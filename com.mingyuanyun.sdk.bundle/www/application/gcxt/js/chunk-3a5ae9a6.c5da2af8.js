(window["webpackJsonp_module_entry_gcxt_"]=window["webpackJsonp_module_entry_gcxt_"]||[]).push([["chunk-3a5ae9a6"],{"705f":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("business-edit-view",{attrs:{data:e.data,comps:e.comps,config:e.config,"biz-type":e.bizType,"change-type":e.changeType,mode:e.mode},on:{"form-change":e.onFormChanged,"select-biz-change":e.selectBizChange}})},r=[],i=(n("ac67"),n("1bc7"),n("32ea"),n("e5b4"),n("34f5")),o=n("6c9f"),c=n("225c"),u=n("7bce"),s=n("db68"),d=n("3ec3"),f=n("2d5c"),l=n("82f8"),b=n("2655"),p=n("a262");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={name:"PaymentEdit",components:{BusinessEditView:p["a"]},data:function(){return{bizType:s["b"].store.getValueByKey("biz_type"),changeType:s["b"].store.getValueByKey("change_type")||"",data:null,comps:["ViewTemplate","FormComp","RelativeFieldGroup","SubForms","UploadImages","Attachment","SelectPeople","UserSelector"],accountInfo:{}}},computed:{sheetId:function(){return this.$route.query.id},mode:function(){return this.sheetId?"edit":"add"},config:function(){return d["a"][this.bizType]}},watch:{sheetId:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){var e=this,t={afterLayoutRequest:this.insertFields};c["a"].init({bizType:this.bizType,changeType:this.changeType,sheetId:this.sheetId,params:JSON.parse(this.$route.query.params||"null"),config:this.config,hooks:t}).then((function(t){var n=t;e.data=n,e.addJzcConfirmField()})).catch((function(e){console.error(e)}))},selectBizChange:function(e){if("contract_id"===e.id)return this.getBankInfo(e.value)},insertFields:function(e){var t=e.dataModel,n=e.layoutArr;t.yf_company={id:"yf_company",label:"乙方单位",value:"",show:!0,isEdit:!1,enabled:!1,type:"text",relative_id:"contract_id",nestingStructure:"yf_company"},n[1].unshift("yf_company")},addJzcConfirmField:function(){var e=this;return Object(l["o"])({codes:["sub_form_relative_jzc"]}).then((function(t){var n;try{n=JSON.parse(t.data[0].layout)}catch(a){n=null}n&&n.enable&&n.enable.payment&&e.data.relative_doc.layouts.push({code:"relative_from_jzc_confirm",enable:{payment:!0},req:{payment:n.req&&n.req.payment||0},label:"关联收货确认单",title:"请选择关联收货确认单"})}))},getBankInfo:function(e){var t=this,n=this.data.formData.dataModel;return Object(f["b"])({contract_id:e}).then((function(e){var a=e.data;for(var r in a)n[r]&&(n[r].value=n[r].text=a[r],u["b"].triggerRelation(n[r],t.data.formData),Object(b["b"])(n,a));a.bank;var i=Object(o["a"])(a,["bank"]);if(t.accountInfo=i,a.bank&&n.bank_name){var c=a.bank.map((function(e){var t=e.bank_name;return m(m({},e),{},{text:t,value:t})})),s=n.bank_name;s.data=c;var d={},f=function(e){return s.value===e.value};s.value&&(d=c.find((function(e){if(f(e))return s.text=e.text,!0})),d||(1===c.length?(s.value=s.text=c[0].value,d=c[0]):s.value=s.text="")),Object(b["b"])(n,m(m({},i),d)),u["b"].triggerRelation(s,t.data.formData)}}))},onFormChanged:function(e,t,n){"bank_name"===t.id&&Object(b["b"])(this.data.formData.dataModel,m(m({},this.accountInfo),n[0]))}}},g=y,v=(n("bd75"),n("5d22")),_=Object(v["a"])(g,a,r,!1,null,"3fa90309",null);t["default"]=_.exports},"84bb":function(e,t,n){var a=n("c005");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=n("85cb").default;r("16cda977",a,!0,{sourceMap:!1,shadowMode:!1})},bd75:function(e,t,n){"use strict";n("84bb")},c005:function(e,t,n){t=e.exports=n("690e")(!1),t.push([e.i,"[data-v-3fa90309] .field-jzc_confirms .af-item .af-title{min-width:97px;width:auto}",""])}}]);