(window["webpackJsonp_module_entry_gcxt_"]=window["webpackJsonp_module_entry_gcxt_"]||[]).push([["chunk-ab59204c"],{"34d4":function(e,t,n){var a=n("a6f8");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=n("85cb").default;r("72001ec9",a,!0,{sourceMap:!1,shadowMode:!1})},"705f":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("business-edit-view",{attrs:{data:e.data,comps:e.comps,config:e.config,"biz-type":e.bizType,"change-type":e.changeType,mode:e.mode},on:{"form-change":e.onFormChanged,"select-biz-change":e.selectBizChange}})},r=[],i=(n("5ab2"),n("6d57"),n("e10e"),n("e697"),n("b23b")),o=n("28f8"),c=n("225c"),s=n("7bce"),u=n("db68"),l=n("3ec3"),d=n("2d5c"),f=n("2c57"),p=n("0938"),b=n("82f8"),h=n("2655"),m=n("a783"),y=n("a262");function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _={name:"PaymentEdit",components:{BusinessEditView:y["a"]},data:function(){return{bizType:u["b"].store.getValueByKey("biz_type"),changeType:u["b"].store.getValueByKey("change_type")||"",data:null,comps:["ViewTemplate","FormComp","SubForms","UploadImages","Attachment","SelectPeople","UserSelector"],accountInfo:{}}},computed:{sheetId:function(){return this.$route.query.id},mode:function(){return this.sheetId?"edit":"add"},config:function(){return l["a"][this.bizType]}},watch:{sheetId:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){var e=this,t={afterLayoutRequest:this.insertFields};c["a"].init({bizType:this.bizType,changeType:this.changeType,sheetId:this.sheetId,params:JSON.parse(this.$route.query.params||"null"),config:this.config,hooks:t}).then((function(t){var n=t;e.data=n})).catch((function(e){console.error(e)}))},selectBizChange:function(e){if("contract_id"===e.id)return this.getBankInfo(e.value)},insertFields:function(e){var t=this,n=e.dataModel,a=e.layoutArr,r=e.groupInfo;return n.yf_company={id:"yf_company",label:"乙方单位",value:"",show:!0,isEdit:!1,enabled:!1,type:"text",relative_id:"contract_id",nestingStructure:"yf_company"},a[1].unshift("yf_company"),Object(b["n"])({codes:["sub_form_relative_jzc"]}).then((function(e){var i;try{i=JSON.parse(e.data[0].layout)}catch(c){i=null}if(i&&i.enable&&i.enable.payment){var o={id:"jzc_confirms",hasSubtext:1,isEdit:1,keyword:"",label:i.groupName||"收货确认单",multi:!0,multiple:!0,options:[],placeholder:"必选",req:i.req&&i.req.payment||0,searchTip:"搜获确认单据名称或编号",subtext:[],temp:[],text:"",type:"selectBiz",value:"",valueReviewTpl:"已选({0})",showSearch:!1,keyMap:{id:"confirm_id",name:"confirm_no",value:"confirm_id",label:"subtext"},pagingFun:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page_index:1,page_size:10};e.page_size=10;var t=m["a"].contracts[0];return e.contract_id=t?t.contract_id:"",Object(f["a"])(e).then((function(e){if(!e.data)return{list:[],total:0};var t=e.data,n=t.list,a=t.count,r=n.map((function(e){return v(v({},e),{},{subtext:e.ws_code?"申购单编号：".concat(e.ws_code):""})}));return{list:r,total:a}}))},show:!0,data:[],searchResult:[],multiTexts:[],sendType:"Object"};t.$set(n,"jzc_confirms",o),a.push(["jzc_confirms"]),r.push({groupId:Object(p["c"])(),name:""})}}))},getBankInfo:function(e){var t=this,n=this.data.formData.dataModel;return Object(d["b"])({contract_id:e}).then((function(e){var a=e.data;for(var r in a)n[r]&&(n[r].value=n[r].text=a[r],s["b"].triggerRelation(n[r],t.data.formData),Object(h["b"])(n,a));a.bank;var o=Object(i["a"])(a,["bank"]);if(t.accountInfo=o,a.bank&&n.bank_name){var c=a.bank.map((function(e){var t=e.bank_name;return v(v({},e),{},{text:t,value:t})})),u=n.bank_name;u.data=c;var l={},d=function(e){return u.value===e.value};u.value&&(l=c.find((function(e){if(d(e))return u.text=e.text,!0})),l||(1===c.length?(u.value=u.text=c[0].value,l=c[0]):u.value=u.text="")),Object(h["b"])(n,v(v({},o),l)),s["b"].triggerRelation(u,t.data.formData)}}))},onFormChanged:function(e,t,n){"bank_name"===t.id&&Object(h["b"])(this.data.formData.dataModel,v(v({},this.accountInfo),n[0]))}}},O=_,j=(n("8ee5"),n("c701")),w=Object(j["a"])(O,a,r,!1,null,"3bfb6466",null);t["default"]=w.exports},"8ee5":function(e,t,n){"use strict";n("34d4")},a6f8:function(e,t,n){t=e.exports=n("690e")(!1),t.push([e.i,"[data-v-3bfb6466] .field-jzc_confirms .af-item .af-title{min-width:97px;width:auto}",""])}}]);