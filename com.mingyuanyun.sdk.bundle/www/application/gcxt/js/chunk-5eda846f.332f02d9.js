(window["webpackJsonp_module_entry_gcxt_"]=window["webpackJsonp_module_entry_gcxt_"]||[]).push([["chunk-5eda846f","chunk-0a82b41d"],{"3ec5":function(t,e,i){var a=i("a5a1");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("85cb").default;n("797dfdf8",a,!0,{sourceMap:!1,shadowMode:!1})},"5e54":function(t,e,i){t.exports=i.p+"img/announcement.75c1464d.png"},"648c":function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return c}));var a=i("ab3e"),n=i("da71");function o(t){return Object(a["a"])({url:n["a"].get_update_info})}function s(t){return Object(a["a"])({url:n["a"].get_msg_list,data:t})}function r(t){return Object(a["a"])({url:n["a"].get_last_version,data:t})}function c(t){return Object(a["a"])({url:n["a"].get_erp_statement_by_msg_id,data:t})}},7010:function(t,e,i){"use strict";i("3ec5")},"80e6":function(t,e,i){t.exports=i.p+"img/no_todo.c7ca1ef3.png"},"8b7b":function(t,e,i){"use strict";i.d(e,"d",(function(){return R})),i.d(e,"a",(function(){return m})),i.d(e,"b",(function(){return h})),i.d(e,"c",(function(){return w}));i("cc57"),i("06a2"),i("6d57");var a=i("a740"),n=i("4360"),o=i("21aa"),s=i("a18c"),r=i("ddf0"),c=i("34ae"),l=i("d9d2"),d=function(){var t="";return function(){if(t)return t;var e=location.protocol+location.host+location.pathname;return t=e.substring(0,e.lastIndexOf("/")+1),t}}(),g=d()+"static/images/IM/back.png",u=d()+"static/images/IM/info.png",p=d()+"static/images/IM/groupInfo.png",f=d()+"static/images/IM/tel.png",m="GROUP",h="PRIVATE",x=[],b={},v={};function _(){return new Promise((function(t,e){window.RongCloudLibPlugin?window.RongCloudLibPlugin.getConversationList((function(e,i){e&&"success"===e.status&&(console.log("会话列表",e),t(e.result))})):t([])}))}function w(){return new Promise((function(t,e){_().then(C).then(P).then((function(){t(x)}))}))}function y(t){if(!t)return null;var e=v,i=x;return t.forEach((function(t){e[t.group_id]=t.group_name})),i.forEach((function(t,i){if(t.conversationType===m){var a=e[t.targetId];a&&(x[i].group_name=a)}})),t}function k(t){if(!t)return null;var e=b,i=x;return t.forEach((function(t){e[t.user_id]=t})),i.forEach((function(t,i){if(t.conversationType===h){var a=e[t.targetId];a&&(x[i].targetInfo=a)}})),t}function C(t,e){var i=b,a=v,n=[],o=[];return t.forEach((function(t){t.conversationType===h?i[t.targetId]?t.targetInfo=i[t.targetId]:n.push(t.targetId):t.conversationType===m&&(!i[t.senderUserId]&&n.indexOf(t.senderUserId)<0&&!isNaN(t.senderUserId)&&""!==t.senderUserId&&n.push(t.senderUserId),a[t.targetId]?t.group_name=a[t.targetId]:o.push(t.targetId))})),x=t,n.length||o.length?Promise.all([I(n),T(o)]):null}function I(t){return t&&t.length?new Promise((function(e,i){Object(r["b"])({user_ids:JSON.stringify(t)}).then((function(t){e(t.data)}))})):Promise.resolve()}function T(t){return t&&t.length?new Promise((function(e,i){Object(r["a"])({group_ids:t.join(",")}).then((function(t){e(t.data)}))})):Promise.resolve()}function P(t){if(t){var e=t[0],i=t[1];k(e),y(i)}}function R(t,e,i){if(window.MRongCloudCaigou){i=void 0===i?0:i;var r=Object(a["d"])(),d={userId:r.user_id,name:Object(a["a"])("xt_user_name"),portraitUri:r.photo},m={userId:t.user_id,name:t.name,portraitUri:t.photo},h={onOpenIMSuccess:function(){console.log("开启聊天")},onOpenIMError:function(){console.error(arguments),l["b"].toast("打开聊天失败"),c["a"].__im_user=void 0},onGoBack:function(){c["a"].__im_user=void 0,n["a"].commit(o["c"],null),s["a"].push("/home/message")},onClickBusInfo:function(t){console.log("点击businfo区域"),console.log(arguments)},onClickPortrait:function(t){console.log(t),console.log("点击了聊天用户头像"),c["a"].__im_user=void 0},onClickRightIcon:function(){}},x={isShowRightBtn:!0,conversationType:i,navBar:{leftIconPath:g,rightIconPath:p,barColor:"#3492e9",barTitleColor:"#ffffff"},closeOpenAnimation:!0,closeBackAnimation:!0};i||(x.navBar.rightIconPath=u,x.navBar.rightSubIconPath=f,x.navBar.rightSubParam={type:1,value:t.user_code}),x.busInfo=e,console.log(x,"----im");try{window.MRongCloudCaigou.openIm(d,m,h,x)}catch(b){console.log(b),c["a"].__im_user=void 0}}else console.warn("打开会话框失败，MRongCloudCaigou插件不存在，请检测打包配置。")}},"8c9e":function(t,e,i){"use strict";i("d202")},"9bfc":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"msg_todo_list"}},[i("scroll-refresh",{ref:"scrollList",attrs:{loading:t.loading,finished:t.finished,"finished-text":""},on:{refresh:t.refresh,more:t.more}},[i("div",{staticStyle:{height:"100%"}},[i("div",{staticClass:"list-block msg-list"},[t._t("itemBefore"),t._l(t.listData.data,(function(e,a){return i("div",{directives:[{name:"touch",rawName:"v-touch",value:{index:a,onSwipeLeft:t.onSwipeLeft,onSwipeRight:t.onSwipeRight},expression:"{ index, onSwipeLeft, onSwipeRight }"}],key:a,staticClass:"item-content",class:{undo:"0"===e.msg_status,swipe:a===t.swipeIndex},on:{click:function(i){t.handleRedirect(i,e,a)}}},[i("div",{staticClass:"item-media",class:{unread:"0"===e.msg_status}},[i("i",{staticClass:"iconfont",class:t._f("bizTypeIcon")(e)})]),i("div",{staticClass:"item-inner"},[i("div",{staticClass:"item-title-row"},[i("div",[i("span",[t._v(t._s(e.msg_content.news.articles[0].title))])])]),i("div",{staticClass:"item-subtitle"},[1===e.display?i("span",[i("span",{domProps:{textContent:t._s("cc"===e.msg_content.news.articles[0].flag?"抄送人":"发起人")}}),t._v("\n                :"+t._s(e.msg_content.news.articles[0].fq_user.station_name)+"【"+t._s(e.msg_content.news.articles[0].fq_user.user_name)+"】\n              ")]):i("span",[t._v(t._s(e.msg_content.news.articles[0].description))])]),i("div",{staticClass:"item-subtitle clearfix",attrs:{id:"msg-detail"}},[i("span",{staticClass:"item-date"},[t._v(t._s(t._f("timer")(e.create_time)))]),1===e.display?i("span",{staticClass:"item-desc"},[t._v("\n                "+t._s(e.msg_content.news.articles[0].biz_type_desc)+"\n              ")]):i("span",{staticClass:"item-desc"},[t._v("\n                "+t._s(t._f("bizTypeTransfer")(e.biz_type))+"\n              ")]),e.msg_content.news.articles[0].erp_change_type?i("span",{staticClass:"item-desc"},[t._v("\n                "+t._s(e.msg_content.news.articles[0].erp_change_type)+"\n              ")]):t._e()])]),"0"===e.msg_status?i("div",{staticClass:"set-done",attrs:{"data-index":a},on:{click:function(i){i.stopPropagation(),t.handleSetDone(i,e,a)}}},[t._v("\n            置为已读\n          ")]):t._e()])}))],2)])]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.listData.data.length&&!t.busy&&!t.broadcastCount,expression:"!listData.data.length && !busy && !broadcastCount"}],staticClass:"no-new"},[t._v("\n    当前无通知事项\n  ")]),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showButton,expression:"showButton"}],staticClass:"read-all-btn",on:{click:t.set_msg_read}},[i("i",{staticClass:"iconfont icon-quanbiaoyidu-01"}),i("span",{staticClass:"text"},[t._v("将未读消息标为已读")])])])],1)},n=[],o=i("4c09"),s=(i("6a61"),i("2e91")),r=(i("6d57"),i("06a2"),i("163d"),i("f121")),c=i("648c"),l=i("40e4"),d=i("a075"),g=i("db68"),u=i("933f"),p=i("042e"),f={name:"NoticeList",filters:{bizTypeTransfer:function(t){if(!t)return t;var e=r["d"][t];return e||""},bizTypeIcon:function(t){var e="";try{e=t.msg_content.news.articles[0].change_type}catch(n){e=""}if("现场签证"===e)return"icon-_daiban-xianchangqi";if("设计变更"===e)return"icon-_daiban-shejibiange";var i=t.biz_type;if(!i)return i;var a=r["c"][i];return a||""},timer:function(t){return d["a"].date.beautify(t)}},props:{broadcastCount:{type:Number,default:0}},data:function(){return{swipeIndex:-1,loading:!1,loaded:!1,finished:!1,pageIndex:0,notifyMsgCount:0,list:[],busy:!1,loadAll:!1,listData:{searchParam:{page_index:0,msg_type:1},data:[]},bottomConfig:{triggerDistance:10}}},computed:{showButton:function(){return this.listData.data.some((function(t){return"0"===t.msg_status}))||this.broadcastCount>0}},watch:{notifyMsgCount:function(t){!isNaN(t)&&t>=0&&this.$store.dispatch(p["g"],{message:t+this.broadcastCount})}},mounted:function(){this.notifyMsgCount=this.$store.state.menuInfo.data[2].number},methods:{onSwipeLeft:function(t){"0"===this.listData.data[t].msg_status&&(this.swipeIndex=t)},onSwipeRight:function(){this.swipeIndex=-1},set_msg_read:function(){var t=this;this.sui.actions({title:"确认全标已读吗？",classNames:["action-sheet__notice-list"],actions:[{name:"全标已读",color:"#FF3B30"}],onSelect:function(e){return u["a"].idkey(u["a"].idkeys.noticeReadAll),Promise.all([Object(l["k"])().then((function(){return t.refresh()})),Object(l["m"])()]).then((function(){t.$store.dispatch(p["d"]),t.notifyMsgCount=0,t.sui.toast("全部置为已读成功")}))},onCancel:function(){}})},refresh:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.busy){t.next=2;break}return t.abrupt("return");case 2:return this.listData.searchParam.showIndicator=void 0==i||i,this.listData.searchParam.page_index=1,this.$refs.scrollList&&this.$refs.scrollList.scrollTop(),t.abrupt("return",this.getListData("refresh"));case 6:case"end":return t.stop()}}),t,this)})));function e(e,i){return t.apply(this,arguments)}return e}(),more:function(){this.listData.searchParam.page_index++,this.getListData("more")},getListData:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var i,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.swipeIndex=-1,this.busy=!0,this.loading=!0,i=this,t.abrupt("return",Object(c["b"])(this.listData.searchParam).then((function(t){i.busy=!1,"refresh"===e&&(i.listData.data=[],i.finished=!1),t.data.length<10&&(i.finished=!0),i.listData.data=[].concat(Object(o["a"])(i.listData.data),Object(o["a"])(t.data)),a.loading=!1})).catch((function(){i.finished=!0,i.loading=!1})));case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleRedirect:function(t,e,i){var a=this;return u["a"].idkey(u["a"].idkeys.noticeToBiz),Object(l["l"])({msg_id:e.msg_id}).then((function(t){a.swipeIndex=-1,a.$set(a.listData.data[i],"msg_status","1"),a.notifyMsgCount-=1})).then((function(){g["b"].business.message.open({msg_id:e.msg_id,msg_type:e.msg_type,biz_type:e.biz_type,msg_status:e.msg_status,param:e.msg_content.news.articles[0].url,linkto:e.msg_content.news.articles[0].linkto,dev_id:e.msg_content.news.articles[0].dev_id,biz_id:e.biz_id,description:e.msg_content.news.articles[0].description,sub_biz_type:e.sub_biz_type,change_type:e.msg_content.news.articles[0].change_type})}))},handleSetDone:function(t,e,i){var a=this;return Object(l["l"])({msg_id:e.msg_id}).then((function(t){a.swipeIndex=-1,a.$set(a.listData.data[i],"msg_status","1"),a.notifyMsgCount-=1}))},goBack:function(){history.back()}}},m=f,h=(i("7010"),i("c701")),x=Object(h["a"])(m,a,n,!1,null,"7c90527e",null);e["default"]=x.exports},a5a1:function(t,e,i){var a=i("5454");e=t.exports=i("690e")(!1),e.push([t.i,'@charset "UTF-8";.gcxt[data-v-7c90527e] :export{colorPrimary:#2c5cf7;headerBackgroundColor:#fff;headerTextColor:#333}.gcxt .list-block ul li[biz_type="9"][data-v-7c90527e]{background:#fff}.gcxt .list-block ul li[biz_type="9"] .item-subtitle[data-v-7c90527e]{overflow:hidden;white-space:nowrap}.gcxt .list-block ul li.msg_status_1 .item-title[data-v-7c90527e]{color:#999}.gcxt .list-block ul li[biz_type="9"] .item-title[data-v-7c90527e]{color:#333}.gcxt .list-block ul li.msg_status_1 .item-subtitle[data-v-7c90527e]{color:#999}.gcxt .list-block ul[data-v-7c90527e]:after,.gcxt .list-block ul[data-v-7c90527e]:before{display:none}.gcxt .item-time[data-v-7c90527e]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:.6rem;color:#999;height:1.3rem;line-height:1.3rem;-ms-flex-negative:0;flex-shrink:0;-webkit-flex-shrink:0}.gcxt .xt-ios .item-time[data-v-7c90527e]{font-size:.65rem}.gcxt .item-title-row[data-v-7c90527e]{padding:0}.gcxt .show-history[data-v-7c90527e]{display:none}.gcxt .buttons-tab[data-v-7c90527e]{position:absolute;left:0;width:100%;top:2.2rem;z-index:1}.gcxt .page .content[data-v-7c90527e]{top:2.2rem;padding-bottom:0}.gcxt .has-sys-msg .content[data-v-7c90527e]{top:3.8rem}.gcxt .xt-ios .bar-nav~.content[data-v-7c90527e]{top:2.9rem}.gcxt .xt-ios .has-sys-msg .content[data-v-7c90527e]{top:4.5rem}.gcxt .has-overtime .content[data-v-7c90527e]{top:4.9rem}.gcxt .xt-ios .has-overtime .content[data-v-7c90527e]{top:5.6rem}.gcxt .has-sys-msg.has-overtime .content[data-v-7c90527e]{top:6.5rem}.gcxt .xt-ios .has-sys-msg.has-overtime .content[data-v-7c90527e]{top:7.2rem}.gcxt #msg_list .no-new[data-v-7c90527e],.gcxt #msg_todo_list .no-new[data-v-7c90527e]{position:absolute;top:100px;padding-top:235px;width:100%;background-repeat:no-repeat;background-position:bottom;background-size:45%;font-size:.8rem;color:#666;text-align:center;background-image:url('+a(i("80e6"))+')}.gcxt .unread[data-v-7c90527e]{position:relative}.gcxt .unread[data-v-7c90527e]:before{position:absolute;right:0;top:0;width:10px;height:10px;background:#f83b37;border-radius:50%;content:""}.gcxt #msg_list li[data-v-7c90527e],.gcxt #msg_todo_list li[data-v-7c90527e]{position:relative;padding-left:0}.gcxt #msg_list .iconfont[data-v-7c90527e],.gcxt #msg_todo_list .iconfont[data-v-7c90527e]{display:inline-block;width:40px;height:40px;font-size:40px;text-align:center;line-height:40px}.gcxt #msg_list .item-subtitle[data-v-7c90527e],.gcxt #msg_todo_list .item-subtitle[data-v-7c90527e]{padding:3px 0 0}.gcxt .item-title-row[data-v-7c90527e]{min-height:21px;line-height:21px;font-size:15px}.gcxt #msg-detail[data-v-7c90527e]{overflow:initial}.gcxt .item-status[data-v-7c90527e]{line-height:21px;float:right;font-size:14px;right:14px;bottom:16px;color:#509afa}.gcxt .item-status.danger[data-v-7c90527e]{color:#d0021b}.gcxt .item-date[data-v-7c90527e],.gcxt .item-desc[data-v-7c90527e]{padding-right:15px;float:left}.gcxt #page-home .overtime-tabs .tab.active .tab-contain[data-v-7c90527e]{background-color:#509afa;color:#fff}.gcxt #page-home .tab-contain[data-v-7c90527e]{display:inline-block;padding:2px 11px;min-width:0;color:#69696e;border-radius:100px;line-height:20px}.gcxt .overtime-tabs .tab[data-v-7c90527e]{-webkit-box-flex:initial;-ms-flex:initial;flex:initial;-webkit-flex:initial;width:33%}.gcxt .overtime-tips[data-v-7c90527e]{margin:0 5px 0 0;position:relative;width:11px;height:16px}.gcxt .overtime-tips[data-v-7c90527e]:after{position:absolute;border-radius:4px;padding:2px;width:12px;height:12px;font-size:12px;line-height:12px;left:0;top:2px;text-align:center}.gcxt .overtime-tips.yellow[data-v-7c90527e]{background-color:transparent}.gcxt .overtime-tips.yellow[data-v-7c90527e]:after{content:"\\8B66";background-color:#faa304}.gcxt .overtime-tips.red[data-v-7c90527e]{background-color:transparent}.gcxt .overtime-tips.red[data-v-7c90527e]:after{content:"\\8D85";background-color:#fc5a14}.gcxt #msg_list li[data-v-7c90527e],.gcxt #msg_todo_list li[data-v-7c90527e],.gcxt .set-done[data-v-7c90527e]{-webkit-transition:.1s;transition:.1s}.gcxt #msg_list .item-status[data-v-7c90527e]{display:none}.gcxt .set-done[data-v-7c90527e]{width:100px;position:absolute;right:-100px;top:0;height:100%;display:none;-webkit-box-align:center;-webkit-box-pack:center;color:#fff;background-color:#c7c7cc}.gcxt .swipe .set-done[data-v-7c90527e]{display:-webkit-box}.gcxt .swipe[data-v-7c90527e]{transform:translate3d(-100px,0,0);-webkit-transform:translate3d(-100px,0,0)}.gcxt .sys-msg[data-v-7c90527e]{position:absolute;left:0;bottom:0;width:100%;background:#fff1ad;color:#333;font-size:.7rem;padding-left:.75rem;height:32px;line-height:32px;top:2.2rem}.gcxt .xt-ios .sys-msg[data-v-7c90527e]{top:2.9rem}.gcxt .sys-msg .icon-close[data-v-7c90527e]{padding:0 .7rem;position:absolute;right:0;top:0}.gcxt .sys-msg .icon-close[data-v-7c90527e]:before{background:#d6cb94;display:block;color:#fff;font-size:8px;line-height:1em;padding:6px 5px 4px 5px;border-radius:100%;text-align:center;margin-top:7px}.gcxt .xt-ios .sys-msg .icon-close[data-v-7c90527e]:before{padding:5px;margin-top:5px}.gcxt .overtime-tabs.active[data-v-7c90527e]{display:-webkit-box;display:-ms-flexbox;display:flex}.gcxt .overtime-tabs[data-v-7c90527e]{top:2.2rem;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.gcxt .has-sys-msg .overtime-tabs[data-v-7c90527e]{top:3.8rem}.gcxt .overtime-tabs[data-v-7c90527e]{border-bottom:0;-ms-flex-wrap:wrap;flex-wrap:wrap}.gcxt .overtime-tabs[data-v-7c90527e]:after{content:"";display:block;height:10px;width:100%;background-color:#f5f5f9;-webkit-box-shadow:0 2px 5px 0 #e2e2e2 inset;box-shadow:inset 0 2px 5px 0 #e2e2e2}.gcxt .overtime-tabs .tab[data-v-7c90527e]{height:2.2rem}.gcxt .item-title-row .item-title[data-v-7c90527e]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;white-space:normal}.gcxt ul.list-block[data-v-7c90527e]{background:#fff;list-style:none;padding:0;margin:0;position:relative}.gcxt .xt-iphonex ul.list-block[data-v-7c90527e]{padding-bottom:1.7rem!important}.gcxt .action-block p[data-v-7c90527e]{margin:0;color:#999}.gcxt .scroll-container[data-v-7c90527e]{overflow:hidden;overflow-y:auto}[data-v-7c90527e] .header-bg .pull-right{right:15px}.gcxt #msg_todo_list[data-v-7c90527e]{position:absolute;top:0;bottom:0;left:0;right:0}.gcxt #msg_todo_list .item-content[data-v-7c90527e]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:0;position:relative}.gcxt #msg_todo_list .item-content[data-v-7c90527e]:before{bottom:0;content:" ";position:absolute;z-index:1;left:0;right:0;border-top:1px solid #efeff4;-webkit-transform:scaleY(.5);transform:scaleY(.5);left:15px}.gcxt #msg_todo_list .item-media[data-v-7c90527e]{padding:0;margin:10px 15px}.gcxt #msg_todo_list .item-inner[data-v-7c90527e]{margin-left:0}.gcxt #msg_todo_list .item-inner[data-v-7c90527e]:after{display:none}.gcxt #msg_todo_list .list-block[data-v-7c90527e]{margin-top:0;margin-bottom:75px}.gcxt #msg_todo_list .read-all-btn[data-v-7c90527e]{position:absolute;bottom:24px;background:#fff;-webkit-box-shadow:0 2px 6px 2px hsla(0,0%,74.9%,.6);box-shadow:0 2px 6px 2px hsla(0,0%,74.9%,.6);border-radius:30px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);color:#2c5cf7;text-align:center;padding:10px 26px;white-space:nowrap;z-index:1}.gcxt #msg_todo_list .read-all-btn .iconfont[data-v-7c90527e]{width:auto;height:auto;line-height:1;margin-right:8px;font-size:14px}[data-v-7c90527e] .van-list{background:#fff}',""])},cd0f:function(t,e,i){e=t.exports=i("690e")(!1),e.push([t.i,".gcxt .content{padding-bottom:10px}.gcxt .conversation-list{padding:0;margin:0;padding-left:15px;background-color:#fff}.gcxt #page-home .icon-gongchengxietong-icon-36{font-size:20px;margin-top:-12px;position:relative;z-index:20}.gcxt #page-home .icon-gongchengxietong-icon-34{font-size:30px;line-height:48px}.gcxt .conversation-list{list-style:none}.gcxt .conversation-item{position:relative;padding:10px 15px 10px 58px;height:70px}.gcxt .conversation-item:last-child{border-bottom:none}.gcxt .conversation-item-icon{width:40px;height:40px;border-radius:5px;position:absolute;left:0;top:15px;background-size:contain;color:#fff;font-size:30px;text-align:center;line-height:40px}.gcxt .conversation-item-header{display:block;width:100%;height:100%;border:none;border-radius:5px}.gcxt .permissionSetting{background-color:#e8f2ff;position:relative;height:41px;line-height:41px;padding-left:35px;color:#69696e;font-size:14px}.gcxt .permissionSetting button{outline:none;padding:0;border:0;-webkit-appearance:none}.gcxt .permissionSetting .icon-close{position:absolute;font-size:12px;color:#8e8e93;left:13px;top:14px;line-height:12px;background-color:transparent}.gcxt .permissionSetting-btn{position:absolute;right:8px;top:8px;background-color:#fff;border-radius:100px;width:60px;height:24px;line-height:25px;text-align:center;color:#4694fb;font-size:13px;-webkit-box-shadow:0 2px 4px 0 rgba(82,131,229,.17);box-shadow:0 2px 4px 0 rgba(82,131,229,.17)}.gcxt .conversation-broadcast{background-image:linear-gradient(-1deg,#fc8c60,#facc99)}.gcxt .conversation-inform{background-image:linear-gradient(-1deg,#00dadf,#7dfeff)}.gcxt .conversation-item-count{position:absolute;background-color:#ea3426;color:#fff;line-height:14px;font-size:12px;border-radius:7px;right:-4px;top:-4px;min-width:14px;padding:0 2px;text-align:center}.gcxt .conversation-item-title{font-size:17px;height:25px;padding-right:80px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.gcxt .conversation-item-subtitle{color:#8e8e8e}.gcxt .conversation-item-detail{font-size:14px;color:#8e8e8e;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1;padding-top:6px;height:26px}.gcxt .conversation-item-detail .draft{color:red}.gcxt .conversation-item-time{position:absolute;right:15px;top:15px;font-size:14px;line-height:1;color:#8e8e8e}.gcxt .modal.busInfo .modal-inner{border-radius:3px 3px 0 0}.gcxt .modal.busInfo .modal-title{text-align:left;font-size:17px;font-weight:400}.gcxt .modal.busInfo .user-info{position:relative;margin-top:14px;padding-left:50px;line-height:40px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:left}.gcxt .modal.busInfo .user-header{position:absolute;width:40px;height:40px;left:0;top:0}.gcxt .modal.busInfo .user-name{font-size:16px;color:#2d2d00}.gcxt .modal.busInfo .message{margin:25px 0 11px 0}.gcxt .modal.busInfo .message input{display:block;width:100%;height:45px;line-height:20px;background-color:transparent;text-align:left;border:1px solid #e5e5e5;text-indent:5px;outline:none;-webkit-appearance:none}.gcxt .modal.busInfo .modal-button:first-child{color:#69696e;border-radius:0 0 0 3px}.gcxt .modal.busInfo .modal-button:last-child{border-radius:0 0 3px 0}.gcxt .swipe .set-done{display:-webkit-box}.gcxt .set-done{width:100px;position:absolute;right:-100px;top:0;height:100%;display:none;-webkit-box-align:center;-webkit-box-pack:center;color:#fff;background-color:#c7c7cc}.gcxt #page-home li,.gcxt .set-done{-webkit-transition:.1s;transition:.1s}.gcxt .swipe{transform:translate3d(-100px,0,0);-webkit-transform:translate3d(-100px,0,0)}",""])},cdfa:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",[a("v-header",{attrs:{slot:"header",title:"消息","is-back":!1},slot:"header"},[a("template",{slot:"right"},[a("i",{staticClass:"icon__contract-book iconfont icon icon-_tongxunlu _ex-click",on:{click:t.goAddressList}})])],2),a("div",{staticClass:"content"},[t.showPermissionSetting?a("div",{staticClass:"permissionSetting"},[a("button",{staticClass:"iconfont icon-close",attrs:{type:"button"},on:{click:t.onPermissionSetting}}),a("span",[t._v("打开系统通知，随时接收消息通知")]),a("button",{staticClass:"permissionSetting-btn",attrs:{type:"button"},on:{click:function(e){t.onPermissionSetting(!0)}}},[t._v("\n        去开启\n      ")])]):t._e(),a("ul",{staticClass:"conversation-list"},[t._l(t.imData.conversationList,(function(e,i){return["PRIVATE"===e.conversationType&&e.targetInfo||"GROUP"===e.conversationType?a("li",{key:i,staticClass:"conversation-item conversation-item-chat",on:{click:function(i){t.openIm(e,i)}}},[a("div",{staticClass:"conversation-item-icon"},["PRIVATE"===e.conversationType?a("img",{staticClass:"conversation-item-header",attrs:{src:e.targetInfo.photo?e.targetInfo.photo:t.defaultHeader,alt:""}}):t._e(),"GROUP"===e.conversationType?a("i",{staticClass:"iconfont icon-gongchengxietong-icon-34"}):t._e(),e.unreadMessageCount?a("span",{staticClass:"conversation-item-count"},[t._v("\n              "+t._s(e.unreadMessageCount)+"\n            ")]):t._e()]),"GROUP"===e.conversationType?a("div",{staticClass:"conversation-item-title"},[t._v("\n            "+t._s(e.group_name||"多人聊天")+"\n          ")]):t._e(),"PRIVATE"===e.conversationType&&e.targetInfo?a("div",{staticClass:"conversation-item-title"},[t._v("\n            "+t._s(e.targetInfo.name)+"\n            "),e.targetInfo.station_name?a("span",{staticClass:"conversation-item-subtitle"},[t._v("\n              ("+t._s(e.targetInfo.station_name)+")\n            ")]):t._e()]):t._e(),e.draft?a("div",{staticClass:"conversation-item-detail"},[a("span",{staticClass:"draft"},[t._v("[草稿]")]),a("span",[t._v(t._s(t._f("draftFilter")(e.draft)))])]):t._e(),e.draft?t._e():a("div",{staticClass:"conversation-item-detail"},["GROUP"===e.conversationType?a("span",[t._v("\n              "+t._s(t.userInfo[e.senderUserId]&&t.userInfo[e.senderUserId].name+":")+"\n            ")]):t._e(),"RC:VcMsg"===e.objectName?a("span",[t._v("[语音消息]")]):t._e(),"RC:ImgMsg"===e.objectName?a("span",[t._v("[图片]")]):t._e(),"RC:TxtMsg"===e.objectName?a("span",[t._v(t._s(e.latestMessage.text))]):t._e(),"MIC:BusInfoMsg"===e.objectName?a("span",[t._v("[应用消息]")]):t._e()]),a("div",{staticClass:"conversation-item-time"},[t._v(t._s(t._f("timeFilter")(e.receivedTime)))]),a("div",{staticClass:"set-done",on:{click:function(a){t.removeIm(e,i)}}},[t._v("\n            删除会话\n          ")])]):t._e()]}))],2),a("notice-list",{attrs:{"broadcast-count":t.broadcastData.broadcastCount||0}},[a("template",{slot:"itemBefore"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.broadcastData.broadcastTime,expression:"broadcastData.broadcastTime"}],staticClass:"conversation-item",on:{click:function(e){t.goRouter("/message-broadcast")}}},[a("div",{staticClass:"conversation-item-icon conversation-broadcast iconfont"},[a("img",{staticClass:"img",attrs:{src:i("5e54")}}),t.broadcastData.broadcastCount?a("span",{staticClass:"conversation-item-count",domProps:{textContent:t._s(t.broadcastData.broadcastCount)}}):t._e()]),a("div",{staticClass:"conversation-item-title"},[t._v("公告")]),a("div",{staticClass:"conversation-item-detail",domProps:{textContent:t._s(t.broadcastData.broadcastTitle)}}),a("div",{staticClass:"conversation-item-time"},[t._v(t._s(t._f("timeFilter")(t.broadcastData.broadcastTime)))])])])],2)],1),a("template",{slot:"footer"},[t._t("default")],2)],2)},n=[],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"searchTool",class:{active:t.active}},[i("div",{staticClass:"searchTool-header"},[i("div",{staticClass:"searchTool-field"},[i("i",{staticClass:"iconfont icon-_sousuo icon__search"}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"searchTool-input",attrs:{type:"text",placeholder:"搜索"},domProps:{value:t.keyword},on:{focus:t.enter,input:function(e){e.target.composing||(t.keyword=e.target.value)}}}),i("i",{staticClass:"iconfont icon-baocuo",on:{click:t.clear}})]),i("button",{staticClass:"searchTool-btn-quit",attrs:{type:"button"},on:{click:t.quit}},[t._v("\n      取消\n    ")])]),i("div",{staticClass:"searchTool-body"},[t.user.length&&"member"===t.type?i("ul",{staticClass:"userList"},[i("li",{staticClass:"address-title"},[t._v("联系人")]),t._l(t.user,(function(e,a){return i("li",{key:a,staticClass:"userList-item",on:{click:function(i){t.selectuser(e,"PRIVATE")}}},[i("img",{staticClass:"userList-item-photo",attrs:{alt:"",src:e.photo?e.photo:"./assets/images/defaultHeader.png"}}),i("div",{staticClass:"userList-item-name"},[i("span",[t._v(t._s(e.name))]),e.station_name?i("span",{staticClass:"position"},[t._v("\n            ("+t._s(e.station_name)+")\n          ")]):t._e()])])}))],2):t._e(),t.group.length&&"group"===t.type?i("ul",{staticClass:"searchResult-group"},[i("li",{staticClass:"address-title"},[t._v("群聊")]),t._l(t.group,(function(e,a){return i("li",{key:a,staticClass:"searchResult-group-item",on:{click:function(i){t.selectuser(e,"GROUP")}}},[t._m(0,!0),i("div",{staticClass:"searchResult-group-detail"},[i("div",{staticClass:"searchResult-group-name"},[t._v(t._s(e.group_name))]),i("include-user",{attrs:{user:e.members[0],keyword:t.keyword}})],1)])}))],2):t._e()])])},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"searchResult-group-icon"},[i("i",{staticClass:"iconfont icon-gongchengxietong-icon-34"})])}],r=(i("c0c3"),i("ab3e")),c=i("da71"),l={name:"HomeMessage",props:{type:{type:String,default:"member"}},data:function(){return{keyword:"",active:!1,searchId:null,user:[],group:[]}},watch:{keyword:function(t){var e=this;this.searchId&&clearTimeout(this.searchId),this.searchId=setTimeout((function(){e.search(t),this.searchId=null}),500)}},methods:{enter:function(){!0!==this.active&&(this.active=!0)},quit:function(){this.keyword="",this.active=!1},clear:function(){this.keyword=""},search:function(t){console.log(t);var e=this;t?Object(r["a"])({url:c["a"].search_user,data:{keyword:t}}).then((function(t){var i=t.data;e.group=i.group,e.user=i.user})):(this.group=[],this.user=[])},selectuser:function(t,e){this.quit(),this.$emit("selectuser",t,e)}}},d=l,g=i("c701"),u=Object(g["a"])(d,o,s,!1,null,null,null),p=u.exports,f=i("9bfc"),m=i("a075"),h=i("648c"),x=i("8b7b"),b=i("db68"),v=i("34ae"),_=i("933f"),w={name:"HomeMessage",components:{searchTool:p,NoticeList:f["default"]},filters:{timeFilter:function(t){return t?m["a"].date.beautify(t):""},draftFilter:function(t){if(!t)return t;try{var e=JSON.parse(t);return e.draftContent||t}catch(i){return t}}},data:function(){return{PRIVATE:"PRIVATE",showPermissionSetting:!1,msgList:[],imData:this.$store.state.im.imData,list:[],noticePath:"/message-notice"}},computed:{broadcastData:function(){return this.$store.state.todo.broadcastData},notifyCount:function(){return this.$store.state.todo.msgInfo[1]},msgListFirst:function(){var t,e={};return this.msgList.length>0&&(t=this.msgList[0],e.nofifyTitle=t.msg_content.news.articles[0].title,e.create_time=t.create_time),e},hasOpenIM:function(){return b["b"].business.hasOpenIM()}},created:function(){this.getMsg()},methods:{goAddressList:function(){_["a"].idkey(_["a"].idkeys.messageToAddressList),this.$router.push("/message-im-project")},getMsg:function(){var t=this;return Object(h["b"])({msg_type:1,page_index:1}).then((function(e){t.msgList=e.data}))},openAddress:function(){},goRouter:function(t){t===this.noticePath&&_["a"].idkey(_["a"].idkeys.messageToNotice),this.$router.push(t)},openIm:function(t,e){e&&"set-done"===e.target.className||(this.current=t,t&&(v["a"].__im_user=t.conversationType+":"+t.targetId,t.conversationType===this.GROUP?Object(x["d"])({user_id:t.targetId,name:t.group_name||"群聊",photo:""},null,1):t.conversationType===this.PRIVATE&&Object(x["d"])(t.targetInfo)))},createIm:function(t){this.current={conversationType:this.PRIVATE,targetId:t.user_id,targetInfo:t},v["a"].__im_user=this.PRIVATE+":"+t.user_id},onSelectSearchUser:function(t,e){e===this.PRIVATE?(this.createIm(t),this.userInfo[t.user_id]=t):e===this.GROUP&&(v["a"].__im_user=this.GROUP+":"+t.group_id,this.groupName[t.group_id]=t.group_name)},onPermissionSetting:function(t){this.showPermissionSetting=!1}}},y=w,k=(i("8c9e"),Object(g["a"])(y,a,n,!1,null,"578f6784",null));e["default"]=k.exports},d202:function(t,e,i){var a=i("e3fe");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("85cb").default;n("848dd5d2",a,!0,{sourceMap:!1,shadowMode:!1})},e3fe:function(t,e,i){e=t.exports=i("690e")(!1),e.i(i("cd0f"),""),e.push([t.i,'.gcxt[data-v-578f6784] :export{colorPrimary:#2c5cf7;headerBackgroundColor:#fff;headerTextColor:#333}.gcxt .conversation-item[data-v-578f6784]{margin-left:15px;position:relative}.gcxt .conversation-item[data-v-578f6784]:before{bottom:0;content:" ";position:absolute;z-index:1;right:0;border-top:1px solid #efeff4;-webkit-transform:scaleY(.5);transform:scaleY(.5);left:0}.gcxt .conversation-item-icon .img[data-v-578f6784]{width:100%}.gcxt .icon__contract-book[data-v-578f6784]{font-size:20px}.gcxt .conversation-item-icon[data-v-578f6784]{background:-webkit-gradient(linear,left top,right top,from(#2c5cf7),to(rgba(44,92,247,.8)));background:linear-gradient(90deg,#2c5cf7 0,rgba(44,92,247,.8))}',""])}}]);