(window["webpackJsonp_module_entry_gcxt_"]=window["webpackJsonp_module_entry_gcxt_"]||[]).push([["chunk-c2fd2a0e"],{"1c35":function(t,e,i){e=t.exports=i("690e")(!1),e.push([t.i,'.gcxt[data-v-5de7668b] :export{colorPrimary:#0268b3;headerBackgroundColor:#fff;headerTextColor:#333}.gcxt .gld-workload[data-v-5de7668b]{margin-bottom:10px}.gcxt .file-icon[data-v-5de7668b]{font-size:0;display:inline-block;line-height:1;margin-right:10px}.gcxt .file-icon.abs[data-v-5de7668b]{position:absolute;left:15px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.gcxt .icon__file[data-v-5de7668b]{font-size:40px;color:#97c3ff}.gcxt .icon__delete[data-v-5de7668b]{position:absolute;right:0;top:0;padding:5px;-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%);color:#ff3b30}[data-v-5de7668b] .multi-texts-wrapper .multi-texts{padding:13px 15px 13px 68px}[data-v-5de7668b] .multi-texts-wrapper .multi-texts .label{color:#1b1b1b}[data-v-5de7668b] .multi-texts-wrapper .multi-texts .tip{color:#8e8e93;margin-top:3px}.gcxt .view-list .item[data-v-5de7668b]{padding:13px 15px;padding-left:65px;background-color:#fff;position:relative}.gcxt .view-list .item[data-v-5de7668b]:before{bottom:0;content:" ";position:absolute;z-index:1;right:0;border-top:1px solid #ececec;-webkit-transform:scaleY(.5);transform:scaleY(.5);left:0;left:15px}.gcxt .view-list .file-icon[data-v-5de7668b]{left:15px}.gcxt .view-list .label[data-v-5de7668b]{font-size:14px;color:#1b1b1b}.gcxt .view-list .tip[data-v-5de7668b]{margin-top:2px;font-size:13px;color:#8e8e93}.gcxt .view-list .gld-history-btn[data-v-5de7668b]{position:absolute;right:15px;bottom:13px;font-size:12px;padding:0 9px;border:1px solid #dcdcdc;border-radius:15px;line-height:21px;height:22px}.gcxt .view-list .time[data-v-5de7668b]{position:absolute;right:15px;bottom:13px;color:#999;font-size:12px}[data-v-5de7668b] .van-collapse-item__content{padding:0}[data-v-5de7668b] .van-cell__title{font-size:16px}.gcxt .description[data-v-5de7668b]{padding:6px 0 2px 8px}.gcxt .description[data-v-5de7668b],.gcxt .history-view-list .tip[data-v-5de7668b]{font-size:12px;color:#999}',""])},2465:function(t,e,i){"use strict";i("9f96")},"46a4":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page",[i("v-header",{attrs:{slot:"header",title:"Demo"},slot:"header"}),i("gld-workload",{attrs:{"contract-id":"145"}})],1)},a=[],n=i("9a14"),r={name:"Demo",components:{GldWorkload:n["a"]},data:function(){return{}}},s=r,l=i("5d22"),c=Object(l["a"])(s,o,a,!1,null,null,null);e["default"]=c.exports},5289:function(t,e,i){"use strict";i("6b6fb")("link",(function(t){return function(e){return t(this,"a","href",e)}}))},"6b6fb":function(t,e,i){var o=i("e99b"),a=i("0926"),n=i("3ab0"),r=/"/g,s=function(t,e,i,o){var a=String(n(t)),s="<"+e;return""!==i&&(s+=" "+i+'="'+String(o).replace(r,"&quot;")+'"'),s+">"+a+"</"+e+">"};t.exports=function(t,e){var i={};i[t]=e(s),o(o.P+o.F*a((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",i)}},"9a14":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"gld-workload"},["edit"===t.mode?i("af-select-page-cell",{attrs:{id:"gld-worload",label:"工程量清单",value:t.value,title:"添加工程量清单",data:t.list,"show-search":!1,multi:t.multi,"value-review-tpl":"","key-map":t.keyMap,"multi-texts":t.valueObj},on:{load:t.load,input:t.input,clickMultiItem:t.openFile},scopedSlots:t._u([{key:"multiTextBefore",fn:function(e){var o=e.index;return[i("span",{staticClass:"file-icon abs"},[i("i",{staticClass:"icon__file iconfont icon-_unknow-type"}),i("i",{staticClass:"icon__delete iconfont icon-_shanchu-",on:{click:function(e){e.stopPropagation(),t.deleteItem(o)}}})])]}}])},[i("template",{slot:"item-before"},[i("span",{staticClass:"file-icon"},[i("i",{staticClass:"icon__file iconfont icon-_unknow-type"})])])],2):i("div",[i("van-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("van-collapse-item",{attrs:{name:"default"}},[i("template",{slot:"title"},[t._v("\n          工程量清单 ("+t._s(t.valueObj.length)+")\n        ")]),i("div",{staticClass:"view-list"},t._l(t.valueObj,(function(e,o){return i("div",{key:o,staticClass:"item",on:{click:function(i){t.openFile(e)}}},[i("span",{staticClass:"file-icon abs"},[i("i",{staticClass:"icon__file iconfont icon-_unknow-type"})]),i("div",{staticClass:"label"},[t._v(t._s(e.text))]),i("div",{staticClass:"tip"},[t._v(t._s(e.subtext))]),"1"===e.__orgOption.has_reformulate_log?i("span",{staticClass:"gld-history-btn",on:{click:function(i){i.stopPropagation(),t.openHistoryPopup(e)}}},[t._v("历史版本")]):t._e()])})))],2)],1),t.editable?i("div",{staticClass:"description"},[t._v("*注意：如需修订工程量清单请使用电脑登录工程协同网页进行操作。")]):t._e(),i("popup-page",{directives:[{name:"phy-back",rawName:"v-phy-back",value:{status:t.showHistoryPopup,method:"closeHistoryPopup"},expression:"{status: showHistoryPopup, method: 'closeHistoryPopup'}"}],model:{value:t.showHistoryPopup,callback:function(e){t.showHistoryPopup=e},expression:"showHistoryPopup"}},[i("v-header",{attrs:{slot:"header",title:"历史版本","back-action":t.closeHistoryPopup},slot:"header"}),i("div",{staticClass:"view-list history-view-list"},t._l(t.curHistoryList,(function(e,o){return i("div",{key:o,staticClass:"item",on:{click:function(i){t.openFile(e)}}},[i("span",{staticClass:"file-icon abs"},[i("i",{staticClass:"icon__file iconfont icon-_unknow-type"})]),i("div",{staticClass:"label"},[t._v(t._s(e.text))]),i("div",{staticClass:"tip"},[t._v(t._s(e.subtext))]),i("div",{staticClass:"time"},[t._v(t._s(e.time))])])})))],1)],1)],1)},a=[],n=(i("5289"),i("fd50")),r=(i("ac67"),i("1bc7"),i("32ea"),i("34f5")),s=i("ab3e"),l=i("da71");function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){Object(r["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var d=function(t){return Object(s["a"])({url:l["a"].gld_get_gld_workload_list,data:u({showLoading:!0},t)})},p=function(t){return Object(s["a"])({url:l["a"].gld_get_gld_workload_download_link,data:u({showLoading:!0},t)})},f=function(t){return Object(s["a"])({url:l["a"].get_gld_workload_log_list,data:u({showLoading:!0},t)})},b=i("a783"),v={name:"GldWorkload",inheritAttrs:!1,props:{mode:{type:String,default:"edit"},multi:{type:Boolean,default:!0},isRequire:{type:Boolean,default:!1},beforeEdit:{type:Function,default:function(){return!0}},data:{type:Array,default:function(){return[]}}},data:function(){return{store:b["a"],keyMap:{id:"id",name:"text",label:"subtext",value:"id"},list:[],valueObj:[],activeNames:["default"],showHistoryPopup:!1,curHistoryList:[]}},provide:function(){return{beforeClick:this.beforeGetData}},computed:{value:function(){return this.valueObj.map((function(t){var e=t.id;return e}))},editable:function(){return this.valueObj.some((function(t){return t.__orgOption.action&&!!t.__orgOption.action.length}))}},watch:{data:{handler:function(t){this.valueObj=t.map((function(t){var e=t.gld_fileid,i=t.file_name,o=t.gld_create_time;return{id:e,value:e,text:i,subtext:o,__orgOption:t}}))},immediate:!0}},mounted:function(){},methods:{input:function(t,e){this.valueObj=e},load:function(){this.getData()},beforeGetData:function(){return this.beforeEdit()?this.getBizData():n["a"].reject(null)},getBizData:function(){var t=this;return d({biz_type:this.store.bizType,change_type:this.store.changeType,contract_id:this.store.contracts[0]?this.store.contracts[0].contract_id:""}).then((function(e){var i=e.data,o=i.map((function(t){var e=t.gld_fileid,i=t.file_name,o=t.gld_create_time;return{id:e,value:e,text:i,subtext:o,__orgOption:t}}));return t.list=o,{list:o,total:o.length}})).catch((function(t){console.error(t)}))},deleteItem:function(t){this.valueObj.splice(t,1)},openFile:function(t){var e=this,i=t.id;return p({gld_fileid:i}).then((function(t){var i=t.data,o=i.link;console.log(i.link),e.OPEN_NEW_FILE(o)}))},getData:function(){return this.valueObj.map((function(t){return t.__orgOption}))},validateRequirement:function(){var t={flag:!0,msg:""};return this.isRequire&&0===this.valueObj.length&&(t={flag:!1,msg:"广联达工程量清单不可为空"}),t},openHistoryPopup:function(t){var e=this;return f({biz_id:t.__orgOption.biz_id,workload_id:t.__orgOption.workload_id}).then((function(t){var i=t.data;e.showHistoryPopup=!0,e.curHistoryList=(i||[]).map((function(t){var e=t.gld_fileid,i=t.file_name,o=t.user_name,a=t.update_time;return{id:e,value:e,text:i,subtext:o,time:a,__orgOption:t}}))}))},closeHistoryPopup:function(){this.showHistoryPopup=!1}}},_=v,g=(i("2465"),i("5d22")),m=Object(g["a"])(_,o,a,!1,null,"5de7668b",null);e["a"]=m.exports},"9f96":function(t,e,i){var o=i("1c35");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var a=i("85cb").default;a("b8b0fa8a",o,!0,{sourceMap:!1,shadowMode:!1})}}]);