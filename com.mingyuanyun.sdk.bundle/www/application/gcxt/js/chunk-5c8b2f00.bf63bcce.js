(window["webpackJsonp_module_entry_gcxt_"]=window["webpackJsonp_module_entry_gcxt_"]||[]).push([["chunk-5c8b2f00"],{"13a0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:"slide-right"}},[r("page",[r("template",{slot:"header"},[r("v-header",{attrs:{title:"项目充值","back-action":e.goBack}}),r("xt-wizard",{staticClass:"xt-wizard-wrapper",attrs:{wizard:e.pageList,current:e.curWizard}})],1),"main"===e.page?[e.companyList.length?r("div",{staticClass:"kv-list kv-ml-list kv-radio-list pic-list",attrs:{id:"yf_list"}},[r("ul",e._l(e.companyList,(function(t,a){return r("li",{key:a,class:{selected:e.selectedCompany.yf_company_guid==t.yf_company_guid&&e.selectedCompany.yf_company==t.yf_company},on:{click:function(a){e.selectCompany(t)}}},[r("div",{staticClass:"ii bb"},[r("div",{staticClass:"kv"},[r("div",{staticClass:"v"},[r("dl",[r("dt",[e._v(e._s(t.yf_company))])])]),r("div",{staticClass:"iconfont icon_selected icon-_xuanzhong"})])])])})))]):e.companyList.length&&e.companyListLoaded?r("div",{staticClass:"empty-list"},[r("img",{staticStyle:{width:"150px"},attrs:{src:a("6d8b")}}),r("span",{staticClass:"empty-text"},[e._v("没有找到您有合同权限的乙方单位~")]),r("button",{staticClass:"button button-fill",attrs:{id:"empty-btn"}},[e._v("\n          申请合同权限\n        ")])]):e._e()]:"page_proj"===e.page?[r("div",{staticClass:"usePeriod-contain"},[r("i",{staticClass:"usePeriod-circle usePeriod-valid"}),r("span",{staticClass:"usePeriod-text"},[e._v("已购买")]),r("i",{staticClass:"usePeriod-circle usePeriod-never"}),r("span",{staticClass:"usePeriod-text"},[e._v("未购买")]),r("i",{staticClass:"usePeriod-circle usePeriod-overdue"}),r("span",{staticClass:"usePeriod-text"},[e._v("已过期")])]),r("project-tree",{attrs:{list:e.projectList,"select-handle":e.selectedProjectHandle}})]:"page_confirm"===e.page?[r("div",{attrs:{id:"confirm_contain"}},[r("div",{staticClass:"recharge-confirm"},[r("div",{staticClass:"fz-13"},[e._v("是否确认充值给")]),r("div",[r("div",{staticClass:"recharge-target mt-10"},[e._v("\n              "+e._s(e.selectedCompany.yf_company)+"\n            ")]),r("div",{staticClass:"recharge-target mt-10"},[e._v("\n              "+e._s(e.selectProject.project_name)+"\n            ")])])]),r("div",{staticClass:"pl-15 pr-15 mt-20"},[r("app-button",{on:{click:e.btnConfirm}},[e._v("确认充值")])],1)])]:"page_success"===e.page?[r("div",{attrs:{id:"success_contain"}},[r("div",{staticClass:"recharge-success"},[r("div",{staticClass:"recharge-head"},[r("i",{staticClass:"iconfont icon-success"}),r("span",{staticClass:"recharge-title"},[e._v("恭喜您, 充值成功!")])]),r("div",{staticClass:"mt-10"},[r("div",{staticClass:"recharge-target"},[e._v("\n              "+e._s(e.selectedCompany.yf_company)+"-"+e._s(e.selectProject.project_name)+"\n            ")]),r("div",{staticClass:"recharge-target"},[e._v("到期时间为: "+e._s(e.expire_time))])])]),r("div",{staticClass:"pl-15 pr-15 mt-15"},[r("app-button",{on:{click:e.goBack}},[e._v("完成")])],1)])]:e._e(),["main","page_proj"].includes(e.page)?r("app-button-group",{attrs:{slot:"footer"},slot:"footer"},[r("app-button",{on:{click:e.next}},[e._v("下一步")])],1):e._e()],2)],1)},o=[],i=(a("ac67"),a("32ea"),a("1bc7"),a("6a61"),a("ed32")),n=a("34f5"),c=a("4ae5"),s=a("b098"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"proj_contain"},e._l(e.list,(function(t,r){return a("div",{key:r,staticClass:"proj-block"},[a("div",{staticClass:"ProjTree-root bb bt ProjTree-fold",class:{selected:e.selected.project_id==t.project_id},on:{click:function(a){e.selecteItem(t)}}},[a("div",{staticClass:"ProjTree-sticker",class:t.sticker_class}),a("i",{staticClass:"icon icon-down ProjTree-icon",class:{"icon-up":e.unfold&&e.unfoldSelected.project_id==t.project_id}}),a("div",{staticClass:"ProjTree-text"},[a("div",{staticClass:"ProjTree-name"},[a("span",[e._v(e._s(t.project_name))]),t.contract_count?a("span",{staticClass:"ProjTree-count"},[e._v("("+e._s(t.contract_count)+")")]):e._e()]),!t.multi_company&&t.expire_date?a("div",{staticClass:"ProjTree-time mt-5",class:{"usePeriod-warning-text":t.is_overdue}},[t.is_overdue?a("span",[e._v("过期时间: "+e._s(t.expire_date))]):a("span",[e._v("到期时间: "+e._s(t.expire_date))])]):e._e()]),a("i",{staticClass:"usePeriod-circle usePeriod-warning"}),t.selectable?a("i",{staticClass:"iconfont icon_selected icon-_xuanzhong"}):"项目"===t.charge_mode&&t.multi_company?a("i",{staticClass:"iconfont icon-projdetail ProjTree-detail"}):e._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.unfold&&e.unfoldSelected.project_id==t.project_id,expression:"unfold && unfoldSelected.project_id == v.project_id"}]},e._l(t.projects,(function(r,o){return a("div",{key:o,staticClass:"ProjTree-node bb",class:{indent:!r.contracts&&t.projects.length!=o+1}},[t.project_id==r.project_id?[a("div")]:[a("div",{staticClass:"ProjTree-name"},[e._v(e._s(r.project_name))])]],2)})))])})))},l=[],p={name:"ProjectTree",props:{list:{type:Array,default:function(){return[]}},selectHandle:{type:Function,default:function(){}}},data:function(){return{selected:{},unfoldSelected:{},unfold:!1}},methods:{selectRoot:function(e){this.selected=e,this.selectHandle(e)},selecteItem:function(e){e.project_id!=this.unfoldSelected.project_id?(this.unfold=!this.unfold,this.unfoldSelected=e):this.unfold=!this.unfold,this.selectRoot(e)}}},u=p,f=(a("8fa1"),a("5d22")),g=Object(f["a"])(u,d,l,!1,null,"9aafe78e",null),m=g.exports,_=a("f2de"),v=a("dbf5"),x=a("d3d0"),b=a("5782"),h=a("1cd7"),y=a("e717"),j=a("8b44"),P=a("6485"),C=a("a18c");function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var T={name:"SelectProj",components:{NoRecord:P["a"],XtWizard:j["a"],AppButtonGroup:y["a"],VHeader:h["a"],AppButton:b["a"],Wizard:s["a"],ProjectTree:m},data:function(){return{page:"main",pageList:[{key:"main",name:"确认乙方单位"},{key:"page_proj",name:"确认项目"},{key:"page_confirm",name:"充值"}],companyList:[],urlParams:{},pageIndex:0,footerButton:!0,selectedCompany:{},selectProject:{},projectList:[],expire_time:"",companyListLoaded:!1}},computed:w({pageMap:function(){return this.pageList.reduce((function(e,t,a){return e[t.key]=w(w({},t),{},{index:a}),e}),{})},curPageIndex:function(){return this.pageMap[this.page].index},curWizard:function(){var e={main:0,page_proj:1,page_confirm:2,page_success:2};return e[this.page]}},Object(_["b"])({userinfo:function(e){return e.userInfo.data},cur_tenant:function(e){return e.userInfo.tenantInfo},role_code:function(e){return e.userInfo.tenantInfo.role_code}})),mounted:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.urlParams=this.$route.query,e.next=3,this.getPersonRechargeList();case 3:this.companyListLoaded=!0;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{next:function(){switch(this.page){case"main":this.toProj();break;case"page_proj":this.toPageConfirm();break}},prev:function(){switch(this.page){case"main":C["a"].back();break}},getPersonRechargeList:function(){var e=this;return this.$store.dispatch(c["l"],{role_code:this.role_code,page_index:this.pageIndex}).then((function(t){e.companyList=t.data,e.footerButton=!1}))},selectCompany:function(e){this.selectedCompany=e},selectedProjectHandle:function(e){this.selectProject=e},toProj:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.selectedCompany.yf_company||this.selectedCompany.yf_company_guid){e.next=3;break}return this.sui.toast("请选择乙方公司"),e.abrupt("return",!1);case 3:return e.next=5,this.getChargeProjectList();case 5:this.page="page_proj";case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),toPageConfirm:function(){if(!this.selectProject.project_id)return this.sui.toast("请选择充值对象"),!1;this.goNext()},getChargeProjectList:function(){var e=this;return this.$store.dispatch(c["m"],{yf_company_guid:this.selectedCompany.yf_company_guid}).then((function(t){e.projectList=e.handleProjectList(t.data)}))},_addProp:function(e){var t=e.item,a=e.config||[];a.forEach((function(e){var a=e.srcKey,r=e.destKey,o=e.callback||function(){};t.hasOwnProperty(a)?t[r]=t[a]:o(t)}))},handleProjectList:function(e){var t=this;return e.forEach((function(e){t._addProp({item:e,config:[{srcKey:"overdue",destKey:"is_overdue",callback:function(e){try{var t=e.yf_companies;e.is_overdue=t.every((function(e){return e.overdue}))}catch(a){console.log(a)}}},{srcKey:"expire_time",destKey:"expire_date",callback:function(e){try{var t=e.yf_companies;1===t.length&&(e.expire_date=t[0].expire_time)}catch(a){console.log(a)}}}]}),e.expire_date&&(e.expire_date=v["a"].format(e.expire_date,"yyyy-MM-dd")),e.selectable=!0,e.sticker_class=t.createPeriodClass(e)})),e},createPeriodClass:function(e){return e.expire_date?e.is_overdue?"usePeriod-overdue":"usePeriod-valid":"usePeriod-never"},btnConfirm:function(){var e=this,t={card_no:this.urlParams.card_no,card_id:this.urlParams.card_id,indent_id:this.urlParams.indent_id,yf_company_guid:this.selectedCompany.yf_company_guid,yf_company:this.selectedCompany.yf_company,charge_project_id:this.selectProject.project_id};this.$store.dispatch(c["n"],t).then((function(t){e.$store.dispatch(x["a"],{showLoading:!1}).then((function(a){e.expire_time=t.data.expire_time,e.page="page_success"}))}))},goBack:function(){switch(this.page){case"main":case"page_success":this.$router.go(-1);break;default:var e=this.curPageIndex;this.page=this.pageList[e-1].key}},goNext:function(){var e=this.curPageIndex;this.page=this.pageList[e+1].key}}},L=T,O=(a("1e6b"),Object(f["a"])(L,r,o,!1,null,"75e9b373",null));t["default"]=O.exports},"1e6b":function(e,t,a){"use strict";a("eca1")},"6d8b":function(e,t,a){e.exports=a.p+"img/no-yf-company.892de8cd.png"},"727b":function(e,t,a){t=e.exports=a("690e")(!1),t.push([e.i,'.gcxt[data-v-9aafe78e] :export{colorPrimary:#0268b3;headerBackgroundColor:#fff;headerTextColor:#333}.gcxt .ProjTree-root[data-v-9aafe78e]{margin-top:15px;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-right:10px;background:#fff}.gcxt .proj_contain .proj-block:first-child .ProjTree-root[data-v-9aafe78e]{margin-top:0}.gcxt .ProjTree-root .ProjTree-sticker[data-v-9aafe78e]{position:absolute;top:0;bottom:0;left:0;width:8px}.gcxt .ProjTree-root .icon-down[data-v-9aafe78e],.gcxt .ProjTree-root .icon-up[data-v-9aafe78e]{position:absolute;top:10px;margin-left:16px}.gcxt .ProjTree-root .ProjTree-text[data-v-9aafe78e]{-webkit-box-flex:1;-ms-flex:1;flex:1;padding:10px 0;margin-left:40px}.gcxt .ProjTree-root .ProjTree-text.ml-20[data-v-9aafe78e]{margin-left:20px}.gcxt .ProjTree-root .ProjTree-name[data-v-9aafe78e]{color:#333;font-size:16px}.gcxt .ProjTree-root .ProjTree-count[data-v-9aafe78e]{color:#8b8b8b}.gcxt .ProjTree-root .ProjTree-time[data-v-9aafe78e]{color:#7b7b7b}.gcxt .ProjTree-root .radio-select[data-v-9aafe78e]{margin-left:5px;-ms-flex-negative:0;flex-shrink:0}.gcxt .ProjTree-root .radio-select[data-v-9aafe78e]:after{font-size:1rem;content:"\\E607";color:#b5b5b5}.gcxt .ProjTree-root.selected .radio-select[data-v-9aafe78e]:after{content:"\\E609";color:#0268b3}.gcxt .ProjTree-root .ProjTree-detail[data-v-9aafe78e]{margin-left:5px;font-size:20px;color:#0268b3}.gcxt .ProjTree-root .usePeriod-circle[data-v-9aafe78e]{margin-left:5px;display:none}.gcxt .ProjTree-node[data-v-9aafe78e]{position:relative;padding:15px 10px;padding-left:40px;background:#f6fafe}.gcxt .ProjTree-node[data-v-9aafe78e]:before{content:"";position:absolute;top:50%;margin-top:-.2rem;margin-left:-16px;width:.4rem;height:.4rem;border-radius:50%;background:#bebebe}.gcxt .ProjTree-node .ProjTree-name[data-v-9aafe78e]{color:#69696a}.gcxt .ProjTree-node.indent[data-v-9aafe78e]:after{left:24px;right:0;width:auto}.gcxt .ProjTree-leaf[data-v-9aafe78e]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:15px 10px;padding-left:40px;background:#f6fafe}.gcxt .ProjTree-leaf.indent[data-v-9aafe78e]:after{left:30px;right:0;width:auto}.gcxt .ProjTree-leaf .icon-hetong1[data-v-9aafe78e]{color:#0268b3;font-size:20px}.gcxt .ProjTree-leaf .ProjTree-name[data-v-9aafe78e]{color:#7b7b7b;margin-left:10px}.gcxt .hide[data-v-9aafe78e]{display:none!important}.gcxt .icon_selected[data-v-9aafe78e]{color:#0268b3}.gcxt .ProjTree-root:not(.selected) .icon_selected[data-v-9aafe78e]{opacity:0}',""])},"741f":function(e,t,a){t=e.exports=a("690e")(!1),t.push([e.i,".gcxt[data-v-75e9b373] :export{colorPrimary:#0268b3;headerBackgroundColor:#fff;headerTextColor:#333}.gcxt .kv .v[data-v-75e9b373]{padding-right:.25rem}.gcxt .kv .v dt[data-v-75e9b373]{line-height:1.2!important}.gcxt .content[data-v-75e9b373]{padding-top:80px}.gcxt #page_proj .content[data-v-75e9b373]{padding-top:120px}.gcxt .usePeriod-contain[data-v-75e9b373]{margin-bottom:10px;width:100%}.gcxt .guideline[data-v-75e9b373]{position:absolute;top:0;background:#fff;width:100%}.gcxt #proj_contain[data-v-75e9b373],.gcxt #yf_list[data-v-75e9b373]{height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.gcxt #yf_list .ii[data-v-75e9b373]{padding:.75rem;margin-left:0}.gcxt footer.bar-tab .tab-item[data-v-75e9b373]{color:#fff;background:#3492e9}.gcxt footer.bar-tab .tab-item.action[data-v-75e9b373]{background-color:#3fa3ff}.gcxt .empty-list[data-v-75e9b373]{display:block}.gcxt .empty-list .empty-text[data-v-75e9b373]{margin-top:1rem}.gcxt .empty-list .button.button-fill[data-v-75e9b373]{margin:0 auto;margin-top:30px;padding:0 20px}.gcxt .action-footer[data-v-75e9b373]{padding:5px 15px}.gcxt .xt-wizard-wrapper[data-v-75e9b373]{margin-bottom:10px}.gcxt .icon_selected[data-v-75e9b373]{color:#0268b3}.gcxt li:not(.selected) .icon_selected[data-v-75e9b373]{opacity:0}",""])},"8fa1":function(e,t,a){"use strict";a("f213")},b098:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xt_wizard",staticStyle:{margin:"0 1rem"}},e._l(e.navitems,(function(t,r){return a("span",{key:r,staticClass:"nav_step",class:{selected:e.curstep==r},domProps:{textContent:e._s(t)}})})))},o=[],i={name:"Wizard",props:{curstep:String,navitems:{type:Array,default:function(){return[]},required:!0}}},n=i,c=a("5d22"),s=Object(c["a"])(n,r,o,!1,null,null,null);t["a"]=s.exports},eca1:function(e,t,a){var r=a("741f");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var o=a("85cb").default;o("3eaf69c3",r,!0,{sourceMap:!1,shadowMode:!1})},f213:function(e,t,a){var r=a("727b");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var o=a("85cb").default;o("139ba0dc",r,!0,{sourceMap:!1,shadowMode:!1})}}]);