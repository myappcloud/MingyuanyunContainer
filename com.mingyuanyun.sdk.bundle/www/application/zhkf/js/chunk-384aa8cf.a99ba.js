(window["webpackJsonp_module_entry_zhkf_"]=window["webpackJsonp_module_entry_zhkf_"]||[]).push([["chunk-384aa8cf"],{"0523":function(t,n,o){"use strict";o("6d57");var e=o("c6e3"),a=o("fd50"),i=o("a654"),r=o("c2c1"),s=o("8ae6"),c=function(t){return e["a"].getRoomBaseInfo(t)},l=function(t){return e["a"].getRoomCustomer(t)},f=function(t,n,o){var e,a={batch_unit_id:t,unit_list:[]},i="0";(_.isEmpty(n)||1===n.length&&""===n[0])&&(e=!0,n=[i]);var r={unit:[""],floor_list:[],status_counter:{all:0}};a.unit_list.push(r);for(var s=0;s<n.length;s++){var c=n[s],l={floor:c,room_list:[]};r.floor_list.push(l);for(var f=0;f<o.length;f++){var d=o[f];!e&&d.floor!=c||d.batch_unit_id!=t||(d.floor=e?i:d.floor,l.room_list.push(d),r.status_counter["all"]+=1,d.room_status in r.status_counter?r.status_counter[d.room_status]+=1:r.status_counter[d.room_status]=1)}}return a},d=function(t){return e["a"].getRoomIsReviewed(t)},u=function(t){return e["a"].getRoomTypeDiagram(t).then((function(t){if(!t)return!1;var n=a["a"].when(!1);return t.forEach((function(t){n=n.then((function(n){return n?a["a"].resolve(!0):r["a"].checkFileIsExists(Object(s["e"])()+t.path)}))})),n}))},m=function(t){return e["a"].getDiagramById(t).then((function(t){if(t){if("dev"==window.ZHKF_GLOBAL_ENV.VUE_APP_ENV)return t.url;var n=Object(s["e"])()+t.path;return console.log(n,"========================"),r["a"].checkFileIsExists(n).then((function(t){return t?n:null}))}return null}))},p=function(t){try{return u(t).catch((function(){return!1})).then((function(t){return!!t}))}catch(n){return console.error(n),a["a"].when(!1)}},h=function(t){return i["a"].existsDesignChange(t)},g=function(t){return i["a"].getDesignChange(t)},v=function(t,n){return i["a"].addDesignChangeProblem(t,n)},b=function(t){return c(t).then((function(t){return t.building_name+(t.unit?t.unit+(t.unit.indexOf("单元")>-1?"":"单元"):"")+(-1==t.floor.indexOf("层")&&-1==t.floor.indexOf("楼")&&-1==t.floor.indexOf("公共区域")?t.floor+"楼":t.floor)+(-1!==t.room_no.indexOf("公共区域")?t.floor+"层 公共区域":t.room_no)}))};n["a"]={getRoomBaseInfo:c,getRoomCustomer:l,buildRoomListData:f,getRoomIsReviewed:d,getRoomTypeImageFileIsExists:u,getRoomTypeImageFileIsExistsIgnoreError:p,existsRoomDesignChange:h,getRoomDesignChange:g,addRoomDesignChangeProblem:v,getRoomTitle:b,getDiagramFullPathById:m,getBatchRoomList:function(t,n){return e["a"].getBatchRoomList(t,n)}}},"0a37":function(t,n,o){var e=o("1c4e");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var a=o("85cb").default;a("76d9ba51",e,!0,{})},"1c4e":function(t,n,o){n=t.exports=o("690e")(!1),n.push([t.i,"\n.zhkf .tip[data-v-829243a6] {\n  width: 250px;\n  text-align: center;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n.zhkf .tip img[data-v-829243a6] {\n    width: 200px;\n}\n.zhkf .tip p[data-v-829243a6] {\n    color: #a0a0a0;\n    line-height: 20px;\n    font-size: 14px;\n    margin: 0 auto;\n    text-align: center;\n    margin-top: 3px;\n}\n",""])},2405:function(t,n,o){var e=o("7826");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var a=o("85cb").default;a("e652a6ca",e,!0,{})},"3f4d":function(t,n,o){"use strict";o.r(n);o("5ab2"),o("6d57"),o("e44b"),o("e10e"),o("f0e6");var e=o("28f8"),a=o("5cf9"),i=o("9f72"),r=o("c42d"),s=o("c2c1"),c=o("db55"),l=(o("cc57"),o("6013")),f=function(){var t={},n={setConditions:function(n){t.conditions={batch_id:n.batchId,room_id:n.roomId,process_id:n.processId}}};return{model:t,setConditions:function(t){return n.setConditions(t)},init:function(){return t.sourseData=c["a"].model.sourseData,l["a"].getProcessOperateLog(t.conditions).then((function(n){for(var o=[],e=0;e<n.length;e++){var a=n[e],i={id:t.conditions.process_id,operate_date:a.operate_date,operate_user:a.operate_user,name:t.sourseData[t.conditions.process_id].name,child_process:[],reason:a.reason,remark:a.remark};a.imgs&&(i["imgs"]=a.imgs);for(var r=0;r<a.child_process.length;r++){var s=a.child_process[r],c=t.sourseData[t.conditions.process_id].child_process[s.id],l={id:s.id,status:s.status,name:c.name,remark:c.remark,type:c.type};i.child_process.push(l)}o.push(i)}return o}))}}}(),d=o("f2de");function u(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),o.push.apply(o,e)}return o}function m(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?u(Object(o),!0).forEach((function(n){Object(e["a"])(t,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))}))}return t}var p={components:{Tip:a["a"],Top:i["a"]},data:function(){return{data:[],hasNetwork:!0,customers:[],roomName:""}},computed:m({},Object(d["e"])({deliveryConfig:function(t){return t.app.deliveryConfig}})),activated:function(){var t=this,n=c["a"].model.baseInfo;this.customers=n.customers||[],this.roomName=n.room_name||"",f.setConditions(this.$route.query),r["a"].getHasNetwork().then((function(n){console.log("========= hasNetwork ===========",n),t.hasNetwork=n,n&&(t.$toast.loading({mask:!0,message:"加载中...",duration:0}),f.init().then((function(n){console.log(n),t.data=n,console.log(t.data)})).finally((function(){t.$toast.clear()})))}))},methods:{showLargeImg:function(t,n){s["a"].openImageBrowser(t,n)}}},h=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"room-log"},[e("cus-nav-bar",{attrs:{title:"办理记录","left-arrow":"",border:!1}}),t._v(" "),e("div",{staticClass:"content"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.hasNetwork,expression:"!hasNetwork"}],staticClass:"tipBox"},[e("tip",{attrs:{"img-url":o("eac3"),"tip-cont":"当前网络异常，请稍后重试"}})],1),t._v(" "),e("top",{attrs:{customers:t.customers,"room-name":t.roomName}}),t._v(" "),t._l(t.data,(function(n,o){return e("div",{key:o,staticClass:"content-panel"},[e("div",{staticClass:"panel-nav van-hairline--bottom"},[e("i",{staticClass:"nav-icon"}),t._v(" "),e("div",{staticClass:"nav-title f15"},[t._v("办理人："+t._s(n.operate_user))]),t._v(" "),e("div",{staticClass:"nav-value f12"},[t._v("\n办理时间："+t._s(n.operate_date?n.operate_date.substr(0,16):"")+"\n")])]),t._v(" "),"交付确认"!=n.name?e("div",{staticClass:"panel-item-list"},t._l(n.child_process,(function(n,o){return e("van-cell",{key:o,staticClass:"panel-item",attrs:{title:n.name}},[[2==n.status?e("span",{staticClass:"unfinish f13"},[t._v("未"+t._s(n.type))]):t._e(),t._v(" "),1==n.status?e("span",{staticClass:"finish f13"},[t._v("已"+t._s(n.type))]):t._e()]],2)})),1):t._e(),t._v(" "),n.reason?e("div",{staticClass:"panel-log"},[e("div",{staticClass:"log-title"},[t._v("\n"+t._s("交付确认"==n.name?t.deliveryConfig.reject_delivery.text+"原因":"重新办理原因")+"\n")]),t._v(" "),e("div",{staticClass:"log-value"},[t._v(t._s(n.reason)+" ；"+t._s(n.remark))])]):t._e(),t._v(" "),n.imgs&&n.imgs.length?e("div",{staticClass:"panel-log"},[e("div",{staticClass:"log-title"},[t._v("已交付凭证")]),t._v(" "),e("ul",{staticClass:"log-image-list"},t._l(n.imgs,(function(o,a){return e("li",{key:a,on:{click:function(o){return t.showLargeImg(n.imgs,a)}}},[e("img",{attrs:{src:o}})])})),0)]):t._e()])}))],2)],1)},g=[],v=o("d082");function _(t){o("fed9")}var b=!1,x=_,y="data-v-277b27b2",k=null,w=Object(v["a"])(p,h,g,b,x,y,k);n["default"]=w.exports},"5cf9":function(t,n,o){"use strict";var e={props:{isShow:{type:Boolean,default:!0},imgUrl:{type:String,required:!0},tipCont:{type:String,default:"系统繁忙请稍后重试"}}},a=function(){var t=this,n=t.$createElement,o=t._self._c||n;return o("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"tip"},[o("img",{attrs:{src:t.imgUrl,alt:"tip"}}),t._v(" "),t.tipCont?o("p",{domProps:{innerHTML:t._s(t.tipCont)}}):t._e()])},i=[],r=o("d082");function s(t){o("0a37")}var c=!1,l=s,f="data-v-829243a6",d=null,u=Object(r["a"])(e,a,i,c,l,f,d);n["a"]=u.exports},6013:function(t,n,o){"use strict";var e=o("07a4"),a=o("dfb1"),i=o("81ad"),r=o("c6e3"),s=o("9430"),c=o("a14a"),l=o.n(c),f={getDeliveryNodeList:function(){return a["a"].getDeliveryNodeList(e["a"].state.projectList.currentItem.id)},getTodoDeliveryDetail:function(t){return a["a"].getTodoDeliveryDetail(t)},uploadDeliveryConfirmInfo:function(t,n,o){return i["a"].uploadFiles(t,"deliveryProcess",n.room_id).then((function(t){console.log(t),t=l.a.uniq(t);var e={child_process:[{id:o,status:1,imgs:t}],reason:"",remark:""};return e=l.a.extend(e,n),a["a"].uploadProcessData(e)}))},uploadProcessData:function(t){return a["a"].uploadProcessData(t)},getProcessOperateLog:function(t){return a["a"].getProcessOperateLog(t)},getDeliveryConfirmInfo:function(t,n,o){return a["a"].getDeliveryConfirmInfo(t,n,o)},getRoomData:function(t,n){return r["a"].getBatchRoom(t,n)},assistSignIn:function(t){return a["a"].assistSignIn(t)},hasUploadData:function(t){return s["a"].existsBatchRoomUploadData(t)}};n["a"]=f},7826:function(t,n,o){n=t.exports=o("690e")(!1),n.push([t.i,"\n.zhkf .color-green[data-v-030d81df] {\n  color: #74c913;\n}\n.zhkf .color-orange[data-v-030d81df] {\n  color: #ff8100;\n}\n.zhkf .cutomer-info[data-v-030d81df] {\n  padding: 15px;\n  font-size: 15px;\n  background: #ffffff;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n}\n.zhkf .cutomer-info .info-column[data-v-030d81df] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: row;\n            flex-direction: row;\n    line-height: 1;\n}\n.zhkf .cutomer-info .info-column .right-item[data-v-030d81df] {\n      margin-bottom: 20px;\n}\n.zhkf .cutomer-info .info-column .right-item[data-v-030d81df]:last-child {\n        margin-bottom: 0;\n}\n.zhkf .cutomer-info .info-column[data-v-030d81df]:not(:first-child) {\n    margin-top: 18px;\n}\n.zhkf .cutomer-info .item-left[data-v-030d81df] {\n    color: #a0a0a0;\n}\n.zhkf .cutomer-info .item-right[data-v-030d81df] {\n    margin-left: 20px;\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n}\n.zhkf .cutomer-info .item-right span[data-v-030d81df] {\n      color: #a0a0a0;\n}\n.zhkf .cutomer-info .item-right a[data-v-030d81df] {\n      color: #0099ff;\n}\n.zhkf .cutomer-info .item-right > div[data-v-030d81df]:not(:first-child) {\n      margin-top: 20px;\n}\n.zhkf .cutomer-info .icon-tip[data-v-030d81df] {\n    color: #ff8100;\n}\n",""])},"7d17":function(t,n,o){n=t.exports=o("690e")(!1),n.push([t.i,"\n.zhkf .flex[data-v-277b27b2] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.zhkf .tipBox[data-v-277b27b2] {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n  background: #fff;\n}\n.zhkf .room-log[data-v-277b27b2] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.zhkf .room-log .content[data-v-277b27b2] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n    height: 100%;\n    overflow: scroll;\n    font-size: 15px;\n}\n.zhkf .room-log .content .content-top[data-v-277b27b2] {\n      padding: 15px;\n      background: #ffffff;\n}\n.zhkf .room-log .content .content-top .content-top-column[data-v-277b27b2] {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-orient: horizontal;\n        -webkit-box-direction: normal;\n            -ms-flex-direction: row;\n                flex-direction: row;\n}\n.zhkf .room-log .content .content-top .content-top-column[data-v-277b27b2]:not(:first-child) {\n        margin-top: 20px;\n}\n.zhkf .room-log .content .content-top .item-left[data-v-277b27b2] {\n        color: #a0a0a0;\n}\n.zhkf .room-log .content .content-top .item-right[data-v-277b27b2] {\n        margin-left: 20px;\n}\n.zhkf .room-log .content .content-top .item-right span[data-v-277b27b2] {\n          color: #a0a0a0;\n}\n.zhkf .room-log .content .content-top .item-right > div[data-v-277b27b2]:not(:first-child) {\n          margin-top: 20px;\n}\n.zhkf .room-log .content .content-top .icon-tip[data-v-277b27b2] {\n        color: #ff8100;\n}\n.zhkf .room-log .content .content-panel[data-v-277b27b2] {\n      background: #ffffff;\n      margin-top: 10px;\n      z-index: 0;\n}\n.zhkf .room-log .content .content-panel .panel-nav[data-v-277b27b2] {\n        width: 100%;\n        height: 51px;\n        padding: 18px 15px;\n        color: #202020;\n        line-height: 15px;\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n}\n.zhkf .room-log .content .content-panel .panel-nav .nav-icon[data-v-277b27b2] {\n          background: -webkit-gradient(linear, left top, left bottom, from(#0099ff), to(#1cb0fd));\n          background: linear-gradient(#0099ff, #1cb0fd);\n          width: 3px;\n          height: 15px;\n          border-radius: 10px;\n          margin-right: 8px;\n}\n.zhkf .room-log .content .content-panel .panel-nav .nav-title[data-v-277b27b2] {\n          margin-right: 8px;\n          -webkit-box-flex: 1;\n              -ms-flex: 1;\n                  flex: 1;\n}\n.zhkf .room-log .content .content-panel .panel-nav .nav-value[data-v-277b27b2] {\n          color: #a0a0a0;\n}\n.zhkf .room-log .content .content-panel .panel-item-list[data-v-277b27b2] {\n        width: 100%;\n        padding-left: 15px;\n}\n.zhkf .room-log .content .content-panel .panel-item-list .panel-item[data-v-277b27b2] {\n          min-height: 50px;\n          padding-left: 0;\n          color: #606060;\n          line-height: 21px;\n}\n.zhkf .room-log .content .content-panel .panel-item-list .panel-item .van-cell__title[data-v-277b27b2] {\n            max-width: 80%;\n}\n.zhkf .room-log .content .content-panel .panel-item-list .unfinish[data-v-277b27b2] {\n          color: #ff8100;\n}\n.zhkf .room-log .content .content-panel .panel-item-list .finish[data-v-277b27b2] {\n          color: #74c913;\n}\n.zhkf .room-log .content .content-panel .list-item[data-v-277b27b2] {\n        height: 50px;\n        line-height: 20px;\n}\n.zhkf .room-log .content .content-panel .item-tip[data-v-277b27b2] {\n        color: #74c913;\n}\n.zhkf .room-log .content .panel-log[data-v-277b27b2] {\n      width: 100%;\n      padding: 15px;\n      color: #606060;\n}\n.zhkf .room-log .content .panel-log .log-title[data-v-277b27b2] {\n        color: #a0a0a0;\n}\n.zhkf .room-log .content .panel-log .log-value[data-v-277b27b2] {\n        margin-top: 15px;\n        word-break: break-all;\n}\n.zhkf .room-log .content .panel-log .log-image-list[data-v-277b27b2] {\n        margin-top: 15px;\n}\n.zhkf .room-log .content .panel-log .log-image-list li[data-v-277b27b2] {\n          float: left;\n          width: 60px;\n          height: 60px;\n}\n.zhkf .room-log .content .panel-log .log-image-list li img[data-v-277b27b2] {\n            width: 100%;\n            height: 100%;\n}\n.zhkf .room-log .content .panel-log .log-image-list li[data-v-277b27b2]:not(:first-child) {\n          margin-left: 18px;\n}\n",""])},"9f72":function(t,n,o){"use strict";var e={props:{customers:{type:Array,default:function(){return[]}},roomName:{type:String,default:null},qualification:{type:String,default:""},reason:{type:String,default:""},showQualification:{type:Boolean,default:!1}}},a=function(){var t=this,n=t.$createElement,o=t._self._c||n;return o("div",{staticClass:"cutomer-info"},[o("div",{staticClass:"info-column"},[o("div",{staticClass:"item-left"},[t._v("业主姓名")]),t._v(" "),o("div",{staticClass:"item-right"},t._l(t.customers,(function(n,e){return o("div",{key:e,staticClass:"right-item"},[t._v("\n        "+t._s(n.customerName)+"\n        "),n.canDialTelphonee?t._e():o("span",[t._v(t._s(n.customerPhone))]),t._v(" "),n.canDialTelphonee?o("a",{attrs:{href:"tel:"+n.customerPhone}},[t._v(t._s(n.customerPhone))]):t._e(),t._v(" "),n.hasTag?o("i",{staticClass:"iconfont icon-xiaolian icon-tip"}):t._e()])})),0)]),t._v(" "),null!=t.roomName?o("div",{staticClass:"info-column"},[o("div",{staticClass:"item-left"},[t._v("房产名称")]),t._v(" "),o("div",{staticClass:"item-right flex"},[t._v(t._s(t.roomName))])]):t._e(),t._v(" "),t.showQualification?o("div",{staticClass:"info-column"},[o("div",{staticClass:"item-left"},[t._v("交付资格")]),t._v(" "),o("div",{staticClass:"item-right flex",class:"符合"===t.qualification?"color-green":"color-orange"},[t._v(t._s(t.qualification))])]):t._e(),t._v(" "),"不符合"===t.qualification&&t.showQualification?o("div",{staticClass:"info-column"},[o("div",{staticClass:"item-left"},[t._v("具体原因")]),t._v(" "),o("div",{staticClass:"item-right flex"},[t._v(t._s(t.reason))])]):t._e()])},i=[],r=o("d082");function s(t){o("2405")}var c=!1,l=s,f="data-v-030d81df",d=null,u=Object(r["a"])(e,a,i,c,l,f,d);n["a"]=u.exports},a654:function(t,n,o){"use strict";var e=o("1834"),a=o("0938");n["a"]={existsDesignChange:function(t){var n="select 1 from room_design_change a inner join batch_room b on a.room_id = b.room_id where b.id = ?";return e["a"].queryOne(n,[t]).then((function(t){return!_.isEmpty(t)}))},getDesignChange:function(t){var n="select a.id, a.location, a.content, a.remark, a.sort from room_design_change a inner join batch_room b on a.room_id = b.room_id where b.id = ? order by a.sort";return e["a"].query(n,[t])},addDesignChangeProblem:function(t,n){if(t&&n){var o=a["a"].uuid();e["a"].insert("room_design_change_problem",["id","design_change_id","checkroom_problem_id"],[o,n,t])}}}},db55:function(t,n,o){"use strict";o("5ab2"),o("e10e");var e=o("28f8"),a=(o("e697"),o("6d57"),o("e44b"),o("cc57"),o("fd50")),i=o("07a4"),r=o("a18c"),s=o("6013"),c=o("0523"),l=o("ca33"),f=o("a593");function d(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),o.push.apply(o,e)}return o}function u(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?d(Object(o),!0).forEach((function(n){Object(e["a"])(t,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))}))}return t}n["a"]=function(){var t={},n={},o={review_material:"delivery_review_material",handle_finance:"delivery_handle_finance",handle_property:"delivery_handle_property",check_room:"delivery_check_room",give_gift:"delivery_receive_gift",delivery_confirm:"delivery_confirm"};return n.getConditions=function(){return{batchId:t.roomInfo.batchId,roomId:t.roomInfo.room_list[t.currRoomIndex].room_id}},n.gotoNextRoom=function(){var o=t.roomInfo.room_list.length;return t.currRoomIndex<o-1?(t.currRoomIndex+=1,t.currRoom=t.roomInfo.room_list[t.currRoomIndex],n.load()):a["a"].resolve()},n.load=function(){var e=n.getConditions();return s["a"].getTodoDeliveryDetail(e).then((function(e){t.nodeList=[],t.baseInfo.delivery_qualification=e.delivery_qualification,t.baseInfo.appointment_process_list=e.appointment_process_list||[],t.baseInfo.checkroom_type=e.checkroom_type,t.baseInfo.delivery_unqualified_reason=e.delivery_unqualified_reason,t.baseInfo.hasTag=!1,t.baseInfo.room_name=t.roomInfo.room_list[t.currRoomIndex].room_name,t.baseInfo.customers=[],t.no="",_.each(e.customer_list,(function(n){t.baseInfo.customers.push({customerName:n.customer_name,customerPhone:n.customer_phone,canDialTelphonee:-1===n.customer_phone.indexOf("*"),hasTag:n.has_tag}),1==n.has_tag&&(t.baseInfo.hasTag=!0)})),e.no&&(t.no=e.no),e.signin_id&&(t.roomInfo.signin_id=e.signin_id);var a=i["a"].state.app.global.currentBatchType;_.each(t.sourseData,(function(n,i){var r={name:n.name,id:i,child_node:[],type:o[n.function_code],status:e.process[i]&&1==e.process[i].status?e.process[i].status:0,authRight:f["default"].prototype.$checkRight("view_room",a)&&f["default"].prototype.$checkRight(n.function_code,a)};_.each(n.child_process,(function(t,n){var o={name:t.name,type:t.type,remark:t.remark,id:n};e.process[i]&&1==e.process[i].status&&e.process[i].child_process[n]&&e.process[i].child_process[n].status?o["status"]=e.process[i].child_process[n].status:o["status"]=0,r.child_node.push(o)})),t.nodeList.push(r)}));for(var r=0;r<t.nodeList.length;r++){for(var s=!1,c=0;c<t.nodeList[r].child_node.length;c++)1==t.nodeList[r].child_node[c].status&&(s=!0);t.nodeList[r]["showStatus"]=s}return n.updateCheckroomNode().then((function(){return t.nodeList}))}))},n.updateCheckroomNode=function(){var n=a["a"].when();return t.currRoom.batchRoomId||(n=c["a"].getBatchRoomList(t.roomInfo.batchId,[t.currRoom.room_id]).then((function(n){return!_.isEmpty(n)&&(t.currRoom.batchRoomId=n[0].id,!0)}))),n.then((function(n){if(!1!==n)return s["a"].hasUploadData(t.currRoom.batchRoomId).then((function(n){if(_.isEmpty(n))return a["a"].resolve();var o=_.find(t.nodeList,{type:"delivery_check_room"});if(o){var e=!1;n.forEach((function(t){o.child_node.forEach((function(n){("问题"===t.type&&"登记问题"===n.name||"房间"===t.type&&"登记问题"!==n.name)&&(n.status=1),e=e||1==n.status}))})),o.showStatus=e,o.status=1,o.hasUpload=!0}}))}))},{model:t,initModel:function(n){t.roomInfo=n,t.currRoomIndex=0,t.currRoom=t.roomInfo.room_list[0],t.baseInfo={customers:[]};for(var o=t.roomInfo.room_list.length,e=0;e<o;e++)t.roomInfo.room_list[e].ans=e},init:function(){return s["a"].getDeliveryNodeList().then((function(o){return t.sourseData=o,_.each(t.sourseData,(function(t,n){_.each(t.child_process,(function(t,n){t.type=t.type.substr(0,t.type.length-1)}))})),n.load()}))},gotoNextRoom:function(){return n.gotoNextRoom()},gotoCheckRoom:function(){var n=i["a"].state.app.global.currentBatchType,o={deliveryprocess:{name:"正式交付",type:"交付",batch_type:"delivery",from:"deliveryprocess"},online_delivery_center:{name:"在线交房",type:"在线交付",batch_type:"online_delivery",from:"online_delivery_center"}},e=o[n]["batch_type"];return s["a"].getRoomData(t.roomInfo.batchId,t.currRoom.room_id).then((function(a){if(!_.isEmpty(a)){var s={batchRoomId:a.id,roomId:a.room_id,building_id:a.building_id,batch_unit_id:a.batch_unit_id,type:e,fitment_standard:a.fitment_standard,roomTitle:a.building_name+a.room_no,menuType:i["a"].state.app.global.currentMenuType,batch_id:t.roomInfo.batchId};return c["a"].getRoomTypeImageFileIsExists(a.id).then((function(t){t?(s.mode="0",s.isImageExists=!0):s.from=n,console.log("/checkroom/".concat(e,"-roomdetail")),r["a"].push({path:"/checkroom/".concat(e,"-roomdetail"),query:u(u({},s),{},{from:n})})}))}return i["a"].commit("app/APP",{currentBatchType:e}),r["a"].push({path:"/checkroom/".concat(e,"-batch-unit"),query:o[n]})}))},load:function(){return n.load()},uploadRoomData:function(n){return s["a"].getRoomData(t.roomInfo.batchId,t.currRoom.room_id).then((function(t){return l["a"].uploadData(t.batch_unit_id,t.id).then((function(){n.hasUpload=!1}))}))}}}()},fed9:function(t,n,o){var e=o("7d17");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var a=o("85cb").default;a("11c84ef2",e,!0,{})}}]);