(window["webpackJsonp_module_entry_zhkf_"]=window["webpackJsonp_module_entry_zhkf_"]||[]).push([["chunk-0ffcc8ee"],{1319:function(e,t,n){"use strict";n("5f54");var a=n("3e83"),r=(n("6d57"),n("e44b"),n("6a61"),n("2e91")),c=n("50f2"),i=n("a740"),s=n("9c54"),u=n("1961"),o=n("a997"),p=n("8c39"),b=n("2c15"),f=n("e49e"),k=n("f89a"),m=n("c662"),l=n("e4b6"),d=n("4be7"),x=n("a977"),h=n("4c60"),v=n("8955"),g=n("96ce"),_=n("47f1");function w(){return y.apply(this,arguments)}function y(){return y=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].getOneTimeStamp({type:c["a"].businessType});case 2:if(t=e.sent,n={user_id:Object(i["j"])("userId")},void 0===t||0===t.length){e.next=12;break}if(a=t["time_stamp"],!a){e.next=11;break}return e.next=9,m["a"].getAllCount();case 9:r=e.sent,0===r&&(a="");case 11:n["timestamp"]=a;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function j(){return T.apply(this,arguments)}function T(){return T=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:return t=e.sent,e.next=5,Object(u["a"])({url:"off-line-check-task-api/download-data/is-check-task-data-change",method:"get",data:t});case 5:return n=e.sent,e.abrupt("return",n["is_change"]);case 7:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function I(){return O.apply(this,arguments)}function O(){return O=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x["a"].paginationSaveNewData();case 3:return e.next=5,o["a"].paginationSaveNewData();case 5:return e.next=7,b["a"].paginationSaveNewData();case 7:return e.next=9,p["a"].paginationSaveNewData();case 9:return e.next=11,l["b"].paginationSaveNewData();case 11:return e.next=13,m["a"].paginationSaveNewData();case 13:return e.next=15,f["a"].paginationSaveNewData();case 15:return e.next=17,k["a"].paginationSaveNewData();case 17:return e.next=19,v["a"].paginationSaveNewData();case 19:return e.next=21,c["a"].getOneTimeStamp({type:c["a"].imageType});case 21:return t=e.sent,console.log("timeStamp",t),e.next=25,c["a"].replaceTimeStamp({type:c["a"].businessType,time_stamp:t.time_stamp});case 25:return e.abrupt("return",!0);case 28:if(n=e.sent,0!==n.length){e.next=31;break}throw new Error("业务数据接口返回空数据");case 31:e.t0=regeneratorRuntime.keys(n);case 32:if((e.t1=e.t0()).done){e.next=70;break}a=e.t1.value,r=n[a],e.t2=a,e.next="kf_check_task_batch"===e.t2?38:"kf_check_task_batch_item"===e.t2?41:"kf_check_task_batch_item_detail"===e.t2?44:"kf_check_task_batch_scope"===e.t2?47:"kf_check_task_problem"===e.t2?50:"kf_check_task_problem_scope"===e.t2?53:"kf_check_task_batch_item_detail_person"===e.t2?56:"kf_image"===e.t2?59:"kf_check_node"===e.t2?62:"timestamp"===e.t2?65:68;break;case 38:return e.next=40,o["a"].operationTaskBatch(r);case 40:return e.abrupt("break",68);case 41:return e.next=43,p["a"].operationTaskBatchItem(r);case 43:return e.abrupt("break",68);case 44:return e.next=46,l["b"].operationTaskBatchItemDetail(r);case 46:return e.abrupt("break",68);case 47:return e.next=49,b["a"].operationTaskBatchScope(r);case 49:return e.abrupt("break",68);case 50:return e.next=52,f["a"].operationTaskProblem(r);case 52:return e.abrupt("break",68);case 53:return e.next=55,k["a"].operationTaskProblemScope(r);case 55:return e.abrupt("break",68);case 56:return e.next=58,m["a"].operationTaskBatchItemDetailPerson(r);case 58:return e.abrupt("break",68);case 59:return e.next=61,v["a"].operationImage(r);case 61:return e.abrupt("break",68);case 62:return e.next=64,x["a"].operationCheckNode(r);case 64:return e.abrupt("break",68);case 65:return e.next=67,c["a"].replaceTimeStamp({type:c["a"].businessType,time_stamp:r});case 67:return e.abrupt("break",68);case 68:e.next=32;break;case 70:return e.abrupt("return",!0);case 73:e.prev=73,e.t3=e["catch"](0),Object(s["b"])(e.t3);case 76:case"end":return e.stop()}}),e,null,[[0,73]])}))),O.apply(this,arguments)}function S(e){var t=Object(u["a"])({url:"off-line-check-task-api/upload-data/check-task-data",method:"post",data:e});return t}function D(e,t){return delete e["incrementIds"],t.length>0&&(e["increment"]=t),e}function B(){return N.apply(this,arguments)}function N(){return N=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,r,c,u,o,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=30,e.next=4,h["a"].getCount({},"");case 4:n=e.sent,r=_["a"].buildMaxPage(n,t),console.log("maxPage",r),c=regeneratorRuntime.mark((function e(a){var r,c,s,u,o,p,b,x,g,w,y,j,T,I,O,B;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=_["a"].buildPageParameter(n,a,t),e.next=3,h["a"].pageIncrement(r.offset,r.limit);case 3:if(c=e.sent,0!==c.length||1!==a){e.next=7;break}return console.log("没有增量数据"),e.abrupt("return",{v:!1});case 7:s={},c.map((function(e){var t=e["business_type"];s[t]=s[t]||{},s[t]["incrementIds"]=s[t]["incrementIds"]||[],s[t]["increment"]=s[t]["increment"]||[],s[t]["delete"]=s[t]["delete"]||[];var n=e["business_id"],a=e["operation"];a===h["a"].operationIncrement?s[t]["incrementIds"].push(n):s[t]["delete"].push({id:n})})),e.t0=regeneratorRuntime.keys(s);case 10:if((e.t1=e.t0()).done){e.next=59;break}u=e.t1.value,o=s[u],e.t2=u,e.next="kf_check_task_problem"===e.t2?16:"kf_check_task_batch_item_detail"===e.t2?21:"kf_check_task_problem_scope"===e.t2?26:"kf_check_task_batch_item_detail_person"===e.t2?31:"kf_check_task_log"===e.t2?36:"kf_image"===e.t2?41:57;break;case 16:return e.next=18,f["a"].getCheckTaskProblemListByIdList(o["incrementIds"]);case 18:return p=e.sent,s[u]=D(o,p),e.abrupt("break",57);case 21:return e.next=23,l["b"].getTaskBatchItemDetailListByIds(o["incrementIds"]);case 23:return b=e.sent,s[u]=D(o,b),e.abrupt("break",57);case 26:return e.next=28,k["a"].getTaskProblemScopeListByIds(o["incrementIds"]);case 28:return x=e.sent,s[u]=D(o,x),e.abrupt("break",57);case 31:return e.next=33,m["a"].getTaskBatchItemDetailPersonListByIds(o["incrementIds"]);case 33:return g=e.sent,s[u]=D(o,g),e.abrupt("break",57);case 36:return e.next=38,d["a"].getCheckTaskLogListByIds(o["incrementIds"]);case 38:return w=e.sent,s[u]=D(o,w),e.abrupt("break",57);case 41:return e.next=43,v["a"].getImageListByIds(o["incrementIds"]);case 43:y=e.sent,j=[],T=0;case 46:if(!(T<y.length)){e.next=55;break}return I=y[T],e.next=50,v["a"].saveImageToOss(I);case 50:O=e.sent,j.push(Object.assign({},O));case 52:T++,e.next=46;break;case 55:return s[u]=D(o,y),e.abrupt("break",57);case 57:e.next=10;break;case 59:return B={data:s,user_id:Object(i["j"])().userId},e.next=62,S(B);case 62:case"end":return e.stop()}}),e)})),u=1;case 9:if(!(u<=r)){e.next=17;break}return e.delegateYield(c(u),"t0",11);case 11:if(o=e.t0,"object"!==Object(a["a"])(o)){e.next=14;break}return e.abrupt("return",o.v);case 14:u++,e.next=9;break;case 17:return e.next=19,h["a"].cleanIncrement();case 19:return e.next=21,g["b"].checkAllDataHasChange();case 21:if(p=e.sent,!p["project"]){e.next=25;break}return e.next=25,g["b"].saveProject();case 25:if(!p["building"]){e.next=28;break}return e.next=28,g["b"].saveBuilding();case 28:if(!p["building-unit"]){e.next=31;break}return e.next=31,g["b"].saveBuildingUnit();case 31:if(!p["building-floor"]){e.next=34;break}return e.next=34,g["b"].saveBuildingFloor();case 34:if(!p["room"]){e.next=37;break}return e.next=37,g["b"].saveRoom();case 37:if(!p["basic-data"]){e.next=40;break}return e.next=40,g["b"].getNewBasicData();case 40:if(!p["check-task-data"]){e.next=43;break}return e.next=43,I();case 43:e.next=49;break;case 45:throw e.prev=45,e.t1=e["catch"](0),Object(s["b"])(e.t1),e.t1;case 49:case"end":return e.stop()}}),e,null,[[0,45]])}))),N.apply(this,arguments)}window.sendNewData=B,t["a"]={getNewData:I,sendNewData:B,checkHasChange:j}},"243c":function(e,t){var n=Object.prototype,a=n.toString;function r(e){return a.call(e)}e.exports=r},3804:function(e,t,n){var a=n("b6b5"),r=function(){return a.Date.now()};e.exports=r},4923:function(e,t){function n(e){return null!=e&&"object"==typeof e}e.exports=n},"536d":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return c}));n("2b45"),n("edd1");function a(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}window.rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(e){return setTimeout(e,1e3/60)};function r(){var e=window.navigator?window.navigator.connection:{},t=e.type;return t}function c(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},6973:function(e,t,n){var a=n("82d7"),r=n("7de4"),c=NaN,i=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,o=/^0o[0-7]+$/i,p=parseInt;function b(e){if("number"==typeof e)return e;if(r(e))return c;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=u.test(e);return n||o.test(e)?p(e.slice(2),n?2:8):s.test(e)?c:+e}e.exports=b},"7de4":function(e,t,n){var a=n("9822"),r=n("4923"),c="[object Symbol]";function i(e){return"symbol"==typeof e||r(e)&&a(e)==c}e.exports=i},"82d7":function(e,t){function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=n},"8c18":function(e,t,n){var a=n("b6b5"),r=a.Symbol;e.exports=r},9822:function(e,t,n){var a=n("8c18"),r=n("fe3c"),c=n("243c"),i="[object Null]",s="[object Undefined]",u=a?a.toStringTag:void 0;function o(e){return null==e?void 0===e?s:i:u&&u in Object(e)?r(e):c(e)}e.exports=o},a59e:function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n("0288"))},b6b5:function(e,t,n){var a=n("a59e"),r="object"==typeof self&&self&&self.Object===Object&&self,c=a||r||Function("return this")();e.exports=c},edd1:function(e,t,n){var a=n("82d7"),r=n("3804"),c=n("6973"),i="Expected a function",s=Math.max,u=Math.min;function o(e,t,n){var o,p,b,f,k,m,l=0,d=!1,x=!1,h=!0;if("function"!=typeof e)throw new TypeError(i);function v(t){var n=o,a=p;return o=p=void 0,l=t,f=e.apply(a,n),f}function g(e){return l=e,k=setTimeout(y,t),d?v(e):f}function _(e){var n=e-m,a=e-l,r=t-n;return x?u(r,b-a):r}function w(e){var n=e-m,a=e-l;return void 0===m||n>=t||n<0||x&&a>=b}function y(){var e=r();if(w(e))return j(e);k=setTimeout(y,_(e))}function j(e){return k=void 0,h&&o?v(e):(o=p=void 0,f)}function T(){void 0!==k&&clearTimeout(k),l=0,o=m=p=k=void 0}function I(){return void 0===k?f:j(r())}function O(){var e=r(),n=w(e);if(o=arguments,p=this,m=e,n){if(void 0===k)return g(m);if(x)return clearTimeout(k),k=setTimeout(y,t),v(m)}return void 0===k&&(k=setTimeout(y,t)),f}return t=c(t)||0,a(n)&&(d=!!n.leading,x="maxWait"in n,b=x?s(c(n.maxWait)||0,t):b,h="trailing"in n?!!n.trailing:h),O.cancel=T,O.flush=I,O}e.exports=o},fe3c:function(e,t,n){var a=n("8c18"),r=Object.prototype,c=r.hasOwnProperty,i=r.toString,s=a?a.toStringTag:void 0;function u(e){var t=c.call(e,s),n=e[s];try{e[s]=void 0;var a=!0}catch(u){}var r=i.call(e);return a&&(t?e[s]=n:delete e[s]),r}e.exports=u}}]);