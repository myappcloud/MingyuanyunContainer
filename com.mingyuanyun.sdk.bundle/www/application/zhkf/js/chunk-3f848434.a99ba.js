(window["webpackJsonp_module_entry_zhkf_"]=window["webpackJsonp_module_entry_zhkf_"]||[]).push([["chunk-3f848434"],{"0970":function(e,t,n){"use strict";n("6d57"),n("cc57");var i=n("1834"),a=function(){var e="select ci.id,ci.name,ci.parent_id,ci.sort,ci.ifEnd,cig.remark from check_item ci left join check_item_guide cig on ci.id=cig.item_id";return i["a"].query(e)},r=function(e){var t="select remark from check_item_guide where item_id = ?",n=[e];return i["a"].queryOne(t,n).then((function(e){return e&&e.remark}))},o=function(e){var t="select item.full_name,guide.remark as guide           from check_item_guide guide               inner join check_item item on guide.item_id=item.id           where guide.item_id=?";return i["a"].queryOne(t,[e])},s=function(){var e="select item.id,item.name,item.parent_id,guide.id is not null as has_guide       from check_item item           left join check_item_guide guide on item.id=guide.item_id              and ifnull(guide.remark,'') <> ''       order by sort";return i["a"].query(e)},c={getCheckItemWithGuide:a,getGuideByCheckItemId:r,getCheckItemList:s,getGuideAndItemByItemId:o},l=n("a14a"),d=n.n(l),h=function(){var e={};return{getItem:function(t,n){if(void 0===t||null===t)throw new TypeError("key参数为空");return n?e[t]:d.a.cloneDeep(e[t])},setItem:function(t,n){if(void 0===t||null===t)throw new TypeError("key参数为空");if(arguments.length<2)throw new TypeError("value参数未设置");e[t]=n},clear:function(){e={}}}},u=h(),f={IS_NEED_DOWNLOAD_BASE_DATA:"is_need_download_base_data",LAST_EXEC_TIME_DATA:"last_exec_time_data",LAST_GUIDE_SORT_MAP:"last_guide_sort_map"},p=function(){var e=function e(t,n){t.remark&&""!=t.remark&&(t.has_guide=!0),t.children=[];for(var i=0;i<n.length;i++)n[i].parent_id==t.id&&t.children.push(n[i]);if(t.children&&t.children.length>0)for(var a=0;a<t.children.length;a++)t.children[a]=e(t.children[a],n);return t};return{getCheckItemGuideByItemId:function(e){return c.getGuideByCheckItemId(e)},getCheckItemTree:function(){var t={id:""};return c.getCheckItemWithGuide().then((function(n){t=e(t,n);for(var i=0;i<t.children.length;i++)if("所有检查项"==t.children[i].name)return t.children[i].children;return t.children}))},getCheckItemTreeAndGuideSortMap:function(){return console.time("getData"),c.getCheckItemList().then((function(e){console.timeEnd("getData"),console.time("processData");var t={},n=[],i=0,a=[];function r(e,t){e.forEach((function(e){e.depth=t,e.tree?r(e.tree,t+1):e.has_guide&&(e.guide_sort=i,n[i]=e.id,i++)}))}return e.forEach((function(e){t[e.id]=e})),e.forEach((function(e){e.parent_id&&t[e.parent_id]?(t[e.parent_id].tree=t[e.parent_id].tree||[],t[e.parent_id].tree.push(e)):a.push(e)})),r(a,1),u.setItem(f.LAST_GUIDE_SORT_MAP,n),console.timeEnd("processData"),{tree:a,guideSortMap:n}}))},getGuideSortMapFromCatch:function(){return u.getItem(f.LAST_GUIDE_SORT_MAP,!0)},getGuideAndItemByItemId:c.getGuideAndItemByItemId}};t["a"]=p()},1665:function(e,t,n){t=e.exports=n("690e")(!1),t.push([e.i,"\n.zhkf .tree-wrapper .tree-title[data-v-5a30e59c] {\n  line-height: 50px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-size: 14px;\n  color: #606060;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  padding-left: 15px;\n  padding-right: 15px;\n}\n.zhkf .tree-wrapper .tree-title span[data-v-5a30e59c] {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    width: 50px;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n}\n.zhkf .tree-wrapper .tree-title.bold[data-v-5a30e59c] {\n    color: #202020;\n    font-weight: 500;\n}\n.zhkf .tree-wrapper .tree-title .arrow[data-v-5a30e59c] {\n    width: 20px;\n    margin-right: 12px;\n    color: #d2d2d7;\n}\n.zhkf .tree-wrapper .tree-title .arrow.up[data-v-5a30e59c] {\n      -webkit-transform: rotate(-180deg);\n              transform: rotate(-180deg);\n}\n.zhkf .tree-wrapper .tree-title .name[data-v-5a30e59c] {\n    margin-left: 10px;\n    color: #202020;\n    font-size: 14px;\n}\n.zhkf .tree-wrapper[data-v-5a30e59c] .collapse {\n  -webkit-tap-highlight-color: #f2f2f2;\n  padding: 0;\n}\n.zhkf .tree-wrapper[data-v-5a30e59c] .collapse:active {\n    background: #f2f2f2;\n}\n.zhkf .tree-wrapper[data-v-5a30e59c] .collapse-wrapper .main {\n  padding-left: 0;\n  margin-top: 1px;\n}\n.zhkf .tree-wrapper[data-v-5a30e59c] .collapse-wrapper .main .tree-title {\n    padding-left: 40px;\n}\n.zhkf .content[data-v-5a30e59c] {\n  margin-top: -1px;\n  margin-bottom: -1px;\n}\n.zhkf .check-btn[data-v-5a30e59c] {\n  color: #bbb;\n}\n.zhkf .check-btn.blue[data-v-5a30e59c] {\n    color: #0099ff;\n}\n",""])},"20f4":function(e,t,n){var i=n("1665");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("85cb").default;a("584201da",i,!0,{})},"88bc":function(e,t,n){t=e.exports=n("690e")(!1),t.push([e.i,"\n.zhkf .inspect-guide[data-v-5b446e98] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  height: 100%;\n}\n.zhkf .main[data-v-5b446e98] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  overflow: auto;\n}\n",""])},"9cce":function(e,t,n){"use strict";n.r(t);var i=n("0970"),a=(n("163d"),n("d9cf")),r={name:"TreeItem",components:{CusCollapse:a["a"]},props:{items:{type:Array,default:function(){return[]}},level:Number},data:function(){return{activeNames:[]}},watch:{activeNames:function(e){console.log(e)}},methods:{checkPoint:function(e){return console.log(e,"===checkpoint===="),e.has_guide?!(e.tree&&e.tree.length>0)&&void this.$router.push({path:"/user/guide-detail",query:{item_id:e.id,guide_sort:e.guide_sort}}):(e.tree&&0!==e.tree.length||this.$toast("该检查项暂未设置检查指引"),!1)}}},o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tree-wrapper"},[n("div",e._l(e.items,(function(t){return n("cus-collapse",{key:t.id,attrs:{name:t.name,disabled:!t.tree||t.tree.length<0}},[n("div",{staticClass:"tree-title",class:{bold:0==e.level},style:{"padding-left":40*(t.depth-1)+15+"px"},attrs:{slot:"title"},on:{click:function(n){return e.checkPoint(t)}},slot:"title"},[n("div",{staticClass:"arrow",class:{up:e.activeNames.indexOf(t.name)}},[n("i",{directives:[{name:"show",rawName:"v-show",value:t.tree&&t.tree.length>0,expression:"item.tree && item.tree.length > 0"}],staticClass:"iconfont icon-hebingxingzhuang"})]),e._v(" "),n("span",[e._v("\n          "+e._s(t.name)+"\n        ")]),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:!t.tree||0===t.tree.length,expression:"!item.tree ||item.tree.length === 0"}],staticClass:"check-btn iconfont icon-jianchazhiyintubiao",class:{blue:t.has_guide}})]),e._v(" "),n("div",{staticClass:"content"},[t.tree&&t.tree.length>0?n("tree-item",{attrs:{items:t.tree}}):e._e()],1)])})),1)])},s=[],c=n("d082");function l(e){n("20f4")}var d=!1,h=l,u="data-v-5a30e59c",f=null,p=Object(c["a"])(r,o,s,d,h,u,f),m=p.exports,g=n("0938"),v={components:{Tree:m},data:function(){return{loadingData:!1,finished:!0,activeNames:[0],items:[],showItems:[],page:0,limit:20,total:0}},created:function(){var e=this;i["a"].getCheckItemTreeAndGuideSortMap().then((function(t){e.items=t.tree,e.total=e.items.length;var n=e.items.slice(e.page*e.limit,(e.page+1)*e.limit);e.showItems=e.showItems.concat(n)}))},methods:{goGuide:function(e){this.$router.push({path:"/user/guide-detail",query:{item_id:e.id,guide_sort:e.guide_sort}})},handleScroll:function(){Object(g["i"])(this.doScroll,400)()},doScroll:function(){var e=this.$refs.tree.clientHeight<=this.$refs.scrolldom.scrollTop+window.screen.height+100,t=this.page*this.limit>=this.total;t||e&&this.loadMore()},loadMore:function(){var e=this.items.slice((this.page+1)*this.limit,(this.page+2)*this.limit);this.showItems=this.showItems.concat(e),this.page++}}},_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"inspect-guide"},[n("cus-nav-bar",{attrs:{title:"检查指引","left-arrow":"",border:!1},on:{"click-left":function(t){return e.$router.go(-1)}}}),e._v(" "),n("div",{directives:[{name:"scroll",rawName:"v-scroll"}],ref:"scrolldom",staticClass:"main",on:{scroll:e.handleScroll}},[n("div",{ref:"tree"},[n("tree",{attrs:{items:e.showItems,level:0},on:{goGuideView:e.goGuide}})],1)])],1)},x=[];function w(e){n("a71f")}var b=!1,k=w,I="data-v-5b446e98",y=null,C=Object(c["a"])(v,_,x,b,k,I,y);t["default"]=C.exports},a71f:function(e,t,n){var i=n("88bc");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("85cb").default;a("d7673e72",i,!0,{})},c146:function(e,t,n){t=e.exports=n("690e")(!1),t.push([e.i,"\n.zhkf .collapse-wrapper[data-v-020a7db0] {\n  position: relative;\n}\n.zhkf .collapse[data-v-020a7db0] {\n  position: relative;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  width: 100%;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #323233;\n  font-size: 14px;\n  line-height: 24px;\n  background-color: #fff;\n  height: 50px;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  padding-left: 15px;\n  padding-right: 15px;\n}\n.zhkf .title[data-v-020a7db0] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.zhkf .main[data-v-020a7db0] {\n  padding-left: 40px;\n  background: #fff;\n  position: relative;\n  z-index: 1;\n}\n",""])},d9cf:function(e,t,n){"use strict";n("cc57");var i={name:"CusCollapse",model:{prop:"activeItems",event:"change"},props:{active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:{type:String,default:""},activeItems:{type:Array,default:function(){return[]}}},data:function(){return{isExpand:!1}},created:function(){this.isExpand=this.activeItems.indexOf(this.name)>-1},methods:{toggle:function(){if(!this.disabled){this.isExpand=!this.isExpand;var e=this.activeItems.indexOf(this.name);this.isExpand?e<0&&this.activeItems.push(this.name):this.activeItems.splice(e,1),this.$emit("change",this.activeItems)}}}},a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"collapse-wrapper"},[n("div",{staticClass:"collapse van-hairline--bottom",on:{click:function(t){return e.toggle()}}},[n("div",{staticClass:"title",class:{"collapse-title__expended":e.activeItems.indexOf(e.name)>-1}},[e._t("title")],2),e._v(" "),n("div",{staticClass:"right-icon"},[e._t("right-icon")],2)]),e._v(" "),e.activeItems.indexOf(e.name)>-1?n("div",{ref:"main",staticClass:"main van-hairline--bottom"},[n("div",{ref:"wrapper",staticClass:"wrapper"},[e._t("default")],2)]):e._e()])},r=[],o=n("d082");function s(e){n("dd6f")}var c=!1,l=s,d="data-v-020a7db0",h=null,u=Object(o["a"])(i,a,r,c,l,d,h);t["a"]=u.exports},dd6f:function(e,t,n){var i=n("c146");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("85cb").default;a("336b5d14",i,!0,{})}}]);