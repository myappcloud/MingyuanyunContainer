(window["webpackJsonp_module_entry_zhkf_"]=window["webpackJsonp_module_entry_zhkf_"]||[]).push([["chunk-4dccddbe"],{"0e4a":function(e,t,n){"use strict";n("5f54"),n("6d57");var i=n("a2ee"),a=n("01e5"),s=n("a38a"),o=n("c6e3"),r=n("fd50");t["a"]={getAllTag:function(){return i["a"].getAllTag().then((function(e){return _.isEmpty(e)?[]:e}))},getCustomerTag:function(e){return i["a"].getCustomerTag(e,"tag_id").then((function(e){if(_.isEmpty(e))return[];var t=[];return e.forEach((function(e){t.push(e.tag_id)})),t}))},getCustomerAssess:function(e){return s["a"].getCustomerAssess(e).then((function(e){return _.isEmpty(e)?"":e["remark"]}))},upsertCustomerTags:function(e,t,n){return t=t||[],n=n||[],e?_.isEmpty(t)&&_.isEmpty(n)?r["a"].resolve():i["a"].upsertCustomerTags(e,t,n):r["a"].reject("缺少客户id")},addCustomerTagDataIncrement:function(e){return i["a"].addCustomerTagDataIncrement(e)},upsertCustomerAssess:function(e,t){return e&&t?s["a"].upsertCustomerAssess(e,t):r["a"].reject("缺少客户id或评价说明")},addCustomerAssessDataIncrement:function(e){return s["a"].addCustomerAssessDataIncrement(e)},getRoomCustomerInfo:function(e){return a["a"].getCustomersByRoomId(e).then((function(e){var t=[],n=[];return e.forEach((function(e){t.push(function(e){var t=e.customer_id;return console.log(t),r["a"].all([i["a"].getCustomerTagInfo(t),s["a"].getCustomerAssess(t)]).then((function(t){console.log("results",Object.assign({},t[0])),n.push({customerName:e.customer_name,customerPhone:e.customer_phone,tags:t[0]||[],remark:t[1]&&t[1]["remark"]?t[1]["remark"]:""})}))}(e))})),r["a"].all(t).then((function(){return n}))}))},updateRoomAssessStatus:function(e,t){return o["a"].updateRoomAssessStatus(e,t)},hasTags:function(){return i["a"].hasTags().then((function(e){return e&&!!e["id"]}))}}},"15ad":function(e,t,n){"use strict";n.r(t);n("5ab2"),n("e44b"),n("e10e"),n("cc57"),n("6d57");var i=n("28f8"),a=n("f2de"),s=n("ce7b"),o=n("0e4a"),r=n("3fa2"),c=n("65e1"),l=n("c2c1"),d=n("8ae6");function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m="",u={name:"ReceiveView",components:{Rating:c["a"]},data:function(){return{baseInfo:{},lableWidth:"60",isOpen:!1}},computed:f({},Object(a["e"])({enableDeliveryProcess:function(e){return e.app.global.enableDeliveryProcess}})),created:function(){this.initData()},methods:{initData:function(){var e=this;this.baseInfo={},m=this.$route.query.batchRoomId,s["a"].getReceiveInfo(m).then((function(t){e.lableWidth=e.getMaxLength(t.satisfactionList),e.baseInfo={room_title:t.room_title,customers:[],problemList:t.problemList,receive_date:t.opening_receive_date&&t.opening_receive_date.substring(0,16)||"",satisfactionList:t.satisfactionList,satisfaction_remark:t.satisfaction_remark,signature_image_localpath:t.signature_image_localpath&&d["a"].getImageRealPath(t.signature_image_localpath)||""},o["a"].getRoomCustomerInfo(r["a"].room.id).then((function(t){t=t||[],t.forEach((function(e,t){e.showAllTag=!0,e.idName="tagBox-"+t,e.showBtn=!1,e.canDialTelphonee=-1===e.customerPhone.indexOf("*")})),e.baseInfo["customers"]=t,e.$nextTick((function(){for(var t=e.$refs["tag"]||[],n=0;n<t.length;n++)console.log(t[n].offsetHeight),t[n].offsetHeight>32?(e.$set(e.baseInfo["customers"][n],"isOpen",!0),e.baseInfo["customers"][n].showAllTag=!1):(e.$set(e.baseInfo["customers"][n],"isOpen",!1),e.baseInfo["customers"][n].showAllTag=!0)}))}))})).catch((function(e){return console.log(e)}))},getMaxLength:function(e){if(0===e.length)return 0;for(var t=e[0].name.length,n=0;n<e.length;n++)t<e[n].name.length&&(t=e[n].name.length);return t<4&&(t=4),15*t},showSignImg:function(e){console.error("showSignImg"),l["a"].openImageBrowser([e],0)},showRemark:function(e){this.$dialog.alert({message:e,confirmButtonText:"关闭"})},showTag:function(e){console.log(e),e.showAllTag=!e.showAllTag},review:function(){this.$router.push({path:"/checkroom/delivery-review",query:{batchRoomId:this.batchRoomId}})}}},g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"delivery-view"},[n("cus-nav-bar",{attrs:{title:"接待信息","left-arrow":"",border:!1}}),e._v(" "),e.baseInfo?n("div",{staticClass:"info-list"},[n("div",{staticClass:"base"},[n("div",{staticClass:"title"},[e._v("基础信息")]),e._v(" "),n("div",{staticClass:"base-content content"},[n("div",{staticClass:"box"},[n("div",{staticClass:"box-left"},[e._v("房产")]),e._v(" "),n("div",{staticClass:"box-right"},[e._v(e._s(e.baseInfo.room_title))])]),e._v(" "),n("div",{staticClass:"box"},[n("div",{staticClass:"box-left"},[e._v("业主")]),e._v(" "),n("div",{staticClass:"box-right"},e._l(e.baseInfo.customers,(function(t,i){return n("div",{key:i,staticClass:"item",on:{click:function(n){return e.showTag(t)}}},[n("div",{staticClass:"item-name"},[e._v("\n                  "+e._s(t.customerName)+"\n                  "),t.canDialTelphonee?n("a",{staticClass:"item-phone",attrs:{href:"tel:"+t.customerPhone}},[e._v("\n"+e._s(t.customerPhone)+"\n")]):n("span",{staticClass:"item-phone"},[e._v(e._s(t.customerPhone))]),e._v(" "),t.remark?n("span",{staticClass:"iconfont icon-beizhu",on:{click:function(n){return e.showRemark(t.remark)}}}):e._e()]),e._v(" "),t.tags&&t.tags.length?n("div",{ref:"tag",refInFor:!0,class:t.showAllTag?"item-tags item-tags__open":"item-tags item-tags__close",on:{click:e.showTag}},[t.isOpen?n("span",{class:t.showAllTag?"iconfont icon-hebingxingzhuang":"iconfont icon-hebingxingzhuang1"}):e._e(),e._v(" "),e._l(t.tags,(function(t,i){return n("div",{key:i,staticClass:"tag"},[e._v("\n"+e._s(t)+"\n")])}))],2):e._e()])})),0)])])]),e._v(" "),e.baseInfo.problemList&&e.baseInfo.problemList.length?n("div",{staticClass:"problem"},[n("div",{staticClass:"title"},[e._v("房间问题")]),e._v(" "),n("div",{staticClass:"problem-content content"},e._l(e.baseInfo.problemList,(function(t,i){return n("div",{key:i,staticClass:"item"},[n("p",{staticClass:"item-name"},[e._v(e._s(t.position_name)+" "+e._s(t.item_name))]),e._v(" "),n("p",{staticClass:"item-desc"},[e._v(e._s(t.desc))])])})),0)]):e._e(),e._v(" "),e.baseInfo.review_date?n("div",{staticClass:"review"},[n("div",{staticClass:"title"},[e._v("复查确认信息")]),e._v(" "),n("div",{staticClass:"review-content content"},[n("div",{staticClass:"item"},[n("div",{staticClass:"item-left"},[e._v("钥匙归还")]),e._v(" "),n("div",{staticClass:"item-right"},[e._v(e._s(e.baseInfo.is_key_return))])]),e._v(" "),n("div",{staticClass:"item"},[n("div",{staticClass:"item-left"},[e._v("补充说明")]),e._v(" "),n("div",{staticClass:"item-right"},[e._v(e._s(e.baseInfo.review_remark))])]),e._v(" "),n("div",{staticClass:"item"},[n("div",{staticClass:"item-left"},[e._v("办理时间")]),e._v(" "),n("div",{staticClass:"item-right"},[e._v(e._s(e.baseInfo.review_date))])])])]):e._e(),e._v(" "),n("div",{staticClass:"delivery"},[n("div",{staticClass:"title"},[e._v("接待记录")]),e._v(" "),n("div",{staticClass:"delivery-content content"},[e._l(e.baseInfo.satisfactionList,(function(t,i){return n("div",{key:i,staticClass:"item"},[n("div",{staticClass:"item-left",style:{width:e.lableWidth+"px"}},[e._v(e._s(t.name))]),e._v(" "),n("div",{staticClass:"value"},[n("rating",{attrs:{score:t.value,disabled:!0,index:i},on:{"update:score":function(n){return e.$set(t,"value",n)}}})],1)])})),e._v(" "),n("div",{staticClass:"item"},[n("div",{staticClass:"item-left"},[e._v("补充说明")]),e._v(" "),n("div",{staticClass:"item-right"},[e._v(e._s(e.baseInfo.satisfaction_remark))])]),e._v(" "),n("div",{staticClass:"item"},[n("div",{staticClass:"item-left"},[e._v("业主签名")]),e._v(" "),n("div",{staticClass:"item-right"},[n("img",{attrs:{src:e.baseInfo.signature_image_localpath,width:"100",height:"50"},on:{click:function(t){return e.showSignImg(e.baseInfo.signature_image_localpath)}}})])]),e._v(" "),n("div",{staticClass:"item"},[n("div",{staticClass:"item-left"},[e._v("办理时间")]),e._v(" "),n("div",{staticClass:"item-right"},[e._v(e._s(e.baseInfo.receive_date))])])],2)])]):e._e()],1)},h=[],b=n("d082");function p(e){n("53ba")}var _=!1,x=p,w="data-v-427d8832",y=null,k=Object(b["a"])(u,g,h,_,x,w,y);t["default"]=k.exports},"53ba":function(e,t,n){var i=n("f570");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("85cb").default;a("2eb96aa4",i,!0,{})},"65e1":function(e,t,n){"use strict";n("163d");var i={name:"Rating",props:{score:{type:[String,Number],required:!0},index:{type:[String,Number],default:0},disabled:{type:Boolean,default:!1}},computed:{},methods:{getClass:function(e){return e<=parseInt(this.score,10)?"xingxing1":"xingxing"},setScore:function(e){this.disabled||this.$emit("update:score",e,this.index)}}},a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"rating"},e._l(5,(function(t){return n("span",{key:t,staticClass:"star",class:e.getClass(t),on:{click:function(n){return e.setScore(t)}}})})),0)},s=[],o=n("d082");function r(e){n("c1fd")}var c=!1,l=r,d="data-v-a6e622e0",v=null,f=Object(o["a"])(i,a,s,c,l,d,v);t["a"]=f.exports},"76c0":function(e,t,n){"use strict";n("5f54");var i=n("cb6b"),a=n("0e1c"),s={customer_phone:"",saved_customer_phone:"",signature_image_localpath:"",saved_signature_image_localpath:"",review_signature_image_localpath:"",saved_review_signature_image_localpath:""};t["a"]={getReceive:function(){return i["a"].getObject(a["a"].RECEIVE_RECORD_STORAGE)||s},updateReceive:function(e){var t=i["a"].getObject(a["a"].RECEIVE_RECORD_STORAGE)||s,n=Object.assign({},t,e);i["a"].set(a["a"].RECEIVE_RECORD_STORAGE,n)}}},7803:function(e,t,n){var i=n("5454");t=e.exports=n("690e")(!1),t.push([e.i,"\n.zhkf .star[data-v-a6e622e0] {\n  display: inline-block;\n  font-size: 18px;\n  width: 24px;\n  height: 24px;\n  margin-left: 8px;\n}\n.zhkf .star[data-v-a6e622e0]:first-child {\n    margin-left: 0;\n}\n.zhkf .xingxing[data-v-a6e622e0] {\n  background: url("+i(n("5ea5"))+") no-repeat;\n  background-size: 100%;\n}\n.zhkf .xingxing1[data-v-a6e622e0] {\n  background: url("+i(n("2470"))+") no-repeat;\n  background-size: 100%;\n}\n",""])},c1fd:function(e,t,n){var i=n("7803");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("85cb").default;a("0c324747",i,!0,{})},ce7b:function(e,t,n){"use strict";var i=n("fd50"),a=n("c6e3"),s=n("d42a"),o=n("d485"),r=n("28c8"),c=n("76c0");t["a"]={getReceiveInfo:function(e,t){var n=[a["a"].getRoomReceiveInfo(e),a["a"].getRoomTitle(e,!0),o["a"].getProblemList(e,1),r["a"].getRoomSatisfactionValueList("开放",e),a["a"].getRoomReceivePersonInfo(t)];return i["a"].all(n).then((function(e){var t=e[0];return t.room_title=e[1],t.problemList=e[2],t.satisfactionList=e[3],t.customers=e[4],t}))},saveReceiveInfo:function(e,t){return s["a"].saveReceiveInfo(e,t)},isChangeRecord:function(){var e=c["a"].getReceive(),t=e.customer_phone!=e.saved_customer_phone||e.signature_image_localpath!=e.saved_signature_image_localpath;if(t)return!0;var n=[];for(var i in e)-1!=i.indexOf("record_")&&n.push(i.slice(7));for(var a=0;a<n.length;a++)if(e["record_"+n[a]]!=e["saved_"+n[a]])return!0;return!1}}},f570:function(e,t,n){t=e.exports=n("690e")(!1),t.push([e.i,"\n.zhkf .delivery-view[data-v-427d8832] {\n  height: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.zhkf .delivery-view .title[data-v-427d8832] {\n    height: 45px;\n    line-height: 45px;\n    padding: 0 15px;\n    color: #606060;\n    font-size: 15px;\n}\n.zhkf .delivery-view .content[data-v-427d8832] {\n    background: #fff;\n    padding: 15px;\n    font-size: 15px;\n}\n.zhkf .delivery-view .info-list[data-v-427d8832] {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    overflow: scroll;\n}\n.zhkf .delivery-view .base-content .box[data-v-427d8832] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    margin-bottom: 20px;\n    font-size: 15px;\n}\n.zhkf .delivery-view .base-content .box .box-left[data-v-427d8832] {\n      width: 50px;\n      color: #606060;\n}\n.zhkf .delivery-view .base-content .box .box-right[data-v-427d8832] {\n      color: #202020;\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n}\n.zhkf .delivery-view .base-content .box .box-right .item .item-name[data-v-427d8832] {\n        margin-bottom: 10px;\n}\n.zhkf .delivery-view .base-content .box .box-right .item .item-phone[data-v-427d8832] {\n        color: #0085ff;\n        margin-left: 10px;\n}\n.zhkf .delivery-view .base-content .box .box-right .item .icon-beizhu[data-v-427d8832] {\n        color: #a0a0a0;\n        font-size: 15px;\n        margin-left: 10px;\n}\n.zhkf .delivery-view .base-content .box .box-right .item .item-tags[data-v-427d8832] {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        position: relative;\n        -ms-flex-wrap: wrap;\n            flex-wrap: wrap;\n        padding-right: 23px;\n}\n.zhkf .delivery-view .base-content .box .box-right .item .item-tags .iconfont[data-v-427d8832] {\n          color: #d2d2d7;\n          font-size: 18px;\n          position: absolute;\n          right: 0;\n          top: 2px;\n}\n.zhkf .delivery-view .base-content .box .box-right .item .item-tags .tag[data-v-427d8832] {\n          height: 22px;\n          line-height: 22px;\n          text-align: center;\n          border-radius: 14px;\n          color: #0085ff;\n          background: #e5f4ff;\n          padding: 0 9px;\n          font-size: 12px;\n          margin: 0 10px 10px 0;\n}\n.zhkf .delivery-view .base-content .box .box-right .item .item-tags__close[data-v-427d8832] {\n        height: 32px;\n        overflow: hidden;\n}\n.zhkf .delivery-view .base-content .box .box-right .item .item-tags__open[data-v-427d8832] {\n        height: auto;\n}\n.zhkf .delivery-view .base-content .box[data-v-427d8832]:last-child {\n      margin-bottom: 0;\n}\n.zhkf .delivery-view .problem-content .item[data-v-427d8832] {\n    margin-bottom: 20px;\n}\n.zhkf .delivery-view .problem-content .item .item-name[data-v-427d8832] {\n      color: #202020;\n      margin-bottom: 10px;\n}\n.zhkf .delivery-view .problem-content .item .item-desc[data-v-427d8832] {\n      color: #606060;\n}\n.zhkf .delivery-view .problem-content .item[data-v-427d8832]:last-child {\n      margin-bottom: 0;\n}\n.zhkf .delivery-view .review-content .item[data-v-427d8832],\n  .zhkf .delivery-view .delivery-content .item[data-v-427d8832] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    margin-bottom: 20px;\n}\n.zhkf .delivery-view .review-content .item .item-left[data-v-427d8832],\n    .zhkf .delivery-view .delivery-content .item .item-left[data-v-427d8832] {\n      margin-right: 18px;\n      color: #606060;\n}\n.zhkf .delivery-view .review-content .item .item-right[data-v-427d8832],\n    .zhkf .delivery-view .delivery-content .item .item-right[data-v-427d8832] {\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      color: #202020;\n}\n.zhkf .delivery-view .review-content .item[data-v-427d8832]:last-child,\n    .zhkf .delivery-view .delivery-content .item[data-v-427d8832]:last-child {\n      margin-bottom: 0;\n}\n.zhkf .delivery-view .btn[data-v-427d8832] {\n    height: 45px;\n    line-height: 45px;\n    text-align: center;\n    background: #0085ff;\n    color: #fff;\n    font-size: 15px;\n}\n",""])}}]);