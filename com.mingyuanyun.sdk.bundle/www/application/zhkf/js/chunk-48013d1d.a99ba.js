(window["webpackJsonp_module_entry_zhkf_"]=window["webpackJsonp_module_entry_zhkf_"]||[]).push([["chunk-48013d1d"],{"11e0":function(e,t,n){var o=n("acd3c");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("85cb").default;i("477df7ac",o,!0,{})},"1b3a":function(e,t,n){"use strict";n("f0e6"),n("e697");var o=n("fd50"),i=n("a18c"),r=n("a593"),a=n("43ee"),l=n("d49d"),c=n("af4c"),s=n("a14a"),d=n.n(s),f=function(){var e={},t={allSelected:!1,nextRoomId:"",nextRoom:{},roomName:"",currPage:0,totalPage:0,list:[],filterList:[]},n=!1,s={},f=20;return e.getConditions=function(){var e={batchRoomId:s.id};return d.a.each(t.filterList,(function(t){e[t.type]=t.id})),e.position||(e.checkItem=""),e},e.setFilter=function(e,t,n){var o=d.a.find(e,{id:t});o||(o={id:t,name:n,count:0},e.push(o)),o.count++},e.setAllFilter=function(e){var t=0;d.a.each(e,(function(e){t+=e.count})),e.unshift({id:"",name:"全部",count:t})},e.getFilter=function(n){var o=e.getConditions(),i=[];return!o[n]&&(n=""),l["a"].getFeedbackFilters(o,n).then((function(e){if(d.a.each(t.filterList,(function(o,r){if(e[o.type]||n===o.type){var a=t.filterList[r].value||"";if(o&&e[o.type]){var l=d.a.filter(e[o.type],{id:a});l&&l[0]&&i.push(l[0].count),t.filterList[r].options=e[o.type]}}else o.id="",o.name="",o.options=[]})),i.length){var o=Math.min.apply(null,i);t.totalPage=Math.ceil(o/f)}console.log(t.filterList)}))},e.getFeedbackList=function(n){var o=e.getConditions(),i=n?0:t.currPage*f;return l["a"].getFeedbackListByBatchRoomId(o,i,f).then((function(e){t.list=i?t.list.concat(e):e,t.currPage++}))},e.getNextRoom=function(){n=!1;var e=s.id,o=[];d.a.each(a["a"].model.list,(function(e){o=o.concat(e.roomList)}));var i=d.a.find(o,{id:e}),r=d.a.indexOf(o,i);r<0?(t.nextRoomId="",t.nextRoom=""):r==o.length-1?(t.nextRoomId="",t.nextRoom="",o[r-1]||(n=!0)):(t.nextRoomId=o[r+1].id,t.nextRoom=o[r+1])},e.init=function(n){return n=n||!1,!n&&a["a"].model.currRoom&&a["a"].model.currRoom.id===s.id?o["a"].resolve():(t.allSelected=!1,t.nextRoomId="",t.nextRoom={},t.roomName="",t.list=[],t.currPage=0,t.totalPage=0,t.filterList=[{id:"",name:"",label:"部位",type:"position",options:[]},{id:"",name:"",label:"检查项",type:"checkItem",options:[]}],s=a["a"].model.currRoom,e.getFeedbackList(!0).then((function(){return t.roomName=a["a"].model.unitName+"-"+s.room_no,t.roomName=t.roomName.length>16?"..."+t.roomName.substr(t.roomName.length-16,16):t.roomName,e.getNextRoom(),e.getFilter()})))},e.toNextRoom=function(){return a["a"].model.currRoom=t.nextRoom,t.roomName=a["a"].model.unitName+"-"+t.nextRoom.room_no,t.roomName=t.roomName.length>16?"..."+t.roomName.substr(t.roomName.length-16,16):t.roomName,r["default"].$comComps.toast.show("查验下一个房间 "+t.roomName,3e3),e.init()},e.refresh=function(n){!d.a.isArray(n)&&(n=[n]),console.log(n,"------ids====",t.list);var o=e.getConditions(),i=n.length;return t.list.length-i<=0||t.allSelected?e.init(!0):(t.allSelected=!1,d.a.each(n,(function(e){var n=d.a.find(t.list,{id:e});n&&(t.list=t.list.filter((function(e){return e!==n})))})),l["a"].getFeedbackFilters(o).then((function(e){d.a.each(e,(function(n,o){var i=d.a.find(t.filterList,{type:o});if(i){i.options=e[o];var r=d.a.find(i.options,{id:i.id});d.a.isEmpty(r)&&(i.id="",i.name="")}}))})))},e.resetPage=function(){t.currPage=0,t.totalPage=0,t.allSelected=!1},{model:t,currFeedback:{},init:e.init,getFeedbackList:e.getFeedbackList,getFilter:e.getFilter,getConditions:e.getConditions,resetPage:e.resetPage,toNextRoom:e.toNextRoom,refresh:function(a,d){var f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];d=d||!1;var u=-1;return f&&u--,l["a"].hasMoreFeedback(s.id).then((function(l){if(!l&&t.nextRoomId)return i["a"].go(u),e.toNextRoom();if(l)return i["a"].go(u),e.refresh(a);if(c["a"].model.currFloor&&c["a"].model.currFloor.roomList.length-1){var s=c["a"].model,d=s.batchUnitId,f=s.moduleType;return c["a"].init(d,f,!0).finally((function(){u--,i["a"].go(u)}))}return u-=2,i["a"].go(u),n&&(r["default"].$comComps.toast.show("恭喜，该楼栋已回复完毕",2e3),e.init(!0)),o["a"].resolve()})).then((function(){d&&c["a"].updateRoomList()}))},loadMore:function(){return t.currPage<t.totalPage?e.getFeedbackList():o["a"].resolve()},getSelected:function(){var n=[],i=o["a"].defer();if(t.allSelected){var r=e.getConditions();l["a"].getAllFeedbackIds(r).then((function(e){d.a.each(e,(function(e){n.push(e.id)})),i.resolve(n)}))}else d.a.each(t.list,(function(e){e.selected&&n.push(e.id)})),i.resolve(n);return i.promise}}};t["a"]=f()},"1ec3":function(e,t,n){var o=n("3e9b");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("85cb").default;i("7da787f6",o,!0,{})},"3e9b":function(e,t,n){t=e.exports=n("690e")(!1),t.push([e.i,"\n.zhkf .filter[data-v-c89c18e4] {\n  background: #fff;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n}\n.zhkf .pull-left[data-v-c89c18e4] {\n  float: left;\n}\n.zhkf .check[data-v-c89c18e4] {\n  width: 23px;\n  height: 40px;\n}\n.zhkf .pull-right[data-v-c89c18e4] {\n  float: right;\n}\n.zhkf .clearfix[data-v-c89c18e4]:before,\n.zhkf .clearfix[data-v-c89c18e4]:after {\n  content: ' ';\n  display: table;\n}\n.zhkf .clearfix[data-v-c89c18e4]:after {\n  clear: both;\n}\n.zhkf .filter-header[data-v-c89c18e4] {\n  height: 45px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -ms-flex-wrap: nowrap;\n      flex-wrap: nowrap;\n  -webkit-box-flex: 0;\n      -ms-flex: 0 0 auto;\n          flex: 0 0 auto;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.zhkf .filter-header .filter-item[data-v-c89c18e4] {\n    -webkit-box-flex: 1;\n        -ms-flex: 1 1 auto;\n            flex: 1 1 auto;\n    text-align: center;\n    padding: 10px 0;\n    width: 20%;\n    line-height: 25px;\n    color: #606060;\n}\n.zhkf .filter-header .filter-item .filter-desc[data-v-c89c18e4] {\n      height: 100%;\n      overflow: hidden;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      font-size: 14px;\n}\n.zhkf .filter-header .filter-item .filter-desc .icon-hebingxingzhuang1[data-v-c89c18e4],\n      .zhkf .filter-header .filter-item .filter-desc .icon-hebingxingzhuang[data-v-c89c18e4] {\n        font-size: 10px;\n        color: #d2d2d7;\n        vertical-align: middle;\n}\n.zhkf .filter-header .filter-item .filter-desc img[data-v-c89c18e4] {\n        width: 10px;\n        height: 10px;\n}\n.zhkf .filter-header .filter-item:first-child .filter-desc[data-v-c89c18e4] {\n      border-left: 0;\n}\n.zhkf .filter-header .filter-item__active[data-v-c89c18e4] {\n    color: #0085ff;\n}\n.zhkf .filter-header .filter-item__active .filter-desc .icon-hebingxingzhuang1[data-v-c89c18e4],\n    .zhkf .filter-header .filter-item__active .filter-desc .icon-hebingxingzhuang[data-v-c89c18e4] {\n      color: #0085ff;\n}\n.zhkf .filter-header .filter-item__disabled[data-v-c89c18e4] {\n    color: #a0a0a0;\n}\n.zhkf .filter-header .filter-item__disabled .filter-desc .icon-hebingxingzhuang1[data-v-c89c18e4],\n    .zhkf .filter-header .filter-item__disabled .filter-desc .icon-hebingxingzhuang[data-v-c89c18e4] {\n      color: #a0a0a0;\n}\n.zhkf .filter-content[data-v-c89c18e4] {\n  width: 100%;\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.35);\n  z-index: 9999;\n}\n.zhkf .filter-content .filter-list[data-v-c89c18e4] {\n    background: #fff;\n    max-height: 320px;\n    overflow: scroll;\n}\n.zhkf .filter-content .filter-list .filter-cell[data-v-c89c18e4] {\n      height: 40px;\n      line-height: 40px;\n      padding: 0 15px;\n      font-size: 14px;\n      color: #606060;\n}\n.zhkf .filter-content .filter-list .filter-cell[data-v-c89c18e4]:last-child {\n        border-bottom: 0;\n}\n.zhkf .filter-content .filter-list .filter-cell__active[data-v-c89c18e4] {\n      color: #0085ff;\n}\n",""])},"43ee":function(e,t,n){"use strict";n("c904");var o=n("fd50"),i=n("a14a"),r=n.n(i),a=n("d49d"),l=function(){var e={unitId:"",list:[],currRoom:{}},t={getRoomList:function(){return a["a"].getRoomList(e.unitId).then((function(t){var n=[];if(console.log(t),t){var o=r.a.groupBy(t,"floor");console.log(o),r.a.each(o,(function(e,t){var o={};o.floor=t,o.roomList=[],o.no=t,console.log(e),r.a.each(e,(function(e){o.roomList.push({id:e.id,room_no:e.room_no,count:e.count})})),o.roomList=o.roomList.sort((function(e,t){return t.room_no-e.room_no})),n.push(o)})),n=n.sort((function(e,t){return t.no-e.no})),e.list=n}}))}};return{model:e,initRoomList:function(n,i){return n||e.unitId?(e.list=[],n&&(e.unitId=n),i&&(e.currRoom={}),t.getRoomList()):o["a"].reject("无效的单元")},refresh:function(){return t.getRoomList()},checkHasUpload:function(e){return a["a"].checkHasUpload(e)}}};t["a"]=l()},"99ee":function(e,t,n){"use strict";n("c904");var o=n("fd50"),i=n("a14a"),r=n.n(i),a=n("ff29"),l=function(){var e={unitId:"",list:[],currRoom:{}},t={getRoomList:function(){return a["a"].getRoomList(e.unitId).then((function(t){var n=[];if(console.log(t),t){var o=r.a.groupBy(t,"floor");console.log(o),r.a.each(o,(function(e,t){var o={};o.floor=t,o.roomList=[],o.no=t,console.log(e),r.a.each(e,(function(e){o.roomList.push({id:e.id,room_no:e.room_no,count:e.count})})),o.roomList=o.roomList.sort((function(e,t){return t.room_no-e.room_no})),n.push(o)})),n=n.sort((function(e,t){return t.no-e.no})),e.list=n}}))}};return{model:e,initRoomList:function(n,i){return n||e.unitId?(e.list=[],n&&(e.unitId=n),i&&(e.currRoom={}),t.getRoomList()):o["a"].reject("无效的单元")},refresh:function(){return t.getRoomList()},checkHasUpload:function(e){return a["a"].checkHasUpload(e)}}};t["a"]=l()},acd3c:function(e,t,n){t=e.exports=n("690e")(!1),t.push([e.i,"\n.zhkf .dispatch-problem[data-v-3a55093e] {\n  height: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.zhkf .dispatch-problem .problem-list[data-v-3a55093e] {\n    overflow: scroll;\n    padding: 0 10px;\n    -webkit-box-flex: 1;\n        -ms-flex-positive: 1;\n            flex-grow: 1;\n    max-height: 100%;\n}\n.zhkf .dispatch-problem .problem-list .list-container[data-v-3a55093e] {\n      margin-bottom: 10px;\n}\n.zhkf .toggleBtn[data-v-3a55093e] {\n  color: #202020;\n  white-space: nowrap;\n}\n.zhkf .footer[data-v-3a55093e] {\n  background: #fff;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 7px 10px;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n}\n.zhkf .footer .item-left[data-v-3a55093e] {\n    width: 64px;\n    margin-right: 13px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    color: #0099ff;\n    font-size: 16px;\n}\n.zhkf .footer .item-left span[data-v-3a55093e] {\n      margin-left: 8px;\n}\n.zhkf .footer .btn-wrapper[data-v-3a55093e] {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    height: 45px;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n}\n.zhkf .footer .btn-wrapper li[data-v-3a55093e] {\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      text-align: center;\n      line-height: 45px;\n      font-size: 16px;\n      height: 45px;\n      -webkit-box-shadow: 0px 2px 4px 0px rgba(0, 133, 255, 0.2);\n              box-shadow: 0px 2px 4px 0px rgba(0, 133, 255, 0.2);\n      border-radius: 23px;\n}\n.zhkf .footer .btn-wrapper li.unusual[data-v-3a55093e], .zhkf .footer .btn-wrapper li.back[data-v-3a55093e] {\n        background: #fff;\n        color: #eb544d;\n}\n.zhkf .footer .btn-wrapper li.pass[data-v-3a55093e] {\n        background: -webkit-gradient(linear, right top, left top, from(#0085ff), to(#02b8ff));\n        background: linear-gradient(270deg, #0085ff 0%, #02b8ff 100%);\n        color: #fff;\n}\n.zhkf .footer .btn-wrapper li[data-v-3a55093e]:last-child {\n        background: -webkit-gradient(linear, right top, left top, from(#0085ff), to(#02b8ff)) !important;\n        background: linear-gradient(270deg, #0085ff 0%, #02b8ff 100%) !important;\n        color: #fff !important;\n}\n.zhkf .footer .btn-wrapper li.disabled[data-v-3a55093e] {\n        opacity: 0.5;\n}\n",""])},af4c:function(e,t,n){"use strict";n("e697");var o=n("fd50"),i=n("a18c"),r=n("99ee"),a=n("43ee"),l=n("a14a"),c=n.n(l),s=n("c6e3"),d=function(){return{getNotCheckFloorAndRoom:function(e,t){return o["a"].all([s["a"].getTodoUnitFloors(e),s["a"].getTodoRoomByUnitId(e,t)]).then((function(e){var t,n=e[0],o=e[1],i="0";(c.a.isEmpty(n)||1===n.length&&""===n[0].floor)&&(t=!0,n=[{floor:i}]);for(var r=0;r<n.length;r++){n[r].roomList=[];for(var a=0;a<o.length;a++)(t||o[a].floor===n[r].floor)&&(o[a].floor=t?i:o[a].floor,n[r].roomList.push(o[a]))}return c.a.filter(n,(function(e){return e.roomList&&e.roomList.length>0}))}))},checkHasUpload:function(e,t){return s["a"].checkHasUpload(e,t).then((function(e){return e&&!!e["id"]}))},getRoomInfo:function(e,t){return s["a"].getTodoBatchRoomById(e,t)}}},f=d(),u=function(){var e={floorList:[]},t={},n={special_checkitem:"检查",simulate:"检查",opening:"接待",online_opening:"拍摄",feedback_remain_reply:"回复",delivery:"交付",online_delivery:"交付",problem_remain_reinspect:"复验"};return t.init=function(n,i,r){return r=r||!1,r||n!==e.batchUnitId||i!==e.moduleType?(e.floorList=[],e.batchUnitId=n,e.moduleType=i,e.currRoom=null,e.currFloor=null,e.tip="",t.getRoomList().then((function(t){console.log(t,"floorlist-----"),e.floorList=t}))):o["a"].resolve()},t.getRoomList=function(){return"problem_remain_reinspect"===e.moduleType?t.getReinspectRoomList():"feedback_remain_reply"===e.moduleType?t.getReplyRoomList():t.getCheckRoomList()},t.getCheckRoomList=function(){return f.getNotCheckFloorAndRoom(e.batchUnitId,e.moduleType).then((function(t){return c.a.isEmpty(t)&&f.checkHasUpload(e.batchUnitId,e.moduleType).then((function(t){t&&(e.tip="您已经"+n[e.moduleType]+"完毕，请立即上传~")})),t}))},t.getReinspectRoomList=function(){return r["a"].initRoomList(e.batchUnitId).then((function(){return c.a.isEmpty(r["a"].model.list)&&r["a"].checkHasUpload(e.batchUnitId).then((function(t){t&&(e.tip="您已经"+n[e.moduleType]+"完毕，请立即上传~")})),r["a"].model.list}))},t.getReplyRoomList=function(){return a["a"].initRoomList(e.batchUnitId).then((function(){return c.a.isEmpty(a["a"].model.list)&&a["a"].checkHasUpload(e.batchUnitId).then((function(t){t&&(e.tip="您已经"+n[e.moduleType]+"完毕，请立即上传~")})),a["a"].model.list}))},t.getRoomInfo=function(e,t){return f.getRoomInfo(e,t)},t.removeRoom=function(){var n=c.a.find(e.currFloor.roomList,{id:e.currRoom.id}),o=c.a.indexOf(e.currFloor.roomList,n);o>-1&&e.currFloor.roomList.splice(o,1),c.a.isEmpty(e.currFloor.roomList)&&(o=c.a.indexOf(e.floorList,e.currFloor),o>-1&&e.floorList.splice(o,1)),c.a.isEmpty(e.floorList)&&(t.init(e.batchUnitId,e.moduleType,!0),i["a"].go(-2))},{model:e,init:t.init,updateRoomList:function(i){return c.a.isEmpty(e)||!e.moduleType?o["a"].resolve():(i=i||!1,i?t.removeRoom():"problem_remain_reinspect"===e.moduleType?r["a"].refresh().then((function(){c.a.isEmpty(r["a"].model.list)&&r["a"].checkHasUpload(e.batchUnitId).then((function(t){t&&(e.tip="您已经"+n[e.moduleType]+"完毕，请立即上传~")})),e.floorList=r["a"].model.list})):"feedback_remain_reply"!==e.moduleType?t.getRoomInfo(e.currRoom.id,e.moduleType).then((function(n){if(c.a.isEmpty(n)||"已检查"===n.check_status)return t.removeRoom();for(var o=e.currFloor.roomList.length,i=0;i<o;i++)if(e.currFloor.roomList[i].id===n.id){e.currFloor.roomList[i]=n;break}})):(c.a.isEmpty(a["a"].model.list)&&a["a"].checkHasUpload(e.batchUnitId).then((function(t){t&&(e.tip="您已经"+n[e.moduleType]+"完毕，请立即上传~")})),void(e.floorList=a["a"].model.list)))}}};t["a"]=u()},b40c:function(e,t,n){"use strict";n.r(t);n("5ab2"),n("e44b"),n("e10e"),n("6d57"),n("f0e6"),n("cc57");var o=n("28f8"),i=n("e786"),r=n("2297"),a=n("6583"),l=n("438a"),c=n("cda3"),s=n("1b3a"),d=n("c42d"),f=n("43ee"),u=n("f2de"),h=n("4778");function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}console.log(f["a"]);var g={name:"ReplyFeedback",components:{problemItem:i["a"],problemBtn:r["a"],topTip:a["a"],emptyPage:l["a"],PList:h["a"],problemFilter:c["a"]},data:function(){return{model:{},pageLoading:!1,loadingData:!1,finished:!1,hasNetwork:!0,hasMoreFeedbackData:!0,noFeedbackData:!1,canBatchPass:!1,showItem:!1,canBatchSendBack:!1,showEmpty:!1,isShowProjectChange:!1,emptySrc:n("b98c"),wrapperScrollTop:0,disabledReply:!0}},computed:p({},Object(u["e"])({currentBatchType:function(e){return e.app.global.currentBatchType},currentMenuType:function(e){return e.app.global.currentMenuType},currentItem:function(e){return e.projectList.currentItem},contentHeight:function(e){return e.app.global.contentHeight},footerHeight:function(e){return e.app.global.footerHeight}})),watch:{$route:function(e,t){"todo"===t.name?this.isShowProjectChange=!0:this.isShowProjectChange=!1,"todoFeedbackBack"===t.name&&this.init()},currentItem:function(e,t){"todo"===this.$route.name&&this.$route.name.indexOf("ReplyFeedback")>-1&&this.$router.isForward&&e&&e.id!==(t&&t.id)&&this.init()},showItem:function(e){e&&this.$refs.filterElement.maskClickHandler()}},activated:function(){this.$router.isForward?this.wrapperScrollTop=0:this.$refs.problemList.scrollTop=this.wrapperScrollTop},created:function(){this.getNetwork(),this.init()},methods:{getNetwork:function(){var e=this;return d["a"].getHasNetwork().then((function(t){e.hasNetwork=t}))},init:function(){var e=this;this.showEmpty=!1,this.pageLoading=!0,s["a"].init(!0).finally((function(){e.pageLoading=!1,e.model=s["a"].model,console.log(e.model,"=========="),e.updatePageStatus(),e.model.list.length||(e.showEmpty=!0)})).catch((function(e){return console.log(e.message)}))},getNext:function(){return this.showEmpty=!1,s["a"].toNextRoom()},selectItem:function(e){if(!this.hasNetwork)return this.$toast("当前无网络，请联网操作"),!1;this.$set(e,"selected",!e.selected);var t=!0,n=this.model.list;this.disabledReply=!0;for(var o=0;o<n.length;o++)n[o].selected?this.disabledReply=!1:t=!1;console.log(this.disabledReply,"----disabled"),this.model.allSelected=t},openDetail:function(e){console.log(e),this.wrapperScrollTop=this.$refs.problemList.scrollTop,s["a"].currFeedback=e,this.$router.push({path:"/checkroom/".concat(this.currentMenuType||this.currentBatchType,"-feedback-detail"),query:{title:this.model.roomName,type:"todo"}})},select:function(){var e=this;this.disabledReply=this.model.allSelected,this.model.allSelected=!this.model.allSelected,console.log(this.model),this.model.list.forEach((function(t){e.$set(t,"selected",e.model.allSelected)}))},action:function(e){var t=this;return this.hasNetwork?s["a"].getSelected().then((function(e){if(!e.length)return t.$toast("请选择反馈项"),!1;var n=t.$route.query.batchRoomId;t.$router.push({path:"/checkroom/".concat(t.currentMenuType||t.currentBatchType,"-add-reply"),query:{from:"todo",ids:e,batch_room_id:n}})})):(this.$toast("当前无网络，请联网操作"),!1)},chooseFilterItem:function(e,t){var n=this;this.pageLoading=!0,console.log(e,t);var o=this.model.filterList,i=o.length;while(i--)(o[i]!==t||!o[i].id)&&(o[i].options=[]);console.log(t,"=======-=-=-=-"),s["a"].getFilter(t.type).then((function(){s["a"].resetPage(),s["a"].getFeedbackList(),model.filterList[0].id||(model.filterList[1].id="",model.filterList[1].name="",model.filterList[1].options=[]),n.updatePageStatus()})).finally((function(){n.pageLoading=!1}))},onLoad:function(){var e=this;if(console.log(this.hasMoreFeedbackData),!this.hasMoreFeedbackData)return this.loadingData=!1,this.finished=!0,!1;var t=this.model.currPage;return this.loadingData=!0,s["a"].loadMore().then((function(){e.updatePageStatus()})).finally((function(){e.hasMoreFeedbackData&&t===e.model.currPage&&(e.hasMoreFeedbackData=!1),e.loadingData=!1})).catch((function(e){return console.log(e)}))},updatePageStatus:function(){var e=this;this.hasMoreFeedbackData=this.model.currPage<this.model.totalPage,this.noFeedbackData=!this.model.list.length&&!this.hasMoreFeedbackData,this.model.allSelected&&this.model.list.forEach((function(t){e.$set(t,"selected",e.model.allSelected)}))}}},b=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"dispatch-problem",attrs:{flag:e.model.roomName}},[o("cus-nav-bar",{attrs:{title:e.model.roomName,"left-arrow":""},on:{"click-right":function(t){return e.getNext()}}},[o("div",{attrs:{slot:"title"},slot:"title"},[e.isShowProjectChange?o("p-list",{model:{value:e.showItem,callback:function(t){e.showItem=t},expression:"showItem"}}):e._e(),e._v(" "),e.isShowProjectChange?e._e():o("div",[e._v(e._s(e.model.roomName))])],1),e._v(" "),e.model.nextRoomId?o("div",{staticClass:"toggleBtn",attrs:{slot:"right"},slot:"right"},[e._v("下个房间")]):e._e()]),e._v(" "),o("empty-page",{attrs:{"show-empty":e.pageLoading,"loading-page":!0,"empty-msg":"正在加载问题，请稍等"}}),e._v(" "),o("empty-page",{attrs:{"show-empty":e.noFeedbackData,"empty-img-src":e.emptySrc,"empty-msg":"本地暂无问题，请先下载房间数据"}}),e._v(" "),o("top-tip",{attrs:{show:!e.hasNetwork,message:"当前无网络，请在有网络的时候进行指派",icon:n("02f9"),"icon-width":23}}),e._v(" "),e.model.filterList&&e.model.filterList.length&&!e.pageLoading&&!e.showEmpty?o("problem-filter",{ref:"filterElement",attrs:{"filter-list":e.model.filterList},on:{chooseItem:e.chooseFilterItem}}):e._e(),e._v(" "),e.model.list&&e.model.list.length&&!e.pageLoading&&!e.noFeedbackData?o("div",{ref:"problemList",staticClass:"problem-list"},[o("van-list",{staticClass:"list-container",attrs:{finished:e.finished},on:{load:e.onLoad},model:{value:e.loadingData,callback:function(t){e.loadingData=t},expression:"loadingData"}},e._l(e.model.list,(function(t){return o("problem-item",{key:t.id,attrs:{type:"reply",item:t},on:{selectItem:e.selectItem,openDetail:e.openDetail}})})),1)],1):e._e(),e._v(" "),!e.$checkRight("reply_feedback","online_opening")||e.showEmpty||e.noFeedbackData?e._e():o("div",{staticClass:"footer van-hairline--top"},[o("div",{staticClass:"item-left",on:{click:function(t){return t.stopPropagation(),e.select()}}},[o("img",{directives:[{name:"show",rawName:"v-show",value:e.model.allSelected,expression:"model.allSelected"}],attrs:{src:n("2985"),alt:"selected",width:"20",height:"20"}}),e._v(" "),o("img",{directives:[{name:"show",rawName:"v-show",value:!e.model.allSelected,expression:"!model.allSelected"}],attrs:{src:n("f97d"),alt:"select",width:"20",height:"20"}}),e._v(" "),o("span",[e._v("全选")])]),e._v(" "),e.$checkRight("reply_feedback","online_opening")?o("ul",{staticClass:"btn-wrapper"},[o("li",{staticClass:"pass",class:{disabled:e.disabledReply},on:{click:e.action}},[e._v("回复")])]):e._e()])],1)},v=[],k=n("d082");function x(e){n("11e0")}var y=!1,w=x,_="data-v-3a55093e",L=null,R=Object(k["a"])(g,b,v,y,w,_,L);t["default"]=R.exports},cda3:function(e,t,n){"use strict";n("cc57");var o={props:{filterList:{type:Array,default:function(){return[]}}},data:function(){return{top:0,showFilterContent:!1,currFilter:{},currIndex:""}},mounted:function(){this.initPosition()},updated:function(){this.initPosition()},methods:{initPosition:function(){var e=this.$refs.filterHeader;this.top=e.offsetTop+e.offsetHeight},changeFilter:function(e){return this.currFilter=this.filterList[e],this.currFilter.options.length<2?this.$toast("请先选择部位"):e===this.currIndex?(this.maskClickHandler(),this.currIndex="",!1):(this.currIndex=e,this.showFilterContent=!0,void this.$emit("changeFilter",e))},maskClickHandler:function(){this.showFilterContent=!1,this.currFilter={},this.currIndex=""},chooseItem:function(e,t){this.currFilter.name=this.currFilter.options[e].name,this.currFilter.id!=this.currFilter.options[e].id&&(this.currFilter.id=this.currFilter.options[e].id,console.log(this.currFilter),this.currFilter={},this.$emit("chooseItem",e,t))}}},i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"filter"},[o("ul",{ref:"filterHeader",staticClass:"filter-header van-hairline--bottom"},e._l(e.filterList,(function(t,n){return o("li",{key:n,staticClass:"filter-item",class:{"filter-item__active":e.currFilter.type===t.type||t.id,"filter-item__disabled":"checkItem"==t.type&&t.options.length<2},on:{click:function(t){return e.changeFilter(n)}}},[o("div",{staticClass:"filter-desc van-hairline--left"},[o("span",{staticClass:"filter-title"},[e._v(e._s(t.id?t.name:t.label))]),e._v(" "),o("i",{staticClass:"iconfont",class:e.currIndex===n&&e.showFilterContent?"icon-hebingxingzhuang":"icon-hebingxingzhuang1"})])])})),0),e._v(" "),e.showFilterContent?o("div",{staticClass:"filter-content",style:{top:e.top+"px"},on:{click:e.maskClickHandler}},[o("ul",{staticClass:"filter-list"},e._l(e.currFilter.options,(function(t,i){return o("li",{key:i,staticClass:"filter-cell van-hairline--bottom",class:{"filter-cell__active":e.currFilter.id===t.id},on:{click:function(t){return e.chooseItem(i,e.currFilter)}}},[o("span",{staticClass:"pull-left check"},[o("img",{directives:[{name:"show",rawName:"v-show",value:e.currFilter.id===t.id,expression:"currFilter.id === item.id"}],attrs:{width:"13",src:n("2cf73"),alt:""}})]),e._v(" "),o("span",{staticClass:"pull-left"},[e._v(e._s(t.name))]),e._v(" "),o("span",{staticClass:"pull-right"},[e._v(e._s(t.count))])])})),0)]):e._e()])},r=[],a=n("d082");function l(e){n("1ec3")}var c=!1,s=l,d="data-v-c89c18e4",f=null,u=Object(a["a"])(o,i,r,c,s,d,f);t["a"]=u.exports},d49d:function(e,t,n){"use strict";var o=n("fd50"),i=n("4325"),r=n("a14a"),a=n.n(r),l=function(){var e={},t={position:i["a"].getPositionFilter,checkItem:i["a"].getCheckItemFilter};return e.getRoomList=function(e){return i["a"].getReplyRooms(e)},e.getFeedbackListByBatchRoomId=function(e,t,n){return e.batchRoomId?i["a"].getFeedbackListByBatchRoomId(e,t,n).then((function(e){return e})):o["a"].reject("获取问题列表失败")},e.getFeedbackFilters=function(e,n){if(!e.batchRoomId)return o["a"].reject();var i=a.a.cloneDeep(t),r=[];return delete i[n],e.position||delete i.checkItem,a.a.each(i,(function(n,o){r.push(function(n){return t[o](e).then((function(e){return{type:n,options:e}}))}(o))})),o["a"].all(r).then((function(e){var t={};return a.a.each(e,(function(e){var n=0;a.a.each(e.options,(function(e){n+=e.count})),e.options.unshift({name:"全部",count:n,id:""}),t[e.type]=e.options})),t}))},e.hasMoreFeedback=function(e){return i["a"].getFeedbackCount(e).then((function(e){return e.count>0}))},e.getAllFeedbackIds=function(e){return i["a"].getAllFeedbackIds(e).then((function(e){return e}))},e.checkHasUpload=function(e){return i["a"].hasUploadData(e).then((function(e){return e&&!!e["id"]}))},e};t["a"]=l()},ff29:function(e,t,n){"use strict";n("cc57"),n("e697"),n("9a33");var o=n("fd50"),i=n("4531"),r=n("760e"),a=n("a14a"),l=n.n(a),c=function(){var e={},t={position:i["a"].getPositionFilter,checkItem:i["a"].getCheckItemFilter,register:i["a"].getRegisterFilter};return e.getRoomList=function(e){return i["a"].getReinspectRooms(e)},e.getProblemListByBatchRoomId=function(e,t,n){return e.batchRoomId?i["a"].getProblemListByBatchRoomId(e,t,n).then((function(e){var t=[];return l.a.each(e,(function(e){e.desc=e.desc_id.split(";"),t=t.concat(e.desc)})),t=l.a.uniq(t),r["a"].getDescByIds(t).then((function(t){return l.a.each(e,(function(e){l.a.each(e.desc,(function(n,o){var i=l.a.find(t,{id:n});e.desc[o]=i?i.name:"无描述"})),e.desc=e.desc.join("；"),e.title=e.problem=e.position_name+"-"+e.item_name+"-"+e.desc+(e.remark?"；"+e.remark:"")})),e}))})):o["a"].reject("获取问题列表失败")},e.getProblemFilters=function(e,n){if(!e.batchRoomId)return o["a"].reject();var i=l.a.cloneDeep(t),r=[];return delete i[n],e.position||delete i.checkItem,l.a.each(i,(function(n,o){r.push(function(n){return t[o](e).then((function(e){return{type:n,options:e}}))}(o))})),o["a"].all(r).then((function(e){var t={};return l.a.each(e,(function(e){var n=0;l.a.each(e.options,(function(e){n+=e.count})),e.options.unshift({name:"全部",count:n,id:""}),t[e.type]=e.options})),t}))},e.hasMoreProblem=function(e){return i["a"].getProblemCount(e).then((function(e){return e.count>0}))},e.getAllProblemIds=function(e){return i["a"].getAllProblemIds(e).then((function(e){return e}))},e.checkHasUpload=function(e){return i["a"].hasUploadData(e).then((function(e){return e&&!!e["id"]}))},e};t["a"]=c()}}]);