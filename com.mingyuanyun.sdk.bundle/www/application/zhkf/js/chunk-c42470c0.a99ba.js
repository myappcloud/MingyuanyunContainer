(window["webpackJsonp_module_entry_zhkf_"]=window["webpackJsonp_module_entry_zhkf_"]||[]).push([["chunk-c42470c0"],{"0a1d":function(t,e,n){"use strict";n("6d57");var o=n("16ca"),a=n("fd50"),i=n("c6e3"),s=n("a324"),r=n("0523"),l=function(){var t=function(t,e){for(var n=0;n<t.length;n++){var o=t[n],a=!1,i=0,s=!0;if("已交付"!=o.delivery_status){for(var r=0;r<e.length;r++){var l=e[r];l.batch_room_id.toLowerCase()==o.id.toLowerCase()&&(a=!0,["待派单","待指派","待整改"].indexOf(l.status)>-1&&(o.room_status="待整改",s=!1),"已整改"===l.status&&(s=!1,i=1),"已通过"!==l.status&&(s=!1))}s||o.room_status?"待整改"===o.room_status&&(o.has_repaired=i):o.room_status="已整改","交付中"!=o.delivery_status||"暂不收楼"===o.delivery_situation||a&&!s?("待交付"!=o.delivery_status||a&&!s)&&("交付中"!=o.delivery_status||"暂不收楼"!=o.delivery_situation||a&&!s)||(o.room_status="待交付"):o.room_status="已交付"}else o.room_status="已交付"}return t},e=function(e){var n=[i["a"].getUnitFloors(e),i["a"].getUnitRooms(e),s["a"].getProblemListByBatchUnitId(e)];return a["a"].all(n).then((function(n){var o=n[0],a=n[1],i=n[2];return t(a,i),r["a"].buildRoomListData(e,o,a)}))};return{getRoomListByBatchUnit:e}},c=l(),u=function(){var t=function(t,e){for(var n=0;n<t.length;n++){for(var o=t[n],a=!1,i=0,s=!0,r=0;r<e.length;r++){var l=e[r];l.batch_room_id.toLowerCase()==o.id.toLowerCase()&&(a=!0,["待派单","待指派","待整改"].indexOf(l.status)>-1&&(o.room_status="待整改",s=!1),"已整改"===l.status&&(s=!1,i=1),"已通过"!==l.status&&(s=!1))}if(s||o.room_status?"待整改"===o.room_status&&(o.has_repaired=i):o.room_status="已整改",a?s&&("已接待"===o.opening_status?o.room_status="已接待":o.room_status="待接待"):"已接待"===o.opening_status?o.room_status="已接待":o.room_status="待接待",!o.room_status)throw new Error("room_status 赋值为空."+o.id)}return t},e=function(e){var n=[i["a"].getUnitFloors(e),i["a"].getUnitRooms(e),s["a"].getProblemListByBatchUnitId(e)];return a["a"].all(n).then((function(n){var o=n[0],a=n[1],i=n[2];return a=t(a,i),r["a"].buildRoomListData(e,o,a)}))};return{getRoomListByBatchUnit:e}},d=u(),f=function(){var t={simulate:[{name:"全部",key:"all",dot:"",less:0},{name:"待检查",key:"待检查",dot:"white",less:0},{name:"待整改",key:"待整改",dot:"red",less:0},{name:"已整改",key:"已整改",dot:"blue",less:0},{name:"已通过",key:"已通过",dot:"green",less:0}],delivery:[{name:"全部",key:"all",dot:"",less:0},{name:"待交付",key:"待交付",dot:"white",less:0},{name:"待整改",key:"待整改",dot:"red",less:0},{name:"已整改",key:"已整改",dot:"blue",less:0},{name:"已交付",key:"已交付",dot:"green",less:0}],online_delivery:[{name:"全部",key:"all",dot:"",less:0},{name:"待交付",key:"待交付",dot:"white",less:0},{name:"待整改",key:"待整改",dot:"red",less:0},{name:"已整改",key:"已整改",dot:"blue",less:0},{name:"已交付",key:"已交付",dot:"green",less:0}],opening:[{name:"全部",key:"all",dot:"",less:0},{name:"待接待",key:"待接待",dot:"white",less:0},{name:"待整改",key:"待整改",dot:"red",less:0},{name:"已整改",key:"已整改",dot:"blue",less:0},{name:"已接待",key:"已接待",dot:"green",less:0}]},e={simulate:o["a"],delivery:c,opening:d,online_delivery:c},n={tabs:[],items:{},lastView:{},status_sel:"全部",status_counter:0,display_rooms:[]};return{model:n,init:function(t,e){return this.model.batchType=t,this.model.unitId=e,this.model.tabs=this.getTabs(t),this.getRoomList(t,e)},updateRoomList:function(){var t=this.model,e=t.batchType,n=t.unitId;this.init(e,n)},getTabs:function(e){return t[e]},tabsInit:function(){var t=this.model.items.unit_list[0].status_counter;this.model.tabs.forEach((function(e){e.less=t[e.key]||0}))},getRoomList:function(t,n){var o=this;return"special_checkitem"===t&&(t="simulate"),e[t]&&e[t].getRoomListByBatchUnit?e[t].getRoomListByBatchUnit(n).then((function(t){o.model.items=t,o.iniRoomData(),o.tabsInit()})):Promise.resolve()},iniRoomData:function(){this.model.items["unit_sel"]=this.model.items.unit_list[0].unit,this.roomStatusClass(),this.model.status_sel=this.model.lastView&&this.model.lastView.status||"全部",this.filterRoomList(),this.model.status_counter=this.model.items.unit_list[0].status_counter},filterRoomList:function(){for(var t=this.model.items.unit_list[0].floor_list,e=[],n=0;n<t.length;n++){for(var o=t[n].room_list,a=[],i=!1,s=0;s<o.length;s++)"全部"!=this.model.status_sel&&o[s].room_status!=this.model.status_sel||(a.push(o[s]),i=!0);i&&e.push({floor:t[n].floor,room_list:a})}this.model.display_rooms=e,console.log(this.model.display_rooms,"------------楼栋数据------------")},roomStatusClass:function(){for(var t=n.items.unit_list,e=0;e<t.length;e++)for(var o=t[e].floor_list,a=0;a<o.length;a++){var i=o[a].room_list;o[a]["floor_show"]=!0;for(var s=0;s<i.length;s++){switch(i[s]["room_show"]=!0,i[s].room_status){case"待检查":i[s]["room_status_class"]="white";break;case"待整改":i[s]["room_status_class"]="red",i[s].has_repaired&&(i[s]["room_status_class"]+=" problem-repaired");break;case"已整改":i[s]["room_status_class"]="blue";break;case"已通过":case"已接待":case"已交付":i[s]["room_status_class"]="green";break;default:i[s]["room_status_class"]="white";break}i[s]["room_info"]=JSON.stringify({building_name:i[s].building_name,unit:i[s].unit,floor:i[s].floor,room_no:i[s].room_no})}}}}};e["a"]=f()},"16ca":function(t,e,n){"use strict";var o=n("fd50"),a=n("c6e3"),i=n("a324"),s=n("0523"),r=n("07a4"),l=n("af4c"),c=function(t,e){for(var n=0;n<e.length;n++){var o=e[n];if(o.batch_room_id.toLowerCase()==t.toLowerCase())return!1}return!0},u=function(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(0!=o.has_problem||0!=o.is_checked)if(c(o.id,e))t[n].room_status="已通过";else{for(var a=!0,i=0,s=0;s<e.length;s++){var r=e[s];if(o.id.toLowerCase()==r.batch_room_id.toLowerCase()){var l=["待派单","待指派","待整改"];l.indexOf(r.status)>-1&&(o.room_status="待整改",a=!1),"已整改"===r.status&&(a=!1,i=1)}}a?o.room_status="已通过":o.room_status?"待整改"===o.room_status&&(o.has_repaired=i):o.room_status="已整改"}else t[n].room_status="待检查"}return t},d=function(t){var e=[a["a"].getUnitFloors(t),a["a"].getUnitRooms(t),i["a"].getProblemListByBatchUnitId(t)];return o["a"].all(e).then((function(e){var n=e[0],o=e[1],a=e[2];return u(o,a),s["a"].buildRoomListData(t,n,o)}))};e["a"]={getRoomListByBatchUnit:d,updateCheckStatus:function(t){return a["a"].getRoomCheckStatus(t).then((function(t){t=t||{};var e=!t["is_checked"]||!t["check_date"]||!t["check_engineer"];return a["a"].updateCheckStatus(t,e)})).then((function(){"todo"===r["a"].state.app.global.currentMenuType&&l["a"].updateRoomList(!0)}))}}},"43ee":function(t,e,n){"use strict";n("c904");var o=n("fd50"),a=n("a14a"),i=n.n(a),s=n("d49d"),r=function(){var t={unitId:"",list:[],currRoom:{}},e={getRoomList:function(){return s["a"].getRoomList(t.unitId).then((function(e){var n=[];if(console.log(e),e){var o=i.a.groupBy(e,"floor");console.log(o),i.a.each(o,(function(t,e){var o={};o.floor=e,o.roomList=[],o.no=e,console.log(t),i.a.each(t,(function(t){o.roomList.push({id:t.id,room_no:t.room_no,count:t.count})})),o.roomList=o.roomList.sort((function(t,e){return e.room_no-t.room_no})),n.push(o)})),n=n.sort((function(t,e){return e.no-t.no})),t.list=n}}))}};return{model:t,initRoomList:function(n,a){return n||t.unitId?(t.list=[],n&&(t.unitId=n),a&&(t.currRoom={}),e.getRoomList()):o["a"].reject("无效的单元")},refresh:function(){return e.getRoomList()},checkHasUpload:function(t){return s["a"].checkHasUpload(t)}}};e["a"]=r()},4438:function(t,e,n){"use strict";var o=n("cb6b"),a=n("0e1c");e["a"]={getLocalBusinessToggle:function(){var t=o["a"].getObject(a["a"].BUSINESS_TOGGLE,o["a"].level.user);return t||{enable_opening_tab:0,enable_pass_when_add:0,enable_pass_when_to_repair:0,sign_when_receive_delivery:1,special_project_switch:0,take_photo_when_review:0,take_photo_when_regist:0,hide_owner_phone:0,enable_problem_reason:0}}}},"447b":function(t,e,n){"use strict";n("ed63");var o=n("fd50"),a=n("dfb1"),i=n("07a4"),s={getDeliveryBatchUnitList:function(t){var e=i["a"].state.projectList.currentItem.id,n=["online_delivery","online_delivery_center"],o=n.includes(t)?"在线交付":"交付";return a["a"].getDeliveryBatchUnitList(e,o)},getDeliveryBatchRoomData:function(t){var e=[a["a"].getDeliveryBatchRoomCount(t),a["a"].getDeliveryBatchRoomList(t)];return o["a"].all(e).then((function(t){var e={count:t[0],list:t[1]};return e}))},getDeliveryBatchRoomList:function(t){return a["a"].getDeliveryBatchRoomList(t)}};e["a"]=s},"5a4f":function(t,e,n){"use strict";n("5ab2"),n("6d57"),n("e44b"),n("e10e"),n("cc57");var o=n("28f8");function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){Object(o["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var s={name:"AppInput",model:{prop:"value",event:"change"},props:{type:{type:String,default:"text"},value:{type:String,default:""},name:{type:String,default:""}},computed:{text:{get:function(){return this.value},set:function(t){this.$emit("change",t)}},listeners:function(){return i(i({},this.$listeners),{},{change:function(){}})}},watch:{text:function(t){String(this.name).toLowerCase().indexOf("pwd")<0&&(this.text=t.slice(0,20))}},methods:{onBlur:function(){this.type}}},r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",t._g(t._b({directives:[{name:"model",rawName:"v-model.trim",value:t.text,expression:"text",modifiers:{trim:!0}}],staticClass:"app-input",attrs:{type:t.type,name:t.name},domProps:{value:t.text},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("submit")},blur:[function(e){return t.onBlur()},function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.text=e.target.value.trim())}}},"input",t.$attrs,!1),t.listeners))},l=[],c=n("d082");function u(t){n("d18a")}var d=!1,f=u,m="data-v-7ace17fb",p=null,h=Object(c["a"])(s,r,l,d,f,m,p);e["a"]=h.exports},"643f":function(t,e,n){"use strict";n.r(e);n("5ab2"),n("e44b"),n("e10e"),n("cc57"),n("6d57");var o=n("28f8"),a=n("5a4f"),i=n("65e1"),s=n("bdbb"),r=n("cb6b"),l=n("0e1c"),c=n("4438"),u=n("a6f0"),d=n("3fa2"),f=n("8326"),m=n("f2de"),p=n("0938"),h=n("c2c1"),_=n("ca33"),v=n("8ae6"),g=n("af4c"),b=n("0a1d"),y=n("b6fa");function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(o["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={components:{AppInput:a["a"],Rating:i["a"],TextBox:s["a"]},data:function(){return{baseInfo:{},score:3,showKeys:!1,keynumList:[],keynum:{value:0,text:"未留"},autoUpload:!1,signature_image_localpath:"",deliveryConfigViewTitle:"",canDialTelphone:!1,isShowPhone:!1,needSign:!1}},computed:x({},Object(m["e"])({enableDeliveryProcess:function(t){return t.app.global.enableDeliveryProcess},currentBatchType:function(t){return t.app.global.currentBatchType},currentMenuType:function(t){return t.app.global.currentMenuType}})),watch:{autoUpload:function(t){r["a"].set(l["a"].AUTO_UPLOAD_ROOM,t)}},created:function(){var t=this,e=this.$route.query.batchRoomId;this.batchRoomId=e,this.autoUpload=r["a"].getObject(l["a"].AUTO_UPLOAD_ROOM)||!1,this.isShowPhone=1!=c["a"].getLocalBusinessToggle().hide_owner_phone,this.deliveryConfigViewTitle=this.enableDeliveryProcess?"验房信息":"交付信息",this.receiveType="顺利收楼";var n=c["a"].getLocalBusinessToggle()||{};this.needSign=0!=n.sign_when_receive_delivery,f["a"].updateDelivery({electric_meter_degree:"",saved_electric_meter_degree:"",water_meter_degree:"",saved_water_meter_degree:"",gas_meter_degree:"",saved_gas_meter_degree:"",heating_pressure_degree:"",saved_heating_pressure_degree:"",signature_image_localpath:"",saved_signature_image_localpath:"",review_signature_image_localpath:"",saved_review_signature_image_localpath:"",satisfaction_remark:"",delivery_degree_items:[],delivery_record_items:[]}),this.keynumList=this.initkeynumList(20),u["a"].getDeliveryInfo(e).then((function(e){console.log(e,"============");for(var n=0;n<e.satisfactionList.length;n++)e.satisfactionList[n]["value"]=0;t.baseInfo={batch_unit_id:e.batch_unit_id,room_title:e.room_title,customer_name:e.customer_name,customer_phone:e.customer_phone,customers:e.customers,electric_meter_degree:"",water_meter_degree:"",gas_meter_degree:"",heating_pressure_degree:"",delivery_date:p["a"].getNowDate().substring(0,16),problemList:e.problemList,satisfactionList:e.satisfactionList,satisfaction_remark:e.remark||"",delivery_degree_items:e.delivery_degree_items||[],delivery_record_items:e.delivery_record_items||[]},t.baseInfo.customers&&t.baseInfo.customers.length&&t.baseInfo.customers.forEach((function(t,e){t.canDialTelphonee=t.customer_phone&&-1===t.customer_phone.indexOf("*")})),t.canDialTelphone=!1,t.baseInfo.customer_phone&&-1===t.baseInfo.customer_phone.indexOf("*")&&(t.canDialTelphone=!0);var o=t.baseInfo.problemList&&t.baseInfo.problemList.length>0?1:0;o&&(t.keynum={value:1,text:"1把"}),f["a"].updateDelivery({customer_phone:e.customer_phone,saved_customer_phone:e.customer_phone,satisfaction_remark:e.satisfaction_remark,keynum:o,saved_keynum:o,degree:e.satisfactionList,saved_degree:e.satisfactionList});for(var a=0;a<e.satisfactionList.length;a++){var i={};i["config_"+e.satisfactionList[a].id]=e.satisfactionList[a].value,i["saved_"+e.satisfactionList[a].id]=e.satisfactionList[a].value,f["a"].updateDelivery(i)}!0===e.hasRejection?t.receiveType="先拒收后收楼":t.baseInfo.problemList&&t.baseInfo.problemList.length>0&&(t.receiveType="先收楼后处理")}))},methods:{goBack:function(){var t=this;this.$dialog.confirm({message:"当前交付信息尚未提交，您确认要放弃吗？"}).then((function(){t.$router.go(-1)}))},selectKey:function(t){this.keynum=t,this.showKeys=!1},updateScore:function(t,e){this.baseInfo.satisfactionList[e].value=t;var n=this.baseInfo.satisfactionList[e].id;this.updateDeliveryStorage("config_"+n,t),console.log(t)},onChangeRemark:function(t){console.log(t),this.baseInfo.satisfaction_remark=t},initkeynumList:function(t){for(var e=[{value:-1,text:"无钥匙"},{value:0,text:"未留"}],n=1;n<=t;n++)e.push({value:n,text:n+" 把"});return e},updateDeliveryStorage:function(t,e){var n={};n[t]=e||"",f["a"].updateDelivery(n)},showSignImg:function(t){h["a"].openImageBrowser([t],0)},signImg:function(){var t=this,e=h["a"].openSign();e.then((function(e){e&&(t.signature_image_path=e,t.signature_image_localpath=v["a"].getImageRealPath(e),t.updateDeliveryStorage("signature_image_localpath",e))}))},delSignImg:function(){this.signature_image_path="",this.signature_image_localpath="",this.updateDeliveryStorage("signature_image_localpath","")},getElementTop:function(t){var e=t.offsetTop,n=t.offsetParent;while(null!==n)e+=n.offsetTop,n=n.offsetParent;return e},submitSaveDelivery:function(){for(var t=this,e=this.baseInfo.delivery_degree_items.concat(this.baseInfo.delivery_record_items),n=!0,o=0;o<e.length;o++){var a=e[o],i=a.value||"";if(a.is_required&&!i.trim()){n=!1;var s=this.$refs[a.id][0].offsetTop?this.$refs[a.id][0]:this.$refs[a.id][0].$el,r=this.getElementTop(s)-95,l=this.$refs["contentWrapper"].scrollTop;l-r>0&&(this.$refs["contentWrapper"].scrollTop=r),this.$refs[a.id][0].focus(),this.$toast("请输入"+a.item_name);break}}if(n){for(var c=this.baseInfo.satisfactionList,f=0;f<c.length;f++)if(!c[f].value)return this.$toast("请选择"+c[f].name),!1;if(this.needSign&&!this.signature_image_path)return this.$toast("请邀请业主签名",2e3),!1;this.$toast("正在提交...");var m={delivery_status:this.baseInfo.problemList&&this.baseInfo.problemList.length>0?"交付中":"已交付",delivery_situation:this.receiveType,customer_phone:this.baseInfo.customer_phone,water_meter_degree:this.baseInfo.water_meter_degree||null,electric_meter_degree:this.baseInfo.electric_meter_degree||null,gas_meter_degree:this.baseInfo.gas_meter_degree||null,heating_pressure_degree:this.baseInfo.heating_pressure_degree||null,key_saved_count:this.keynum.value,signature_image_localpath:this.signature_image_path||"",satisfaction_remark:this.baseInfo.satisfaction_remark,satisfactionList:this.baseInfo.satisfactionList,delivery_items:e};u["a"].saveDeliveryInfo(this.batchRoomId,m).then((function(e){d["a"].room.hasDeliveryInfo=!0;var n=t.currentMenuType||t.currentBatchType;"todo"===n?(t.$router.go(-1),g["a"].updateRoomList(!0)):"deliveryprocess"===n||"online_delivery_center"===n?y["a"].updateList():b["a"].updateRoomList(),!0===t.autoUpload?_["a"].uploadData(t.baseInfo.batch_unit_id,t.batchRoomId).then((function(){t.$toast.clear(),t.$toast("提交成功",1e3),d["a"].updateRoomInfo({assess_customer_status:"待评价",delivery_status:m.delivery_status}),d["a"].changeSatisfactionUploadFlag(t.batchRoomId),t.$router.go(-1)})):(t.$toast.clear(),t.$toast("提交成功",1e3),d["a"].updateRoomInfo({assess_customer_status:"待评价",delivery_status:m.delivery_status}),t.$router.go(-1))}),(function(e){t.$toast.clear(),t.$toast(e||"提交失败",2e3)}))}}}},L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"delivery-view yf-comp-wrapper"},[n("cus-nav-bar",{attrs:{title:t.deliveryConfigViewTitle,"left-arrow":"",border:!1,"use-click-left":""},on:{"click-left":function(e){return t.goBack()}}}),t._v(" "),n("div",{ref:"contentWrapper",staticClass:"content"},[n("div",{staticClass:"title"},[t._v("基础信息")]),t._v(" "),n("div",{staticClass:"base-info wrapper"},[n("div",{staticClass:"item"},[n("div",{staticClass:"base-label"},[t._v("房产")]),t._v(" "),n("div",{staticClass:"value"},[t._v(t._s(t.baseInfo.room_title))])]),t._v(" "),n("div",{staticClass:"item"},[n("div",{staticClass:"base-label"},[t._v("业主")]),t._v(" "),n("div",{staticClass:"value block"},t._l(t.baseInfo.customers,(function(e){return n("div",{staticClass:"customer",attrs:{Key:e.customer_name}},[n("span",{staticClass:"customer-name"},[t._v(t._s(e.customer_name))]),t._v(" "),e.canDialTelphonee?n("a",{attrs:{href:"tel:"+e.customer_phone}},[t._v(t._s(e.customer_phone))]):t._e(),t._v(" "),e.canDialTelphonee?t._e():n("span",{staticClass:"color-gray"},[t._v(t._s(e.customer_phone))])])})),0)])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.baseInfo.problemList&&t.baseInfo.problemList.length>0,expression:"baseInfo.problemList && baseInfo.problemList.length > 0"}],staticClass:"title"},[t._v("房间问题")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.baseInfo.problemList&&t.baseInfo.problemList.length>0,expression:"baseInfo.problemList && baseInfo.problemList.length > 0"}],staticClass:"problem-inof wrapper"},t._l(t.baseInfo.problemList,(function(e,o){return n("div",{key:o,staticClass:"problem-item"},[n("p",{staticClass:"h2"},[t._v(t._s(e.position_name)+" "+t._s(e.item_name))]),t._v(" "),n("p",{staticClass:"color-gray",staticStyle:{"padding-right":"10px"}},[t._v(t._s(e.desc))])])})),0),t._v(" "),n("div",{staticClass:"title"},[t._v("交付信息")]),t._v(" "),n("div",{staticClass:"delivery-info wrapper"},[n("van-cell-group",[n("van-cell",{attrs:{"is-link":"","arrow-direction":"down"},on:{click:function(e){t.showKeys=!0}}},[n("div",{staticClass:"cell-title",attrs:{slot:"title"},slot:"title"},[t._e(),t._v(" "),n("span",[t._v("钥匙留用")])]),t._v(" "),n("div",{staticClass:"black"},[t._v(t._s(t.keynum.text))])]),t._v(" "),t._l(t.baseInfo.delivery_degree_items,(function(e){return n("van-field",{key:e.id,ref:e.id,refInFor:!0,attrs:{"input-align":"right"},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"item.value"}},[n("div",{staticClass:"cell-title",attrs:{slot:"label"},slot:"label"},[e.is_required?n("span",{staticClass:"star"},[t._v("*")]):t._e(),t._v(" "),n("span",[t._v(t._s(e.item_name))])]),t._v(" "),n("div",{attrs:{slot:"right-icon"},slot:"right-icon"},[t._v(t._s(e.unit))])])}))],2),t._v(" "),t._l(t.baseInfo.delivery_record_items,(function(e){return n("div",{key:e.id,staticClass:"mt-10"},[n("van-cell",[n("div",{staticClass:"cell-title",attrs:{slot:"title"},slot:"title"},[e.is_required?n("span",{staticClass:"star"},[t._v("*")]):t._e(),t._v(" "),n("span",[t._v(t._s(e.item_name))])])]),t._v(" "),n("text-box",{ref:e.id,refInFor:!0,staticClass:"textbox van-hairline--bottom",attrs:{"max-length":e.max_length,placeholder:"请输入"+e.item_name},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"item.value"}})],1)})),t._v(" "),n("div",{staticClass:"satisfy-wrapper"},t._l(t.baseInfo.satisfactionList,(function(e,o){return n("div",{key:o,staticClass:"item"},[n("div",{staticClass:"satisfactionList-label"},[n("span",{staticClass:"star"},[t._v("*")]),t._v(" "),n("span",[t._v(t._s(e.name))])]),t._v(" "),n("div",{staticClass:"value"},[n("rating",{attrs:{score:e.value,disabled:!1,index:o},on:{"update:score":[function(n){return t.$set(e,"value",n)},t.updateScore]}})],1)])})),0)],2),t._v(" "),n("text-box",{staticClass:"textbox van-hairline--top van-hairline--bottom",attrs:{remark:t.baseInfo.satisfaction_remark,placeholder:"满意度说明/其他补充说明"},on:{input:t.onChangeRemark}}),t._v(" "),n("div",{staticClass:"sign wrapper"},[n("div",{staticClass:"item ali-center"},[n("div",{staticClass:"cell-title sign-label",attrs:{slot:"title"},slot:"title"},[t.needSign?n("span",{staticClass:"star"},[t._v("*")]):t._e(),t._v(" "),n("span",[t._v("业主签名")])]),t._v(" "),n("div",{staticClass:"value"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.signature_image_localpath,expression:"!signature_image_localpath"}],staticClass:"sign-btn",on:{click:function(e){return t.signImg()}}},[t._v("签名")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.signature_image_localpath,expression:"signature_image_localpath"}],staticClass:"sign-wrap ng-hide"},[n("img",{staticClass:"sign-img",attrs:{src:t.signature_image_localpath,width:"100",height:"50"},on:{click:function(e){return t.showSignImg(t.signature_image_localpath)}}}),t._v(" "),n("span",{staticClass:"del-wrap",on:{click:function(e){return e.stopPropagation(),t.delSignImg()}}},[t._m(0)])])])]),t._v(" "),n("div",{staticClass:"item"},[t._m(1),t._v(" "),n("div",{staticClass:"value checkbox"},[n("van-checkbox",{model:{value:t.autoUpload,callback:function(e){t.autoUpload=e},expression:"autoUpload"}})],1)])])],1),t._v(" "),n("div",{staticClass:"footer"},[n("ul",{staticClass:"btn-wrapper"},[n("li",{staticClass:"blue",on:{click:function(e){return t.submitSaveDelivery()}}},[t._v("提交")])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showKeys,expression:"showKeys"}],staticClass:"action-sheet"},[n("div",{staticClass:"picker-wrapper"},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.keynumList,"confirm-button-text":"完成","cancel-button-text":"关闭"},on:{cancel:function(e){t.showKeys=!1},confirm:t.selectKey}})],1),t._v(" "),n("div",{staticClass:"overlay",on:{click:function(e){t.showKeys=!1}}})])],1)},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"del-icon"},[n("span")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v("\n          提交后自动上传\n          "),n("span",{staticClass:"font-grey"},[t._v("(非Wifi网络会消耗流量)")])])}],R=n("d082");function C(t){n("8998")}var z=!1,O=C,U="data-v-3cab7568",T=null,D=Object(R["a"])(w,L,I,z,O,U,T);e["default"]=D.exports},"65e1":function(t,e,n){"use strict";n("163d");var o={name:"Rating",props:{score:{type:[String,Number],required:!0},index:{type:[String,Number],default:0},disabled:{type:Boolean,default:!1}},computed:{},methods:{getClass:function(t){return t<=parseInt(this.score,10)?"xingxing1":"xingxing"},setScore:function(t){this.disabled||this.$emit("update:score",t,this.index)}}},a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"rating"},t._l(5,(function(e){return n("span",{key:e,staticClass:"star",class:t.getClass(e),on:{click:function(n){return t.setScore(e)}}})})),0)},i=[],s=n("d082");function r(t){n("c1fd")}var l=!1,c=r,u="data-v-a6e622e0",d=null,f=Object(s["a"])(o,a,i,l,c,u,d);e["a"]=f.exports},7803:function(t,e,n){var o=n("5454");e=t.exports=n("690e")(!1),e.push([t.i,"\n.zhkf .star[data-v-a6e622e0] {\n  display: inline-block;\n  font-size: 18px;\n  width: 24px;\n  height: 24px;\n  margin-left: 8px;\n}\n.zhkf .star[data-v-a6e622e0]:first-child {\n    margin-left: 0;\n}\n.zhkf .xingxing[data-v-a6e622e0] {\n  background: url("+o(n("5ea5"))+") no-repeat;\n  background-size: 100%;\n}\n.zhkf .xingxing1[data-v-a6e622e0] {\n  background: url("+o(n("2470"))+") no-repeat;\n  background-size: 100%;\n}\n",""])},8998:function(t,e,n){var o=n("c08f");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var a=n("85cb").default;a("440dff16",o,!0,{})},"99ee":function(t,e,n){"use strict";n("c904");var o=n("fd50"),a=n("a14a"),i=n.n(a),s=n("ff29"),r=function(){var t={unitId:"",list:[],currRoom:{}},e={getRoomList:function(){return s["a"].getRoomList(t.unitId).then((function(e){var n=[];if(console.log(e),e){var o=i.a.groupBy(e,"floor");console.log(o),i.a.each(o,(function(t,e){var o={};o.floor=e,o.roomList=[],o.no=e,console.log(t),i.a.each(t,(function(t){o.roomList.push({id:t.id,room_no:t.room_no,count:t.count})})),o.roomList=o.roomList.sort((function(t,e){return e.room_no-t.room_no})),n.push(o)})),n=n.sort((function(t,e){return e.no-t.no})),t.list=n}}))}};return{model:t,initRoomList:function(n,a){return n||t.unitId?(t.list=[],n&&(t.unitId=n),a&&(t.currRoom={}),e.getRoomList()):o["a"].reject("无效的单元")},refresh:function(){return e.getRoomList()},checkHasUpload:function(t){return s["a"].checkHasUpload(t)}}};e["a"]=r()},af4c:function(t,e,n){"use strict";n("e697");var o=n("fd50"),a=n("a18c"),i=n("99ee"),s=n("43ee"),r=n("a14a"),l=n.n(r),c=n("c6e3"),u=function(){return{getNotCheckFloorAndRoom:function(t,e){return o["a"].all([c["a"].getTodoUnitFloors(t),c["a"].getTodoRoomByUnitId(t,e)]).then((function(t){var e,n=t[0],o=t[1],a="0";(l.a.isEmpty(n)||1===n.length&&""===n[0].floor)&&(e=!0,n=[{floor:a}]);for(var i=0;i<n.length;i++){n[i].roomList=[];for(var s=0;s<o.length;s++)(e||o[s].floor===n[i].floor)&&(o[s].floor=e?a:o[s].floor,n[i].roomList.push(o[s]))}return l.a.filter(n,(function(t){return t.roomList&&t.roomList.length>0}))}))},checkHasUpload:function(t,e){return c["a"].checkHasUpload(t,e).then((function(t){return t&&!!t["id"]}))},getRoomInfo:function(t,e){return c["a"].getTodoBatchRoomById(t,e)}}},d=u(),f=function(){var t={floorList:[]},e={},n={special_checkitem:"检查",simulate:"检查",opening:"接待",online_opening:"拍摄",feedback_remain_reply:"回复",delivery:"交付",online_delivery:"交付",problem_remain_reinspect:"复验"};return e.init=function(n,a,i){return i=i||!1,i||n!==t.batchUnitId||a!==t.moduleType?(t.floorList=[],t.batchUnitId=n,t.moduleType=a,t.currRoom=null,t.currFloor=null,t.tip="",e.getRoomList().then((function(e){console.log(e,"floorlist-----"),t.floorList=e}))):o["a"].resolve()},e.getRoomList=function(){return"problem_remain_reinspect"===t.moduleType?e.getReinspectRoomList():"feedback_remain_reply"===t.moduleType?e.getReplyRoomList():e.getCheckRoomList()},e.getCheckRoomList=function(){return d.getNotCheckFloorAndRoom(t.batchUnitId,t.moduleType).then((function(e){return l.a.isEmpty(e)&&d.checkHasUpload(t.batchUnitId,t.moduleType).then((function(e){e&&(t.tip="您已经"+n[t.moduleType]+"完毕，请立即上传~")})),e}))},e.getReinspectRoomList=function(){return i["a"].initRoomList(t.batchUnitId).then((function(){return l.a.isEmpty(i["a"].model.list)&&i["a"].checkHasUpload(t.batchUnitId).then((function(e){e&&(t.tip="您已经"+n[t.moduleType]+"完毕，请立即上传~")})),i["a"].model.list}))},e.getReplyRoomList=function(){return s["a"].initRoomList(t.batchUnitId).then((function(){return l.a.isEmpty(s["a"].model.list)&&s["a"].checkHasUpload(t.batchUnitId).then((function(e){e&&(t.tip="您已经"+n[t.moduleType]+"完毕，请立即上传~")})),s["a"].model.list}))},e.getRoomInfo=function(t,e){return d.getRoomInfo(t,e)},e.removeRoom=function(){var n=l.a.find(t.currFloor.roomList,{id:t.currRoom.id}),o=l.a.indexOf(t.currFloor.roomList,n);o>-1&&t.currFloor.roomList.splice(o,1),l.a.isEmpty(t.currFloor.roomList)&&(o=l.a.indexOf(t.floorList,t.currFloor),o>-1&&t.floorList.splice(o,1)),l.a.isEmpty(t.floorList)&&(e.init(t.batchUnitId,t.moduleType,!0),a["a"].go(-2))},{model:t,init:e.init,updateRoomList:function(a){return l.a.isEmpty(t)||!t.moduleType?o["a"].resolve():(a=a||!1,a?e.removeRoom():"problem_remain_reinspect"===t.moduleType?i["a"].refresh().then((function(){l.a.isEmpty(i["a"].model.list)&&i["a"].checkHasUpload(t.batchUnitId).then((function(e){e&&(t.tip="您已经"+n[t.moduleType]+"完毕，请立即上传~")})),t.floorList=i["a"].model.list})):"feedback_remain_reply"!==t.moduleType?e.getRoomInfo(t.currRoom.id,t.moduleType).then((function(n){if(l.a.isEmpty(n)||"已检查"===n.check_status)return e.removeRoom();for(var o=t.currFloor.roomList.length,a=0;a<o;a++)if(t.currFloor.roomList[a].id===n.id){t.currFloor.roomList[a]=n;break}})):(l.a.isEmpty(s["a"].model.list)&&s["a"].checkHasUpload(t.batchUnitId).then((function(e){e&&(t.tip="您已经"+n[t.moduleType]+"完毕，请立即上传~")})),void(t.floorList=s["a"].model.list)))}}};e["a"]=f()},b32e:function(t,e,n){e=t.exports=n("690e")(!1),e.push([t.i,"\n.zhkf .app-input[data-v-7ace17fb] {\n  display: block;\n  border: 0;\n  border-radius: 0;\n  outline: 0;\n  font-size: 14px;\n  background: transparent;\n}\n",""])},b6fa:function(t,e,n){"use strict";n("cc57"),n("6d57");var o=n("447b");e["a"]=function(){var t={display_rooms:[],tabs:[{name:"全部",key:"all_room_count",dot:""},{name:"待交付",key:"to_delivery_room_count",dot:"room-type1"},{name:"交付中",key:"",dot:"room-type2"},{name:"已交付",key:"deliveried_room_count",dot:"room-type4"}],filter:{current:{name:"全部",count:0},selectStatus:!1,options:[{name:"全部",count:0},{name:"扫码签到",count:0},{name:"交付资料审核",count:0},{name:"财务手续办理",count:0},{name:"物业手续办理",count:0},{name:"验房",count:0},{name:"领取礼品",count:0},{name:"暂不收楼",count:0}]},status_sel:"全部",count:{}},e={load:function(e,n){return o["a"].getDeliveryBatchRoomList({batch_unit_id:t.buildingId,status:e,name:n}).then((function(t){for(var e=[],n={"待交付":"room-type1","交付中":"room-type2","已交付":"room-type4"},o=0;o<t.length;o++){for(var a={floor:t[o].floor,room_list:[]},i=0;i<t[o].room_list.length;i++)a.room_list.push({room_no:t[o].room_list[i].room_no,room_status_class:n[t[o].room_list[i].status],id:t[o].room_list[i].room_id});e.push(a)}return e}))}};return{model:t,init:function(e){var n=this;return e&&(t.buildingId=e),t.status_sel="全部",t.filter.current={name:"全部",count:0},o["a"].getDeliveryBatchRoomData({batch_unit_id:t.buildingId,status:"全部"}).then((function(e){for(var o={count:e.count,list:[]},a={"待交付":"room-type1","交付中":"room-type2","已交付":"room-type4"},i=0;i<e.list.length;i++){for(var s={floor:e.list[i].floor,room_list:[]},r=0;r<e.list[i].room_list.length;r++)s.room_list.push({room_no:e.list[i].room_list[r].room_no,room_status_class:a[e.list[i].room_list[r].status],id:e.list[i].room_list[r].room_id});o.list.push(s)}return t.display_rooms=o.list,t.count=o.count,n.initFilter(),o}))},initFilter:function(){var e=t.count.deliveying_room_count.process_count;t.filter.options.forEach((function(n){"全部"==n.name?n.count=t.count.deliveying_room_count.count:n.count=e[n.name]})),t.filter.current.count=t.count.deliveying_room_count.count},updateList:function(){var e=this;this.load(t.status_sel).then((function(){e.initFilter()}))},load:function(n,o){return e.load(n,o).then((function(e){t.display_rooms=e}))}}}()},c08f:function(t,e,n){e=t.exports=n("690e")(!1),e.push([t.i,"\n.zhkf .cell-title[data-v-3cab7568] {\n  color: #303030;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.zhkf .cell-title .star[data-v-3cab7568] {\n    color: #f7554c;\n    margin-right: 3px;\n}\n.zhkf .mt-10[data-v-3cab7568] {\n  margin-top: 10px;\n}\n[data-v-3cab7568] .van-field__control {\n  line-height: 24px;\n}\n.zhkf .black[data-v-3cab7568] {\n  color: #303030;\n}\n.zhkf .satisfy-wrapper[data-v-3cab7568] {\n  background: #fff;\n  margin-top: 10px;\n  padding: 15px;\n}\n.zhkf .sign-btn[data-v-3cab7568] {\n  width: 80px;\n  height: 40px;\n  background: #f4f4f4;\n  text-align: center;\n  line-height: 40px;\n  color: #0099ff;\n  font-size: 15px;\n}\n.zhkf .ali-center[data-v-3cab7568] {\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.zhkf .customer[data-v-3cab7568] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.zhkf .customer .customer-name[data-v-3cab7568] {\n    margin-right: 5px;\n}\n.zhkf .customer a[data-v-3cab7568] {\n    color: #0099ff;\n}\n.zhkf .color-gray[data-v-3cab7568] {\n  color: #a0a0a0;\n}\n.zhkf .font-grey[data-v-3cab7568] {\n  color: #a8a8a8;\n  font-size: 12px;\n}\n.zhkf .textbox[data-v-3cab7568] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.zhkf .action-sheet[data-v-3cab7568] {\n  position: fixed;\n  background: rgba(0, 0, 0, 0.35);\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: column-reverse;\n          flex-direction: column-reverse;\n  z-index: 2002;\n}\n.zhkf .action-sheet .overlay[data-v-3cab7568] {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n}\n.zhkf .problem-item[data-v-3cab7568] {\n  margin-bottom: 16px;\n  font-size: 15px;\n}\n.zhkf .problem-item[data-v-3cab7568]:last-child {\n    margin-bottom: 0px;\n}\n.zhkf .problem-item .h2[data-v-3cab7568] {\n    margin-top: 0;\n    margin-bottom: 10px;\n}\n.zhkf .content[data-v-3cab7568] {\n  overflow: auto;\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.zhkf .content .title[data-v-3cab7568] {\n    height: 45px;\n    color: #606060;\n    font-size: 15px;\n    padding-left: 15px;\n    line-height: 45px;\n}\n.zhkf .content .wrapper[data-v-3cab7568] {\n    padding: 15px;\n    background: #fff;\n}\n.zhkf .content .wrapper.delivery-info[data-v-3cab7568] {\n      padding: 0;\n      background: transparent;\n}\n.zhkf .content .item[data-v-3cab7568] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    color: #202020;\n    font-size: 15px;\n    margin-bottom: 16px;\n}\n.zhkf .content .item[data-v-3cab7568]:last-child {\n      margin-bottom: 0px;\n}\n.zhkf .content .item .base-label[data-v-3cab7568] {\n      width: 70px;\n}\n.zhkf .content .item .delivery-label[data-v-3cab7568] {\n      -ms-flex-negative: 0;\n          flex-shrink: 0;\n      margin-right: 10px;\n}\n.zhkf .content .item .satisfactionList-label[data-v-3cab7568] {\n      width: 130px;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n}\n.zhkf .content .item .satisfactionList-label .star[data-v-3cab7568] {\n        color: #f7554c;\n        margin-right: 3px;\n}\n.zhkf .content .item .sign-label[data-v-3cab7568] {\n      width: 78px;\n}\n.zhkf .content .item .value[data-v-3cab7568] {\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n}\n.zhkf .content .item .value.checkbox[data-v-3cab7568] {\n        -webkit-box-orient: horizontal;\n        -webkit-box-direction: reverse;\n            -ms-flex-direction: row-reverse;\n                flex-direction: row-reverse;\n}\n.zhkf .content .item .value.block[data-v-3cab7568] {\n        display: block;\n}\n.zhkf .content .item .value .ipt[data-v-3cab7568] {\n        -webkit-box-flex: 1;\n            -ms-flex: 1;\n                flex: 1;\n        width: 100px;\n}\n.zhkf .content .item .value .unit[data-v-3cab7568] {\n        color: #a0a0a0;\n}\n.zhkf .content .item .value .arrow[data-v-3cab7568] {\n        color: #d2d2d7;\n        font-size: 14px;\n        margin-right: 7px;\n}\n.zhkf .sign-wrap[data-v-3cab7568] {\n  position: relative;\n  width: 100px;\n  height: 50px;\n}\n.zhkf .sign-wrap .sign-img[data-v-3cab7568] {\n  width: 100px;\n  height: 50px;\n}\n.zhkf .sign-wrap .del-wrap[data-v-3cab7568] {\n  display: inline-block;\n  position: absolute;\n  right: -12px;\n  top: -10px;\n  padding: 5px;\n}\n.zhkf .sign-wrap .del-icon[data-v-3cab7568] {\n  position: relative;\n  display: inline-block;\n  width: 15px;\n  height: 15px;\n  text-align: center;\n  overflow: hidden;\n  border-radius: 15px;\n  background-color: #ff4545;\n}\n.zhkf .sign-wrap .del-icon span[data-v-3cab7568] {\n  display: inline-block;\n  width: 9px;\n  height: 2px;\n  position: absolute;\n  top: 6px;\n  left: 3px;\n  background-color: #fff;\n}\n.zhkf .footer[data-v-3cab7568] {\n  background: #fff;\n}\n.zhkf .footer .btn-wrapper[data-v-3cab7568] {\n    width: 100%;\n    height: 100%;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    height: 45px;\n}\n.zhkf .footer .btn-wrapper li[data-v-3cab7568] {\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      text-align: center;\n      line-height: 45px;\n      font-size: 16px;\n}\n.zhkf .footer .btn-wrapper li.white[data-v-3cab7568] {\n        background: #fff;\n        color: #eb544d;\n}\n.zhkf .footer .btn-wrapper li.blue[data-v-3cab7568] {\n        background: #0099ff;\n        color: #fff;\n}\n",""])},c1fd:function(t,e,n){var o=n("7803");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var a=n("85cb").default;a("0c324747",o,!0,{})},d18a:function(t,e,n){var o=n("b32e");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var a=n("85cb").default;a("6599e76d",o,!0,{})},d49d:function(t,e,n){"use strict";var o=n("fd50"),a=n("4325"),i=n("a14a"),s=n.n(i),r=function(){var t={},e={position:a["a"].getPositionFilter,checkItem:a["a"].getCheckItemFilter};return t.getRoomList=function(t){return a["a"].getReplyRooms(t)},t.getFeedbackListByBatchRoomId=function(t,e,n){return t.batchRoomId?a["a"].getFeedbackListByBatchRoomId(t,e,n).then((function(t){return t})):o["a"].reject("获取问题列表失败")},t.getFeedbackFilters=function(t,n){if(!t.batchRoomId)return o["a"].reject();var a=s.a.cloneDeep(e),i=[];return delete a[n],t.position||delete a.checkItem,s.a.each(a,(function(n,o){i.push(function(n){return e[o](t).then((function(t){return{type:n,options:t}}))}(o))})),o["a"].all(i).then((function(t){var e={};return s.a.each(t,(function(t){var n=0;s.a.each(t.options,(function(t){n+=t.count})),t.options.unshift({name:"全部",count:n,id:""}),e[t.type]=t.options})),e}))},t.hasMoreFeedback=function(t){return a["a"].getFeedbackCount(t).then((function(t){return t.count>0}))},t.getAllFeedbackIds=function(t){return a["a"].getAllFeedbackIds(t).then((function(t){return t}))},t.checkHasUpload=function(t){return a["a"].hasUploadData(t).then((function(t){return t&&!!t["id"]}))},t};e["a"]=r()},ff29:function(t,e,n){"use strict";n("cc57"),n("e697"),n("9a33");var o=n("fd50"),a=n("4531"),i=n("760e"),s=n("a14a"),r=n.n(s),l=function(){var t={},e={position:a["a"].getPositionFilter,checkItem:a["a"].getCheckItemFilter,register:a["a"].getRegisterFilter};return t.getRoomList=function(t){return a["a"].getReinspectRooms(t)},t.getProblemListByBatchRoomId=function(t,e,n){return t.batchRoomId?a["a"].getProblemListByBatchRoomId(t,e,n).then((function(t){var e=[];return r.a.each(t,(function(t){t.desc=t.desc_id.split(";"),e=e.concat(t.desc)})),e=r.a.uniq(e),i["a"].getDescByIds(e).then((function(e){return r.a.each(t,(function(t){r.a.each(t.desc,(function(n,o){var a=r.a.find(e,{id:n});t.desc[o]=a?a.name:"无描述"})),t.desc=t.desc.join("；"),t.title=t.problem=t.position_name+"-"+t.item_name+"-"+t.desc+(t.remark?"；"+t.remark:"")})),t}))})):o["a"].reject("获取问题列表失败")},t.getProblemFilters=function(t,n){if(!t.batchRoomId)return o["a"].reject();var a=r.a.cloneDeep(e),i=[];return delete a[n],t.position||delete a.checkItem,r.a.each(a,(function(n,o){i.push(function(n){return e[o](t).then((function(t){return{type:n,options:t}}))}(o))})),o["a"].all(i).then((function(t){var e={};return r.a.each(t,(function(t){var n=0;r.a.each(t.options,(function(t){n+=t.count})),t.options.unshift({name:"全部",count:n,id:""}),e[t.type]=t.options})),e}))},t.hasMoreProblem=function(t){return a["a"].getProblemCount(t).then((function(t){return t.count>0}))},t.getAllProblemIds=function(t){return a["a"].getAllProblemIds(t).then((function(t){return t}))},t.checkHasUpload=function(t){return a["a"].hasUploadData(t).then((function(t){return t&&!!t["id"]}))},t};e["a"]=l()}}]);