(window["webpackJsonp_module_entry_zhkf_"]=window["webpackJsonp_module_entry_zhkf_"]||[]).push([["chunk-1d6d8ada"],{"0523":function(t,e,o){"use strict";o("6d57");var n=o("c6e3"),r=o("fd50"),i=o("a654"),a=o("c2c1"),s=o("8ae6"),l=function(t){return n["a"].getRoomBaseInfo(t)},c=function(t){return n["a"].getRoomCustomer(t)},u=function(t,e,o){var n,r={batch_unit_id:t,unit_list:[]},i="0";(_.isEmpty(e)||1===e.length&&""===e[0])&&(n=!0,e=[i]);var a={unit:[""],floor_list:[],status_counter:{all:0}};r.unit_list.push(a);for(var s=0;s<e.length;s++){var l=e[s],c={floor:l,room_list:[]};a.floor_list.push(c);for(var u=0;u<o.length;u++){var f=o[u];!n&&f.floor!=l||f.batch_unit_id!=t||(f.floor=n?i:f.floor,c.room_list.push(f),a.status_counter["all"]+=1,f.room_status in a.status_counter?a.status_counter[f.room_status]+=1:a.status_counter[f.room_status]=1)}}return r},f=function(t){return n["a"].getRoomIsReviewed(t)},d=function(t){return n["a"].getRoomTypeDiagram(t).then((function(t){if(!t)return!1;var e=r["a"].when(!1);return t.forEach((function(t){e=e.then((function(e){return e?r["a"].resolve(!0):a["a"].checkFileIsExists(Object(s["e"])()+t.path)}))})),e}))},m=function(t){return n["a"].getDiagramById(t).then((function(t){if(t){if("dev"==window.ZHKF_GLOBAL_ENV.VUE_APP_ENV)return t.url;var e=Object(s["e"])()+t.path;return console.log(e,"========================"),a["a"].checkFileIsExists(e).then((function(t){return t?e:null}))}return null}))},h=function(t){try{return d(t).catch((function(){return!1})).then((function(t){return!!t}))}catch(e){return console.error(e),r["a"].when(!1)}},p=function(t){return i["a"].existsDesignChange(t)},g=function(t){return i["a"].getDesignChange(t)},b=function(t,e){return i["a"].addDesignChangeProblem(t,e)},v=function(t){return l(t).then((function(t){return t.building_name+(t.unit?t.unit+(t.unit.indexOf("单元")>-1?"":"单元"):"")+(-1==t.floor.indexOf("层")&&-1==t.floor.indexOf("楼")&&-1==t.floor.indexOf("公共区域")?t.floor+"楼":t.floor)+(-1!==t.room_no.indexOf("公共区域")?t.floor+"层 公共区域":t.room_no)}))};e["a"]={getRoomBaseInfo:l,getRoomCustomer:c,buildRoomListData:u,getRoomIsReviewed:f,getRoomTypeImageFileIsExists:d,getRoomTypeImageFileIsExistsIgnoreError:h,existsRoomDesignChange:p,getRoomDesignChange:g,addRoomDesignChangeProblem:b,getRoomTitle:v,getDiagramFullPathById:m,getBatchRoomList:function(t,e){return n["a"].getBatchRoomList(t,e)}}},"25a4":function(t,e,o){e=t.exports=o("690e")(!1),e.push([t.i,"\n.zhkf .filter-content[data-v-09162e09] {\n  width: 100%;\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 109px;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.2);\n  z-index: 9999;\n}\n.zhkf .filter-content.isIos[data-v-09162e09] {\n    top: 130px;\n}\n.zhkf .filter-content.isIosx[data-v-09162e09] {\n    top: 150px;\n}\n.zhkf .filter-content .filter-list[data-v-09162e09] {\n    background: #fff;\n    max-height: 320px;\n    font-size: 14px;\n    color: #606060;\n    overflow: scroll;\n}\n.zhkf .filter-content .filter-list .filter-cell[data-v-09162e09] {\n      height: 40px;\n      line-height: 40px;\n      padding: 0 15px;\n}\n.zhkf .filter-content .filter-list .filter-cell[data-v-09162e09]:last-child {\n        border: none;\n}\n.zhkf .filter-content .filter-list .filter-cell__active[data-v-09162e09] {\n      color: #0085ff;\n}\n.zhkf .room-list[data-v-09162e09] {\n  height: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.zhkf .arrow[data-v-09162e09] {\n  font-size: 14px;\n  color: #d2d2d7;\n  margin-left: 3px;\n}\n.zhkf .content[data-v-09162e09] {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.zhkf .wrapper[data-v-09162e09] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.zhkf .toggleBtn[data-v-09162e09] {\n  color: #202020;\n  white-space: nowrap;\n}\n.zhkf .room-type1[data-v-09162e09] {\n  border: 1px solid #ccc;\n}\n.zhkf .room-type2[data-v-09162e09] {\n  background: #eb544d;\n  color: #fff;\n}\n.zhkf .room-type3[data-v-09162e09] {\n  background: #0099ff;\n  color: #fff;\n}\n.zhkf .room-type4[data-v-09162e09] {\n  background: #00cb59;\n  color: #fff;\n}\n.zhkf .tabs-wrapper[data-v-09162e09] {\n  position: relative;\n}\n.zhkf .tabs[data-v-09162e09] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 62px;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n  background: #fff;\n}\n.zhkf .tabs .tab[data-v-09162e09] {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    position: relative;\n}\n.zhkf .tabs .tab[data-v-09162e09]:last-child {\n      border: none;\n}\n.zhkf .tabs .tab .title[data-v-09162e09] {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n      -webkit-box-pack: center;\n          -ms-flex-pack: center;\n              justify-content: center;\n      font-size: 14px;\n}\n.zhkf .tabs .tab .title .dot[data-v-09162e09] {\n        width: 7px;\n        height: 7px;\n        border-radius: 50%;\n        margin-right: 3px;\n}\n.zhkf .tabs .tab .less[data-v-09162e09] {\n      text-align: center;\n      font-size: 12px;\n      color: #606060;\n}\n.zhkf .tabs .tab .line[data-v-09162e09] {\n      position: absolute;\n      bottom: -13px;\n      right: 50%;\n      -webkit-transform: translateX(50%);\n              transform: translateX(50%);\n      width: 24px;\n      height: 3px;\n      background: -webkit-gradient(linear, left top, right top, from(#1cb0fd), to(#0099ff));\n      background: linear-gradient(90deg, #1cb0fd 0%, #0099ff 100%);\n      border-radius: 3px;\n      z-index: 10;\n}\n.zhkf .rooms[data-v-09162e09] {\n  overflow: auto;\n  margin-top: 10px;\n}\n.zhkf .rooms .room[data-v-09162e09] {\n    padding: 4px 6px 19px 18px;\n    background: #fff;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n}\n.zhkf .rooms .room .floor[data-v-09162e09] {\n      padding-top: 20px;\n      width: 42px;\n      word-break: break-all;\n      text-align: center;\n      margin-right: 10px;\n      font-size: 14px;\n}\n.zhkf .rooms .room .floor .f20[data-v-09162e09] {\n        font-size: 20px;\n}\n.zhkf .rooms .room .floor-rooms[data-v-09162e09] {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-orient: horizontal;\n      -webkit-box-direction: normal;\n          -ms-flex-direction: row;\n              flex-direction: row;\n      -ms-flex-wrap: wrap;\n          flex-wrap: wrap;\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n}\n.zhkf .rooms .room .floor-rooms .floor-room[data-v-09162e09] {\n        height: 32px;\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n        padding: 0 16px;\n        border-radius: 2px;\n        margin-right: 12px;\n        margin-top: 15px;\n        font-size: 14px;\n}\n.zhkf .lou-ceng[data-v-09162e09] {\n  position: fixed;\n  bottom: 30px;\n  right: 15px;\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  border-radius: 50%;\n  font-size: 14px;\n  text-align: center;\n  color: #fff;\n  background: -webkit-gradient(linear, left top, left bottom, from(#02b8ff), to(#0085ff));\n  background: linear-gradient(to bottom, #02b8ff, #0085ff);\n}\n.zhkf .lou-ceng-content[data-v-09162e09] {\n  position: absolute;\n  width: 180px;\n  font-size: 16px;\n  background-color: #fff;\n  z-index: 11;\n}\n.zhkf .list-title[data-v-09162e09] {\n  height: 45px;\n  line-height: 45px;\n  padding-left: 15px;\n  font-weight: 500;\n  color: #303030;\n  border-bottom: 1px solid #ebebeb;\n}\n.zhkf .lc-mask[data-v-09162e09] {\n  position: absolute;\n  top: 0;\n  height: 100%;\n  width: 100%;\n  background-color: rgba(0, 0, 0, 0.35);\n}\n.zhkf .lc-list[data-v-09162e09] {\n  padding-bottom: 65px;\n  overflow: auto;\n  color: #909090;\n}\n.zhkf .lc-list div[data-v-09162e09] {\n    height: 45px;\n    line-height: 45px;\n    padding-left: 15px;\n}\n.zhkf .lc-list .active_div[data-v-09162e09] {\n    font-weight: 500;\n    color: #303030;\n    background-color: #efefef;\n}\n.zhkf .lc-list img[data-v-09162e09] {\n    width: 13px;\n    height: 10px;\n    margin-left: 115px;\n}\n",""])},"447b":function(t,e,o){"use strict";o("ed63");var n=o("fd50"),r=o("dfb1"),i=o("07a4"),a={getDeliveryBatchUnitList:function(t){var e=i["a"].state.projectList.currentItem.id,o=["online_delivery","online_delivery_center"],n=o.includes(t)?"在线交付":"交付";return r["a"].getDeliveryBatchUnitList(e,n)},getDeliveryBatchRoomData:function(t){var e=[r["a"].getDeliveryBatchRoomCount(t),r["a"].getDeliveryBatchRoomList(t)];return n["a"].all(e).then((function(t){var e={count:t[0],list:t[1]};return e}))},getDeliveryBatchRoomList:function(t){return r["a"].getDeliveryBatchRoomList(t)}};e["a"]=a},"5e92":function(t,e,o){"use strict";o.r(e);o("5ab2"),o("e44b"),o("e10e"),o("6d57"),o("cc57"),o("f0e6");var n=o("28f8"),r=o("438a"),i=o("f2de"),a=o("b6fa"),s=o("c42d"),l=o("db55"),c=o("ba1a");function u(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function f(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach((function(e){Object(n["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var d={components:{EmptyPage:r["a"]},filters:{format:function(t){return t.length>3?t.slice(0,2)+"...":t}},data:function(){return{model:a["a"].model,batchUnitId:"",title:"",batchType:"",status_counter:0,items:null,loading:!1,emptyImgSrc:o("5452"),emptyMsg:"当前楼栋/单元暂无交付的房间",hasNetwork:!0,isShowFloorList:!1,showRight:-180,currFloorIndex:0,wrapperScrollTop:0,isChangeTab:!1,offsetTopList:[]}},computed:f({},Object(i["e"])({currentBatchType:function(t){return t.app.global.currentBatchType},currentMenuType:function(t){return t.app.global.currentMenuType},isIOSX:function(t){return t.app.global.isIOSX},isIOS:function(t){return t.app.global.isIOS},headerHeight:function(t){return t.app.global.headerHeight},contentHeight:function(t){return t.app.global.contentHeight}})),activated:function(){0!==this.model.display_rooms.length||this.loading||(this.showEmpty=!0),this.$router.isForward?this.wrapperScrollTop=0:this.$refs.roomList.scrollTop=this.wrapperScrollTop},created:function(){this.init()},methods:{init:function(){var t=this,e=c["a"].getDecodeQuery(this.$route.query),o=e.unitId,n=e.unitName,r=e.batchId;this.batchId=r,this.title=n,s["a"].getHasNetwork().then((function(e){t.hasNetwork=e})),this.loading=!0,a["a"].init(o).finally((function(){t.loading=!1}))},select:function(t){var e=this;if(t.key){var o=t.name;this.model.filter.selectStatus=!1,this.model.status_sel=o,this.loading=!0,a["a"].load(o,"").finally((function(){e.loading=!1}))}else this.clickFilter();this.isChangeTab=!0,this.currFloorIndex=0,this.$refs.roomList.scrollTop=0,this.$refs.lcList.scrollTop=0},clickFilter:function(){this.model.filter.selectStatus=!this.model.filter.selectStatus},chooseItem:function(t){var e=this;this.model.filter.current={name:t.name,count:t.count},this.model.status_sel="交付中",this.model.filter.selectStatus=!1,this.loading=!0,a["a"].load("交付中","全部"==t.name?"":t.name).finally((function(){e.loading=!1}))},goRoom:function(t,e){this.wrapperScrollTop=this.$refs.roomList.scrollTop;var o={batchId:this.batchId,no:"",roomName:this.title+t+"楼"+e.room_no,signin_id:"",room_list:[{room_id:e.id,room_name:this.title+t+"楼"+e.room_no}]};l["a"].initModel(o),this.$router.push({path:"/checkroom/".concat(this.currentMenuType||this.currentBatchType,"-room"),query:{batchRoomId:e.id}})},showFloorList:function(){var t=this;window.$log("工作台-房间列表悬浮球点击"),this.isShowFloorList=!0,this.showRight=0,setTimeout((function(){if(t.$refs.roomList.scrollTop||t.isChangeTab){var e=document.getElementById("app").querySelectorAll(".room"),o=t.$refs.roomList.scrollTop+t.headerHeight+45;t.isChangeTab||!t.offsetTopList.length?(e.forEach((function(e,n){var r={};r["index"]=n,r["offsetTop"]=e.offsetTop,t.offsetTopList.push(r),e.offsetTop-o<45&&(t.currFloorIndex=n)})),t.isChangeTab&&(t.isChangeTab=!1)):t.offsetTopList.forEach((function(e){e.offsetTop-o<45&&(t.currFloorIndex=e.index)}))}else t.currFloorIndex=0;var n=t.$refs.lcList_items[t.currFloorIndex].offsetTop;n&&t.currFloorIndex>10?t.$refs.lcList.scrollTop=n-t.headerHeight-45:t.$refs.lcList.scrollTop=0}),200)},hideFloorList:function(t){var e=document.getElementById("app").querySelectorAll(".room");this.$refs.roomList.scrollTop=e[t].offsetTop-this.headerHeight-70,this.isShowFloorList=!1,this.showRight=-180}}},m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"room-list"},[n("cus-nav-bar",{attrs:{title:t.title,"left-arrow":""}}),t._v(" "),n("empty-page",{attrs:{"show-empty":!t.hasNetwork,"empty-msg":"当前网络异常，请稍后重试","empty-img-src":o("6233")}}),t._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"tabs-wrapper"},[n("ul",{staticClass:"tabs van-hairline--bottom"},t._l(t.model.tabs,(function(e){return n("li",{key:e.name,staticClass:"tab van-hairline--right",on:{click:function(o){return t.select(e)}}},[n("p",{staticClass:"title"},[e.dot?n("span",{staticClass:"dot",class:e.dot}):t._e(),t._v("\n            "+t._s(t._f("format")("全部"===t.model.filter.current.name||"交付中"!==e.name?e.name:t.model.filter.current.name))+"\n            "),"交付中"==e.name?n("i",{staticClass:"iconfont arrow",class:t.model.filter.selectStatus?"icon-hebingxingzhuang":"icon-hebingxingzhuang1"}):t._e()]),t._v(" "),n("p",{staticClass:"less"},[t._v("("+t._s(e.key?t.model.count[e.key]||0:t.model.filter.current.count||0)+")")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.name==t.model.status_sel,expression:"item.name == model.status_sel"}],staticClass:"line"})])})),0),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.model.filter.selectStatus,expression:"model.filter.selectStatus"}],staticClass:"filter-content",class:{isIos:t.isIOS,isIosx:t.isIOSX},on:{click:function(e){t.model.filter.selectStatus=!1}}},[n("ul",{staticClass:"filter-list"},t._l(t.model.filter.options,(function(e,o){return n("li",{key:o,staticClass:"filter-cell van-hairline--bottom",class:{"filter-cell__active":t.model.filter.current.name===e.name},on:{click:function(o){return o.stopPropagation(),t.chooseItem(e)}}},[n("span",{staticClass:"pull-left"},[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"pull-right"},[t._v(t._s(e.count))])])})),0)])]),t._v(" "),n("empty-page",{attrs:{"show-empty":t.loading,"loading-page":!0,"empty-msg":"正在统计您的房间，请耐心等待"}}),t._v(" "),n("empty-page",{attrs:{"show-empty":!t.loading&&0===t.model.display_rooms.length,"empty-msg":t.emptyMsg,"empty-img-src":t.emptyImgSrc}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&t.model.display_rooms.length>0,expression:"!loading && model.display_rooms.length > 0"}],staticClass:"wrapper"},[n("ul",{ref:"roomList",staticClass:"rooms",style:{height:t.contentHeight-62+"px"}},[t._l(t.model.display_rooms,(function(e){return n("li",{key:e.floor,staticClass:"room van-hairline--bottom"},[n("div",{staticClass:"floor"},[n("span",{class:{f20:/^\w*$/.test(e.floor)}},[t._v(t._s(e.floor))]),t._v(" "),n("span",[t._v("F")])]),t._v(" "),n("ul",{staticClass:"floor-rooms"},t._l(e.room_list,(function(o){return n("li",{key:o.id,staticClass:"floor-room",class:o.room_status_class,attrs:{"data-event":"用户点击","data-log":o.room_no},on:{click:function(n){return t.goRoom(e.floor,o)}}},[t._v(t._s(o.room_no))])})),0)])})),t._v(" "),n("li",{staticStyle:{height:"50px"}})],2)]),t._v(" "),n("div",{staticClass:"lou-ceng",on:{click:t.showFloorList}},[t._v("楼层")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowFloorList,expression:"isShowFloorList"}],staticClass:"lc-mask",on:{click:function(e){t.isShowFloorList=!1}}},[n("div",{on:{click:function(t){t.stopPropagation()}}},[n("div",{staticClass:"lou-ceng-content",style:{top:t.headerHeight+"px",right:t.showRight+"px"}},[n("div",{staticClass:"list-title"},[t._v("楼层选择")]),t._v(" "),n("div",{ref:"lcList",staticClass:"lc-list",style:{height:t.contentHeight+"px"}},[t._l(t.model.display_rooms,(function(e,o){return n("div",{key:o,ref:"lcList_items",refInFor:!0,class:o==t.currFloorIndex?"active_div":"",on:{click:function(e){return t.hideFloorList(o)}}},[t._v("\n              "+t._s(e.floor)+"\n              ")])})),t._v(" "),n("div",{staticStyle:{height:"50px"}})],2)])])])],1)],1)},h=[],p=o("d082");function g(t){o("ecfe")}var _=!1,b=g,v="data-v-09162e09",y=null,x=Object(p["a"])(d,m,h,_,b,v,y);e["default"]=x.exports},6013:function(t,e,o){"use strict";var n=o("07a4"),r=o("dfb1"),i=o("81ad"),a=o("c6e3"),s=o("9430"),l=o("a14a"),c=o.n(l),u={getDeliveryNodeList:function(){return r["a"].getDeliveryNodeList(n["a"].state.projectList.currentItem.id)},getTodoDeliveryDetail:function(t){return r["a"].getTodoDeliveryDetail(t)},uploadDeliveryConfirmInfo:function(t,e,o){return i["a"].uploadFiles(t,"deliveryProcess",e.room_id).then((function(t){console.log(t),t=c.a.uniq(t);var n={child_process:[{id:o,status:1,imgs:t}],reason:"",remark:""};return n=c.a.extend(n,e),r["a"].uploadProcessData(n)}))},uploadProcessData:function(t){return r["a"].uploadProcessData(t)},getProcessOperateLog:function(t){return r["a"].getProcessOperateLog(t)},getDeliveryConfirmInfo:function(t,e,o){return r["a"].getDeliveryConfirmInfo(t,e,o)},getRoomData:function(t,e){return a["a"].getBatchRoom(t,e)},assistSignIn:function(t){return r["a"].assistSignIn(t)},hasUploadData:function(t){return s["a"].existsBatchRoomUploadData(t)}};e["a"]=u},a654:function(t,e,o){"use strict";var n=o("1834"),r=o("0938");e["a"]={existsDesignChange:function(t){var e="select 1 from room_design_change a inner join batch_room b on a.room_id = b.room_id where b.id = ?";return n["a"].queryOne(e,[t]).then((function(t){return!_.isEmpty(t)}))},getDesignChange:function(t){var e="select a.id, a.location, a.content, a.remark, a.sort from room_design_change a inner join batch_room b on a.room_id = b.room_id where b.id = ? order by a.sort";return n["a"].query(e,[t])},addDesignChangeProblem:function(t,e){if(t&&e){var o=r["a"].uuid();n["a"].insert("room_design_change_problem",["id","design_change_id","checkroom_problem_id"],[o,e,t])}}}},b6fa:function(t,e,o){"use strict";o("cc57"),o("6d57");var n=o("447b");e["a"]=function(){var t={display_rooms:[],tabs:[{name:"全部",key:"all_room_count",dot:""},{name:"待交付",key:"to_delivery_room_count",dot:"room-type1"},{name:"交付中",key:"",dot:"room-type2"},{name:"已交付",key:"deliveried_room_count",dot:"room-type4"}],filter:{current:{name:"全部",count:0},selectStatus:!1,options:[{name:"全部",count:0},{name:"扫码签到",count:0},{name:"交付资料审核",count:0},{name:"财务手续办理",count:0},{name:"物业手续办理",count:0},{name:"验房",count:0},{name:"领取礼品",count:0},{name:"暂不收楼",count:0}]},status_sel:"全部",count:{}},e={load:function(e,o){return n["a"].getDeliveryBatchRoomList({batch_unit_id:t.buildingId,status:e,name:o}).then((function(t){for(var e=[],o={"待交付":"room-type1","交付中":"room-type2","已交付":"room-type4"},n=0;n<t.length;n++){for(var r={floor:t[n].floor,room_list:[]},i=0;i<t[n].room_list.length;i++)r.room_list.push({room_no:t[n].room_list[i].room_no,room_status_class:o[t[n].room_list[i].status],id:t[n].room_list[i].room_id});e.push(r)}return e}))}};return{model:t,init:function(e){var o=this;return e&&(t.buildingId=e),t.status_sel="全部",t.filter.current={name:"全部",count:0},n["a"].getDeliveryBatchRoomData({batch_unit_id:t.buildingId,status:"全部"}).then((function(e){for(var n={count:e.count,list:[]},r={"待交付":"room-type1","交付中":"room-type2","已交付":"room-type4"},i=0;i<e.list.length;i++){for(var a={floor:e.list[i].floor,room_list:[]},s=0;s<e.list[i].room_list.length;s++)a.room_list.push({room_no:e.list[i].room_list[s].room_no,room_status_class:r[e.list[i].room_list[s].status],id:e.list[i].room_list[s].room_id});n.list.push(a)}return t.display_rooms=n.list,t.count=n.count,o.initFilter(),n}))},initFilter:function(){var e=t.count.deliveying_room_count.process_count;t.filter.options.forEach((function(o){"全部"==o.name?o.count=t.count.deliveying_room_count.count:o.count=e[o.name]})),t.filter.current.count=t.count.deliveying_room_count.count},updateList:function(){var e=this;this.load(t.status_sel).then((function(){e.initFilter()}))},load:function(o,n){return e.load(o,n).then((function(e){t.display_rooms=e}))}}}()},db55:function(t,e,o){"use strict";o("5ab2"),o("e10e");var n=o("28f8"),r=(o("e697"),o("6d57"),o("e44b"),o("cc57"),o("fd50")),i=o("07a4"),a=o("a18c"),s=o("6013"),l=o("0523"),c=o("ca33"),u=o("a593");function f(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function d(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?f(Object(o),!0).forEach((function(e){Object(n["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):f(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}e["a"]=function(){var t={},e={},o={review_material:"delivery_review_material",handle_finance:"delivery_handle_finance",handle_property:"delivery_handle_property",check_room:"delivery_check_room",give_gift:"delivery_receive_gift",delivery_confirm:"delivery_confirm"};return e.getConditions=function(){return{batchId:t.roomInfo.batchId,roomId:t.roomInfo.room_list[t.currRoomIndex].room_id}},e.gotoNextRoom=function(){var o=t.roomInfo.room_list.length;return t.currRoomIndex<o-1?(t.currRoomIndex+=1,t.currRoom=t.roomInfo.room_list[t.currRoomIndex],e.load()):r["a"].resolve()},e.load=function(){var n=e.getConditions();return s["a"].getTodoDeliveryDetail(n).then((function(n){t.nodeList=[],t.baseInfo.delivery_qualification=n.delivery_qualification,t.baseInfo.appointment_process_list=n.appointment_process_list||[],t.baseInfo.checkroom_type=n.checkroom_type,t.baseInfo.delivery_unqualified_reason=n.delivery_unqualified_reason,t.baseInfo.hasTag=!1,t.baseInfo.room_name=t.roomInfo.room_list[t.currRoomIndex].room_name,t.baseInfo.customers=[],t.no="",_.each(n.customer_list,(function(e){t.baseInfo.customers.push({customerName:e.customer_name,customerPhone:e.customer_phone,canDialTelphonee:-1===e.customer_phone.indexOf("*"),hasTag:e.has_tag}),1==e.has_tag&&(t.baseInfo.hasTag=!0)})),n.no&&(t.no=n.no),n.signin_id&&(t.roomInfo.signin_id=n.signin_id);var r=i["a"].state.app.global.currentBatchType;_.each(t.sourseData,(function(e,i){var a={name:e.name,id:i,child_node:[],type:o[e.function_code],status:n.process[i]&&1==n.process[i].status?n.process[i].status:0,authRight:u["default"].prototype.$checkRight("view_room",r)&&u["default"].prototype.$checkRight(e.function_code,r)};_.each(e.child_process,(function(t,e){var o={name:t.name,type:t.type,remark:t.remark,id:e};n.process[i]&&1==n.process[i].status&&n.process[i].child_process[e]&&n.process[i].child_process[e].status?o["status"]=n.process[i].child_process[e].status:o["status"]=0,a.child_node.push(o)})),t.nodeList.push(a)}));for(var a=0;a<t.nodeList.length;a++){for(var s=!1,l=0;l<t.nodeList[a].child_node.length;l++)1==t.nodeList[a].child_node[l].status&&(s=!0);t.nodeList[a]["showStatus"]=s}return e.updateCheckroomNode().then((function(){return t.nodeList}))}))},e.updateCheckroomNode=function(){var e=r["a"].when();return t.currRoom.batchRoomId||(e=l["a"].getBatchRoomList(t.roomInfo.batchId,[t.currRoom.room_id]).then((function(e){return!_.isEmpty(e)&&(t.currRoom.batchRoomId=e[0].id,!0)}))),e.then((function(e){if(!1!==e)return s["a"].hasUploadData(t.currRoom.batchRoomId).then((function(e){if(_.isEmpty(e))return r["a"].resolve();var o=_.find(t.nodeList,{type:"delivery_check_room"});if(o){var n=!1;e.forEach((function(t){o.child_node.forEach((function(e){("问题"===t.type&&"登记问题"===e.name||"房间"===t.type&&"登记问题"!==e.name)&&(e.status=1),n=n||1==e.status}))})),o.showStatus=n,o.status=1,o.hasUpload=!0}}))}))},{model:t,initModel:function(e){t.roomInfo=e,t.currRoomIndex=0,t.currRoom=t.roomInfo.room_list[0],t.baseInfo={customers:[]};for(var o=t.roomInfo.room_list.length,n=0;n<o;n++)t.roomInfo.room_list[n].ans=n},init:function(){return s["a"].getDeliveryNodeList().then((function(o){return t.sourseData=o,_.each(t.sourseData,(function(t,e){_.each(t.child_process,(function(t,e){t.type=t.type.substr(0,t.type.length-1)}))})),e.load()}))},gotoNextRoom:function(){return e.gotoNextRoom()},gotoCheckRoom:function(){var e=i["a"].state.app.global.currentBatchType,o={deliveryprocess:{name:"正式交付",type:"交付",batch_type:"delivery",from:"deliveryprocess"},online_delivery_center:{name:"在线交房",type:"在线交付",batch_type:"online_delivery",from:"online_delivery_center"}},n=o[e]["batch_type"];return s["a"].getRoomData(t.roomInfo.batchId,t.currRoom.room_id).then((function(r){if(!_.isEmpty(r)){var s={batchRoomId:r.id,roomId:r.room_id,building_id:r.building_id,batch_unit_id:r.batch_unit_id,type:n,fitment_standard:r.fitment_standard,roomTitle:r.building_name+r.room_no,menuType:i["a"].state.app.global.currentMenuType,batch_id:t.roomInfo.batchId};return l["a"].getRoomTypeImageFileIsExists(r.id).then((function(t){t?(s.mode="0",s.isImageExists=!0):s.from=e,console.log("/checkroom/".concat(n,"-roomdetail")),a["a"].push({path:"/checkroom/".concat(n,"-roomdetail"),query:d(d({},s),{},{from:e})})}))}return i["a"].commit("app/APP",{currentBatchType:n}),a["a"].push({path:"/checkroom/".concat(n,"-batch-unit"),query:o[e]})}))},load:function(){return e.load()},uploadRoomData:function(e){return s["a"].getRoomData(t.roomInfo.batchId,t.currRoom.room_id).then((function(t){return c["a"].uploadData(t.batch_unit_id,t.id).then((function(){e.hasUpload=!1}))}))}}}()},ecfe:function(t,e,o){var n=o("25a4");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var r=o("85cb").default;r("5538055a",n,!0,{})}}]);