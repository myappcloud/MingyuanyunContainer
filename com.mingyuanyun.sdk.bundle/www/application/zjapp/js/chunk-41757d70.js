(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-41757d70","chunk-59fa3e5d","chunk-0b5b35be","chunk-b1eec014"],{"010c":function(e,t,i){"use strict";i("3646")},"0732":function(e,t,i){var a=i("81f2");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("1b5b07de",a,!0,{sourceMap:!1,shadowMode:!1})},"0748":function(e,t,i){"use strict";i("3cc7")},"0cb6":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .problem-detail-header[data-v-0901aadd]{display:flex;align-items:center;justify-content:center;height:40px;padding:0 15px;line-height:40px;background-color:#f2f2f2}.zjapp .problem-detail-header .status[data-v-0901aadd]{flex:1;height:16px;line-height:16px;border-left:5px solid #ddd;padding-left:5px;color:#111;font-size:16px}.zjapp .problem-detail-header .status-red[data-v-0901aadd]{border-color:#ff3d3d}.zjapp .problem-detail-header .status-blue[data-v-0901aadd]{border-color:#4275e8}.zjapp .problem-detail-header .status-green[data-v-0901aadd]{border-color:#0bc666}.zjapp .problem-detail-header .status-orange[data-v-0901aadd]{border-color:#fc8b01}.zjapp .problem-detail-header .status-black[data-v-0901aadd]{border-color:#333}.zjapp .problem-detail-header .status-gray[data-v-0901aadd]{border-color:#999}.zjapp .problem-detail-header .return[data-v-0901aadd],.zjapp .problem-detail-header .timeout[data-v-0901aadd],.zjapp .problem-detail-header .urgent[data-v-0901aadd]{display:block;padding:0 5px;margin-left:6px;height:16px;line-height:16px;color:#fff;font-size:12px;border-radius:2px;-webkit-border-radius:2px}.zjapp .problem-detail-header .urgent[data-v-0901aadd]{background-color:#ff3d3d}.zjapp .problem-detail-header .timeout[data-v-0901aadd]{background-color:#954cfe}.zjapp .problem-detail-header .return[data-v-0901aadd]{background-color:#fc8b01}.zjapp .problem-detail-header .operat[data-v-0901aadd]{height:40px;line-height:40px;white-space:nowrap;font-size:16px;color:#6b7ba9}",""])},1304:function(e,t,i){"use strict";var a=i("c5a7");t.__esModule=!0,t.SlotsMixin=void 0;var s=a(i("329b")).default.extend({methods:{slots:function(e,t){void 0===e&&(e="default");var i=this.$slots,a=this.$scopedSlots[e];return a?a(t):i[e]}}});t.SlotsMixin=s},"19a9":function(e,t,i){"use strict";i("7d4e")},"1f63":function(e,t,i){"use strict";i("7434")},2064:function(e,t,i){"use strict";t.__esModule=!0,t.addUnit=function(e){if(!(0,a.isDef)(e))return;return e=String(e),(0,s.isNumber)(e)?e+"px":e};var a=i("b7b4"),s=i("f24f")},"27c4":function(e,t,i){var a=i("db6b2");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("42e360af",a,!0,{sourceMap:!1,shadowMode:!1})},2939:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .page-scroll[data-v-74102c05]{flex:1;overflow:auto;padding-bottom:100px;transform:translateZ(0)}.zjapp .sublist[data-v-74102c05]{padding-left:25px;padding-top:1px;background-color:#fff}.zjapp .sublist>.sublist[data-v-74102c05]{padding-left:10px;padding-top:0}",""])},"299f":function(e,t,i){var a=i("8b97");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("692b574b",a,!0,{sourceMap:!1,shadowMode:!1})},"29be":function(e,t,i){"use strict";(function(e){i("5ab2"),i("6d57"),i("e10e");var a=i("28f8"),s=(i("cc57"),i("163d"),i("07d2")),o=i("a5c6"),n=i("6144");function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}t.a={name:"SingleSelect",components:{Item:s.a},props:{title:{type:String,default:""},pageTitle:{type:String,default:""},placeholder:{type:String,default:""},value:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},optionsDisabled:{type:Array,default:function(){return[]}},required:{type:Boolean,default:!0},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},beforeOpen:{type:Function,default:function(){}},searchBar:{type:Boolean,default:!0},grouping:{type:String,default:""},autoOpen:{type:Boolean,default:!1},rightBtn:{type:String,default:""},rightBtnEvent:{type:Function,default:function(){return 0}},ifToggle:{type:Boolean,default:!1},formCheck:{type:Boolean,default:!1},editorAddData:{type:Boolean,default:!1},lineLimit:{type:[Number,String],default:1}},data:function(){return{memoryKey:this.$route.name+encodeURI(this.title)}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var t=this;if(this.editabled){var i=this.beforeOpen();i&&i.then&&e.isFunction(i.then)?i.then((function(e){!1!==e&&t.openPopup()})):!1!==i&&this.openPopup()}},openPopup:function(){var t=this;if(this.optionsDisabled&&this.optionsDisabled.length){var i={};e.each(this.optionsDisabled,(function(e){e.id&&(i[e.id]=e)})),e.each(this.options,(function(e,a){i[e.id]?t.options[a].disabled=!0:t.options[a].disabled=!1}))}o.a.openPopup({title:this.pageTitle||"选择"+this.title,selected:this.value,options:this.options,required:this.required,searchBar:this.searchBar,grouping:this.grouping,autoOpen:this.autoOpen,rightBtn:this.rightBtn,ifToggle:this.ifToggle,lineLimit:this.lineLimit,editorAddData:this.editorAddData,onSelect:function(i){var a=e.cloneDeep(t.value);i=e.isArray(i)?e.map(i,(function(e){return c({},e)})):c({},i),t.$emit("input",i,a),t.$emit("onSelect",i,a)},rightBtnEvent:function(i){var a=e.cloneDeep(t.value);t.$emit("rightBtnEvent",i,a)}})},closePopup:function(){o.a.closePopup()},onSelect:function(e){n.a.saveObject(this.memoryKey,e,n.a.level.user),this.$emit("input",e[0]),this.$emit("onSelect",e[0])},setSelected:function(){var t=n.a.getObject(this.memoryKey,n.a.level.user);!1===this.editabled||e.isEmpty(this.options)||(e.isEmpty(this.value)?this.memory&&!e.isEmpty(t)&&e.some(this.options,{id:t.id})&&(this.$emit("input",t),this.autoSelect&&this.$emit("onSelect",t)):this.autoSelect&&this.$emit("onSelect",this.value))}}}}).call(this,i("391c"))},"2c76":function(e,t,i){"use strict";i("c070")},"2dd6":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .single-item[data-v-6920dde7]{min-height:44px}.zjapp .single-item>div[data-v-6920dde7]{display:flex}.zjapp .single-item>div>span[data-v-6920dde7]{flex:1;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical}.zjapp .single-item>div>span[data-v-6920dde7] label{color:#4174e9}.zjapp .single-item i[data-v-6920dde7]{line-height:24px;font-size:24px;color:#4275e8}.zjapp .single-item .disabled-item[data-v-6920dde7]{color:#aaa}",""])},"2ddb":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .supplier-editor[data-v-e465319c]{margin-bottom:10px;padding:8px;display:flex;justify-content:space-between;align-items:center;height:52px;color:#4275e8;background-color:#fff}.zjapp .supplier-editor .icon[data-v-e465319c]{border-left:1px solid #c8c8c8;padding-left:12px}.zjapp .supplier-editor .icon-edit[data-v-e465319c]{color:#c8c8c8;font-size:18px}.zjapp .supplier-editor .icon-qualified[data-v-e465319c]{color:#4275e8}.zjapp .supplier-editor .margin-r[data-v-e465319c]{margin-right:10px}.zjapp .list-title[data-v-e465319c]{position:relative;top:0;color:#888;font-size:14px;line-height:30px;min-height:40px;margin-bottom:0;margin-top:0;padding:8px 16px 2px}.zjapp .search-item>div[data-v-e465319c]{padding-right:35px}.zjapp .search-item i[data-v-e465319c]{position:absolute;color:#ccc;font-size:26px;right:0;top:50%;transform:translateY(-50%)}.zjapp .van-popup--right[data-v-e465319c]{width:100%;height:100%}[data-v-e465319c] .van-cell__title{color:#4174e9;font-weight:700}[data-v-e465319c] .van-collapse-item__content{transform:translateZ(0);padding:0 0 0 25px}[data-v-e465319c] .van-collapse-item__content .van-cell{padding-left:0}",""])},"2f9d":function(e,t,i){"use strict";(function(e){var a=i("fc9f");t.a={getTemplateDirs:function(e){return a.a.query("select * from template_manage_dirs where parent_id = ? order by pinyin, name",[e])},getDirsAndCount:function(e,t){return a.a.query('select tmd.* ,                 (select count(1) from template_manage tm                     join template_manage_projs tmp on tmp.template_manage_id = tm.id                     where tmp.proj_id = ? and tm.code like tmd.code || ".%"                 ) as file_count                 from template_manage_dirs tmd where tmd.parent_id = ? order by pinyin, name',[e,t])},getTemplateList:function(e,t){return a.a.query("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and tm.template_manage_dir_id = ? order by tm.pinyin, tm.name ",[e,t])},updateDownloadTime:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",n="replace into template_manage_local (id, download_time, name, url, local_download_time) values (?, ?, ?, ?, ?)";return a.a.executeSql(n,[e,t,i,s,o])},getMaterialTemplate:function(e,t){return a.a.queryOne("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and material_id = ? ",[e,t])},getProcessTemplate:function(e,t){return a.a.queryOne("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and tm.process_check_id = ? ",[e,t])},getRecord:function(e){return a.a.queryOne("select * from template_manage where id = ?",[e])},getLocal:function(e){return a.a.query("select * from template_manage_local")},delLocalByIds:function(t){e.isArray(t)||(t=[t]);var i="DELETE FROM template_manage_local WHERE id in ("+e.map(t,(function(e){return"'"+e+"'"})).join(", ")+")";return a.a.executeSql(i)}}}).call(this,i("391c"))},3050:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;t.default={name:"姓名",tel:"电话",save:"保存",confirm:"确认",cancel:"取消",delete:"删除",complete:"完成",loading:"加载中...",telEmpty:"请填写电话",nameEmpty:"请填写姓名",confirmDelete:"确定要删除么",telInvalid:"请填写正确的电话",vanContactCard:{addText:"添加联系人"},vanContactList:{addText:"新建联系人"},vanPagination:{prev:"上一页",next:"下一页"},vanPullRefresh:{pulling:"下拉即可刷新...",loosing:"释放即可刷新..."},vanSubmitBar:{label:"合计："},vanCoupon:{valid:"有效期",unlimited:"无使用门槛",discount:function(e){return e+"折"},condition:function(e){return"满"+e+"元可用"}},vanCouponCell:{title:"优惠券",tips:"使用优惠",count:function(e){return e+"张可用"}},vanCouponList:{empty:"暂无优惠券",exchange:"兑换",close:"不使用优惠",enable:"可使用优惠券",disabled:"不可使用优惠券",placeholder:"请输入优惠码"},vanAddressEdit:{area:"地区",postal:"邮政编码",areaEmpty:"请选择地区",addressEmpty:"请填写详细地址",postalEmpty:"邮政编码格式不正确",defaultAddress:"设为默认收货地址",telPlaceholder:"收货人手机号",namePlaceholder:"收货人姓名",areaPlaceholder:"选择省 / 市 / 区"},vanAddressEditDetail:{label:"详细地址",placeholder:"街道门牌、楼层房间号等信息"},vanAddressList:{add:"新增地址"}}},"3156b":function(e,t,i){"use strict";i("163d");var a={name:"SingleSelectItem",props:{item:{type:Object,default:function(){return{id:"",name:""}}},checked:{type:Boolean,default:!1},renderField:{type:String,default:"name"},lineLimit:{type:[Number,String],default:1}},methods:{selectItem:function(e){e.disabled||this.$emit("click",e)}}},s=(i("9788"),i("17cc")),o=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("van-cell",{staticClass:"single-item",attrs:{clickable:!0},on:{click:function(t){e.selectItem(e.item)}}},[i("span",{class:{"disabled-item":e.item.disabled},style:{"-webkit-line-clamp":"unlimited"===e.lineLimit?"initial":e.lineLimit},domProps:{innerHTML:e._s(e.item[e.renderField])}}),e.checked?i("van-icon",{attrs:{name:"success"}}):e._e()],1)}),[],!1,null,"6920dde7",null);t.a=o.exports},3480:function(e,t,i){"use strict";(function(e){i("5ab2"),i("6d57"),i("e10e");var a=i("28f8"),s=i("e2a7"),o=i("e89f"),n=i("07d2"),r=i("3c64"),c=i("e68e");function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}t.a={name:"ProblemBack",components:{Item:n.a,ItemTextarea:r.a,ItemImgList:c.a},mixins:[o.a],props:{},data:function(){return{show:!1,multiple:!1,reasonList:[],reason:{},remark:"",images:[],placeholder:"补充说明",isBack:!1,photoRequest:"",allowSelectAlbum:void 0,allowBuildinAlbum:void 0}},methods:{openPopup:function(t){t.reasonList?this.reasonList=e.clone(t.reasonList):this.reasonList=[{id:1,text:"整改不合格"},{id:2,text:"其它",remarkRequire:!0}],this.isBack=t.isBack||!1,this.reason=e.clone(t.reason)||{},this.images=e.map(t.images,(function(e){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e)})),this.remark=t.remark||"",this.placeholder=t.placeholder?t.placeholder:"补充说明",this.multiple=t.multiple,e.isEmpty(t.reasonList)||(this.reasonList=e.clone(t.reasonList)),this.callback=t.callback,this.beforeCallback=t.beforeCallback,this.photoRequest=t.photoRequest||"",t.allowSelectAlbum&&(this.allowSelectAlbum=Boolean(t.allowSelectAlbum)),t.allowBuildinAlbum&&(this.allowBuildinAlbum=Boolean(t.allowBuildinAlbum)),this.value=!0,this.show=!0,this.$emit("open")},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},selectItem:function(e){this.multiple?this.$set(e,"checked",!e.checked):this.reason=e},submit:function(){var t=this;if(this.multiple){if(this.reason=e.filter(this.reasonList,{checked:!0}),e.isEmpty(this.remark))return void s.a.alert("补充说明必填")}else{if(e.isUndefined(this.reason.id))return void s.a.alert("请填写退回原因");if(this.reason.remarkRequire&&e.isEmpty(this.remark))return void s.a.alert("补充说明必填");if(this.photoRequest&&e.isEmpty(this.images))return void s.a.alert("请拍摄退回照片")}var i={reason:this.reason,remark:this.remark,images:this.images},a=!this.beforeCallback||this.beforeCallback(i);a&&a.then&&e.isFunction(a.then)?a.then((function(e){!1!==e&&(t.callback&&t.callback(i),t.closePopup())})):!1!==a&&(this.callback&&this.callback(i),this.closePopup())}}}}).call(this,i("391c"))},3646:function(e,t,i){var a=i("de1f");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("4f8cf845",a,!0,{sourceMap:!1,shadowMode:!1})},"3c64":function(e,t,i){"use strict";i("163d");var a={name:"ItemTextarea",components:{},props:{value:{type:String,default:""},placeholder:{type:String,default:""},maxlength:{type:Number,default:200},borderBottom:{type:Boolean,default:!0}},data:function(){return{textareaHeight:40,isLock:!1,blurTime:null}},computed:{lastLength:function(){var e=this.value&&this.value.length||0,t=this.maxlength-e;return t>0?t:0}},mounted:function(){var e=this;this.$nextTick((function(){e.textareaHeight=e.$refs.rule&&e.$refs.rule.offsetHeight||40}))},methods:{onfocus:function(){var e=(new Date).getTime();this.blurTime&&e-this.blurTime<300&&window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(this.$refs.input.blur(),window.cordova.plugins.Keyboard.close()),this.blurTime=null,this.$emit("focus")},onblur:function(){this.blurTime=(new Date).getTime(),this.$emit("blur")},setStatus:function(e){console.log(e),this.isLock=e},oninput:function(e){var t=this;setTimeout((function(){if(!t.isLock){var i=e.target.value;i.length>t.maxlength&&(i=i.substring(0,t.maxlength),t.$refs.input.value=i),t.$refs.rule.innerText=i,t.textareaHeight=t.$refs.rule&&t.$refs.rule.offsetHeight+20,t.$emit("input",i),t.$emit("change",i)}}),0)}}},s=(i("2c76"),i("17cc")),o=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"item-textarea",class:{"border-bottom":e.borderBottom}},[i("div",{staticClass:"item-textarea-content"},[i("textarea",{ref:"input",style:{height:e.textareaHeight+"px"},attrs:{placeholder:e.placeholder},domProps:{value:e.value},on:{focus:e.onfocus,blur:e.onblur,compositionstart:function(t){e.setStatus(!0)},compositionend:function(t){e.setStatus(!1)},input:e.oninput}}),i("div",{ref:"rule",staticClass:"rule"},[e._v("\n      "+e._s(e.value)+"\n    ")]),e.maxlength!==1/0?i("p",{staticClass:"counter"},[e._v("\n      "+e._s(e.lastLength)+"\n    ")]):e._e()])])}),[],!1,null,null,null);t.a=o.exports},"3cc7":function(e,t,i){var a=i("44a1");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("12a96fd8",a,!0,{sourceMap:!1,shadowMode:!1})},"3cd8":function(e,t,i){var a=i("5c19");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("67c16200",a,!0,{sourceMap:!1,shadowMode:!1})},"3e18":function(e,t,i){"use strict";i("5a83")},"3e47":function(e,t,i){"use strict";(function(e){i("e697"),i("9e76"),i("cc57"),i("6d57"),i("ed63"),i("8cf2");var a=i("fd50"),s=i("e2a7"),o=i("ed08"),n=i("4ad6"),r=i("3122"),c=i("162a"),l=i("a078"),p=i("2f9d"),d=i("4360"),u=i("a18c"),h=i("6bf2"),m=i.n(h),f=i("2e26"),g=i("4daa"),b={},v=[],_={},y=[],k={_downloadTemplate:function(e,t,i){if(e in b)return k._checkQueue();var r=i,u=o.a.formatFiletypes(r),h=n.a.appDataPath()+"template",g=h+"/"+e+"."+u,v=a.a.defer(),y=b[e]=_[e]=_[e]||{progress:0},x=d.a.state.templateManage.support_bimface.includes(u);return x&&(g+=".zip"),y.promise=v.promise,f.a.log("download url",r),f.a.log("download localPath",g),c.a.startBackgroundTask(),c.a.canUpdate(!1).then((function(){return n.a.isFileExists(h)})).then((function(e){return e?n.a.isFileExists(g).then((function(e){if(e)return n.a.deleteFile(g)})):n.a.mkdir(h)})).then((function(){return y.progress=0,n.a.downloadFile(r,g).then((function(t){if(f.a.log("service ext",u),x){var i=h+"/"+e;return f.a.log("localUnzipPath",i),n.a.isFileExists(i).then((function(e){if(e)return n.a.deleteFile(i)})).then((function(){return n.a.unzipFile(g,i).catch((function(){return a.a.reject("使用此功能请升级到最新版本")}))})).then((function(){return n.a.deleteFile(g)})).then((function(){return i}))}return t})).then((function(a){return v.resolve(a),y.download_time=y.upload_time,y.progress=-1,p.a.updateDownloadTime(e,y.upload_time,t,i,m()().format("YYYY-MM-DD HH:mm")).then((function(){return delete b[e],k._checkQueue()}))}),null,(function(e){y.progress=e,v.notify(e)}))})).catch((function(t){return y.progress=-1,t&&n.a.getAppFullVersion().then((function(e){e.fullVersion=e.fullVersion.slice(0,5),1===o.a.versionCompare("3.0.5",e.fullVersion)?s.a.popBoxExt({content:"使用此模块需更新APP到最新版",buttons:["取消","去更新"],cssClass:"popup-app-update",callback:function(e,t){switch(e){case 0:_btnSelected="cancel",$ionicBackdrop.release();break;case 1:$ionicBackdrop.release(),n.a.getDeviceInfo().then((function(e){var t="Android"===e.platform?l.a.appUpdate.Android:l.a.appUpdate.IOS;n.a.openUrlInBrowser(t)})),t.preventDefault(),_btnSelected="update"}}}):(f.a.error("下载错误: ",t),s.a.alert(t))})),delete b[e],v.reject(t),k._checkQueue()})).finally((function(){c.a.finishBackgroundTask()})),v.promise},downloadSingleTemplate:function(e,t,i){var r,l=i;if(e in b)return r=s.a.topProcess({title:$rootScope.isIPhoneFullScreen?"下载中":"正在下载文件...",successTitle:"下载完成"}),b[e].promise.then(null,null,(function(e){r.loading(e)})).finally((function(){r.close()}));var u=o.a.formatFiletypes(l),h=n.a.appDataPath()+"template",g=h+"/"+e+"."+u,v=b[e]=_[e]=_[e]||{},y=d.a.state.templateManage.support_bimface.includes(u);return y&&(g+=".zip"),v.progress=0,r=s.a.topProcess({title:$rootScope.isIPhoneFullScreen?"下载中":"正在下载文件...",successTitle:"下载完成"}),c.a.beginManualUpdate(),c.a.startBackgroundTask(),v.promise=c.a.canUpdate(!1).then((function(){return n.a.isFileExists(h)})).then((function(e){return e?n.a.isFileExists(g).then((function(e){if(e)return n.a.deleteFile(g)})):n.a.mkdir(h)})).then((function(){return n.a.downloadFile(l,g).then((function(t){if(y){var i=h+"/"+e;return n.a.isFileExists(i).then((function(e){if(e)return n.a.deleteFile(i)})).then((function(){return n.a.unzipFile(g,i)})).then((function(){return n.a.deleteFile(g)})).then((function(){return i}))}return t})).then((function(a){return v.download_time=v.upload_time,v.progress=-1,p.a.updateDownloadTime(e,v.upload_time,t,i,m()().format("YYYY-MM-DD HH:mm")).then((function(){delete b[e]}))}),null,(function(e){v.progress=e,r.loading(e)}))})).catch((function(t){return r.close(),v.progress=-1,delete b[e],t?(f.a.error("下载错误: ",t),a.a.reject(t)):a.a.reject("下载样板发生错误")})).finally((function(){r.close(),c.a.finishBackgroundTask(),c.a.endManualUpdate()}))},fetchBimfaceSupported:function(){var e="bimface_mime_type";return c.a.post("/setting/get-setting-value",null,{code:[e]}).then((function(t){try{return JSON.parse(t[e])}catch(e){return[]}}))},addDownloadQueue:function(e,t,i){if(!b[e]){v.push({id:e,name:t,url:i}),_[e]=_[e]||{progress:0},_[e].progress=0;var s=a.a.defer();return k._checkQueue().then(null,null,(function(e){return s.notify(e)})),s.promise}},_checkQueue:function(){if(!v.length)return c.a.endManualUpdate(),a.a.when();var t=e.keys(b).length;if(t>=3)return a.a.when();0===t&&c.a.beginManualUpdate();var i=a.a.defer(),s=v.shift(),o=s.id,n=s.name,r=s.url;return k._downloadTemplate(o,n,r).then((function(e){return i.resolve(e)}),null,(function(e){return i.notify(e)})),i.promise},getTemplateListCount:function(e,t){return a.a.all([p.a.getTemplateDirs(t),p.a.getTemplateList(e,t)]).then((function(e){return e[0].concat(e[1]).length}))},getTemplateList:function(t,i){return f.a.log(t,"projId"),a.a.all([p.a.getDirsAndCount(t,i),p.a.getTemplateList(t,i)]).then((function(t){var i=t[0],a=t[1];return e.each(i,(function(e){e.file_type="folder",e.child_num=e.file_count})),e.each(a,(function(e){_[e.id]=_[e.id]||{progress:-1},_[e.id].download_time=e.download_time,_[e.id].upload_time=e.upload_time,e.downloadInfo=_[e.id],e.file_size=o.a.formatFilesize(e.file_size),e.file_type=e.url&&e.url.match(/[^\.]+$/)?e.url.match(/[^\.]+$/)[0]:"",e.child_num=1})),i.concat(a)}))},openTemplate:function(e,t,i){return new Promise((function(a,s){var c=o.a.formatFiletypes(i),l=d.a.state.templateManage.support_bimface.includes(c),p=n.a.appDataPath()+"template/"+e+"."+c;"pdf"===c||"docx"===c||"doc"===c||"xls"===c||"xlsx"===c||"ppt"===c||"pptx"===c?n.a.openPDF(p,t).then((function(e){a(e)})).catch((function(e){s(e)})):"jpg"===c||"jpeg"===c||"png"===c?n.a.openImageBrowser([r.a.fixUrl(p)],0).then((function(e){a(e)})).catch((function(e){s(e)})):l?(p=n.a.appDataPath()+"template/"+e,f.a.log("localPath",p),f.a.log("name",t),u.a.push({path:"/bimface",query:{mode:"view",layout:"fullScreen",url:p,name:t,ext:c}}),a()):s("未知的文件类型")}))},getMaterialTemplate:function(e,t){var i={projId:e,materialId:t};return Object(g.a)(i).then((function(e){var t=e&&e.length?e[0]:null;return t&&(_[t.id]=_[t.id]||{progress:-1},_[t.id].download_time=t.download_time,_[t.id].upload_time=t.upload_time,t.downloadInfo=_[t.id],t.file_size=o.a.formatFilesize(t.file_size)),t}))},getProcessTemplate:function(e,t){var i={projId:e,processId:t};return Object(g.b)(i).then((function(e){var t=e&&e.length?e[0]:null;return t&&(_[t.id]=_[t.id]||{progress:-1},_[t.id].download_time=t.download_time,_[t.id].upload_time=t.upload_time,t.downloadInfo=_[t.id],t.file_size=o.a.formatFilesize(t.file_size)),t}))},openDirs:function(e,t){return k.getTemplateList(e,t.id).then((function(i){var o=$rootScope.$new();o.listConllection=i||[],y.push(o),o.title=t.name,o.close=function(e){if(e)for(;y.length;)y.pop().modal.remove();else y.pop().modal.remove()},$ionicModal.fromTemplateUrl("templates/template-manage/template-list.html?v=20190415",{scope:o,animation:"slide-in-right"}).then((function(e){o.modal=e,o.modal.show()})),o.openDOC=function(){var t=this.item;if("folder"===t.file_type)return k.openDirs(e,t);t.downloadInfo.progress<0&&t.downloadInfo.download_time===t.downloadInfo.upload_time&&k.openTemplate(t.id).catch((function(e){s.a.alert(e)}))},o.uploadCallback=function(){k.getTemplateList(e,t.id).then((function(e){o.listConllection=e||[]}))},o.downloadTemplate=function(e,t,i){i&&i.stopPropagation();var s=this;a.a.when().then((function(){i.target.style.display="none"})).then((function(){s.item.downloadInfo.progress=0})).then((function(){setTimeout((function(){k.addDownloadQueue(e,t)}),10)}))}}))},_getTemplateList:function(t){var i=t.projId,s=t.parent_id,n=t.keywords,r=t.mtime_sort,l=t.name_sort;return a.a.all([c.a.post("/template-manage/list",{proj_id:i,parent_id:s,keywords:n,mtime_sort:r,name_sort:l}),k._getLocalTemplateList()]).then((function(t){var i=t[0].list.filter((function(e){return e.is_dir})),a=t[0].list.filter((function(e){return!e.is_dir})),s=t[1];return e.each(i,(function(e){e.file_type="folder",e.child_num=e.docs_num})),e.each(a,(function(e){_[e.id]=_[e.id]||{progress:-1};var t=s.find((function(t){return t.id===e.id}));_[e.id].download_time=t?t.download_time:"",_[e.id].upload_time=e.upload_time,e.downloadInfo=_[e.id],e.file_size=o.a.formatFilesize(e.file_size),e.file_type=o.a.formatFiletypes(e.url||e.name),e.child_num=1})),i.concat(a)}))},_getLocalTemplateList:function(){return p.a.getLocal().then((function(e){return e.filter((function(e){return e.name&&e.url}))}))},removeTemplate:function(e){return p.a.delLocalByIds(e)},getViewToken:function(e){return c.a.post("/template-manage/get-view-token",null,{id:e})},coverterBimface:function(e){return new Promise((function(t,i){var a=20;!function s(){if(a<=0)return void i("timeout");var o=function(){setTimeout((function(){a--,s()}),2e3)};c.a.request("/template-manage/offline-data-uri",{id:e}).then((function(e){e?t(e):o()})).catch((function(){o()}))}()}))}};t.a=k}).call(this,i("391c"))},"3f00":function(e,t,i){var a=i("a14f");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("eb0bf718",a,!0,{sourceMap:!1,shadowMode:!1})},4412:function(e,t,i){"use strict";t.__esModule=!0,t.createBEM=function(e){return function(t,i){return t&&"string"!=typeof t&&(i=t,t=""),t=a(e,t,"__"),i?[t,s(t,i)]:t}};function a(e,t,i){return t?e+i+t:e}function s(e,t){if("string"==typeof t)return a(e,t,"--");if(Array.isArray(t))return t.map((function(t){return s(e,t)}));var i={};return t&&Object.keys(t).forEach((function(a){i[e+"--"+a]=t[a]})),i}},"44a1":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .multiple-place-content[data-v-4b9b8166]{z-index:99999;max-height:134px;border-bottom:1px solid #ececec;overflow:auto;scroll-behavior:smooth}.zjapp .multiple-place-content.-fixed[data-v-4b9b8166]{position:absolute;left:0;right:0;top:0}.zjapp .selected[data-v-4b9b8166]{position:relative;display:flex;padding:13px 15px;font-size:15px;background-color:#fff;overflow:scroll}.zjapp .selected label[data-v-4b9b8166]{margin-right:10px;color:#999;white-space:nowrap}.zjapp .select-wrap[data-v-4b9b8166]{flex:1;background-color:#fff;overflow:auto;scroll-behavior:smooth}.zjapp .van-collapse[data-v-4b9b8166] .van-cell{align-items:center}.zjapp .van-collapse[data-v-4b9b8166] .icon{margin-right:10px;vertical-align:middle}.zjapp .van-collapse[data-v-4b9b8166] .van-collapse-item__content{padding:0}.zjapp .group.-border-bottom[data-v-4b9b8166]{border-bottom:1px solid #ececec}.zjapp .group-name[data-v-4b9b8166]{font-size:14px;color:#999;height:34px;padding-top:15px}.zjapp .element-list[data-v-4b9b8166]{display:flex;flex-wrap:wrap}.zjapp .element[data-v-4b9b8166]{min-width:75px;height:28px;line-height:28px;text-align:center;margin:10px 6px 10px 0;padding:0 10px;background:#fff;border-radius:100px;color:#333;font-size:14px;border:1px solid #dcdcdc}.zjapp .element.-disabled[data-v-4b9b8166]{background:#ececec;color:#999;border-color:#ececec}.zjapp .element.-checked[data-v-4b9b8166]{background:#4275e8;color:#fff;border-color:#4275e8}",""])},"4aef":function(e,t,i){"use strict";var a=i("dd16").a,s=i("17cc"),o=Object(s.a)(a,(function(){var e=this.$createElement;return(this._self._c||e)("span",{class:this.classSet[this.status]},[this._v(this._s(this.text||this.status))])}),[],!1,null,null,null);t.a=o.exports},"4d1b":function(e,t,i){"use strict";var a=i("c5a7");t.__esModule=!0,t.default=void 0;var s=a(i("329b")),o=i("53a5"),n=a(i("3050")),r=s.default.prototype,c=s.default.util.defineReactive;c(r,"$vantLang","zh-CN"),c(r,"$vantMessages",{"zh-CN":n.default});var l={messages:function(){return r.$vantMessages[r.$vantLang]},use:function(e,t){var i;r.$vantLang=e,this.add(((i={})[e]=t,i))},add:function(e){void 0===e&&(e={}),(0,o.deepAssign)(r.$vantMessages,e)}};t.default=l},"4daa":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));var a=i("5e8d"),s=i("162a"),o=i("da71");function n(e){return Object(a.a)().then((function(){var t=o.a.processTemplate.url;return s.a.request(t,e)}))}function r(e){return Object(a.a)().then((function(){var t=o.a.materialTemplate.url;return s.a.request(t,e)}))}},"515e":function(e,t,i){"use strict";var a=i("329b"),s=i("f1e4").a,o=(i("fe9e"),i("17cc")),n=Object(o.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-right"}},[e.show?i("page-content",{class:{"content-not-empty":e.content.length},attrs:{mode:"dialog",title:"检查指引","on-close":e.closePopup}},[e.isLoading?e._e():i("div",{staticClass:"check-guide-detail-hd border-bottom"},[i("h2",{staticClass:"check-guide-detail-title pb10"},[e._v(e._s(e.title))])]),!e.isLoading&&e.content.length?i("div",{staticClass:"check-guide-detail-content"},e._l(e.content,(function(t,a){return i("p",{key:a},[t.isImg&&t.src?i("img",{class:{"img-not-ready":!t.ready,error:"rejected"===t.status},attrs:{src:e.getThumbnail(t)},on:{error:function(i){e.imgError(t,a)},click:function(i){e.imgClick(t)}}}):e._e(),t.isImg?e._e():i("span",[e._v("\n          "+e._s(t.val)+"\n        ")])])}))):e._e(),i("loading-status",{attrs:{"is-loading":e.isLoading,"is-empty":!e.content.length,"empty-text":"PC端未设置检查指引"}})],1):e._e()],1)}),[],!1,null,"43042f0d",null).exports,r=!1;r||(r=new(a.default.extend(n))({el:document.createElement("div")}),document.body.appendChild(r.$el));t.a=r},"53a5":function(e,t,i){"use strict";t.__esModule=!0,t.deepAssign=o;var a=i("b7b4"),s=Object.prototype.hasOwnProperty;function o(e,t){return Object.keys(t).forEach((function(i){!function(e,t,i){var n=t[i];(0,a.isDef)(n)&&(s.call(e,i)&&(0,a.isObj)(n)&&"function"!=typeof n?e[i]=o(Object(e[i]),t[i]):e[i]=n)}(e,t,i)})),e}},"542f":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .layout-main[data-v-29e0b631] .layout-content{overflow:auto}[data-v-29e0b631] .item .icon{color:#4275e8}.zjapp .item-con[data-v-29e0b631] .item-img-list{margin-top:-8px}",""])},"574c":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .item-textarea{background-color:#fff;padding:5px 15px}.zjapp .item-textarea-content{position:relative}.zjapp .item-textarea .rule,.zjapp .item-textarea textarea{width:100%;min-height:40px;line-height:20px;font-size:16px;padding:0;border:none}.zjapp .item-textarea .rule{position:absolute;top:0;left:0;visibility:hidden;word-break:break-all}.zjapp .item-textarea .counter{text-align:right;margin:0 0 -5px 0;height:15px;line-height:15px;color:#b2b2b2;font-size:12px}",""])},"5a71":function(e,t,i){"use strict";var a=i("29be").a,s=i("17cc"),o=Object(s.a)(a,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("item",{class:e.required,attrs:{label:e.title,text:e.value&&e.value.id?e.value.name:"view"===e.mode?"无":"",mode:e.mode,editabled:e.editabled,placeholder:e.required?e.placeholder||"请选择":"选填","form-check":e.formCheck},on:{click:e.openSelect}})}),[],!1,null,null,null);t.a=o.exports},"5a83":function(e,t,i){var a=i("c1f2");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("c19c3f6c",a,!0,{sourceMap:!1,shadowMode:!1})},"5c19":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .content-not-empty[data-v-43042f0d] .layout-content{display:auto;overflow:auto;padding-bottom:100px}.zjapp .check-guide-detail-hd[data-v-43042f0d]{margin-left:30px;padding:25px 30px 5px 0}.zjapp .check-guide-detail-title[data-v-43042f0d]{margin:0;line-height:20px;font-size:18px;color:#111;font-weight:700;word-break:break-all}.zjapp .check-guide-detail-info[data-v-43042f0d]{line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .check-guide-detail-content[data-v-43042f0d]{padding:30px;line-height:30px;color:#333;font-size:16px}.zjapp .check-guide-detail-content p[data-v-43042f0d]{margin-bottom:30px;min-height:1em}.zjapp .check-guide-detail-content img[data-v-43042f0d]{max-width:100%}.zjapp .check-guide-detail-content .img-not-ready[data-v-43042f0d]{width:80px;height:auto}.zjapp .error[data-v-43042f0d]{max-width:50%}",""])},6147:function(e,t,i){"use strict";t.__esModule=!0,t.createNamespace=function(e){return e="van-"+e,[(0,s.createComponent)(e),(0,a.createBEM)(e),(0,o.createI18N)(e)]};var a=i("4412"),s=i("7e06"),o=i("65af")},6272:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,'.zjapp .number-input[data-v-74068386]{position:relative;display:inline-block;vertical-align:top;width:61px;height:30px;border:1px solid #e5e5e5;border-radius:3px;text-align:center;font-size:14px;color:#333}@media screen and (min-width:320px){.zjapp .number-input[data-v-74068386]{width:50px}}@media screen and (min-width:360px){.zjapp .number-input[data-v-74068386]{width:58px}}@media screen and (min-width:375px){.zjapp .number-input[data-v-74068386]{width:61px}}.zjapp .text[data-v-74068386]{position:relative;display:inline-block;vertical-align:top;width:100%;height:100%;line-height:28px;overflow:hidden}.zjapp .text.disabled[data-v-74068386]{background:#f5f5f5;color:#666}.zjapp .value[data-v-74068386]{position:absolute;top:50%;right:0;margin-top:-14px;min-width:100%;height:28px;color:inherit}.zjapp .placeholder[data-v-74068386],.zjapp .value[data-v-74068386]{line-height:28px;pointer-events:none}.zjapp .placeholder[data-v-74068386]{display:inline-block;vertical-align:top;width:100%;height:100%;color:#b2b2b2}.zjapp .icon-minus[data-v-74068386]{position:absolute;top:-9px;right:-9px;width:18px;height:18px;border-radius:9px;background-color:#ff4546}.zjapp .icon-minus[data-v-74068386]:before{content:"";position:absolute;left:4px;top:8px;width:10px;height:2px;background-color:#fff}.zjapp .icon-minus[data-v-74068386]:after{content:"";position:absolute;left:-5px;top:-5px;width:28px;height:28px;border-radius:9px}.zjapp .number-input-select-all .value-handle[data-v-74068386]{background-color:#cbdaf9}.zjapp .number-input.unqualified[data-v-74068386]{border:1px solid #ffe8e8;background-color:#fff3f3;color:#ff5050}.zjapp .number-input.qualified .text[data-v-74068386]{color:#333}.zjapp .number-input.number-input-focus[data-v-74068386]{border-color:#4275e8;box-shadow:0 0 8px 0 rgba(66,117,232,.37)}.zjapp .number-input.number-input-empty[data-v-74068386]{border-color:#ff3d3d;box-shadow:0 0 8px 0 rgba(255,59,48,.37)}',""])},"65af":function(e,t,i){"use strict";var a=i("c5a7");t.__esModule=!0,t.createI18N=function(e){var t=(0,o.camelize)(e)+".";return function(e){for(var i=(0,s.get)(n.default.messages(),t+e)||(0,s.get)(n.default.messages(),e),a=arguments.length,o=new Array(a>1?a-1:0),r=1;r<a;r++)o[r-1]=arguments[r];return"function"==typeof i?i.apply(void 0,o):i}};var s=i("b7b4"),o=i("a1aa"),n=a(i("4d1b"))},6718:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));i("163d"),i("cc57");var a=i("b7b4"),s={name:"SwipeTab",props:{title:{type:String}},data:function(){return{offset:0,style:{},bem:Object(a.createNamespace)("swipe-item")[1](),parent:{}}},computed:{index:function(){return this.parent.tabs.indexOf(this)}},beforeCreate:function(){this.$parent.swipes.push(this)},created:function(){this.findParent("SwipeTabs")},destroyed:function(){this.$parent.swipes.splice(this.$parent.swipes.indexOf(this),1)},mounted:function(){var e=this,t=this.parent.tabs,i=this.parent.$slots.default.indexOf(this.$vnode);t.splice(-1===i?t.length:i,0,this),this.$nextTick((function(){var t=e.$parent,i=t.vertical,a=t.computedWidth,s=t.computedHeight;e.style={width:a+"px",height:i?a+"px":s+"px",transform:"translate".concat(i?"Y":"X","(").concat(e.offset,"px)")}}))},methods:{findParent:function(e){for(var t=this.$parent;t;){if(t.$options.name===e){this.parent=t;break}t=t.$parent}}}},o=i("17cc"),n=Object(o.a)(s,(function(){var e=this.$createElement;return(this._self._c||e)("div",this._g({class:this.bem,style:this.style},this.$listeners),[this._t("default")],2)}),[],!1,null,null,null).exports,r={name:"SwipeTabs",model:{prop:"tabIndex",event:"change"},props:{tabIndex:{type:Number,default:0},markType:{type:String,default:"line"},showTabs:{type:Boolean,default:!0},touchable:{type:Boolean,default:!0}},data:function(){return{curIndex:0,initIndex:0,tabs:[],tabScrollVersion:null}},computed:{tabsPadding:function(){return Math.max(24-4*this.tabs.length,0)},markLeft:function(){var e=(100-2*this.tabsPadding)/this.tabs.length;return this.tabsPadding+(this.curIndex+.5)*e}},watch:{tabIndex:function(e){e!==this.curIndex&&(this.curIndex=e,this.$refs.swipe.swipeTo(e,{immediate:!0}))},curIndex:function(){this.scrollTabsTocurrent()}},created:function(){this.initIndex=this.tabIndex,this.curIndex=this.tabIndex},activated:function(){this.initIndex=this.tabIndex,this.curIndex=this.tabIndex},mounted:function(){this.$nextTick(this.scrollTabsTocurrent)},methods:{changeIndex:function(e){this.$refs.swipe.swipeTo(e)},onChange:function(e){this.curIndex=e,this.$emit("change",e)},scrollTabsTocurrent:function(){var e=this.$refs["tabs-scroll"],t=this.$refs["tab-point"]?this.$refs["tab-point"][this.curIndex]:null;if(e&&t){var i=e.getBoundingClientRect(),a=t.getBoundingClientRect(),s=a.left-i.left,o=i.right-a.right;s<0&&this.tabScrollBy(s),o<0&&this.tabScrollBy(-o)}},tabScrollBy:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,a=this.$refs["tabs-scroll"];if(a){var s=a.scrollLeft,o=s+e,n=Math.round(i/16.7),r=e/n,c=s,l=this.tabScrollVersion=+new Date;return s===o?Promise.resolve():new Promise((function(e){!function i(){window.requestAnimationFrame((function(){l===t.tabScrollVersion&&(c+=r,a.scrollLeft=c,s<o&&c<o||s>o&&c>o?i():(a.scrollTop=o,e()))}))}()}))}}}},c=(i("bcf4"),Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"swipe-tabs"},[e.showTabs?["line"===e.markType?i("div",{staticClass:"tabs border-bottom",style:{padding:"0 "+Math.max(24-4*e.tabs.length,0)+"%"}},[e._l(e.tabs,(function(t){return i("div",{key:t.index,staticClass:"tab",class:{"tab-current":t.index===e.curIndex},on:{click:function(i){e.changeIndex(t.index)}}},[e._v("\n        "+e._s(t.title)+"\n      ")])})),i("div",{staticClass:"mark-line",style:{left:e.markLeft+"%"}})],2):e._e(),"point"===e.markType?i("div",{staticClass:"tabs-point border-bottom"},[i("div",{ref:"tabs-scroll",staticClass:"tabs-scroll"},e._l(e.tabs,(function(t){return i("div",{key:t.index,ref:"tab-point",refInFor:!0,staticClass:"tab-point",class:{"tab-current":t.index===e.curIndex},on:{click:function(i){e.changeIndex(t.index)}}},[e._v("\n          "+e._s(t.title)+"\n        ")])})))]):e._e()]:e._e(),e._t("fixed"),i("van-swipe",{ref:"swipe",attrs:{"initial-swipe":e.initIndex,"show-indicators":!1,duration:250,loop:!1,touchable:e.touchable},on:{change:e.onChange}},[e._t("default")],2)],2)}),[],!1,null,"025feb99",null));t.b=c.exports},6948:function(e,t,i){"use strict";i("2b45"),i("163d");var a=i("329b"),s=i("8c3d").a,o=(i("b55a"),i("17cc")),n=Object(o.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-up"},on:{leave:e.startClose,afterLeave:e.onClose}},[e.show?i("div",{staticClass:"number-keyboard-con",class:{"ios-bezel-less":e.isIOSBezelLess},style:{"z-index":e.zIndex},on:{touchstart:e.keyTouchstart,touchend:e.keyTouchend}},["true-or-false"===e.type?[i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"row-span-3 keys-row"},[i("div",{staticClass:"keys col color-green",attrs:{direct:"setTure"}},[i("icon",{attrs:{name:"qualified"}}),e._v("\n            合格\n          ")],1),i("div",{staticClass:"keys col color-red",attrs:{direct:"setFalse"}},[i("icon",{attrs:{name:"unqualified"}}),e._v("\n            不合格\n          ")],1)]),i("div",{staticClass:"row-span-1"},[i("div",{staticClass:"keys-row"},[i("div",{staticClass:"keys keys-ok",attrs:{direct:"closeKeyboard"}},[i("icon",{attrs:{name:"keyboard-close"}})],1)]),i("div",{staticClass:"keys-row"},[i("div",{staticClass:"keys keys-delete",attrs:{direct:"delete"}},[i("icon",{attrs:{name:"keyboard-delete"}})],1)])])]),i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys keys-prev",class:{disabled:!e.hasPrev},attrs:{direct:"prev"}},[e._v("\n          上一项\n        ")]),i("div",{staticClass:"keys keys-next",class:{disabled:!e.hasNext},attrs:{direct:"next"}},[e._v("\n          下一项\n        ")])])]:[i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys",attrs:{direct:"1"}},[e._v("1")]),i("div",{staticClass:"keys",attrs:{direct:"2"}},[e._v("2")]),i("div",{staticClass:"keys",attrs:{direct:"3"}},[e._v("3")]),i("div",{staticClass:"keys keys-ok",attrs:{direct:"closeKeyboard"}},[i("icon",{attrs:{name:"keyboard-close"}})],1)]),i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys",attrs:{direct:"4"}},[e._v("4")]),i("div",{staticClass:"keys",attrs:{direct:"5"}},[e._v("5")]),i("div",{staticClass:"keys",attrs:{direct:"6"}},[e._v("6")]),i("div",{staticClass:"keys keys-delete",attrs:{direct:"delete"}},[i("icon",{attrs:{name:"keyboard-delete"}})],1)]),i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys",attrs:{direct:"7"}},[e._v("7")]),i("div",{staticClass:"keys",attrs:{direct:"8"}},[e._v("8")]),i("div",{staticClass:"keys",attrs:{direct:"9"}},[e._v("9")]),i("div",{staticClass:"keys keys-prev",class:{disabled:!e.hasPrev},attrs:{direct:"prev"}},[e._v("\n          上一项\n        ")])]),i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys",class:{disabled:e.isDisabledMinus},attrs:{direct:"-"}},[e._v("-")]),i("div",{staticClass:"keys",attrs:{direct:"0"}},[e._v("0")]),i("div",{staticClass:"keys",class:{disabled:e.isDisabledPoint},attrs:{direct:"."}},[e._v(".")]),i("div",{staticClass:"keys keys-next",class:{disabled:!e.hasNext},attrs:{direct:"next"}},[e._v("\n          下一项\n        ")])])]],2):e._e()])}),[],!1,null,"6337f428",null).exports,r=!1;r||(r=new(a.default.extend(n))({el:document.createElement("div")}),document.body.appendChild(r.$el));var c=r,l=i("6f9e"),p=i("4360"),d={name:"NumberInput",props:{value:{type:[String,Number]},type:{type:String,default:"all"},decimal:{type:Number,default:2},placeholder:{type:String,default:""},nextEvent:{type:Function},range:{type:Array,default:function(){return[]}},overflowAutoRecover:{type:Boolean,default:!1},required:{type:Boolean},emptyAutoRecover:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},isSetEmptyTip:{type:Boolean,default:!1}},data:function(){return{rawValue:"",isFocusing:!1,isSelectAll:!1,keyboardHeight:p.a.state.app.isIOSBezelLess?266:"true-or-false"===this.type?176:232}},computed:{min:function(){return isNaN(this.range[0])?-1/0:parseFloat(this.range[0])},max:function(){return isNaN(this.range[1])?1/0:parseFloat(this.range[1])}},created:function(){l.a.$on("numberInputBlur",this.setBlur),l.a.$on("numberKeyboardClose",this.setBlur)},beforeDestroy:function(){this.isFocusing&&c.closeKeyboard()},destroyed:function(){l.a.$off("numberInputBlur",this.setBlur),l.a.$off("numberKeyboardClose",this.setBlur)},methods:{hasVal:function(e){return null!=e&&""!==e},openKeyboard:function(){this.disabled||(this.isFocusing?this.isSelectAll=!1:(l.a.$emit("numberInputBlur"),this.setFocus(),c.openKeyboard({inputComponent:this})))},setFocus:function(){this.isFocusing=!0,"true-or-false"!==this.type&&(this.isSelectAll=!0),this.rawValue=this.value,c.$on("keyboardInput",this.input),c.$on("keyboardAssign",this.assign),c.$on("keyboardDelete",this.deleteValue),c.$on("keyboardClear",this.clear),this.$emit("focus")},setBlur:function(){if(this.isFocusing){var e=this.checkValue();this.isFocusing=!1,this.isSelectAll=!1,c.$off("keyboardInput",this.input),c.$off("keyboardAssign",this.assign),c.$off("keyboardDelete",this.deleteValue),c.$off("keyboardClear",this.clear),this.$emit("input",e),this.$emit("blur",e),this.$nextTick((function(){c.calcTab()}))}},input:function(e){var t=this.hasVal(this.value)?this.value.toString():"",i="";this.isSelectAll?(i=e,this.isSelectAll=!1):i=t+e,console.log("newValue =====",i),this.$emit("input",i),c.setKeysStatus(i,this.type)},assign:function(e){this.isSelectAll=!1,this.$emit("input",e),c.setKeysStatus(e,this.type)},deleteValue:function(){var e=this.hasVal(this.value)?this.value.toString():"",t="";this.hasVal(e)&&(t=this.isSelectAll?"":e.substr(0,e.length-1)),this.$emit("input",t),c.setKeysStatus(t,this.type)},clear:function(){this.$emit("input",""),c.setKeysStatus("",this.type)},checkValue:function(){var e=this.hasVal(this.value)?this.value.toString():"";"-"===e&&(e=""),"."===e.substr(-1)&&(e=e.substr(0,e.length-1));var t=e.indexOf(".");return t>0&&(e=parseFloat(e.substring(0,t+this.decimal+1))),e=parseFloat(e),isNaN(e)?this.required&&this.emptyAutoRecover?(e=this.rawValue,this.$emit("onEmpty")):e="":(e<this.min&&(e=this.overflowAutoRecover?this.rawValue:this.min,this.$emit("overflowRange")),e>this.max&&(e=this.overflowAutoRecover?this.rawValue:this.max,this.$emit("overflowRange"))),e}}},u=(i("6abe"),Object(o.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"number-input component-number-input",class:{"number-input-focus":e.isFocusing,"number-input-empty":e.isSetEmptyTip&&!e.value&&!e.isFocusing,"number-input-select-all":e.isSelectAll,qualified:"true-or-false"===e.type&&1===e.value,unqualified:"true-or-false"===e.type&&0===e.value}},[i("div",{staticClass:"text",class:{disabled:e.disabled},on:{click:function(t){return t.stopPropagation(),e.openKeyboard(t)}}},[e.hasVal(e.value)?i("span",{staticClass:"value"},[i("span",{staticClass:"value-handle"},[e._v(e._s("true-or-false"===e.type?1===e.value?"合格":"不合格":e.value))])]):i("span",{staticClass:"placeholder"},[e._v("\n      "+e._s(e.placeholder)+"\n    ")])]),e._t("extend")],2)}),[],!1,null,"74068386",null));t.a=u.exports},"6abe":function(e,t,i){"use strict";i("bebe")},7434:function(e,t,i){var a=i("0cb6");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("f6a1180a",a,!0,{sourceMap:!1,shadowMode:!1})},7460:function(e,t,i){"use strict";i("cc57");var a=i("e2a7"),s=i("ed08"),o=i("3e47"),n={name:"TemplateGuide",components:{Converting:i("e8e4").a},props:{projId:{type:String,default:""},module:{type:String,default:""},connectId:{type:String,default:""}},data:function(){return{templateData:null,inConverting:!1}},watch:{connectId:function(e){this.init()}},activated:function(){this.init()},methods:{init:function(){var e=this,t=this.connectId;return t?Promise.resolve().then((function(){return"process"===e.module?o.a.getProcessTemplate(e.projId,t):"material"===e.module?o.a.getMaterialTemplate(e.projId,t):void 0})).then((function(i){t===e.connectId&&(e.templateData=i,e.$emit("queryHasTemplate",!!i))})).catch((function(t){e.templateData=null,e.$emit("queryHasTemplate",!1),console.error(t)})):Promise.resolve()},downloadTemplate:function(){var e=this.templateData.url,t=s.a.formatFiletypes(e);"dwg"!==t&&"rvt"!==t?this.openTemplateGuide():this.handleCovertingAndDownload()},handleCovertingAndDownload:function(){var e=this,t=this.templateData.id;this.inConverting=!0,o.a.coverterBimface(t).then((function(t){e.templateData.url=t,$log.log("converting url",t),e.inConverting=!1,e.openTemplateGuide()})).catch((function(){e.inConverting=!1,$log.log("转换失败")}))},openTemplateGuide:function(){var e=this;return Promise.resolve().then((function(){var t=e.templateData.downloadInfo;if(!t.download_time||t.upload_time>t.download_time)return o.a.downloadSingleTemplate(e.templateData.id,e.templateData.name,e.templateData.url)})).then((function(){return o.a.openTemplate(e.templateData.id,e.templateData.name,e.templateData.url).catch((function(e){a.a.alert(e)}))})).catch((function(e){a.a.alert(e)}))}}},r=(i("d81a"),i("17cc")),c=Object(r.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.templateData?i("div",{staticClass:"header-btn",on:{click:function(t){e.downloadTemplate()}}},[e.inConverting?i("converting",{staticClass:"cover"}):e._e(),e.inConverting?e._e():i("span",[e._v("样板")])],1):e._e()}),[],!1,null,"02a5f460",null);t.a=c.exports},"75ca":function(e,t,i){"use strict";var a=i("329b"),s=i("3480").a,o=(i("d6fa"),i("17cc")),n=Object(o.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-right"}},[e.show?i("page-content",{attrs:{mode:"dialog",title:(e.multiple?"":"选择")+"退回原因","on-close":e.closePopup}},[e.multiple?e._e():i("div",[i("div",{staticClass:"list"},e._l(e.reasonList,(function(t,a){return i("item",{key:a,attrs:{mode:"edit","icon-right":t.id===e.reason.id?"qualified":"","icon-right-color":"color-theme"},on:{click:function(i){e.selectItem(t)}}},[i("div",{staticClass:"item-text"},[e._v("\n            "+e._s(t.text)+"\n          ")])])}))),i("item-textarea",{staticClass:"mt10",attrs:{placeholder:e.placeholder},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}}),i("item",{staticClass:"p15"},[i("item-img-list",{attrs:{maxlength:15,"allow-select-album":e.allowSelectAlbum,"allow-buildin-album":e.allowBuildinAlbum},model:{value:e.images,callback:function(t){e.images=t},expression:"images"}})],1),i("app-button-group",[i("app-button",{on:{click:e.submit}},[e._v("提交")])],1)],1),e.multiple?i("div",[i("div",{staticClass:"list"},e._l(e.reasonList,(function(t,a){return i("item",{key:a,attrs:{mode:"edit","icon-back":e.isBack,"icon-left":t.checked?"qualified":""},on:{click:function(i){e.selectItem(t)}}},[i("div",{staticClass:"item-text"},[e._v("\n            "+e._s(t.text)+"\n          ")])])}))),i("div",{staticClass:"list mt10"},[i("item",{staticClass:"p15"},[i("item-img-list",{attrs:{maxlength:15,"allow-select-album":e.allowSelectAlbum,"allow-buildin-album":e.allowBuildinAlbum},model:{value:e.images,callback:function(t){e.images=t},expression:"images"}})],1),i("item-textarea",{staticClass:"mt10",attrs:{placeholder:e.placeholder},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1),i("app-button-group",[i("app-button",{on:{click:e.submit}},[e._v("确认退回")])],1)],1):e._e()]):e._e()],1)}),[],!1,null,"29e0b631",null).exports,r=!1;r||(r=new(a.default.extend(n))({el:document.createElement("div")}),document.body.appendChild(r.$el));t.a=r},"7c9b":function(e,t,i){"use strict";(function(e){i("e204"),i("f548"),i("6d57"),i("cc57"),i("c904");var a=i("e89f"),s=i("1df9"),o=i("774b"),n=i("e2a7"),r=i("7cb8");t.a={components:{PageContent:s.a,Scroller:o.a},mixins:[a.a],data:function(){return{show:!1,title:"",options:[],actionTabs:[],mapSelectedItems:[],selectedResult:"",optionsMap:{},statusMap:{},autoSuffix:!0,nameKeys:{"unit-floor-room":[{id:"unit",name:"unit_name",children:"floors"},{id:"floor",name:"floor_name",children:"rooms"},{name:"room_name"}],"floor-room":[{id:"floor",name:"floor_name",children:"rooms"},{name:"room_name"}],"unit-floor":[{id:"unit",name:"unit_name",children:"floors"},{id:"floor",name:"floor_name"}],floor:[{id:"floor",name:"floor_name"}]}}},computed:{selectedResultText:function(){return e.clone(this.mapSelectedItems).sort((function(e,t){return e.order-t.order})).reduce((function(e,t){return e+="、"+t.name}),"").substring(1)}},mounted:function(){window.dialogTest=this},methods:{initData:function(e){var t=this;this.actionTabs=[],this.mapSelectedItems=[],this.selectedResult="",this.options=e||[],"floor"===this.type&&this.options.floors&&(this.options=this.options[0].floors);var i=this.traversOptions(this.options);if("floor"===this.type){var a=0,s=[];for(var o in this.statusMap)this.statusMap[o].pid="allfloors",this.statusMap[o].disabled||(a+=2),s.push(o);var n=!1;0===a&&(n=!0),this.statusMap.allfloors={id:"allfloors",status:"0",total:a,countChecked:0,children:s,disabled:n}}i.forEach((function(e){t.toggleItem(e.id,!0)}))},traversOptions:function(e){var t=this,i={},a={},s=[],o=this.nameKeys[this.type],n=0;function c(e){var o=e.val,r=e.mapId,c=e.parentId,p=e.childrenKey,d=e.isChecked,u=e.isForceChecked,h=e.isDisabled;i[r]=o;var m=c?a[c].name:"",f={id:r,status:"0",order:n++,originName:o.name,disabled:h,isForceChecked:u,name:t.autoSuffix?(m+o.name).replace(/单元.*层(.)/,"单元$1"):m+o.name};if(a[r]=f,p&&(f.total=o[p]?2*o[p].filter((function(e){return!l(e)})).length:0,0===f.total&&(f.disabled=!0),f.countChecked=0),c){f.pid=c;var g=a[c];g.children||(g.children=[]),g.children.push(r)}o.status&&(f.statusText=o.status),d&&s.push(f)}function l(e){return!!(e.used||e.disabled||e.status&&!e.checked)}return function e(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(i)&&i.length){var n=s?s+"-":"",p=a===o.length-1;i.forEach((function(i){var d=o[a];i.name||(i.name=i[d.name]||""),i.id||(i.id=i[d.id]),t.autoSuffix&&(i.hasOwnProperty("floors")&&(i.name=Object(r.a)(i.name,"单元")),i.hasOwnProperty("rooms")&&(i.name=Object(r.a)(i.name,"层")));var u=!1;p&&l(i)&&(u=!0);var h=!1,m=!1;p&&((h=i.checked||!1)&&(m=!0),~t.selected.findIndex((function(e){return"unit-floor"===t.type?e.id===i.id&&e.unit===i.unit:e.id===i.id}))&&(m=!0));var f=n+i.id,g=d.children;c({val:i,mapId:f,parentId:s,childrenKey:g,isChecked:m,isForceChecked:h,isDisabled:u}),g&&e(i[g],a+1,f)}))}}(e),this.optionsMap=i,this.statusMap=a,s},openPopup:function(e){this.show=!0,this.title=e.title,this.selected=e.selected,this.onSelect=e.onSelect,this.rightBtn=e.rightBtn,this.type=e.type,this.rightBtnEvent=e.rightBtnEvent,this.autoSuffix=!1!==e.autoSuffix,this.initData(e.options),this.$emit("open")},closePopup:function(){this.show=!1,this.$emit("close")},_handlerItemSelected:function(e,t){if(!e.total){var i=this.mapSelectedItems.indexOf(e);t?~i&&this.mapSelectedItems.splice(i,1):~i||this.mapSelectedItems.push(e)}},toggleItem:function(e,t){var i=this,a=this.statusMap;var s=a[e];if(!t&&s.isForceChecked||s.disabled)s.statusText&&!t&&n.a.alert(s.statusText);else{var o,r=s.status;(function e(t,o){var n=a[t];n.status=o,"2"===o&&n.total?n.countChecked=n.total:n.countChecked=0,n.hasOwnProperty("children")?n.children.length&&n.children.forEach((function(t){i.optionsMap[t].checked||e(t,o)})):s.isForceChecked||n.disabled||i._handlerItemSelected(n,"0"===o)})(e,o="2"===r?"0":"2"),function e(t,i){var s=a[t].pid;if(s){var o=a[s],n=function(e,t){var i=e.status,a=e.total;e.countChecked=e.countChecked+t;var s=e.countChecked;switch(!0){case 0===s:e.status="0";break;case s<a:e.status="1";break;case s===a:e.status="2";break;default:$log.error("something is wrong on @toggleItem: current pItem's pCountChecked: ".concat(s,", pTotal: ").concat(a))}return e.status-i}(o,i);0!==n&&e(o.id,n)}}(e,o-r)}},mapStatusToClass:function(e,t){if(this.statusMap[e].disabled)return"-disabled";return["","-indeterminate","-checked"][this.statusMap[e].status]},onRightBtnEvent:function(){var t=this;if(e.isEmpty(this.mapSelectedItems)){if("room"===this.type.substr(-4))return n.a.alert("请选择房间");if("floor"===this.type.substr(-5))return n.a.alert("请选择楼层")}var i=[];this.mapSelectedItems.forEach((function(e){i.push(t.optionsMap[e.id])})),this.rightBtnEvent(i),this.show=!1}}}}).call(this,i("391c"))},"7d4e":function(e,t,i){var a=i("c59b");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("62c5f5a2",a,!0,{sourceMap:!1,shadowMode:!1})},"7e06":function(e,t,i){"use strict";var a=i("c5a7");t.__esModule=!0,t.unifySlots=r,t.createComponent=function(e){return function(t){var i;return"function"==typeof t&&(t={functional:!0,props:(i=t).props,model:i.model,render:function(e,t){return i(e,t.props,r(t),t)}}),t.functional||(t.mixins=t.mixins||[],t.mixins.push(o.SlotsMixin)),t.name=e,t.install=n,t}},i("4d1b");var s=i("a1aa"),o=i("1304");a(i("329b"));function n(e){var t=this.name;e.component(t,this),e.component((0,s.camelize)("-"+t),this)}function r(e){var t=e.scopedSlots||e.data.scopedSlots||{},i=e.slots();return Object.keys(i).forEach((function(e){t[e]||(t[e]=function(){return i[e]})})),t}},"81f2":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,'.zjapp .main[data-v-2cac8864]{position:fixed;width:100%;bottom:0}.zjapp .arrow[data-v-2cac8864]{position:absolute;top:-7px;right:18px;width:0;height:0;border-bottom:7px solid #fff;border-right:7px solid transparent;border-left:7px solid transparent}.zjapp .content[data-v-2cac8864]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-2cac8864]{display:flex;flex-direction:column;background-color:#fff;overflow:auto}.zjapp .box-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1}.zjapp .detail-hd[data-v-2cac8864]{display:flex;padding:6px 15px}.zjapp .detail-arrow-right[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-right[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:12px;border:5px solid transparent;border-left:5px solid #c8c8c8}.zjapp .detail-arrow-down[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-down[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:15px;border:5px solid transparent;border-top:5px solid #c8c8c8}.zjapp .detail-title[data-v-2cac8864]{flex:1;line-height:34px;color:#111;font-size:16px}.zjapp .detail-bd[data-v-2cac8864]{padding:8px 15px 8px 35px;background-color:#fafafa}.zjapp .text-line[data-v-2cac8864]{font-size:14px;color:#666;line-height:30px;margin-bottom:30px}.zjapp .detail-hd-single[data-v-2cac8864]{padding:6px 0;margin:0 15px}.zjapp .detail-bd-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1;padding:8px 15px;background-color:#fff}',""])},"8b97":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .cover[data-v-02a5f460] path{fill:#fff!important}",""])},"8c3d":function(e,t,i){"use strict";(function(e){i("ed63"),i("163d"),i("2b45"),i("e204"),i("cc57");var a,s,o=i("07d2"),n=i("cf09"),r=i("6f9e"),c=i("4360"),l=[],p=[0,1,2,3,4,5,6,7,8,9,".","-"];function d(e){return null!=e&&""!==e}t.a={name:"NumberKeyboard",components:{Item:o.a},data:function(){return{show:!1,isClosing:!1,zIndex:0,willOpenParams:null,inputComponent:"",type:"",hasPrev:!1,hasNext:!1,isDisabledMinus:!1,isDisabledPoint:!1}},computed:{isIOSBezelLess:function(){return c.a.state.app.isIOSBezelLess}},watch:{isClosing:function(e){var t=this;this.$nextTick((function(){!e&&t.willOpenParams&&t.openKeyboard(t.willOpenParams)}))}},created:function(){r.a.$on("routerBeforeEach",this.closeKeyboard),r.a.$on("pageContentClick",this.closeKeyboard)},destroyed:function(){r.a.$off("routerBeforeEach",this.closeKeyboard),r.a.$off("pageContentClick",this.closeKeyboard)},methods:{openKeyboard:function(e){this.isClosing?this.willOpenParams=e:(this.willOpenParams=null,this.show=!0,this.inputComponent=e.inputComponent,this.zIndex=n.a?++n.a.zIndex:1,c.a.commit("global/SET_IS_NUMBER_INPUT_OPEN",!0),c.a.commit("global/SET_NUMBER_KEYBOARD_HEIGHT",c.a.state.app.isIOSBezelLess?266:"true-or-false"===this.inputComponent.type?176:232),this.calcTab(),this.type=this.inputComponent.type,this.setKeysStatus(this.inputComponent.value,this.inputComponent.type),r.a.$emit("numberKeyboardOpen",this.inputComponent))},closeKeyboard:function(){this.show=!1,r.a.$emit("numberKeyboardClose")},startClose:function(){this.isClosing=!0},onClose:function(){this.isClosing=!1,c.a.commit("global/SET_IS_NUMBER_INPUT_OPEN",!1),r.a.$emit("afterNumberKeyboardClose")},input:function(e){"-"===e&&this.isDisabledMinus||"."===e&&this.isDisabledPoint||this.$emit("keyboardInput",e)},delete:function(e){var t=this;this.$emit("keyboardDelete"),a=setTimeout((function(){t.$emit("keyboardClear")}),500)},calcTab:function(){var t=function e(t){return t&&t.$parent?"Scroller"===t.$parent.$options.name?t.$parent:e(t.$parent):null}(this.inputComponent),i=t&&t.$el.querySelectorAll(".component-number-input");if(l=[],i&&e.each(i,(function(e){l.push(e.__vue__)})),e.isEmpty(l))this.hasPrev=!1,this.hasNext=!1;else{var a=e.findIndex(l,this.inputComponent);this.hasPrev=a>0,this.hasNext=a<l.length-1}this.inputComponent&&this.inputComponent.nextEvent&&(this.hasNext=!0)},prev:function(){var t=e.findIndex(l,this.inputComponent),i=l[t-1];i&&(r.a.$emit("numberInputBlur"),i.setFocus(),this.openKeyboard({inputComponent:i}))},next:function(){var t=e.findIndex(l,this.inputComponent),i=l[t+1];i?(r.a.$emit("numberInputBlur"),i.setFocus(),this.openKeyboard({inputComponent:i})):this.inputComponent&&this.inputComponent.nextEvent&&this.inputComponent.nextEvent()},setTure:function(){this.$emit("keyboardAssign",1)},setFalse:function(){this.$emit("keyboardAssign",0)},setKeysStatus:function(e,t){e=d(e)?e.toString():"",d(e)||t.indexOf("positive")>=0?this.isDisabledMinus=!0:this.isDisabledMinus=!1,!/\d/.test(e)||e.indexOf(".")>=0||t.indexOf("int")>=0?this.isDisabledPoint=!0:this.isDisabledPoint=!1},setKeyActiving:function(e,t){e&&e.classList.contains("keys")&&!e.classList.contains("disabled")&&(t?e.classList.add("activing"):e.classList.remove("activing"))},keyTouchstart:function(e){var t=e&&e.target;if(t){+new Date,s=t,this.setKeyActiving(t,!0);var i=t.getAttribute("direct");"closeKeyboard"!==i&&this.clickHandler(i)}},keyTouchend:function(e){var t=e&&e.target;if(t){this.setKeyActiving(t,!1),this.setKeyActiving(s,!1);var i=t.getAttribute("direct");"delete"===i?clearTimeout(a):"closeKeyboard"===i&&this.clickHandler(i)}},clickHandler:function(e){e&&(isNaN(e)||(e=Number(e)),"function"==typeof this[e]?this[e]():p.includes(e)&&this.input(e))}}}}).call(this,i("391c"))},9120:function(e,t,i){var a=i("2ddb");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("cb55f532",a,!0,{sourceMap:!1,shadowMode:!1})},"91c1":function(e,t,i){"use strict";(function(e){i("5ab2"),i("6d57"),i("e10e"),i("9a33");var a=i("28f8"),s=i("e68e"),o=i("6f9e"),n=i("bcc7"),r=i("e89f");function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}t.a={name:"CheckGuideDetailDrop",components:{ItemImgList:s.a},mixins:[r.a],data:function(){return{show:!1,showList:!1,isLoading:!1,isOpening:!1,isClosing:!1,contentTop:64,listHeight:510,module:"",itemIds:[],data:[],target:""}},watch:{show:function(e){var t=this;e&&this.$nextTick((function(){t.showList=!0}))}},created:function(){o.a.$on("routerBeforeEach",this.closePopup),o.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){o.a.$off("routerBeforeEach",this.closePopup),o.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(t){this.show=!0,this.$emit("open"),this.module=t.module,this.itemIds=t.itemIds,this.options=t.options;var i=document.querySelector(".layout-main .layout-header");if(this.contentTop=i.offsetHeight,t.el){var a=t.el.getBoundingClientRect();this.contentTop=a.bottom}this.target=t.el,this.listHeight=e.minBy([window.innerHeight-this.contentTop-50,510]),this.getData()},closePopup:function(){var e=this;if(!this.isOpening)return this.showList=!1,this.$emit("close"),new Promise((function(t){e.$on("afterClosePopup",t)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(e){e&&e.target&&e.target!==this.target&&this.show&&this.closePopup()},getData:function(){var t=this;return this.options&&this.options.length?(this.data=e.map(this.options,(function(e){return l(l({},e),{},{isOpen:!1})})),Promise.resolve()):n.a.getMeasureCheckItem(this.itemIds).then((function(i){t.data=e.map(i,(function(t){var i=t.content?t.content.trim():"",a=i?i.split("\n"):[],s=t.content_image?JSON.parse(t.content_image):[],o=e.filter(a,(function(e){return!/<img([\s\S]*)>/gm.test(e)}));return e.each(s,(function(e){e.url=e.url.split("@")[0]})),{id:t.id,name:t.full_name,textArr:o,contentImage:s,isOpen:!1}}))})).catch((function(e){console.error(e)}))},toggleItem:function(e){this.data.length>1&&this.$set(e,"isOpen",!e.isOpen)}}}}).call(this,i("391c"))},9446:function(e,t,i){var a=i("2dd6");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("2192cd00",a,!0,{sourceMap:!1,shadowMode:!1})},"960c":function(e,t,i){"use strict";i.r(t);var a=i("b2a0").a,s=(i("3e18"),i("17cc")),o=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("page-content",{attrs:{title:e.processData.name,"show-go-root":!0}},[i("template",{slot:"header-bar-right"},[!1===e.hasTemplate?i("check-guide",{attrs:{"item-id":e.checkItemId}}):e._e(),i("template-guide",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading&&!1!==e.hasTemplate,expression:"!isLoading && hasTemplate !== false"}],attrs:{module:"process","proj-id":e.projId,"connect-id":e.checkItemId},on:{queryHasTemplate:e.setHasTemplate}})],1),i("swipe-tabs",{attrs:{color:"#4275e8","title-active-color":"#4275e8","line-width":e.tabsWidth},model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[i("swipe-tab",{attrs:{title:"工序信息"}},[e.isLoading?e._e():i("scroller",["待移交"!==e.processData.status?i("problem-detail-header",{staticClass:"bg-white",attrs:{status:e.processData.status}}):e._e(),i("div",{staticClass:"base-detail-header"},[i("p",{staticClass:"base-detail-title"},[e._v(e._s(e.processData.name))]),i("p",{staticClass:"base-detail-content"},[e._v("\n            标段："+e._s(e.processData.section_name)+"("+e._s(e.processData.proj_name)+")\n          ")]),e.processData.location_id?e._e():i("p",{staticClass:"base-detail-content"},[e._v("\n            楼栋："+e._s(e.processData.building_name)+e._s(e.processData.unit?"-"+e.processData.unit.replace("单元","")+"单元":"")+"\n          ")]),e.processData.location_id?i("p",{staticClass:"base-detail-content"},[e._v("\n            部位："+e._s(e.processData.location.parent_name?e.processData.location.parent_name+"-":"")+e._s(e.processData.location.name)+"\n          ")]):e._e()]),"已退回"!==e.processData.status&&e.backLogList.length?i("item",{staticClass:"mb10",attrs:{mode:"edit",border:"none",label:"退回记录",text:e.backLogList.length+"次","icon-right":"arrow-right"},on:{click:e.openBackHistory}}):e._e(),1===e.processMode||2===e.processMode||5===e.processMode?i("item",{attrs:{mode:"待移交"===e.processData.status?"edit":"view",label:"移交部位",text:e.placeName,editabled:"待移交"===e.processData.status&&e.isRepair&&!e.backLogList.length},on:{click:function(t){"待移交"===e.processData.status&&e.isRepair&&!e.backLogList.length&&e.setUnitFloor()}}}):e._e(),3===e.processMode?i("item",{attrs:{mode:"待移交"===e.processData.status?"edit":"view",label:"移交部位",text:"整栋"}}):e._e(),90===e.processMode?i("item",{attrs:{mode:"待移交"===e.processData.status?"edit":"view",label:"移交部位",text:e.processData.custom_location||"无"}},[i("template",{slot:"right"},[e.backLogList.length?i("div",{staticClass:"item-text align-l"},[e._v("\n              "+e._s(e.processData.custom_location||"无")+"\n            ")]):i("div",{staticClass:"item-con"},["待移交"===e.processData.status?i("input",{directives:[{name:"model",rawName:"v-model",value:e.processData.custom_location,expression:"processData.custom_location"}],staticClass:"location-place-input",attrs:{type:"text",placeholder:"必填，最多50字",maxlength:"50"},domProps:{value:e.processData.custom_location},on:{blur:e.saveCustomLocation,input:function(t){t.target.composing||e.$set(e.processData,"custom_location",t.target.value)}}}):i("div",{staticClass:"item-text align-l"},[e._v("\n                "+e._s(e.processData.custom_location)+"\n              ")])])])],2):e._e(),90===e.processMode?i("item",{attrs:{mode:"待移交"===e.processData.status?"edit":"view"}},[i("div",{class:"待移交"===e.processData.status?"item-text":"item-label item-label-gray"},[e._v("\n            整体完成率("+e._s(e.processData.location.name)+")\n          ")]),i("div",{staticClass:"item-con",class:"待移交"===e.processData.status?"align-r":"align-l item-location"},[i("number-input",{attrs:{type:"int",range:[0,100],"overflow-auto-recover":!1},on:{blur:e.setValChange},model:{value:e.processData.complete_progress,callback:function(t){e.$set(e.processData,"complete_progress",t)},expression:"processData.complete_progress"}})],1),i("div",{staticClass:"item-font pl5"},[e._v("%")])]):e._e(),i("single-select",{attrs:{title:"施工单位",mode:"待移交"===e.processData.status?"edit":"view",options:e.contractors,editabled:"待移交"===e.processData.status&&e.isRepair&&!e.backLogList.length},on:{onSelect:e.changePerson},model:{value:e.processData.contractor,callback:function(t){e.$set(e.processData,"contractor",t)},expression:"processData.contractor"}}),i("user-select",{attrs:{title:"施工负责人",mode:"待移交"===e.processData.status?"edit":"view",editabled:!1,date:e._f("formatDate")(e.processData.repair_complete_date),status:e.processData.repair_status,"status-class":e.statusClassSet[e.processData.repair_status]},model:{value:e.processData.repair,callback:function(t){e.$set(e.processData,"repair",t)},expression:"processData.repair"}}),("待验收"===e.processData.status||"已验收"===e.processData.status)&&e.hasRepairConfirm&&e.processData.checkPointDetail.length?i("div",{staticClass:"bg-white"},[e._l(e.processData.checkPointDetail,(function(t,a){return[i("item",{key:"title"+a,staticClass:"mt10",attrs:{text:t.title}},[i("i",{staticClass:"icon-point",attrs:{slot:"icon-left"},slot:"icon-left"})]),i("item",{key:"img"+a,staticClass:"pt0 pb15"},[i("item-img-list",{attrs:{"model-id":t.id,"model-field":"image_file","model-table":"process_check_checkpoint_detail",editabled:!1,"edit-by":e.processData.repair.id,group:"check-point-view","track-text":"工序移交报验"},model:{value:t.image_file,callback:function(i){e.$set(t,"image_file",i)},expression:"point.image_file"}})],1),t.content?i("div",{key:"con"+a,staticClass:"pl15 pr15 pb10 bg-white"},[i("div",{staticClass:"point-content"},[e._v(e._s(t.content))])]):e._e()]}))],2):e._e(),"待验收"!==e.processData.status&&"已验收"!==e.processData.status||!e.processData.repair_remark?e._e():i("item",{staticClass:"mt10",attrs:{label:"备注",mode:"view",text:e.processData.repair_remark}}),"已退回"===e.processData.status&&e.repairLog.checkpoint&&e.repairLog.checkpoint.length?i("div",{staticClass:"bg-white"},[e._l(e.repairLog.checkpoint,(function(t,a){return[i("item",{key:"title"+a,staticClass:"mt10",attrs:{text:t.title}},[i("i",{staticClass:"icon-point",attrs:{slot:"icon-left"},slot:"icon-left"})]),i("item",{key:"img"+a,staticClass:"pt0 pb15"},[i("item-img-list",{attrs:{"model-id":t.id,"model-field":"image_file","model-table":"process_check_send_back_checkpoint_detail",editabled:!1,"edit-by":e.processData.repair.id,group:"check-point-view"},model:{value:t.image_file,callback:function(i){e.$set(t,"image_file",i)},expression:"point.image_file"}})],1),t.content?i("div",{key:"con"+a,staticClass:"pl15 pr15 pb10 bg-white"},[i("div",{staticClass:"point-content"},[e._v(e._s(t.content))])]):e._e()]}))],2):e._e(),"已退回"===e.processData.status&&e.repairLog.repair_remark?i("item",{staticClass:"mt10",attrs:{label:"备注",mode:"view",text:e.repairLog.repair_remark}}):e._e(),e.needReceiver&&"验收通过"===e.processData.receive_status?i("div",{staticClass:"mt10"},[i("item",{attrs:{label:"后续接收单位",text:e.processData.receive_contractor.name}}),i("user-select",{attrs:{title:"后续接收人",mode:"view",date:e._f("formatDate")(e.processData.receive_complete_date),status:e.processData.receive_status,"status-class":e.statusClassSet[e.processData.receive_status],editabled:!1},model:{value:e.processData.receive_complete,callback:function(t){e.$set(e.processData,"receive_complete",t)},expression:"processData.receive_complete"}}),i("item",{attrs:{label:"移交记录"}},[i("template",{slot:"right"},[e.processData.receive_remark||e.processData.receive_image_file.length?i("div",{staticClass:"item-con"},[e.processData.receive_remark?i("div",{staticClass:"item-font"},[e._v("\n                  "+e._s(e.processData.receive_remark)+"\n                ")]):e._e(),i("item-img-list",{attrs:{"model-id":e.processData.receive_status_id,"model-field":"image_file","model-table":"process_check_status",editabled:!1,"edit-by":e.processData.receive_complete.id},model:{value:e.processData.receive_image_file,callback:function(t){e.$set(e.processData,"receive_image_file",t)},expression:"processData.receive_image_file"}})],1):i("div",{staticClass:"item-text"},[e._v("无")])])],2)],1):e._e(),"验收通过"===e.processData.check_status?i("div",{staticClass:"mt10"},[i("user-select",{attrs:{title:"监理",mode:"view",date:e._f("formatDate")(e.processData.check_complete_date),status:e.processData.check_status,"status-class":e.statusClassSet[e.processData.check_status],editabled:!1},model:{value:e.processData.check_complete,callback:function(t){e.$set(e.processData,"check_complete",t)},expression:"processData.check_complete"}}),i("item",{attrs:{label:"移交记录"}},[i("template",{slot:"right"},[e.processData.check_remark||e.processData.check_image_file.length?i("div",{staticClass:"item-con"},[e.processData.check_remark?i("div",{staticClass:"item-font"},[e._v("\n                  "+e._s(e.processData.check_remark)+"\n                ")]):e._e(),i("item-img-list",{attrs:{"model-id":e.processData.check_status_id,"model-field":"image_file","model-table":"process_check_status",editabled:!1,"edit-by":e.processData.check_complete.id},model:{value:e.processData.check_image_file,callback:function(t){e.$set(e.processData,"check_image_file",t)},expression:"processData.check_image_file"}})],1):i("div",{staticClass:"item-text"},[e._v("无")])])],2)],1):e._e(),e.needConstructer&&"验收通过"===e.processData.construct_status?i("div",{staticClass:"mt10"},[i("user-select",{attrs:{title:"建设单位负责人",mode:"view",date:e._f("formatDate")(e.processData.construct_complete_date),status:e.processData.construct_status,"status-class":e.statusClassSet[e.processData.construct_status],editabled:!1},model:{value:e.processData.construct_complete,callback:function(t){e.$set(e.processData,"construct_complete",t)},expression:"processData.construct_complete"}}),i("item",{attrs:{label:"移交记录"}},[i("template",{slot:"right"},[e.processData.construct_remark||e.processData.construct_image_file.length?i("div",{staticClass:"item-con"},[e.processData.construct_remark?i("div",{staticClass:"item-font"},[e._v("\n                  "+e._s(e.processData.construct_remark)+"\n                ")]):e._e(),i("item-img-list",{attrs:{"model-id":e.processData.construct_status_id,"model-field":"image_file","model-table":"process_check_status",editabled:!1,"edit-by":e.processData.construct_complete_user_id},model:{value:e.processData.construct_image_file,callback:function(t){e.$set(e.processData,"construct_image_file",t)},expression:"processData.construct_image_file"}})],1):i("div",{staticClass:"item-text"},[e._v("无")])])],2)],1):e._e(),e.areaAcceptorCheckedList&&e.areaAcceptorCheckedList.length?i("div",{staticClass:"mt10"},[e._l(e.areaAcceptorCheckedList,(function(t,a){return[i("user-select",{key:"user"+a,attrs:{title:"区域验收人",mode:"view",date:e._f("formatDate")(t.complete_date),status:t.status,"status-class":e.statusClassSet[t.status],editabled:!1},model:{value:t.areaAcceptor,callback:function(i){e.$set(t,"areaAcceptor",i)},expression:"area.areaAcceptor"}}),i("item",{key:"info"+a,attrs:{label:"移交记录"}},[i("template",{slot:"right"},[t.remark||t.image_file.length?i("div",{staticClass:"item-con"},[t.remark?i("div",{staticClass:"item-font"},[e._v(e._s(t.remark))]):e._e(),i("item-img-list",{attrs:{"model-id":t.id,"model-field":"image_file","model-table":"process_check_status",editabled:!1,"edit-by":t.process_check_id},model:{value:t.image_file,callback:function(i){e.$set(t,"image_file",i)},expression:"area.image_file"}})],1):i("div",{staticClass:"item-text"},[e._v("无")])])],2)]}))],2):e._e(),"已退回"!==e.processData.status?i("div",{staticClass:"mt10"},[e.needReceiver&&!e.hasReceiverConfirm?i("single-select",{attrs:{title:"后续接收单位",options:e.receiverContractors,editabled:(e.isRepair||e.isReinspect&&"待移交"!==e.processData.status)&&!e.hasReceiverConfirm},on:{onSelect:e.changePerson},model:{value:e.processData.receive_contractor,callback:function(t){e.$set(e.processData,"receive_contractor",t)},expression:"processData.receive_contractor"}}):e._e(),e.needReceiver&&!e.hasReceiverConfirm?i("user-select",{attrs:{title:"后续接收人",options:e.repairs,editabled:(e.isRepair||(e.isReinspect||e.isReceiver)&&"待移交"!==e.processData.status)&&!e.hasReceiverConfirm},on:{onSelect:function(t){e.changeReceiver()}},model:{value:e.processData.receiver,callback:function(t){e.$set(e.processData,"receiver",t)},expression:"processData.receiver"}}):e._e(),e.hasReinspectConfirm?e._e():i("user-select",{attrs:{title:"监理",options:e.checkers,editabled:(e.isRepair||e.isReinspect&&"待移交"!==e.processData.status)&&!e.hasReinspectConfirm},on:{onSelect:function(t){e.changePerson("checker")}},model:{value:e.processData.checker,callback:function(t){e.$set(e.processData,"checker",t)},expression:"processData.checker"}}),e.needConstructer&&!e.hasConstructerConfirm?i("user-select",{attrs:{title:"建设单位负责人",options:e.constructers,editabled:(e.isRepair||e.isConstructer&&"待移交"!==e.processData.status)&&!e.hasConstructerConfirm},on:{onSelect:function(t){e.changePerson("constructer")}},model:{value:e.processData.constructer,callback:function(t){e.$set(e.processData,"constructer",t)},expression:"processData.constructer"}}):e._e(),"已验收"!==e.processData.status&&"已退回"!==e.processData.status&&e.processData.area_acceptor&&e.processData.area_acceptor.length>0?i("user-select",{attrs:{title:"区域验收人",multi:!0,editabled:!1,"select-required":"false"},model:{value:e.processData.area_acceptor,callback:function(t){e.$set(e.processData,"area_acceptor",t)},expression:"processData.area_acceptor"}}):e._e(),"已验收"!==e.processData.status?i("user-select",{attrs:{title:"抄送人",multi:!0,options:e.ccList,memory:!e.processCheckId,editabled:e.isRepair&&"已验收"!==e.processData.status||e.isReceiver&&!e.hasReceiverConfirm||e.isReinspect&&!e.hasReinspectConfirm||e.isConstructer&&!e.hasConstructerConfirm,"select-required":"false"},on:{onSelect:function(t){e.changeCC()}},model:{value:e.processData.cc,callback:function(t){e.$set(e.processData,"cc",t)},expression:"processData.cc"}}):e._e(),"已验收"===e.processData.status?i("user-select",{attrs:{title:"抄送人",multi:!0,"select-style":"detail",mode:"view",options:e.ccList,editabled:!1,"select-required":"false"},on:{onSelect:function(t){e.changeCC()}},model:{value:e.processData.cc,callback:function(t){e.$set(e.processData,"cc",t)},expression:"processData.cc"}}):e._e()],1):e._e(),"已退回"!==e.processData.status&&(e.showBtnProcess||e.showBtnPass)?i("div",{staticClass:"mt10"},["待移交"!==e.processData.status?i("item",[i("div",{staticClass:"item-con"},[i("div",{staticClass:"item-text"},[e._v("移交记录")]),i("item-img-list",{staticClass:"pt10 pb10",attrs:{"prepare-callback":function(){return e.prepareTakePicture()},maxlength:50},on:{callback:e.saveProblem},model:{value:e.processData.img,callback:function(t){e.$set(e.processData,"img",t)},expression:"processData.img"}})],1)]):e._e(),e.processData.checkPointDetail&&e.processData.checkPointDetail.length&&"待移交"===e.processData.status?[e._l(e.processData.checkPointDetail,(function(t,a){return[i("item",{key:"hd"+a,staticClass:"mt10",attrs:{text:t.title,"icon-right":e.checkPointOpenStatus[t.id]?"arrow-up":"arrow-down",border:"bottom"},on:{click:function(i){e.togglePoint(t)}}},[i("i",{staticClass:"icon-point",attrs:{slot:"icon-left"},slot:"icon-left"})]),e.checkPointOpenStatus[t.id]?i("div",{key:"img"+a,staticClass:"p15 bg-white"},[i("item-img-list",{attrs:{"prepare-callback":function(){return e.prepareTakePicture(t)},maxlength:50,group:"check-point-edit","track-text":"工序移交报验"},on:{callback:e.saveProblem},model:{value:t.image_file,callback:function(i){e.$set(t,"image_file",i)},expression:"point.image_file"}})],1):e._e(),t.content?i("div",{key:"con"+a,staticClass:"pl15 pr15 pb10 bg-white"},[i("div",{staticClass:"point-content"},[e._v(e._s(t.content))])]):e._e()]}))]:e._e(),i("item-textarea",{staticClass:"mt10 border-none",attrs:{placeholder:"补充说明"},on:{blur:e.saveProblem},model:{value:e.processData.remark,callback:function(t){e.$set(e.processData,"remark",t)},expression:"processData.remark"}})],2):e._e(),"已退回"===e.processData.status?i("div",{staticClass:"mt10"},[[e._l(e.showBackLogList,(function(t,a){return[t.contractor?i("item",{key:"con"+a,staticClass:"mt10",attrs:{label:"后续接收单位",mode:"view",text:t.contractor}}):e._e(),t.type?i("user-select",{key:"user"+a,attrs:{title:t.type,mode:"view",date:e._f("formatDate")(t.complete_date),status:"已通过"===t.status?"验收通过":t.status,"status-class":{"已通过":"color-green","已退回":"color-red"}[t.status],editabled:!1},model:{value:t.checker,callback:function(i){e.$set(t,"checker",i)},expression:"log.checker"}}):e._e(),i("item",{key:"info"+a,attrs:{label:"已退回"===t.status?"退回原因":"移交记录"}},[i("template",{slot:"right"},[t.remark||t.image_file.length?i("div",{staticClass:"item-con"},[t.remark?i("div",{staticClass:"item-font"},[e._v(e._s(t.remark))]):e._e(),i("item-img-list",{attrs:{editabled:!1},model:{value:t.image_file,callback:function(i){e.$set(t,"image_file",i)},expression:"log.image_file"}})],1):i("div",{staticClass:"item-text"},[e._v("无")])])],2)]})),e.backLogList.length>1?i("item",{staticClass:"mt10",attrs:{label:"退回记录",text:e.backLogList.length+"次",mode:"edit",editabled:!0},on:{click:e.openBackHistory}}):e._e()]],2):e._e(),"已退回"===e.processData.status?i("div",{staticClass:"bottom-tips"},[e._v("\n          需要原施工负责人"+e._s(e.processData.repair.name)+"重新申请验收\n        ")]):e._e(),e.allowDeleteProblem||e.processCheckId&&"待移交"===e.processData.status&&!e.reDoing?i("app-button-group",[e.allowDeleteProblem?i("app-button",{attrs:{type:"text",name:"删除"},on:{click:e.deleteProblem}}):e._e(),e.processCheckId&&"待移交"===e.processData.status&&!e.reDoing?i("app-button",{attrs:{type:"text",name:"删除此草稿"},on:{click:e.deleteDraft}}):e._e()],1):e._e()],1),!e.isLoading&&e.showReDoBtn?i("app-button-group",{attrs:{"fixed-bottom":""}},[i("app-button",{attrs:{name:"重新申请验收"},on:{click:e.reDo}})],1):e._e(),!e.isLoading&&e.showBtnPass?i("app-button-group",{attrs:{"fixed-bottom":"",seamless:""}},[i("app-button",{staticStyle:{width:"50%"},attrs:{plain:"",type:"warning",name:"退回"},on:{click:e.back}}),i("app-button",{attrs:{name:"验收通过"},on:{click:e.submitCheck}})],1):e._e(),!e.isLoading&&e.showBtnProcess?i("app-button-group",{attrs:{"fixed-bottom":"",seamless:""}},[i("app-button",{staticStyle:{width:"50%"},attrs:{plain:"",name:"暂存"},on:{click:e.saveProblemAndTip}}),i("app-button",{attrs:{name:"申请验收"},on:{click:e.submitCheck}})],1):e._e(),i("loading-status",{attrs:{"is-loading":e.isLoading}})],1),i("swipe-tab",{attrs:{title:"整改问题("+e.problemList.length+")"}},[i("scroller",{attrs:{"has-next":e.listPage*e.listPagesize<e.problemList.length,"is-empty":!e.problemList.length},on:{loadNext:e.pageProblemList}},[e._l(e.problemListShow,(function(t,a){return i("item-list",{key:a,attrs:{"is-unread":t.unread,"is-timeout":t.is_timeout,"is-urgent":"紧急"==t.emergency_degree||"特急"==t.emergency_degree,"is-return":t.sent_back_times>0,img:t.thumbnail,title:t.item_full_name||"未选检查项",detail:(t.desc_name?t.desc_name+" ":"")+(t.remark||""),footer:t.regist_date+" "+(t.place||""),status:"待提交"===t.status?"草稿":t.status,"status-text":"待提交"===t.status_text?"草稿":t.status_text},on:{click:function(i){e.problemDetail(t)}}})})),i("loading-status",{attrs:{"is-loading":e.isProblemListLoading,"is-empty":!e.problemList||!e.problemList.length,"empty-text":"这里暂无数据"}})],2),i("app-button-group",{attrs:{"fixed-bottom":""}},[i("app-button",{attrs:{name:"新增问题",disabled:!e.processData.id||"待移交"===e.processData.status},on:{click:function(t){e.problemAdd()}}})],1)],1)],1)],2)}),[],!1,null,"040518bd",null);t.default=o.exports},"967a":function(e,t,i){"use strict";var a=i("8d95");t.a={REPAIR_DEADLINE_STATUS:{name:"repair_deadline_status",status:["待整改"],module:[a.a.CHECK]}}},9788:function(e,t,i){"use strict";i("9446")},"9ab7":function(e,t,i){var a=i("542f");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("8c69df94",a,!0,{sourceMap:!1,shadowMode:!1})},"9b25":function(e,t,i){"use strict";i("b09a")},"9e8c":function(e,t,i){"use strict";i("3f00")},a093:function(e,t,i){"use strict";(function(e){i("5ab2"),i("6d57"),i("e10e"),i("f548");var a=i("28f8"),s=(i("9dd9"),i("cc57"),i("e204"),i("9eea")),o=i("3156b"),n=i("774b"),r=i("e89f"),c=i("6f9e");function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}t.a={name:"AppSingleSelect",components:{appSearchBar:s.a,item:o.a,Scroller:n.a},mixins:[r.a],props:{},data:function(){return{activeTab:[],storageKey:encodeURI(this.title||"singleSelectMark"),storageVal:[],keyword:"",searchStatus:!1,checkedItem:{},show:!1,searchData:[],options:[],optionsLimit:20,pagingOptions:!1,searchBar:!0,category:[],ifToggle:!1,editorAddData:!1,lineLimit:1}},computed:{optionsShow:function(){return this.options&&this.options.length?this.grouping?this.getGroupData():this.options.slice(0,this.optionsLimit):[]}},watch:{keyword:function(e){var t=this;this.$nextTick((function(){t.filterList(e)}))}},methods:{openPopup:function(t){if(console.log(t),this.value=!0,this.show=!0,this.category=[],c.a.$on("closeDialog",this.closePopup),this.title=t.title,this.selected=t.selected,this.checkedItem=t.selected,this.options=t.options,this.onSelect=t.onSelect,this.searchBar=t.searchBar,this.grouping=t.grouping,this.rightBtn=t.rightBtn,this.rightBtnEvent=t.rightBtnEvent,this.ifToggle=t.ifToggle,this.lineLimit=t.lineLimit,this.editorAddData=t.editorAddData,t.grouping&&t.autoOpen){var i=e.uniqBy(e.map(this.options,t.grouping));this.activeTab=e.map(i,(function(e,t){return t}))}this.storageKey=encodeURI(this.title||"singleSelectMark"),this.$emit("open")},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeEvent:function(){c.a.$off("closeDialog",this.closePopup),this.value=!1,this.show=!1,this.keyword="",this.searchStatus=!1,this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch()},customAddSupplier:function(e){return this.options.findIndex((function(t){return t.name===e}))},selectItem:function(e){var t=this;this.ifToggle&&this.checkedItem.id===e.id?this.checkedItem={}:this.checkedItem=e,this.onSelect(this.checkedItem),this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].saveHistory(),window.setTimeout((function(){t.closeEvent()}),300)},onSearchTypeChange:function(e){this.searchStatus=e},filterList:function(e){var t,i,a=this,s=new RegExp("("+e+")","gmi");if(this.category=[],this.keyword=e,this.searchData=[],!e)return!1;this.options.map((function(e){return s.test(e.name)&&(i=p(p({},e),{},{rename:e.name.replace(s,"<label>$1</label>")}),a.grouping?-1===(t=a.category.indexOf(i[a.grouping]))?(a.category.push(i[a.grouping]),a.searchData.push({name:i[a.grouping],children:[i]})):a.searchData[t].children.push(i):a.searchData.push(i)),e}))},pageOptions:function(){this.optionsLimit=this.optionsLimit+20,this.pagingOptions=!1},getGroupData:function(){var e,t=this,i=[];return this.category=[],this.options.map((function(a){return-1===(e=t.category.indexOf(a[t.grouping]))?(t.category.push(a[t.grouping]),i.push({name:a[t.grouping],children:[a]})):i[e].children.push(a),a})),i}}}}).call(this,i("391c"))},a14f:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .convert[data-v-13aac6b6]{-webkit-animation:rotate-data-v-13aac6b6 2s linear infinite;animation:rotate-data-v-13aac6b6 2s linear infinite}.zjapp .icon[data-v-13aac6b6]{fill:#4275e8}@-webkit-keyframes rotate-data-v-13aac6b6{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes rotate-data-v-13aac6b6{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}",""])},a1aa:function(e,t,i){"use strict";t.__esModule=!0,t.camelize=function(e){return e.replace(a,(function(e,t){return t.toUpperCase()}))},t.padZero=function(e,t){void 0===t&&(t=2);var i=e+"";for(;i.length<t;)i="0"+i;return i};var a=/-(\w)/g},a5c6:function(e,t,i){"use strict";var a=i("329b"),s=i("a093").a,o=(i("f3d7"),i("17cc")),n=Object(o.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-right"}},[e.show?i("page-content",{attrs:{title:e.title,mode:"dialog","on-close":e.closeEvent}},[e.rightBtn&&!e.editorAddData||e.rightBtn&&e.editorAddData&&(!e.selected.name||e.customAddSupplier(e.selected.name)>-1)?i("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:function(t){e.rightBtnEvent(e.category)}},slot:"header-bar-right"},[e._v("\n      "+e._s(e.rightBtn)+"\n    ")]):e._e(),i("scroller",{attrs:{"has-next":!e.searchStatus&&!e.grouping&&e.optionsLimit<e.options.length,"end-text":"","is-empty":0===e.optionsShow.length},on:{loadNext:e.pageOptions}},[e.searchBar?i("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":e.storageKey},on:{changeSearchStatus:e.onSearchTypeChange},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}):e._e(),e.searchStatus?[e.keyword?[e.grouping?i("van-collapse",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.searchData,(function(t,a){return i("van-collapse-item",{key:a,attrs:{title:t.name,name:a}},e._l(t.children,(function(t,a){return i("item",{key:a,attrs:{checked:e.checkedItem.id===t.id,item:t,"line-limit":e.lineLimit,"render-field":"rename"},on:{click:e.selectItem}})})))}))):e._e(),e.grouping&&!e.searchData.length?i("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容","show-style":"search"}}):e._e(),e.grouping?e._e():[e._l(e.searchData,(function(t,a){return i("item",{key:a,attrs:{checked:e.checkedItem.id===t.id,item:t,"line-limit":e.lineLimit,"render-field":"rename"},on:{click:e.selectItem}})})),e.searchData.length?e._e():i("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容","show-style":"search"}})]]:e._e()]:["-1"===e.selected.id&&e.customAddSupplier(e.selected.name)<0&&e.editorAddData?i("div",{staticClass:"supplier-editor",on:{click:e.closePopup}},[i("span",{staticClass:"title"},[e._v(e._s(e.selected.name))]),i("span",{staticClass:"icon"},[i("i",{staticClass:"iconfont icon-edit margin-r",on:{click:e.rightBtnEvent}}),i("i",{staticClass:"iconfont icon-qualified"})])]):e._e(),e.grouping?i("van-collapse",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.optionsShow,(function(t,a){return i("van-collapse-item",{key:a,attrs:{title:t.name,name:a}},e._l(t.children,(function(t,a){return i("item",{key:a,attrs:{checked:e.checkedItem.id===t.id,item:t,"line-limit":e.lineLimit},on:{click:e.selectItem}})})))}))):e._l(e.optionsShow,(function(t,a){return i("item",{key:a,attrs:{checked:e.checkedItem.id===t.id,item:t,"line-limit":e.lineLimit},on:{click:e.selectItem}})})),e.optionsShow.length?e._e():i("loading-status",{attrs:{"is-empty":!0,"empty-text":"暂无数据","show-style":"search"}})]],2)],1):e._e()],1)}),[],!1,null,"e465319c",null).exports,r=!1;r||(r=new(a.default.extend(n))({el:document.createElement("div")}),document.body.appendChild(r.$el));t.a=r},b09a:function(e,t,i){var a=i("2939");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("65170d73",a,!0,{sourceMap:!1,shadowMode:!1})},b2a0:function(e,t,i){"use strict";(function(e){i("5ab2"),i("e10e"),i("c904");var a=i("28f8"),s=(i("e697"),i("6d57"),i("06a2"),i("cc57"),i("391c"),i("f369")),o=i("7460"),n=i("6718"),r=i("da1c"),c=i("07d2"),l=i("5a71"),p=i("cd05"),d=i("6948"),u=i("774b"),h=i("3c64"),m=i("e68e"),f=i("b61f"),g=i("fa4f"),b=i("3bd5"),v=i("5028"),_=i("5ff0"),y=i("37d5"),k=i("bcc7"),x=i("0136"),C=i("e2a7"),D=i("7cb8"),w=i("3122"),I=i("48f4"),j=i("75ca"),P=i("1b7e"),S=i("112f"),O=i("14c3"),z=i("162a"),$=i("ed08"),T=i("d767"),L=i("6bf2"),B=i.n(L);function E(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}var R=b.a.getUser(),A=v.a.processNewDraft,M=null;t.a={name:"ProcessNewDetail",components:{CheckGuide:s.a,TemplateGuide:o.a,SwipeTabs:n.b,SwipeTab:n.a,ProblemDetailHeader:r.a,Item:c.a,SingleSelect:l.a,UserSelect:p.a,NumberInput:d.a,Scroller:u.a,ItemTextarea:h.a,ItemImgList:m.a,ItemList:g.a},data:function(){return{isLoading:!0,hasTemplate:null,tabIndex:0,processData:{},place:[],buildingId:"",unit:"",checkItemId:"",processCheckId:"",deliverType:"",mode:"",backLogList:[],repairLog:{},isRepair:!1,isReceiver:!1,isReinspect:!1,isConstructer:!1,hasRepairConfirm:!1,hasReceiverConfirm:!1,hasReinspectConfirm:!1,hasConstructerConfirm:!1,showBtnProcess:!1,showReDoBtn:!1,showBtnPass:!1,allowDeleteProblem:!1,isAreaAcceptor:!1,hasAreaAcceptor:!1,areaAcceptorCheckedList:[],needReceiver:!1,receiverContractors:[],needConstructer:!1,repairs:[],contractors:[],checkers:[],constructers:[],ccList:[],placeOptions:[],reDoing:!1,photoRequired:!1,checkPointOpenStatus:{},isProblemListLoading:!1,problemList:[],listPage:1,listPagesize:10,projId:"",statusClassSet:{"验收通过":"color-green","退回":"color-red"},primaryKeys:{},recoverResult:null}},computed:{tabsWidth:function(){return window.innerWidth/2},placeName:function(){var t=this,i=[];if(1===this.processMode){if(e.isEmpty(this.processData.selected_rooms))return"";i=e.map(this.processData.selected_rooms,(function(e){return Object(D.a)(e.unit,"单元")+e.name}))}else{if(2!==this.processMode&&5!==this.processMode)return"";if(e.isEmpty(this.processData.selected_floors))return"";i=e.map(this.processData.selected_floors,(function(e){return(5===t.processMode?Object(D.a)(e.unit,"单元"):"")+Object(D.a)(e.name,"层")}))}return i.join("、")},processMode:function(){return this.processData.processMode},showBackLogList:function(){if(e.isEmpty(this.backLogList))return[];var t=e.clone(this.backLogList[this.backLogList.length-1]);return t=t.splice(1)},problemListShow:function(){return this.problemList&&this.problemList.length?this.problemList.slice(0,this.listPage*this.listPagesize):[]}},mounted:function(){window.processNewDetailTest=this},activated:function(){R=b.a.getUser(),this.$router.isBack||(this.projId=this.$store.state.global.currentProject.id,this.buildingId=this.$route.query.buildingId,this.unit=this.$route.query.unit,this.checkItemId=this.$route.query.checkitemId,this.deliverType=this.$route.query.deliverType,this.processCheckId=this.$route.query.processCheckId,this.isLoading=!0,this.isLoading=!0,this.tabIndex=0,this.processData={},this.place=[],this.mode="",this.backLogList=[],this.repairLog={},this.isRepair=!1,this.isReceiver=!1,this.isReinspect=!1,this.isConstructer=!1,this.hasRepairConfirm=!1,this.hasReceiverConfirm=!1,this.hasReinspectConfirm=!1,this.hasConstructerConfirm=!1,this.showBtnProcess=!1,this.showReDoBtn=!1,this.showBtnPass=!1,this.allowDeleteProblem=!1,this.isAreaAcceptor=!1,this.hasAreaAcceptor=!1,this.areaAcceptorCheckedList=[],this.needReceiver=!1,this.receiverContractors=[],this.needConstructer=!1,this.repairs=[],this.contractors=[],this.checkers=[],this.constructers=[],this.ccList=[],this.placeOptions=[],this.reDoing=!1,this.photoRequired=!1,this.checkPointOpenStatus={},this.isProblemListLoading=!1,this.problemList=[],this.listPage=1,this.listPagesize=10,A=v.a.processNewDraft,M=null,this.recoverResult=null),this.init()},methods:{init:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Promise.resolve().then((function(){console.log(t.$route)})).then((function(){var e=t.$route.query.getProcessCheckIdFromPrimaryKeys,a=!0;return!i&&e&&(a=!1),a&&t.processCheckId?t.loadDetail(t.processCheckId):t.createNewDetail()})).then((function(){return t.recoverProcessDatas()})).then((function(){return t.createMMKVSaver()})).then((function(e){if(console.log("mmkvDraft...",t.processData,e,t.recoverResult),e&&"process-new"===e.module&&(t.processCheckId=e.processCheckId,t.$set(t.processData,"remark",e.remark),t.$set(t.processData,"complete_progress",e.complete_progress),t.$set(t.processData,"custom_location",e.custom_location),t.$set(t.processData,"checkPointDetail",e.checkPointDetail),t.$set(t.processData,"cc",e.cc),t.$set(t.processData,"constructer",e.constructer),t.$set(t.processData,"img",e.img),t.$set(t.processData,"checker",e.checker),t.$set(t.processData,"selected_rooms",e.selected_rooms),t.$set(t.processData,"selected_floors",e.selected_floors),t.$set(t.processData,"receive_contractor",e.receive_contractor),t.$set(t.processData,"receiver",e.receiver),t.$set(t.processData,"area_acceptor",e.area_acceptor),t.$set(t.processData,"contractor",e.contractor),t.recoverResult)){console.log("-----recoverResult-----",t.recoverResult);var i=t.recoverResult,a=i.recoverData,s=i.recoverMedia;t.recoverData(a,s),t.saveProblem()}})).then((function(){if("待移交"===t.processData.status)return v.a.getPlaceOptions(t.buildingId,t.unit,t.checkItemId,t.processMode).then((function(e){t.placeOptions=e}))})).then((function(){return Promise.all([t.loadContractor(),t.loadReceiverContractor(),t.getUserOptions()])})).then((function(){return t.getSectionSetting()})).then((function(){return v.a.isPhotoRequired().then((function(e){t.photoRequired=e}))})).then((function(){if(t.processCheckId)return v.a.getSentBackList(t.processCheckId).then((function(e){t.backLogList=e,e&&e.length&&(t.repairLog=e[e.length-1][0])}))})).then((function(){t.areaAcceptorCheckedList=t.processData.areaAcceptorCheckedList,t.getUserAuthority(),t.processData.isRepair&&!t.processData.hasRepairConfirm||t.processData.isReceiver&&!t.processData.hasReceiverConfirm||t.processData.isReinspect&&!t.processData.hasReinspectConfirm||t.processData.hasConstructerConfirm&&!t.processData.hasConstructerConfirm||t.processData.isAreaAcceptor&&t.processData.hasAreaAcceptor?t.mode="edit":t.mode="view"})).then((function(){e.each(t.processData.checkPointDetail,(function(e){t.$set(t.checkPointOpenStatus,e.id,e.isOpen)}))})).then((function(){return t.getProblemList()})).then((function(){t.isLoading=!1}))},createMMKVSaver:function(e){var t=this;return e=e||{},Promise.resolve().then((function(){return A.config({deliverType:t.deliverType,buildingId:t.buildingId,checkpointId:t.checkItemId,locationId:t.unit||t.buildingId}),t.primaryKeys={deliverType:t.deliverType,buildingId:t.buildingId,checkpointId:t.checkItemId,selectedRoomsOrFloors:t.processData.selected_rooms||t.processData.selected_floors,unit:t.unit,processCheckId:t.processCheckId},console.log("createMMKVSaver this.primaryKeys",t.primaryKeys),M=v.a.createPrimaryKeys(t.primaryKeys),A.get(M)}))},recoverProcessDatas:function(){var e=this;return Promise.resolve().then((function(){return O.a.getRecoverData().then((function(t){if(t&&"process-new"===t.module){var i=t.processData.processMode;return 1===i?e.$store.commit("process/SET_DETAIL_FLOOR_AND_ROOM",t.processData.selected_rooms):2!==i&&5!==i||e.$store.commit("process/SET_DETAIL_FLOOR_AND_ROOM",t.processData.selected_floors),e.processData.selected_rooms=t.processData.selected_rooms,e.processData.selected_floors=t.processData.selected_floors,e.processCheckId=t.processCheckId,O.a.getRecoverMedia().then((function(e){return $log.log("恢复工序移交数据",t,e),e})).then((function(i){O.a.clear(),e.recoverResult={recoverData:t,recoverMedia:i}}))}e.recoverResult=null}))}))},prepareTakePicture:function(e){$log.log("当前验收点",e),this.saveProblem(),O.a.save({module:"process-new",point:e,processData:this.processData,processCheckId:this.processCheckId})},recoverData:function(e,t){if(console.log("recoverData, recoverMedia....",e,t),t)if(e.point){var i=this.processData.checkPointDetail.find((function(t){return t.checkpoint_id===e.point.checkpoint_id}));i&&i.image_file.push(t)}else console.log("no point recoverData...",e),this.processData.img.push(t)},loadDetail:function(e){var t=this;return v.a.getProcessDetail(e).then((function(e){var i=e.processMode;t.processData=e,1===i?t.$store.commit("process/SET_DETAIL_FLOOR_AND_ROOM",e.selected_rooms):2!==i&&5!==i||t.$store.commit("process/SET_DETAIL_FLOOR_AND_ROOM",e.selected_floors)}))},createNewDetail:function(){var e=this;return v.a.createProcessDetail(this.buildingId,this.unit,this.checkItemId).then((function(t){e.processData=t}))},getProblemList:function(){var t=this;return v.a.getProcessProblemList(this.processCheckId).then((function(i){var a=e.filter(i.data,(function(e){var t=JSON.parse(e.image_file||"[]");return e.thumbnail=w.a.getDefaultThumbnailFromList(t,"工序移交(新)"),e.regist_date=B()(e.regist_date||e.created_on).format("MM-DD HH:mm"),w.a.isNeedThumbnail(t)}));I.default.autoLoadThumbnail(a,"工序移交(新)","image_file","thumbnail","checkquality_problem"),t.problemList=i.data}))},pageProblemList:function(){this.listPage=this.listPage+1},setHasTemplate:function(e){this.hasTemplate=e},loadContractor:function(){var t=this,i=this.processData.repair&&this.processData.repair.id||"";return _.a.getContractorListByUser(i,this.processData.section_id).then((function(i){t.contractors=i.list,e.isEmpty(i.list)||!i.isGroupList||t.processCheckId||(t.processData.contractor=i.list[0])}))},loadReceiverContractor:function(){var t=this,i=this.processData.receiver&&this.processData.receiver.id||"";return _.a.getContractorListByUser(i,this.processData.section_id).then((function(i){t.receiverContractors=i.list,e.isEmpty(i.list)||!i.isGroupList||t.processCheckId||(t.processData.receive_contractor=i.list[0])}))},getUserOptions:function(){var e=this,t=this.processData.proj_id;return Promise.all([y.default.getProjectUsers(t,[31]),y.default.getProjectUsers(t,[32,33]),y.default.getProjectUsers(t,[33]),y.default.getProjectUsers(t,[31,32,33])]).then((function(t){e.repairs=t[0],e.checkers=t[1],e.constructers=t[2],e.ccList=t[3]}))},getSectionSetting:function(){var t=this;return k.a.getBidSectionCheckItemInfo(this.processData.proj_id,this.processData.section_id,this.processData.item_id,"工序移交").then((function(i){if(console.log("标段默认设置 ======",t.processData.proj_id,t.processData.section_id,t.processData.item_id,i),i.contractor_id&&e.isEmpty(t.processData.contractor)){var a=e.find(t.contractors,(function(e){return e.id===i.contractor_id}));a&&(t.processData.contractor=a)}if(!e.isEmpty(i.repair)&&e.isEmpty(t.processData.repair)){var s=e.find(t.repairs,(function(e){return e.id===i.repair[0].id}));s&&(t.processData.repair=s)}if(!e.isEmpty(i.reinspect)&&e.isEmpty(t.processData.checker)){var o=e.find(t.checkers,(function(e){return e.id===i.reinspect[0].id}));o&&(t.processData.checker=o)}if(!t.processCheckId&&!e.isEmpty(i.constructer)){var n=e.find(t.constructers,(function(e){return e.id===i.constructer[0].id}));n&&(t.processData.constructer=n)}t.processCheckId||e.isEmpty(i.cc)||(t.processData.cc=i.cc),t.processCheckId||e.isEmpty(i.area_acceptor)||(t.processData.area_acceptor=i.area_acceptor),t.processCheckId&&"待移交"!==t.processData.status?(t.needReceiver=t.processData.receiver&&t.processData.receiver.id,t.needConstructer=t.processData.constructer&&t.processData.constructer.id):(t.needReceiver=i.need_receiver,t.needConstructer=i.need_constructer)})).then((function(){var i=t.processData.section_id,a=t.processData.proj_id,s=t.processData.item_id;if(t.needReceiver&&(e.isEmpty(t.processData.receive_contractor)||e.isEmpty(t.processData.receiver)))return k.a.getNextCheckItem(i,"工序移交",s).then((function(s){if(!e.isEmpty(s))return k.a.getBidSectionCheckItemInfo(a,i,s.id,"工序移交").then((function(i){if(i.contractor_id&&e.isEmpty(t.processData.receive_contractor)&&(t.processData.receive_contractor={id:i.contractor_id,name:i.contractor_name}),!e.isEmpty(i.repair)&&e.isEmpty(t.processData.receiver)){var a=e.find(t.repairs,(function(e){return e.id===i.repair[0].id}));a&&(t.processData.receiver=a)}}))}))}))},getUserAuthority:function(){var e=R.user_id;this.isRepair=this.processData.repair&&this.processData.repair.id===e,this.isReceiver=this.processData.receiver&&(this.processData.receiver.id?this.processData.receiver.id===e:this.processData.repair.id===e),this.isReinspect=this.processData.checker&&this.processData.checker.id===e,this.isConstructer=this.processData.constructer&&this.processData.constructer.id===e,this.isAreaAcceptor=this.processData.isAreaAcceptor,this.hasRepairConfirm=this.processData.hasRepairConfirm,this.hasReceiverConfirm=this.processData.hasReceiverConfirm,this.hasReinspectConfirm=this.processData.hasReinspectConfirm,this.hasConstructerConfirm=this.processData.hasConstructerConfirm,this.hasAreaAcceptor=this.processData.hasAreaAcceptor,this.allowDeleteProblem=!("待移交"===this.processData.status||"已退回"===this.processData.status||!this.isRepair||"验收通过"===this.processData.check_status||"验收通过"===this.processData.construct_status||"验收通过"===this.processData.receive_status&&!this.isReceiver),this.showBtnProcess="已退回"!==this.processData.status&&this.isRepair&&!this.hasRepairConfirm,this.showReDoBtn="已退回"===this.processData.status&&this.isRepair,this.showBtnPass="待验收"===this.processData.status&&this.hasRepairConfirm&&(this.isReceiver&&!this.hasReceiverConfirm||this.isReinspect&&!this.hasReinspectConfirm||this.isConstructer&&!this.hasConstructerConfirm||this.isAreaAcceptor&&this.hasAreaAcceptor)},setUnitFloor:function(){var e,t,i,a=this;this.unit?1===this.processMode?(e="unit-floor-room",t="选择移交房间"):2===this.processMode?(e="floor",t="移交楼层"):5===this.processMode&&(e="unit-floor",t="移交楼层"):1===this.processMode?(e="floor-room",t="选择移交房间"):(2===this.processMode||5===this.processMode)&&(e="floor",t="移交楼层"),i=1===this.processMode?this.processData.selected_rooms:this.processData.selected_floors,f.a.openPopup({title:t,type:e,selected:i,options:this.placeOptions,rightBtn:"确定",rightBtnEvent:function(e){1===a.processMode?a.processData.selected_rooms=e:a.processData.selected_floors=e,a.saveProblem()}})},saveCustomLocation:function(){return this.processData.id?v.a.updateProcessCheckData({id:this.processData.id,custom_location:this.processData.custom_location}):this.saveProblem()},setValChange:function(){var e=this;return v.a.complateRate(this.processData).then((function(){if("待移交"!==e.processData.status)return v.a.uploadCompleteRate(e.processData.location_id,e.processData.item_id)}))},changePerson:function(t){var i=this,a=this.processData,s=!a.id;if(!(1===this.processMode&&e.isEmpty(this.processData.selected_rooms)||(2===this.processMode||5===this.processMode)&&e.isEmpty(this.processData.selected_floors))){var o=a.contractor.id,n=this.needReceiver?a.receiver.id:"",r=a.checker.id,c=this.needReceiver?a.receive_contractor.id:"",l=this.needConstructer?a.constructer.id:"";this.saveProblem().then((function(){if(s)return v.a.changeCC(a.id,a.cc,!1)})).then((function(){return v.a.changePerson(a.id,o,n,r,c,l,"待移交"!==a.status)})).then((function(){if("待移交"!==a.status){var e=x.a.getProcessTodoSort(a.status,a.building_name,a.unit,a.name,a.update_timestamp),i=2;return("receiver"===t&&n===R.user_id||"checker"===t&&r===R.user_id||"constructer"===t&&l===R.user_id)&&(i=1),x.a.insertTodoData(R.user_id,a.id,"process",i,e)}})).then((function(){if("待移交"!==a.status)return i.init()}))}},changeReceiver:function(){var e=this;return this.loadReceiverContractor().then((function(){e.changePerson("receiver")}))},changeCC:function(){this.saveProblem()},togglePoint:function(e){if(e.isOpen=!e.isOpen,this.$set(this.checkPointOpenStatus,e.id,e.isOpen),e.id&&e.process_check_id)return v.a.uploadCheckpointDetail(e.id,e.isOpen)},openBackHistory:function(){T.a.openDialog({processId:this.processData.id})},saveProblem:function(){var e=this.processCheckId||$.a.uuid();this.processCheckId=e,this.primaryKeys={deliverType:this.deliverType,buildingId:this.buildingId,checkpointId:this.checkItemId,selectedRoomsOrFloors:this.processData.selected_rooms||this.processData.selected_floors,unit:this.unit,processCheckId:e},M=v.a.createPrimaryKeys(this.primaryKeys);var t=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({processCheckId:e,primaryKeys:this.primaryKeys,module:"process-new"},this.processData);return console.log("saveProblem mmkvModel",t),A.config({deliverType:this.deliverType,buildingId:this.buildingId,checkpointId:this.checkItemId,locationId:this.unit||this.buildingId,model:t,modelKeys:["processCheckId","primaryKeys","module","processMode","checkPointDetail","remark","cc","constructer","checker","selected_rooms","selected_floors","complete_progress","custom_location","receive_contractor","receiver","area_acceptor","img","status","contractor"]}),A.save(M)},saveProblemToLocalDB:function(){var t=this;if(!(1===this.processMode&&e.isEmpty(this.processData.selected_rooms)||(2===this.processMode||5===this.processMode)&&e.isEmpty(this.processData.selected_floors)))return Promise.resolve().then((function(){var e;if(t.isRepair&&!t.hasRepairConfirm?e="施工负责人":t.processData.receive_contractor.id&&t.isReceiver&&!t.hasReceiverConfirm?e="后续接收人":t.isReinspect&&!t.hasReinspectConfirm?e="监理":t.processData.constructer.id&&t.isConstructer&&!t.hasConstructerConfirm?e="建设单位负责人":t.isAreaAcceptor&&t.hasAreaAcceptor&&(e="区域验收人"),e)return v.a.saveProcessStatus(t.processData,e,!0)})).then((function(){if(t.processCheckId){if("待移交"===t.processData.status){var i=Promise.resolve();return e.each(t.processData.checkPointDetail,(function(e){console.log("each point...",e);var a={id:e.id||$.a.uuid(),process_check_id:t.processCheckId,status_id:e.status_id,title:e.title,checkpoint_id:e.checkpoint_id,content:e.content,image_file:JSON.stringify(e.image_file),sort:e.sort,is_open:e.isOpen};i=i.then((function(){return v.a.saveAcceptDetail(a)}))})),i}}else t.processCheckId=t.processData.id,t.init()})).finally((function(){}))},saveProblemAndTip:function(){var e=this;this.saveProblem().then((function(){C.a.alert("保存成功"),setTimeout((function(){e.$router.go(-1)}),500)}))},submitCheck:function(){var t,i,a=this,s=this.processData;if(1!==this.processMode||s.selected_rooms&&s.selected_rooms.length)if(2!==this.processMode&&5!==this.processMode||s.selected_floors&&s.selected_floors.length){if(90!==this.processMode||s.custom_location){var o=this.needConstructer&&this.isConstructer&&!this.hasConstructerConfirm||this.isAreaAcceptor&&this.hasAreaAcceptor;if(this.photoRequired&&!o)if(this.isRepair&&!this.hasRepairConfirm){if(s.checkPointDetail&&s.checkPointDetail.length){var n=e.filter(s.checkPointDetail,(function(e){return!e.image_file.length}));if(n&&n.length)return void C.a.alert("请拍摄照片")}}else if(!s.img||!s.img.length)return void C.a.alert("请拍摄照片");return i=s.id?v.a.getProcessInfo(s.id).then((function(e){if(!e)return Promise.reject({code:1001})})):Promise.resolve(),s.needReceiver=this.needReceiver,s.needConstructer=this.needConstructer,this.isRepair&&!this.hasRepairConfirm?i=i.then((function(){return s.contractor.id?a.needReceiver&&!s.receive_contractor.id?Promise.reject({msg:"请选择后续接收单位"}):a.needReceiver&&!s.receiver.id?Promise.reject({msg:"请选择后续接收人"}):s.checker.id?a.needConstructer&&!s.constructer.id?Promise.reject({msg:"请选择建设单位负责人"}):Promise.resolve().then((function(){if(90===a.processMode)return v.a.isCustomLocationDuplicate(s.item_id,s.location_id,s.custom_location,a.processData.id)})).then((function(e){return e?Promise.reject("此部位已存在，不可重复"):v.a.repair(s)})):Promise.reject({msg:"请选择监理"}):Promise.reject({msg:"请选择施工单位"})})):this.isReceiver&&!this.hasReceiverConfirm?i=i.then((function(){return C.a.confirm("确定验收通过？").then((function(e){if(!e)return Promise.reject({cancel:!0})}))})).then((function(){return v.a.receive(a.processData)})):this.isReinspect&&!this.hasReinspectConfirm?i=i.then((function(){return C.a.confirm("确定验收通过？").then((function(e){if(!e)return Promise.reject({cancel:!0})}))})).then((function(){return v.a.reinspect(a.processData)})):this.needConstructer&&this.isConstructer&&!this.hasConstructerConfirm?i=i.then((function(){return C.a.confirm("确定验收通过？").then((function(e){if(!e)return Promise.reject({cancel:!0})}))})).then((function(){return v.a.construct(a.processData)})):this.isAreaAcceptor&&this.hasAreaAcceptor&&(i=i.then((function(){return C.a.confirm("确定验收通过？").then((function(e){if(!e)return Promise.reject({cancel:!0})}))})).then((function(){return v.a.areaAcceptor(a.processData)}))),console.log(8888888),i=i.then((function(){a.showBtnProcess&&(t=1)})).then((function(){a.processCheckId=a.processData.id})).then((function(){1===t&&(C.a.alert("提交成功"),a.reDoing=!1),A.remove(M),a.init(!0)})).catch((function(e){console.error(e),e&&1001===e.code?C.a.alert("数据有更新，请重试").then((function(){a.$router.go(-1)})):C.a.alert(e)}))}C.a.alert("请填写移交部位")}else C.a.alert("请选择移交楼层");else C.a.alert("请选择移交房间")},back:function(){var t=this;return this.checkItemId?P.a.getHasNetwork().then((function(e){if(!e)return Promise.reject("当前无网络")})).then((function(){return S.a.getCheckItemDescList(t.checkItemId)})).then((function(i){j.a.openPopup({multiple:!0,reasonList:i,placeholder:"补充说明(必填)",isBack:!0,beforeCallback:function(e){return t.photoRequired&&0===e.images.length?(C.a.alert("请拍摄照片"),!1):e.remark?void 0:(C.a.alert("补充说明必填"),!1)},callback:function(i){var a,s="";t.processData.receive_contractor.id&&t.isReceiver&&!t.hasReceiverConfirm?(a="后续接收人",s=t.processData.receive_contractor.name):t.isReinspect&&!t.hasReinspectConfirm?a="监理":t.isConstructer&&!t.hasConstructerConfirm?a="建设单位负责人":t.hasAreaAcceptor&&t.isAreaAcceptor&&(a="区域验收人");var o=e.map(i.reason,"text");i.remark&&o.push(i.remark);var n=t.processData,r={id:n.id,type:a,status:"已退回",remark:o.join(";"),contractor:s};return z.a.beginManualUpdate(),z.a.canUpdate().then((function(){if(C.a.loading("请等待..."),"dev"!==APP_ENV)return Promise.all(e.map(i.images,(function(e,t){return z.a.uploadFile(e.temp,!0).then((function(t){delete e.temp,e.url=t,e.thumbnailUrl=t})).then((function(){if(e.videoTemp)return z.a.uploadFile(e.videoTemp,!0).then((function(t){delete e.videoTemp,e.videoUrl=t}))}))})))})).then((function(){return r.image_file=JSON.stringify(i.images||[]),v.a.saveSentBackLog(r,n.status)})).then((function(){t.init()})).catch((function(e){if(C.a.hideLoading(),!e||"当前网络无法同步数据"!==e.msg)return C.a.alert(e&&e.errmsg||e||"未知错误").then((function(){e&&"20444"===e.errcode&&t.$router.go(-1)}))})).finally((function(){z.a.endManualUpdate(),C.a.hideLoading()}))}})})).catch((function(e){console.error(e),C.a.alert(e.errmsg||e||"数据有更新")})):C.a.alert("检查项不能为空")},reDo:function(){var t=this;return v.a.getReDoByCheckPoint(this.processCheckId).then((function(i){if(!i.length)return v.a.getCheckPoints(t.checkItemId).then((function(i){if(i&&i.length){var a=Promise.resolve();return e.each(i,(function(e){a=a.then((function(){var i={id:$.a.uuid(),process_check_id:t.processData.id,status_id:t.processData.repair_status_id,title:e.title,checkpoint_id:e.checkpoint_id,content:e.content,image_file:"[]",sort:e.sort,is_open:"true"};return v.a.saveAcceptDetail(i)}))})),a}}))})).then((function(){return t.init()})).then((function(){t.reDoing=!0,t.showReDoBtn=!1,t.showBtnProcess=!0,t.processData.status="待移交"})).catch((function(e){console.error(e)}))},deleteProblem:function(){var e=this;return this.problemData&&this.problemData.total>0?C.a.alert("已有整改问题，不可删除"):this.backLogList&&this.backLogList.length?C.a.alert("被退回的任务不可删除"):C.a.confirm("确定删除本次发起的移交？",{okText:"删除"}).then((function(t){return t?v.a.dropProcess(e.processData.id):Promise.reject()}))},deleteDraft:function(){var e=this;return C.a.confirm("确定删除吗？",{okText:"删除",cancelText:"取消"}).then((function(t){if(t)return A.remove(M).then((function(){setTimeout((function(){e.$router.go(-1)}),500)}))}))},problemDetail:function(e){"待提交"===e.status?this.problemAdd(e.id):this.$router.push({name:"ProcessNewProblemDetail",params:{id:e.id}})},problemAdd:function(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";1===this.processMode?t=Object(D.f)(e.map(this.processData.selected_rooms,"id")):2!==this.processMode&&5!==this.processMode||(t=Object(D.f)(e.map(this.processData.selected_floors,"id")));var a={batch_id:this.processData.batch_id,check_item_id:this.checkItemId,building_id:this.buildingId,process_check_id:this.processCheckId};e.isEmpty(this.unit)||(a.unit=this.unit),this.$router.push({name:"ProcessNewProblemEdit",params:a,query:{deliver_type:this.processMode,floorsOrRoomsId:t,location_id:this.processData.location_id,problem_id:i}})}}}}).call(this,i("391c"))},b55a:function(e,t,i){"use strict";i("c001")},b61f:function(e,t,i){"use strict";var a=i("329b"),s=i("7c9b").a,o=(i("0748"),i("17cc")),n=Object(o.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-right"}},[e.show?i("page-content",{attrs:{title:e.title,mode:"dialog","on-close":e.closePopup}},[e.rightBtn?i("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:e.onRightBtnEvent},slot:"header-bar-right"},[e._v("\n      "+e._s(e.rightBtn)+"("+e._s(e.mapSelectedItems.length)+")\n    ")]):e._e(),i("div",{staticClass:"multiple-place-content"},[i("div",{staticClass:"selected"},[i("label",[e._v("已选:")]),i("div",{staticClass:"text"},[e._v("\n          "+e._s(e.selectedResultText)+"\n        ")])])]),i("div",{staticClass:"multiple-place-content -fixed"},[i("div",{staticClass:"selected"},[i("label",[e._v("已选:")]),i("div",{staticClass:"text"},[e._v("\n          "+e._s(e.selectedResultText)+"\n        ")])])]),i("div",{staticClass:"select-wrap"},["unit-floor-room"===e.type?i("van-collapse",{model:{value:e.actionTabs,callback:function(t){e.actionTabs=t},expression:"actionTabs"}},e._l(e.options,(function(t){return i("van-collapse-item",{key:t.id,staticClass:"section",attrs:{name:t.id}},[i("strong",{attrs:{slot:"title"},on:{click:function(i){i.stopPropagation(),e.toggleItem(t.id)}},slot:"title"},[i("icon",{attrs:{slot:"icon",name:"checkbox-square"+e.mapStatusToClass(t.id)},slot:"icon"}),e._v(e._s(t.name))],1),e._l(t[e.nameKeys[e.type][0].children],(function(a){return i("div",{key:a.id,staticClass:"group pl40 pr15  -border-bottom"},[i("div",{staticClass:"group-name"},[e._v(e._s(a.name))]),i("div",{staticClass:"element-list"},[i("div",{staticClass:"element -all",class:e.mapStatusToClass([t.id,a.id].join("-"),a),on:{click:function(i){e.toggleItem([t.id,a.id].join("-"))}}},[e._v("\n                  全选\n                ")]),e._l(a[e.nameKeys[e.type][1].children],(function(s){return i("div",{key:s.name,staticClass:"element",class:e.mapStatusToClass([t.id,a.id,s.id].join("-")),on:{click:function(i){e.toggleItem([t.id,a.id,s.id].join("-"))}}},[e._v("\n                  "+e._s(s.name)+"\n                ")])}))],2)])}))],2)}))):e._e(),"floor-room"===e.type?i("div",{staticClass:"section"},e._l(e.options,(function(t){return i("div",{key:t.id,staticClass:"group pl15 pr15"},[i("div",{staticClass:"group-name"},[e._v(e._s(t.name))]),i("div",{staticClass:"element-list"},[i("div",{staticClass:"element -all",class:e.mapStatusToClass(t.id,t),on:{click:function(i){e.toggleItem(t.id)}}},[e._v("\n              全选\n            ")]),e._l(t[e.nameKeys[e.type][0].children],(function(a){return i("div",{key:a.id,staticClass:"element mr15",class:e.mapStatusToClass([t.id,a.id].join("-")),on:{click:function(i){e.toggleItem([t.id,a.id].join("-"))}}},[e._v("\n              "+e._s(a.name)+"\n            ")])}))],2)])}))):e._e(),"floor"===e.type?i("div",{staticClass:"section"},[i("div",{staticClass:"group pl15 pr15"},[i("div",{staticClass:"group-name"},[e._v("全部")]),i("div",{staticClass:"element-list"},[i("div",{staticClass:"element mr15",class:e.mapStatusToClass("allfloors"),on:{click:function(t){e.toggleItem("allfloors")}}},[e._v("\n              全选\n            ")]),e._l(e.options,(function(t){return i("div",{key:t.name,staticClass:"element mr15",class:e.mapStatusToClass(t.id),on:{click:function(i){e.toggleItem(t.id)}}},[e._v("\n              "+e._s(t.name)+"\n            ")])}))],2)])]):e._e(),"unit-floor"===e.type?i("div",{staticClass:"section"},e._l(e.options,(function(t){return i("div",{key:t.name,staticClass:"group pl15 pr15"},[i("div",{staticClass:"group-name"},[e._v(e._s(t.name))]),i("div",{staticClass:"element-list"},[i("div",{staticClass:"element mr15",class:e.mapStatusToClass(t.id,t),on:{click:function(i){e.toggleItem(t.id)}}},[e._v("\n              全选\n            ")]),e._l(t[e.nameKeys[e.type][0].children],(function(a){return i("div",{key:a.name,staticClass:"element mr15",class:e.mapStatusToClass([t.id,a.id].join("-")),on:{click:function(i){e.toggleItem([t.id,a.id].join("-"))}}},[e._v("\n              "+e._s(a.name)+"\n            ")])}))],2)])}))):e._e(),e.options.length?e._e():i("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容"}})],1)]):e._e()],1)}),[],!1,null,"4b9b8166",null).exports,r=!1;r||(r=new(a.default.extend(n))({el:document.createElement("div")}),document.body.appendChild(r.$el));t.a=r},b7b4:function(e,t,i){"use strict";var a=i("c5a7");t.__esModule=!0,t.noop=function(){},t.isDef=c,t.isObj=function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)},t.get=function(e,t){var i=t.split("."),a=e;return i.forEach((function(e){a=c(a[e])?a[e]:""})),a},t.isServer=t.addUnit=t.createNamespace=void 0;var s=a(i("329b")),o=i("6147");t.createNamespace=o.createNamespace;var n=i("2064");t.addUnit=n.addUnit;var r=s.default.prototype.$isServer;function c(e){return null!=e}t.isServer=r},bcf4:function(e,t,i){"use strict";i("27c4")},bebe:function(e,t,i){var a=i("6272");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("53478790",a,!0,{sourceMap:!1,shadowMode:!1})},c001:function(e,t,i){var a=i("f53a");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("bd5eb062",a,!0,{sourceMap:!1,shadowMode:!1})},c070:function(e,t,i){var a=i("574c");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("35590dcb",a,!0,{sourceMap:!1,shadowMode:!1})},c1f2:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .layout-main[data-v-040518bd] .layout-content{display:flex;flex-direction:column}.zjapp .layout-main[data-v-040518bd] .layout-content .swipe-tabs{flex:1}.zjapp .layout-main[data-v-040518bd] .layout-content .scroll-warp-complete{height:900px}.zjapp .base-detail-header[data-v-040518bd]{background-color:#fff;padding:10px 15px;margin-bottom:10px}.zjapp .base-detail-title[data-v-040518bd]{font-size:18px;color:#111;margin-bottom:10px}.zjapp .base-detail-content[data-v-040518bd]{line-height:18px;font-size:14px;color:#8c8c8c}.zjapp .icon-point[data-v-040518bd]{position:absolute;top:15px;left:0;width:4px;height:16px;background-color:#4275e8}.zjapp .bottom-tips[data-v-040518bd]{padding:5px 15px;color:#999;text-align:center;line-height:20px;font-size:14px}.zjapp .location-place-input[data-v-040518bd]{border:none;width:100%;text-align:right}.zjapp .location-place-detail[data-v-040518bd]{text-align:left}.zjapp .item-location[data-v-040518bd]{flex:none}.zjapp .point-content[data-v-040518bd]{font-size:14px;background-color:#f0f0f0;padding:10px;color:#666;border-radius:3px}",""])},c59b:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .item-list{position:relative;padding:10px;display:flex;align-items:center;background-color:#fff;min-height:100px}.zjapp .item-list .img{display:block;width:80px;height:80px;background:no-repeat 50%;background-size:cover;background-color:#ddd}.zjapp .item-list .item-list-con{flex:1;padding:0 15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.zjapp .item-list .item-list-con .title{height:30px;line-height:24px;color:#111;font-size:16px;padding-top:6px;margin:0;padding-right:10px;margin-right:-10px;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important;font-weight:400}.zjapp .item-list .item-list-con .title .type-tag{display:inline-block;height:16px;line-height:16px;padding:0 4px;border-radius:2px;border:1px solid #4275e8;color:#4275e8;font-size:12px;zoom:.8;margin:3px 0 0 0;vertical-align:text-top}.zjapp .item-list .item-list-con .text{height:30px;line-height:24px;color:#8c8c8c;padding-bottom:6px;padding-right:11px;margin-right:-10px}.zjapp .item-list .item-list-con .text,.zjapp .item-list .item-list-con .time{font-size:14px;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important}.zjapp .item-list .item-list-con .time{height:20px;line-height:20px;color:#b3b3b3;padding-right:11px!important;margin-right:-10px!important}.zjapp .item-list .item-list-con .time .ion{color:#a6a6a6;font-size:20px;font-weight:700;margin-right:5px;vertical-align:top}.zjapp .item-list .item-list-r{width:60px;line-height:18px;text-align:center}.zjapp .item-list .item-list-status{min-width:4em;line-height:18px;text-align:center;white-space:normal;font-size:14px}.zjapp .item-list .icon-unread{display:inline-block;text-align:center;width:12px;height:12px;border-radius:6px;background-color:red}.zjapp .item-list .icon-return,.zjapp .item-list .icon-timeout,.zjapp .item-list .icon-urgent{display:inline-block;width:16px;height:16px;text-align:center;line-height:16px;font-size:12px;font-style:normal;color:#fff;border-radius:2px;-webkit-border-radius:2px;vertical-align:top;margin-top:4px;margin-right:5px}.zjapp .item-list .icon-timeout{background:#964bfe}.zjapp .item-list .icon-return{background:#fe8b00}.zjapp .item-list .icon-urgent{background:#ff3c3d}.zjapp .item-list .icon-return:last-child,.zjapp .item-list .icon-timeout:last-child,.zjapp .item-list .icon-urgent:last-child{margin-right:0}.zjapp .item-list-tip{height:70px;line-height:60px;color:#b4b4b4;text-align:center}.zjapp .status-new-tag{position:absolute;right:0;top:0;width:50px;height:50px;overflow:hidden;z-index:10}.zjapp .status-new-tag>.tag{position:absolute;right:-32px;bottom:22px;height:20px;line-height:20px;width:100px;color:#fff;font-size:12px;transform:rotate(45deg);text-align:center;border-width:1px;border-style:solid}.zjapp .time-status{font-size:10px;color:#999}",""])},c5a7:function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},d0fb:function(e,t,i){"use strict";(function(e){var a=i("fd50"),s=i("bcc7"),o=i("515e"),n=i("e89f"),r=i("07d2"),c=i("7bac"),l=i("a7c3"),p=i("4360");t.a={name:"CheckGuideList",components:{Item:r.a},mixins:[n.a],store:p.a,props:{data:{type:String,default:""}},data:function(){return{show:!1,isLoading:!0,listData:[],module:"",itemId:"",batchId:"",sectionId:"",options:""}},computed:{moduleAttribute:function(){return this.$store.state.global.moduleAttribute}},mounted:function(){this.data=[]},methods:{openPopup:function(t){var i,s=this;for(var o in this.value=!0,this.show=!0,this.module=t.module,this.itemId=t.itemId,this.batchId=t.batchId,this.sectionId=t.sectionId,this.options=t.options,this.$emit("open"),t)this[o]=t[o];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module];var n=!1;e.isEmpty(this.itemId)?!e.isEmpty(this.checkType)&&e.isEmpty(this.sectionId)?i=this.initByType():e.isEmpty(this.batchId)?e.isEmpty(this.options)?e.isEmpty(this.sectionId)?i=a.a.when():(n=!0,i=this.initByBidsection()):i=this.initByOptions():i=this.initByBatch():i=this.initById(),this.isLoading=!0,i.then((function(t){var i=s.moduleAttribute[s.module]||{};!e.isEmpty(i)&&i.setUsualItems&&n?c.a.getUserKey(s.mmkvCode()).then((function(e){e=null===e?t:s.mergeArray(s.deepClone(t),e),s.listData=e||[],s.isLoading=!1})):(s.listData=t||[],s.isLoading=!1)}))},mmkvCode:function(){var e=this.moduleAttribute[this.module]||{};return l.a[e.mmkv_item]+"_"+this.sectionId},mergeArray:function(t,i){var a=this;return e.filter(t,(function(t){var s=i[t.id];return e.isEmpty(t.subitem)||(t.subitem=a.mergeArray(t.subitem,i)),!e.isEmpty(s)||"desc"===t.type}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},clickItem:function(e){e.subitem&&e.subitem.length?this.$set(e,"isOpen",!e.isOpen):"special-inspect"===this.module?o.a.openPopup({itemId:e.id,module:this.module}):o.a.openPopup({itemId:e.item_id,module:this.module})},initById:function(){var e=this;if("special-inspect"!==this.module)return s.a.getCheckItem(this.itemId,this.checkType).then((function(t){return t?e.sectionId?s.a.getBidSectionCheckItemListByCode(e.sectionId,t.code):s.a.getCheckItemTreeByCode(t.code):a.a.when()}))},initByType:function(){return s.a.getCheckItemGuidelineList(this.checkType)},initByBatch:function(){return a.a.when()},initByBidsection:function(){return s.a.getBidSectionCheckItemTreeByType(this.sectionId,this.checkType)},initByOptions:function(){return a.a.resolve(this.options)},deepClone:function(e){return JSON.parse(JSON.stringify(e))}}}}).call(this,i("391c"))},d6fa:function(e,t,i){"use strict";i("9ab7")},d767:function(e,t,i){"use strict";var a=i("329b"),s=i("07d2"),o=i("774b"),n=i("cd05"),r=i("e68e"),c=i("6718"),l=i("5028"),p=i("cf09"),d=i("04f3"),u=i("8248"),h={name:"ProcessNewHistory",components:{Item:s.a,Scroller:o.a,UserSelect:n.a,ItemImgList:r.a,SwipeTabs:c.b,SwipeTab:c.a},filters:{formatDate:function(e){return Object(u.a)(e)}},data:function(){return{show:!1,isLoading:!0,logList:[],pageIndex:1,zIndex:0,backButtonEvent:""}},methods:{openDialog:function(e){e&&e.processId?(this.show=!0,this.zIndex=p.a?p.a.zIndex++:1,this.backButtonEvent||(this.backButtonEvent=Object(d.a)(this.closePopup)),this.getList(e.processId)):console.error("参数错误，打开退回记录失败")},closeDialog:function(){this.show=!1,this.backButtonEvent&&(Object(d.c)(this.backButtonEvent),this.backButtonEvent=null)},getList:function(e){var t=this;return this.isLoading=!0,l.a.getSentBackList(e).then((function(e){t.logList=e,t.pageIndex=e.length-1,t.isLoading=!1}))}}},m=(i("010c"),i("17cc")),f=Object(m.a)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-right"}},[e.show?i("page-content",{attrs:{title:"退回记录",mode:"dialog","on-close":e.closeDialog}},[e.isLoading?e._e():i("swipe-tabs",{attrs:{"mark-type":"point","show-tabs":e.logList.length>1},model:{value:e.pageIndex,callback:function(t){e.pageIndex=t},expression:"pageIndex"}},e._l(e.logList,(function(t,a){return i("swipe-tab",{key:a,attrs:{title:"第"+(a+1)+"次"}},[i("scroller",e._l(t,(function(t,a){return i("div",{key:a,staticClass:"mt10"},[t.contractor?i("item",{attrs:{label:"施工负责人"===t.type?"施工单位":"后续接收单位",text:t.contractor||"无"}}):e._e(),i("user-select",{attrs:{title:t.type,mode:"view",date:e._f("formatDate")(t.complete_date),status:"施工负责人"===t.type?"申请验收":"已通过"===t.status?"验收通过":t.status,"status-class":{"color-green":"施工负责人"!==t.type&&"已通过"===t.status,"color-red":"施工负责人"!==t.type&&"已退回"===t.status},editabled:!1},model:{value:t.checker,callback:function(i){e.$set(t,"checker",i)},expression:"detail.checker"}}),"施工负责人"!==t.type?i("item",{attrs:{label:"已退回"===t.status?"退回原因":"移交记录"}},[i("template",{slot:"right"},[t.remark||t.image_file.length?i("div",{staticClass:"item-con"},[t.remark?i("div",{staticClass:"item-font"},[e._v(e._s(t.remark))]):e._e(),i("item-img-list",{attrs:{editabled:!1},model:{value:t.image_file,callback:function(i){e.$set(t,"image_file",i)},expression:"detail.image_file"}})],1):i("div",{staticClass:"item-text"},[e._v("无")])])],2):e._e(),"施工负责人"===t.type&&t.checkpoint.length?i("div",{staticClass:"mt10"},[e._l(t.checkpoint,(function(t,a){return[i("item",{key:"title"+a,staticClass:"mt10",attrs:{text:t.title}},[i("i",{staticClass:"icon-point",attrs:{slot:"icon-left"},slot:"icon-left"})]),i("item",{key:"img"+a,staticClass:"pt0 pb15 bg-white"},[i("item-img-list",{attrs:{editabled:!1,group:"check-point-view"},model:{value:t.image_file,callback:function(i){e.$set(t,"image_file",i)},expression:"point.image_file"}})],1),t.content?i("div",{key:"con"+a,staticClass:"pl15 pr15 pb10 bg-white"},[i("div",{staticClass:"point-content"},[e._v(e._s(t.content))])]):e._e()]}))],2):e._e(),"施工负责人"===t.type&&t.remark?i("item",{attrs:{label:"备注",text:t.remark}}):e._e()],1)})))],1)}))),i("loading-status",{attrs:{"is-loading":e.isLoading}})],1):e._e()],1)}),[],!1,null,"69ced543",null).exports,g=!1;g||(g=new(a.default.extend(f))({el:document.createElement("div")}),document.body.appendChild(g.$el));t.a=g},d81a:function(e,t,i){"use strict";i("299f")},da1c:function(e,t,i){"use strict";i("163d");var a=i("65a8"),s={name:"ProblemHeader",props:{status:{type:String,default:""},statusText:{type:String,default:""},level:{type:String,default:""},isTimeout:{type:Boolean,default:!1},sentBackTimes:{type:[Number,String],default:0}},data:function(){return{edOptions:{}}},created:function(){var e=this;a.a.getOptions("紧急程度").then((function(t){e.edOptions=t}))}},o=(i("1f63"),i("17cc")),n=Object(o.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._g({staticClass:"problem-detail-header border-bottom"},e.$listeners),[i("div",{staticClass:"status",class:{"待整改":"status-red","不合格":"status-red","已退回":"status-red","待复验":"status-orange","已放水待验收":"status-orange","检查中":"status-orange","待验收":"status-orange","已通过":"status-green","已整改":"status-green","已提交":"status-green","合格":"status-green","检查完毕":"status-green","已验收":"status-green","已关闭":"status-black","进度正常":"status-green","进度滞后":"status-red","验收中":"status-orange","已抽验":"status-green"}[e.status]},[e._v(e._s(e.statusText||e.status))]),"紧急"===e.level||"特急"===e.level?i("span",{staticClass:"urgent"},[e._v(e._s(e.edOptions[e.level]))]):e._e(),e.isTimeout?i("span",{staticClass:"timeout"},[e._v("超时")]):e._e(),e.sentBackTimes>0?i("span",{staticClass:"return"},[e._v("退回"+e._s(e.sentBackTimes)+"次")]):e._e(),e._t("operat")],2)}),[],!1,null,"0901aadd",null);t.a=n.exports},db6b2:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,'.zjapp .swipe-tabs[data-v-025feb99]{display:flex;flex-direction:column;flex:1;overflow:hidden}.zjapp .tabs[data-v-025feb99]{position:relative;display:flex;background-color:#fff}.zjapp .tab[data-v-025feb99]{flex:1;height:40px;line-height:20px;padding:10px;font-size:14px;text-align:center;box-sizing:border-box}.zjapp .tab-current[data-v-025feb99]{color:#4275e8}.zjapp .mark-line[data-v-025feb99]{position:absolute;bottom:0;left:0;width:20px;height:2px;margin-left:-10px;background-image:linear-gradient(90deg,#5ea2ff,#4f83eb 50%,#4275e8);transition:left .4s cubic-bezier(.1,.7,.1,1)}.zjapp .tabs-point[data-v-025feb99]{position:relative;z-index:1;height:40px;font-size:0;text-align:center;background-color:#fff;overflow:visible}.zjapp .tabs-scroll[data-v-025feb99]{position:relative;padding-bottom:3px;margin-bottom:-3px;white-space:nowrap;overflow-x:auto}.zjapp .tabs-scroll[data-v-025feb99]::-webkit-scrollbar{display:none}.zjapp .tab-point[data-v-025feb99]{display:inline-block;padding:10px 15px;line-height:20px;font-size:16px;color:#333;white-space:nowrap}.zjapp .tab-point.tab-current[data-v-025feb99]{position:relative;z-index:3;color:#4275e8}.zjapp .tab-point.tab-current[data-v-025feb99]:after{content:"";position:absolute;z-index:3;bottom:-3px;left:50%;margin-left:-3px;width:7px;height:7px;border-radius:50%;background-color:#4275e8}',""])},dc98:function(e,t,i){"use strict";i("0732")},dd16:function(e,t,i){"use strict";(function(e){t.a={name:"StatusText",props:{status:{type:String},text:{type:String},extend:{type:Object,default:function(){return{}}}},data:function(){return{classSet:e.extend({"草稿":"color-gray","暂存":"color-gray","检查中":"color-orange","待整改":"color-red","待复验":"color-orange","待验收":"color-red","待报验":"color-red","待申请进场":"color-red","待初验":"color-red","待送检":"color-red","待上传报告":"color-red","待退场":"color-red","待建设单位验收":"color-red","待区域验收":"color-red","供应链退回":"color-red","预创建":"color-status-blue","已提交":"color-green","已整改":"color-green","已验收":"color-green","已通过":"color-green","已退场":"color-gray","已关闭":"color-gray","非正常关闭":"color-gray","已退回":"color-red","已完成":"color-green","已甩项":"color-gray","检查完毕":"color-green","送检合格":"color-green","复验合格":"color-green","验收合格":"color-green","验收不合格":"color-red","未验收":"color-orange","待点评":"color-orange","已点评":"color-green","合格":"color-green","不合格":"color-red","进度正常":"color-green","进度滞后":"color-red","施工单位验收合格":"color-green","监理单位验收合格":"color-green","建设单位验收合格":"color-green","施工单位验收不合格":"color-red","监理单位验收不合格":"color-red","建设单位验收不合格":"color-red"},this.extend)}},mounted:function(){}}}).call(this,i("391c"))},de1f:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .icon-point[data-v-69ced543]{position:absolute;top:15px;left:0;width:4px;height:16px;background-color:#4275e8}.zjapp .point-content[data-v-69ced543]{font-size:14px;background-color:#f0f0f0;padding:10px;color:#666;border-radius:3px}",""])},e8e4:function(e,t,i){"use strict";i("163d");var a={name:"ProgressRound",props:{size:{type:[String,Number],default:24}},data:function(){return{girth:22*Math.PI}},computed:{barWidth:function(){return this.girth*(Number(this.progress)||0)/100},isWaiting:function(){return 0===(Number(this.progress)||0)}}},s=(i("9e8c"),i("17cc")),o=Object(s.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{staticClass:"convert",style:{width:this.size+"px",height:this.size+"px"},attrs:{t:"1597203904175",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{staticClass:"icon",attrs:{d:"M194.047757 125.823843l2.133331 0.170666a42.922613 42.922613 0 0 1 33.023959 21.119974l85.333226 147.797148a42.666613 42.666613 0 1 1-73.898574 42.666614L183.893103 239.231701A424.959469 424.959469 0 0 0 85.333227 511.99936c0 235.647705 191.018428 426.666133 426.666133 426.666133a426.3248 426.3248 0 0 0 165.589126-33.279958 42.666613 42.666613 0 0 1 33.151959 78.591902A508.586031 508.586031 0 0 1 511.99936 1023.99872C229.247713 1023.99872 0 794.751007 0 511.99936c0-143.786487 59.605259-278.058319 162.559797-374.271532 2.474664-2.346664 5.247993-4.437328 8.362656-6.229326l0.426666-0.255999a42.32528 42.32528 0 0 1 1.663998-0.853333l-2.090664 1.109332c1.706665-0.981332 3.413329-1.834664 5.16266-2.559997l1.194665-0.426666a36.394621 36.394621 0 0 1 3.498663-1.151998l1.365331-0.341333a32.981292 32.981292 0 0 1 3.839996-0.767999l0.511999-0.042667a38.655952 38.655952 0 0 1 7.55199-0.426666zM511.99936 0c282.751647 0 511.99936 229.247713 511.99936 511.99936a510.250029 510.250029 0 0 1-152.917142 364.97021 42.666613 42.666613 0 0 1-49.493272 7.509324 42.83728 42.83728 0 0 1-18.51731-17.194645l-85.333227-147.797148a42.666613 42.666613 0 0 1 73.898575-42.666614l56.575929 97.919878A424.703469 424.703469 0 0 0 938.665493 511.99936c0-235.647705-191.018428-426.666133-426.666133-426.666133-44.842611 0-88.746556 6.911991-130.474504 20.309308A42.666613 42.666613 0 0 1 355.412889 24.405303 511.700694 511.700694 0 0 1 511.99936 0z","p-id":"13796"}})])}),[],!1,null,"13aac6b6",null);t.a=o.exports},f1e4:function(e,t,i){"use strict";(function(e){i("5ab2"),i("e10e");var a=i("28f8"),s=(i("9e76"),i("6d57"),i("9a33"),i("f548"),i("cc57"),i("4ad6")),o=i("e89f"),n=i("bcc7"),r=i("3122"),c=i("6e1b"),l=i("c130"),p=i("0636");function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}t.a={name:"CheckGuideDetail",components:{},mixins:[o.a],data:function(){return{show:!1,isLoading:!0,isImageDownloading:!1,title:"",content:[],module:"",itemId:""}},methods:{openPopup:function(t){var i=this;for(var a in this.value=!0,this.show=!0,this.module=t.module,this.itemId=t.itemId,this.$emit("open"),t)this[a]=t[a];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module],this.isLoading=!0,("special-inspect"===this.module?c.a.getSpecialInspectCheckItemDetail(this.itemId):"templet-plan"===this.module?l.a.getTempletDetail(this.itemId):"material"===this.module?p.a.getMaterialDetail(this.itemId):n.a.getCheckItem(this.itemId,this.checkType)).then((function(t){console.log("checkitemData",t),i.checkitemData=t,i.title=t.full_name||t.name,"special-inspect"!==i.module&&"inspect"!==i.module&&"fly-inspect"!==i.module&&"material"!==i.module||(t.content=t.guideline||t.content);var a=t.content?t.content.trim():"";if(a=(a=(a=(a=(a=a.replace(/<\/p><p>/gm,"\n")).replace(/<p>/gm,"")).replace(/<\/p>/gm,"")).replace(/<br>/gm,"")).replace(/<br \/>/gm,""),/(<img[^\>]*>)/gm.test(a)){var s=a.split(/(<img[^\>]*>)/gm);(s=s.filter((function(e){return!!e}))).forEach((function(e,t){e&&!/^\s*\n/.test(e)&&t&&!/\n\s*$/.test(s[t-1])&&(s[t]="\n"+e)})),a=s.join("")}var o=a?a.split("\n"):[];i.content=e.map(o,(function(e,t){var i;if(/<img([\s\S]*)>/gm.test(e)){var a=e.split(/\ssrc="([^"]*)"/gm)[1],s=a?a.match(/[\w|-]{36}/gm)[0]:(new Date).getTime()+"-"+t;i={isImg:!0,src:"",url:a,status:"pending",id:s,ready:!0}}else i={isImg:!1,val:e};return i})),i.downloadImage(),i.isLoading=!1})).catch((function(e){$log.log(e)}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},getThumbnail:function(e){return"pending"===e.status?r.a.IMAGE_LOADING:"rejected"===e.status?r.a.IMAGE_RELOAD:"dev"===APP_ENV?e.url:"fulfilled"===e.status?e.src:($log.log("检查指引-显示图片：",e),r.a.IMAGE_PLACEHOLD)},imgError:function(e,t){$log.error("检查指引-加载图片出现错误：",e);var i=u({},e);i.status="rejected",this.$set(this.content,t,i)},downloadImage:function(t){var i=this;t=t?[t]:this.imageList(),e.each(t,(function(t){var a=u({},t),s=e.map(i.content,(function(e){return e.id})).indexOf(t.id);r.a.isNeedDownload(t.url).then((function(e){e?r.a.download(t.url).then((function(e){a.status="fulfilled",a.src=r.a.fixUrl(e),i.$set(i.content,s,a)})).catch((function(e){$log.error("检查指引-下载图片：",e)})):(a.status="fulfilled",a.src=r.a.fixUrl(r.a.getPathFromUrl(t.url)),i.$set(i.content,s,a))}))}))},imageList:function(){return e.filter(this.content,(function(e){return e.isImg}))},imgClick:function(t){var i=this;if("pending"===t.status)return!1;if("rejected"===t.status)return this.downloadImage(t),$log.log("检查指引-点击重新加载-重新下载图片：",t),!1;var a=this.imageList(),o=e.map(a,(function(e){return e.id})).indexOf(t.id);a=e.map(a,(function(e){return i.getThumbnail(e)})),s.a.openImageBrowser(a,o)}}}}).call(this,i("391c"))},f24f:function(e,t,i){"use strict";t.__esModule=!0,t.isNumber=function(e){return/^\d+(\.\d+)?$/.test(e)},t.isNaN=function(e){if(Number.isNaN)return Number.isNaN(e);return e!=e}},f369:function(e,t,i){"use strict";var a=i("fd50"),s=i("bcc7"),o=i("329b"),n=i("d0fb").a,r=(i("9b25"),i("17cc")),c=Object(r.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-right"}},[e.show?i("page-content",{attrs:{mode:"dialog",title:"检查指引","on-close":e.closePopup}},[!e.isLoading&&e.listData.length?i("div",{staticClass:"page-scroll"},e._l(e.listData,(function(t,a){return i("div",{key:a},[i("item",{attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){e.clickItem(t)}}},[i("div",{staticClass:"item-text fw-b color-blue one-line"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){e.clickItem(t)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){e.clickItem(t)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){e.clickItem(t)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])])],1)})):e._e()],2)})):e._e()],2)})):e._e()],2)}))):e._e(),i("loading-status",{attrs:{"is-loading":e.isLoading,"is-empty":!e.listData.length,"empty-text":"没有检查项"}})],1):e._e()],1)}),[],!1,null,"74102c05",null).exports,l=!1;l||(l=new(o.default.extend(c))({el:document.createElement("div")}),document.body.appendChild(l.$el));var p=l,d=i("515e"),u=i("91c1").a,h=(i("dc98"),Object(r.a)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.show?i("div",{staticClass:"main",style:{top:e.contentTop+"px"}},[i("i",{staticClass:"arrow"}),i("div",{staticClass:"content",on:{click:function(t){return t.target!==t.currentTarget?null:e.closePopup(t)}}},[i("transition",{attrs:{name:"slide-down"},on:{enter:function(t){e.isOpening=!0},"after-enter":function(t){e.isOpening=!1},leave:function(t){e.isClosing=!0},"after-leave":e.afterClose}},[e.showList?i("div",{staticClass:"box",style:{height:e.listHeight+"px"}},e._l(e.data,(function(t,a){return i("div",{key:a,class:{"border-bottom":e.data.length>1,"box-single":1===e.data.length}},[i("div",{staticClass:"detail-hd",class:{"border-bottom":e.data.length<=1,"detail-hd-single":e.data.length<=1},on:{click:function(i){e.toggleItem(t)}}},[e.data.length>1?i("i",{class:{"detail-arrow-right":!t.isOpen,"detail-arrow-down":t.isOpen}}):e._e(),i("div",{staticClass:"detail-title"},[e._v(e._s(t.name))])]),e.data.length<=1||t.isOpen?i("div",{staticClass:"detail-bd",class:{"detail-bd-single":e.data.length<=1}},[e._l(t.textArr,(function(t,a){return i("p",{key:a,staticClass:"text-line"},[e._v("\n              "+e._s(t)+"\n            ")])})),i("item-img-list",{attrs:{editabled:!1},model:{value:t.contentImage,callback:function(i){e.$set(t,"contentImage",i)},expression:"item.contentImage"}}),i("loading-status",{attrs:{"is-empty":!t.textArr.length&&!t.contentImage.length,"empty-text":"PC端未设置检查指引"}})],2):e._e()])}))):e._e()])],1)]):e._e()}),[],!1,null,"2cac8864",null).exports),m=!1;m||(m=new(o.default.extend(h))({el:document.createElement("div")}),document.body.appendChild(m.$el));var f=m,g={name:"CheckGuide",components:{},props:{module:{type:String,default:""},mode:{type:String,default:"page"},itemId:{type:String,default:""},itemIds:{type:Array,default:function(){return[]}},batchId:{type:String,default:""},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}},optionsPromise:{type:Function,default:function(){}},beforeOpen:{type:Function,default:function(){}}},data:function(){return{isLoading:!1}},methods:{openCheckGuide:function(){var e=this,t=this.beforeOpen&&this.beforeOpen();t instanceof Promise||(t=Promise.resolve(t)),t.then((function(t){!1!==t&&("drop"===e.mode?f.openPopup({itemIds:e.itemIds,el:e.$refs["check-guide-btn"],options:e.options}):("templet-plan"===e.module?a.a.when(!1):e.itemId&&e.sectionId?s.a.hasChildSectionCheckItem(e.itemId,e.sectionId):e.itemId?s.a.hasChildCheckItem(e.itemId):a.a.when(!0)).then((function(t){t?p.openPopup({module:e.module,itemId:e.itemId,batchId:e.batchId,sectionId:e.sectionId,options:e.options}):d.a.openPopup({itemId:e.itemId,module:e.module})})))}))}}},b=Object(r.a)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"check-guide-btn",staticClass:"header-btn",on:{click:function(t){e.openCheckGuide()}}},[i("icon",{attrs:{name:"nav-info"}})],1)}),[],!1,null,null,null);t.a=b.exports},f3d7:function(e,t,i){"use strict";i("9120")},f53a:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .number-keyboard-con[data-v-6337f428]{position:absolute;left:0;bottom:0;width:100%;padding:4px 0;background-color:#fafafa;box-shadow:0 -4px 8px 0 rgba(0,0,0,.08);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.zjapp .ios-bezel-less[data-v-6337f428]{padding-bottom:34px}.zjapp .keyboard-row[data-v-6337f428],.zjapp .keys-row[data-v-6337f428]{display:flex}.zjapp .row-span-1[data-v-6337f428]{flex:1}.zjapp .row-span-2[data-v-6337f428]{flex:2}.zjapp .row-span-3[data-v-6337f428]{flex:3}.zjapp .keys[data-v-6337f428]{flex:1;height:48px;line-height:48px;text-align:center;font-size:18px;margin:4px;border:1px solid rgba(5,5,5,.07);border-radius:8px;background-color:#fff;padding:0}.zjapp .keys-next[data-v-6337f428],.zjapp .keys-prev[data-v-6337f428]{font-size:14px;color:#4275e8}.zjapp .keys-ok[data-v-6337f428]{font-size:14px;color:#999}.zjapp .keys-delete[data-v-6337f428]{color:#999}.zjapp .icon[data-v-6337f428]{pointer-events:none}.zjapp .icon-keyboard-close[data-v-6337f428]{font-size:20px;color:#999}.zjapp .icon-keyboard-delete[data-v-6337f428]{vertical-align:top;margin-top:13px;font-size:14px;color:#333}.zjapp .activing[data-v-6337f428]{background-color:#ececec}.zjapp .disabled[data-v-6337f428]{color:#999}.zjapp .col[data-v-6337f428]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:104px;line-height:36px}",""])},fa4f:function(e,t,i){"use strict";var a=i("4aef"),s=i("967a"),o={name:"ItemList",components:{StatusText:a.a},props:{img:{type:String,default:""},title:{type:String,default:""},detail:{type:String,default:""},footer:{type:String,default:""},status:{type:String,default:""},isShowNewStatus:{type:Boolean,default:!1},statusText:{type:String,default:""},statusClassSet:{type:Object,default:function(){return{}}},typeTag:{type:String,default:""},isUnread:{type:Boolean,default:!1},isTimeout:{type:Boolean,default:!1},isUrgent:{type:Boolean,default:!1},isReturn:{type:Boolean,default:!1},repairDeadline:{type:String,default:null}},data:function(){return{repairDeadlineStatus:s.a.REPAIR_DEADLINE_STATUS.status}},computed:{bgNewClass:function(){return{"草稿":"bg-gray7 b-color","暂存":"bg-gray b-color","检查中":"bg-orange b-color","待整改":"bg-red2 b-color ","待复验":"bg-purple b-color","待验收":"bg-red b-color","待报验":"bg-red b-color","待申请进场":"bg-red b-color","待初验":"bg-red b-color","待送检":"bg-red b-color","待上传报告":"bg-red b-color","待退场":"bg-red b-color","待建设单位验收":"bg-red b-color","待区域验收":"bg-red b-color","已提交":"bg-green b-color","已整改":"bg-green b-color","已验收":"bg-green b-color","已通过":"bg-green2 b-color","已退场":"bg-gray b-color","已关闭":"bg-gray7 b-color","非正常关闭":"bg-gray b-color","已退回":"bg-red b-color","已完成":"bg-green b-color","已甩项":"bg-gray b-color","检查完毕":"bg-green b-color","送检合格":"bg-green b-color","复验合格":"bg-green b-color","验收合格":"bg-green b-color","验收不合格":"bg-red b-color","未验收":"bg-orange b-color","待点评":"bg-orange b-color","已点评":"bg-green b-color","合格":"bg-green b-color","不合格":"bg-red b-color","进度正常":"bg-green2 b-color","进度滞后":"bg-red2 b-color","施工单位验收合格":"bg-green b-color","监理单位验收合格":"bg-green b-color","建设单位验收合格":"bg-green b-color","施工单位验收不合格":"bg-red b-color","监理单位验收不合格":"bg-red b-color","建设单位验收不合格":"bg-red b-color"}}},activated:function(){}},n=(i("19a9"),i("17cc")),r=Object(n.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._g({staticClass:"item-list border-bottom"},e.$listeners),[e.isShowNewStatus?i("div",{staticClass:"status-new-tag"},[i("div",{staticClass:"tag",class:e.bgNewClass[e.status]},[e._v("\n      "+e._s(e.status)+"\n    ")])]):e._e(),e.img?i("div",{staticClass:"img",style:{"background-image":"url("+e.img+")"}}):e._e(),i("div",{staticClass:"item-list-con"},[i("h2",{staticClass:"title"},[e.isUnread?i("i",{staticClass:"icon-unread"}):e._e(),e.isTimeout?i("i",{staticClass:"icon-timeout"},[e._v("\n        超\n      ")]):e._e(),e.isUrgent?i("i",{staticClass:"icon-urgent"},[e._v("\n        急\n      ")]):e._e(),e.isReturn?i("i",{staticClass:"icon-return"},[e._v("\n        退\n      ")]):e._e(),e.$slots.title?e._t("title"):[e.typeTag?i("span",{staticClass:"type-tag"},[e._v(e._s(e.typeTag))]):e._e(),e._v("\n        "+e._s(e.title||"")+"\n      ")]],2),i("p",{staticClass:"text"},[e._v(e._s(e.detail||""))]),e.$slots.footer?e._t("footer"):i("p",{staticClass:"time",domProps:{innerHTML:e._s(e.footer||"")}})],2),e.status&&!e.isShowNewStatus?i("div",{staticClass:"item-list-status"},[i("status-text",{attrs:{status:e.status,text:e.statusText,extend:e.statusClassSet}}),e.repairDeadline&&e.repairDeadlineStatus.includes(e.status)?i("p",{staticClass:"time-status"},[e._v("\n      "+e._s(e._f("timeStatus")(e.repairDeadline))+"\n    ")]):e._e()],1):e._e()])}),[],!1,null,null,null);t.a=r.exports},fe9e:function(e,t,i){"use strict";i("3cd8")}}]);