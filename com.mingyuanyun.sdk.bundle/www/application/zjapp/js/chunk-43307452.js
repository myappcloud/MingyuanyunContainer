(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-43307452"],{"2c76":function(e,t,i){"use strict";i("c070")},"30c7":function(e,t,i){"use strict";i("69c5")},"3c64":function(e,t,i){"use strict";i("163d");var r={name:"ItemTextarea",components:{},props:{value:{type:String,default:""},placeholder:{type:String,default:""},maxlength:{type:Number,default:200},borderBottom:{type:Boolean,default:!0}},data:function(){return{textareaHeight:40,isLock:!1,blurTime:null}},computed:{lastLength:function(){var e=this.value&&this.value.length||0,t=this.maxlength-e;return t>0?t:0}},mounted:function(){var e=this;this.$nextTick((function(){e.textareaHeight=e.$refs.rule&&e.$refs.rule.offsetHeight||40}))},methods:{onfocus:function(){var e=(new Date).getTime();this.blurTime&&e-this.blurTime<300&&window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(this.$refs.input.blur(),window.cordova.plugins.Keyboard.close()),this.blurTime=null,this.$emit("focus")},onblur:function(){this.blurTime=(new Date).getTime(),this.$emit("blur")},setStatus:function(e){console.log(e),this.isLock=e},oninput:function(e){var t=this;setTimeout((function(){if(!t.isLock){var i=e.target.value;i.length>t.maxlength&&(i=i.substring(0,t.maxlength),t.$refs.input.value=i),t.$refs.rule.innerText=i,t.textareaHeight=t.$refs.rule&&t.$refs.rule.offsetHeight+20,t.$emit("input",i),t.$emit("change",i)}}),0)}}},a=(i("2c76"),i("17cc")),s=Object(a.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"item-textarea",class:{"border-bottom":e.borderBottom}},[i("div",{staticClass:"item-textarea-content"},[i("textarea",{ref:"input",style:{height:e.textareaHeight+"px"},attrs:{placeholder:e.placeholder},domProps:{value:e.value},on:{focus:e.onfocus,blur:e.onblur,compositionstart:function(t){e.setStatus(!0)},compositionend:function(t){e.setStatus(!1)},input:e.oninput}}),i("div",{ref:"rule",staticClass:"rule"},[e._v("\n      "+e._s(e.value)+"\n    ")]),e.maxlength!==1/0?i("p",{staticClass:"counter"},[e._v("\n      "+e._s(e.lastLength)+"\n    ")]):e._e()])])}),[],!1,null,null,null);t.a=s.exports},"3f68":function(e,t,i){var r=i("5454");(e.exports=i("690e")(!1)).push([e.i,".zjapp .ncov-safe-popup .scroll-view{min-width:260px;text-align:center}.zjapp .ncov-safe-popup .popup-buttons .button{margin:0;background-color:#fff}.zjapp .ncov-risk-popup .popup-head{display:block;padding-bottom:10px;background-image:none;font-size:16px;color:#000}.zjapp .ncov-risk-popup .scroll-view{margin-top:0;max-width:260px;max-height:200px}.zjapp .ncov-risk-popup .popup-body{padding-top:10px;max-height:200px}.zjapp .ncov-risk-popup .line{line-height:20px;display:flex}.zjapp .ncov-risk-popup .label{color:#999;font-size:14px}.zjapp .ncov-risk-popup .text{flex:1;color:#000;font-size:14px}.zjapp .ncov-risk-popup .level-item{display:inline-block;width:20px;height:20px;margin-right:6px;background:url("+r(i("811c"))+") no-repeat;background-size:20px 20px}.zjapp .ncov-risk-popup .popup-buttons{flex-direction:column}.zjapp .ncov-risk-popup .popup-buttons .button{margin:0;background-color:#fff}.zjapp .ncov-risk-popup .popup-extend-buttons{margin-top:30px;text-align:center}.zjapp .btn-risk-detail{display:inline-block;height:28px;line-height:28px;padding:0 15px;background:linear-gradient(90deg,#55abff,#4c7aff);border:none;border-radius:14px;color:#fff;font-size:14px}.zjapp .ncov-popup-confirm .van-dialog__cancel{color:#666}.zjapp .ncov-popup-confirm .van-dialog__confirm .van-button__text{font-weight:400}.zjapp .detail-line{background-color:#fafafa}",""])},"46ae":function(e,t,i){"use strict";var r=i("e1e7").a,a=i("17cc"),s=Object(a.a)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("item",{attrs:{label:e.title,text:e.text,mode:e.mode,editabled:e.editabled,placeholder:e.placeholder},on:{click:e.openSelect}},[e.$slots.right?e._t("right",null,{slot:"right"}):e._e()],2)}),[],!1,null,null,null);t.a=s.exports},"4e8c":function(e,t,i){"use strict";var r=i("329b"),a=i("b056").a,s=(i("30c7"),i("17cc")),o=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.show?i("div",{staticClass:"content",on:{click:function(t){return t.target!==t.currentTarget?null:e.closePopup(t)}}},[i("transition",{attrs:{name:"slide-up"},on:{enter:function(t){e.isOpening=!0},"after-enter":function(t){e.isOpening=!1},leave:function(t){e.isClosing=!0},"after-leave":e.afterClose}},[e.showList?i("div",{staticClass:"box",style:{height:e.listHeight+"px"}},[e.allowSearching?e._e():i("div",{staticClass:"hd border-bottom"},[e._v("\n        "+e._s(e.title)+"\n        "),i("icon",{attrs:{name:"unqualified"},on:{click:e.closePopup}})],1),e.allowSearch?i("app-search-bar",{ref:"app-search-bar-checkitem-select",staticClass:"bg-white",attrs:{"history-key":e.historyKey},on:{changeSearchStatus:e.setSearchMode},model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}}):e._e(),e.renderData&&e.renderData.length?i("scroller",{ref:"scroller",attrs:{"has-next":e.hasNextPage},on:{loadNext:e.loadNext}},[i("div",{attrs:{id:"slideUpSelectDialog"}},e._l(e.renderData,(function(t){return i("item",{key:t.id,attrs:{"icon-right":t.id===e.selected.id?"qualified":"",border:"bottom"},on:{click:function(i){e.select(t)}}},[e.showNote?[i("div",{staticClass:"item-con"},[i("p",{staticClass:"text"},[e._v(e._s(t.name))]),i("p",{staticClass:"note"},[e._v(e._s(t[e.showNote]))])])]:i("div",{staticClass:"item-text",domProps:{innerHTML:e._s(e.keywordFilter(t.name))}})],2)})))]):e._e(),i("loading-status",{attrs:{"is-empty":!e.options||!e.options.length,type:"search","empty-text":e.emptyText}},[e.allowSearching&&e.allowSearch?i("template",{slot:"empty-text"},[e._v("\n          未搜索到包含"),i("span",{staticClass:"color-blue"},[e._v(e._s(e.searchKeyword))]),e._v("的结果\n        ")]):e._e()],2)],1):e._e()])],1):e._e()}),[],!1,null,"c4404120",null).exports,n=!1;n||(n=new(r.default.extend(o))({el:document.createElement("div")}),document.body.appendChild(n.$el));t.a=n},5431:function(e,t,i){"use strict";i("77d1")},"574c":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .item-textarea{background-color:#fff;padding:5px 15px}.zjapp .item-textarea-content{position:relative}.zjapp .item-textarea .rule,.zjapp .item-textarea textarea{width:100%;min-height:40px;line-height:20px;font-size:16px;padding:0;border:none}.zjapp .item-textarea .rule{position:absolute;top:0;left:0;visibility:hidden;word-break:break-all}.zjapp .item-textarea .counter{text-align:right;margin:0 0 -5px 0;height:15px;line-height:15px;color:#b2b2b2;font-size:12px}",""])},"69c5":function(e,t,i){var r=i("7d2b");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,i("85cb").default)("172b2e44",r,!0,{sourceMap:!1,shadowMode:!1})},"77d1":function(e,t,i){var r=i("876f");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,i("85cb").default)("6edb5f86",r,!0,{sourceMap:!1,shadowMode:!1})},"7d2b":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .content[data-v-c4404120]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-c4404120]{position:absolute;left:0;bottom:0;width:100%;flex-direction:column}.zjapp .box[data-v-c4404120],.zjapp .list-wrap[data-v-c4404120]{display:flex;background-color:#fff}.zjapp .list-wrap[data-v-c4404120]{flex-direction:row;align-items:flex-start;flex:1;height:465px}.zjapp #slideUpSelectDialog[data-v-c4404120]{padding:0 15px 0}.zjapp .hd[data-v-c4404120]{position:relative;padding:10px 45px;height:44px;line-height:22px;font-size:16px;color:#666;text-align:center;background-color:#fff}.zjapp .hd .icon-unqualified[data-v-c4404120]{position:absolute;width:44px;height:44px;top:0;right:0;line-height:44px;font-size:14px;text-align:center;color:#999}.zjapp .item[data-v-c4404120]{padding-left:0;padding-right:0}.zjapp .text[data-v-c4404120]{font-size:14px;line-height:20px;color:#333}.zjapp .note[data-v-c4404120]{font-size:12px;line-height:18px;color:#999}[data-v-c4404120] .icon-qualified{width:34px;height:34px;line-height:34px;text-align:center;color:#4275e8}",""])},"876f":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .user-info[data-v-95a8d710]{display:flex;padding:15px;background-color:#fff}.zjapp .info-left[data-v-95a8d710]{flex:1}.zjapp .no-idcard[data-v-95a8d710]{padding-top:15px}.zjapp .no-idcard.no-mobile[data-v-95a8d710]{padding-top:25px}.zjapp .info-img[data-v-95a8d710]{width:66px;height:66px;border-radius:33px;background:no-repeat 50%;background-size:cover;background-color:#ddd;overflow:hidden}.zjapp .user-name[data-v-95a8d710]{font-size:18px;line-height:20px;margin-bottom:10px;color:#333}.zjapp .user-line[data-v-95a8d710]{line-height:18px;color:#999}.zjapp .icon-point[data-v-95a8d710]{position:absolute;top:15px;left:0;width:4px;height:16px;background-color:#4275e8}.zjapp .number-input.temperature-input[data-v-95a8d710]{flex:1;border:none;text-align:right}.zjapp .number-input.temperature-input.number-input-focus[data-v-95a8d710]{box-shadow:none}.zjapp .bg-none[data-v-95a8d710]{background-color:none}.zjapp .ncov-radio[data-v-95a8d710] .radio-box{height:28px;line-height:28px;min-width:52px}",""])},b056:function(e,t,i){"use strict";(function(e){i("f548"),i("cc57"),i("9dd9");var r,a=i("07d2"),s=i("6f9e"),o=i("e89f"),n=i("9eea"),l=i("774b");t.a={name:"SlideUpSelectDialog",components:{Item:a.a,appSearchBar:n.a,Scroller:l.a},mixins:[o.a],data:function(){return{show:!1,showList:!1,isOpening:!1,isClosing:!1,title:"",selected:{},options:[],showNote:"",emptyText:"",initHeight:null,listHeight:null,componentUid:"",searchKeyword:"",allowSearch:!1,allowSearching:!1,timer:null,historyKey:null,searchOptions:[],listLimit:100,listLimitSize:100}},computed:{renderData:function(){var e=this.options;return e&&e.length>this.listLimit?e.slice(0,this.listLimit):e||[]},hasNextPage:function(){return this.options&&this.options.length>this.listLimit}},watch:{searchKeyword:function(t){var i=this;this.$nextTick((function(){i.options=t?i.fitlerByKeyword(e.cloneDeep(i.searchOptions),t):e.cloneDeep(i.searchOptions)}))},show:function(e){var t=this;e&&this.$nextTick((function(){t.showList=!0}))},showList:function(e){e&&this.scrollToSelect()}},created:function(){s.a.$on("routerBeforeEach",this.closePopup),s.a.$on("pageContentClick",this.closePopup),window.addEventListener("native.keyboardshow",this.onResize,!1),window.addEventListener("native.keyboardhide",this.onResize,!1)},destroyed:function(){s.a.$off("routerBeforeEach",this.closePopup),s.a.$off("pageContentClick",this.closePopup)},methods:{openPopup:function(t){this.componentUid=t.componentUid||"",this.title="选择"+t.title,this.options=t.options,this.searchOptions=e.cloneDeep(t.options),this.selected=e.clone(t.selected),this.showNote=t.showNote,this.emptyText=t.emptyText,this.allowSearch=t.allowSearch,this.initHeight=t.initHeight,this.historyKey=t.historyKey,r=t.callback,this.show=!0,this.onResize(),this.clearScrollToTimeout()},closePopup:function(){var e=this;if(!this.isOpening)return this.showList=!1,this.clearScrollToTimeout(),this.cloneSearch(),new Promise((function(t){e.$on("afterClosePopup",t)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},select:function(e){r(e),this.saveHistory(),this.closePopup()},scrollToSelect:function(){var e=this;this.$nextTick((function(){e.timer=window.setTimeout((function(){var t=document.querySelector("#slideUpSelectDialog .item .item-icon-right");t&&t.scrollIntoViewIfNeeded({block:"start",behavior:"smooth"}),e.clearScrollToTimeout()}),400)}))},clearScrollToTimeout:function(){clearTimeout(this.timer),this.timer=null},cloneSearch:function(){this.options=e.cloneDeep(this.searchOptions),this.searchKeyword="",this.$refs["app-search-bar-checkitem-select"]&&this.$refs["app-search-bar-checkitem-select"].cancelSearch()},saveHistory:function(){this.$refs["app-search-bar-checkitem-select"]&&this.$refs["app-search-bar-checkitem-select"].saveHistory()},setSearchMode:function(e){this.allowSearching=e,this.onResize()},onResize:function(t){var i=null,r=window.innerHeight;r-=$rootScope.viewSize.headerHeight-44,i=this.allowSearch&&this.allowSearching?r:e.minBy([.8*r,this.initHeight]),this.listHeight=i},fitlerByKeyword:function(t,i){var r=this,a=[];return e.each(t,(function(t){if(new RegExp(i,"gm").test(t.name))t.isOpen=!0,a.push(t);else if(!e.isEmpty(t.children)){var s=r.fitlerByKeyword(t.children,i);e.isEmpty(s)||(t.isOpen=!0,t.children=s,a.push(t))}})),a},keywordFilter:function(e){return this.searchKeyword?e.replace(new RegExp(this.searchKeyword,"gm"),'<span class="color-blue">'+this.searchKeyword+"</span>"):e},loadNext:function(){this.listLimit+=this.listLimitSize,this.listLimit>this.options.length&&(this.listLimit=this.options.length)},resultListLimit:function(){this.listLimit=this.listLimitSize}}}}).call(this,i("391c"))},b318:function(e,t,i){var r=i("3f68");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,i("85cb").default)("86b859f0",r,!0,{sourceMap:!1,shadowMode:!1})},bd68:function(e,t,i){"use strict";(function(e){i("5ab2"),i("e10e");var r=i("28f8"),a=(i("2b45"),i("6d57"),i("06a2"),i("e697"),i("cc57"),i("774b")),s=i("07d2"),o=i("1059"),n=i("e68e"),l=i("3c64"),c=i("6948"),p=i("f301"),u=i("46ae"),d=i("9baf"),h=i("6bf2"),m=i.n(h),f=i("e2a7"),v=i("3122"),g=(i("1b7e"),i("162a")),b=i("330e3"),x=i.n(b),w=i("6144");i("4ad6"),i("7f43");function y(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}t.a={name:"NcovEnterAdd",components:{Scroller:a.a,Item:s.a,RadioBox:o.a,ItemImgList:n.a,ItemTextarea:l.a,NumberInput:c.a,SlideUpSelect:u.a,DateSelect:d.a},data:function(){return{isLoading:!0,bidsectionId:"",userIdcard:"",userinfo:{},isNewUser:!0,newUser:{name:"",idcard:"",mobile:"",img:[]},dataType:"",isTripOpen:!0,trafficOptions:[{id:1,name:"飞机",requiredNumber:!0},{id:2,name:"火车",requiredNumber:!0},{id:4,name:"客车",requiredNumber:!0},{id:15,name:"自驾",requiredNumber:!0},{id:3,name:"地铁",requiredNumber:!1},{id:5,name:"公交",requiredNumber:!1},{id:6,name:"出租车",requiredNumber:!1},{id:7,name:"轮船",requiredNumber:!0},{id:8,name:"其他",requiredNumber:!1}],hasTrip:!1,trip:{from:[],fromCode:"",traffic:{},number:"",date:""},tripNumbers:[{val:""}],defaultTrip:{},isHealthOpen:!0,temperature:"",health:{temperature:"",hasSymptom:"否"},hasSymptomOptions:["是","否"],extraDesc:"",remark:"",riskResult:{},travelRiskSource:"",isExpired:!1}},computed:{projId:function(){return this.$store.state.global.currentProject.id},pageTitle:function(){if(this.isExpired)return"扫描结果";var e="...";return this.isLoading||(e=this.isNewUser?"临时".concat(this.dataType,"人员"):"人员进出场登记"),e},fromText:function(){var t="";return e.isEmpty(this.trip.from)||(t=this.trip.from[0].name===this.trip.from[1].name?this.trip.from[0].name:this.trip.from[0].name+this.trip.from[1].name),t}},activated:function(){var e=w.a.getUserObject("ncov-index-section-default"+this.projId)||{};this.bidsectionId=e.id||"",this.userIdcard=this.$route.query.idcard,this.userId=this.$route.query.id,this.isExpired=!1,this.init()},methods:{reset:function(){this.userinfo={},this.newUser={name:"",idcard:"",mobile:"",img:[]},this.dataType="进场",this.isTripOpen=!0,this.hasTrip=!1,this.trip={from:[],fromCode:"",traffic:{},number:"",date:m()().format("YYYY-MM-DD")},this.tripNumbers=[{val:""}],this.defaultTrip={},this.isHealthOpen=!0,this.temperature="",this.health={temperature:"",hasSymptom:"否"},this.remark="",this.extraDesc="",this.riskResult={}},init:function(){var e=this;return this.reset(),Promise.resolve().then((function(){return e.userIdcard?e.getUserInfo():e.userId?e.getUserById():void(e.isNewUser=!0)})).then((function(){e.isLoading=!1})).catch((function(t){console.error(t),e.isNewUser=!0,e.isLoading=!1}))},getUserInfo:function(){var e=this;return this.isLoading=!0,g.a.request("/online/ncov-approach/get-travel-information-by-id-card",{idcard:this.userIdcard,bidsection_id:this.bidsectionId}).then((function(t){t&&t.user&&"0"===t.user.is_active?(e.isExpired=!0,e.setUserinfo({}),e.setTrip({})):(e.setUserinfo(t&&t.user),e.setTrip(t&&t.return_trip))}))},getUserById:function(){var e=this;return this.isLoading=!0,g.a.post("/online/ncov-user/get-return-trip",{},{user_id:this.userId,proj_id:this.projId,bidsection_id:this.bidsectionId}).then((function(t){t&&t.user&&"0"===t.user.is_active?(e.isExpired=!0,e.setUserinfo({}),e.setTrip({})):(e.setUserinfo(t&&t.user),e.setTrip(t&&t.returnTrip))}))},setUserinfo:function(t){if(this.isNewUser=e.isEmpty(t),!this.isNewUser){var i=JSON.parse(t.image||[])[0];this.userinfo={id:t.id||t.user_id,fullname:t.fullname,sex:t.sex||"",age:t.age||"",mobile:t.mobile,idcard:t.idcard||"",img:e.isEmpty(i)?x.a:v.a.getThumbnailFromUrl(i.url)}}},setTrip:function(t){if(this.hasTrip=!e.isEmpty(t),this.hasTrip){var i=t.arrival_time?m()(t.arrival_time).format("YYYY-MM-DD"):"";this.defaultTrip={from:t.from_province+(t.from_city===t.from_province?"":t.from_city),fromProvince:t.from_province,fromCity:t.from_city,traffic:this.getVehicleName(t.vehicle),number:t.number,date:i}}else this.defaultTrip={}},numbserTips:function(){f.a.notify("结合您出行的交通工具填写，\n航班示例：CZ3952\n火车/动车/高铁示例：G203\n自驾/客车/出租车示例：粤B88888",{buttonName:"知道了",className:"broad-dialog"})},addNumber:function(){this.tripNumbers.length>=10?f.a.alert("最多可添加10个"):this.tripNumbers.push({val:""})},removeNumber:function(e){this.tripNumbers.length>1&&this.tripNumbers.splice(e,1)},getVehicleName:function(t){if(isNaN(t))return t;var i=e.find(this.trafficOptions,{id:parseInt(t)});return i?i.name:""},togglePart:function(e){this[e]=!this[e]},onTemperatureOverflow:function(){f.a.alert("请输入正确的体温")},selectAddress:function(){var e=this;p.a.open({value:this.trip.fromCode,onConfirm:function(t){e.trip.from=t,e.trip.fromCode=t[t.length-1].code}})},check:function(){var t=this;if(this.fromCheck()){var i,r,a,s,o,n,l=[];if(e.each(this.tripNumbers,(function(e){e&&e.val&&l.push(e.val)})),e.isEmpty(this.defaultTrip)){var c=[];e.each(this.tripNumbers,(function(e){e&&e.val&&c.push(e.val)})),i=c.join(","),r=m()(this.trip.date).format("YYYY-MM-DD"),a=this.trip.from.length?this.trip.from[0].name:"",s=this.trip.from.length?this.trip.from[1].name:""}else i=this.defaultTrip.number,r=m()(this.defaultTrip.date).format("YYYY-MM-DD"),a=this.defaultTrip.fromProvince,s=this.defaultTrip.fromCity;return o=this.temperature,n="是"===this.health.hasSymptom?1:0,g.a.post("/online/ncov-approach/test-travel-risk",{},{user_id:this.userinfo&&this.userinfo.id||"",bidsection_id:this.bidsectionId,number:i,date:r,from_province:a,from_city:s,body_temperature:o,body_extra:n}).then((function(e){console.log(e);var i=e.data||e,r=i.risk_level,a=i.risk_reason,s=i.suggestion;t.riskResult={level:r,reason:a,suggestion:s},t.riskResult.level?t.riskTips(t.riskResult):t.safeTips()}))}},safeTips:function(){var e=this;f.a.popBoxExt({content:"该人员查无风险",cssClass:"ncov-safe-popup",buttons:["取消","提交".concat(this.dataType,"记录")],buttonsType:["color-gray1","border-left color-theme"],callback:function(t){switch(t){case 1:e.submit()}}})},riskTips:function(e){var t=this;if(e){for(var i="",r=0;r<e.level;r++)i+='<div class="level-item"></div>';var a='\n        <div class="line">\n          <div class="label">风险等级：</div>\n          <div class="level">\n            '.concat(i,'\n          </div>\n        </div>\n        <div class="line mt10">\n          <div class="label">风险原因：</div>\n          <div class="text">').concat(e.reason,'</div>\n        </div>\n        <div class="line mt10">\n          <div class="label">').concat(this.dataType,'建议：</div>\n          <div class="text">').concat(e.suggestion,"</div>\n        </div>\n      ");f.a.popBoxExt({title:"该人员存在感染风险",content:a,cssClass:"ncov-risk-popup",buttons:["拒绝".concat(this.dataType),"仍然".concat(this.dataType),"取消"],buttonsType:["color-theme","border-top color-gray1","border-top color-gray1"],callback:function(e){switch(e){case 0:t.submit(!0);break;case 1:setTimeout((function(){t.addRemark()}))}}})}},addRemark:function(){var e=this;f.a.popBoxExt({content:'<textarea id="ncov-enter-remark" maxlength="50" placeholder="请输入进出场备注"></textarea>',cssClass:"promptBox",buttons:["取消","保存"],buttonsType:["color-gray1","color-theme"],scope:this,callback:function(t){switch(t){case 1:var i=document.querySelector("#ncov-enter-remark"),r=i?i.value.trim():"";if(""===r)return f.a.alert("请输入进出场备注"),!1;e.remark=r,e.submit()}}})},uploadImages:function(){var t=[];return e.each(this.newUser.img||[],(function(e){!e.url&&e.temp&&t.push(v.a.uploadImage(e.temp).then((function(t){e.url=t})))})),Promise.all(t)},fromCheck:function(){if(this.isNewUser){if(this.newUser.name=this.newUser.name?this.newUser.name.trim():"",this.newUser.idcard=this.newUser.idcard?this.newUser.idcard.trim():"",this.newUser.mobile=this.newUser.mobile?this.newUser.mobile.trim():"",this.temperature=this.temperature?this.temperature.toString().trim():"",!this.newUser.name)return f.a.alert("请输入姓名"),!1;if(!this.newUser.idcard)return f.a.alert("请输入身份证"),!1;if(this.newUser.idcard&&!/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/.test(this.newUser.idcard))return f.a.alert("请输入正确的身份证号"),!1;if(this.newUser.mobile&&!/^1[3456789]\d{9}$/.test(this.newUser.mobile))return f.a.alert("请输入正确的手机号"),!1}if(!this.hasTrip){e.isEmpty(this.tripNumbers)||e.some(this.tripNumbers,(function(e){return!e.val||!e.val.toString().trim()}));if(e.some(this.tripNumbers,(function(e){return e.val&&e.val.indexOf(",")>=0})))return f.a.alert("航班/车次/车牌号不能输入逗号"),!1}return this.temperature?!(isNaN(this.temperature)||this.temperature<30||this.temperature>50)||(f.a.alert("请输入正确的体温"),!1):(f.a.alert("请输入体温"),!1)},submit:function(t){var i=this;f.a.loading("正在提交"),Promise.resolve().then((function(){return i.uploadImages()})).then((function(){var a={proj_id:i.projId,bidsection_id:i.bidsectionId},s=e.map(i.newUser.img,(function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?y(Object(i),!0).forEach((function(t){Object(r.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e);return delete t.thumbnail,delete t.temp,delete t.videoTemp,t}));if(i.isNewUser?(a.fullname=i.newUser.name,a.idcard=i.newUser.idcard,a.mobile=i.newUser.mobile,a.image=JSON.stringify(s)):a.user_id=i.userinfo.id,!i.hasTrip){a.from_province=i.trip.from.length?i.trip.from[0].name:"",a.from_city=i.trip.from.length?i.trip.from[1].name:"",a.arrival_time=i.trip.date;var o=[];e.each(i.tripNumbers,(function(e){e&&e.val&&o.push(e.val)})),a.number=o.join(",")}a.body_temperature=i.temperature,a.remark=i.remark||"",a.extra_desc=i.extraDesc||"";var n={hasSymptom:"是"===i.health.hasSymptom?1:0};return a.extra=JSON.stringify(n),a.status=i.riskResult.level?1:0,a.risk_level=i.riskResult.level,a.risk_reason=i.riskResult.reason,a.suggestion=i.riskResult.suggestion,a.type={"进场":0,"出场":1}[i.dataType],a.is_rejected=t?1:0,g.a.post("/online/ncov-approach/save",{},a).then((function(e){"ncovEnterScanError"===i.$store.state.global.prevRouter.name?i.$router.go(-2):i.$router.go(-1),f.a.hideLoading()})).catch((function(e){console.error(e),f.a.hideLoading(),f.a.alert(e.errmsg)}))})).catch((function(e){console.error(e),f.a.hideLoading(),f.a.alert(e.errmsg)}))}}}}).call(this,i("391c"))},c070:function(e,t,i){var r=i("574c");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,i("85cb").default)("35590dcb",r,!0,{sourceMap:!1,shadowMode:!1})},e1e7:function(e,t,i){"use strict";(function(e){i("cc57"),i("163d");var r=i("07d2"),a=i("4e8c");t.a={name:"SlideUpSelect",components:{Item:r.a},props:{title:{type:String,default:""},value:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},placeholder:{type:String,default:"请选择"},emptyText:{type:String,default:"暂无数据"},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},showNote:{type:String},allowSearch:{type:Boolean,defalut:!1},initHeight:{type:Number,default:400},historyKey:{type:String,default:"historyHey"}},data:function(){return{isOpen:!1}},computed:{text:function(){return e.isEmpty(this.value)?this.editabled?"":"无":this.value.name}},created:function(){var e=this;a.a.$on("afterClosePopup",(function(){e.isOpen=!1}))},activated:function(){a.a.resultListLimit()},methods:{openSelect:function(){var e=this;a.a.openPopup({title:this.title,options:this.options,selected:this.value,showNote:this.showNote,emptyText:this.emptyText,allowSearch:this.allowSearch,initHeight:this.initHeight,historyKey:this.historyKey,componentUid:this._uid,callback:function(t){e.$emit("input",t),e.$emit("onSelect",t)}}),this.isOpen=!0}}}}).call(this,i("391c"))},ef52:function(e,t,i){"use strict";i.r(t);var r=i("bd68").a,a=(i("5431"),i("f91b"),i("17cc")),s=Object(a.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("page-content",{attrs:{title:e.pageTitle,"show-go-root":!0}},[e.isLoading||e.isExpired?e._e():i("scroller",[e.isNewUser?e._e():i("div",{staticClass:"user-info"},[i("div",{staticClass:"info-left",class:{"no-idcard":!e.userinfo.idcard,"no-mobile":!e.userinfo.mobile}},[i("div",{staticClass:"user-name"},[e._v("\n          "+e._s(e.userinfo.fullname)+"\n        ")]),i("div",{staticClass:"user-line"},[i("span",{directives:[{name:"show",rawName:"v-show",value:e.userinfo.idcard,expression:"userinfo.idcard"}]},[e._v(e._s(e.userinfo.sex)+" ｜ "+e._s(e.userinfo.age)+"岁")]),i("span",{directives:[{name:"show",rawName:"v-show",value:e.userinfo.mobile,expression:"userinfo.mobile"}]},[e._v("｜ "+e._s(e.userinfo.mobile))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.userinfo.idcard,expression:"userinfo.idcard"}],staticClass:"user-line"},[e._v("身份证号码："+e._s(e.userinfo.idcard))])]),i("div",{staticClass:"info-img",style:{"background-image":"url("+e.userinfo.img+")"}})]),e.isNewUser?[i("item",{attrs:{label:"姓名",mode:"edit"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.name,expression:"newUser.name"}],staticClass:"input-align-r f16",attrs:{slot:"right",type:"text",placeholder:"必填"},domProps:{value:e.newUser.name},on:{input:function(t){t.target.composing||e.$set(e.newUser,"name",t.target.value)}},slot:"right"})]),i("item",{attrs:{label:"身份证",mode:"edit"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.idcard,expression:"newUser.idcard"}],staticClass:"input-align-r f16",attrs:{slot:"right",type:"text",placeholder:"必填"},domProps:{value:e.newUser.idcard},on:{input:function(t){t.target.composing||e.$set(e.newUser,"idcard",t.target.value)}},slot:"right"})]),i("item",{attrs:{label:"手机",mode:"edit"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.mobile,expression:"newUser.mobile"}],staticClass:"input-align-r f16",attrs:{slot:"right",type:"text",placeholder:"选填"},domProps:{value:e.newUser.mobile},on:{input:function(t){t.target.composing||e.$set(e.newUser,"mobile",t.target.value)}},slot:"right"})]),i("item",{staticClass:"p15",attrs:{mode:"edit"}},[i("div",{staticClass:"item-con"},[i("p",{staticClass:"mb10"},[e._v("个人照片"),i("span",{staticClass:"color-gray3"},[e._v("(选填)")])]),i("item-img-list",{attrs:{maxlength:1,"allow-select-album":!0,"allow-buildin-album":!0,"online-mode":!0},model:{value:e.newUser.img,callback:function(t){e.$set(e.newUser,"img",t)},expression:"newUser.img"}})],1)])]:e._e(),i("item",{staticClass:"mt10"},[i("div",{staticClass:"item-text"},[e._v("进出场")]),i("div",{staticClass:"item-con"},[i("radio-box",{attrs:{"custom-class":"ncov-radio",options:["进场","出场"]},model:{value:e.dataType,callback:function(t){e.dataType=t},expression:"dataType"}})],1)]),i("item",{staticClass:"mt10",attrs:{text:"出行信息","icon-right":e.isTripOpen?"arrow-up":"arrow-down",border:"bottom"},on:{click:function(t){e.togglePart("isTripOpen")}}},[i("i",{staticClass:"icon-point",attrs:{slot:"icon-left"},slot:"icon-left"})]),e.isTripOpen?[e.hasTrip?[i("item",{staticClass:"detail-line",attrs:{label:"从哪里来",text:e.defaultTrip.from}}),i("item",{staticClass:"detail-line",attrs:{label:"航班/车次/车牌号",text:e.defaultTrip.number}}),i("item",{staticClass:"detail-line",attrs:{label:"到达时间",text:e.defaultTrip.date}})]:[i("item",{attrs:{label:"从哪里来",mode:"edit",editabled:!0,text:e.fromText,placeholder:"选填"},on:{click:e.selectAddress}}),i("item",{staticClass:"mt10 border-bottom"},[i("div",{staticClass:"item-text"},[e._v("\n            航班/车次/车牌号\n            "),i("icon",{staticClass:"f18 color-gray7",attrs:{name:"yiwen"},on:{click:e.numbserTips}})],1),i("div",{staticClass:"item-font color-theme",on:{click:e.addNumber}},[i("icon",{staticClass:"f14 mr5",attrs:{name:"add"}}),e._v("添加\n          ")],1)]),e._l(e.tripNumbers,(function(t,r){return i("item",{key:r,staticClass:"flex-center",attrs:{mode:"edit"}},[i("icon",{staticClass:"ml25 mr20 f18",attrs:{name:"remove"},on:{click:function(t){e.removeNumber(r)}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"number.val"}],staticClass:"f16",attrs:{type:"text",placeholder:"选填",maxlength:"20"},domProps:{value:t.val},on:{input:function(i){i.target.composing||e.$set(t,"val",i.target.value)}}})],1)})),i("date-select",{staticClass:"mt10",attrs:{label:"到达时间",type:"date",format:"YYYY-MM-DD",placeholder:"必填"},model:{value:e.trip.date,callback:function(t){e.$set(e.trip,"date",t)},expression:"trip.date"}})]]:e._e(),i("item",{staticClass:"mt10",attrs:{text:"身体状况","icon-right":e.isHealthOpen?"arrow-up":"arrow-down",border:"bottom"},on:{click:function(t){e.togglePart("isHealthOpen")}}},[i("i",{staticClass:"icon-point",attrs:{slot:"icon-left"},slot:"icon-left"})]),e.isHealthOpen?[i("item",{attrs:{label:"体温(°C)",mode:"edit"}},[i("number-input",{staticClass:"temperature-input",attrs:{slot:"right",decimal:1,range:[30,50],"overflow-auto-recover":!0,placeholder:"必填"},on:{overflowRange:e.onTemperatureOverflow},slot:"right",model:{value:e.temperature,callback:function(t){e.temperature=t},expression:"temperature"}})],1),i("item",[i("div",{staticClass:"item-text"},[e._v("是否出现乏力、咳嗽、发烧、 肌肉酸痛症状")]),i("div",{staticClass:"item-con"},[i("radio-box",{attrs:{"custom-class":"ncov-radio",options:e.hasSymptomOptions},model:{value:e.health.hasSymptom,callback:function(t){e.$set(e.health,"hasSymptom",t)},expression:"health.hasSymptom"}})],1)]),i("item-textarea",{staticClass:"mt10",attrs:{placeholder:"补充说明（选填）"},model:{value:e.extraDesc,callback:function(t){e.extraDesc=t},expression:"extraDesc"}})]:e._e(),i("app-button-group",{staticClass:"mt20"},[i("app-button",{on:{click:e.check}},[e._v("检 测")])],1)],2),e.isExpired?i("loading-status",{attrs:{"is-loading":!1,"is-empty":!0,"empty-text":"二维码已过期",type:"qrcode"}}):i("loading-status",{attrs:{"is-loading":e.isLoading}})],1)}),[],!1,null,"95a8d710",null);t.default=s.exports},f91b:function(e,t,i){"use strict";i("b318")}}]);