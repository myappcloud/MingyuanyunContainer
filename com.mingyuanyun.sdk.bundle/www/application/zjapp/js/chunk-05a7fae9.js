(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-05a7fae9"],{"09ae":function(e,t,a){"use strict";(function(e){a.d(t,"c",(function(){return _})),a.d(t,"a",(function(){return C})),a.d(t,"d",(function(){return S})),a.d(t,"b",(function(){return M}));a("5ab2"),a("cc57");var r=a("28f8"),o=(a("163d"),a("6a61"),a("e697"),a("2e91")),s=(a("e10e"),a("f548"),a("6d57"),a("a044")),n=a("2b66"),u=a("82c5"),l=a("b26e"),m=a("1b7e"),i=a("7bac"),d=a("a7c3"),c=a("6bf2"),h=a.n(c);function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var f=a("8625"),b={};f.keys().forEach((function(e){var t=f(e).default,a=e.replace(/(\.\/|\.js)/g,"");b[a]=t}));var N,g=Object.keys(b).map((function(e){return e.replace("mode-","")}));function v(){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.getHasNetwork();case 2:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:if(t=N){e.next=8;break}return e.abrupt("return",!0);case 8:if(a=Number(t),!isNaN(a)){e.next=12;break}return N="",e.abrupt("return",!0);case 12:return r=h()(a),e.abrupt("return",h()().diff(r,s.c)>s.b);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){var a=t.value;if(a&&"string"==typeof a)try{a=JSON.parse(a)}catch(e){a=null}return e[t.code]=a,e}),{})}function w(){return k.apply(this,arguments)}function k(){return(k=Object(o.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:if(e.sent){e.next=11;break}return e.next=6,i.a.getUserKey(d.a.CUSTOM_LAYOUT_SPECIAL_INSPECT);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0={};case 9:return t=e.t0,e.abrupt("return",t);case 11:return e.next=13,Object(l.c)({codes:g.map((function(e){return s.d+"_"+e}))}).catch((function(){return null}));case 13:if((a=e.sent)&&Array.isArray(a)){e.next=22;break}return e.next=17,i.a.getUserKey(d.a.CUSTOM_LAYOUT_SPECIAL_INSPECT);case 17:if(e.t1=e.sent,e.t1){e.next=20;break}e.t1={};case 20:return t=e.t1,e.abrupt("return",t);case 22:return t=I(a),e.next=25,i.a.setUserKey(d.a.CUSTOM_LAYOUT_SPECIAL_INSPECT,t);case 25:return N=(new Date).getTime(),e.abrupt("return",t);case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return E.apply(this,arguments)}function E(){return(E=Object(o.a)(regeneratorRuntime.mark((function t(a){var r,o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.d+"_"+a,t.next=3,w();case 3:return n=t.sent,o=n[r],((o=y(y({},e.cloneDeep(b["mode-".concat(a)])),o))&&o.tree&&o.tree.btns||[]).forEach((function(e,t){e.index=t})),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(e,t){return F.apply(this,arguments)}function F(){return(F=Object(o.a)(regeneratorRuntime.mark((function t(a,r){var o,s,n,l,m,i,d,c,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=h.length>2&&void 0!==h[2]?h[2]:"edit",t.next=3,_(a);case 3:if(s=t.sent,n={edit:"detailEditForm",view:"detailViewForm"}[o]){t.next=8;break}return t.abrupt("return",[]);case 8:if(l=s&&s[n],m=s&&s.tree&&s.tree.btns||[],i=m[r]&&m[r].formConfig,d={edit:u.a,view:u.b},c=d[o]){t.next=15;break}return t.abrupt("return",[]);case 15:return t.abrupt("return",c.map((function(t){var a=t.name,r=l&&l.find((function(e){return e.name===a})),o=i&&i.find((function(e){return e.name===a})),s=e.mergeWith({},t,r,o,(function(e,t){if(Array.isArray(e))return t}));return e.cloneDeep(s)})));case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function S(t){return e.cloneDeep(n.a.find((function(e){return e.mode===t})))}function M(e){return D.apply(this,arguments)}function D(){return(D=Object(o.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(t);case 2:return a=e.sent,e.abrupt("return",a&&a.navMenu||[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,a("391c"))},"17b9":function(e,t,a){"use strict";a.r(t),t.default={mode:4,name:'可打分，按"权重+得分率"计算总分',navMenu:[{name:"全部问题",code:"allProblem"},{name:"展示描述",code:"toggleDesc"}],totalMode:"batch.template_extension.mode4_passrate_mode",defaultTotalMode:1,tree:{style:"no-point",attrs:[{key:"checkitem_extension",name:"扩展属性",type:"object",pattern:"computed",result:'JSON.parse(checkitem_extension || "{}")'},{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"score",name:"满分汇总-末级算法",type:"number",pattern:"transmit",totalMode:1,match:"!treeNodeIsEnd",filter:"hasData",result:"score || 0"},{key:"deductionLimit",name:"扣分上限汇总-末级算法",type:"number",pattern:"computed",totalMode:1,match:"treeNodeIsEnd",filter:"hasData",result:"Math.max(Number(checkitem_extension.deduction_limit) || 0, score || 0)"},{key:"score",name:"满分汇总-二级算法",type:"number",pattern:"transmit",totalMode:2,match:"treeNodeIsFirst",filter:"hasData",result:"score || 0"},{key:"deduction",name:"扣分汇总-末级算法，取末级的扣分时，要判断不能超过满分",type:"number",pattern:"transmit",totalMode:1,match:"!treeNodeIsEnd",result:"treeNodeIsEnd ? Math.min(deduction || 0,  deductionLimit || 0) : deduction"},{key:"deduction",name:"扣分上限处理-二级算法",type:"number",pattern:"computed",totalMode:2,match:"treeNodeIsEnd && isNumber(checkitem_extension.deduction_limit)",result:"Math.min(deduction || 0, checkitem_extension.deduction_limit)"},{key:"deduction",name:"扣分汇总-二级算法",type:"number",pattern:"transmit",totalMode:2,match:"!treeNodeIsEnd",result:"deduction || 0"},{key:"deduction",name:"扣分汇总-二级算法，二级检查项满分判断",type:"number",pattern:"computed",totalMode:2,match:"treeNodeLevel === 1",result:"isNumber(score) ? Math.min(deduction || 0, score) : (deduction || 0)"},{key:"scoreRate",name:"一级检查项得分率",type:"number",pattern:"computed",match:"treeNodeIsFirst",result:"score === 0 ? 0 : (score - deduction) / score"},{key:"problemNum",name:"问题总数",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"problemNum || 0"},{key:"weight",name:"权重",type:"number",pattern:"computed",result:"parseFloat(weight) || 0"}],notes:[{text:"({{ weight || 0 }}%)",color:"balck",show:"treeNodeIsFirst"},{text:"({{ score || 0 }}分)",color:"gray3",show:"!treeNodeIsFirst && treeNodeIsEnd",totalMode:1},{text:"({{ score || 0 }}分)",color:"gray3",show:"treeNodeLevel === 1",totalMode:2}],infos:[{text:"未检",color:"gray3",show:"treeNodeIsFirst && !hasData"},{text:"-{{ deduction }}分",color:"red",show:"treeNodeIsFirst && hasData"},{text:"{{ percent(scoreRate, 2) }}",color:"red",show:"treeNodeIsFirst && hasData"},{text:"{{ status }}",type:"status",show:'status === "合格"'},{text:"-{{ deduction || 0 }}分",color:"red",show:'status === "不合格"',totalMode:1},{text:"{{ problemNum }}个问题",color:"gray3",show:'treeNodeIsEnd && problemNum && status !== "合格"',totalMode:1},{text:"-{{ deduction || 0 }}分",color:"red",show:'!treeNodeIsFirst && hasData && status !== "合格"',totalMode:2},{text:"{{ problemNum }}个问题",color:"gray3",show:'!treeNodeIsFirst && hasData && status !== "合格"',totalMode:2}],icons:[{name:"mark",show:"treeNodeIsEnd && is_redline_deduction",totalMode:2}],btns:[{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && status !== "合格" && !problemNum',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]},{name:"合格",show:'!treeNodeIsFirst && treeNodeIsEnd && status !== "合格" && !problemNum',operate:"change-status",value:"合格"}]},total:{title:"当前综合得分",note:"",calc:[{key:"scoreWeightSum",name:"得分率*权重之和",match:"treeNodeIsFirst && hasData",value:"scoreRate * weight",text:"{{percent(scoreRate, 2)}} * {{weight || 0}}%"},{key:"weightSum",name:"权重之和",match:"treeNodeIsFirst && hasData",value:"weight",text:"{{weight || 0}}%"},{key:"redlineDeduction",name:"红线扣分",match:"treeNodeIsEnd && hasData",value:"redline_deduction",text:"{{redline_deduction}}"},{key:"doneCount",name:"已检数量",match:"treeNodeIsEnd && hasData",value:"1"}],result:"batch.template_extension.mode4_passrate_mode === 2 ?  Math.max((weightSum.value ? scoreWeightSum.value / weightSum.value : 0) - redlineDeduction.value * 0.01, 0): (weightSum.value ? scoreWeightSum.value / weightSum.value : 0) - redlineDeduction.value * 0.01",hasResult:'batch.status === "检查完毕" || Boolean(doneCount.value)',resultType:"percent",formula:"综合得分=(已检查的一级检查项得分率的加权平均-红线扣分*0.01)*100%",formulaCalc:"=(({{scoreWeightSum.text}})/({{weightSum.text}})-{{redlineDeduction.value}}*0.01)*100%={{result}}",formulaText:"{{formula}}{{formulaCalc}}"}}},"1def":function(e,t,a){"use strict";a.r(t),t.default={mode:5,name:"可打分，按满分减扣分计算总分",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{attrs:[{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"deduction",name:"扣分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"deduction || 0"},{key:"problemNum",name:"问题数量-非末级",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"problemNum"}],infos:[{text:"-{{ deduction > score ? score : deduction }}分",color:"red",show:"treeNodeIsFirst && (problemNum || hasData)"},{text:"满分{{ score || 0 }}",color:"gray3",show:{treeNodeIsFirst:!0}},{text:"{{ status }}",type:"status",show:{status:"合格"}},{text:"-{{ deduction || 0 }}分",color:"red",show:{status:"不合格"}},{text:"{{ problemNum }}个问题",color:"gray3",show:'!treeNodeIsFirst && treeNodeIsEnd && problemNum && status !== "不合格"'}],btns:[{name:"合格",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"change-status",value:"合格"},{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:"当前综合得分",note:"",calc:[{key:"scoreSum",name:"总满分",match:"treeNodeIsFirst",value:"score",text:"{{score }}"},{key:"deductionSum",name:"总扣分",match:"treeNodeIsFirst && hasData",value:"deduction > score ? score : deduction",text:"{{deduction > score ? score : deduction}}"}],result:"scoreSum.value - deductionSum.value",hasResult:"Boolean(scoreSum.value)",resultType:"number",numberFixed:!1,formula:"得分=总满分-总扣分",formulaCalc:"=({{scoreSum.text}})-({{deductionSum.text || 0}})={{result}}",formulaText:"{{formula}}{{formulaCalc}}\n需至少检查一项，记录合格或扣分，批次创建人才能最终结束并提交"},finishBatchCheck:[{isFilterFirst:!1,statusTotalConfig:[{status:"合格",key:"a"},{status:"不合格",key:"b"}],match:"a + b <= 0",msg:"您未录入任何检查项的检查记录，请录入后再提交"}]}},"2bec":function(e,t,a){"use strict";a.r(t),t.default={mode:9,name:"得分率（打分制）",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{style:"no-point",infos:[{text:"{{ level }}",color:"gray",show:{treeNodeIsEnd:!0,status:"检查完毕"}},{text:"{{ reward }}分",color:"gray",show:{treeNodeIsEnd:!0,status:"检查完毕"}},{text:"{{ status }}",type:"status",show:'treeNodeIsEnd && status !== "检查完毕" && status !== "未设置" && status !== "已甩项"'},{text:"{{ status }}",type:"status",show:'treeNodeIsEnd && status === "已甩项" && !editable'}],btns:[{name:"登记",show:{treeNodeIsEnd:!0,status:"未设置"},operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]},{name:"甩项",show:{treeNodeIsEnd:!0,status:"未设置"},operate:"change-status",value:"已甩项"},{name:"取消甩项",show:{treeNodeIsEnd:!0,status:"已甩项"},operate:"change-status",value:"未设置"}]},total:{title:"当前综合得分",calc:[{key:"rewardSum",name:"已检项的实得分之和",match:'treeNodeIsEnd && status === "检查完毕"',value:"reward || 0"},{key:"scoreSum",name:"已检项应得满分之和",match:'treeNodeIsEnd && status === "检查完毕"',value:"score || 0"},{key:"doneCount",name:"已测数量",match:'treeNodeIsEnd && status === "检查完毕"',value:"1"}],result:"scoreSum.value ? rewardSum.value / scoreSum.value : 0",hasResult:'batch.status === "检查完毕" || Boolean(doneCount.value)',resultType:"percent",formula:"综合得分 =（已检项的实得分之和 / 已检项应得满分之和）*100%",formulaCalc:"=({{rewardSum.value}}/{{scoreSum.value}})*100%={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},finishBatchCheck:[{isFilterFirst:!1,statusTotalConfig:[{status:"未设置",key:"a"},{status:"草稿",key:"b"}],match:"a + b > 0",type:"notify",msg:"有未检查的检查项，请检查完之后重试"}]}},7965:function(e,t,a){"use strict";a.r(t),t.default={mode:8,name:"质量风险",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{style:"no-point",attrs:[{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"temporary_storage",name:"暂存的问题数量",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"temporary_storage || 0"},{key:"deduction",name:"扣分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"deduction || 0"},{key:"scoreCount",name:"参与计算的总分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"treeNodeIsEnd ? (hasData ? score : 0) : (scoreCount || 0)"},{key:"scoreRate",name:"得分率",type:"number",pattern:"computed",match:"treeNodeIsFirst",result:'hasData ? (scoreCount - deduction) / scoreCount : ""'}],notes:[{text:"({{score}}分)",color:"gray3",show:{treeNodeIsEnd:!0,treeNodeIsFirst:!1}}],infos:[{text:"暂存",color:"orange",show:"!!temporary_storage"},{text:"-{{deduction}}分",color:"red",show:"treeNodeIsFirst && hasData && !temporary_storage"},{text:"{{ percent(scoreRate, 2) }}",color:"gray3",show:"treeNodeIsFirst && hasData && !temporary_storage"},{text:"未检",color:"gray3",show:"treeNodeIsFirst && !hasData && !temporary_storage"},{text:"-{{deduction}}分",color:"red",show:'treeNodeIsEnd && status === "不合格" && !temporary_storage'},{text:"{{problem_num}}个问题",color:"gray3",show:'treeNodeIsEnd && status === "不合格" && !temporary_storage'},{text:"{{ status }}",type:"status",show:'treeNodeIsEnd && status === "合格" && !temporary_storage'}],icons:[{name:"mark",show:"treeNodeIsEnd && is_redline_deduction"}],btns:[{name:"合格",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置",temporary_storage:0},operate:"change-status",value:"合格"},{name:"扣分",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置",temporary_storage:0},operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:"当前综合得分",calc:[{key:"scoreSum",name:"已检项的应得分",match:"treeNodeIsFirst && hasData",value:"scoreCount"},{key:"deductionSum",name:"扣分值",match:"treeNodeIsFirst && hasData",value:"deduction"},{key:"redlineDeductionACount",name:"星标项A级扣分的数量",match:'treeNodeIsEnd && hasData && is_redline_deduction && deduction_level === "A"',value:"1"},{key:"redlineDeductionBCount",name:"星标项B级扣分的数量",match:'treeNodeIsEnd && hasData && is_redline_deduction && deduction_level === "B"',value:"1"},{key:"redlineDeductionCCount",name:"星标项C级扣分的数量",match:'treeNodeIsEnd && hasData && is_redline_deduction && deduction_level === "C"',value:"1"}],result:"(scoreSum.value - deductionSum.value) / scoreSum.value - (((redlineDeductionACount.value < (batch.template_extension.A_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionACount.value, batch.template_extension.A_valid_max || Infinity)) * (batch.template_extension.A || 0)) + ((redlineDeductionBCount.value < (batch.template_extension.B_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionBCount.value, batch.template_extension.B_valid_max || Infinity)) * (batch.template_extension.B || 0)) + ((redlineDeductionCCount.value < (batch.template_extension.C_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionCCount.value, batch.template_extension.C_valid_max || Infinity)) * (batch.template_extension.C || 0))) * 0.01",hasResult:"Boolean(scoreSum.value)",resultType:"percent",formula:"综合得分 =（（已检项的应得分-扣分值）/应得分-星标项的加扣分值*0.01）*100%",formulaCalc:"=(({{scoreSum.value}}-{{deductionSum.value}})/{{scoreSum.value}}-{{((redlineDeductionACount.value < (batch.template_extension.A_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionACount.value, batch.template_extension.A_valid_max || Infinity)) * (batch.template_extension.A || 0)) + ((redlineDeductionBCount.value < (batch.template_extension.B_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionBCount.value, batch.template_extension.B_valid_max || Infinity)) * (batch.template_extension.B || 0)) + ((redlineDeductionCCount.value < (batch.template_extension.C_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionCCount.value, batch.template_extension.C_valid_max || Infinity)) * (batch.template_extension.C || 0))}}*0.01)*100%={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},finishBatchCheck:[{isFilterFirst:!1,statusTotalConfig:[{status:"合格",key:"a"},{status:"不合格",key:"b"}],match:"a + b <= 0",msg:"您未录入任何检查项的检查记录，请录入后再提交"}]}},"82c5":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var r=[{id:"title",name:"title",type:"text",isExtend:!0,display:!0,label:"",value:"检查项名称",extendOptions:{border:"bottom",fontSize:16,color:"#333",weight:500}},{id:"rule",name:"rule",isExtend:!0,type:"text",label:"",value:"检查项规则",display:!1,extendOptions:{border:"bottom",fontSize:14,color:"#999"}},{id:"status",type:"radio",label:"检查结果",name:"status",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[{key:"不合格",label:"不合格"}],itemLayout:"horizontal",options:[{key:"不合格",label:"不合格"},{key:"合格",label:"合格"}],relations:[]},{id:"divider",type:"divider",label:"分割线",name:"divider",display:!0,height:"10"},{id:"deduction",name:"deduction",label:"扣分",value:"",isExtend:!0,type:"number-input",extendOptions:{decimal:2,range:[0,999999.99],unit:"分",mode:"edit"},display:!0,required:!0,rules:[{pattern:/^[+-]?(0|([1-9]\d*))(\.\d+)?$/,message:"请输入扣分"}],relations:[{type:"formula",func:"DISPLAY([#{status},不合格,=])"}]},{id:"images",name:"images",label:"",value:[],isExtend:!0,type:"images",extendOptions:{maxlength:15},display:!0},{id:"remark",name:"remark",label:"",value:"",isExtend:!0,type:"textarea",extendOptions:{placeholder:"补充说明"},display:!0}],o=[{id:"title",name:"title",type:"text",isExtend:!0,display:!0,label:"",value:"检查项名称",extendOptions:{border:"bottom",fontSize:16,color:"#333",weight:500}},{id:"rule",name:"rule",isExtend:!0,type:"text",label:"",value:"检查项规则",display:!1,extendOptions:{border:"bottom",fontSize:14,color:"#999"},relations:[{type:"formula",func:"DISPLAY([#{rule},,=])"}]},{id:"status",name:"status",isExtend:!0,type:"text",label:"检查结果",extendOptions:{mode:"edit"},display:!0,value:""},{id:"divider",type:"divider",label:"分割线",name:"divider",display:!0,height:"10"},{id:"deduction",name:"deduction",label:"扣分",value:"",isExtend:!0,type:"text",display:!0,extendOptions:{mode:"edit"},relations:[{type:"formula",func:"DISPLAY([#{status},不合格, =])"}]},{id:"images",name:"images",label:"",value:[],isExtend:!0,type:"images",disabled:!0,extendOptions:{maxlength:15},display:!0},{id:"remark",name:"remark",label:"补充说明",value:"",isExtend:!0,type:"text",display:!0}]},8625:function(e,t,a){var r={"./mode-1.js":"b464","./mode-10.js":"def6","./mode-100.js":"b48c","./mode-11.js":"c1d9","./mode-2.js":"bfb1","./mode-3.js":"a2fc","./mode-4.js":"17b9","./mode-5.js":"1def","./mode-6.js":"879f","./mode-7.js":"f6b4f","./mode-8.js":"7965","./mode-9.js":"2bec","./mode-99.js":"e8cb"};function o(e){var t=s(e);return a(t)}function s(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=s,e.exports=o,o.id="8625"},"879f":function(e,t,a){"use strict";a.r(t),t.default={mode:6,name:"合同巡检",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{attrs:[{key:"unqualifiedItemNum",name:"不合格的项数",type:"number",pattern:"computed",match:"treeNodeIsEnd",result:'status === "不合格" ? 1 : 0'},{key:"unqualifiedItemNum",name:"不合格的项数",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"unqualifiedItemNum || 0"},{key:"status",name:"状态 status 处理，保存草稿时，没有修改 speical_inspect 表的状态",type:"string",pattern:"computed",match:"treeNodeIsEnd",result:'{{status === "未设置" && problem_id ? "草稿" : status }}'}],infos:[{text:"{{ unqualifiedItemNum }}项不合格",color:"gray3",show:{treeNodeIsFirst:!0}},{text:"{{ status }}",type:"status",show:'treeNodeIsEnd && status !== "未设置"'}],btns:[{name:"合格",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"change-status",value:"合格"},{name:"不合格",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:'{{batch.status === "检查中" ? "当前" : ""}}合格率',note:"{{unqualifiedCount.value}}项不合格",calc:[{key:"unqualifiedCount",name:"不合格项数",match:'treeNodeIsEnd && status === "不合格"',value:"1"},{key:"qualifiedCount",name:"参与检查的合格项数",match:'treeNodeIsEnd && status === "合格"',value:"1"},{key:"count",name:"参与检查的全部项数",match:'treeNodeIsEnd && (status === "合格" || status === "不合格")',value:"1"}],result:"qualifiedCount.value / count.value",hasResult:"Boolean(count.value)",resultType:"percent",formula:"合格率=参与检查的合格项数/参与检查的全部项数*100%",formulaCalc:"={{qualifiedCount.value}}/{{count.value}}*100%={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},finishBatchCheck:[{isFilterFirst:!0,statusTotalConfig:[{status:"合格",key:"a"},{status:"不合格",key:"b"}],match:"a + b <= 0",type:"notify",msg:"至少有一项检查记录"}]}},a2fc:function(e,t,a){"use strict";a.r(t),t.default={mode:3,name:"可打分，按得分率计算总分",navMenu:[{name:"全部问题",code:"allProblem"}],totalMode:"batch.template_extension.mode3_fling_mode",defaultTotalMode:1,tree:{attrs:[{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",totalMode:2,match:"treeNodeIsEnd",result:'status !== "已甩项" && !treeNodeIsFirst'},{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",totalMode:1,match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"hasCheck",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",totalMode:2,match:"treeNodeIsEnd",result:'status !== "未设置"'},{key:"hasCheck",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",totalMode:2,match:"!treeNodeIsEnd",result:"hasCheck"},{key:"hasScore",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",totalMode:2,match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasScore",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",totalMode:2,match:"!treeNodeIsEnd",result:"hasScore"},{key:"problemNum",name:"问题数量-非末级",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"problemNum"},{key:"score",name:"满分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",filter:"hasData",result:"score || 0"},{key:"deduction",name:"扣分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"Math.min(deduction, score)"},{key:"scoreRate",name:"得分率",type:"number",pattern:"computed",match:"treeNodeIsFirst",result:'hasData ? (score - deduction) / score : ""'}],notes:[{text:"({{ score || 0 }}分)",color:"gray3",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0}}],infos:[{text:"-{{ deduction > score ? score : deduction }}分",color:"red",show:"treeNodeIsFirst && (problemNum || hasData) && hasScore",totalMode:2},{text:"{{ percent(scoreRate, 2) }}",color:"red",show:"treeNodeIsFirst && (problemNum || hasData) && hasScore",totalMode:2},{text:"未检",color:"gray3",show:"treeNodeIsFirst && !problemNum && !hasCheck",totalMode:2},{text:"-{{ deduction > score ? score : deduction }}分",color:"red",show:"treeNodeIsFirst && (problemNum || hasData)",totalMode:1},{text:"{{ percent(scoreRate, 2) }}",color:"red",show:"treeNodeIsFirst && (problemNum || hasData)",totalMode:1},{text:"未检",color:"gray3",show:'treeNodeIsFirst && !problemNum && !hasData && batch.status !== "检查完毕"',totalMode:1},{text:"{{ status }}",type:"status",show:{status:"合格"}},{text:"{{ status }}",type:"status",show:'status==="已甩项"&& treeNodeIsEnd && batch.status === "检查完毕"'},{text:"-{{ deduction || 0 }}分",color:"red",show:{status:"不合格"}},{text:"{{ problemNum }}个问题",color:"gray3",show:"!treeNodeIsFirst && treeNodeIsEnd && problemNum",totalMode:2},{text:"{{ problemNum }}个问题",color:"gray3",show:'!treeNodeIsFirst && treeNodeIsEnd && problemNum && status !== "合格"',totalMode:1}],btns:[{name:"合格",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"change-status",value:"合格",totalMode:1},{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status === "未设置"',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}],totalMode:2},{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}],totalMode:1},{name:"甩项",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"change-status",value:"已甩项",tips:"甩项成功",totalMode:2},{name:"取消甩项",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"已甩项"},operate:"change-status",value:"未设置",tips:"取消甩项",totalMode:2}]},total:{title:"当前综合得分",note:"",calc:[{key:"numerator",name:"得分之和（分子）",match:"treeNodeIsFirst && hasData",value:"score - deduction",text:"{{score - deduction}}"},{key:"denominator",name:"满分之和（分母）",match:"treeNodeIsFirst && hasData",value:"score",text:"{{score}}"}],result:"denominator.value ? numerator.value / denominator.value : 0",hasResult:'batch.status === "检查完毕" || Boolean(denominator.value)',resultType:"percent",formula:"得分＝检查过的项目得分之和/检查过的项目满分之和*100%",formulaCalc:"=\n{{numerator.value}}/{{denominator.value}}*100%={{result}}",formulaText:"{{formula}}{{formulaCalc}}"}}},b464:function(e,t,a){"use strict";a.r(t),t.default={mode:1,name:"可打分，按权重计算总分",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{attrs:[{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"deduction",name:"扣分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"deduction || 0"},{key:"deduction",name:"扣分，不超总分",type:"number",pattern:"computed",totalMode:1,match:"treeNodeIsFirst",result:"Math.min(deduction || 0, score || 0)"},{key:"problemNum",name:"问题数量-非末级",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"problemNum"}],infos:[{text:"-{{ deduction > score ? score : deduction }}分",color:"red",show:"treeNodeIsFirst && (problemNum || hasData)"},{text:"满分{{ score || 0 }}",color:"gray3",show:{treeNodeIsFirst:!0}},{text:"{{ status }}",type:"status",show:{status:"合格"}},{text:"-{{ deduction || 0 }}分",color:"red",show:{status:"不合格"}},{text:"{{ problemNum }}个问题",color:"gray3",show:'!treeNodeIsFirst && treeNodeIsEnd && problemNum && status !== "合格"'}],btns:[{name:"合格",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"change-status",value:"合格"},{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:"当前综合得分",note:"",calc:[{key:"numerator",name:"得分*权重（分子）",match:"treeNodeIsFirst && hasData",value:"(score - deduction) * weight / 100",text:"{{score - deduction}}*{{weight}}%"},{key:"denominator",name:"权重（分母）",match:"treeNodeIsFirst && hasData",value:"weight / 100",text:"{{weight}}%"}],result:"numerator.value / denominator.value",hasResult:"Boolean(denominator.value)",resultType:"number",formula:"得分=∑（有记录的一级检查项得分*该项权重）/∑（有记录的一级检查项权重）",formulaCalc:"=({{numerator.text}})/({{denominator.text}})={{result}}",formulaText:"{{formula}}{{formulaCalc}}"},detailEditForm:[{name:"deduction",label:"倒扣分"}],detailViewForm:[],problemForm:[]}},b48c:function(e,t,a){"use strict";a.r(t),t.default={mode:100,name:"组合嵌套模板",totalMode:"batch.template_extension.total_score_algorithm",defaultTotalMode:1,tree:{attrs:[{key:"algorithm",name:"当前层级算法",pattern:"computed",match:"template_mode === 100",result:"template_extension && template_extension.total_score_algorithm || 1"},{key:"scoreWeightSum",name:"子级“得分*权重”总和",type:"number",pattern:"transmit",match:"template_mode === 100",filter:"hasVal(score)",result:"parseFloat(score) / 100 * parseFloat(weight) / 100"},{key:"scoreWeightSumText",name:"子级“得分*权重”总和，文本",type:"string",pattern:"transmit",match:"template_mode === 100",filter:"hasVal(score)",result:"{{percent(parseFloat(score) / 100, 2)}} * {{weight}}%"},{key:"weightSum",name:"子级“权重”总和",type:"number",pattern:"transmit",match:"template_mode === 100 && algorithm === 2",filter:"hasVal(score)",result:"parseFloat(weight) / 100"},{key:"weightSumText",name:"子级“权重”总和，文本",type:"string",pattern:"transmit",match:"template_mode === 100 && algorithm === 2",filter:"hasVal(score)",result:"{{weight}}%"},{key:"score",name:"当前层级得分-加权",pattern:"computed",match:"template_mode === 100 && algorithm === 1",result:"percent(scoreWeightSum, 2)"},{key:"score",name:"当前层级得分-加权平均",pattern:"computed",match:"template_mode === 100 && algorithm === 2",result:"percent(scoreWeightSum / weightSum, 2)"},{key:"score",name:"得分，百分比显示规范",pattern:"computed",match:'template_mode !== 100 && hasVal(score) && socre.substr(-1) === "%"',result:"percent(parseFloat(score) / 100, 2)"},{key:"formula",name:"得分公式-加权",type:"string",pattern:"computed",match:"template_mode === 100 && algorithm === 1",result:"得分=组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n"},{key:"formulaClac",name:"得分公式-加权，计算过程",type:"string",pattern:"computed",match:"template_mode === 100 && algorithm === 1 && hasVal(score)",result:"={{scoreWeightSumText}}={{score}}"},{key:"formula",name:"得分公式-加权平均",type:"string",pattern:"computed",match:"template_mode === 100 && algorithm === 2",result:"得分=（组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n）/（权重1+权重2+...+权重n）"},{key:"formulaClac",name:"得分公式-加权平均，计算过程",type:"string",pattern:"computed",match:"template_mode === 100 && algorithm === 2 && hasVal(score)",result:"=({{scoreWeightSumText}})/{{weightSumText}}={{score}}"}]},total:[{totalMode:1,title:"总得分",calc:[{key:"scoreWeightSum",name:"得分*权重总和",match:"treeNodeIsFirst && hasVal(score)",value:"parseFloat(score) / 100 * parseFloat(weight) / 100",text:"{{percent(parseFloat(score) / 100, 2)}} * {{weight}}%"},{key:"doneCount",name:"完成检查的数量",match:"treeNodeIsFirst && hasVal(score)",value:"1"}],result:"scoreWeightSum.value",hasResult:"Boolean(doneCount)",resultType:"percent",formula:"得分=组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n",formulaCalc:"={{scoreWeightSum.text}}={{result}}",formulaText:"{{formula}}{{formulaCalc}}"},{totalMode:2,title:"总得分",calc:[{key:"scoreWeightSum",name:"得分*权重总和",match:"treeNodeIsFirst && hasVal(score)",value:"parseFloat(score) / 100 * parseFloat(weight) / 100",text:"{{percent(parseFloat(score) / 100, 2)}} * {{weight}}%"},{key:"weightSum",name:"权重总和",match:"treeNodeIsFirst && hasVal(score)",value:"parseFloat(weight) / 100",text:"{{weight}}%"},{key:"doneCount",name:"完成检查的数量",match:"treeNodeIsFirst && hasVal(score)",value:"1"}],result:"scoreWeightSum.value / weightSum.value",hasResult:"Boolean(doneCount)",resultType:"percent",formula:"得分=（组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n）/（权重1+权重2+...+权重n）",formulaCalc:"=({{scoreWeightSum.text}})/({{weightSum.text}})={{result}}",formulaText:"{{formula}}{{formulaCalc}}"}]}},bfb1:function(e,t,a){"use strict";a.r(t),t.default={mode:2,name:"无打分，仅记录是否合格，计算合格率",tree:{attrs:[{key:"status",name:"草稿状态处理，不合格的草稿状态保存在 problem，没有存在检查项",type:"string",pattern:"computed",match:'treeNodeIsEnd && status === "未设置" && problem_id',result:"草稿"},{key:"qualifiedNum",name:"合格的数量-末级",type:"number",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" ? 1 : 0'},{key:"qualifiedNum",name:"合格的数量-非末级",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"qualifiedNum"},{key:"unqualifiedNum",name:"不合格的数量",type:"number",pattern:"computed",match:"treeNodeIsEnd",result:'status === "不合格" ? 1 : 0'},{key:"unqualifiedNum",name:"不合格的数量",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"unqualifiedNum"}],infos:[{text:"{{ unqualifiedNum || 0 }}项不合格",color:"gray3",show:{treeNodeIsFirst:!0}},{text:"{{ status }}",type:"status",show:'status !== "未设置" && status !== "已甩项"'},{text:"{{ status }}",type:"status",show:'!editable && status === "已甩项"'}],btns:[{name:"登记",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"route-to-edit"},{name:"甩项",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"change-status",value:"已甩项",tips:"甩项成功"},{name:"取消甩项",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"已甩项"},operate:"change-status",value:"未设置",tips:"取消甩项"}]},total:{title:"当前合格率",note:"{{ unqualifiedNum.value }}项不合格",calc:[{key:"qualifiedNum",name:"合格项总数",match:"treeNodeIsFirst",value:"qualifiedNum",text:"{{qualifiedNum}}"},{key:"unqualifiedNum",name:"不合格项数",match:"treeNodeIsFirst",value:"unqualifiedNum",text:"{{unqualifiedNum}}"}],result:"Boolean(qualifiedNum.value + unqualifiedNum.value) ? qualifiedNum.value / (qualifiedNum.value + unqualifiedNum.value) : 0",hasResult:'batch.status === "检查完毕" ? true : Boolean(qualifiedNum.value + unqualifiedNum.value)',resultType:"percent",formula:"合格率=合格项总数/（合格项数+不合格项数）*100%",formulaCalc:"={{qualifiedNum.value}}/{{qualifiedNum.value + unqualifiedNum.value}}*100%={{result}}",formulaText:"{{formula}}{{formulaCalc}}"},detailEditForm:[{name:"deduction",display:!1,relations:[]}],finishBatchCheck:[{isFilterFirst:!0,statusTotalConfig:[{status:"未设置",key:"a"},{status:"草稿",key:"b"}],match:"a + b > 0",msg:"有未检查的检查项，请检查完之后重试"}],detailViewForm:[],problemForm:[]}},c1d9:function(e,t,a){"use strict";a.r(t),t.default={mode:11,name:"观感效果",navMenu:[{name:"全部问题",code:"allProblem"}],detailEditForm:[{name:"rule",display:!0}],detailViewForm:[{name:"rule",display:!0}]}},def6:function(e,t,a){"use strict";a.r(t),t.default={mode:10,name:"加/扣分",navMenu:[{name:"全部问题",code:"allProblem",match:"batch.template_extension.score_mode === 2"}],totalMode:"batch.template_extension.score_mode",defaultTotalMode:1,tree:{attrs:[{key:"deduction",name:"扣分/加分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"deduction || 0"}],infos:[{text:"{{ status }}",type:"status",show:'status === "草稿"'},{totalMode:1,text:'{{deduction ? "+" : ""}}{{ deduction }}',color:"gray",show:"treeNodeIsFirst && !treeNodeIsEnd"},{totalMode:2,text:'{{deduction ? "-" : ""}}{{ deduction }}',color:"gray",show:"treeNodeIsFirst && !treeNodeIsEnd"},{totalMode:1,text:"+{{ deduction }}",color:"green",show:'treeNodeIsEnd && status !== "草稿" && status !== "未设置"'},{totalMode:2,text:"-{{ deduction }}",color:"red",show:'treeNodeIsEnd && status !== "草稿" && status !== "未设置"'}],btns:[{name:"打分",show:{treeNodeIsEnd:!0,status:"未设置"},operate:"route-to-edit"}]},total:[{totalMode:1,title:"当前综合得分",calc:[{key:"deductionSum",name:"加分值之和",match:'treeNodeIsEnd && status !== "未设置" && status !== "草稿"',value:"deduction"},{key:"doneCount",name:"已测的数量",match:'status !== "未设置" && status !== "草稿"',value:"1"}],result:"deductionSum.value",hasResult:'batch.status === "检查完毕" || Boolean(doneCount.value)',resultType:"number",numberFixed:!1,formula:"当前综合得分=加分值之和",formulaCalc:"={{result}}",formulaText:"{{formula}}{{formulaCalc}}"},{totalMode:2,title:"当前综合得分",calc:[{key:"deductionSum",name:"扣分值之和",match:'treeNodeIsEnd && status !== "未设置" && status !== "草稿"',value:"deduction"},{key:"doneCount",name:"已测的数量",match:'status !== "未设置" && status !== "草稿"',value:"1"}],result:"-deductionSum.value",hasResult:'batch.status === "检查完毕" || Boolean(doneCount.value)',resultType:"number",numberFixed:!1,formula:"当前综合得分=扣分值之和",formulaCalc:"={{result}}",formulaText:"{{formula}}{{formulaCalc}}"}]}},e8cb:function(e,t,a){"use strict";a.r(t),t.default={mode:99,name:"组合模板",totalMode:"batch.template_extension.total_score_algorithm",defaultTotalMode:1,total:[{totalMode:1,title:"总得分",note:'{{hasResult ? "" : "未检查完毕"}}',calc:[{key:"scoreWeight",name:"得分*权重总和",match:'status === "检查完毕"',value:"(parseFloat(score) || 0) / 100 * weight / 100",text:'{{(score.includes("%") ? score : score + "%")}}*{{weight}}%'},{key:"finishCount",name:"检查完毕的数量",match:'status === "检查完毕"',value:"1"}],result:"scoreWeight.value",hasResult:"Boolean(finishCount.value)",resultType:"percent",formula:"总分=得分1*权重1+...+得分n*权重n",formulaCalc:"=({{scoreWeight.text}})={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},{totalMode:2,title:"总得分",note:'{{hasResult ? "" : "未检查完毕"}}',calc:[{key:"scoreWeight",name:"得分*权重总和",match:'status === "检查完毕"',value:"(parseFloat(score) || 0) / 100 * weight / 100",text:'{{(score.includes("%") ? score : score + "%")}}*{{weight}}%'},{key:"weightSum",name:"权重总和",match:'status === "检查完毕"',value:"weight / 100",text:"{{weight}}%"},{key:"finishCount",name:"检查完毕的数量",match:'status === "检查完毕"',value:"1"}],result:"scoreWeight.value / weightSum.value",hasResult:"Boolean(finishCount.value)",resultType:"percent",formula:"总分 = (得分1*权重1+...+得分n*权重n) / (权重1+…+权重n)",formulaCalc:"=({{scoreWeight.text}}) / ({{weightSum.text}})={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"}]}},f6b4f:function(e,t,a){"use strict";a.r(t),t.default={mode:7,name:"实测实量",totalMode:"batch.template_extension.pass_rate_mode",defaultTotalMode:1,tree:{style:'{{batch.status === "检查完毕" ? "finished" : "default"}}',attrs:[{key:"weight",name:"权重",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"weight || 0",totalMode:3},{key:"measurement_points",name:"实测点数",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:'treeNodeIsEnd && status !== "检查完毕" ? 0 : measurement_points || 0'},{key:"problem_points",name:"问题点数",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:'treeNodeIsEnd && status !== "检查完毕" ? 0 : problem_points || 0'},{key:"passrate",name:"合格率",type:"number",pattern:"computed",result:'measurement_points ? (measurement_points - problem_points) / measurement_points : ""'},{key:"passrateWeightSum",name:"合格率*权重 汇总",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",filter:"measurement_points",result:"passrate * (weight || 0) / 100",totalMode:3},{key:"weightSum",name:"权重 汇总",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",filter:"measurement_points",result:"(weight || 0) / 100",totalMode:3}],notes:[{text:"({{ weight || 0 }}%)",color:"black",show:"treeNodeIsFirst",totalMode:2},{text:"({{ weight || 0 }}%)",color:'{{batch.status === "检查中" || treeNodeIsFirst ? "black" : "gray"}}',totalMode:3}],infos:[{text:"{{ percent(passrate, 2) }}",color:'{{batch.status === "检查中" ? "gray" : "black"}}',show:"treeNodeIsFirst",totalMode:1},{text:"{{ percent(passrate, 2) }}",color:'{{batch.status === "检查中" ? "gray" : "black"}}',show:"treeNodeIsFirst",totalMode:2},{text:"{{ percent(passrateWeightSum / weightSum, 2) }}",color:'{{batch.status === "检查中" ? "gray" : "black"}}',show:"treeNodeIsFirst && measurement_points",totalMode:3},{text:"暂存",color:"orange",show:'treeNodeIsEnd && status === "检查中"'},{text:"{{percent(passrate, 2)}}",color:'{{batch.status === "检查中" ? "gray" : "black"}}',show:'treeNodeIsEnd && status === "检查完毕"'}]},total:[{totalMode:1,title:'{{batch.status === "检查中" ? "当前" : ""}}合格率',calc:[{key:"measurement_points",name:"总实测点数",match:'treeNodeIsEnd && status === "检查完毕"',value:"measurement_points",text:"{{measurement_points}}"},{key:"qualified_points",name:"总合格点数",match:'treeNodeIsEnd && status === "检查完毕"',value:"measurement_points - problem_points",text:"{{measurement_points - problem_points}}"}],result:"qualified_points.value / measurement_points.value",hasResult:"Boolean(measurement_points.value)",resultType:"percent",formula:"总合格率=总合格点数/总实测点数*100%",formulaCalc:"={{qualified_points.value}}/{{measurement_points.value}}*100%={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},{totalMode:2,title:'{{batch.status === "检查中" ? "当前" : ""}}合格率',calc:[{key:"passrateWeightSum",name:"一级检查项合格率*权重和",match:"treeNodeIsFirst && measurement_points",value:"passrate * (weight || 0) / 100",text:"{{percent(passrate, 2)}}*{{weight || 0}}%"},{key:"weightSum",name:"一级检查项权重总和",match:"treeNodeIsFirst && measurement_points",value:"(weight || 0) / 100",text:"{{weight || 0}}%"}],result:"passrateWeightSum.value / weightSum.value",hasResult:"Boolean(weightSum.value)",resultType:"percent",formula:"总合格率 = ( 一级检查项1合格率*一级检查项1权重+一级检查项2合格率*一级检查项2权重+...+一级检查项n合格率*一级检查项n权重) / (一级检查项1权重+一级检查项2权重+...+一级检查项n权重)",formulaCalc:"=({{passrateWeightSum.text}})/({{weightSum.text}})={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},{totalMode:3,title:'{{batch.status === "检查中" ? "当前" : ""}}合格率',calc:[{key:"passrateWeightSum",name:"末级检查项合格率*权重和",match:"treeNodeIsEnd && measurement_points",value:"passrate * (weight || 0) / 100",text:"{{percent(passrate, 2)}}*{{ (weight || 0)}}%"},{key:"weightSum",name:"末级检查项权重总和",match:"treeNodeIsEnd && measurement_points",value:"(weight || 0) / 100",text:"{{ (weight || 0)}}%"}],result:"passrateWeightSum.value / weightSum.value",hasResult:"Boolean(weightSum.value)",resultType:"percent",formula:"总合格率 = ( 末级检查项1合格率*末级检查项1权重+末级检查项2合格率*末级检查项2权重+...+末级检查项n合格率*末级检查项n权重) / (末级检查项1权重+末级检查项2权重+...+末级检查项n权重)",formulaCalc:"=({{passrateWeightSum.text}})/({{weightSum.text}})={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"}],finishBatchCheck:[{isFilterFirst:!1,statusTotalConfig:[{status:"检查完毕",key:"a"},{status:"不合格",key:"b"}],match:"a <= 0",type:"alert",msg:"至少1项有记录"},{isFilterFirst:!1,statusTotalConfig:[{status:"检查中",key:"a"}],calc:"a > 0",type:"notify",msg:'有<span class="color-orange pl5 pr5">{{a}}</span>项暂存，请先填写完整或删除草稿后再提交'}]}}}]);