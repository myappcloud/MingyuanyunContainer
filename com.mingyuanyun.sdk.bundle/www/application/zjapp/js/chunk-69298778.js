(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-69298778"],{"79a7":function(t,e,a){"use strict";a.r(e);var n=a("07d2"),c=a("fc33"),o=a("e2a7"),i=(a("7cb8"),{name:"IndexFooter",components:{Item:n.a},props:{batchId:{type:String}},data:function(){return{isLoading:!1,scoreRate:"",totalData:[]}},watch:{batchId:{handler:function(t){t?this.getTotalData():(this.scoreRate="",this.totalData=[])},immediate:!0}},created:function(){this.$on("reload",this.getTotalData)},activated:function(){this.getTotalData()},methods:{getTotalData:function(){var t=this,e=this.batchId;return c.a.getBatchTotalData(e).then((function(a){e===t.batchId&&(t.totalData=a,t.scoreRate=a&&a[0]&&a[0].score)}))},formulaTips:function(){var t=this.totalData&&this.totalData[0];if(t){var e=c.a.getScoreFormula(t.children,t.algorithm);o.a.notify("总".concat(e),{buttonName:"知道了",className:"broad-dialog"})}}}}),r=(a("ca28"),a("17cc")),s=Object(r.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("item",{attrs:{border:"top"}},[e("div",{staticClass:"item-text"},[this._v("总得分")]),e("div",{staticClass:"item-font color-theme f18 fw-b"},[this._v(this._s(this.scoreRate))]),e("icon",{attrs:{name:"yiwen"},on:{click:this.formulaTips}})],1)}),[],!1,null,"7ce676ad",null);e.default=s.exports},b0933:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .icon-yiwen[data-v-7ce676ad]{font-size:18px;color:#b4b4b4;line-height:30px;padding-left:10px}.zjapp .ios-bezel-less .item[data-v-7ce676ad]{padding-bottom:42px}",""])},b0e9:function(t,e,a){var n=a("b0933");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a("85cb").default)("133e89e7",n,!0,{sourceMap:!1,shadowMode:!1})},ca28:function(t,e,a){"use strict";a("b0e9")},fc33:function(t,e,a){"use strict";a("2b45"),a("6d57");var n=a("fc9f"),c=function(t){return n.a.query("select b.*, t.name as template_name, t.mode as template_mode, bc.weight\n      from batch b\n      left join special_inspect_template t on t.id = b.template_id\n      left join special_inspect_template_batch_combo bc on bc.batch_id = b.id and bc.template_id = t.id\n      where b.root_id = ? and ifnull(b.parent_id, '') != ''\n      order by bc.sort",[t])},o=function(t){return n.a.query("select b.*, t.name as template_name, t.mode as template_mode, bc.weight\n      from batch b\n      left join special_inspect_template t on t.id = b.template_id\n      left join special_inspect_template_batch_combo bc on bc.batch_id = b.id and bc.template_id = t.id\n      where b.root_id = ?\n      order by bc.sort",[t])},i=a("7cb8");function r(t){if(!t||!t.length)return[];var e=[],a=[];return t.forEach((function(t){e[t.id]=t})),t.forEach((function(t){t.parent_id&&e[t.parent_id]?(e[t.parent_id].children||(e[t.parent_id].children=[]),e[t.parent_id].children.push(t)):a.push(t)})),a}e.a={getBatchTree:function(t){var e=this;return c(t).then((function(t){(t||[]).forEach((function(t){try{var e=JSON.parse(t.template_extension||{});t.algorithm=parseInt(e.total_score_algorithm)||1}catch(e){t.algorithm=1}}));var a=r(t);return e.setBatchTreeScore(a),a}))},setBatchTreeScore:function(t){var e=this;t&&t.length&&t.forEach((function(t){t.children&&t.children.length&&(e.setBatchTreeScore(t.children),t.score=e.getScore(t.children,t.algorithm))}))},getBatchTotalData:function(t){var e=this;return o(t).then((function(t){(t||[]).forEach((function(t){try{var e=JSON.parse(t.template_extension||{});t.algorithm=parseInt(e.total_score_algorithm)}catch(e){t.algorithm=1}}));var a=r(t);return e.setBatchTreeScore(a),a}))},getScoreWeight:function(t,e){return Object(i.i)(t)?Object(i.i)(e)?(t=parseFloat(t))*(e=parseFloat(e)/100):parseFloat(t):0},getScoreWeightText:function(t,e){return Object(i.i)(t)?Object(i.i)(e)?(t="%"===t.toString().substr(-1)?t:"".concat(t,"%"),e="%"===e.toString().substr(-1)?e:"".concat(e,"%"),"".concat(t,"*").concat(e)):t:""},getScore:function(){var t,e,a=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o="";return 1===c?(n.forEach((function(e){if(Object(i.i)(e.score)){var n=e.score,c=e.weight;t=t||0,t+=a.getScoreWeight(n,c)}})),o=t):2===c&&(n.forEach((function(n){if(Object(i.i)(n.score)){var c=n.score,o=n.weight;t=t||0,e=e||0,t+=a.getScoreWeight(c,o),e+=parseFloat(o)/100}})),o=Object(i.i)(t)?e?t/e:0:""),o=Object(i.i)(o)?(Math.round(100*o)/100).toFixed(2)+"%":""},getScoreFormula:function(){var t,e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,c=[],o=[];return 1===n?(t="得分=组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n",a.forEach((function(t){if(Object(i.i)(t.score)){var a=t.score,n=t.weight;c.push(e.getScoreWeightText(a,n))}})),c&&c.length&&(t+="=".concat(c.join("+"),"=").concat(this.getScore(a,n)))):2===n&&(t="得分=（组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n）/（权重1+权重2+...+权重n）",a.forEach((function(t){if(Object(i.i)(t.score)){var a=t.score,n=t.weight;c.push(e.getScoreWeightText(a,n)),o.push("".concat(n,"%"))}})),c&&c.length&&(t+="=(".concat(c.join("+"),")/(").concat(o.join("+"),")=").concat(this.getScore(a,n)))),t}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fX21vZHVsZV9lbnRyeV96amFwcF9fLy4vc3JjL3ZpZXdzL3NwZWNpYWwtaW5zcGVjdC90ZW1wbGF0ZS0xMDAvaW5kZXgtZm9vdGVyLnZ1ZT9iZDg4Iiwid2VicGFjazovL19fbW9kdWxlX2VudHJ5X3pqYXBwX18vLi9zcmMvdmlld3Mvc3BlY2lhbC1pbnNwZWN0L3RlbXBsYXRlLTEwMC9pbmRleC1mb290ZXIudnVlP2I4ODkiLCJ3ZWJwYWNrOi8vX19tb2R1bGVfZW50cnlfemphcHBfXy9zcmMvdmlld3Mvc3BlY2lhbC1pbnNwZWN0L3RlbXBsYXRlLTEwMC9pbmRleC1mb290ZXIudnVlIiwid2VicGFjazovL19fbW9kdWxlX2VudHJ5X3pqYXBwX18vLi9zcmMvdmlld3Mvc3BlY2lhbC1pbnNwZWN0L3RlbXBsYXRlLTEwMC9pbmRleC1mb290ZXIudnVlIiwid2VicGFjazovL19fbW9kdWxlX2VudHJ5X3pqYXBwX18vLi9zcmMvdmlld3Mvc3BlY2lhbC1pbnNwZWN0L3RlbXBsYXRlLTEwMC9pbmRleC1mb290ZXIudnVlPzJhOWYiLCJ3ZWJwYWNrOi8vX19tb2R1bGVfZW50cnlfemphcHBfXy8uL3NyYy92aWV3cy9zcGVjaWFsLWluc3BlY3QvdGVtcGxhdGUtMTAwL2luZGV4LWZvb3Rlci52dWU/NDkwMiIsIndlYnBhY2s6Ly9fX21vZHVsZV9lbnRyeV96amFwcF9fLy4vc3JjL3ZpZXdzL3NwZWNpYWwtaW5zcGVjdC90ZW1wbGF0ZS0xMDAvaW5kZXgtZm9vdGVyLnZ1ZT80OTkyIiwid2VicGFjazovL19fbW9kdWxlX2VudHJ5X3pqYXBwX18vLi9zcmMvdmlld3Mvc3BlY2lhbC1pbnNwZWN0L3RlbXBsYXRlLTEwMC9yZXBvc2l0b3J5LmpzIiwid2VicGFjazovL19fbW9kdWxlX2VudHJ5X3pqYXBwX18vLi9zcmMvdmlld3Mvc3BlY2lhbC1pbnNwZWN0L3RlbXBsYXRlLTEwMC9zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbIm5hbWUiLCJjb21wb25lbnRzIiwiSXRlbSIsInByb3BzIiwiYmF0Y2hJZCIsInR5cGUiLCJTdHJpbmciLCJkYXRhIiwiaXNMb2FkaW5nIiwic2NvcmVSYXRlIiwidG90YWxEYXRhIiwid2F0Y2giLCJoYW5kbGVyIiwidiIsInRoaXMiLCJnZXRUb3RhbERhdGEiLCJpbW1lZGlhdGUiLCJjcmVhdGVkIiwiJG9uIiwiYWN0aXZhdGVkIiwibWV0aG9kcyIsImZvcm11bGFUaXBzIiwiY29tcG9uZW50IiwiX2giLCIkY3JlYXRlRWxlbWVudCIsIl9jIiwiX3NlbGYiLCJhdHRycyIsInN0YXRpY0NsYXNzIiwiX3YiLCJfcyIsIm9uIiwibW9kdWxlIiwiZXhwb3J0cyIsInB1c2giLCJpIiwiY29udGVudCIsImxvY2FscyIsImFkZCIsImRlZmF1bHQiLCJsb2NhbERCIiwicXVlcnkiLCJjcmVhdGVUcmVlQnlBcnJheSIsImxlbmd0aCIsIm1hcCIsInJlc3VsdCIsImZvckVhY2giLCJpdGVtIiwiaWQiLCJwYXJlbnRfaWQiLCJjaGlsZHJlbiIsImdldEJhdGNoVHJlZSIsIlJlcG9zaXRvcnkiLCJ0aGVuIiwicmVzIiwiZXh0ZW5zaW9uIiwiSlNPTiIsInBhcnNlIiwidGVtcGxhdGVfZXh0ZW5zaW9uIiwiYWxnb3JpdGhtIiwicGFyc2VJbnQiLCJ0b3RhbF9zY29yZV9hbGdvcml0aG0iLCJzZXRCYXRjaFRyZWVTY29yZSIsInNjb3JlIiwiZ2V0U2NvcmUiLCJnZXRCYXRjaFRvdGFsRGF0YSIsImdldFNjb3JlV2VpZ2h0Iiwid2VpZ2h0IiwiaGFzVmFsIiwicGFyc2VGbG9hdCIsImdldFNjb3JlV2VpZ2h0VGV4dCIsInRvU3RyaW5nIiwic3Vic3RyIiwidG90YWxTdW0iLCJ3ZWlndGhTdW0iLCJNYXRoIiwicm91bmQiLCJ0b0ZpeGVkIiwiZ2V0U2NvcmVGb3JtdWxhIiwiZm9ybXVsYSIsInRvdGFsU2V0Iiwid2VpZ2h0U2V0Iiwiam9pbiJdLCJtYXBwaW5ncyI6IjJKQUFBLEksb0NDQXdkLEcsVUNjeGQsQ0FDRUEsS0FBTSxjQUNOQyxXQUFZ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WG9CLE9BRWJhLEVBQVM5QyxLQUFLLEVBQUtvQyxtQkFBbUJQLEVBQU9JLElBQzdDYyxFQUFVL0MsS0FBVixVQUFrQmlDLEVBQWxCLFVBR0VhLEdBQVlBLEVBQVNyQyxTQUV2Qm9DLEdBQVcsS0FBSixPQUFTQyxFQUFTRSxLQUFLLEtBQXZCLGNBQWlDRCxFQUFVQyxLQUFLLEtBQWhELGFBQXlEcEUsS0FBS2tELFNBQ25FekQsRUFDQW9ELE1BS0NvQiIsImZpbGUiOiJqcy9jaHVuay02OTI5ODc3OC5qcz92MTYwODcxNDQ1MTE5NSIsInNvdXJjZXNDb250ZW50IjpbInZhciByZW5kZXIgPSBmdW5jdGlvbiAoKSB7dmFyIF92bT10aGlzO3ZhciBfaD1fdm0uJGNyZWF0ZUVsZW1lbnQ7dmFyIF9jPV92bS5fc2VsZi5fY3x8X2g7cmV0dXJuIF9jKCdpdGVtJyx7YXR0cnM6e1wiYm9yZGVyXCI6XCJ0b3BcIn19LFtfYygnZGl2Jyx7c3RhdGljQ2xhc3M6XCJpdGVtLXRleHRcIn0sW192bS5fdihcIuaAu+W+l+WIhlwiKV0pLF9jKCdkaXYnLHtzdGF0aWNDbGFzczpcIml0ZW0tZm9udCBjb2xvci10aGVtZSBmMTggZnctYlwifSxbX3ZtLl92KF92bS5fcyhfdm0uc2NvcmVSYXRlKSldKSxfYygnaWNvbicse2F0dHJzOntcIm5hbWVcIjpcInlpd2VuXCJ9LG9uOntcImNsaWNrXCI6X3ZtLmZvcm11bGFUaXBzfX0pXSwxKX1cbnZhciBzdGF0aWNSZW5kZXJGbnMgPSBbXVxuXG5leHBvcnQgeyByZW5kZXIsIHN0YXRpY1JlbmRlckZucyB9IiwiaW1wb3J0IG1vZCBmcm9tIFwiLSEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX2NhY2hlLWxvYWRlckAyLjAuMUBjYWNoZS1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tMTItMCEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX3RocmVhZC1sb2FkZXJAMi4xLjNAdGhyZWFkLWxvYWRlci9kaXN0L2Nqcy5qcyEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX2JhYmVsLWxvYWRlckA4LjIuMUBiYWJlbC1sb2FkZXIvbGliL2luZGV4LmpzIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9fY2FjaGUtbG9hZGVyQDIuMC4xQGNhY2hlLWxvYWRlci9kaXN0L2Nqcy5qcz8/cmVmLS0wLTAhLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL192dWUtbG9hZGVyQDE1LjcuMEB2dWUtbG9hZGVyL2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vaW5kZXgtZm9vdGVyLnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIjsgZXhwb3J0IGRlZmF1bHQgbW9kOyBleHBvcnQgKiBmcm9tIFwiLSEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX2NhY2hlLWxvYWRlckAyLjAuMUBjYWNoZS1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tMTItMCEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX3RocmVhZC1sb2FkZXJAMi4xLjNAdGhyZWFkLWxvYWRlci9kaXN0L2Nqcy5qcyEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX2JhYmVsLWxvYWRlckA4LjIuMUBiYWJlbC1sb2FkZXIvbGliL2luZGV4LmpzIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9fY2FjaGUtbG9hZGVyQDIuMC4xQGNhY2hlLWxvYWRlci9kaXN0L2Nqcy5qcz8/cmVmLS0wLTAhLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL192dWUtbG9hZGVyQDE1LjcuMEB2dWUtbG9hZGVyL2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vaW5kZXgtZm9vdGVyLnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIiIsIjx0ZW1wbGF0ZT5cbiAgPGl0ZW0gYm9yZGVyPVwidG9wXCI+XG4gICAgPGRpdiBjbGFzcz1cIml0ZW0tdGV4dFwiPuaAu+W+l+WIhjwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJpdGVtLWZvbnQgY29sb3ItdGhlbWUgZjE4IGZ3LWJcIj57eyBzY29yZVJhdGUgfX08L2Rpdj5cbiAgICA8aWNvbiBuYW1lPVwieWl3ZW5cIiBAY2xpY2s9XCJmb3JtdWxhVGlwc1wiIC8+XG4gIDwvaXRlbT5cbjwvdGVtcGxhdGU+XG5cbjxzY3JpcHQ+XG5pbXBvcnQgSXRlbSBmcm9tICdAc3JjL2NvbXBvbmVudHMvaXRlbS8nO1xuaW1wb3J0IFNlcnZpY2UgZnJvbSAnLi9zZXJ2aWNlLmpzJztcbmltcG9ydCBQb3B1cCBmcm9tICdAc3JjL3V0aWxzL3BvcHVwJztcbmltcG9ydCB7IGhhc1ZhbCB9IGZyb20gJ0BzcmMvY29tbW9uL2RhdGEtaGFuZGxlJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnSW5kZXhGb290ZXInLFxuICBjb21wb25lbnRzOiB7XG4gICAgSXRlbSxcbiAgfSxcblxuICBwcm9wczoge1xuICAgIGJhdGNoSWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICB9LFxuICB9LFxuICBkYXRhKCkge1xuICAgIHJldHVybiB7XG4gICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgc2NvcmVSYXRlOiAnJyxcbiAgICAgIHRvdGFsRGF0YTogW10sXG4gICAgfTtcbiAgfSxcbiAgd2F0Y2g6IHtcbiAgICBiYXRjaElkOiB7XG4gICAgICBoYW5kbGVyKHYpIHtcbiAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICB0aGlzLmdldFRvdGFsRGF0YSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2NvcmVSYXRlID0gJyc7XG4gICAgICAgICAgdGhpcy50b3RhbERhdGEgPSBbXTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGltbWVkaWF0ZTogdHJ1ZSxcbiAgICB9LFxuICB9LFxuICBjcmVhdGVkKCkge1xuICAgIHRoaXMuJG9uKCdyZWxvYWQnLCB0aGlzLmdldFRvdGFsRGF0YSk7XG4gIH0sXG4gIGFjdGl2YXRlZCgpIHtcbiAgICB0aGlzLmdldFRvdGFsRGF0YSgpO1xuICB9LFxuICBtZXRob2RzOiB7XG4gICAgLy8g6I635Y+W5oC75b6X5YiG55qE5pWw5o2uXG4gICAgZ2V0VG90YWxEYXRhKCkge1xuICAgICAgbGV0IGJhdGNoSWQgPSB0aGlzLmJhdGNoSWQ7XG4gICAgICByZXR1cm4gU2VydmljZS5nZXRCYXRjaFRvdGFsRGF0YShiYXRjaElkKS50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmIChiYXRjaElkICE9PSB0aGlzLmJhdGNoSWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50b3RhbERhdGEgPSByZXM7XG5cbiAgICAgICAgdGhpcy5zY29yZVJhdGUgPSByZXMgJiYgcmVzWzBdICYmIHJlc1swXS5zY29yZTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyDmgLvlvpfliIYgdGlwc1xuICAgIGZvcm11bGFUaXBzKCkge1xuICAgICAgbGV0IGRhdGEgPSB0aGlzLnRvdGFsRGF0YSAmJiB0aGlzLnRvdGFsRGF0YVswXTtcbiAgICAgIGlmICghZGF0YSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBmb3JtdWxhID0gU2VydmljZS5nZXRTY29yZUZvcm11bGEoZGF0YS5jaGlsZHJlbiwgZGF0YS5hbGdvcml0aG0pO1xuICAgICAgUG9wdXAubm90aWZ5KGDmgLske2Zvcm11bGF9YCwgeyBidXR0b25OYW1lOiAn55+l6YGT5LqGJywgY2xhc3NOYW1lOiAnYnJvYWQtZGlhbG9nJyB9KTtcbiAgICB9LFxuICB9LFxufTtcbjwvc2NyaXB0PlxuXG48c3R5bGUgbGFuZz1cInNjc3NcIiBzY29wZWQ+XG4uaWNvbi15aXdlbiB7XG4gIGZvbnQtc2l6ZTogMThweDtcbiAgY29sb3I6ICNiNGI0YjQ7XG4gIGxpbmUtaGVpZ2h0OiAzMHB4O1xuICBwYWRkaW5nLWxlZnQ6IDEwcHg7XG59XG5cbi5pb3MtYmV6ZWwtbGVzcyAuaXRlbSB7XG4gIHBhZGRpbmctYm90dG9tOiA0MnB4O1xufVxuPC9zdHlsZT5cbiIsImltcG9ydCB7IHJlbmRlciwgc3RhdGljUmVuZGVyRm5zIH0gZnJvbSBcIi4vaW5kZXgtZm9vdGVyLnZ1ZT92dWUmdHlwZT10ZW1wbGF0ZSZpZD03Y2U2NzZhZCZzY29wZWQ9dHJ1ZSZcIlxuaW1wb3J0IHNjcmlwdCBmcm9tIFwiLi9pbmRleC1mb290ZXIudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5leHBvcnQgKiBmcm9tIFwiLi9pbmRleC1mb290ZXIudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5pbXBvcnQgc3R5bGUwIGZyb20gXCIuL2luZGV4LWZvb3Rlci52dWU/dnVlJnR5cGU9c3R5bGUmaW5kZXg9MCZpZD03Y2U2NzZhZCZsYW5nPXNjc3Mmc2NvcGVkPXRydWUmXCJcblxuXG4vKiBub3JtYWxpemUgY29tcG9uZW50ICovXG5pbXBvcnQgbm9ybWFsaXplciBmcm9tIFwiIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9fdnVlLWxvYWRlckAxNS43LjBAdnVlLWxvYWRlci9saWIvcnVudGltZS9jb21wb25lbnROb3JtYWxpemVyLmpzXCJcbnZhciBjb21wb25lbnQgPSBub3JtYWxpemVyKFxuICBzY3JpcHQsXG4gIHJlbmRlcixcbiAgc3RhdGljUmVuZGVyRm5zLFxuICBmYWxzZSxcbiAgbnVsbCxcbiAgXCI3Y2U2NzZhZFwiLFxuICBudWxsXG4gIFxuKVxuXG5leHBvcnQgZGVmYXVsdCBjb21wb25lbnQuZXhwb3J0cyIsImV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX2Nzcy1sb2FkZXJAMS4wLjFAY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikoZmFsc2UpO1xuLy8gaW1wb3J0c1xuXG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiLnpqYXBwIC5pY29uLXlpd2VuW2RhdGEtdi03Y2U2NzZhZF17Zm9udC1zaXplOjE4cHg7Y29sb3I6I2I0YjRiNDtsaW5lLWhlaWdodDozMHB4O3BhZGRpbmctbGVmdDoxMHB4fS56amFwcCAuaW9zLWJlemVsLWxlc3MgLml0ZW1bZGF0YS12LTdjZTY3NmFkXXtwYWRkaW5nLWJvdHRvbTo0MnB4fVwiLCBcIlwiXSk7XG5cbi8vIGV4cG9ydHNcbiIsIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX2Nzcy1sb2FkZXJAMS4wLjFAY3NzLWxvYWRlci9pbmRleC5qcz8/cmVmLS04LW9uZU9mLTEtMSEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX3Z1ZS1sb2FkZXJAMTUuOS41QHZ1ZS1sb2FkZXIvbGliL2xvYWRlcnMvc3R5bGVQb3N0TG9hZGVyLmpzIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9fcG9zdGNzcy1sb2FkZXJAMy4wLjBAcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPz9yZWYtLTgtb25lT2YtMS0yIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9fcG9zdGNzcy1sb2FkZXJAMy4wLjBAcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPz9yZWYtLTgtb25lT2YtMS0zIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9fc2Fzcy1sb2FkZXJANy4xLjBAc2Fzcy1sb2FkZXIvbGliL2xvYWRlci5qcz8/cmVmLS04LW9uZU9mLTEtNCEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX2NhY2hlLWxvYWRlckAyLjAuMUBjYWNoZS1sb2FkZXIvZGlzdC9janMuanM/P3JlZi0tMC0wIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9fdnVlLWxvYWRlckAxNS43LjBAdnVlLWxvYWRlci9saWIvaW5kZXguanM/P3Z1ZS1sb2FkZXItb3B0aW9ucyEuL2luZGV4LWZvb3Rlci52dWU/dnVlJnR5cGU9c3R5bGUmaW5kZXg9MCZpZD03Y2U2NzZhZCZsYW5nPXNjc3Mmc2NvcGVkPXRydWUmXCIpO1xuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcbi8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cbnZhciBhZGQgPSByZXF1aXJlKFwiIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9fdnVlLXN0eWxlLWxvYWRlckA0LjEuMkB2dWUtc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXNDbGllbnQuanNcIikuZGVmYXVsdFxudmFyIHVwZGF0ZSA9IGFkZChcIjEzM2U4OWU3XCIsIGNvbnRlbnQsIHRydWUsIHtcInNvdXJjZU1hcFwiOmZhbHNlLFwic2hhZG93TW9kZVwiOmZhbHNlfSk7IiwiZXhwb3J0ICogZnJvbSBcIi0hLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL192dWUtc3R5bGUtbG9hZGVyQDQuMS4yQHZ1ZS1zdHlsZS1sb2FkZXIvaW5kZXguanM/P3JlZi0tOC1vbmVPZi0xLTAhLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL19jc3MtbG9hZGVyQDEuMC4xQGNzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tOC1vbmVPZi0xLTEhLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL192dWUtbG9hZGVyQDE1LjkuNUB2dWUtbG9hZGVyL2xpYi9sb2FkZXJzL3N0eWxlUG9zdExvYWRlci5qcyEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX3Bvc3Rjc3MtbG9hZGVyQDMuMC4wQHBvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8/cmVmLS04LW9uZU9mLTEtMiEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX3Bvc3Rjc3MtbG9hZGVyQDMuMC4wQHBvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8/cmVmLS04LW9uZU9mLTEtMyEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX3Nhc3MtbG9hZGVyQDcuMS4wQHNhc3MtbG9hZGVyL2xpYi9sb2FkZXIuanM/P3JlZi0tOC1vbmVPZi0xLTQhLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL19jYWNoZS1sb2FkZXJAMi4wLjFAY2FjaGUtbG9hZGVyL2Rpc3QvY2pzLmpzPz9yZWYtLTAtMCEuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvX3Z1ZS1sb2FkZXJAMTUuNy4wQHZ1ZS1sb2FkZXIvbGliL2luZGV4LmpzPz92dWUtbG9hZGVyLW9wdGlvbnMhLi9pbmRleC1mb290ZXIudnVlP3Z1ZSZ0eXBlPXN0eWxlJmluZGV4PTAmaWQ9N2NlNjc2YWQmbGFuZz1zY3NzJnNjb3BlZD10cnVlJlwiIiwiLypcbiAqIEBBdXRob3I6IGppYW5nbDAyXG4gKiBARGF0ZTogMjAyMC0wNi0yMyAwOTo0NTo1NFxuICogQExhc3RFZGl0b3JzOiBqaWFuZ2wwMlxuICogQExhc3RFZGl0VGltZTogMjAyMC0wNi0yNCAxNDoxMTowM1xuICogQERlc2NyaXB0aW9uOlxuICovXG5cbmltcG9ydCBsb2NhbERCIGZyb20gJ0BzcmMvZnJhbWV3b3JrL2xvY2FsREInO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb246IOiOt+WPluaJueasoeeahOaJgOacieWtkOaJueasoVxuICAgKiBAcGFyYW0ge1N0cmluZ30gYmF0Y2hJZFxuICAgKiBAcmV0dXJuOiBQcm9taXNlXG4gICAqL1xuICBnZXRCYXRjaEFsbENoaWxkcmVuKGJhdGNoSWQpIHtcbiAgICBsZXQgc3FsID0gYHNlbGVjdCBiLiosIHQubmFtZSBhcyB0ZW1wbGF0ZV9uYW1lLCB0Lm1vZGUgYXMgdGVtcGxhdGVfbW9kZSwgYmMud2VpZ2h0XG4gICAgICBmcm9tIGJhdGNoIGJcbiAgICAgIGxlZnQgam9pbiBzcGVjaWFsX2luc3BlY3RfdGVtcGxhdGUgdCBvbiB0LmlkID0gYi50ZW1wbGF0ZV9pZFxuICAgICAgbGVmdCBqb2luIHNwZWNpYWxfaW5zcGVjdF90ZW1wbGF0ZV9iYXRjaF9jb21ibyBiYyBvbiBiYy5iYXRjaF9pZCA9IGIuaWQgYW5kIGJjLnRlbXBsYXRlX2lkID0gdC5pZFxuICAgICAgd2hlcmUgYi5yb290X2lkID0gPyBhbmQgaWZudWxsKGIucGFyZW50X2lkLCAnJykgIT0gJydcbiAgICAgIG9yZGVyIGJ5IGJjLnNvcnRgO1xuICAgIHJldHVybiBsb2NhbERCLnF1ZXJ5KHNxbCwgW2JhdGNoSWRdKTtcbiAgfSxcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uOiDojrflj5bmibnmrKEr5a2Q5om55qyh55qE5YiX6KGoXG4gICAqIEBwYXJhbSB7dHlwZX1cbiAgICogQHJldHVybjpcbiAgICovXG4gIGdldEJhdGNoTGlzdChiYXRjaElkKSB7XG4gICAgbGV0IHNxbCA9IGBzZWxlY3QgYi4qLCB0Lm5hbWUgYXMgdGVtcGxhdGVfbmFtZSwgdC5tb2RlIGFzIHRlbXBsYXRlX21vZGUsIGJjLndlaWdodFxuICAgICAgZnJvbSBiYXRjaCBiXG4gICAgICBsZWZ0IGpvaW4gc3BlY2lhbF9pbnNwZWN0X3RlbXBsYXRlIHQgb24gdC5pZCA9IGIudGVtcGxhdGVfaWRcbiAgICAgIGxlZnQgam9pbiBzcGVjaWFsX2luc3BlY3RfdGVtcGxhdGVfYmF0Y2hfY29tYm8gYmMgb24gYmMuYmF0Y2hfaWQgPSBiLmlkIGFuZCBiYy50ZW1wbGF0ZV9pZCA9IHQuaWRcbiAgICAgIHdoZXJlIGIucm9vdF9pZCA9ID9cbiAgICAgIG9yZGVyIGJ5IGJjLnNvcnRgO1xuICAgIHJldHVybiBsb2NhbERCLnF1ZXJ5KHNxbCwgW2JhdGNoSWRdKTtcbiAgfSxcbn07XG4iLCIvKlxuICogQEF1dGhvcjogamlhbmdsMDJcbiAqIEBEYXRlOiAyMDIwLTA2LTIzIDA5OjM3OjA1XG4gKiBATGFzdEVkaXRvcnM6IGppYW5nbDAyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDIwLTA2LTI4IDE2OjAzOjM2XG4gKiBARGVzY3JpcHRpb246IOe7hOWQiOW1jOWll+aooeadvyBzZXJ2aWNlXG4gKi9cblxuaW1wb3J0IFJlcG9zaXRvcnkgZnJvbSAnLi9yZXBvc2l0b3J5LmpzJztcbmltcG9ydCB7IGhhc1ZhbCB9IGZyb20gJ0BzcmMvY29tbW9uL2RhdGEtaGFuZGxlJztcblxuLyoqXG4gKiBAZGVzY3JpcHRpb246IOWIm+W7uiB0cmVlXG4gKiBAcGFyYW0ge0FycmF5fSBkYXRhXG4gKiBAcmV0dXJuOiBBcnJheVxuICovXG5mdW5jdGlvbiBjcmVhdGVUcmVlQnlBcnJheShkYXRhKSB7XG4gIGlmICghZGF0YSB8fCAhZGF0YS5sZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgbWFwID0gW107XG4gIGxldCByZXN1bHQgPSBbXTtcbiAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgIG1hcFtpdGVtLmlkXSA9IGl0ZW07XG4gIH0pO1xuICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XG4gICAgaWYgKCFpdGVtLnBhcmVudF9pZCB8fCAhbWFwW2l0ZW0ucGFyZW50X2lkXSkge1xuICAgICAgcmVzdWx0LnB1c2goaXRlbSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFtYXBbaXRlbS5wYXJlbnRfaWRdLmNoaWxkcmVuKSB7XG4gICAgICBtYXBbaXRlbS5wYXJlbnRfaWRdLmNoaWxkcmVuID0gW107XG4gICAgfVxuICAgIG1hcFtpdGVtLnBhcmVudF9pZF0uY2hpbGRyZW4ucHVzaChpdGVtKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uOiDojrflj5bmibnmrKHmoJHlvaLnu5PmnoRcbiAgICogQHBhcmFtIHt0eXBlfVxuICAgKiBAcmV0dXJuOlxuICAgKi9cbiAgZ2V0QmF0Y2hUcmVlKGJhdGNoSWQpIHtcbiAgICByZXR1cm4gUmVwb3NpdG9yeS5nZXRCYXRjaEFsbENoaWxkcmVuKGJhdGNoSWQpLnRoZW4ocmVzID0+IHtcbiAgICAgIChyZXMgfHwgW10pLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIC8vIOiOt+WPluKAnOW9k+WJjeWxgue6p+eul+azleKAnVxuICAgICAgICB0cnkge1xuICAgICAgICAgIGxldCBleHRlbnNpb24gPSBKU09OLnBhcnNlKGl0ZW0udGVtcGxhdGVfZXh0ZW5zaW9uIHx8IHt9KTtcbiAgICAgICAgICBpdGVtLmFsZ29yaXRobSA9IHBhcnNlSW50KGV4dGVuc2lvbi50b3RhbF9zY29yZV9hbGdvcml0aG0pIHx8IDE7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgIGl0ZW0uYWxnb3JpdGhtID0gMTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGxldCByZXN1bHQgPSBjcmVhdGVUcmVlQnlBcnJheShyZXMpO1xuICAgICAgLy8g6K6h566X5b6X5YiGXG4gICAgICB0aGlzLnNldEJhdGNoVHJlZVNjb3JlKHJlc3VsdCk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb246IOmAkuW9kuiuoeeul+aJueasoeWIhuaVsFxuICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSB0cmVlXG4gICAqIEByZXR1cm46XG4gICAqL1xuICBzZXRCYXRjaFRyZWVTY29yZShkYXRhKSB7XG4gICAgaWYgKCFkYXRhIHx8ICFkYXRhLmxlbmd0aCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIGlmIChpdGVtLmNoaWxkcmVuICYmIGl0ZW0uY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuc2V0QmF0Y2hUcmVlU2NvcmUoaXRlbS5jaGlsZHJlbik7XG4gICAgICAgIGl0ZW0uc2NvcmUgPSB0aGlzLmdldFNjb3JlKGl0ZW0uY2hpbGRyZW4sIGl0ZW0uYWxnb3JpdGhtKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uOiDojrflj5bmibnmrKHnmoTnu5/orqHmlbDmja5cbiAgICogQHBhcmFtIHt0eXBlfVxuICAgKiBAcmV0dXJuOlxuICAgKi9cbiAgZ2V0QmF0Y2hUb3RhbERhdGEoYmF0Y2hJZCkge1xuICAgIHJldHVybiBSZXBvc2l0b3J5LmdldEJhdGNoTGlzdChiYXRjaElkKS50aGVuKHJlcyA9PiB7XG4gICAgICAocmVzIHx8IFtdKS5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAvLyDojrflj5bigJzlvZPliY3lsYLnuqfnrpfms5XigJ1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsZXQgZXh0ZW5zaW9uID0gSlNPTi5wYXJzZShpdGVtLnRlbXBsYXRlX2V4dGVuc2lvbiB8fCB7fSk7XG4gICAgICAgICAgaXRlbS5hbGdvcml0aG0gPSBwYXJzZUludChleHRlbnNpb24udG90YWxfc2NvcmVfYWxnb3JpdGhtKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgaXRlbS5hbGdvcml0aG0gPSAxO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgbGV0IHJlc3VsdCA9IGNyZWF0ZVRyZWVCeUFycmF5KHJlcyk7XG4gICAgICAvLyDorqHnrpflvpfliIZcbiAgICAgIHRoaXMuc2V0QmF0Y2hUcmVlU2NvcmUocmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbjog6I635Y+WIOWIhuaVsCrmnYPph40g55qE57uT5p6cXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzY29yZSDliIbmlbDvvIzkuIDoiKzkuLrnmb7liIbmlbDjgILkuZ/lj6/ku6XkuLrmlbDlrZfvvIzlvLrliLbovazmjaLmiJDnmb7liIbmlbDvvJoxMi4zID0+IDEyLjMlXG4gICAqIEBwYXJhbSB7U3RyaW5nIHwgTnVtYmVyfSB3ZWlnaHQg5p2D6YeN77yM5pWw5a2X44CC6K6h566X55qE5pe25YCZ5b2T5oiQ55m+5YiG5q+U77ya5YiG5pWwICogMTIuMyjmnYPph40pID0+IOWIhuaVsCAqIDEyLjMlID0+IOWIhuaVsCAqIDAuMTIzXG4gICAqIEByZXR1cm46IE51bWJlclxuICAgKi9cbiAgZ2V0U2NvcmVXZWlnaHQoc2NvcmUsIHdlaWdodCkge1xuICAgIGlmICghaGFzVmFsKHNjb3JlKSkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGlmICghaGFzVmFsKHdlaWdodCkpIHtcbiAgICAgIHJldHVybiBwYXJzZUZsb2F0KHNjb3JlKTtcbiAgICB9XG5cbiAgICBzY29yZSA9IHBhcnNlRmxvYXQoc2NvcmUpO1xuICAgIHdlaWdodCA9IHBhcnNlRmxvYXQod2VpZ2h0KSAvIDEwMDtcblxuICAgIHJldHVybiBzY29yZSAqIHdlaWdodDtcbiAgfSxcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uOiDojrflj5Yg5YiG5pWwKuadg+mHje+8jOaWh+Wtl+eJiFxuICAgKiBAcGFyYW0ge1N0cmluZ30gc2NvcmUg5YiG5pWw77yM5LiA6Iis5Li655m+5YiG5pWw44CC5Lmf5Y+v5Lul5Li65pWw5a2X77yM5by65Yi26L2s5o2i5oiQ55m+5YiG5pWw77yaMTIuMyA9PiAxMi4zJVxuICAgKiBAcGFyYW0ge1N0cmluZyB8IE51bWJlcn0gd2VpZ2h0IOadg+mHje+8jOaVsOWtl+OAguiuoeeul+eahOaXtuWAmeW9k+aIkOeZvuWIhuavlO+8muWIhuaVsCAqIDEyLjMo5p2D6YeNKSA9PiDliIbmlbAgKiAxMi4zJSA9PiDliIbmlbAgKiAwLjEyM1xuICAgKiBAcmV0dXJuOlxuICAgKi9cbiAgZ2V0U2NvcmVXZWlnaHRUZXh0KHNjb3JlLCB3ZWlnaHQpIHtcbiAgICBpZiAoIWhhc1ZhbChzY29yZSkpIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgaWYgKCFoYXNWYWwod2VpZ2h0KSkge1xuICAgICAgcmV0dXJuIHNjb3JlO1xuICAgIH1cblxuICAgIHNjb3JlID0gc2NvcmUudG9TdHJpbmcoKS5zdWJzdHIoLTEpID09PSAnJScgPyBzY29yZSA6IGAke3Njb3JlfSVgO1xuICAgIHdlaWdodCA9IHdlaWdodC50b1N0cmluZygpLnN1YnN0cigtMSkgPT09ICclJyA/IHdlaWdodCA6IGAke3dlaWdodH0lYDtcblxuICAgIHJldHVybiBgJHtzY29yZX0qJHt3ZWlnaHR9YDtcbiAgfSxcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uOiDojrflj5blvpfliIZcbiAgICogQHBhcmFtIHtBcnJheX0gZGF0YSDlj4LkuI7orqHnrpflvpfliIbnmoTmlbDmja5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IGFsZ29yaXRobSDnrpfms5XvvIwxOuWKoOadg++8jDI65Yqg5p2D5bmz5Z2HXG4gICAqIEByZXR1cm46IFN0cmluZ1xuICAgKi9cbiAgZ2V0U2NvcmUoZGF0YSA9IFtdLCBhbGdvcml0aG0gPSAxKSB7XG4gICAgbGV0IHJlc3VsdCA9ICcnO1xuICAgIGxldCB0b3RhbFN1bTtcbiAgICBsZXQgd2VpZ3RoU3VtO1xuXG4gICAgaWYgKGFsZ29yaXRobSA9PT0gMSkge1xuICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAvLyDlt7LmnInlvpfliIbnmoTvvIzmiY3lj4LkuI7orqHnrpdcbiAgICAgICAgaWYgKCFoYXNWYWwoaXRlbS5zY29yZSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHsgc2NvcmUsIHdlaWdodCB9ID0gaXRlbTtcbiAgICAgICAgdG90YWxTdW0gPSB0b3RhbFN1bSB8fCAwO1xuICAgICAgICB0b3RhbFN1bSArPSB0aGlzLmdldFNjb3JlV2VpZ2h0KHNjb3JlLCB3ZWlnaHQpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIOWbuuWumjLkvY3lsI/mlbBcbiAgICAgIHJlc3VsdCA9IHRvdGFsU3VtO1xuICAgIH0gZWxzZSBpZiAoYWxnb3JpdGhtID09PSAyKSB7XG4gICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIC8vIOW3suacieW+l+WIhueahO+8jOaJjeWPguS4juiuoeeul1xuICAgICAgICBpZiAoIWhhc1ZhbChpdGVtLnNjb3JlKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgeyBzY29yZSwgd2VpZ2h0IH0gPSBpdGVtO1xuICAgICAgICB0b3RhbFN1bSA9IHRvdGFsU3VtIHx8IDA7XG4gICAgICAgIHdlaWd0aFN1bSA9IHdlaWd0aFN1bSB8fCAwO1xuICAgICAgICB0b3RhbFN1bSArPSB0aGlzLmdldFNjb3JlV2VpZ2h0KHNjb3JlLCB3ZWlnaHQpO1xuICAgICAgICB3ZWlndGhTdW0gKz0gcGFyc2VGbG9hdCh3ZWlnaHQpIC8gMTAwO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIOWbuuWumjLkvY3lsI/mlbBcbiAgICAgIHJlc3VsdCA9IGhhc1ZhbCh0b3RhbFN1bSkgPyAod2VpZ3RoU3VtID8gdG90YWxTdW0gLyB3ZWlndGhTdW0gOiAwKSA6ICcnO1xuICAgIH1cblxuICAgIC8vIOWbuuWumjLkvY3lsI/mlbBcbiAgICByZXN1bHQgPSBoYXNWYWwocmVzdWx0KSA/IChNYXRoLnJvdW5kKHJlc3VsdCAqIDEwMCkgLyAxMDApLnRvRml4ZWQoMikgKyAnJScgOiAnJztcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbjog6I635Y+W5b6X5YiG5YWs5byPXG4gICAqIEBwYXJhbSB7QXJyYXl9IGRhdGEg5Y+C5LiO6K6h566X5b6X5YiG5YWs5byP55qE5pWw5o2uXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBhbGdvcml0aG0g566X5rOV77yMMTrliqDmnYPvvIwyOuWKoOadg+W5s+Wdh1xuICAgKiBAcmV0dXJuOiBTdHJpbmdcbiAgICovXG4gIGdldFNjb3JlRm9ybXVsYShkYXRhID0gW10sIGFsZ29yaXRobSA9IDEpIHtcbiAgICBsZXQgZm9ybXVsYTtcbiAgICBsZXQgdG90YWxTZXQgPSBbXTtcbiAgICBsZXQgd2VpZ2h0U2V0ID0gW107XG5cbiAgICBpZiAoYWxnb3JpdGhtID09PSAxKSB7XG4gICAgICBmb3JtdWxhID0gYOW+l+WIhj3nu4TlkIjor4TliIbooagxKuadg+mHjTEr57uE5ZCI6K+E5YiG6KGoMirmnYPph40yKy4uLivnu4TlkIjor4TliIbooahuKuadg+mHjW5gO1xuXG4gICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIC8vIOW3suacieW+l+WIhueahO+8jOaJjeWPguS4juiuoeeul1xuICAgICAgICBpZiAoIWhhc1ZhbChpdGVtLnNjb3JlKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgeyBzY29yZSwgd2VpZ2h0IH0gPSBpdGVtO1xuICAgICAgICB0b3RhbFNldC5wdXNoKHRoaXMuZ2V0U2NvcmVXZWlnaHRUZXh0KHNjb3JlLCB3ZWlnaHQpKTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAodG90YWxTZXQgJiYgdG90YWxTZXQubGVuZ3RoKSB7XG4gICAgICAgIGZvcm11bGEgKz0gYD0ke3RvdGFsU2V0LmpvaW4oJysnKX09JHt0aGlzLmdldFNjb3JlKGRhdGEsIGFsZ29yaXRobSl9YDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGFsZ29yaXRobSA9PT0gMikge1xuICAgICAgZm9ybXVsYSA9IGDlvpfliIY977yI57uE5ZCI6K+E5YiG6KGoMSrmnYPph40xK+e7hOWQiOivhOWIhuihqDIq5p2D6YeNMisuLi4r57uE5ZCI6K+E5YiG6KGobirmnYPph41u77yJL++8iOadg+mHjTEr5p2D6YeNMisuLi4r5p2D6YeNbu+8iWA7XG5cbiAgICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgLy8g5bey5pyJ5b6X5YiG55qE77yM5omN5Y+C5LiO6K6h566XXG4gICAgICAgIGlmICghaGFzVmFsKGl0ZW0uc2NvcmUpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCB7IHNjb3JlLCB3ZWlnaHQgfSA9IGl0ZW07XG5cbiAgICAgICAgdG90YWxTZXQucHVzaCh0aGlzLmdldFNjb3JlV2VpZ2h0VGV4dChzY29yZSwgd2VpZ2h0KSk7XG4gICAgICAgIHdlaWdodFNldC5wdXNoKGAke3dlaWdodH0lYCk7XG4gICAgICB9KTtcblxuICAgICAgaWYgKHRvdGFsU2V0ICYmIHRvdGFsU2V0Lmxlbmd0aCkge1xuICAgICAgICAvLyDmnIDnu4jliIbmlbBcbiAgICAgICAgZm9ybXVsYSArPSBgPSgke3RvdGFsU2V0LmpvaW4oJysnKX0pLygke3dlaWdodFNldC5qb2luKCcrJyl9KT0ke3RoaXMuZ2V0U2NvcmUoXG4gICAgICAgICAgZGF0YSxcbiAgICAgICAgICBhbGdvcml0aG1cbiAgICAgICAgKX1gO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmb3JtdWxhO1xuICB9LFxufTtcbiJdLCJzb3VyY2VSb290IjoiIn0=