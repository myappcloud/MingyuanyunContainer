(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-76f4e6dd","chunk-2b8a39de","chunk-739f37c8"],{"08d4":function(t,e,i){"use strict";i("3880")},"10d4":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .multi-select-list-title[data-v-89cd976c]{position:relative;color:#888;font-size:14px;line-height:30px;min-height:40px;margin-bottom:0;margin-top:0;padding:8px 16px;background-color:#f2f2f2}.zjapp .item[data-v-89cd976c]{padding:16px}.zjapp .search-item>div[data-v-89cd976c]{padding-right:35px}.zjapp .search-item i[data-v-89cd976c]{position:absolute;color:#ccc;font-size:26px;right:0;top:50%;transform:translateY(-50%)}.zjapp .van-popup--right[data-v-89cd976c]{width:100%;height:100%}[data-v-89cd976c] .van-cell__title{color:#4174e9;font-weight:700}[data-v-89cd976c] .van-collapse-item__content{transform:translateZ(0);padding:0 0 0 25px}[data-v-89cd976c] .van-collapse-item__content .van-cell{padding-left:0}",""])},"2dea":function(t,e,i){var n=i("10d4");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("d2d2cc46",n,!0,{sourceMap:!1,shadowMode:!1})},3730:function(t,e,i){"use strict";var n=i("329b"),a=i("b65c").a,o=(i("50d5e"),i("17cc")),s=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{attrs:{title:t.title,mode:"dialog","on-close":t.closeEvent}},[t.rightBtn?i("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:function(e){t.checkBoxAliRight?t.submit():t.rightBtnEvent(t.category)}},slot:"header-bar-right"},[t._v(t._s(t.checkBoxAliRight?t.rightBtn+"("+t.realChecked.length+")":t.rightBtn))]):t._e(),i("scroller",{staticClass:"bg-white",attrs:{"has-next":!t.searchStatus&&!t.grouping&&t.optionsLimit<t.options.length,"end-text":"","is-empty":0===t.optionsShow.length},on:{loadNext:t.pageOptions}},[t.searchBar?i("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":t.storageKey},on:{changeSearchStatus:t.onSearchTypeChange,input:t.onInput},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):t._e(),t.showSelected&&(t.searchStatus&&t.isHasVal||!t.searchStatus)?i("div",[i("div",{staticClass:"multi-select-list-title"},[t._v("已选")]),i("div",{staticClass:"item"},[t._v(t._s(t.selectedNames||"请选择"))])]):t._e(),t.listTile&&(t.searchStatus&&t.isHasVal||!t.searchStatus)?i("div",{staticClass:"multi-select-list-title"},[t._v("全部")]):t._e(),t.searchStatus?[t.keyword?[t.grouping?i("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.searchData,(function(e,n){return i("van-collapse-item",{key:n,attrs:{title:e.name,name:n}},t._l(e.children,(function(e,n){return i("item",{key:n,attrs:{checked:!!t.checkedItem[e.id],item:e,"render-field":"rename"},on:{click:t.selectItem}})})))}))):t._l(t.searchData,(function(e,n){return i("item",{key:n,attrs:{checked:!!t.checkedItem[e.id],item:e,disabled:e.disabled,"render-field":"rename"},on:{click:t.selectItem}})}))]:t._e()]:[t.grouping?i("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.optionsShow,(function(e,n){return i("van-collapse-item",{key:n,attrs:{title:e.name,name:n}},[t._l(e.children,(function(e,n){return i("item",{key:n,attrs:{checked:!!t.checkedItem[e.id],item:e},on:{click:t.selectItem}})})),t._v("\n            "+t._s(e.id)+"\n          ")],2)}))):t._l(t.optionsShow,(function(e,n){return i("item",{key:n,attrs:{checked:!!t.checkedItem[e.id],item:e,"align-right":t.checkBoxAliRight,disabled:e.disabled},on:{click:t.selectItem}})})),t.optionsShow.length?t._e():i("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容",type:"search"}})]],2),t.checkBoxAliRight?t._e():i("app-button-group",{staticClass:"ctrl",attrs:{"fixed-bottom":""}},[i("app-button",{on:{click:t.submit}},[t._v("提交")])],1)],1):t._e()],1)}),[],!1,null,"89cd976c",null).exports,r=!1;r||(r=new(n.default.extend(s))({el:document.createElement("div")}),document.body.appendChild(r.$el));e.a=r},3880:function(t,e,i){var n=i("b66d");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("1e2c6191",n,!0,{sourceMap:!1,shadowMode:!1})},"3c77":function(t,e,i){"use strict";i("9dd9"),i("f548");var n=i("28f8"),a=(i("163d"),i("7bac")),o=i("4360");a.a.getUserObject("tree-base-open-set-memory").then((function(t){o.a.commit("components/SET_TREE_BASE_OPEN_SET",t||{})}));var s={name:"TreeBase",props:{data:{type:Array,default:function(){return[]}},keyword:{type:String,default:""},level:{type:Number,default:0},iconPosition:{type:String,default:"left"},indentSize:{type:Number,default:14},memoryOpenSet:{type:Boolean,default:!1},defaultOpenLevel:{type:Number,default:0},hasSlotLeft:{type:Boolean,default:!1},hasSlotRight:{type:Boolean,default:!1},listStyle:{type:Object,default:function(){return{}}},nodeStyle:{type:Object,default:function(){return{}}},textStyle:{type:Object,default:function(){return{}}}},data:function(){return{selfOpenSet:{}}},computed:{openSet:function(){return this.memoryOpenSet?o.a.state.components.treeBaseOpenSet:this.selfOpenSet},showSlotLeft:function(){return this.level?this.hasSlotLeft:!!this.$scopedSlots.left},showSlotRight:function(){return this.level?this.hasSlotRight:!!this.$scopedSlots.right}},methods:{itemClick:function(t){if(t.children&&t.children.length){if(this.memoryOpenSet)!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},o.a.state.components.treeBaseOpenSet,t);o.a.commit("components/SET_TREE_BASE_OPEN_SET",e),a.a.saveUserObject("tree-base-open-set-memory",e)}(Object(n.a)({},t.id,!this.isNodeOpen(t.id)));else this.$set(this.selfOpenSet,t.id,!this.isNodeOpen(t.id));this.$emit("onClickFoldNode",t)}else this.$emit("onClickEndNode",t);this.$emit("onClickNode",t)},isNodeOpen:function(t){return void 0===this.openSet[t]?this.level<this.defaultOpenLevel:this.openSet[t]},onClickNode:function(t){this.$emit("onClickNode",t)},onClickFoldNode:function(t){this.$emit("onClickFoldNode",t)},onClickEndNode:function(t){this.$emit("onClickEndNode",t)},keywordFilter:function(t){return this.keyword?t.replace(new RegExp(this.keyword,"gm"),'<span class="color-blue">'+this.keyword+"</span>"):t}}},r=(i("08d4"),i("17cc")),c=Object(r.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tree-con"},t._l(t.data,(function(e){return i("div",{key:e.id,staticClass:"tree-list",style:Object.assign({},t.listStyle["level-all"],t.listStyle["level-"+t.level])},[i("div",{staticClass:"tree-node border-bottom",class:"tree-node-level-"+t.level,style:Object.assign({},t.nodeStyle["level-all"],t.nodeStyle["level-"+t.level]),on:{click:function(i){t.itemClick(e)}}},[i("div",{staticClass:"tree-indent",style:{width:t.indentSize*t.level+"px"}}),"left"===t.iconPosition?i("div",{staticClass:"tree-icon",class:{"icon-dropdown":e.children&&e.children.length&&(void 0===t.openSet[e.id]?t.level<t.defaultOpenLevel:t.openSet[e.id]),"icon-dropright":e.children&&e.children.length&&!(void 0===t.openSet[e.id]?t.level<t.defaultOpenLevel:t.openSet[e.id])}}):t._e(),i("div",{staticClass:"tree-main"},[t.showSlotLeft?t._t("left",null,{data:e}):i("div",{staticClass:"tree-text",style:Object.assign({},t.textStyle["level-all"],t.textStyle["level-"+t.level]),domProps:{innerHTML:t._s(t.keywordFilter(e.name))}})],2),t.showSlotRight?t._t("right",null,{data:e}):t._e(),"right"===t.iconPosition&&e.children&&e.children.length?i("icon",{staticClass:"icon-right",attrs:{name:(void 0===t.openSet[e.id]?t.level<t.defaultOpenLevel:t.openSet[e.id])?"arrow-up":"arrow-down"}}):t._e()],2),t._t("siblings",null,{data:e}),e.children&&e.children.length&&(void 0===t.openSet[e.id]?t.level<t.defaultOpenLevel:t.openSet[e.id])?[i("tree-base",{key:"children-"+e.id,attrs:{data:e.children,level:t.level+1,keyword:t.keyword,"default-open-level":t.defaultOpenLevel,"memory-open-set":t.memoryOpenSet,"icon-position":t.iconPosition,"has-slot-left":t.showSlotLeft,"has-slot-right":t.showSlotRight,"indent-size":t.indentSize,"list-style":t.listStyle,"node-style":t.nodeStyle,"text-style":t.textStyle},on:{onClickNode:t.onClickNode,onClickFoldNode:t.onClickFoldNode,onClickEndNode:t.onClickEndNode},scopedSlots:t._u([{key:"left",fn:function(e){return[t._t("left",null,{data:e.data})]}},{key:"right",fn:function(e){return[t._t("right",null,{data:e.data})]}},{key:"siblings",fn:function(e){return[t._t("siblings",null,{data:e.data})]}}])})]:t._e()],2)})))}),[],!1,null,"0083fc0a",null);e.a=c.exports},"50d5e":function(t,e,i){"use strict";i("2dea")},"53bf":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .single-item[data-v-b3cb8602]{min-height:44px}.zjapp .single-item .checkbox[data-v-b3cb8602]{font-size:14px;color:transparent;text-align:center;line-height:inherit;width:20px;height:20px;box-sizing:border-box;border:1px solid #dcdcdc;transition:.2s;border-radius:100%;display:inline-block;vertical-align:middle}.zjapp .single-item .checkbox i[data-v-b3cb8602]{display:none}.zjapp .single-item .checkbox.checked[data-v-b3cb8602]{color:#fff;border-color:#1989fa;background-color:#1989fa}.zjapp .single-item .checkbox.checked i[data-v-b3cb8602]{display:inline-block}.zjapp .single-item .checkbox.disabled[data-v-b3cb8602]{border-color:#b2b2b2}.zjapp .single-item .checkboxtxt[data-v-b3cb8602]{flex:1;margin-left:8px}.zjapp .single-item .disabled-text[data-v-b3cb8602]{color:#b2b2b2}.zjapp .wrapper[data-v-b3cb8602]{display:flex;align-items:center}",""])},"774b":function(t,e,i){"use strict";i.r(e);var n=i("d18d").a,a=(i("b225"),i("17cc")),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"scroll-warp",staticClass:"scroll-warp",class:{"scroll-warp-pulling":t.pulling,"scroll-warp-complete":!t.hasNext&&!t.isEmpty,"scroll-warp-empty":t.isEmpty},style:{"padding-bottom":t.numberKeyboardCoverHeight+"px"},on:{scroll:t.onScroll,touchstart:t.onTouchstart,touchmove:t.onTouchmove,touchend:t.onTouchend}},[t.allowPullDown?i("div",{staticClass:"pull-refresh-warp",style:{height:t.pullDist+"px"}},[i("div",{staticClass:"pull-refresh"},[i("div",{staticClass:"animation-refresher",class:{refreshing:t.refreshing}}),t.updateTime?i("p",{staticClass:"pull-refresh-date"},[t._v("最后成功同步："+t._s(t.updateTime))]):t._e()])]):t._e(),t._t("default"),t.loading?i("div",{staticClass:"page-loading"},[i("svg",{staticClass:"svg-loading",attrs:{viewBox:"0 0 80 80"}},[i("circle",{attrs:{cx:"40",cy:"40",r:"36"}})])]):t._e(),t.hasNext||t.isEmpty?t._e():[t.$slots.end?t._t("end"):t._e(),!t.$slots.end&&t.endText?i("div",{staticClass:"end-text"},[t._v("\n      "+t._s(t.endText)+"\n    ")]):t._e()]],2)}),[],!1,null,"2b1a346c",null);e.default=o.exports},"88c7":function(t,e,i){"use strict";var n=i("c7df").a,a=i("17cc"),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{on:{click:t.openSelect}},[t.$slots.default?t._t("default"):i("item",{class:t.required,attrs:{label:t.title,text:t.selectVal,mode:t.mode,editabled:t.editabled,placeholder:t.required?"请选择":"选填"}},[t.$slots.right?t._t("right",null,{slot:"right"}):t._e()],2)],2)}),[],!1,null,null,null);e.a=o.exports},"9d55":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .scroll-warp[data-v-2b1a346c]{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}.zjapp .scroll-warp-pulling[data-v-2b1a346c]{overflow:hidden}.zjapp .scroll-warp-complete[data-v-2b1a346c]:after{content:"";display:block;height:100px}.zjapp .scroll-warp-empty[data-v-2b1a346c]{display:flex;flex-direction:column}.zjapp .pull-refresh-warp[data-v-2b1a346c]{position:relative;height:0;overflow:hidden}.zjapp .pull-refresh[data-v-2b1a346c]{position:absolute;left:0;bottom:0;height:70px;width:100%;padding:6px;text-align:center}.zjapp .pull-refresh-date[data-v-2b1a346c]{margin-top:4px;height:16px;line-height:16px;font-size:12px;color:#bcbcbc}.zjapp .page-loading[data-v-2b1a346c]{padding:10px;text-align:center}.zjapp .end-text[data-v-2b1a346c]{color:#c8c8c8;background:#f4f4f4;position:relative;line-height:76px;height:76px;text-align:center}.zjapp .end-text[data-v-2b1a346c]:after,.zjapp .end-text[data-v-2b1a346c]:before{content:"";position:absolute;width:48px;height:1px;background:#e4e4e4;top:50%;margin-top:-1px}.zjapp .end-text[data-v-2b1a346c]:after{left:50%;transform:translateX(-92px)}.zjapp .end-text[data-v-2b1a346c]:before{right:50%;transform:translateX(90px)}.zjapp .end-slot[data-v-2b1a346c]{padding:30px;line-height:18px;text-align:center;color:#c8c8c8}',""])},aca8:function(t,e,i){"use strict";i.r(e);i("5ab2"),i("6d57"),i("e10e"),i("ed63"),i("8cf2"),i("163d"),i("e697"),i("cc57"),i("e204");var n=i("28f8"),a=(i("6a61"),i("2e91")),o=i("07d2"),s=i("cd05"),r=i("5a71"),c=i("88c7"),l=i("3c77"),p=i("774b"),d=i("6948"),h=i("3bd5"),u=i("3516"),f=i("37d5"),m=i("e2a7"),g=i("2757"),b=i("162a"),v=i("7cb8");function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var w,k,S,_={components:{SingleSelect:r.default,UserSelect:s.a,MultiSelect:c.a,Item:o.default,TreeBase:l.a,Scroller:p.default,NumberInput:d.a},data:function(){return{type:"add",batchId:"",project:{},batchName:"",template:{},contracts:[],inspectors:[],cc:[],templateItems:[],templateTree:[],templateTreeLoading:!0,targetUser:{},templateOptions:[],contractsOptions:[],inspectorOptions:[],ccOptions:[]}},computed:{currentProject:function(){return this.$store.state.global.currentProject},hasCombo:function(){var t=this.template&&this.template.mode;return(99===t||100===t)&&"add"===this.type}},activated:function(){this.batchId=this.$route&&this.$route.query&&this.$route.query.id||"",this.init()},destroyed:function(){window.clearTimeout(this.timeoutEvent)},methods:{init:(S=Object(a.a)(regeneratorRuntime.mark((function t(){var e,i,n,a,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.type=this.batchId?"edit":"add",!this.batchId){t.next=6;break}return t.next=4,this.loadData();case 4:t.next=9;break;case 6:return t.next=8,this.initData();case 8:this.timeoutEvent=window.setTimeout((function(){o.$refs.batch_add_name_input.focus()}),400);case 9:if(!this.template||6!==this.template.mode){t.next=12;break}return t.next=12,this.getContractOptions();case 12:return t.next=14,g.b.getTemplateList();case 14:return this.templateOptions=t.sent,t.next=17,f.default.getProjectUsers(this.project.id,[31,32,33]);case 17:if(t.t0=t.sent,t.t0){t.next=20;break}t.t0=[];case 20:e=t.t0,this.inspectorOptions=e.map((function(t){return y({},t)})),this.ccOptions=e.map((function(t){return y({},t)})),i=this.inspectorOptions.findIndex((function(t){return t.id===o.targetUser.id})),n=this.inspectorOptions[i],i>=0&&(a=this.inspectorOptions.splice(i,1),this.inspectorOptions.unshift(a[0])),n&&(n.checked=!0,n.disabled=!0,this.inspectors.some((function(t){return t.id===n.id}))||this.inspectors.push(n));case 27:case"end":return t.stop()}}),t,this)}))),function(){return S.apply(this,arguments)}),loadData:(k=Object(a.a)(regeneratorRuntime.mark((function t(){var e,i,n,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.getBatchById(this.batchId);case 2:return e=t.sent,i=[],t.next=6,u.a.getBatchUsers(this.batchId);case 6:if(t.t0=t.sent,t.t0){t.next=9;break}t.t0=[];case 9:return n=t.t0,t.next=12,u.a.getBatchCCs(this.batchId);case 12:if(t.t1=t.sent,t.t1){t.next=15;break}t.t1=[];case 15:if(a=t.t1,6!==e.temp_mode){t.next=20;break}return t.next=19,g.a.getBatchContracts(this.batchId);case 19:i=t.sent;case 20:this.targetUser={id:e.created_by,name:e.created_by_name},this.project={id:e.proj_id,name:e.proj_name},this.batchName=e.name,this.template={id:e.temp_id,name:e.temp_name,mode:e.temp_mode,template_extension:e.template_extension},this.contracts=i,this.inspectors=n.map((function(t){return{id:t.user_id,name:t.user_name,checked:!0}})),this.cc=a,this.templateTree=[];case 28:case"end":return t.stop()}}),t,this)}))),function(){return k.apply(this,arguments)}),initData:function(){var t=h.a.getUser();this.targetUser={id:t.user_id,name:t.user_name},this.project=this.currentProject,this.batchName="",this.template={},this.contracts=[],this.inspectors=[],this.cc=[],this.templateTree=[]},getContractOptions:function(){var t=this;return g.b.getContractList(this.project.id).then((function(e){t.contractsOptions=e}))},beforeCheckContract:function(t){var e=(this.contracts||[]).find((function(e){return e.id===t.id}));if(e&&e.problemNum)return m.a.alert("此合同有相关检查记录，不可删除"),!1},saveBatch:function(){var t=this,e={batch:{id:this.batchId,batch_type:u.a.getBatchType("special-inspect"),proj_id:this.currentProject.id,bidsection_id:"",name:this.batchName,template_id:this.template&&this.template.id,batch_purpose:"正式",status:"检查中",contracts:(this.contracts||[]).map((function(t,e){return{id:t.id,remark:t.remark,sort:e+1}})),template_extension:this.template.template_extension},batch_user:this.inspectors.map((function(t){return t.id})),batch_cc:this.cc.map((function(t){return t.id}))};if(""!==this.batchName)if(this.template&&this.template.id)if(6!==this.template.mode||this.contracts&&this.contracts.length)if(this.inspectors&&this.inspectors.length){if(this.hasCombo){var i=this.templateItems.find((function(t){return!Object(v.i)(t.weight)}));if(i)return void m.a.alert("请填写 ".concat(i.name," 的权重"));e.tree=this.templateItems.map((function(t){return{id:t.id,weight:Number(t.weight)}}))}m.a.loading("请稍等..."),u.a.uploadBatch(e).then(function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.setDefaultBatch(i);case 2:t.$router.go(-1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(t){return m.a.hideLoading(),m.a.alert(t)})).finally((function(){m.a.hideLoading()}))}else m.a.alert("请选择检查人");else m.a.alert("请选择相关合同");else m.a.alert("请选择检查模板");else m.a.alert("请输入批次名称")},onSelectTemplate:function(t){[100,99].includes(t.mode)?this.getTemplateTree(t.id):[6].includes(t.mode)&&this.getContractOptions()},getTemplateTree:(w=Object(a.a)(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.templateTreeLoading=!0,t.next=3,b.a.request("/online/special-inspect/get-template-tree",{template_id:e});case 3:i=t.sent,this.templateItems=i,this.templateTree=Object(v.c)(i),this.templateTreeLoading=!1;case 7:case"end":return t.stop()}}),t,this)}))),function(t){return w.apply(this,arguments)})}},j=(i("d3276"),i("17cc")),O=Object(j.a)(_,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{title:"add"===t.type?"新建批次":"编辑批次","show-go-root":!0}},[i("scroller",[i("div",{staticClass:"list"},[i("item",{attrs:{label:"项目",text:t.project.name,mode:"edit"}}),i("item",{attrs:{label:"批次名称",mode:"edit"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.batchName,expression:"batchName"}],ref:"batch_add_name_input",staticClass:"input-align-r",attrs:{slot:"right",type:"text",placeholder:"请填写"},domProps:{value:t.batchName},on:{input:function(e){e.target.composing||(t.batchName=e.target.value)}},slot:"right"})]),i("single-select",{attrs:{title:"检查模板",options:t.templateOptions,mode:"edit",editabled:"add"===t.type},on:{onSelect:t.onSelectTemplate},model:{value:t.template,callback:function(e){t.template=e},expression:"template"}}),6===t.template.mode?i("multi-select",{ref:"selectMaterialType",attrs:{options:t.contractsOptions,"selected-text":t.contracts&&t.contracts.length?t.contracts.length+"个":"",title:"相关合同","right-btn":"确定","check-box-ali-right":!0,"before-check":t.beforeCheckContract},model:{value:t.contracts,callback:function(e){t.contracts=e},expression:"contracts"}}):t._e(),t._l(t.contracts,(function(e,n){return i("div",{key:n,staticClass:"item-contract",class:{"border-bottom":n+1!==t.contracts.length}},[i("icon",{staticClass:"item-contract-icon",attrs:{name:"list-index"}}),i("div",{staticClass:"item-contract-index",domProps:{textContent:t._s(n+1)}}),i("div",{staticClass:"item-contract-name",domProps:{textContent:t._s(e.name)}}),i("div",{staticClass:"item-contract-code",domProps:{textContent:t._s(e.code)}}),i("div",{staticClass:"item-contract-textarea border-top"},[i("textarea",{directives:[{name:"autoheight",rawName:"v-autoheight"},{name:"model",rawName:"v-model",value:e.remark,expression:"contract.remark"}],attrs:{placeholder:"合同当前进度描述(选填)",maxlength:"200"},domProps:{value:e.remark},on:{input:function(i){i.target.composing||t.$set(e,"remark",i.target.value)}}})])],1)}))],2),i("div",{staticClass:"list mt10"},[i("user-select",{attrs:{options:t.inspectorOptions,title:"检查人",multi:!0},model:{value:t.inspectors,callback:function(e){t.inspectors=e},expression:"inspectors"}}),i("user-select",{attrs:{options:t.ccOptions,title:"抄送人",multi:!0},model:{value:t.cc,callback:function(e){t.cc=e},expression:"cc"}})],1),t.hasCombo?i("div",{staticClass:"list mt10"},[t.templateTreeLoading?t._e():[i("div",{staticClass:"title"},[t._v("权重配置")]),t.templateTree.length?i("tree-base",{staticClass:"tree-base",attrs:{data:t.templateTree,"indent-size":10,"default-open-level":1/0},scopedSlots:t._u([{key:"right",fn:function(e){return[i("div",{staticClass:"tree-base-right",on:{click:function(t){t.stopPropagation()}}},["add"===t.type?i("number-input",{staticClass:"mr5",attrs:{decimal:2,range:[0,100]},model:{value:e.data.weight,callback:function(i){t.$set(e.data,"weight",i)},expression:"item.data.weight"}}):i("span",[t._v(t._s(e.data.weight))]),i("span",[t._v("%")])],1)]}}])}):t._e()],i("loading-status",{staticStyle:{"min-height":"230px"},attrs:{"is-loading":t.templateTreeLoading,"is-empty":!t.templateTree.length,"empty-text":"请在PC端添加评分模板"}})],2):t._e(),i("app-button-group",["add"===t.type?i("app-button",{on:{click:t.saveBatch}},[t._v("\n        提交\n      ")]):i("app-button",{on:{click:t.saveBatch}},[t._v("\n        保存\n      ")])],1)],1)],1)}),[],!1,null,"6576198e",null);e.default=O.exports},b225:function(t,e,i){"use strict";i("ef48")},b65c:function(t,e,i){"use strict";(function(t){i("5ab2"),i("e10e"),i("f548"),i("9dd9"),i("cc57");var n=i("28f8"),a=(i("6d57"),i("de78"),i("9eea")),o=i("b850"),s=i("774b"),r=i("e89f");function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"AppMultiSelect",components:{appSearchBar:a.default,item:o.a,Scroller:s.default},mixins:[r.a],props:{},data:function(){return{activeTab:[],storageKey:encodeURI(this.title||"multiSelectMark"),storageVal:[],keyword:"",searchStatus:!1,isHasVal:!1,checkedItem:{},show:!1,searchData:[],showSelected:!1,listTile:"",selectedNames:"",options:[],optionsLimit:20,pagingOptions:!1,searchBar:!0,category:[]}},computed:{optionsShow:function(){return this.options&&this.options.length?this.grouping?this.getGroupData():this.options.slice(0,this.optionsLimit):[]},realChecked:function(){return Object.values(this.checkedItem).filter((function(t){return!!t}))}},watch:{keyword:function(t){var e=this;this.$nextTick((function(){e.filterList(t)}))}},methods:{openPopup:function(e){this.value=!0,this.show=!0,this.title=e.title,this.selected=e.selected,this.options=e.options,this.onSelect=e.onSelect,this.searchBar=e.searchBar,this.grouping=e.grouping,this.rightBtn=e.rightBtn,this.rightBtnEvent=e.rightBtnEvent,this.checkBoxAliRight=e.checkBoxAliRight,this.showSelected=e.showSelected,this.listTile=e.listTile,this.beforeCheck=e.beforeCheck,t.isEmpty(this.selected)&&(this.selectedNames=""),this.setValue(e.selected),this.$emit("open")},setValue:function(t){var e={};t&&t.length?(t.forEach((function(t){t&&(e[t.id]=t)})),this.checkedItem=e):this.checkedItem={}},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeEvent:function(){this.value=!1,this.show=!1,this.keyword="",this.searchStatus=!1,this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch()},selectItem:function(e){var i=this;if(!e.disabled){var n=this.beforeCheck&&this.beforeCheck(e);n instanceof Promise||(n=Promise.resolve(n)),n.then((function(n){if(!1!==n){var a=l({},i.checkedItem);if(i.$refs["app-search-bar"]&&i.$refs["app-search-bar"].saveHistory(),i.checkedItem[e.id]?delete a[e.id]:a[e.id]=e,i.checkedItem=a,i.showSelected){var o=[];t.each(i.checkedItem,(function(t){o.push(t.name)})),i.selectedNames=o.join("、")}}}))}},onSearchTypeChange:function(t){this.searchStatus=t},onInput:function(t){this.isHasVal=!!t},filterList:function(t){var e,i,n=this,a=new RegExp("("+t+")","gmi");if(this.category=[],this.keyword=t,this.searchData=[],!t)return!1;this.options.map((function(t){return a.test(t.name)&&(i=l(l({},t),{},{rename:t.name.replace(a,"<label>$1</label>")}),n.grouping?-1===(e=n.category.indexOf(i[n.grouping]))?(n.category.push(i[n.grouping]),n.searchData.push({name:i[n.grouping],children:[i]})):n.searchData[e].children.push(i):n.searchData.push(i)),t}))},pageOptions:function(){this.optionsLimit=this.optionsLimit+20,this.pagingOptions=!1},getGroupData:function(){var t,e=this,i=[];return this.category=[],this.options.map((function(n){return-1===(t=e.category.indexOf(n[e.grouping]))?(e.category.push(n[e.grouping]),i.push({name:n[e.grouping],children:[n]})):i[t].children.push(n),n})),i},submit:function(){var t=Object.values(this.checkedItem);this.onSelect(t),this.closeEvent()},getHadSelectValue:function(){return Object.values(this.checkedItem)}}}}).call(this,i("391c"))},b66d:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .tree-node[data-v-0083fc0a]{display:flex;flex-direction:row;align-items:center;justify-content:center;padding:8px 15px}.zjapp .tree-main[data-v-0083fc0a]{flex:1}.zjapp .tree-text[data-v-0083fc0a]{font-size:14px;color:#333;line-height:20px;padding:5px 0;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2}.zjapp .tree-indent[data-v-0083fc0a]{width:14px;height:20px}.zjapp .tree-icon[data-v-0083fc0a]{position:relative;width:20px;height:20px;line-height:20px;color:#c8c8c8;font-size:26px}.zjapp .icon-dropdown[data-v-0083fc0a]:before,.zjapp .icon-dropright[data-v-0083fc0a]:before{content:"";position:absolute;width:0;height:0;border:6px solid #c8c8c8}.zjapp .icon-dropdown[data-v-0083fc0a]:before{top:7px;left:0;border-left-color:transparent}.zjapp .icon-dropdown[data-v-0083fc0a]:before,.zjapp .icon-dropright[data-v-0083fc0a]:before{border-right-color:transparent;border-bottom-color:transparent}.zjapp .icon-dropright[data-v-0083fc0a]:before{top:4px;left:2px;border-top-color:transparent}.zjapp .icon-right[data-v-0083fc0a]{margin-left:10px;color:#c8c8c8;line-height:30px}',""])},b850:function(t,e,i){"use strict";var n={name:"MultiSelectItem",props:{item:{type:Object,default:function(){return{id:"",name:""}}},checked:{type:Boolean,default:!1},alignRight:{type:Boolean,default:!1},renderField:{type:String,default:"name"},disabled:{type:Boolean,default:!1}},methods:{selectItem:function(t){this.disabled||this.$emit("click",t)}}},a=(i("c85b"),i("17cc")),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("van-cell",{staticClass:"single-item",attrs:{clickable:!0},on:{click:function(e){t.selectItem(t.item)}}},[i("div",{staticClass:"wrapper"},[i("span",{class:{checkbox:!0,checked:t.checked,disabled:t.disabled},style:{order:t.alignRight?10:0}},[i("i",{staticClass:"van-icon van-icon-success"})]),i("div",{staticClass:"checkboxtxt",class:{"disabled-text":t.disabled}},[i("span",{domProps:{innerHTML:t._s(t.item[t.renderField])}}),t.alignRight?i("p",{staticClass:"f12 color-gray"},[t._v(t._s(t.item.code))]):t._e()])])])}),[],!1,null,"b3cb8602",null);e.a=o.exports},c74e:function(t,e,i){var n=i("cf37");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("273bfe72",n,!0,{sourceMap:!1,shadowMode:!1})},c7df:function(t,e,i){"use strict";(function(t){i("cc57");var n=i("07d2"),a=i("3730"),o=i("6144");e.a={name:"MultiSelect",components:{Item:n.default},props:{title:{type:String,default:""},value:{type:Array,default:function(){return[]}},options:{type:Array,default:function(){return[]}},selectedText:{type:String,default:""},required:{type:Boolean,default:!0},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},beforeOpen:{type:Function,default:function(){}},beforeCheck:{type:Function,default:function(){}},searchBar:{type:Boolean,default:!0},checkBoxAliRight:{type:Boolean,default:!1},grouping:{type:String,default:""},rightBtn:{type:String,default:""},rightBtnEvent:{type:Function,default:function(){return 0}}},data:function(){return{memoryKey:this.$route.name+encodeURI(this.title)}},computed:{selectVal:function(){return""!==this.selectedText?this.selectedText:this.value&&this.value.length?this.value.map((function(t){return t.name})).join("、"):"view"===this.mode?"无":""}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var e=this;if(this.editabled){var i=this.beforeOpen();i&&i.then&&t.isFunction(i.then)?i.then((function(t){!1!==t&&e.openPopup()})):!1!==i&&this.openPopup()}},renderSelected:function(t){a.a.selectItem(t)},openPopup:function(){var t=this;a.a.openPopup({title:"选择"+this.title,selected:this.value,options:this.options,required:this.required,searchBar:this.searchBar,grouping:this.grouping,rightBtn:this.rightBtn,checkBoxAliRight:this.checkBoxAliRight,beforeCheck:this.beforeCheck,onSelect:function(e){t.$emit("input",e),t.$emit("onSelect",e)},rightBtnEvent:function(e){t.$emit("rightBtnEvent",e)}})},setDialogValue:function(t){a.a.setValue(t)},getDialogValue:function(){return a.a.getHadSelectValue()},closePopup:function(){a.a.closePopup()},onSelect:function(t){this.$emit("input",t),this.$emit("onSelect",t)},setSelected:function(){var e=o.a.getObject(this.memoryKey,o.a.level.user);!1===this.editabled||t.isEmpty(this.options)||(t.isEmpty(this.value)?this.memory&&!t.isEmpty(e)&&t.some(this.options,{id:e.id})&&(this.$emit("input",e),this.autoSelect&&this.$emit("onSelect",e)):this.autoSelect&&this.$emit("onSelect",this.value))}}}}).call(this,i("391c"))},c85b:function(t,e,i){"use strict";i("f6e3")},cf37:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .item-contract[data-v-6576198e]{position:relative;padding:13px 15px;background-color:#fff}.zjapp .item-contract-icon[data-v-6576198e]{top:16px;left:15px;font-size:14px}.zjapp .item-contract-icon[data-v-6576198e],.zjapp .item-contract-index[data-v-6576198e]{position:absolute;width:14px;height:14px;line-height:14px;color:#4275e8}.zjapp .item-contract-index[data-v-6576198e]{top:19px;left:24px;font-size:10px;font-weight:700}.zjapp .item-contract-name[data-v-6576198e]{padding-left:22px;font-size:14px;line-height:20px;color:#666}.zjapp .item-contract-code[data-v-6576198e]{margin-top:4px;padding-left:22px;font-size:12px;line-height:18px;color:#999}.zjapp .item-contract-textarea[data-v-6576198e]{margin-top:13px;padding:13px 0 13px 22px;font-size:12px;line-height:20px;color:#999}.zjapp .item-contract-textarea textarea[data-v-6576198e]{width:100%;line-height:20px;border:none}.zjapp .title[data-v-6576198e]{position:relative;color:#333;height:46px;line-height:46px;background:#fff;padding-left:15px;font-size:16px;border-bottom:1px solid #ececec}.zjapp .title[data-v-6576198e]:after{content:"";width:4px;height:16px;background:#4275e8;position:absolute;top:50%;left:0;margin-top:-8px}.zjapp .tree-base-right[data-v-6576198e]{display:flex;align-items:center;height:28px;padding-left:5px;font-size:16px}.zjapp .tree-base[data-v-6576198e] .tree-node{background-color:#fafafa}.zjapp .tree-base[data-v-6576198e] .tree-node-level-0,.zjapp .tree-base[data-v-6576198e] .tree-node-level-1{background-color:#fff}.zjapp .tree-base[data-v-6576198e] .tree-node .tree-text{color:#666;font-size:16px}.zjapp .tree-base[data-v-6576198e] .tree-node-level-0 .tree-text{font-weight:500}.zjapp .tree-base[data-v-6576198e] .tree-node-level-0,.zjapp .tree-base[data-v-6576198e] .tree-text .tree-node-level-1 .tree-text{color:#333}',""])},d18d:function(t,e,i){"use strict";(function(t){i("2b45");var n,a=i("4360"),o=i("48f4"),s=i("162a"),r=i("e2a7"),c=i("a500"),l=i("6f9e"),p={};e.a={name:"Scroller",props:{buildingId:{type:String,default:""},hasNext:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},isSync:{type:Boolean,default:!0},endText:{type:String,default:""},memoryScrollTop:{type:Boolean,default:!0},keepScrollTop:{type:Boolean},hasPullDown:{type:Boolean,default:!0},onPullDown:{type:Function}},data:function(){return{pullDist:0,refreshing:!1,pulling:!1,loading:!1,scrollTop:0,isCurrKeyboard:!1,gapBottom:0}},computed:{allowPullDown:function(){return this.hasPullDown&&(!!this.$listeners.pullDown||!!this.onPullDown)},updateTime:function(){return a.a.state.global.businessDownloadTime},numberKeyboardCoverHeight:function(){return a.a.state.global.isNumberInputOpen?a.a.state.global.numberKeyboardHeight-this.gapBottom:0}},mounted:function(){var t=this;l.a.$on("numberKeyboardOpen",this.onNumberKeyboardOpen),this.$nextTick((function(){var e=t.$refs["scroll-warp"]&&t.$refs["scroll-warp"].getBoundingClientRect&&t.$refs["scroll-warp"].getBoundingClientRect();e&&(t.gapBottom=document.documentElement.clientHeight-e.bottom),t.$el&&t.$el.addEventListener("focus",(function(e){var i=e&&e.target,n=i&&i.tagName&&i.tagName.toLowerCase();if("input"===n||"textarea"===n){window.addEventListener("resize",(function e(){var n=i.getBoundingClientRect(),a=t.$el.getBoundingClientRect(),o=n.bottom-a.bottom;o>0&&t.scrollBy(o),window.removeEventListener("resize",e,!1)}),!1)}}),!0)}))},destroyed:function(){l.a.$off("numberKeyboardOpen",this.onNumberKeyboardOpen)},activated:function(){var t=this.keepScrollTop||this.$router.isBack&&this.memoryScrollTop;this.scrollTop&&t&&(this.$refs["scroll-warp"].scrollTop=this.scrollTop)},deactivated:function(){this.memoryScrollTop&&(this.scrollTop=this.$refs["scroll-warp"].scrollTop)},methods:{onScroll:function(t){var e=this,i=this.$refs["scroll-warp"].scrollTop,n=this.$refs["scroll-warp"].scrollHeight;if(i+this.$refs["scroll-warp"].clientHeight>=n-5&&!this.loading&&this.hasNext){this.loading=!0;var a=this.$listeners.loadNext();a&&a.then&&"function"==typeof a.then?a.then((function(){e.loading=!1})):this.loading=!1}this.$emit("scroll",t)},getTouchDiretion:function(t){if(!(p&&t&&t.touches&&t.touches[0]))return"";var e=t.touches[0].clientX,i=t.touches[0].clientY;return Math.abs(i-p.y)>Math.abs(e-p.x)&&Math.abs(i-p.y)>=3?i>p.y?"down":"up":""},onTouchstart:function(t){this.allowPullDown&&t.touches&&1===t.touches.length&&(p={x:t.touches[0].clientX,y:t.touches[0].clientY,scrollTop:this.$refs["scroll-warp"].scrollTop,pullDist:this.pullDist})},onTouchmove:function(t){if(this.allowPullDown&&t.touches&&1===t.touches.length){var e=this.$refs["scroll-warp"].scrollTop,i=t.touches[0].clientY,n=i-p.y,a=this.getTouchDiretion(t);"down"===a?!this.refreshing&&e<=0?(this.pulling=!0,this.pullDist=(n-p.scrollTop)/2,t.preventDefault()):this.pulling=!1:"up"===a?this.pullDist>0&&(this.pullDist=p.pullDist-(p.y-i),t.preventDefault()):this.pullDist=p.pullDist}},onTouchend:function(){var t=this;this.allowPullDown&&(p={},this.pulling=!1,this.pullDist>=70&&this.isSync?this.refreshing?this.makePullTo(70):this.makePullTo(70).then((function(){if(t.refreshing=!0,t.onPullDown){var e=t.onPullDown();e&&e.then&&"function"==typeof e?e.finally((function(){t.refreshing=!1,t.makePullTo(0)})):(t.refreshing=!1,t.makePullTo(0))}else t.dataSync().then((function(){t.refreshing=!1,t.makePullTo(0),t.$emit("pullDown")})).catch((function(){t.refreshing=!1,t.makePullTo(0),t.$emit("pullDown")}))})):(this.refreshing=!1,this.makePullTo(0)))},makePullTo:function(t){var e=this,i=this.pullDist,n=t,a=n-i,o=i;return i===n?Promise.resolve():new Promise((function(t){!function s(){window.requestAnimationFrame((function(){o+=a/6,e.pullDist=o,i<n&&o<n||i>n&&o>n?s():(e.pullDist=n,e.refreshing=!1,t())}))}()}))},dataSync:function(){var t,e=o.default.getCurrentModuleCode(),i=o.default.getCurrentRoute(),n=i.meta&&i.meta.isTodo;if(o.default.isModuleNeedBuilding(e)&&!n){if(!this.buildingId)return new Promise((function(t){setTimeout((function(){t()}),500)}));t=this.buildingId}return c.a.addTrack("公共-手动下拉刷新","",""),s.a.beginManualUpdate(),o.default.checkSync(t).then((function(t){return s.a.endManualUpdate(),t})).catch((function(t){$log.error("下拉刷新错误",t),t&&"Error: Network Error"===t.toString()?r.a.alert("当前网络无法同步数据"):r.a.alert(t),s.a.endManualUpdate()}))},getScrollHeight:function(){return this.$refs["scroll-warp"].offsetHeight},getScrollTop:function(){return this.$refs["scroll-warp"].scrollTop},setScrollTop:function(t){this.$refs["scroll-warp"].scrollTop=t},scrollBy:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,a=this.getScrollTop(),o=a+t,s=Math.round(i/16.7),r=t/s,c=a,l=n=+new Date;return a===o?Promise.resolve():new Promise((function(t){!function i(){window.requestAnimationFrame((function(){l===n&&(c+=r,e.$refs["scroll-warp"].scrollTop=c,a<o&&c<o||a>o&&c>o?i():(e.$refs["scroll-warp"].scrollTop=o,t()))}))}()}))},scrollTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=this.getScrollTop(),n=t-i;return this.scrollBy(n,e)},scrollToEle:function(t){var e=t.keyboardHeight||232,i=(t=t.$el?t.$el:t).getBoundingClientRect(),n=this.$refs["scroll-warp"].getBoundingClientRect();if(i&&n){var o=document.documentElement.clientHeight-(a.a.state.global.isNumberInputOpen?e:0),s=n.bottom<o?n.bottom:o,r=n.top-i.top,c=i.bottom-s;r>0?this.scrollBy(-r-10):c>0&&this.scrollBy(c+10)}},isCurrent:function(e,i){var n=this;e.length&&t.each(e,(function(t){t._uid===i?n.isCurrKeyboard=!0:n.isCurrent(t.$children,i)}))},onNumberKeyboardOpen:function(t){this.isCurrKeyboard=!1,this.isCurrent(this.$children,t._uid),this.isCurrKeyboard&&this.scrollToEle(t)}}}}).call(this,i("391c"))},d3276:function(t,e,i){"use strict";i("c74e")},ef48:function(t,e,i){var n=i("9d55");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("a1a65c0c",n,!0,{sourceMap:!1,shadowMode:!1})},f6e3:function(t,e,i){var n=i("53bf");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("d3b0c900",n,!0,{sourceMap:!1,shadowMode:!1})}}]);