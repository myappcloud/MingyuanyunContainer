(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-fe254fc0","chunk-3adbbd26","chunk-2d2263f6"],{"0416":function(t,e,i){"use strict";i("068e")},"068e":function(t,e,i){var a=i("771c");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("1ce02ce6",a,!0,{sourceMap:!1,shadowMode:!1})},"0732":function(t,e,i){var a=i("81f2");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("1b5b07de",a,!0,{sourceMap:!1,shadowMode:!1})},"0ab5":function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e"),i("ed63"),i("8cf2");var a,n,o,r,s,c,l,d=i("28f8"),u=(i("6a61"),i("2e91")),p=i("195b"),m=i("6948"),h=i("07d2"),f=i("fd50"),g=i("e2a7"),b=i("6e1b"),v=i("3516"),x=i("894d"),_=i("3bd5"),y=i("264e");function I(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function k(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?I(Object(i),!0).forEach((function(e){Object(d.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"JFKFEdit",components:{edit:p.a,NumberInput:m.a,Item:h.default},data:function(){return{currentUserId:_.a.getUser().user_id,checkItemData:{base:{},problemList:[],batchData:{},other:{}},rootId:"",specialInspectId:"",checkItemId:"",mode:1,templateType:1,buttonConfig:{save:!1,submit:!0},edit:!1}},computed:{score:function(){return this.checkItemData.base.score||0},problemList:function(){var t=this.checkItemData.batchData.template_extension;return t&&2===t.score_mode},labelName:function(){var t=this.checkItemData.batchData.template_extension;return t&&1===t.score_mode?"加分值":"扣分值"},deduction:{get:function(){return String(this.problemData.deduction)},set:function(t){this.problemData.deduction=t}}},activated:function(){this.needRepair=!1,this.init()},methods:{init:(l=Object(u.a)(regeneratorRuntime.mark((function e(){var i,a,n,o,r,s,c,l,d,u,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.$route.query,a=i.specialInspectId,n=i.checkItemId,o=i.rootId,r=i.mode,this.checkItemData.other=k({},this.$route.query),this.specialInspectId=a,this.checkItemId=n,this.rootId=o,this.mode=parseInt(r),e.next=8,b.a.getSpecialInspectCheckItemDetail(this.specialInspectId);case 8:return s=e.sent,this.checkItemData.base=new x.b(s).getData(),e.next=12,v.a.getBatch(this.checkItemData.base.batch_id);case 12:if(c=e.sent,this.checkItemData.batchData=new x.a(c).getData(),this.templateType=parseInt(r)||1,!c.root_id&&!c.parent_id){e.next=19;break}return e.next=18,v.a.getBatchUsers(c.root_id||c.parent_id);case 18:l=e.sent;case 19:return e.next=21,v.a.getBatchUsers(this.checkItemData.base.batch_id);case 21:d=e.sent,u=l||d,p=t.some(u,{user_id:this.currentUserId}),this.editable=this.checkItemData.batchData.status!==y.a&&p,this.edit=this.editable,this.isLoading=!1;case 27:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)}),submit:(c=Object(u.a)(regeneratorRuntime.mark((function t(e){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveItem(k(k({},e),{},{status:y.a}));case 2:g.a.alert("提交成功"),setTimeout((function(){i.$router.go(-1)}),500);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)}),deductionChange:(s=Object(u.a)(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.checkItemData.base.status,y.d.includes(i)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.saveItem({status:y.b});case 5:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)}),imageChange:(r=Object(u.a)(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.checkItemData.base.status,y.d.includes(i)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.saveItem(k(k({},e),{},{status:y.b}));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)}),save:(o=Object(u.a)(regeneratorRuntime.mark((function t(e){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveItem(k(k({},e),{},{status:y.b}));case 2:g.a.alert("保存成功"),setTimeout((function(){i.$router.go(-1)}),500);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)}),deleteFn:(n=Object(u.a)(regeneratorRuntime.mark((function t(e){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveItem({deduction:0,imageList:[],status:y.c});case 2:g.a.alert("保存成功"),setTimeout((function(){i.$router.go(-1)}),500);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)}),saveItem:(a=Object(u.a)(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isSaving){t.next=2;break}return t.abrupt("return",f.a.when());case 2:return this.isSaving=!0,i={id:this.specialInspectId,status:e.status||y.b,deduction:this.checkItemData.base.deduction},e.imageList&&(i.image_file=JSON.stringify(e.imageList)),e.hasOwnProperty("deduction")&&(i.deduction=e.deduction),t.next=8,b.a.saveSpecialInspectCheckItemDetail(i,y.d.includes(e.status));case 8:this.isSaving=!1;case 9:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)}),keyboardBlur:function(){this.deduction=this.deduction>this.maxInput?this.maxInput:this.deduction}}}}).call(this,i("391c"))},"0dc2":function(t,e,i){var a=i("8fdd");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("1dfae8a1",a,!0,{sourceMap:!1,shadowMode:!1})},"195b":function(t,e,i){"use strict";var a=i("f369"),n=i("07d2"),o=i("e68e"),r=i("7378"),s=i("3bd5"),c=i("f647"),l=i("9416"),d=i("8d95"),u={name:"CheckCmptEdit",components:{CheckGuide:a.a,Item:n.default,ItemImgList:o.a,ProblemList:r.a},props:{problemList:{type:Boolean,default:function(){return!1}},edit:{type:Boolean,default:function(){return!1}},button:{type:Object,default:function(){return{save:!0,submit:!0}}},detail:{type:Object,default:function(){return{base:{},problemList:[]}}}},data:function(){return{title:Object(l.a)(d.a.SPECIAL_INSPECT)||"专项巡检",png_empty:"",isLoading:!1,isSaving:!1,specialInspectId:"",user:s.a.getUser(),maxInput:99.9,backCount:-1,viewSize:$rootScope.viewSize,allowSelectPlace:!1,showNumKeyboard:!1,needRepair:!1,templateType:"",descriptionData:[],pageStatus:"",imageList:[],problemModel:c.a}},computed:{},watch:{"detail.base":{handler:function(t,e){this.imageList=t.image_file||[]},immediate:!0}},activated:function(){this.needRepair=!1,this.init()},methods:{init:function(){this.problemModel.init(null,null,null,this.$route.query),this.specialInspectId=this.detail.base.id},openProblemDetail:function(t){var e;e="草稿"===t.status?"/special-inspect-problem-edit":"/special-inspect-problem-detail",this.$router.push({path:e,query:{specialInspectId:t.biz_id,problem_id:t.id,checkItemId:t.item_id,rootId:this.detail.other.rootId,mode:this.detail.other.mode}})},createProblem:function(){this.$router.push({path:"/special-inspect-problem-edit",query:{batchId:this.detail.batchData.id,specialInspectId:this.detail.base.id,checkItemId:this.detail.base.item_id,mode:this.detail.other.mode,rootId:this.detail.other.rootId}})},imageChange:function(){this.$emit("imageChange",this.getData())},save:function(){console.log(this.getData()),this.$emit("save",this.getData())},getData:function(){return{imageList:this.imageList}},deleteFn:function(){this.$emit("deleteFn",this.getData())},submit:function(){this.$emit("submit",this.getData())},formatDate:function(){}}},p=(i("552b"),i("17cc")),m=Object(p.a)(u,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{title:t.title,"show-go-root":!0}},[i("check-guide",{directives:[{name:"track",rawName:"v-track",value:"专项巡检-检查指引",expression:"'专项巡检-检查指引'"}],attrs:{slot:"header-bar-right","item-id":t.specialInspectId,module:"special-inspect"},slot:"header-bar-right"}),t.isLoading?t._e():i("div",{staticClass:"page-scroll"},[i("item",{attrs:{text:t.detail.base.full_name,border:"bottom"}}),t._t("form"),i("div",{directives:[{name:"show",rawName:"v-show",value:t.edit||!t.edit&&t.imageList&&t.imageList.length,expression:"edit || (!edit && imageList && imageList.length)"}],staticClass:"mt10"},[i("item",{staticClass:"p15 border-bottom"},[i("item-img-list",{attrs:{editabled:t.edit,maxlength:15},on:{callback:t.imageChange},model:{value:t.imageList,callback:function(e){t.imageList=e},expression:"imageList"}})],1)],1),t.problemList?[i("problem-list",{attrs:{list:t.problemModel.data.problemList,edit:t.edit},on:{add:t.createProblem,clickItem:t.openProblemDetail}})]:t._e()],2),"草稿"===t.detail.base.status?[i("app-button-group",[i("app-button",{attrs:{type:"text"},on:{click:t.deleteFn}},[t._v("\n        删除此草稿\n      ")])],1)]:t._e(),!t.isLoading&&t.edit?i("app-button-group",{attrs:{"fixed-bottom":"",seamless:""}},[i("app-button",{directives:[{name:"show",rawName:"v-show",value:"检查完毕"!==t.detail.base.status,expression:"detail.base.status !== '检查完毕'"}],staticStyle:{width:"50%"},attrs:{plain:""},on:{click:t.save}},[t._v("\n      暂存\n    ")]),i("app-button",{on:{click:t.submit}},[t._v("\n      提交\n    ")])],1):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"content-height":"viewSize.contentHeight - 50"}})],2)}),[],!1,null,"209ecd63",null);e.a=m.exports},"19a9":function(t,e,i){"use strict";i("7d4e")},"23df":function(t,e,i){var a=i("ca85");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("035b5144",a,!0,{sourceMap:!1,shadowMode:!1})},"264e":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return o})),i.d(e,"d",(function(){return r}));var a="检查完毕",n="未设置",o="草稿",r=[n,o]},3411:function(t,e,i){"use strict";i("ef1c")},4435:function(t,e,i){var a=i("5353");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("1aef4464",a,!0,{sourceMap:!1,shadowMode:!1})},"4aef":function(t,e,i){"use strict";var a=i("dd16").a,n=i("17cc"),o=Object(n.a)(a,(function(){var t=this.$createElement;return(this._self._c||t)("span",{class:this.classSet[this.status]},[this._v(this._s(this.text||this.status))])}),[],!1,null,null,null);e.a=o.exports},"515e":function(t,e,i){"use strict";var a=i("329b"),n=i("f1e4").a,o=(i("0416"),i("17cc")),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{class:{"content-not-empty":t.content.length},attrs:{mode:"dialog",title:"检查指引","on-close":t.closePopup}},[!t.isLoading&&t.title?i("div",{staticClass:"check-guide-detail-hd border-bottom"},[i("h2",{staticClass:"check-guide-detail-title pb10"},[t._v(t._s(t.title))])]):t._e(),!t.isLoading&&t.content.length?i("div",{staticClass:"check-guide-detail-content"},t._l(t.content,(function(e,a){return i("p",{key:a},[e.isImg&&e.src?i("img",{class:{"img-not-ready":!e.ready,error:"rejected"===e.status},attrs:{src:t.getThumbnail(e)},on:{error:function(i){t.imgError(e,a)},click:function(i){t.imgClick(e)}}}):t._e(),e.isImg?t._e():i("span",[t._v("\n          "+t._s(e.val)+"\n        ")])])}))):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.content.length,"empty-text":"PC端未设置检查指引"}})],1):t._e()],1)}),[],!1,null,"691b2f0f",null).exports,s=!1;s||(s=new(a.default.extend(r))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},5353:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .checked[data-v-209ecd63]{color:#4275e8}.zjapp .page-scroll[data-v-209ecd63]{flex:1;overflow:auto;padding-bottom:100px}.zjapp .deduction-title[data-v-209ecd63]{background-color:transparent}.zjapp .deduction-item[data-v-209ecd63] .item-text{font-size:14px}.zjapp .deduction-item[data-v-209ecd63] .icon{color:#4275e8}[data-v-209ecd63] .textarea-pass textarea{min-height:130px}",""])},"552b":function(t,e,i){"use strict";i("4435")},"6c2c":function(t,e,i){"use strict";var a=i("0e4d"),n=i("94ef"),o=function(){function t(e){Object(a.a)(this,t),this.data=e,this.buildData()}return Object(n.a)(t,[{key:"buildData",value:function(){this.data.template_extension=JSON.parse(this.data.template_extension||"{}")}}]),t}();e.a=o},7378:function(t,e,i){"use strict";var a=i("fa4f"),n=i("eb36"),o=i.n(n),r=i("6bf2"),s=i.n(r),c={name:"ProblemList",components:{ItemList:a.a},props:{edit:{type:Boolean,default:function(){return!1}},list:{type:Array,default:function(){return[]}}},data:function(){return{png_empty:o.a}},computed:{},methods:{createProblem:function(){this.$emit("add")},openProblemDetail:function(t){this.$emit("clickItem",t)},formatDate:function(t){return s()(t).format("YYYY-MM-DD HH:mm")}}},l=(i("8e66"),i("17cc")),d=Object(l.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"problem-wrap"},[i("div",{staticClass:"problem-wrap-title"},[i("div",{staticClass:"problem-title"},[t._v("问题列表("+t._s(t.list.length)+")")]),t.edit?i("div",{staticClass:"problem-btn",on:{click:t.createProblem}},[t._v("新增")]):t._e()]),i("div",{staticClass:"problem-list"},[t.list&&t.list.length?t._l(t.list,(function(e,a){return i("item-list",{key:a,attrs:{"is-unread":e.unread,"is-timeout":e.is_timeout,"is-urgent":"紧急"==e.emergency_degree||"特急"==e.emergency_degree,"is-return":e.sent_back_times>0,img:e.thumbnail,title:e.item_full_name,detail:e.desc||""+e.remark||"",footer:t.formatDate(e.created_on)+" "+(e.place||""),status:e.status,"status-text":e.status},on:{click:function(i){t.openProblemDetail(e)}}})})):[i("div",{staticClass:"empty"},[i("img",{attrs:{src:t.png_empty,alt:""}}),i("span",[t._v("暂无新增问题")])])]],2)])}),[],!1,null,"4cfa77e4",null);e.a=d.exports},"771c":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .content-not-empty[data-v-691b2f0f] .layout-content{display:auto;overflow:auto;padding-bottom:100px}.zjapp .check-guide-detail-hd[data-v-691b2f0f]{margin-left:30px;padding:25px 30px 5px 0}.zjapp .check-guide-detail-title[data-v-691b2f0f]{margin:0;line-height:20px;font-size:18px;color:#111;font-weight:700;word-break:break-all}.zjapp .check-guide-detail-info[data-v-691b2f0f]{line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .check-guide-detail-content[data-v-691b2f0f]{padding:30px;line-height:30px;color:#333;font-size:16px}.zjapp .check-guide-detail-content p[data-v-691b2f0f]{margin-bottom:30px;min-height:1em}.zjapp .check-guide-detail-content img[data-v-691b2f0f]{max-width:100%}.zjapp .check-guide-detail-content .img-not-ready[data-v-691b2f0f]{width:80px;height:auto}.zjapp .error[data-v-691b2f0f]{max-width:50%}",""])},"7d4e":function(t,e,i){var a=i("c59b");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("62c5f5a2",a,!0,{sourceMap:!1,shadowMode:!1})},"81f2":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .main[data-v-2cac8864]{position:fixed;width:100%;bottom:0}.zjapp .arrow[data-v-2cac8864]{position:absolute;top:-7px;right:18px;width:0;height:0;border-bottom:7px solid #fff;border-right:7px solid transparent;border-left:7px solid transparent}.zjapp .content[data-v-2cac8864]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-2cac8864]{display:flex;flex-direction:column;background-color:#fff;overflow:auto}.zjapp .box-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1}.zjapp .detail-hd[data-v-2cac8864]{display:flex;padding:6px 15px}.zjapp .detail-arrow-right[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-right[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:12px;border:5px solid transparent;border-left:5px solid #c8c8c8}.zjapp .detail-arrow-down[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-down[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:15px;border:5px solid transparent;border-top:5px solid #c8c8c8}.zjapp .detail-title[data-v-2cac8864]{flex:1;line-height:34px;color:#111;font-size:16px}.zjapp .detail-bd[data-v-2cac8864]{padding:8px 15px 8px 35px;background-color:#fafafa}.zjapp .text-line[data-v-2cac8864]{font-size:14px;color:#666;line-height:30px;margin-bottom:30px}.zjapp .detail-hd-single[data-v-2cac8864]{padding:6px 0;margin:0 15px}.zjapp .detail-bd-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1;padding:8px 15px;background-color:#fff}',""])},8634:function(t,e,i){"use strict";i.r(e);var a=i("0ab5").a,n=(i("b5db"),i("17cc")),o=Object(n.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("edit",{attrs:{"show-go-root":!0,detail:t.checkItemData,button:t.buttonConfig,edit:t.edit,"problem-list":t.problemList},on:{imageChange:t.imageChange,save:t.save,submit:t.submit,deleteFn:t.deleteFn}},[i("template",{slot:"form"},[i("item",{attrs:{label:"总分中加扣",mode:"edit"}},[i("template",{slot:"left"},[i("div",{staticClass:"item-label"},[i("span",{domProps:{textContent:t._s(t.labelName)}}),i("span",{staticClass:"item-label-desc",domProps:{textContent:t._s("(上限"+(t.score||"0")+"分)")}})])]),i("template",{slot:"right"},[i("div",{staticClass:"item-con align-r"},[i("number-input",{staticClass:"color-red",attrs:{disabled:!t.edit,decimal:2,range:[0,t.score],type:"positive"},on:{input:t.deductionChange},model:{value:t.checkItemData.base.deduction,callback:function(e){t.$set(t.checkItemData.base,"deduction",e)},expression:"checkItemData.base.deduction"}})],1),i("div",{staticClass:"item-font ml5"},[t._v("分")])])],2)],1)],2)}),[],!1,null,"d2920aba",null);e.default=o.exports},"894d":function(t,e,i){"use strict";i.d(e,"b",(function(){return u})),i.d(e,"a",(function(){return p}));i("2b45"),i("fc58");var a=i("0e4d"),n=i("94ef"),o=i("76ff"),r=i("4b67"),s=i("d703"),c=function(){function t(e){Object(a.a)(this,t),this.data=e,this.buildData()}return Object(n.a)(t,[{key:"buildData",value:function(){this.data.image_file=JSON.parse(this.data.image_file||"[]"),this.data.status_text=this.data.status}}]),t}(),l=i("6c2c");function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=Object(s.a)(t);if(e){var n=Object(s.a)(this).constructor;i=Reflect.construct(a,arguments,n)}else i=a.apply(this,arguments);return Object(r.a)(this,i)}}var u=function(t){Object(o.a)(i,t);var e=d(i);function i(t){var n;return Object(a.a)(this,i),(n=e.call(this,t)).data.deduction=n.data.deduction?n.data.deduction:0,n}return Object(n.a)(i,[{key:"getData",value:function(){return this.data}}]),i}(c),p=function(t){Object(o.a)(i,t);var e=d(i);function i(t){var n;return Object(a.a)(this,i),(n=e.call(this,t)).a=1,n}return Object(n.a)(i,[{key:"getData",value:function(){return this.data}}]),i}(l.a)},"8e66":function(t,e,i){"use strict";i("0dc2")},"8fdd":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .problem-wrap-title[data-v-4cfa77e4]{display:flex;justify-content:space-between;align-items:center;font-size:14px;color:#666;padding-left:15px;height:43px}.zjapp .problem-wrap-title .problem-btn[data-v-4cfa77e4]{padding:13px 15px;color:#4275e8}.zjapp .problem-wrap .problem-list[data-v-4cfa77e4]{background:#fff}.zjapp .problem-wrap .problem-list .problem-item[data-v-4cfa77e4]{display:flex;border-bottom:1px solid #ececec;padding:12px 15px}.zjapp .problem-wrap .problem-list .problem-item img[data-v-4cfa77e4]{width:70px;height:70px;background:coral;margin-right:10px}.zjapp .problem-wrap .problem-list .problem-item .content[data-v-4cfa77e4]{margin-right:10px;flex:1;display:flex;flex-direction:column;justify-content:space-between}.zjapp .problem-wrap .problem-list .problem-item .content .desc[data-v-4cfa77e4]{font-size:16px;color:#333;line-height:22px}.zjapp .problem-wrap .problem-list .problem-item .content .date[data-v-4cfa77e4]{color:#999;line-height:20px}.zjapp .problem-wrap .problem-list .problem-item .status[data-v-4cfa77e4]{display:flex;align-items:center;color:#0bc666}.zjapp .problem-wrap .problem-list .empty[data-v-4cfa77e4]{padding:40px 0;display:flex;flex-direction:column;align-items:center;color:#999}.zjapp .problem-wrap .problem-list .empty img[data-v-4cfa77e4]{width:150px;margin-bottom:24px}",""])},"91c1":function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e"),i("9a33");var a=i("28f8"),n=i("e68e"),o=i("6f9e"),r=i("bcc7"),s=i("e89f");function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){Object(a.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"CheckGuideDetailDrop",components:{ItemImgList:n.a},mixins:[s.a],data:function(){return{show:!1,showList:!1,isLoading:!1,isOpening:!1,isClosing:!1,contentTop:64,listHeight:510,module:"",itemIds:[],data:[],target:""}},watch:{show:function(t){var e=this;t&&this.$nextTick((function(){e.showList=!0}))}},created:function(){o.a.$on("routerBeforeEach",this.closePopup),o.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){o.a.$off("routerBeforeEach",this.closePopup),o.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(e){this.show=!0,this.$emit("open"),this.module=e.module,this.itemIds=e.itemIds,this.options=e.options;var i=document.querySelector(".layout-main .layout-header");if(this.contentTop=i.offsetHeight,e.el){var a=e.el.getBoundingClientRect();this.contentTop=a.bottom}this.target=e.el,this.listHeight=t.minBy([window.innerHeight-this.contentTop-50,510]),this.getData()},closePopup:function(){var t=this;if(!this.isOpening)return this.showList=!1,this.$emit("close"),new Promise((function(e){t.$on("afterClosePopup",e)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(t){t&&t.target&&t.target!==this.target&&this.show&&this.closePopup()},getData:function(){var e=this;return this.options&&this.options.length?(this.data=t.map(this.options,(function(t){return l(l({},t),{},{isOpen:!1})})),Promise.resolve()):r.a.getMeasureCheckItem(this.itemIds).then((function(i){e.data=t.map(i,(function(e){var i=e.content?e.content.trim():"",a=i?i.split("\n"):[],n=e.content_image?JSON.parse(e.content_image):[],o=t.filter(a,(function(t){return!/<img([\s\S]*)>/gm.test(t)}));return t.each(n,(function(t){t.url=t.url.split("@")[0]})),{id:e.id,name:e.full_name,textArr:o,contentImage:n,isOpen:!1}}))})).catch((function(t){console.error(t)}))},toggleItem:function(t){this.data.length>1&&this.$set(t,"isOpen",!t.isOpen)}}}}).call(this,i("391c"))},"967a":function(t,e,i){"use strict";var a=i("8d95");e.a={REPAIR_DEADLINE_STATUS:{name:"repair_deadline_status",status:["待整改"],module:[a.a.CHECK]}}},b5db:function(t,e,i){"use strict";i("23df")},c59b:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .item-list{position:relative;padding:10px;display:flex;align-items:center;background-color:#fff;min-height:100px}.zjapp .item-list .img{display:block;width:80px;height:80px;background:no-repeat 50%;background-size:cover;background-color:#ddd}.zjapp .item-list .item-list-con{flex:1;padding:0 15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.zjapp .item-list .item-list-con .title{height:30px;line-height:24px;color:#111;font-size:16px;padding-top:6px;margin:0;padding-right:10px;margin-right:-10px;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important;font-weight:400}.zjapp .item-list .item-list-con .title .type-tag{display:inline-block;height:16px;line-height:16px;padding:0 4px;border-radius:2px;border:1px solid #4275e8;color:#4275e8;font-size:12px;zoom:.8;margin:3px 0 0 0;vertical-align:text-top}.zjapp .item-list .item-list-con .text{height:30px;line-height:24px;color:#8c8c8c;padding-bottom:6px;padding-right:11px;margin-right:-10px}.zjapp .item-list .item-list-con .text,.zjapp .item-list .item-list-con .time{font-size:14px;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important}.zjapp .item-list .item-list-con .time{height:20px;line-height:20px;color:#b3b3b3;padding-right:11px!important;margin-right:-10px!important}.zjapp .item-list .item-list-con .time .ion{color:#a6a6a6;font-size:20px;font-weight:700;margin-right:5px;vertical-align:top}.zjapp .item-list .item-list-r{width:60px;line-height:18px;text-align:center}.zjapp .item-list .item-list-status{min-width:4em;line-height:18px;text-align:center;white-space:normal;font-size:14px}.zjapp .item-list .icon-unread{display:inline-block;text-align:center;width:12px;height:12px;border-radius:6px;background-color:red}.zjapp .item-list .icon-return,.zjapp .item-list .icon-timeout,.zjapp .item-list .icon-urgent{display:inline-block;width:16px;height:16px;text-align:center;line-height:16px;font-size:12px;font-style:normal;color:#fff;border-radius:2px;-webkit-border-radius:2px;vertical-align:top;margin-top:4px;margin-right:5px}.zjapp .item-list .icon-timeout{background:#964bfe}.zjapp .item-list .icon-return{background:#fe8b00}.zjapp .item-list .icon-urgent{background:#ff3c3d}.zjapp .item-list .icon-return:last-child,.zjapp .item-list .icon-timeout:last-child,.zjapp .item-list .icon-urgent:last-child{margin-right:0}.zjapp .item-list-tip{height:70px;line-height:60px;color:#b4b4b4;text-align:center}.zjapp .status-new-tag{position:absolute;right:0;top:0;width:50px;height:50px;overflow:hidden;z-index:10}.zjapp .status-new-tag>.tag{position:absolute;right:-32px;bottom:22px;height:20px;line-height:20px;width:100px;color:#fff;font-size:12px;transform:rotate(45deg);text-align:center;border-width:1px;border-style:solid}.zjapp .time-status{font-size:10px;color:#999}",""])},ca85:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .item-label[data-v-d2920aba]{width:50%}.zjapp .item-label-desc[data-v-d2920aba]{font-size:14px;color:#999}",""])},d1d1:function(t,e,i){"use strict";(function(t){var a=i("fd50"),n=i("bcc7"),o=i("515e"),r=i("07d2"),s=i("7bac"),c=i("a7c3"),l=i("4360");e.a={name:"CheckGuideList",components:{Item:r.default},store:l.a,data:function(){return{isLoading:!0,listData:[],module:"",itemId:"",batchId:"",sectionId:"",options:""}},computed:{moduleAttribute:function(){return this.$store.state.global.moduleAttribute}},methods:{init:function(e){var i,n=this;for(var o in this.module=e.module,this.itemId=e.itemId,this.batchId=e.batchId,this.sectionId=e.sectionId,this.options=e.options,e)this[o]=e[o];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module];var r=!1;t.isEmpty(this.itemId)?!t.isEmpty(this.checkType)&&t.isEmpty(this.sectionId)?i=this.initByType():t.isEmpty(this.batchId)?t.isEmpty(this.options)?t.isEmpty(this.sectionId)?i=a.a.when():(r=!0,i=this.initByBidsection()):i=this.initByOptions():i=this.initByBatch():i=this.initById(),this.isLoading=!0,i.then((function(e){var i=n.moduleAttribute[n.module]||{};!t.isEmpty(i)&&i.setUsualItems&&r?s.a.getUserKey(n.mmkvCode()).then((function(t){t=null===t?e:n.mergeArray(n.deepClone(e),t),n.listData=t||[],n.isLoading=!1})):(n.listData=e||[],n.isLoading=!1)}))},mmkvCode:function(){var t=this.moduleAttribute[this.module]||{};return c.a[t.mmkv_item]+"_"+this.sectionId},mergeArray:function(e,i){var a=this;return t.filter(e,(function(e){var n=i[e.id];return t.isEmpty(e.subitem)||(e.subitem=a.mergeArray(e.subitem,i)),!t.isEmpty(n)||"desc"===e.type}))},clickItem:function(t){t.subitem&&t.subitem.length?this.$set(t,"isOpen",!t.isOpen):"special-inspect"===this.module?o.a.openPopup({itemId:t.id,module:this.module}):o.a.openPopup({itemId:t.item_id,module:this.module})},initById:function(){var t=this;if("special-inspect"!==this.module)return n.a.getCheckItem(this.itemId,this.checkType).then((function(e){return e?t.sectionId?n.a.getBidSectionCheckItemListByCode(t.sectionId,e.code):n.a.getCheckItemTreeByCode(e.code):a.a.when()}))},initByType:function(){return n.a.getCheckItemGuidelineList(this.checkType)},initByBatch:function(){return a.a.when()},initByBidsection:function(){return n.a.getBidSectionCheckItemTreeByType(this.sectionId,this.checkType)},initByOptions:function(){return a.a.resolve(this.options)},deepClone:function(t){return JSON.parse(JSON.stringify(t))}}}}).call(this,i("391c"))},dc98:function(t,e,i){"use strict";i("0732")},dd16:function(t,e,i){"use strict";(function(t){e.a={name:"StatusText",props:{status:{type:String},text:{type:String},extend:{type:Object,default:function(){return{}}},statusStyles:{type:Object,default:function(){return{}}}},data:function(){return{classSet:t.extend({"草稿":"color-gray","暂存":"color-gray","检查中":"color-orange","待整改":"color-red","待复验":"color-orange","待验收":"color-red","待报验":"color-red","待申请进场":"color-red","待初验":"color-red","待送检":"color-red","待上传报告":"color-red","待退场":"color-red","待建设单位验收":"color-red","待区域验收":"color-red","供应链退回":"color-red","预创建":"color-status-blue","已提交":"color-green","已整改":"color-green","已验收":"color-green","已通过":"color-green","已退场":"color-gray","已关闭":"color-gray","非正常关闭":"color-gray","已退回":"color-red","已完成":"color-green","已甩项":"color-gray","检查完毕":"color-green","送检合格":"color-green","复验合格":"color-green","验收合格":"color-green","验收不合格":"color-red","未验收":"color-orange","待点评":"color-orange","已点评":"color-green","合格":"color-green","不合格":"color-red","待审核":"color-orange","已发布":"color-green","已拒绝":"color-red","进度正常":"color-green","进度滞后":"color-red","正常":"color-green","滞后":"color-red","施工单位验收合格":"color-green","监理单位验收合格":"color-green","建设单位验收合格":"color-green","施工单位验收不合格":"color-red","监理单位验收不合格":"color-red","建设单位验收不合格":"color-red"},this.extend)}},mounted:function(){}}}).call(this,i("391c"))},e89f:function(t,e,i){"use strict";var a=i("04f3"),n=i("cf09"),o=i("4360"),r=0;e.a={name:"PopupMixin",data:function(){return{backButtonEvent:null}},watch:{show:function(t){var e=this;if(t){if(this.$nextTick((function(){e.$el&&e.$el.style&&(e.$el.style.zIndex=++n.a.zIndex,r++,o.a.commit("app/SET_HAS_POPUP",!!r))})),!this.backButtonEvent){var i=this.close||this.closePopup;this.backButtonEvent=Object(a.a)(i)}}else--r<0&&(r=0),o.a.commit("app/SET_HAS_POPUP",!!r),this.backButtonEvent&&(Object(a.c)(this.backButtonEvent),this.backButtonEvent=null)}},methods:{}}},e9ea:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .guide-box[data-v-ff0679ce]{flex:1;display:flex}.zjapp .page-scroll[data-v-ff0679ce]{flex:1;overflow:auto;padding-bottom:100px;transform:translateZ(0)}.zjapp .sublist[data-v-ff0679ce]{padding-left:25px;padding-top:1px;background-color:#fff}.zjapp .sublist>.sublist[data-v-ff0679ce]{padding-left:10px;padding-top:0}",""])},ef1c:function(t,e,i){var a=i("e9ea");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("2e832052",a,!0,{sourceMap:!1,shadowMode:!1})},f1e4:function(t,e,i){"use strict";(function(t){i("5ab2"),i("e10e");var a=i("28f8"),n=(i("9e76"),i("6d57"),i("9a33"),i("f548"),i("cc57"),i("4ad6")),o=i("e89f"),r=i("bcc7"),s=i("3122"),c=i("6e1b"),l=i("c130"),d=i("0636");function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function p(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){Object(a.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"CheckGuideDetail",components:{},mixins:[o.a],data:function(){return{show:!1,isLoading:!0,isImageDownloading:!1,title:"",content:[],module:"",itemId:""}},methods:{openPopup:function(e){var i=this;for(var a in this.value=!0,this.show=!0,this.module=e.module,this.itemId=e.itemId,this.$emit("open"),e)this[a]=e[a];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module],this.isLoading=!0,("special-inspect"===this.module?c.a.getSpecialInspectCheckItemDetail(this.itemId):"templet-plan"===this.module?l.a.getTempletDetail(this.itemId):"material"===this.module?d.a.getMaterialDetail(this.itemId):r.a.getCheckItem(this.itemId,this.checkType)).then((function(e){console.log("checkitemData",e),e=e||{},i.checkitemData=e,i.title=e.full_name||e.name,"special-inspect"!==i.module&&"inspect"!==i.module&&"fly-inspect"!==i.module&&"material"!==i.module||(e.content=e.guideline||e.content);var a=e.content?e.content.trim():"";if(a=(a=(a=(a=(a=a.replace(/<\/p><p>/gm,"\n")).replace(/<p>/gm,"")).replace(/<\/p>/gm,"")).replace(/<br>/gm,"")).replace(/<br \/>/gm,""),/(<img[^\>]*>)/gm.test(a)){var n=a.split(/(<img[^\>]*>)/gm);(n=n.filter((function(t){return!!t}))).forEach((function(t,e){t&&!/^\s*\n/.test(t)&&e&&!/\n\s*$/.test(n[e-1])&&(n[e]="\n"+t)})),a=n.join("")}var o=a?a.split("\n"):[];i.content=t.map(o,(function(t,e){var i;if(/<img([\s\S]*)>/gm.test(t)){var a=t.split(/\ssrc="([^"]*)"/gm)[1],n=a?a.match(/[\w|-]{36}/gm)[0]:(new Date).getTime()+"-"+e;i={isImg:!0,src:"",url:a,status:"pending",id:n,ready:!0}}else i={isImg:!1,val:t};return i})),i.downloadImage(),i.isLoading=!1})).catch((function(t){$log.log(t)}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},getThumbnail:function(t){return"pending"===t.status?s.a.IMAGE_LOADING:"rejected"===t.status?s.a.IMAGE_RELOAD:"dev"===APP_ENV?t.url:"fulfilled"===t.status?t.src:($log.log("检查指引-显示图片：",t),s.a.IMAGE_PLACEHOLD)},imgError:function(t,e){$log.error("检查指引-加载图片出现错误：",t);var i=p({},t);i.status="rejected",this.$set(this.content,e,i)},downloadImage:function(e){var i=this;e=e?[e]:this.imageList(),t.each(e,(function(e){var a=p({},e),n=t.map(i.content,(function(t){return t.id})).indexOf(e.id);s.a.isNeedDownload(e.url).then((function(t){t?s.a.download(e.url).then((function(t){a.status="fulfilled",a.src=s.a.fixUrl(t),i.$set(i.content,n,a)})).catch((function(t){$log.error("检查指引-下载图片：",t)})):(a.status="fulfilled",a.src=s.a.fixUrl(s.a.getPathFromUrl(e.url)),i.$set(i.content,n,a))}))}))},imageList:function(){return t.filter(this.content,(function(t){return t.isImg}))},imgClick:function(e){var i=this;if("pending"===e.status)return!1;if("rejected"===e.status)return this.downloadImage(e),$log.log("检查指引-点击重新加载-重新下载图片：",e),!1;var a=this.imageList(),o=t.map(a,(function(t){return t.id})).indexOf(e.id);a=t.map(a,(function(t){return i.getThumbnail(t)})),n.a.openImageBrowser(a,o)}}}}).call(this,i("391c"))},f369:function(t,e,i){"use strict";var a=i("fd50"),n=i("bcc7"),o=i("329b"),r=i("d1d1").a,s=(i("3411"),i("17cc")),c={name:"CheckGuideList",components:{GuideList:Object(s.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"guide-box"},[!t.isLoading&&t.listData.length?i("div",{staticClass:"page-scroll"},t._l(t.listData,(function(e,a){return i("div",{key:a},[i("item",{attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text fw-b color-blue one-line"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])])],1)})):t._e()],2)})):t._e()],2)})):t._e()],2)}))):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.listData.length,"empty-text":"没有检查项"}})],1)}),[],!1,null,"ff0679ce",null).exports},mixins:[i("e89f").a],data:function(){return{show:!1}},methods:{openPopup:function(t){var e=this;this.value=!0,this.show=!0,this.$nextTick((function(){e.$refs["guide-list"].init(t),e.$emit("open")}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")}}},l=Object(s.a)(c,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"slide-right"}},[this.show?e("page-content",{attrs:{mode:"dialog",title:"检查指引","on-close":this.closePopup}},[e("guide-list",{ref:"guide-list"})],1):this._e()],1)}),[],!1,null,null,null).exports,d=!1;d||(d=new(o.default.extend(l))({el:document.createElement("div")}),document.body.appendChild(d.$el));var u=d,p=i("515e"),m=i("91c1").a,h=(i("dc98"),Object(s.a)(m,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"main",style:{top:t.contentTop+"px"}},[i("i",{staticClass:"arrow"}),i("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePopup(e)}}},[i("transition",{attrs:{name:"slide-down"},on:{enter:function(e){t.isOpening=!0},"after-enter":function(e){t.isOpening=!1},leave:function(e){t.isClosing=!0},"after-leave":t.afterClose}},[t.showList?i("div",{staticClass:"box",style:{height:t.listHeight+"px"}},t._l(t.data,(function(e,a){return i("div",{key:a,class:{"border-bottom":t.data.length>1,"box-single":1===t.data.length}},[i("div",{staticClass:"detail-hd",class:{"border-bottom":t.data.length<=1,"detail-hd-single":t.data.length<=1},on:{click:function(i){t.toggleItem(e)}}},[t.data.length>1?i("i",{class:{"detail-arrow-right":!e.isOpen,"detail-arrow-down":e.isOpen}}):t._e(),i("div",{staticClass:"detail-title"},[t._v(t._s(e.name))])]),t.data.length<=1||e.isOpen?i("div",{staticClass:"detail-bd",class:{"detail-bd-single":t.data.length<=1}},[t._l(e.textArr,(function(e,a){return i("p",{key:a,staticClass:"text-line"},[t._v("\n              "+t._s(e)+"\n            ")])})),i("item-img-list",{attrs:{editabled:!1},model:{value:e.contentImage,callback:function(i){t.$set(e,"contentImage",i)},expression:"item.contentImage"}}),i("loading-status",{attrs:{"is-empty":!e.textArr.length&&!e.contentImage.length,"empty-text":"PC端未设置检查指引"}})],2):t._e()])}))):t._e()])],1)]):t._e()}),[],!1,null,"2cac8864",null).exports),f=!1;f||(f=new(o.default.extend(h))({el:document.createElement("div")}),document.body.appendChild(f.$el));var g=f,b={name:"CheckGuide",components:{},props:{module:{type:String,default:""},mode:{type:String,default:"page"},itemId:{type:String,default:""},itemIds:{type:Array,default:function(){return[]}},batchId:{type:String,default:""},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}},optionsPromise:{type:Function,default:function(){}},beforeOpen:{type:Function,default:function(){}}},data:function(){return{isLoading:!1}},methods:{openCheckGuide:function(){var t=this,e=this.beforeOpen&&this.beforeOpen();e instanceof Promise||(e=Promise.resolve(e)),e.then((function(e){!1!==e&&("drop"===t.mode?g.openPopup({itemIds:t.itemIds,el:t.$refs["check-guide-btn"],options:t.options}):("templet-plan"===t.module?a.a.when(!1):t.itemId&&t.sectionId?n.a.hasChildSectionCheckItem(t.itemId,t.sectionId):t.itemId?n.a.hasChildCheckItem(t.itemId):a.a.when(!0)).then((function(e){e?u.openPopup({module:t.module,itemId:t.itemId,batchId:t.batchId,sectionId:t.sectionId,options:t.options}):p.a.openPopup({itemId:t.itemId,module:t.module})})))}))}}},v=Object(s.a)(b,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"check-guide-btn",staticClass:"header-btn",on:{click:function(e){t.openCheckGuide()}}},[i("icon",{attrs:{name:"nav-info"}})],1)}),[],!1,null,null,null);e.a=v.exports},f647:function(t,e,i){"use strict";(function(t){i("e697"),i("cc57"),i("163d");var a,n=i("fd50"),o=i("6e1b"),r=i("3bd5"),s=i("3122"),c=i("48f4");e.a=a={data:{problemData:{},problemList:[]},batchIdOrSpecialInspectId:"",isListLoading:!0,toParams:null,init:function(t,e,i,n){var o;return a.toParams=n,void 0===n?o=a.lastRequest():n.batchId&&6===Number(n.mode)?(o=a.getContractAllProblemList(n.batchId),a.lastRequest=function(){return a.getContractAllProblemList(n.batchId)}):n.batchId&&9==+n.mode||10==+n.mode&&!n.specialInspectId?(o=a.getAllProblemsIncloudRoot(n.batchId),a.lastRequest=function(){return a.getAllProblemsIncloudRoot(n.batchId)}):n.specialInspectId?(o=a.getCheckItemProblemList(n.specialInspectId),a.lastRequest=function(){return a.getCheckItemProblemList(n.specialInspectId)}):(o=a.getAllProblemList(n.batchId),a.lastRequest=function(){return a.getAllProblemList(n.batchId)}),o.then((function(){a.isListLoading=!1}))},getCheckItemProblemList:function(e){return o.a.getSpecialInspectProblemList(e).then((function(e){a.data.problemList=e;var i=t.filter(e,(function(t){var e=JSON.parse(t.image_file||"[]");return s.a.isNeedThumbnail(e)}));c.default.autoLoadThumbnail(i,"专项巡检","image_file","thumbnail","checkquality_problem")}))},getAllProblemList:function(e){return o.a.getSpecialInspectBatchProblemOfAll(e).then((function(e){a.data.problemList=e;var i=t.filter(e,(function(t){var e=JSON.parse(t.image_file||"[]");return s.a.isNeedThumbnail(e)}));c.default.autoLoadThumbnail(i,"专项巡检","image_file","thumbnail","checkquality_problem")}))},getAllProblemsIncloudRoot:function(e){return o.a.getSpecialInspectBatchProblemsIncloudRoot(e).then((function(e){a.data.problemList=e;var i=t.filter(e,(function(t){var e=JSON.parse(t.image_file||"[]");return s.a.isNeedThumbnail(e)}));c.default.autoLoadThumbnail(i,"专项巡检","image_file","thumbnail","checkquality_problem")}))},getContractAllProblemList:function(e){return o.a.getContractAllProblemList(e).then((function(e){a.data.problemList=e;var i=t.filter(e,(function(t){var e=JSON.parse(t.image_file||"[]");return s.a.isNeedThumbnail(e)}));c.default.autoLoadThumbnail(i,"专项巡检","image_file","thumbnail","checkquality_problem")}))},getCheckProblemInfo:function(e){var i,s=a.data;return e?o.a.getCheckProblemInfo(e).then((function(e){(i=e).regist={id:e.regist.id,name:e.regist.name,mobile:e.regist.mobile,is_im_user:e.regist.is_im_user},e.repair&&e.repair.id?i.repair={id:e.repair.id,name:e.repair.name,mobile:e.repair.mobile,is_im_user:e.repair.is_im_user}:i.repair=t.clone(e.repair_set),i.place={full_name:e.place},i.checkItem={id:e.item_id,name:e.item_name,full_name:e.item_full_name},i.description={id:e.desc_id,name:e.desc},i.image_file=JSON.parse(e.image_file||"[]"),i.level=e.emergency_degree||"一般",i.sent_back={id:e.sent_back.id,name:e.sent_back.name,mobile:e.sent_back.mobile},i.sent_back_image_file=JSON.parse(e.sent_back_image_file||"[]"),i.repair_image_file=JSON.parse(e.repair_image_file||"[]"),i.contractor={id:e.contractor_id,name:e.contractor_name},i.cc_set=e.cc_set_array,i.place_point=JSON.parse(e.problem_values||"[]"),i.drawing_file=JSON.parse(e.drawing_file||"[]"),i.deadline=e.deadline||7,i.currentReinspectBy=t.find(t.clone(i.reinspectBy),(function(t){return t.id===r.a.getUser().user_id}))||{reinspect_image_file:[],reinspect_remark:""}})).then((function(){return o.a.getSpecialInspectCheckItemDetail(i.biz_id).then((function(t){t.checkitem_extension&&"string"==typeof t.checkitem_extension&&(i.checkitem_extension=JSON.parse(t.checkitem_extension)),i.isRedlineDeduction=1===t.is_redline_deduction}))})).then((function(){return s.problemData=i,i})):n.a.reject("问题id为空")},getProjectUsers:function(t){return ProjectService.getAllProjectUsers(t).then((function(t){return a.data.users=t,t}))},createNewData:function(t){var e={status:"",place:{},batch_type:"专项巡检",checkItem:{},description:{},image_file:[],remark:"",level:"一般",deadline:7,repair_set:{},contractor:{},cc_set:[],reinspect_set:[],building_id:"",unit:"",room_id:"",place_point:[],deduction:1,redline_deduction:0,biz_id:t};return o.a.getSpecialInspectCheckItemDetail(t).then((function(t){t.checkitem_extension&&"string"==typeof t.checkitem_extension&&(e.checkitem_extension=JSON.parse(t.checkitem_extension)),e.proj_id=t.proj_id,e.batch_id=t.batch_id,e.checkItem={id:t.item_id,name:t.full_name,full_name:t.full_name},e.isRedlineDeduction=1===t.is_redline_deduction,void 0!==t.deduction&&""!==t.deduction&&null!==t.deduction&&(e.deduction=t.deduction)})).then((function(){return a.data.problemData=e,e}))}}}).call(this,i("391c"))},fa4f:function(t,e,i){"use strict";var a=i("4aef"),n=i("967a"),o={name:"ItemList",components:{StatusText:a.a},props:{img:{type:String,default:""},title:{type:String,default:""},detail:{type:String,default:""},footer:{type:String,default:""},status:{type:String,default:""},isShowNewStatus:{type:Boolean,default:!1},statusText:{type:String,default:""},statusClassSet:{type:Object,default:function(){return{}}},typeTag:{type:String,default:""},isUnread:{type:Boolean,default:!1},isTimeout:{type:Boolean,default:!1},isUrgent:{type:Boolean,default:!1},isReturn:{type:Boolean,default:!1},repairDeadline:{type:String,default:null}},data:function(){return{repairDeadlineStatus:n.a.REPAIR_DEADLINE_STATUS.status}},computed:{bgNewClass:function(){return{"草稿":"bg-gray7 b-color","暂存":"bg-gray b-color","检查中":"bg-orange b-color","待整改":"bg-red2 b-color ","待复验":"bg-purple b-color","待验收":"bg-red b-color","待报验":"bg-red b-color","待申请进场":"bg-red b-color","待初验":"bg-red b-color","待送检":"bg-red b-color","待上传报告":"bg-red b-color","待退场":"bg-red b-color","待建设单位验收":"bg-red b-color","待区域验收":"bg-red b-color","已提交":"bg-green b-color","已整改":"bg-green b-color","已验收":"bg-green b-color","已通过":"bg-green2 b-color","已退场":"bg-gray b-color","已关闭":"bg-gray7 b-color","非正常关闭":"bg-gray b-color","已退回":"bg-red b-color","已完成":"bg-green b-color","已甩项":"bg-gray b-color","检查完毕":"bg-green b-color","送检合格":"bg-green b-color","复验合格":"bg-green b-color","验收合格":"bg-green b-color","验收不合格":"bg-red b-color","未验收":"bg-orange b-color","待点评":"bg-orange b-color","已点评":"bg-green b-color","合格":"bg-green b-color","不合格":"bg-red b-color","进度正常":"bg-green2 b-color","进度滞后":"bg-red2 b-color","施工单位验收合格":"bg-green b-color","监理单位验收合格":"bg-green b-color","建设单位验收合格":"bg-green b-color","施工单位验收不合格":"bg-red b-color","监理单位验收不合格":"bg-red b-color","建设单位验收不合格":"bg-red b-color"}}},activated:function(){}},r=(i("19a9"),i("17cc")),s=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._g({staticClass:"item-list border-bottom"},t.$listeners),[t.isShowNewStatus?i("div",{staticClass:"status-new-tag"},[i("div",{staticClass:"tag",class:t.bgNewClass[t.status]},[t._v("\n      "+t._s(t.status)+"\n    ")])]):t._e(),t.img?i("div",{staticClass:"img",style:{"background-image":"url("+t.img+")"}}):t._e(),i("div",{staticClass:"item-list-con"},[i("h2",{staticClass:"title"},[t.isUnread?i("i",{staticClass:"icon-unread"}):t._e(),t.isTimeout?i("i",{staticClass:"icon-timeout"},[t._v("\n        超\n      ")]):t._e(),t.isUrgent?i("i",{staticClass:"icon-urgent"},[t._v("\n        急\n      ")]):t._e(),t.isReturn?i("i",{staticClass:"icon-return"},[t._v("\n        退\n      ")]):t._e(),t.$slots.title?t._t("title"):[t.typeTag?i("span",{staticClass:"type-tag"},[t._v(t._s(t.typeTag))]):t._e(),t._v("\n        "+t._s(t.title||"")+"\n      ")]],2),i("p",{staticClass:"text"},[t._v(t._s(t.detail||""))]),t.$slots.footer?t._t("footer"):i("p",{staticClass:"time",domProps:{innerHTML:t._s(t.footer||"")}})],2),t.status&&!t.isShowNewStatus?i("div",{staticClass:"item-list-status"},[i("status-text",{attrs:{status:t.status,text:t.statusText,extend:t.statusClassSet}}),t.repairDeadline&&t.repairDeadlineStatus.includes(t.status)?i("p",{staticClass:"time-status"},[t._v("\n      "+t._s(t._f("timeStatus")(t.repairDeadline))+"\n    ")]):t._e()],1):t._e()])}),[],!1,null,null,null);e.a=s.exports}}]);