(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-27037b0c","chunk-3adbbd26"],{"0416":function(e,t,i){"use strict";i("068e")},"068e":function(e,t,i){var a=i("771c");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("1ce02ce6",a,!0,{sourceMap:!1,shadowMode:!1})},"0732":function(e,t,i){var a=i("81f2");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("1b5b07de",a,!0,{sourceMap:!1,shadowMode:!1})},"0cb6":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .problem-detail-header[data-v-0901aadd]{display:flex;align-items:center;justify-content:center;height:40px;padding:0 15px;line-height:40px;background-color:#f2f2f2}.zjapp .problem-detail-header .status[data-v-0901aadd]{flex:1;height:16px;line-height:16px;border-left:5px solid #ddd;padding-left:5px;color:#111;font-size:16px}.zjapp .problem-detail-header .status-red[data-v-0901aadd]{border-color:#ff3d3d}.zjapp .problem-detail-header .status-blue[data-v-0901aadd]{border-color:#4275e8}.zjapp .problem-detail-header .status-green[data-v-0901aadd]{border-color:#0bc666}.zjapp .problem-detail-header .status-orange[data-v-0901aadd]{border-color:#fc8b01}.zjapp .problem-detail-header .status-black[data-v-0901aadd]{border-color:#333}.zjapp .problem-detail-header .status-gray[data-v-0901aadd]{border-color:#999}.zjapp .problem-detail-header .return[data-v-0901aadd],.zjapp .problem-detail-header .timeout[data-v-0901aadd],.zjapp .problem-detail-header .urgent[data-v-0901aadd]{display:block;padding:0 5px;margin-left:6px;height:16px;line-height:16px;color:#fff;font-size:12px;border-radius:2px;-webkit-border-radius:2px}.zjapp .problem-detail-header .urgent[data-v-0901aadd]{background-color:#ff3d3d}.zjapp .problem-detail-header .timeout[data-v-0901aadd]{background-color:#954cfe}.zjapp .problem-detail-header .return[data-v-0901aadd]{background-color:#fc8b01}.zjapp .problem-detail-header .operat[data-v-0901aadd]{height:40px;line-height:40px;white-space:nowrap;font-size:16px;color:#6b7ba9}",""])},13578:function(e,t,i){"use strict";(function(e){i("6a61");var a,r=i("2e91"),n=(i("e697"),i("f369")),o=i("da1c"),s=i("07d2"),c=i("e68e"),l=i("3c64"),p=i("cd05"),d=i("6bf2"),u=i.n(d),m=i("e2a7"),g=i("3bd5"),f=i("9864"),h=i("fa4f"),b=(i("c058"),i("eb36")),x=i.n(b),v=i("6e1b"),_=i("f647"),y=i("7c70"),w=i("9416"),k=i("8d95");t.a={name:"CheckEdit",components:{CheckGuide:n.a,ProblemDetailHeader:o.a,Item:s.default,ItemImgList:c.a,ItemTextarea:l.a,UserSelect:p.a,CheckUserContact:f.a,ItemList:h.a},data:function(){return{title:Object(w.a)(k.a.SPECIAL_INSPECT)||"专项巡检",loading:!1,user:g.a.getUser(),viewSize:$rootScope.viewSize,data:{},isEdit:!1,mode:null,specialInspectId:"",template_extension:{},checkitem:{},reward:0,png_empty:x.a,isLoading:!0,problemModel:_.a,image_file:[],selecItem:{},allowRest:!1}},activated:function(){var e=this.$route.query,t=e.batchId,i=e.specialInspectId,a=e.checkItemId,r=e.rootId,n=e.mode;e.problem_id;this.batchId=t,this.specialInspectId=i,this.checkItemId=a,this.rootId=r,this.mode=parseInt(n),this.init()},methods:{init:function(){var t=this;window.test=this,this.isLoading=!0;var i=this.specialInspectId;v.a.getSpecialCheckItemAndBatchDetail(i).then((function(e){return t.checkitem=e,t.image_file=e.image_file?JSON.parse(e.image_file):[],t.allowRest=e.allowRest,t.template_extension=JSON.parse(e.batchDetail.template_extension||"{}"),e})).then((function(i){var a,r=t.checkitem.checkitem_extension||{};Array.isArray(t.template_extension)&&(t.template_extension={mode9_rating_rules:t.template_extension}),a=t.template_extension.mode9_rating_rules||[],"string"==typeof r&&(r=JSON.parse(r));var n=e.find(a,(function(e){return e.rule_id===r.rule_id}));t.selecItem=e.find(n.item,(function(e){return e.level===t.checkitem.level})),t.reward=t.checkitem.reward})).then((function(){t.problemModel.getCheckItemProblemList(i),t.isLoading=!1})).catch((function(e){console.log(e)}))},multiply:function(e,t){var i=e*t;return i=Math.round(100*i)/100},fomatDate:function(e){return u()(e).format("YYYY-MM-DD HH:mm")},problemDetail:function(e){var t;t="草稿"===e.status?"/special-inspect-problem-edit":"/special-inspect-problem-detail",this.$router.push({path:t,query:{specialInspectId:e.biz_id,problem_id:e.id,checkItemId:e.item_id,rootId:this.rootId,mode:this.mode}})},checkItemRest:(a=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={specialInspectId:this.specialInspectId,restSpecialField:{reward:0,level:""}},e.prev=1,e.next=4,y.a.networkTest("确定删除已检查内容？\n删除的已检查内容将无法找回。");case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,y.a.postRestProblemCheckitem(t);case 9:m.a.hideLoading(),m.a.alert("删除成功"),this.$router.go(-1),e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(1),m.a.hideLoading(),m.a.alert(e.t0.errmsg),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,this,[[1,14]])}))),function(){return a.apply(this,arguments)})}}}).call(this,i("391c"))},"19a9":function(e,t,i){"use strict";i("7d4e")},"1f63":function(e,t,i){"use strict";i("7434")},"2c76":function(e,t,i){"use strict";i("c070")},3411:function(e,t,i){"use strict";i("ef1c")},"3c64":function(e,t,i){"use strict";i("163d");var a={name:"ItemTextarea",components:{},props:{value:{type:String,default:""},placeholder:{type:String,default:""},maxlength:{type:Number,default:200},borderBottom:{type:Boolean,default:!0}},data:function(){return{textareaHeight:40,isLock:!1,blurTime:null}},computed:{lastLength:function(){var e=this.value&&this.value.length||0,t=this.maxlength-e;return t>0?t:0}},mounted:function(){var e=this;this.$nextTick((function(){e.textareaHeight=e.$refs.rule&&e.$refs.rule.offsetHeight||40}))},methods:{onfocus:function(){var e=(new Date).getTime();this.blurTime&&e-this.blurTime<300&&window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(this.$refs.input.blur(),window.cordova.plugins.Keyboard.close()),this.blurTime=null,this.$emit("focus")},onblur:function(){this.blurTime=(new Date).getTime(),this.$emit("blur")},setStatus:function(e){console.log(e),this.isLock=e},oninput:function(e){var t=this;setTimeout((function(){if(!t.isLock){var i=e.target.value;i.length>t.maxlength&&(i=i.substring(0,t.maxlength),t.$refs.input.value=i),t.$refs.rule.innerText=i,t.textareaHeight=t.$refs.rule&&t.$refs.rule.offsetHeight+20,t.$emit("input",i),t.$emit("change",i)}}),0)}}},r=(i("2c76"),i("17cc")),n=Object(r.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"item-textarea",class:{"border-bottom":e.borderBottom}},[i("div",{staticClass:"item-textarea-content"},[i("textarea",{ref:"input",style:{height:e.textareaHeight+"px"},attrs:{placeholder:e.placeholder},domProps:{value:e.value},on:{focus:e.onfocus,blur:e.onblur,compositionstart:function(t){e.setStatus(!0)},compositionend:function(t){e.setStatus(!1)},input:e.oninput}}),i("div",{ref:"rule",staticClass:"rule"},[e._v("\n      "+e._s(e.value)+"\n    ")]),e.maxlength!==1/0?i("p",{staticClass:"counter"},[e._v("\n      "+e._s(e.lastLength)+"\n    ")]):e._e()])])}),[],!1,null,null,null);t.a=n.exports},4198:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .layout-main[data-v-58fae5c0] .layout-content{display:flex;flex-direction:column}.zjapp .page-scroll[data-v-58fae5c0]{flex:1;overflow:auto;padding-bottom:100px}.zjapp .page-scroll[data-v-58fae5c0] .item-text{line-height:normal}.zjapp .leader-comment[data-v-58fae5c0]{padding:3px 0}.zjapp .leader-comment .comment-time[data-v-58fae5c0]{color:#bbb}.zjapp .leader-comment .comment-item[data-v-58fae5c0]{margin-bottom:15px}.zjapp .leader-comment p[data-v-58fae5c0]{margin:5px 0}.zjapp .ptb7[data-v-58fae5c0]{padding:7px 0}[data-v-58fae5c0] .item-textarea textarea{min-height:130px}.zjapp .item-name[data-v-58fae5c0]{background:#fff}.zjapp .content[data-v-58fae5c0]{padding-bottom:5px;background:#fff}.zjapp .item-left[data-v-58fae5c0]{width:90px;flex:inherit}.zjapp .item-wrap[data-v-58fae5c0] .item-img-list{flex:1;margin-top:0}.zjapp .item-wrap[data-v-58fae5c0] .item-img-list li{margin-top:7px}.zjapp .problem-wrap-title[data-v-58fae5c0]{display:flex;justify-content:space-between;align-items:center;font-size:14px;color:#666}.zjapp .problem-wrap-title div[data-v-58fae5c0]{padding:10px 15px 5px;line-height:20px}.zjapp .problem-wrap-title .problem-btn[data-v-58fae5c0]{color:#4275e8}.zjapp .problem-wrap .problem-list[data-v-58fae5c0]{background:#fff}.zjapp .problem-wrap .problem-list .problem-item[data-v-58fae5c0]{display:flex;border-bottom:1px solid #ececec;padding:12px 15px}.zjapp .problem-wrap .problem-list .problem-item img[data-v-58fae5c0]{width:70px;height:70px;background:coral;margin-right:10px}.zjapp .problem-wrap .problem-list .problem-item .content[data-v-58fae5c0]{margin-right:10px;flex:1;display:flex;flex-direction:column;justify-content:space-between}.zjapp .problem-wrap .problem-list .problem-item .content .desc[data-v-58fae5c0]{font-size:16px;color:#333;line-height:22px}.zjapp .problem-wrap .problem-list .problem-item .content .date[data-v-58fae5c0]{color:#999;line-height:20px}.zjapp .problem-wrap .problem-list .problem-item .status[data-v-58fae5c0]{display:flex;align-items:center;color:#0bc666}.zjapp .problem-wrap .problem-list .empty[data-v-58fae5c0]{padding:40px 0;display:flex;flex-direction:column;align-items:center;color:#999}.zjapp .problem-wrap .problem-list .empty img[data-v-58fae5c0]{width:150px;margin-bottom:24px}",""])},"4aef":function(e,t,i){"use strict";var a=i("dd16").a,r=i("17cc"),n=Object(r.a)(a,(function(){var e=this.$createElement;return(this._self._c||e)("span",{class:this.classSet[this.status]},[this._v(this._s(this.text||this.status))])}),[],!1,null,null,null);t.a=n.exports},"515e":function(e,t,i){"use strict";var a=i("329b"),r=i("f1e4").a,n=(i("0416"),i("17cc")),o=Object(n.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-right"}},[e.show?i("page-content",{class:{"content-not-empty":e.content.length},attrs:{mode:"dialog",title:"检查指引","on-close":e.closePopup}},[!e.isLoading&&e.title?i("div",{staticClass:"check-guide-detail-hd border-bottom"},[i("h2",{staticClass:"check-guide-detail-title pb10"},[e._v(e._s(e.title))])]):e._e(),!e.isLoading&&e.content.length?i("div",{staticClass:"check-guide-detail-content"},e._l(e.content,(function(t,a){return i("p",{key:a},[t.isImg&&t.src?i("img",{class:{"img-not-ready":!t.ready,error:"rejected"===t.status},attrs:{src:e.getThumbnail(t)},on:{error:function(i){e.imgError(t,a)},click:function(i){e.imgClick(t)}}}):e._e(),t.isImg?e._e():i("span",[e._v("\n          "+e._s(t.val)+"\n        ")])])}))):e._e(),i("loading-status",{attrs:{"is-loading":e.isLoading,"is-empty":!e.content.length,"empty-text":"PC端未设置检查指引"}})],1):e._e()],1)}),[],!1,null,"691b2f0f",null).exports,s=!1;s||(s=new(a.default.extend(o))({el:document.createElement("div")}),document.body.appendChild(s.$el));t.a=s},"574c":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .item-textarea{background-color:#fff;padding:5px 15px}.zjapp .item-textarea-content{position:relative}.zjapp .item-textarea .rule,.zjapp .item-textarea textarea{width:100%;min-height:40px;line-height:20px;font-size:16px;padding:0;border:none}.zjapp .item-textarea .rule{position:absolute;top:0;left:0;visibility:hidden;word-break:break-all}.zjapp .item-textarea .counter{text-align:right;margin:0 0 -5px 0;height:15px;line-height:15px;color:#b2b2b2;font-size:12px}",""])},"653a":function(e,t,i){"use strict";i("7fe2")},7434:function(e,t,i){var a=i("0cb6");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("f6a1180a",a,!0,{sourceMap:!1,shadowMode:!1})},"771c":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .content-not-empty[data-v-691b2f0f] .layout-content{display:auto;overflow:auto;padding-bottom:100px}.zjapp .check-guide-detail-hd[data-v-691b2f0f]{margin-left:30px;padding:25px 30px 5px 0}.zjapp .check-guide-detail-title[data-v-691b2f0f]{margin:0;line-height:20px;font-size:18px;color:#111;font-weight:700;word-break:break-all}.zjapp .check-guide-detail-info[data-v-691b2f0f]{line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .check-guide-detail-content[data-v-691b2f0f]{padding:30px;line-height:30px;color:#333;font-size:16px}.zjapp .check-guide-detail-content p[data-v-691b2f0f]{margin-bottom:30px;min-height:1em}.zjapp .check-guide-detail-content img[data-v-691b2f0f]{max-width:100%}.zjapp .check-guide-detail-content .img-not-ready[data-v-691b2f0f]{width:80px;height:auto}.zjapp .error[data-v-691b2f0f]{max-width:50%}",""])},"7c70":function(e,t,i){"use strict";(function(e){i("5ab2"),i("e10e");var a,r,n,o,s,c,l=i("28f8"),p=(i("06a2"),i("6d57"),i("163d"),i("6a61"),i("2e91")),d=i("8693"),u=i("162a"),m=i("48f4"),g=i("c058"),f=i("1b7e"),h=i("e2a7");function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function x(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(Object(i),!0).forEach((function(t){Object(l.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}t.a={networkTest:(c=Object(p.a)(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.getHasNetwork();case 2:if(e.sent){e.next=6;break}return h.a.alert("当前无网络"),e.abrupt("return",Promise.reject());case 6:return e.next=8,h.a.confirm({message:t,okText:"删除",cancelText:"取消",className:"dialog-customize confirm-color-red"});case 8:return(i=e.sent)&&h.a.loading("正在提交..."),e.abrupt("return",Promise.resolve(i));case 11:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),measureCheckItemsRest:(s=Object(p.a)(regeneratorRuntime.mark((function t(i){var a,r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={special_inspect_ids:i.map((function(e){return e.special_inspect_id})).join(",")},$log.log("专项巡检-实测实量-检查项重置-请求的参数：",a),t.next=5,u.a.post("/online/special-inspect/delete-data-of-checkitem",null,a);case 5:if(r=t.sent,!Number(r.errcode)||0===Number(r.errcode)){t.next=8;break}return t.abrupt("return",Promise.reject(r));case 8:return n=[],e.forEach(i,(function(e){var t={remark:"",status:"未设置",image_file:"[]",id:e.special_inspect_id,download_time:r.update_timestamp},i={id:e.id,group_id:"",measurement_points:"",problem_points:"",problem_values:"",problem_values_zip:""};$log.log("专项巡检-实测实量-检查项重置-请求的参数："," special_inspect => ",t," special_inspect_measure_item =>",i);var a=d.a.updateSpecialInspectData(t),o=d.a.updateSpecialInspectMeasureItem(i),s=m.default.removeSyncGroup(e.special_inspect_id);n.push(a,o,s)})),t.next=12,Promise.all(n);case 12:return $log.log("专项巡检-实测实量-检查项重置-成功"),t.abrupt("return",Promise.resolve());case 16:return t.prev=16,t.t0=t.catch(0),$log.log("专项巡检-实测实量-检查项重置-error：",t.t0),t.abrupt("return",Promise.reject(t.t0));case 20:case"end":return t.stop()}}),t,null,[[0,16]])}))),function(e){return s.apply(this,arguments)}),postDeleteProblem:(o=Object(p.a)(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.a.post("/online/problem-secure/delete",null,{id:t});case 3:if(i=e.sent,!Number(i.errcode)||0===Number(i.errcode)){e.next=6;break}return e.abrupt("return",Promise.reject(i));case 6:return e.abrupt("return",Promise.resolve(i));case 9:return e.prev=9,e.t0=e.catch(0),$log.log("专项巡检-删除问题-error：",e.t0),e.abrupt("return",Promise.reject(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))),function(e){return o.apply(this,arguments)}),postRestCheckItemTemplate11:(n=Object(p.a)(regeneratorRuntime.mark((function e(t){var i,a,r,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=t.specialInspectId,a=t.placeCheckitemId,r=t.problemIds,$log.log("专项巡检-观感模板-删除检查项内容-传入数据：",t),n={special_inspect_ids:i,place_checkitem_id:a},e.next=6,u.a.post("/online/special-inspect/delete-data-of-checkitem",null,n);case 6:if(o=e.sent,!Number(o.errcode)||0===Number(o.errcode)){e.next=9;break}return e.abrupt("return",Promise.reject(o));case 9:return e.next=11,this.sqlDeleteProblem(r);case 11:return $log.log("专项巡检-观感模板-删除检查项内容-删除问题成功"),s={id:a,status:"未设置",remark:null,checker:"",image_file:"[]",deduction:null,download_time:o.update_timestamp},$log.log("更新special_inspect_place_checkitem数据：",s),e.next=16,d.a.updatePlaceSpecialInspectData(s);case 16:return $log.log("专项巡检-观感模板-删除检查项内容-删除检查项的内容成功"),e.next=19,m.default.removeSyncGroup(a);case 19:return $log.log("专项巡检-观感模板-删除检查项内容-删除上传队列成功"),e.abrupt("return",Promise.resolve());case 23:return e.prev=23,e.t0=e.catch(0),$log.log("专项巡检-删除问题-error：",e.t0),e.abrupt("return",Promise.reject(e.t0));case 27:case"end":return e.stop()}}),e,this,[[0,23]])}))),function(e){return n.apply(this,arguments)}),postRestProblemCheckitem:(r=Object(p.a)(regeneratorRuntime.mark((function t(i){var a,r,n,o,s,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=i.specialInspectId,r=i.restSpecialField,n=void 0===r?{}:r,$log.log("专项巡检-重置检查项内容-传入数据：",i),o={special_inspect_ids:a},t.next=6,u.a.post("/online/special-inspect/delete-data-of-checkitem",null,o);case 6:if(s=t.sent,!Number(s.errcode)||0===Number(s.errcode)){t.next=9;break}return t.abrupt("return",Promise.reject(s));case 9:return c=x({id:a,status:"未设置",remark:null,image_file:"[]",download_time:s.update_timestamp},n),$log.log("更新special_inspect数据：",c),t.next=13,d.a.updateSpecialInspectData(c);case 13:return $log.log("专项巡检-重置检查项内容-重置成功"),t.next=16,m.default.removeSyncGroup(a);case 16:return $log.log("专项巡检-重置检查项内容-删除上传队列成功"),t.next=19,d.a.getProblemBySpecialInspect(a);case 19:return l=t.sent,(l=e.map(l,(function(e){return e.id})))&&this.sqlDeleteProblem(l),t.abrupt("return",Promise.resolve());case 25:return t.prev=25,t.t0=t.catch(0),$log.log("专项巡检-重置检查项-error：",t.t0),t.abrupt("return",Promise.reject(t.t0));case 29:case"end":return t.stop()}}),t,this,[[0,25]])}))),function(e){return r.apply(this,arguments)}),sqlDeleteProblem:(a=Object(p.a)(regeneratorRuntime.mark((function e(t){var i,a,r,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.length>1&&void 0!==n[1]&&n[1],e.prev=1,Array.isArray(t)||(t=[t]),$log.log("专项巡检-删除问题-传入ids：",t),e.next=6,d.a.deleteProblemAllIds(t);case 6:return $log.log("专项巡检-删除问题-删除问题表和关联表成功"),a=[],t.forEach((function(e){a.push(m.default.removeSyncGroup(e))})),e.next=11,Promise.all(a);case 11:if($log.log("专项巡检-删除问题-删除上传队列成功"),i){e.next=18;break}return r=[],t.forEach((function(e){var t=g.a.addLog({relation_id:e,business_type:"special-inspect",event:"删除"});r.push(t)})),e.next=17,Promise.all(r);case 17:$log.log("专项巡检-删除问题-添加删除业务日志");case 18:return e.abrupt("return",Promise.resolve());case 21:return e.prev=21,e.t0=e.catch(1),$log.log("专项巡检-删除问题-error：",e.t0),e.abrupt("return",Promise.reject(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,21]])}))),function(e){return a.apply(this,arguments)})}}).call(this,i("391c"))},"7d4e":function(e,t,i){var a=i("c59b");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("62c5f5a2",a,!0,{sourceMap:!1,shadowMode:!1})},"7fe2":function(e,t,i){var a=i("4198");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("4dcc8115",a,!0,{sourceMap:!1,shadowMode:!1})},"81f2":function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,'.zjapp .main[data-v-2cac8864]{position:fixed;width:100%;bottom:0}.zjapp .arrow[data-v-2cac8864]{position:absolute;top:-7px;right:18px;width:0;height:0;border-bottom:7px solid #fff;border-right:7px solid transparent;border-left:7px solid transparent}.zjapp .content[data-v-2cac8864]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-2cac8864]{display:flex;flex-direction:column;background-color:#fff;overflow:auto}.zjapp .box-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1}.zjapp .detail-hd[data-v-2cac8864]{display:flex;padding:6px 15px}.zjapp .detail-arrow-right[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-right[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:12px;border:5px solid transparent;border-left:5px solid #c8c8c8}.zjapp .detail-arrow-down[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-down[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:15px;border:5px solid transparent;border-top:5px solid #c8c8c8}.zjapp .detail-title[data-v-2cac8864]{flex:1;line-height:34px;color:#111;font-size:16px}.zjapp .detail-bd[data-v-2cac8864]{padding:8px 15px 8px 35px;background-color:#fafafa}.zjapp .text-line[data-v-2cac8864]{font-size:14px;color:#666;line-height:30px;margin-bottom:30px}.zjapp .detail-hd-single[data-v-2cac8864]{padding:6px 0;margin:0 15px}.zjapp .detail-bd-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1;padding:8px 15px;background-color:#fff}',""])},8501:function(e,t,i){"use strict";i.r(t);var a=i("13578").a,r=(i("653a"),i("17cc")),n=Object(r.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("page-content",{attrs:{title:e.title,"show-go-root":!0}},[i("template",{slot:"header-bar-right"},[i("check-guide",{directives:[{name:"track",rawName:"v-track",value:"专项巡检-检查指引",expression:"'专项巡检-检查指引'"}],attrs:{"item-id":e.specialInspectId,module:"special-inspect"}})],1),e.loading?e._e():i("div",{staticClass:"page-scroll"},[9===e.mode&&e.checkitem?[i("item",{staticClass:"item-title",attrs:{border:"bottom"}},[i("div",{staticClass:"item-text"},[i("span",[e._v(e._s(e.checkitem.name))])])]),i("div",{staticClass:"content"},[i("item",{staticClass:"item-wrap"},[i("div",{staticClass:"item-text item-left"},[i("span",{staticClass:"color-gray"},[e._v("此项得分")])]),i("div",{staticClass:"item-text"},[e._v("\n            "+e._s(e.selecItem.level+"："+(e.selecItem.remark?e.selecItem.remark+", ":"")+e.reward+"分")+"\n          ")])]),e.image_file&&e.image_file.length?i("item",{staticClass:"item-wrap"},[i("div",{staticClass:"item-text item-left"},[i("span",{staticClass:"color-gray"},[e._v("检查照片")])]),i("item-img-list",{attrs:{maxlength:15,editabled:!1},model:{value:e.image_file,callback:function(t){e.image_file=t},expression:"image_file"}})],1):e._e()],1)]:e._e(),e.problemModel.data.problemList&&e.problemModel.data.problemList.length?i("div",{staticClass:"problem-wrap"},[i("div",{staticClass:"problem-wrap-title"},[i("div",{staticClass:"problem-title"},[e._v("问题列表 ("+e._s(e.problemModel.data.problemList.length)+")")]),i("div",{staticClass:"problem-btn"})]),i("div",{staticClass:"problem-list"},[e.problemModel.data.problemList?e._l(e.problemModel.data.problemList,(function(t,a){return i("item-list",{key:a,attrs:{"is-unread":t.unread,"is-timeout":t.is_timeout,"is-urgent":"紧急"==t.emergency_degree||"特急"==t.emergency_degree,"is-return":t.sent_back_times>0,img:t.thumbnail,title:t.item_full_name,detail:t.desc||""+t.remark||"",footer:e.fomatDate(t.created_on)+" "+(t.place||""),status:t.status,"status-text":t.status},on:{click:function(i){e.problemDetail(t)}}})})):i("div",{staticClass:"empty"},[i("img",{attrs:{src:e.png_empty,alt:""}}),i("span",[e._v("暂无新增问题")])])],2)]):e._e(),i("app-button-group",[e.allowRest?i("app-button",{attrs:{type:"text"},on:{click:e.checkItemRest}},[e._v("\n        删除已检查内容\n      ")]):e._e()],1)],2),i("loading-status",{attrs:{"is-loading":e.isLoading,"content-height":e.viewSize.contentHeight}})],2)}),[],!1,null,"58fae5c0",null);t.default=n.exports},"91c1":function(e,t,i){"use strict";(function(e){i("5ab2"),i("6d57"),i("e10e"),i("9a33");var a=i("28f8"),r=i("e68e"),n=i("6f9e"),o=i("bcc7"),s=i("e89f");function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}t.a={name:"CheckGuideDetailDrop",components:{ItemImgList:r.a},mixins:[s.a],data:function(){return{show:!1,showList:!1,isLoading:!1,isOpening:!1,isClosing:!1,contentTop:64,listHeight:510,module:"",itemIds:[],data:[],target:""}},watch:{show:function(e){var t=this;e&&this.$nextTick((function(){t.showList=!0}))}},created:function(){n.a.$on("routerBeforeEach",this.closePopup),n.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){n.a.$off("routerBeforeEach",this.closePopup),n.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(t){this.show=!0,this.$emit("open"),this.module=t.module,this.itemIds=t.itemIds,this.options=t.options;var i=document.querySelector(".layout-main .layout-header");if(this.contentTop=i.offsetHeight,t.el){var a=t.el.getBoundingClientRect();this.contentTop=a.bottom}this.target=t.el,this.listHeight=e.minBy([window.innerHeight-this.contentTop-50,510]),this.getData()},closePopup:function(){var e=this;if(!this.isOpening)return this.showList=!1,this.$emit("close"),new Promise((function(t){e.$on("afterClosePopup",t)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(e){e&&e.target&&e.target!==this.target&&this.show&&this.closePopup()},getData:function(){var t=this;return this.options&&this.options.length?(this.data=e.map(this.options,(function(e){return l(l({},e),{},{isOpen:!1})})),Promise.resolve()):o.a.getMeasureCheckItem(this.itemIds).then((function(i){t.data=e.map(i,(function(t){var i=t.content?t.content.trim():"",a=i?i.split("\n"):[],r=t.content_image?JSON.parse(t.content_image):[],n=e.filter(a,(function(e){return!/<img([\s\S]*)>/gm.test(e)}));return e.each(r,(function(e){e.url=e.url.split("@")[0]})),{id:t.id,name:t.full_name,textArr:n,contentImage:r,isOpen:!1}}))})).catch((function(e){console.error(e)}))},toggleItem:function(e){this.data.length>1&&this.$set(e,"isOpen",!e.isOpen)}}}}).call(this,i("391c"))},"967a":function(e,t,i){"use strict";var a=i("8d95");t.a={REPAIR_DEADLINE_STATUS:{name:"repair_deadline_status",status:["待整改"],module:[a.a.CHECK]}}},c070:function(e,t,i){var a=i("574c");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("35590dcb",a,!0,{sourceMap:!1,shadowMode:!1})},c59b:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .item-list{position:relative;padding:10px;display:flex;align-items:center;background-color:#fff;min-height:100px}.zjapp .item-list .img{display:block;width:80px;height:80px;background:no-repeat 50%;background-size:cover;background-color:#ddd}.zjapp .item-list .item-list-con{flex:1;padding:0 15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.zjapp .item-list .item-list-con .title{height:30px;line-height:24px;color:#111;font-size:16px;padding-top:6px;margin:0;padding-right:10px;margin-right:-10px;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important;font-weight:400}.zjapp .item-list .item-list-con .title .type-tag{display:inline-block;height:16px;line-height:16px;padding:0 4px;border-radius:2px;border:1px solid #4275e8;color:#4275e8;font-size:12px;zoom:.8;margin:3px 0 0 0;vertical-align:text-top}.zjapp .item-list .item-list-con .text{height:30px;line-height:24px;color:#8c8c8c;padding-bottom:6px;padding-right:11px;margin-right:-10px}.zjapp .item-list .item-list-con .text,.zjapp .item-list .item-list-con .time{font-size:14px;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important}.zjapp .item-list .item-list-con .time{height:20px;line-height:20px;color:#b3b3b3;padding-right:11px!important;margin-right:-10px!important}.zjapp .item-list .item-list-con .time .ion{color:#a6a6a6;font-size:20px;font-weight:700;margin-right:5px;vertical-align:top}.zjapp .item-list .item-list-r{width:60px;line-height:18px;text-align:center}.zjapp .item-list .item-list-status{min-width:4em;line-height:18px;text-align:center;white-space:normal;font-size:14px}.zjapp .item-list .icon-unread{display:inline-block;text-align:center;width:12px;height:12px;border-radius:6px;background-color:red}.zjapp .item-list .icon-return,.zjapp .item-list .icon-timeout,.zjapp .item-list .icon-urgent{display:inline-block;width:16px;height:16px;text-align:center;line-height:16px;font-size:12px;font-style:normal;color:#fff;border-radius:2px;-webkit-border-radius:2px;vertical-align:top;margin-top:4px;margin-right:5px}.zjapp .item-list .icon-timeout{background:#964bfe}.zjapp .item-list .icon-return{background:#fe8b00}.zjapp .item-list .icon-urgent{background:#ff3c3d}.zjapp .item-list .icon-return:last-child,.zjapp .item-list .icon-timeout:last-child,.zjapp .item-list .icon-urgent:last-child{margin-right:0}.zjapp .item-list-tip{height:70px;line-height:60px;color:#b4b4b4;text-align:center}.zjapp .status-new-tag{position:absolute;right:0;top:0;width:50px;height:50px;overflow:hidden;z-index:10}.zjapp .status-new-tag>.tag{position:absolute;right:-32px;bottom:22px;height:20px;line-height:20px;width:100px;color:#fff;font-size:12px;transform:rotate(45deg);text-align:center;border-width:1px;border-style:solid}.zjapp .time-status{font-size:10px;color:#999}",""])},d1d1:function(e,t,i){"use strict";(function(e){var a=i("fd50"),r=i("bcc7"),n=i("515e"),o=i("07d2"),s=i("7bac"),c=i("a7c3"),l=i("4360");t.a={name:"CheckGuideList",components:{Item:o.default},store:l.a,data:function(){return{isLoading:!0,listData:[],module:"",itemId:"",batchId:"",sectionId:"",options:""}},computed:{moduleAttribute:function(){return this.$store.state.global.moduleAttribute}},methods:{init:function(t){var i,r=this;for(var n in this.module=t.module,this.itemId=t.itemId,this.batchId=t.batchId,this.sectionId=t.sectionId,this.options=t.options,t)this[n]=t[n];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module];var o=!1;e.isEmpty(this.itemId)?!e.isEmpty(this.checkType)&&e.isEmpty(this.sectionId)?i=this.initByType():e.isEmpty(this.batchId)?e.isEmpty(this.options)?e.isEmpty(this.sectionId)?i=a.a.when():(o=!0,i=this.initByBidsection()):i=this.initByOptions():i=this.initByBatch():i=this.initById(),this.isLoading=!0,i.then((function(t){var i=r.moduleAttribute[r.module]||{};!e.isEmpty(i)&&i.setUsualItems&&o?s.a.getUserKey(r.mmkvCode()).then((function(e){e=null===e?t:r.mergeArray(r.deepClone(t),e),r.listData=e||[],r.isLoading=!1})):(r.listData=t||[],r.isLoading=!1)}))},mmkvCode:function(){var e=this.moduleAttribute[this.module]||{};return c.a[e.mmkv_item]+"_"+this.sectionId},mergeArray:function(t,i){var a=this;return e.filter(t,(function(t){var r=i[t.id];return e.isEmpty(t.subitem)||(t.subitem=a.mergeArray(t.subitem,i)),!e.isEmpty(r)||"desc"===t.type}))},clickItem:function(e){e.subitem&&e.subitem.length?this.$set(e,"isOpen",!e.isOpen):"special-inspect"===this.module?n.a.openPopup({itemId:e.id,module:this.module}):n.a.openPopup({itemId:e.item_id,module:this.module})},initById:function(){var e=this;if("special-inspect"!==this.module)return r.a.getCheckItem(this.itemId,this.checkType).then((function(t){return t?e.sectionId?r.a.getBidSectionCheckItemListByCode(e.sectionId,t.code):r.a.getCheckItemTreeByCode(t.code):a.a.when()}))},initByType:function(){return r.a.getCheckItemGuidelineList(this.checkType)},initByBatch:function(){return a.a.when()},initByBidsection:function(){return r.a.getBidSectionCheckItemTreeByType(this.sectionId,this.checkType)},initByOptions:function(){return a.a.resolve(this.options)},deepClone:function(e){return JSON.parse(JSON.stringify(e))}}}}).call(this,i("391c"))},da1c:function(e,t,i){"use strict";i("163d");var a=i("65a8"),r={name:"ProblemHeader",props:{status:{type:String,default:""},statusText:{type:String,default:""},level:{type:String,default:""},isTimeout:{type:Boolean,default:!1},sentBackTimes:{type:[Number,String],default:0}},data:function(){return{edOptions:{}}},created:function(){var e=this;a.a.getOptions("紧急程度").then((function(t){e.edOptions=t}))}},n=(i("1f63"),i("17cc")),o=Object(n.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._g({staticClass:"problem-detail-header border-bottom"},e.$listeners),[i("div",{staticClass:"status",class:{"待整改":"status-red","不合格":"status-red","已退回":"status-red","待复验":"status-orange","已放水待验收":"status-orange","检查中":"status-orange","待验收":"status-orange","已通过":"status-green","已整改":"status-green","已提交":"status-green","合格":"status-green","检查完毕":"status-green","已验收":"status-green","已关闭":"status-black","进度正常":"status-green","进度滞后":"status-red","验收中":"status-orange","已抽验":"status-green"}[e.status]},[e._v(e._s(e.statusText||e.status))]),"紧急"===e.level||"特急"===e.level?i("span",{staticClass:"urgent"},[e._v(e._s(e.edOptions[e.level]))]):e._e(),e.isTimeout?i("span",{staticClass:"timeout"},[e._v("超时")]):e._e(),e.sentBackTimes>0?i("span",{staticClass:"return"},[e._v("退回"+e._s(e.sentBackTimes)+"次")]):e._e(),e._t("operat")],2)}),[],!1,null,"0901aadd",null);t.a=o.exports},dc98:function(e,t,i){"use strict";i("0732")},dd16:function(e,t,i){"use strict";(function(e){t.a={name:"StatusText",props:{status:{type:String},text:{type:String},extend:{type:Object,default:function(){return{}}},statusStyles:{type:Object,default:function(){return{}}}},data:function(){return{classSet:e.extend({"草稿":"color-gray","暂存":"color-gray","检查中":"color-orange","待整改":"color-red","待复验":"color-orange","待验收":"color-red","待报验":"color-red","待申请进场":"color-red","待初验":"color-red","待送检":"color-red","待上传报告":"color-red","待退场":"color-red","待建设单位验收":"color-red","待区域验收":"color-red","供应链退回":"color-red","预创建":"color-status-blue","已提交":"color-green","已整改":"color-green","已验收":"color-green","已通过":"color-green","已退场":"color-gray","已关闭":"color-gray","非正常关闭":"color-gray","已退回":"color-red","已完成":"color-green","已甩项":"color-gray","检查完毕":"color-green","送检合格":"color-green","复验合格":"color-green","验收合格":"color-green","验收不合格":"color-red","未验收":"color-orange","待点评":"color-orange","已点评":"color-green","合格":"color-green","不合格":"color-red","待审核":"color-orange","已发布":"color-green","已拒绝":"color-red","进度正常":"color-green","进度滞后":"color-red","正常":"color-green","滞后":"color-red","施工单位验收合格":"color-green","监理单位验收合格":"color-green","建设单位验收合格":"color-green","施工单位验收不合格":"color-red","监理单位验收不合格":"color-red","建设单位验收不合格":"color-red"},this.extend)}},mounted:function(){}}}).call(this,i("391c"))},e9ea:function(e,t,i){(e.exports=i("690e")(!1)).push([e.i,".zjapp .guide-box[data-v-ff0679ce]{flex:1;display:flex}.zjapp .page-scroll[data-v-ff0679ce]{flex:1;overflow:auto;padding-bottom:100px;transform:translateZ(0)}.zjapp .sublist[data-v-ff0679ce]{padding-left:25px;padding-top:1px;background-color:#fff}.zjapp .sublist>.sublist[data-v-ff0679ce]{padding-left:10px;padding-top:0}",""])},ef1c:function(e,t,i){var a=i("e9ea");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("85cb").default)("2e832052",a,!0,{sourceMap:!1,shadowMode:!1})},f1e4:function(e,t,i){"use strict";(function(e){i("5ab2"),i("e10e");var a=i("28f8"),r=(i("9e76"),i("6d57"),i("9a33"),i("f548"),i("cc57"),i("4ad6")),n=i("e89f"),o=i("bcc7"),s=i("3122"),c=i("6e1b"),l=i("c130"),p=i("0636");function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){Object(a.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}t.a={name:"CheckGuideDetail",components:{},mixins:[n.a],data:function(){return{show:!1,isLoading:!0,isImageDownloading:!1,title:"",content:[],module:"",itemId:""}},methods:{openPopup:function(t){var i=this;for(var a in this.value=!0,this.show=!0,this.module=t.module,this.itemId=t.itemId,this.$emit("open"),t)this[a]=t[a];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module],this.isLoading=!0,("special-inspect"===this.module?c.a.getSpecialInspectCheckItemDetail(this.itemId):"templet-plan"===this.module?l.a.getTempletDetail(this.itemId):"material"===this.module?p.a.getMaterialDetail(this.itemId):o.a.getCheckItem(this.itemId,this.checkType)).then((function(t){console.log("checkitemData",t),t=t||{},i.checkitemData=t,i.title=t.full_name||t.name,"special-inspect"!==i.module&&"inspect"!==i.module&&"fly-inspect"!==i.module&&"material"!==i.module||(t.content=t.guideline||t.content);var a=t.content?t.content.trim():"";if(a=(a=(a=(a=(a=a.replace(/<\/p><p>/gm,"\n")).replace(/<p>/gm,"")).replace(/<\/p>/gm,"")).replace(/<br>/gm,"")).replace(/<br \/>/gm,""),/(<img[^\>]*>)/gm.test(a)){var r=a.split(/(<img[^\>]*>)/gm);(r=r.filter((function(e){return!!e}))).forEach((function(e,t){e&&!/^\s*\n/.test(e)&&t&&!/\n\s*$/.test(r[t-1])&&(r[t]="\n"+e)})),a=r.join("")}var n=a?a.split("\n"):[];i.content=e.map(n,(function(e,t){var i;if(/<img([\s\S]*)>/gm.test(e)){var a=e.split(/\ssrc="([^"]*)"/gm)[1],r=a?a.match(/[\w|-]{36}/gm)[0]:(new Date).getTime()+"-"+t;i={isImg:!0,src:"",url:a,status:"pending",id:r,ready:!0}}else i={isImg:!1,val:e};return i})),i.downloadImage(),i.isLoading=!1})).catch((function(e){$log.log(e)}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},getThumbnail:function(e){return"pending"===e.status?s.a.IMAGE_LOADING:"rejected"===e.status?s.a.IMAGE_RELOAD:"dev"===APP_ENV?e.url:"fulfilled"===e.status?e.src:($log.log("检查指引-显示图片：",e),s.a.IMAGE_PLACEHOLD)},imgError:function(e,t){$log.error("检查指引-加载图片出现错误：",e);var i=u({},e);i.status="rejected",this.$set(this.content,t,i)},downloadImage:function(t){var i=this;t=t?[t]:this.imageList(),e.each(t,(function(t){var a=u({},t),r=e.map(i.content,(function(e){return e.id})).indexOf(t.id);s.a.isNeedDownload(t.url).then((function(e){e?s.a.download(t.url).then((function(e){a.status="fulfilled",a.src=s.a.fixUrl(e),i.$set(i.content,r,a)})).catch((function(e){$log.error("检查指引-下载图片：",e)})):(a.status="fulfilled",a.src=s.a.fixUrl(s.a.getPathFromUrl(t.url)),i.$set(i.content,r,a))}))}))},imageList:function(){return e.filter(this.content,(function(e){return e.isImg}))},imgClick:function(t){var i=this;if("pending"===t.status)return!1;if("rejected"===t.status)return this.downloadImage(t),$log.log("检查指引-点击重新加载-重新下载图片：",t),!1;var a=this.imageList(),n=e.map(a,(function(e){return e.id})).indexOf(t.id);a=e.map(a,(function(e){return i.getThumbnail(e)})),r.a.openImageBrowser(a,n)}}}}).call(this,i("391c"))},f369:function(e,t,i){"use strict";var a=i("fd50"),r=i("bcc7"),n=i("329b"),o=i("d1d1").a,s=(i("3411"),i("17cc")),c={name:"CheckGuideList",components:{GuideList:Object(s.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"guide-box"},[!e.isLoading&&e.listData.length?i("div",{staticClass:"page-scroll"},e._l(e.listData,(function(t,a){return i("div",{key:a},[i("item",{attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){e.clickItem(t)}}},[i("div",{staticClass:"item-text fw-b color-blue one-line"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){e.clickItem(t)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){e.clickItem(t)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,a){return i("div",{key:a,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){e.clickItem(t)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])])],1)})):e._e()],2)})):e._e()],2)})):e._e()],2)}))):e._e(),i("loading-status",{attrs:{"is-loading":e.isLoading,"is-empty":!e.listData.length,"empty-text":"没有检查项"}})],1)}),[],!1,null,"ff0679ce",null).exports},mixins:[i("e89f").a],data:function(){return{show:!1}},methods:{openPopup:function(e){var t=this;this.value=!0,this.show=!0,this.$nextTick((function(){t.$refs["guide-list"].init(e),t.$emit("open")}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")}}},l=Object(s.a)(c,(function(){var e=this.$createElement,t=this._self._c||e;return t("transition",{attrs:{name:"slide-right"}},[this.show?t("page-content",{attrs:{mode:"dialog",title:"检查指引","on-close":this.closePopup}},[t("guide-list",{ref:"guide-list"})],1):this._e()],1)}),[],!1,null,null,null).exports,p=!1;p||(p=new(n.default.extend(l))({el:document.createElement("div")}),document.body.appendChild(p.$el));var d=p,u=i("515e"),m=i("91c1").a,g=(i("dc98"),Object(s.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.show?i("div",{staticClass:"main",style:{top:e.contentTop+"px"}},[i("i",{staticClass:"arrow"}),i("div",{staticClass:"content",on:{click:function(t){return t.target!==t.currentTarget?null:e.closePopup(t)}}},[i("transition",{attrs:{name:"slide-down"},on:{enter:function(t){e.isOpening=!0},"after-enter":function(t){e.isOpening=!1},leave:function(t){e.isClosing=!0},"after-leave":e.afterClose}},[e.showList?i("div",{staticClass:"box",style:{height:e.listHeight+"px"}},e._l(e.data,(function(t,a){return i("div",{key:a,class:{"border-bottom":e.data.length>1,"box-single":1===e.data.length}},[i("div",{staticClass:"detail-hd",class:{"border-bottom":e.data.length<=1,"detail-hd-single":e.data.length<=1},on:{click:function(i){e.toggleItem(t)}}},[e.data.length>1?i("i",{class:{"detail-arrow-right":!t.isOpen,"detail-arrow-down":t.isOpen}}):e._e(),i("div",{staticClass:"detail-title"},[e._v(e._s(t.name))])]),e.data.length<=1||t.isOpen?i("div",{staticClass:"detail-bd",class:{"detail-bd-single":e.data.length<=1}},[e._l(t.textArr,(function(t,a){return i("p",{key:a,staticClass:"text-line"},[e._v("\n              "+e._s(t)+"\n            ")])})),i("item-img-list",{attrs:{editabled:!1},model:{value:t.contentImage,callback:function(i){e.$set(t,"contentImage",i)},expression:"item.contentImage"}}),i("loading-status",{attrs:{"is-empty":!t.textArr.length&&!t.contentImage.length,"empty-text":"PC端未设置检查指引"}})],2):e._e()])}))):e._e()])],1)]):e._e()}),[],!1,null,"2cac8864",null).exports),f=!1;f||(f=new(n.default.extend(g))({el:document.createElement("div")}),document.body.appendChild(f.$el));var h=f,b={name:"CheckGuide",components:{},props:{module:{type:String,default:""},mode:{type:String,default:"page"},itemId:{type:String,default:""},itemIds:{type:Array,default:function(){return[]}},batchId:{type:String,default:""},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}},optionsPromise:{type:Function,default:function(){}},beforeOpen:{type:Function,default:function(){}}},data:function(){return{isLoading:!1}},methods:{openCheckGuide:function(){var e=this,t=this.beforeOpen&&this.beforeOpen();t instanceof Promise||(t=Promise.resolve(t)),t.then((function(t){!1!==t&&("drop"===e.mode?h.openPopup({itemIds:e.itemIds,el:e.$refs["check-guide-btn"],options:e.options}):("templet-plan"===e.module?a.a.when(!1):e.itemId&&e.sectionId?r.a.hasChildSectionCheckItem(e.itemId,e.sectionId):e.itemId?r.a.hasChildCheckItem(e.itemId):a.a.when(!0)).then((function(t){t?d.openPopup({module:e.module,itemId:e.itemId,batchId:e.batchId,sectionId:e.sectionId,options:e.options}):u.a.openPopup({itemId:e.itemId,module:e.module})})))}))}}},x=Object(s.a)(b,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"check-guide-btn",staticClass:"header-btn",on:{click:function(t){e.openCheckGuide()}}},[i("icon",{attrs:{name:"nav-info"}})],1)}),[],!1,null,null,null);t.a=x.exports},f647:function(e,t,i){"use strict";(function(e){i("e697"),i("cc57"),i("163d");var a,r=i("fd50"),n=i("6e1b"),o=i("3bd5"),s=i("3122"),c=i("48f4");t.a=a={data:{problemData:{},problemList:[]},batchIdOrSpecialInspectId:"",isListLoading:!0,toParams:null,init:function(e,t,i,r){var n;return a.toParams=r,void 0===r?n=a.lastRequest():r.batchId&&6===Number(r.mode)?(n=a.getContractAllProblemList(r.batchId),a.lastRequest=function(){return a.getContractAllProblemList(r.batchId)}):r.batchId&&9==+r.mode||10==+r.mode&&!r.specialInspectId?(n=a.getAllProblemsIncloudRoot(r.batchId),a.lastRequest=function(){return a.getAllProblemsIncloudRoot(r.batchId)}):r.specialInspectId?(n=a.getCheckItemProblemList(r.specialInspectId),a.lastRequest=function(){return a.getCheckItemProblemList(r.specialInspectId)}):(n=a.getAllProblemList(r.batchId),a.lastRequest=function(){return a.getAllProblemList(r.batchId)}),n.then((function(){a.isListLoading=!1}))},getCheckItemProblemList:function(t){return n.a.getSpecialInspectProblemList(t).then((function(t){a.data.problemList=t;var i=e.filter(t,(function(e){var t=JSON.parse(e.image_file||"[]");return s.a.isNeedThumbnail(t)}));c.default.autoLoadThumbnail(i,"专项巡检","image_file","thumbnail","checkquality_problem")}))},getAllProblemList:function(t){return n.a.getSpecialInspectBatchProblemOfAll(t).then((function(t){a.data.problemList=t;var i=e.filter(t,(function(e){var t=JSON.parse(e.image_file||"[]");return s.a.isNeedThumbnail(t)}));c.default.autoLoadThumbnail(i,"专项巡检","image_file","thumbnail","checkquality_problem")}))},getAllProblemsIncloudRoot:function(t){return n.a.getSpecialInspectBatchProblemsIncloudRoot(t).then((function(t){a.data.problemList=t;var i=e.filter(t,(function(e){var t=JSON.parse(e.image_file||"[]");return s.a.isNeedThumbnail(t)}));c.default.autoLoadThumbnail(i,"专项巡检","image_file","thumbnail","checkquality_problem")}))},getContractAllProblemList:function(t){return n.a.getContractAllProblemList(t).then((function(t){a.data.problemList=t;var i=e.filter(t,(function(e){var t=JSON.parse(e.image_file||"[]");return s.a.isNeedThumbnail(t)}));c.default.autoLoadThumbnail(i,"专项巡检","image_file","thumbnail","checkquality_problem")}))},getCheckProblemInfo:function(t){var i,s=a.data;return t?n.a.getCheckProblemInfo(t).then((function(t){(i=t).regist={id:t.regist.id,name:t.regist.name,mobile:t.regist.mobile,is_im_user:t.regist.is_im_user},t.repair&&t.repair.id?i.repair={id:t.repair.id,name:t.repair.name,mobile:t.repair.mobile,is_im_user:t.repair.is_im_user}:i.repair=e.clone(t.repair_set),i.place={full_name:t.place},i.checkItem={id:t.item_id,name:t.item_name,full_name:t.item_full_name},i.description={id:t.desc_id,name:t.desc},i.image_file=JSON.parse(t.image_file||"[]"),i.level=t.emergency_degree||"一般",i.sent_back={id:t.sent_back.id,name:t.sent_back.name,mobile:t.sent_back.mobile},i.sent_back_image_file=JSON.parse(t.sent_back_image_file||"[]"),i.repair_image_file=JSON.parse(t.repair_image_file||"[]"),i.contractor={id:t.contractor_id,name:t.contractor_name},i.cc_set=t.cc_set_array,i.place_point=JSON.parse(t.problem_values||"[]"),i.drawing_file=JSON.parse(t.drawing_file||"[]"),i.deadline=t.deadline||7,i.currentReinspectBy=e.find(e.clone(i.reinspectBy),(function(e){return e.id===o.a.getUser().user_id}))||{reinspect_image_file:[],reinspect_remark:""}})).then((function(){return n.a.getSpecialInspectCheckItemDetail(i.biz_id).then((function(e){e.checkitem_extension&&"string"==typeof e.checkitem_extension&&(i.checkitem_extension=JSON.parse(e.checkitem_extension)),i.isRedlineDeduction=1===e.is_redline_deduction}))})).then((function(){return s.problemData=i,i})):r.a.reject("问题id为空")},getProjectUsers:function(e){return ProjectService.getAllProjectUsers(e).then((function(e){return a.data.users=e,e}))},createNewData:function(e){var t={status:"",place:{},batch_type:"专项巡检",checkItem:{},description:{},image_file:[],remark:"",level:"一般",deadline:7,repair_set:{},contractor:{},cc_set:[],reinspect_set:[],building_id:"",unit:"",room_id:"",place_point:[],deduction:1,redline_deduction:0,biz_id:e};return n.a.getSpecialInspectCheckItemDetail(e).then((function(e){e.checkitem_extension&&"string"==typeof e.checkitem_extension&&(t.checkitem_extension=JSON.parse(e.checkitem_extension)),t.proj_id=e.proj_id,t.batch_id=e.batch_id,t.checkItem={id:e.item_id,name:e.full_name,full_name:e.full_name},t.isRedlineDeduction=1===e.is_redline_deduction,void 0!==e.deduction&&""!==e.deduction&&null!==e.deduction&&(t.deduction=e.deduction)})).then((function(){return a.data.problemData=t,t}))}}}).call(this,i("391c"))},fa4f:function(e,t,i){"use strict";var a=i("4aef"),r=i("967a"),n={name:"ItemList",components:{StatusText:a.a},props:{img:{type:String,default:""},title:{type:String,default:""},detail:{type:String,default:""},footer:{type:String,default:""},status:{type:String,default:""},isShowNewStatus:{type:Boolean,default:!1},statusText:{type:String,default:""},statusClassSet:{type:Object,default:function(){return{}}},typeTag:{type:String,default:""},isUnread:{type:Boolean,default:!1},isTimeout:{type:Boolean,default:!1},isUrgent:{type:Boolean,default:!1},isReturn:{type:Boolean,default:!1},repairDeadline:{type:String,default:null}},data:function(){return{repairDeadlineStatus:r.a.REPAIR_DEADLINE_STATUS.status}},computed:{bgNewClass:function(){return{"草稿":"bg-gray7 b-color","暂存":"bg-gray b-color","检查中":"bg-orange b-color","待整改":"bg-red2 b-color ","待复验":"bg-purple b-color","待验收":"bg-red b-color","待报验":"bg-red b-color","待申请进场":"bg-red b-color","待初验":"bg-red b-color","待送检":"bg-red b-color","待上传报告":"bg-red b-color","待退场":"bg-red b-color","待建设单位验收":"bg-red b-color","待区域验收":"bg-red b-color","已提交":"bg-green b-color","已整改":"bg-green b-color","已验收":"bg-green b-color","已通过":"bg-green2 b-color","已退场":"bg-gray b-color","已关闭":"bg-gray7 b-color","非正常关闭":"bg-gray b-color","已退回":"bg-red b-color","已完成":"bg-green b-color","已甩项":"bg-gray b-color","检查完毕":"bg-green b-color","送检合格":"bg-green b-color","复验合格":"bg-green b-color","验收合格":"bg-green b-color","验收不合格":"bg-red b-color","未验收":"bg-orange b-color","待点评":"bg-orange b-color","已点评":"bg-green b-color","合格":"bg-green b-color","不合格":"bg-red b-color","进度正常":"bg-green2 b-color","进度滞后":"bg-red2 b-color","施工单位验收合格":"bg-green b-color","监理单位验收合格":"bg-green b-color","建设单位验收合格":"bg-green b-color","施工单位验收不合格":"bg-red b-color","监理单位验收不合格":"bg-red b-color","建设单位验收不合格":"bg-red b-color"}}},activated:function(){}},o=(i("19a9"),i("17cc")),s=Object(o.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._g({staticClass:"item-list border-bottom"},e.$listeners),[e.isShowNewStatus?i("div",{staticClass:"status-new-tag"},[i("div",{staticClass:"tag",class:e.bgNewClass[e.status]},[e._v("\n      "+e._s(e.status)+"\n    ")])]):e._e(),e.img?i("div",{staticClass:"img",style:{"background-image":"url("+e.img+")"}}):e._e(),i("div",{staticClass:"item-list-con"},[i("h2",{staticClass:"title"},[e.isUnread?i("i",{staticClass:"icon-unread"}):e._e(),e.isTimeout?i("i",{staticClass:"icon-timeout"},[e._v("\n        超\n      ")]):e._e(),e.isUrgent?i("i",{staticClass:"icon-urgent"},[e._v("\n        急\n      ")]):e._e(),e.isReturn?i("i",{staticClass:"icon-return"},[e._v("\n        退\n      ")]):e._e(),e.$slots.title?e._t("title"):[e.typeTag?i("span",{staticClass:"type-tag"},[e._v(e._s(e.typeTag))]):e._e(),e._v("\n        "+e._s(e.title||"")+"\n      ")]],2),i("p",{staticClass:"text"},[e._v(e._s(e.detail||""))]),e.$slots.footer?e._t("footer"):i("p",{staticClass:"time",domProps:{innerHTML:e._s(e.footer||"")}})],2),e.status&&!e.isShowNewStatus?i("div",{staticClass:"item-list-status"},[i("status-text",{attrs:{status:e.status,text:e.statusText,extend:e.statusClassSet}}),e.repairDeadline&&e.repairDeadlineStatus.includes(e.status)?i("p",{staticClass:"time-status"},[e._v("\n      "+e._s(e._f("timeStatus")(e.repairDeadline))+"\n    ")]):e._e()],1):e._e()])}),[],!1,null,null,null);t.a=s.exports}}]);