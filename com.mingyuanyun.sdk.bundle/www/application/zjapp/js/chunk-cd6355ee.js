(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-cd6355ee"],{"279e":function(e,t,n){(e.exports=n("690e")(!1)).push([e.i,".zjapp .drop-select[data-v-19e08ef3] div,.zjapp .drop-select[data-v-19e08ef3] i{pointer-events:none}.zjapp .filter-tabs[data-v-19e08ef3]{display:flex}.zjapp .filter-tab[data-v-19e08ef3]{flex:1;min-height:44px;line-height:16px;padding:6px 5px 0;text-align:center;font-size:14px;color:#999;background-color:#fafafa;border-right:1px solid #ececec;border-bottom:1px solid #ececec}.zjapp .filter-tab[data-v-19e08ef3]:last-child{border-right:none}.zjapp .filter-tab.current[data-v-19e08ef3]{border-bottom:none;background-color:#fff;color:#4275e8}.zjapp .item-node[data-v-19e08ef3]{display:flex;position:relative;padding:24px 15px 19px 0;background-position:75px 0!important;overflow:hidden;background-color:#fff}.zjapp .item-node-main[data-v-19e08ef3]{display:flex;flex:1}.zjapp .item-node-time[data-v-19e08ef3]{width:75px;color:#666;text-align:center}.zjapp .item-node-con[data-v-19e08ef3]{flex:1;padding-left:20px}.zjapp .item-node-day[data-v-19e08ef3]{font-size:15px;line-height:15px}.zjapp .item-node-year[data-v-19e08ef3]{font-size:9px;line-height:9px;margin-top:7px}.zjapp .item-node-title[data-v-19e08ef3]{font-size:17px;line-height:17px;color:#333;word-wrap:break-word;word-break:break-all}.zjapp .item-node-detail[data-v-19e08ef3]{font-size:0;line-height:0;padding-top:10px;margin-bottom:-5px}.zjapp .item-node-exceed[data-v-19e08ef3]{display:inline-block;vertical-align:top;height:17px;line-height:17px;font-size:11px;color:#999}.zjapp .item-node-level[data-v-19e08ef3]{color:#999;background-color:#f4f4f4}.zjapp .item-node-level[data-v-19e08ef3],.zjapp .item-node-timeout[data-v-19e08ef3]{display:inline-block;vertical-align:top;margin-right:5px;margin-bottom:5px;height:17px;padding:0 7px;line-height:17px;font-size:11px;border-radius:8.5px}.zjapp .item-node-timeout[data-v-19e08ef3]{color:#fff;background-color:#ff3c46}.zjapp .item-node-report[data-v-19e08ef3]{background-color:#ff7439}.zjapp .item-node-report[data-v-19e08ef3],.zjapp .item-node-review[data-v-19e08ef3]{display:inline-block;vertical-align:top;margin-right:5px;margin-bottom:5px;height:17px;padding:0 7px;line-height:17px;font-size:11px;color:#fff;border-radius:8.5px}.zjapp .item-node-review[data-v-19e08ef3]{background-color:#796bfb}.zjapp .item-node-surplus[data-v-19e08ef3]{display:inline-block;vertical-align:top;margin-right:5px;margin-bottom:5px;height:17px;padding:0 7px;line-height:17px;font-size:11px;color:#fff;background-color:#febd01;border-radius:8.5px}.zjapp .item-node-status[data-v-19e08ef3]{padding-left:10px}.zjapp .item-node-opare[data-v-19e08ef3]{display:inline-block;height:28px;line-height:26px;border:1px solid #ececec;padding:0 10px;color:#666;border-radius:14px}.zjapp .item-node-opare.disabled[data-v-19e08ef3]{background:#ececec;color:#bababa}.zjapp .item-node-bar-bg[data-v-19e08ef3]{position:absolute;left:74px;top:0;width:2px;height:100%;background-color:#f4f4f4}.zjapp .item-node-bar[data-v-19e08ef3]{position:absolute;left:0;top:0;width:2px;background-color:#c3cee6}.zjapp .item-node:first-child .item-node-bar-bg[data-v-19e08ef3]{top:33px}.zjapp .item-node:last-child .item-node-bar-bg[data-v-19e08ef3]{height:33px}.zjapp .item-node-icon-pending[data-v-19e08ef3]{background-color:#c8c8c8}.zjapp .item-node-icon-doing[data-v-19e08ef3],.zjapp .item-node-icon-pending[data-v-19e08ef3]{position:absolute;top:29px;left:71px;width:8px;height:8px;border-radius:4px}.zjapp .item-node-icon-doing[data-v-19e08ef3]{background-color:#7a95d1}.zjapp .item-node-icon-finish[data-v-19e08ef3]{position:absolute;top:24px;left:66px;width:18px;height:18px;line-height:15px;border-radius:9px;background-color:#7a95d1;font-size:14px;color:#fff;text-align:center}.zjapp .item-node-icon-finish[data-v-19e08ef3] .icon{font-size:8px}",""])},"2b59":function(e,t,n){"use strict";n("3d80")},"3d80":function(e,t,n){var i=n("279e");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n("85cb").default)("6c745e46",i,!0,{sourceMap:!1,shadowMode:!1})},"40e8":function(e,t,n){"use strict";n.r(t);var i=n("67cf").a,a=(n("2b59"),n("17cc")),o=Object(a.a)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("page-content",{attrs:{title:e.title}},[n("item",{staticClass:"bg-sub-theme drop-select",attrs:{text:e.schedulePlanText,border:"bottom","icon-right":e.isDropSelectOpen?"arrow-up":"arrow-down"},on:{click:e.selectSchedulePlan}}),!e.isNodeLoading&&e.schedulePlan&&e.schedulePlan.id&&!e.errorTips?n("div",{staticClass:"filter-tabs"},e._l(e.filterData,(function(t,i){return n("div",{key:i,staticClass:"filter-tab",class:{current:e.filterType===t.type},on:{click:function(n){e.changeFilter(t.type)}}},[e._v("\n      "+e._s(t.name)),n("br"),e._v(e._s(t.data.length)+"\n    ")])}))):e._e(),n("scroller",{attrs:{"is-empty":e.isNodeLoading||!e.nodeList.length||!(e.schedulePlan&&e.schedulePlan.id)||!!e.errorTips}},[!e.isNodeLoading&&e.schedulePlan&&e.schedulePlan.id&&!e.errorTips?e._l(e.nodeList,(function(t,i){return n("div",{directives:[{name:"track",rawName:"v-track",value:"进度管理-计划详情页-进入单个节点",expression:"'进度管理-计划详情页-进入单个节点'"}],key:i,staticClass:"item-node",class:{"border-top":i},on:{click:function(n){e.gotoDetail(t)}}},[e.nodeList.length>1?n("div",{staticClass:"item-node-bar-bg"},[n("div",{staticClass:"item-node-bar",style:{height:{a:"100%",b:"100%",t:"33px"}[t.bar_status],top:{a:0,b:"33px",t:0}[t.bar_status]}})]):e._e(),n("div",{class:{"item-node-icon-finish":"finish"===t.node_status,"item-node-icon-doing":"doing"===t.node_status,"item-node-icon-pending":"pending"===t.node_status}},["已完成"===t.status?n("icon",{attrs:{name:"qualified"}}):e._e()],1),n("div",{staticClass:"item-node-main"},[n("div",{staticClass:"item-node-time"},[n("p",{staticClass:"item-node-day"},[e._v("\n              "+e._s(t.deadline?e.dateFormat(t.deadline,"MM-DD"):"未设")+"\n            ")]),n("p",{staticClass:"item-node-year"},[e._v("\n              "+e._s(t.deadline?e.dateFormat(t.deadline,"YYYY"):"计划时间")+"\n            ")])]),n("div",{staticClass:"item-node-con"},[n("p",{staticClass:"item-node-title"},[e._v(e._s(t.name))]),n("div",{staticClass:"item-node-detail"},[n("span",{staticClass:"item-node-level"},[e._v(e._s(t.schedule_node_level_value))]),t.complete_time&&"已完成"===t.status?n("span",{staticClass:"item-node-exceed"},[e._v("\n                实际"+e._s(e.dateFormat(t.complete_time,"YYYY-MM-DD"))+"\n              ")]):e._e(),t.complete_time&&t.overday&&"已完成"===t.status?n("span",{staticClass:"item-node-exceed ml5",class:{"color-red":t.is_overtime}},[e._v("\n                "+e._s(t.overday)+"\n              ")]):e._e(),!t.complete_time&&t.overday?n("span",{staticClass:"item-node-timeout"},[e._v("\n                "+e._s(t.overday)+"\n              ")]):e._e(),!t.complete_time&&t.leftday?n("span",{staticClass:"item-node-surplus"},[e._v("\n                "+e._s(t.leftday)+"\n              ")]):e._e(),!t.complete_time&&t.report_count&&"0"!==t.report_count?n("span",{staticClass:"item-node-report"},[e._v("\n                已汇报"+e._s(t.report_count)+"次\n              ")]):e._e(),"待审核"===t.status&&t.no_check_count>0?n("span",{staticClass:"item-node-review"},[e._v("\n                需"+e._s(t.no_check_count)+"人审核\n              ")]):e._e()])])]),t.canReport?n("div",{staticClass:"item-mode-status"},[n("span",{staticClass:"item-node-opare",class:{disabled:t.erpNeedReport}},[e._v("去汇报")])]):e._e(),"待审核"===t.checker_status&&"待审核"===t.status?n("div",{staticClass:"item-mode-status"},[n("span",{staticClass:"item-node-opare"},[e._v("去审核")])]):e._e()])})):e._e(),n("loading-status",{attrs:{"is-loading":e.isNodeLoading,"is-empty":!e.nodeList.length||!(e.schedulePlan&&e.schedulePlan.id)||!!e.errorTips,"empty-text":e.errorTips?e.errorTips:e.schedulePlan&&e.schedulePlan.id?"无此类节点":"PC端未设置进度计划",type:e.errorTips?"error":"common"}})],2)],1)}),[],!1,null,"19e08ef3",null);t.default=o.exports},"47df":function(e,t,n){var i=n("cc4c");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n("85cb").default)("1ffcc628",i,!0,{sourceMap:!1,shadowMode:!1})},"67cf":function(e,t,n){"use strict";(function(e){n("f548"),n("e697"),n("cc57");var i=n("07d2"),a=n("774b"),o=n("d152"),r=n("f97c"),s=n("6144"),l=n("bc69"),c=n("7136"),d=n("6bf2"),u=n.n(d),p=n("9416"),h=n("8d95");t.a={name:"SchedulePlan",components:{item:i.a,Scroller:a.a},data:function(){return{title:Object(p.a)(h.a.SCHEDULE_PLAN)||"进度管理",isPlanLoading:!0,isNodeLoading:!0,errorTips:"",projId:"",planId:"",schedulePlan:{},schedulePlanList:[],nodeListAll:[],nodeList:[],filterData:[{type:0,name:"全部节点",data:[]},{type:1,name:"1级预警",data:[]},{type:2,name:"2级预警",data:[]},{type:3,name:"其他预警",data:[]}],filterType:0}},computed:{isDropSelectOpen:function(){return o.a.show},schedulePlanText:function(){return this.isPlanLoading?"...":this.errorTips?this.errorTips:e.isEmpty(this.schedulePlan)?"PC端未设置进度计划":this.schedulePlan.name}},activated:function(){var e=this.$route.query.proj_id;this.projId=e||r.a.getDefaultProject().id,this.planId=this.$route.params.planId,this.init()},methods:{init:function(){var t=this;return this.errorTips="",this.getSchedulePlanList().then((function(){return t.getSchedulePlan()})).then((function(){return t.saveSchedulePlan()})).then((function(){return t.getFilterData()})).then((function(){return t.getNodeData()})).catch((function(n){console.error(n),t.errorTips=e.isString(n)?n:n&&n.errmsg||"获取数据失败",t.isPlanLoading=!1,t.isNodeLoading=!1}))},getSchedulePlanList:function(){var e=this;return c.a.getSchedulePlanList(this.projId).then((function(t){e.schedulePlanList=t}))},getSchedulePlan:function(){var t,n=this,i=s.a.getUserObject(l.a.LAST_SCHEDULE_PLAN_ID)||{};e.isEmpty(this.schedulePlanList)?t=null:this.planId?t=e.find(this.schedulePlanList,(function(e){return e.id===n.planId})):i[this.projId]&&(t=e.find(this.schedulePlanList,(function(e){return e.id===i[n.projId]}))),!e.isEmpty(this.schedulePlanList)&&e.isEmpty(t)&&(t=this.schedulePlanList[0]),this.schedulePlan=t,this.isPlanLoading=!1},saveSchedulePlan:function(){var t=s.a.getUserObject(l.a.LAST_SCHEDULE_PLAN_ID)||{};e.isEmpty(this.schedulePlan)||(t[this.projId]=this.schedulePlan.id,s.a.saveUserObject(l.a.LAST_SCHEDULE_PLAN_ID,t))},getFilterData:function(){var t=this;return e.isEmpty(this.schedulePlan)?Promise.resolve():c.a.schedulePlanNodeList(this.schedulePlan.id).then((function(e){t.filterData[1].name=e[0].value.replace("预警","")+"预警",t.filterData[2].name=e[1].value.replace("预警","")+"预警"}))},getNodeData:function(){var t=this;return e.isEmpty(this.schedulePlan)?(this.isNodeLoading=!1,Promise.resolve()):c.a.getNodeList(this.schedulePlan.id).then((function(n){e.each(n,(function(e){"erp"===e.source&&"0"===e.is_allow_report&&(e.erpNeedReport=!0)})),t.nodeListAll=n,t.filterData[0].data=n,t.filterData[1].data=e.filter(n,(function(e){return"1级"===e.level&&e.is_overtime&&!e.complete_time})),t.filterData[2].data=e.filter(n,(function(e){return"2级"===e.level&&e.is_overtime&&!e.complete_time})),t.filterData[3].data=e.filter(n,(function(e){return"1级"!==e.level&&"2级"!==e.level&&e.is_overtime&&!e.complete_time}))})).then((function(){return t.getNodeList()})).then((function(){t.isNodeLoading=!1}))},getNodeList:function(t){var n=this;t=void 0===t?this.filterType:t,this.nodeList=this.filterData[t].data,e.each(this.nodeList,(function(e,t){"finish"===e.node_status||"doing"===e.node_status?!t||"finish"!==n.nodeList[t-1].node_status&&"doing"!==n.nodeList[t-1].node_status?e.bar_status="":(e.bar_status="t","t"===n.nodeList[t-1].bar_status?n.nodeList[t-1].bar_status="a":n.nodeList[t-1].bar_status=1===t?"a":"b"):e.bar_status=""}))},selectSchedulePlan:function(e){var t=this;o.a.show?o.a.closePopup():o.a.openPopup({options:this.schedulePlanList,selected:[this.schedulePlan],stage:1,el:e.target,callback:function(e){t.schedulePlan=e[0],t.saveSchedulePlan(),t.getNodeData()}})},changeFilter:function(e){this.filterType=e,this.getNodeList(e)},dateFormat:function(e,t){return u()(e).format(t)},gotoDetail:function(e){this.$router.push({name:"SchedulePlanDetail",params:{id:e.id}})}}}}).call(this,n("391c"))},7136:function(e,t,n){"use strict";(function(e){n("5ab2"),n("6d57"),n("e10e");var i=n("28f8"),a=(n("cc57"),n("fd50")),o=n("1b7e"),r=n("e2a7"),s=n("3bd5"),l=n("3122"),c=n("c745"),d=n("6bf2"),u=n.n(d),p=n("9cd1");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={getSchedulePlanList:function(e){return c.a.hasRole(170).then((function(t){return t?o.a.getHasNetwork().then((function(e){if(!e)return Promise.reject({errmsg:"当前无网络连接"})})).then((function(){return Object(p.g)({proj_id:e})})):[]}))},setOverTime:function(e){var t=u()().startOf("day");if(e.is_overtime=!1,!e.deadline)return e.leftday="",void(e.overday="");var n=u()(e.deadline).startOf("day");if(e.complete_time){e.leftday="";var i,a,o=u()(e.complete_time).startOf("day");o.isAfter(n)?(i=o.diff(n,"days"),e.overday="超时"+i+"天",e.is_overtime=!0):n.isAfter(o)?(i=n.diff(o,"days"),e.overday="提前"+i+"天"):e.overday="按时完成"}else t.isAfter(n)?(e.leftday="",i=t.diff(n,"days"),e.overday="超时"+i+"天",e.is_overtime=!0):(e.overday="",a=n.diff(t,"days"),e.leftday=0===a?"今天":a<=7?"还剩"+a+"天":"")},getNodeList:function(t){return o.a.getHasNetwork().then((function(e){if(!e)return Promise.reject({errmsg:"当前无网络连接"})})).then((function(){return Object(p.f)({plan_id:t})})).then((function(t){var n=s.a.getUser();return e.each(t,(function(e){e.canReport=e.in_charge_by===n.user_id&&!e.complete_time&&"待汇报"===e.status})),t})).then((function(t){return e.each(t,(function(e,t){m.setOverTime(e),e.node_status="已完成"===e.status?"finish":"0"!==e.report_count?"doing":"pending"})),t}))},getScheduleView:function(t){return o.a.getHasNetwork().then((function(e){if(!e)return r.a.alert("当前无网络连接")})).then((function(){return Object(p.d)({detail_id:t})})).then((function(t){return t?(m.setOverTime(t),t.in_charge_by={is_im_user:t.is_im_user,id:t.in_charge_by,name:t.in_charge_by_name,mobile:t.mobile,headimg_url:t.headimg_url},e.each(t.report,(function(e){e.user={is_im_user:e.is_im_user,id:e.id,name:e.name,mobile:e.mobile,headimg_url:e.headimg_url},e.pictures=JSON.parse(e.pictures||"[]")})),t.reports=t.report,t):t}))},submitReport:function(t){var n=[];return e.isEmpty(t.remark)?a.a.reject({msg:"请填写补充说明"}):t.isComplete&&!t.complete_time?a.a.reject({msg:"请选择完成时间"}):o.a.getHasNetwork().then((function(e){if(!e)return r.a.alert("当前无网络连接")})).then((function(){return e.each(t.pictures,(function(e){!e.url&&e.temp?n.push(l.a.uploadImage(e.temp).then((function(t){e.url=t,delete e.temp}))):delete e.temp,!e.video_url&&e.videoTemp?n.push(l.a.uploadImage(e.videoTemp).then((function(t){e.video_url=t,delete e.videoTemp}))):delete e.videoTemp})),a.a.all(n).then((function(){var n=[];e.each(t.pictures,(function(e){var t=f(f({},e),{},{videoUrl:e.video_url||""});delete t.video_url,n.push(t)})),t.pictures=n}))})).then((function(){var e={detail_id:t.schedule_plan_detail_id,pictures:JSON.stringify(t.pictures),remark:t.remark,progress:t.progress};return t.isComplete&&t.complete_time&&(e.is_complete=1,e.complete_time=t.complete_time),Object(p.l)(e)})).catch((function(e){r.a.alert(e)}))},saveCompleteDate:function(e){return o.a.getHasNetwork().then((function(e){if(!e)return r.a.alert("当前无网络连接")})).then((function(){var t={detail_id:e.id,complete_time:e.complete_time};return Object(p.k)(t)}))},backPlan:function(t){var n=a.a.defer(),i=n.promise,o=[],s=$rootScope.$new();return s.closeModal=function(){s.modal.remove()},$ionicModal.fromTemplateUrl("templates/schedule-plan/back.html?v=20190624",{scope:s,animation:"slide-in-right"}).then((function(e){s.modal=e,s.modal.show()})),s.returnData={img:[],mark:""},s.setReturn=function(){if(s.returnData.mark)return e.each(s.returnData.img,(function(e){!e.url&&e.temp?o.push(l.a.uploadImage(e.temp).then((function(t){e.url=t,delete e.temp}))):delete e.temp,!e.video_url&&e.videoTemp?o.push(l.a.uploadImage(e.videoTemp).then((function(t){e.video_url=t,delete e.videoTemp}))):delete e.videoTemp})),a.a.all(o).then((function(){var t=[];e.each(s.returnData.img,(function(e){var n=f(f({},e),{},{videoUrl:e.video_url||""});delete n.video_url,t.push(n)})),s.returnData.img=t})).then((function(){s.closeModal(),m.reviewRequest(t,2,s.returnData).then((function(){n.resolve()})).catch((function(e){n.reject(e)}))}));r.a.alert("补充说明必填")},i},reviewRequest:function(e,t,n){var i={};return 1===parseInt(t)?(i.detail_id=e,i.is_review=t):(i.detail_id=e,i.is_review=t,i.pictures=n.img,i.remark=n.remark),Object(p.j)(i)},logList:function(e){return o.a.getHasNetwork().then((function(e){if(!e)return r.a.alert("当前无网络连接")})).then((function(){return Object(p.b)({detail_id:e})}))},viewLog:function(t){var n=$rootScope.$new();return n.closeModal=function(){n.modal.remove()},n.list=[],n.isLoading=!0,$ionicModal.fromTemplateUrl("templates/schedule-plan/log.html?v=20190624",{scope:n,animation:"slide-in-right"}).then((function(e){n.modal=e,n.modal.show()})),n.returnData={img:[],mark:""},n.setReturn=function(){n.returnData.mark?(m.reviewRequest(detail_id,!1,returnData),n.closeModal()):r.a.alert("补充说明必填")},m.logList(t).then((function(t){e.each(t,(function(e){e.checker={is_im_user:parseInt(e.is_im_user),id:e.id,name:e.name,mobile:parseInt(e.mobile),headimg_url:e.headimg_url},e.image_file=JSON.parse(e.image_file||"[]")})),n.list=t,n.isLoading=!1}))},schedulePlanNodeList:function(e){return Object(p.e)({plan_id:e})},getSettingWithCompleteTime:function(){return Object(p.c)()},getServerTime:function(){return l.a.getServerTime()}};t.a=m}).call(this,n("391c"))},"774b":function(e,t,n){"use strict";var i=n("d18d").a,a=(n("b225"),n("17cc")),o=Object(a.a)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"scroll-warp",staticClass:"scroll-warp",class:{"scroll-warp-pulling":e.pulling,"scroll-warp-complete":!e.hasNext&&!e.isEmpty,"scroll-warp-empty":e.isEmpty},style:{"padding-bottom":e.numberKeyboardCoverHeight+"px"},on:{scroll:e.onScroll,touchstart:e.onTouchstart,touchmove:e.onTouchmove,touchend:e.onTouchend}},[e.allowPullDown?n("div",{staticClass:"pull-refresh-warp",style:{height:e.pullDist+"px"}},[n("div",{staticClass:"pull-refresh"},[n("div",{staticClass:"animation-refresher",class:{refreshing:e.refreshing}}),e.updateTime?n("p",{staticClass:"pull-refresh-date"},[e._v("最后成功同步："+e._s(e.updateTime))]):e._e()])]):e._e(),e._t("default"),e.loading?n("div",{staticClass:"page-loading"},[n("svg",{staticClass:"svg-loading",attrs:{viewBox:"0 0 80 80"}},[n("circle",{attrs:{cx:"40",cy:"40",r:"36"}})])]):e._e(),e.hasNext||e.isEmpty?e._e():[e.$slots.end?e._t("end"):e._e(),!e.$slots.end&&e.endText?n("div",{staticClass:"end-text"},[e._v("\n      "+e._s(e.endText)+"\n    ")]):e._e()]],2)}),[],!1,null,"2b1a346c",null);t.a=o.exports},"9cd1":function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"m",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"l",(function(){return u})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"a",(function(){return b}));var i=n("5e8d"),a=n("162a"),o=n("bcc78");function r(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanTaskInfo.url;return a.a.request(t,e)}))}function s(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanSaveTask.url;return a.a.post(t,null,e)}))}function l(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanPlanList.url;return a.a.request(t,e)}))}function c(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanNodeList.url;return a.a.request(t,e)}))}function d(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanNodeInfo.url;return a.a.request(t,e)}))}function u(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanSaveReport.url;return a.a.post(t,null,e)}))}function p(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanSaveCompleteTime.url;return a.a.post(t,null,e)}))}function h(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanSaveChecker.url;return a.a.post(t,null,e)}))}function f(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanCheckerLogList.url;return a.a.request(t,e)}))}function m(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanNodeLevel.url;return a.a.request(t,e)}))}function g(){return Object(i.a)().then((function(){var e=o.a.schedulePlanCompletedTimeSetting.url;return a.a.request(e)}))}function v(){return Object(i.a)().then((function(){var e=o.a.schedulePlanLeaderSchedulePlan.url;return a.a.request(e)}))}function b(e){return Object(i.a)().then((function(){var t=o.a.schedulePlanGetByFirstProject.url;return a.a.request(t,e)}))}},"9d55":function(e,t,n){(e.exports=n("690e")(!1)).push([e.i,'.zjapp .scroll-warp[data-v-2b1a346c]{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}.zjapp .scroll-warp-pulling[data-v-2b1a346c]{overflow:hidden}.zjapp .scroll-warp-complete[data-v-2b1a346c]:after{content:"";display:block;height:100px}.zjapp .scroll-warp-empty[data-v-2b1a346c]{display:flex;flex-direction:column}.zjapp .pull-refresh-warp[data-v-2b1a346c]{position:relative;height:0;overflow:hidden}.zjapp .pull-refresh[data-v-2b1a346c]{position:absolute;left:0;bottom:0;height:70px;width:100%;padding:6px;text-align:center}.zjapp .pull-refresh-date[data-v-2b1a346c]{margin-top:4px;height:16px;line-height:16px;font-size:12px;color:#bcbcbc}.zjapp .page-loading[data-v-2b1a346c]{padding:10px;text-align:center}.zjapp .end-text[data-v-2b1a346c]{color:#c8c8c8;background:#f4f4f4;position:relative;line-height:76px;height:76px;text-align:center}.zjapp .end-text[data-v-2b1a346c]:after,.zjapp .end-text[data-v-2b1a346c]:before{content:"";position:absolute;width:48px;height:1px;background:#e4e4e4;top:50%;margin-top:-1px}.zjapp .end-text[data-v-2b1a346c]:after{left:50%;transform:translateX(-92px)}.zjapp .end-text[data-v-2b1a346c]:before{right:50%;transform:translateX(90px)}.zjapp .end-slot[data-v-2b1a346c]{padding:30px;line-height:18px;text-align:center;color:#c8c8c8}',""])},ad46:function(e,t,n){"use strict";(function(e){n("f548"),n("e697"),n("cc57"),n("9dd9");var i,a=n("07d2"),o=n("9eea"),r=n("6f9e"),s=n("e89f"),l=[],c=[],d=[],u=!0,p=null,h=["没有标段","没有楼栋","没有单元","没有楼层"],f=["","list bg-gray6","list bg-gray5","list bg-gray4"];t.a={name:"DropDownSelectDialog",components:{Item:a.a,appSearchBar:o.a},mixins:[s.a],data:function(){return{show:!1,showList:!1,isOpening:!1,isClosing:!1,isSearching:!1,contentTop:64,listHeight:510,target:"",selectedSet:[],stage:1,layoutMap:[],keepStage:[],componentUid:"",showNote:!0,hasSearch:!1,searchTimer:null,keyword:""}},watch:{show:function(e){var t=this;e&&this.$nextTick((function(){t.showList=!0}))},showList:function(t){var n=this;t&&this.$nextTick((function(){n.$refs["list-wrap"]&&e.each(n.$refs["list-wrap"].querySelectorAll(".selected")||[],(function(e){setTimeout((function(){e.scrollIntoViewIfNeeded(!0)}),400)}))}))},keyword:function(e){var t=this;clearTimeout(this.searchTimer),this.searchTimer=setTimeout((function(){t.initSelectedSet(l,c)}),100)}},created:function(){r.a.$on("routerBeforeEach",this.closePopup),r.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){r.a.$off("routerBeforeEach",this.closePopup),r.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(t){var n=this;if(this.show)return t.componentUid===this.componentUid?void this.closePopup():void this.closePopup().then((function(){n.openPopup(t)}));this.stage=t.stage,this.componentUid=t.componentUid||"";var a=document.querySelector(".layout-main .layout-header");this.contentTop=a.offsetHeight;var o=t.el&&t.el.$el?t.el.$el:t.el;if(o){var r=o.getBoundingClientRect();this.contentTop=r.bottom}this.target=o,this.listHeight=e.minBy([window.innerHeight-this.contentTop-50,510]),l=t.options,c=e.clone(t.selected),d=t.optionsMap||[],u=!1!==t.needFullSelecte||t.needFullSelecte,p=t.minSelectStage||this.stage,i=t.callback,this.showNote=t.showNote,this.layoutMap=[];for(var s=0;s<t.stage;s++)this.layoutMap.push({level:s,bgColor:t.hasBgColor?f[s]:"",emptyText:t.emptyText&&t.emptyText[s]?t.emptyText[s]:h[s],keep:!!e.isEmpty(t.keepStage)||!!t.keepStage[s]});this.hasSearch=!!t.hasSearch,this.initSelectedSet(t.options,t.selected),this.show=!0,this.$emit("open")},closePopup:function(){var e=this;if(!this.isOpening)return this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch(),this.showList=!1,this.$emit("close"),new Promise((function(t){e.$on("afterClosePopup",t)}))},afterClose:function(){this.show=!1,this.keyword="",this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(e){e&&e.target&&e.target!==this.target&&this.show&&this.closePopup()},getLevelOptionsKey:function(e){return d&&d[e]&&d[e].key?d[e].key:"children"},initSelectedSet:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.selectedSet=[],e.each(i||[],(function(i,a){var o=t.getLevelOptionsKey(a);if(i&&!(a>t.stage-1)){if(!t.selectedSet[a]){var r;r=a?t.selectedSet[a-1].selected&&t.selectedSet[a-1].selected[o]||[]:n;var s=a||e.isEmpty(t.keyword)?r:e.filter(r,(function(e){return new RegExp(t.keyword,"gm").test(e.name)}));t.selectedSet[a]={selected:{},options:s}}var l=t.selectedSet[a].options,c=e.find(l,{id:i.id});c&&(t.selectedSet[a].selected=c)}})),e.isEmpty(this.selectedSet)&&(this.selectedSet=[{selected:{},options:n}])},showName:function(e){var t=e;return t=(t=t.replace(new RegExp("<","gm"),"&lt;")).replace(new RegExp(">","gm"),"&gt;")},highLightKeyword:function(e){if(this.keyword){var t="";return t=e.replace(new RegExp(this.keyword,"gm"),"-----hightLightTagL-----"+this.keyword+"-----hightLightTagR-----"),t=(t=(t=this.showName(t)).replace(/-----hightLightTagL-----/gm,'<span class="color-blue">')).replace(/-----hightLightTagR-----/gm,"</span>")}return this.showName(e)},getResult:function(){var t=this,n=[];return e.each(this.selectedSet,(function(i,a){var o=e.extend({},i.selected);delete o[t.getLevelOptionsKey(a+1)],e.isEmpty(o)||n.push(o)})),n},select:function(t,n){var a=this,o=this.getLevelOptionsKey(n+1),r=e.isEmpty(t[o]),s=n>=this.stage-1||n>=p-1&&r||!u&&r;this.selectedSet.splice(n+1),this.selectedSet[n].selected=t,c.splice(n),c.push(t),this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].saveHistory(),s?setTimeout((function(){i&&i(a.getResult()),a.closePopup()}),100):this.selectedSet.push({selected:{},options:t[o]})},onSearchTypeChange:function(e){this.isSearching=e}}}}).call(this,n("391c"))},b225:function(e,t,n){"use strict";n("ef48")},cc4c:function(e,t,n){(e.exports=n("690e")(!1)).push([e.i,".zjapp .content[data-v-1fa2658d]{position:fixed;width:100%;bottom:0;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-1fa2658d]{flex-direction:column}.zjapp .box[data-v-1fa2658d],.zjapp .list-wrap[data-v-1fa2658d]{display:flex;background-color:#fff}.zjapp .list-wrap[data-v-1fa2658d]{flex-direction:row;align-items:flex-start;flex:1;overflow:hidden}.zjapp .list[data-v-1fa2658d]{padding:0 10px}.zjapp .list[data-v-1fa2658d],.zjapp .list-single[data-v-1fa2658d]{flex:1;overflow:auto;height:100%;scroll-behavior:smooth}.zjapp .item-dropdown[data-v-1fa2658d]{padding:6px 0;background-color:transparent}.zjapp .item-dropdown[data-v-1fa2658d] .item-text{font-size:14px}.zjapp .item-dropdown.selected[data-v-1fa2658d]{color:#4275e8;padding-bottom:5px;border-bottom:1px solid #4275e8}.zjapp .item-dropdown.selected[data-v-1fa2658d] .item-text{color:#4275e8}.zjapp .empty-tips[data-v-1fa2658d]{padding:13px 0;line-height:20px;color:#b2b2b2;font-size:14px}.zjapp .select-note[data-v-1fa2658d]{line-height:16px;font-size:12px;color:#8c8c8c}[data-v-1fa2658d] .icon-qualified{width:30px;height:30px;line-height:30px;text-align:center;color:#4275e8}",""])},d152:function(e,t,n){"use strict";var i=n("329b"),a=n("ad46").a,o=(n("fc72"),n("17cc")),r=Object(o.a)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("div",{staticClass:"content",style:{top:e.contentTop+"px"},on:{click:function(t){return t.target!==t.currentTarget?null:e.closePopup(t)}}},[n("transition",{attrs:{name:"slide-down"},on:{enter:function(t){e.isOpening=!0},"after-enter":function(t){e.isOpening=!1},leave:function(t){e.isClosing=!0},"after-leave":e.afterClose}},[e.showList?n("div",{staticClass:"box",style:{height:e.listHeight+"px"}},[e.hasSearch?n("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"输入项目名称搜索","simple-mode":"","history-key":"drop-down-search-history-key"},on:{changeSearchStatus:e.onSearchTypeChange},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}):e._e(),!e.isSearching||e.keyword&&e.selectedSet[0]&&e.selectedSet[0].options.length?n("div",{ref:"list-wrap",staticClass:"list-wrap"},[1===e.stage?e._l(e.layoutMap,(function(t,i){var a;return n("div",{key:"map"+i,staticClass:"list-single",class:(a={},a[t.bgColor]=!0,a),style:{height:e.listHeight-(e.hasSearch?44:0)+"px"}},e._l(e.selectedSet[t.level]&&e.selectedSet[t.level].options||[],(function(a,o){return n("item",{key:o,class:{selected:e.selectedSet[t.level].selected&&e.selectedSet[t.level].selected.id===a.id},attrs:{border:"bottom"},on:{click:function(n){e.select(a,t.level)}}},[n("div",{staticClass:"item-text",class:{"color-theme":a.note&&e.selectedSet[t.level].selected&&e.selectedSet[t.level].selected.id===a.id},domProps:{innerHTML:e._s(i?e.showName(a.nameShow||a.name):e.highLightKeyword(a.nameShow||a.name))}}),!a.note&&e.selectedSet[t.level].selected&&e.selectedSet[t.level].selected.id===a.id?n("icon",{attrs:{name:"qualified"}}):e._e(),a.note?n("div",{staticClass:"item-font color-gray2 f14"},[e._v(e._s(a.note))]):e._e()],1)})))})):[e._l(e.layoutMap,(function(t,i){var a;return[t.keep||e.selectedSet[t.level]&&e.selectedSet[t.level].options&&e.selectedSet[t.level].options.length?n("div",{key:"map"+i,staticClass:"list",class:(a={},a[t.bgColor]=!0,a),style:{height:e.listHeight-(e.hasSearch?44:0)+"px"}},[e._l(e.selectedSet[t.level]&&e.selectedSet[t.level].options||[],(function(a,o){return n("item",{key:o,staticClass:"item-dropdown",class:{selected:e.selectedSet[t.level].selected&&e.selectedSet[t.level].selected.id===a.id},on:{click:function(n){e.select(a,t.level)}}},[n("div",{staticClass:"item-text"},[n("p",{domProps:{innerHTML:e._s(i?e.showName(a.nameShow||a.name):e.highLightKeyword(a.nameShow||a.name))}}),n("p",{staticClass:"select-note"},[e._v(e._s(a.note))])])])})),e.selectedSet[t.level]&&e.selectedSet[t.level].options&&e.selectedSet[t.level].options.length?e._e():n("div",{staticClass:"empty-tips"},[e._v("\n                "+e._s(e.selectedSet[t.level-1]&&e.selectedSet[t.level-1].selected&&e.selectedSet[t.level-1].selected.id?t.emptyText:"请选择")+"\n              ")])],2):e._e()]}))]],2):e._e(),!e.isSearching||!e.keyword||e.selectedSet[0]&&e.selectedSet[0].options.length?e._e():n("loading-status",{attrs:{"is-empty":!0,type:"search","empty-text":"未搜索到相关内容"}})],1):e._e()])],1):e._e()}),[],!1,null,"1fa2658d",null).exports,s=!1;s||(s=new(i.default.extend(r))({el:document.createElement("div")}),document.body.appendChild(s.$el));t.a=s},d18d:function(e,t,n){"use strict";(function(e){n("2b45");var i,a=n("4360"),o=n("48f4"),r=n("162a"),s=n("e2a7"),l=n("a500"),c=n("6f9e"),d={};t.a={name:"Scroller",props:{buildingId:{type:String,default:""},hasNext:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},isSync:{type:Boolean,default:!0},endText:{type:String,default:""},memoryScrollTop:{type:Boolean,default:!0},keepScrollTop:{type:Boolean},hasPullDown:{type:Boolean,default:!0},onPullDown:{type:Function}},data:function(){return{pullDist:0,refreshing:!1,pulling:!1,loading:!1,scrollTop:0,isCurrKeyboard:!1,gapBottom:0}},computed:{allowPullDown:function(){return this.hasPullDown&&(!!this.$listeners.pullDown||!!this.onPullDown)},updateTime:function(){return a.a.state.global.businessDownloadTime},numberKeyboardCoverHeight:function(){return a.a.state.global.isNumberInputOpen?a.a.state.global.numberKeyboardHeight-this.gapBottom:0}},mounted:function(){var e=this;c.a.$on("numberKeyboardOpen",this.onNumberKeyboardOpen),this.$nextTick((function(){var t=e.$refs["scroll-warp"]&&e.$refs["scroll-warp"].getBoundingClientRect&&e.$refs["scroll-warp"].getBoundingClientRect();t&&(e.gapBottom=document.documentElement.clientHeight-t.bottom),e.$el&&e.$el.addEventListener("focus",(function(t){var n=t&&t.target,i=n&&n.tagName&&n.tagName.toLowerCase();if("input"===i||"textarea"===i){window.addEventListener("resize",(function t(){var i=n.getBoundingClientRect(),a=e.$el.getBoundingClientRect(),o=i.bottom-a.bottom;o>0&&e.scrollBy(o),window.removeEventListener("resize",t,!1)}),!1)}}),!0)}))},destroyed:function(){c.a.$off("numberKeyboardOpen",this.onNumberKeyboardOpen)},activated:function(){var e=this.keepScrollTop||this.$router.isBack&&this.memoryScrollTop;this.scrollTop&&e&&(this.$refs["scroll-warp"].scrollTop=this.scrollTop)},deactivated:function(){this.memoryScrollTop&&(this.scrollTop=this.$refs["scroll-warp"].scrollTop)},methods:{onScroll:function(e){var t=this,n=this.$refs["scroll-warp"].scrollTop,i=this.$refs["scroll-warp"].scrollHeight;if(n+this.$refs["scroll-warp"].clientHeight>=i-5&&!this.loading&&this.hasNext){this.loading=!0;var a=this.$listeners.loadNext();a&&a.then&&"function"==typeof a.then?a.then((function(){t.loading=!1})):this.loading=!1}this.$emit("scroll",e)},getTouchDiretion:function(e){if(!(d&&e&&e.touches&&e.touches[0]))return"";var t=e.touches[0].clientX,n=e.touches[0].clientY;return Math.abs(n-d.y)>Math.abs(t-d.x)&&Math.abs(n-d.y)>=3?n>d.y?"down":"up":""},onTouchstart:function(e){this.allowPullDown&&e.touches&&1===e.touches.length&&(d={x:e.touches[0].clientX,y:e.touches[0].clientY,scrollTop:this.$refs["scroll-warp"].scrollTop,pullDist:this.pullDist})},onTouchmove:function(e){if(this.allowPullDown&&e.touches&&1===e.touches.length){var t=this.$refs["scroll-warp"].scrollTop,n=e.touches[0].clientY,i=n-d.y,a=this.getTouchDiretion(e);"down"===a?!this.refreshing&&t<=0?(this.pulling=!0,this.pullDist=(i-d.scrollTop)/2,e.preventDefault()):this.pulling=!1:"up"===a?this.pullDist>0&&(this.pullDist=d.pullDist-(d.y-n),e.preventDefault()):this.pullDist=d.pullDist}},onTouchend:function(){var e=this;this.allowPullDown&&(d={},this.pulling=!1,this.pullDist>=70&&this.isSync?this.refreshing?this.makePullTo(70):this.makePullTo(70).then((function(){if(e.refreshing=!0,e.onPullDown){var t=e.onPullDown();t&&t.then&&"function"==typeof t?t.finally((function(){e.refreshing=!1,e.makePullTo(0)})):(e.refreshing=!1,e.makePullTo(0))}else e.dataSync().then((function(){e.refreshing=!1,e.makePullTo(0),e.$emit("pullDown")})).catch((function(){e.refreshing=!1,e.makePullTo(0),e.$emit("pullDown")}))})):(this.refreshing=!1,this.makePullTo(0)))},makePullTo:function(e){var t=this,n=this.pullDist,i=e,a=i-n,o=n;return n===i?Promise.resolve():new Promise((function(e){!function r(){window.requestAnimationFrame((function(){o+=a/6,t.pullDist=o,n<i&&o<i||n>i&&o>i?r():(t.pullDist=i,t.refreshing=!1,e())}))}()}))},dataSync:function(){var e,t=o.default.getCurrentModuleCode(),n=o.default.getCurrentRoute(),i=n.meta&&n.meta.isTodo;if(o.default.isModuleNeedBuilding(t)&&!i){if(!this.buildingId)return new Promise((function(e){setTimeout((function(){e()}),500)}));e=this.buildingId}return l.a.addTrack("公共-手动下拉刷新","",""),r.a.beginManualUpdate(),o.default.checkSync(e).then((function(e){return r.a.endManualUpdate(),e})).catch((function(e){$log.error("下拉刷新错误",e),e&&"Error: Network Error"===e.toString()?s.a.alert("当前网络无法同步数据"):s.a.alert(e),r.a.endManualUpdate()}))},getScrollHeight:function(){return this.$refs["scroll-warp"].offsetHeight},getScrollTop:function(){return this.$refs["scroll-warp"].scrollTop},setScrollTop:function(e){this.$refs["scroll-warp"].scrollTop=e},scrollBy:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,a=this.getScrollTop(),o=a+e,r=Math.round(n/16.7),s=e/r,l=a,c=i=+new Date;return a===o?Promise.resolve():new Promise((function(e){!function n(){window.requestAnimationFrame((function(){c===i&&(l+=s,t.$refs["scroll-warp"].scrollTop=l,a<o&&l<o||a>o&&l>o?n():(t.$refs["scroll-warp"].scrollTop=o,e()))}))}()}))},scrollTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=this.getScrollTop(),i=e-n;return this.scrollBy(i,t)},scrollToEle:function(e){var t=e.keyboardHeight||232,n=(e=e.$el?e.$el:e).getBoundingClientRect(),i=this.$refs["scroll-warp"].getBoundingClientRect();if(n&&i){var o=document.documentElement.clientHeight-(a.a.state.global.isNumberInputOpen?t:0),r=i.bottom<o?i.bottom:o,s=i.top-n.top,l=n.bottom-r;s>0?this.scrollBy(-s-10):l>0&&this.scrollBy(l+10)}},isCurrent:function(t,n){var i=this;t.length&&e.each(t,(function(e){e._uid===n?i.isCurrKeyboard=!0:i.isCurrent(e.$children,n)}))},onNumberKeyboardOpen:function(e){this.isCurrKeyboard=!1,this.isCurrent(this.$children,e._uid),this.isCurrKeyboard&&this.scrollToEle(e)}}}}).call(this,n("391c"))},e89f:function(e,t,n){"use strict";var i=n("04f3"),a=n("cf09"),o=n("4360"),r=0;t.a={name:"PopupMixin",data:function(){return{backButtonEvent:null}},watch:{show:function(e){var t=this;if(e){if(this.$nextTick((function(){t.$el&&t.$el.style&&(t.$el.style.zIndex=++a.a.zIndex,r++,o.a.commit("app/SET_HAS_POPUP",!!r))})),!this.backButtonEvent){var n=this.close||this.closePopup;this.backButtonEvent=Object(i.a)(n)}}else--r<0&&(r=0),o.a.commit("app/SET_HAS_POPUP",!!r),this.backButtonEvent&&(Object(i.c)(this.backButtonEvent),this.backButtonEvent=null)}},methods:{}}},ef48:function(e,t,n){var i=n("9d55");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n("85cb").default)("a1a65c0c",i,!0,{sourceMap:!1,shadowMode:!1})},fc72:function(e,t,n){"use strict";n("47df")}}]);