(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-4c88beda"],{"774b":function(t,e,o){"use strict";var n=o("d18d").a,r=(o("b225"),o("17cc")),l=Object(r.a)(n,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"scroll-warp",staticClass:"scroll-warp",class:{"scroll-warp-pulling":t.pulling,"scroll-warp-complete":!t.hasNext&&!t.isEmpty,"scroll-warp-empty":t.isEmpty},style:{"padding-bottom":t.numberKeyboardCoverHeight+"px"},on:{scroll:t.onScroll,touchstart:t.onTouchstart,touchmove:t.onTouchmove,touchend:t.onTouchend}},[t.allowPullDown?o("div",{staticClass:"pull-refresh-warp",style:{height:t.pullDist+"px"}},[o("div",{staticClass:"pull-refresh"},[o("div",{staticClass:"animation-refresher",class:{refreshing:t.refreshing}}),t.updateTime?o("p",{staticClass:"pull-refresh-date"},[t._v("最后成功同步："+t._s(t.updateTime))]):t._e()])]):t._e(),t._t("default"),t.loading?o("div",{staticClass:"page-loading"},[o("svg",{staticClass:"svg-loading",attrs:{viewBox:"0 0 80 80"}},[o("circle",{attrs:{cx:"40",cy:"40",r:"36"}})])]):t._e(),t.hasNext||t.isEmpty?t._e():[t.$slots.end?t._t("end"):t._e(),!t.$slots.end&&t.endText?o("div",{staticClass:"end-text"},[t._v("\n      "+t._s(t.endText)+"\n    ")]):t._e()]],2)}),[],!1,null,"2b1a346c",null);e.a=l.exports},7939:function(t,e,o){"use strict";o("dd81")},"9d55":function(t,e,o){(t.exports=o("690e")(!1)).push([t.i,'.zjapp .scroll-warp[data-v-2b1a346c]{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}.zjapp .scroll-warp-pulling[data-v-2b1a346c]{overflow:hidden}.zjapp .scroll-warp-complete[data-v-2b1a346c]:after{content:"";display:block;height:100px}.zjapp .scroll-warp-empty[data-v-2b1a346c]{display:flex;flex-direction:column}.zjapp .pull-refresh-warp[data-v-2b1a346c]{position:relative;height:0;overflow:hidden}.zjapp .pull-refresh[data-v-2b1a346c]{position:absolute;left:0;bottom:0;height:70px;width:100%;padding:6px;text-align:center}.zjapp .pull-refresh-date[data-v-2b1a346c]{margin-top:4px;height:16px;line-height:16px;font-size:12px;color:#bcbcbc}.zjapp .page-loading[data-v-2b1a346c]{padding:10px;text-align:center}.zjapp .end-text[data-v-2b1a346c]{color:#c8c8c8;background:#f4f4f4;position:relative;line-height:76px;height:76px;text-align:center}.zjapp .end-text[data-v-2b1a346c]:after,.zjapp .end-text[data-v-2b1a346c]:before{content:"";position:absolute;width:48px;height:1px;background:#e4e4e4;top:50%;margin-top:-1px}.zjapp .end-text[data-v-2b1a346c]:after{left:50%;transform:translateX(-92px)}.zjapp .end-text[data-v-2b1a346c]:before{right:50%;transform:translateX(90px)}.zjapp .end-slot[data-v-2b1a346c]{padding:30px;line-height:18px;text-align:center;color:#c8c8c8}',""])},b225:function(t,e,o){"use strict";o("ef48")},cd4c:function(t,e,o){"use strict";o.r(e);o("309f"),o("0b53"),o("06a2"),o("ec25"),o("cc57"),o("2b45"),o("5ab2"),o("6d57"),o("e10e");var n=o("28f8"),r=o("4c09"),l=(o("c904"),o("fc08")),i=o("774b"),a=o("162a"),s=o("1b7e");function c(t,e){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return u(t,e)}(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return i=t.done,t},e:function(t){a=!0,l=t},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw l}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function p(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function h(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?p(Object(o),!0).forEach((function(e){Object(n.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):p(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var f={components:{Scroller:i.a},data:function(){return{isLoading:!1,list:[]}},activated:function(){this.getData(),this.hasNetWork()},methods:{hasNetWork:function(){var t=this;return s.a.getHasNetwork().then((function(e){e&&t.updateLocaoFollowProject()}))},getData:function(){var t=this;return l.a.getData().then((function(e){t.list=Object(r.a)(e.list).sort((function(t,e){return t[1].sort_by>e[1].sort_by?.5:-.5})).map((function(t){return h(h({},t[1]),{},{isFollow:!0})}))}))},updateLocaoFollowProject:function(){var t=this;this.isLoading=!0,this.getAllProjectObject().then((function(t){return l.a.filterFollow(t)})).then((function(e){return t.getData()})).catch((function(t){$log.log("update follow’s project error:",t)})),this.isLoading=!1},follow:function(t,e){t.stopPropagation();var o=!e.isFollow;o?l.a.add(e).then((function(t){return e.isFollow=o})):l.a.remove(e.id).then((function(t){return e.isFollow=o}))},toDetail:function(t){var e=1===t.is_end?"/project-map-end-detail":"/project-map-detail";this.$router.push({path:e,query:{proj_id:t.id,timestmap:(new Date).getTime()}})},getAllProjectObject:function(){var t=this;return a.a.request("/project-map/org-tree",{origin:"homepage"}).then((function(e){return t.getProjectList(e)}))},getProjectList:function(t){var e=[];return function t(o){var n,r=c(o);try{for(r.s();!(n=r.n()).done;){var l=n.value;l.children&&l.children.length?t(l.children):e.push(l)}}catch(t){r.e(t)}finally{r.f()}}(t),e}}},d=(o("7939"),o("17cc")),g=Object(d.a)(f,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("page-content",{attrs:{title:"我的关注"}},[t.list.length?o("scroller",t._l(t.list,(function(e){return o("van-cell",{key:e.id,attrs:{title:e.name},on:{click:function(o){t.toDetail(e)}}},[[e.isFollow?o("van-button",{attrs:{plain:"",type:"info",color:"#999",round:"",size:"mini"},on:{click:function(o){t.follow(o,e)}}},[t._v("取消关注")]):o("van-button",{attrs:{plain:"",type:"info",round:"",size:"mini"},on:{click:function(o){t.follow(o,e)}}},[t._v("关注")])]],2)}))):t._e(),o("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.list.length,"empty-text":"没有任何关注~"}})],1)}),[],!1,null,"1974cf2a",null);e.default=g.exports},d18d:function(t,e,o){"use strict";(function(t){o("2b45");var n,r=o("4360"),l=o("48f4"),i=o("162a"),a=o("e2a7"),s=o("a500"),c=o("6f9e"),u={};e.a={name:"Scroller",props:{buildingId:{type:String,default:""},hasNext:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},isSync:{type:Boolean,default:!0},endText:{type:String,default:""},memoryScrollTop:{type:Boolean,default:!0},keepScrollTop:{type:Boolean},hasPullDown:{type:Boolean,default:!0},onPullDown:{type:Function}},data:function(){return{pullDist:0,refreshing:!1,pulling:!1,loading:!1,scrollTop:0,isCurrKeyboard:!1,gapBottom:0}},computed:{allowPullDown:function(){return this.hasPullDown&&(!!this.$listeners.pullDown||!!this.onPullDown)},updateTime:function(){return r.a.state.global.businessDownloadTime},numberKeyboardCoverHeight:function(){return r.a.state.global.isNumberInputOpen?r.a.state.global.numberKeyboardHeight-this.gapBottom:0}},mounted:function(){var t=this;c.a.$on("numberKeyboardOpen",this.onNumberKeyboardOpen),this.$nextTick((function(){var e=t.$refs["scroll-warp"]&&t.$refs["scroll-warp"].getBoundingClientRect&&t.$refs["scroll-warp"].getBoundingClientRect();e&&(t.gapBottom=document.documentElement.clientHeight-e.bottom),t.$el&&t.$el.addEventListener("focus",(function(e){var o=e&&e.target,n=o&&o.tagName&&o.tagName.toLowerCase();if("input"===n||"textarea"===n){window.addEventListener("resize",(function e(){var n=o.getBoundingClientRect(),r=t.$el.getBoundingClientRect(),l=n.bottom-r.bottom;l>0&&t.scrollBy(l),window.removeEventListener("resize",e,!1)}),!1)}}),!0)}))},destroyed:function(){c.a.$off("numberKeyboardOpen",this.onNumberKeyboardOpen)},activated:function(){var t=this.keepScrollTop||this.$router.isBack&&this.memoryScrollTop;this.scrollTop&&t&&(this.$refs["scroll-warp"].scrollTop=this.scrollTop)},deactivated:function(){this.memoryScrollTop&&(this.scrollTop=this.$refs["scroll-warp"].scrollTop)},methods:{onScroll:function(t){var e=this,o=this.$refs["scroll-warp"].scrollTop,n=this.$refs["scroll-warp"].scrollHeight;if(o+this.$refs["scroll-warp"].clientHeight>=n-5&&!this.loading&&this.hasNext){this.loading=!0;var r=this.$listeners.loadNext();r&&r.then&&"function"==typeof r.then?r.then((function(){e.loading=!1})):this.loading=!1}this.$emit("scroll",t)},getTouchDiretion:function(t){if(!(u&&t&&t.touches&&t.touches[0]))return"";var e=t.touches[0].clientX,o=t.touches[0].clientY;return Math.abs(o-u.y)>Math.abs(e-u.x)&&Math.abs(o-u.y)>=3?o>u.y?"down":"up":""},onTouchstart:function(t){this.allowPullDown&&t.touches&&1===t.touches.length&&(u={x:t.touches[0].clientX,y:t.touches[0].clientY,scrollTop:this.$refs["scroll-warp"].scrollTop,pullDist:this.pullDist})},onTouchmove:function(t){if(this.allowPullDown&&t.touches&&1===t.touches.length){var e=this.$refs["scroll-warp"].scrollTop,o=t.touches[0].clientY,n=o-u.y,r=this.getTouchDiretion(t);"down"===r?!this.refreshing&&e<=0?(this.pulling=!0,this.pullDist=(n-u.scrollTop)/2,t.preventDefault()):this.pulling=!1:"up"===r?this.pullDist>0&&(this.pullDist=u.pullDist-(u.y-o),t.preventDefault()):this.pullDist=u.pullDist}},onTouchend:function(){var t=this;this.allowPullDown&&(u={},this.pulling=!1,this.pullDist>=70&&this.isSync?this.refreshing?this.makePullTo(70):this.makePullTo(70).then((function(){if(t.refreshing=!0,t.onPullDown){var e=t.onPullDown();e&&e.then&&"function"==typeof e?e.finally((function(){t.refreshing=!1,t.makePullTo(0)})):(t.refreshing=!1,t.makePullTo(0))}else t.dataSync().then((function(){t.refreshing=!1,t.makePullTo(0),t.$emit("pullDown")})).catch((function(){t.refreshing=!1,t.makePullTo(0),t.$emit("pullDown")}))})):(this.refreshing=!1,this.makePullTo(0)))},makePullTo:function(t){var e=this,o=this.pullDist,n=t,r=n-o,l=o;return o===n?Promise.resolve():new Promise((function(t){!function i(){window.requestAnimationFrame((function(){l+=r/6,e.pullDist=l,o<n&&l<n||o>n&&l>n?i():(e.pullDist=n,e.refreshing=!1,t())}))}()}))},dataSync:function(){var t,e=l.default.getCurrentModuleCode(),o=l.default.getCurrentRoute(),n=o.meta&&o.meta.isTodo;if(l.default.isModuleNeedBuilding(e)&&!n){if(!this.buildingId)return new Promise((function(t){setTimeout((function(){t()}),500)}));t=this.buildingId}return s.a.addTrack("公共-手动下拉刷新","",""),i.a.beginManualUpdate(),l.default.checkSync(t).then((function(t){return i.a.endManualUpdate(),t})).catch((function(t){$log.error("下拉刷新错误",t),t&&"Error: Network Error"===t.toString()?a.a.alert("当前网络无法同步数据"):a.a.alert(t),i.a.endManualUpdate()}))},getScrollHeight:function(){return this.$refs["scroll-warp"].offsetHeight},getScrollTop:function(){return this.$refs["scroll-warp"].scrollTop},setScrollTop:function(t){this.$refs["scroll-warp"].scrollTop=t},scrollBy:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=this.getScrollTop(),l=r+t,i=Math.round(o/16.7),a=t/i,s=r,c=n=+new Date;return r===l?Promise.resolve():new Promise((function(t){!function o(){window.requestAnimationFrame((function(){c===n&&(s+=a,e.$refs["scroll-warp"].scrollTop=s,r<l&&s<l||r>l&&s>l?o():(e.$refs["scroll-warp"].scrollTop=l,t()))}))}()}))},scrollTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=this.getScrollTop(),n=t-o;return this.scrollBy(n,e)},scrollToEle:function(t){var e=t.keyboardHeight||232,o=(t=t.$el?t.$el:t).getBoundingClientRect(),n=this.$refs["scroll-warp"].getBoundingClientRect();if(o&&n){var l=document.documentElement.clientHeight-(r.a.state.global.isNumberInputOpen?e:0),i=n.bottom<l?n.bottom:l,a=n.top-o.top,s=o.bottom-i;a>0?this.scrollBy(-a-10):s>0&&this.scrollBy(s+10)}},isCurrent:function(e,o){var n=this;e.length&&t.each(e,(function(t){t._uid===o?n.isCurrKeyboard=!0:n.isCurrent(t.$children,o)}))},onNumberKeyboardOpen:function(t){this.isCurrKeyboard=!1,this.isCurrent(this.$children,t._uid),this.isCurrKeyboard&&this.scrollToEle(t)}}}}).call(this,o("391c"))},d6b8:function(t,e,o){(t.exports=o("690e")(!1)).push([t.i,"[data-v-1974cf2a] .van-cell{font-size:14px}[data-v-1974cf2a] .van-cell .van-cell__title{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[data-v-1974cf2a] .van-cell .van-cell__value{max-width:76px}[data-v-1974cf2a] .van-cell .van-button--round{width:68px;height:24px;line-height:24px}",""])},dd81:function(t,e,o){var n=o("d6b8");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,o("85cb").default)("a3229a86",n,!0,{sourceMap:!1,shadowMode:!1})},ef48:function(t,e,o){var n=o("9d55");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,o("85cb").default)("a1a65c0c",n,!0,{sourceMap:!1,shadowMode:!1})}}]);