(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-683362f4"],{"00be":function(t,e,i){var a=i("d6e0");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("35cb8b6d",a,!0,{sourceMap:!1,shadowMode:!1})},"04da":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .comment-list .cl-total[data-v-636dc866]{padding:0 15px;line-height:46px;color:#999;font-size:16px;border-bottom:1px solid #ececec;background:#fff}.zjapp .comment-list .cl-list[data-v-636dc866]{padding:0 15px;background:#fff}.zjapp .comment-list .cl-item[data-v-636dc866]{display:flex;padding:15px 0 0;position:relative}.zjapp .comment-list .cl-img[data-v-636dc866]{width:32px;height:32px;border-radius:50%;margin-right:10px}.zjapp .comment-list .cl-flex[data-v-636dc866]{width:calc(100% - 40px);flex:1;padding-bottom:15px;border-bottom:1px solid #ececec}.zjapp .comment-list .cl-name[data-v-636dc866]{line-height:22px;color:#6b7ba9;font-size:16px;vertical-align:top;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.zjapp .comment-list .cl-content[data-v-636dc866]{color:#333;font-size:16px;margin-bottom:8px}.zjapp .comment-list .cl-date[data-v-636dc866]{line-height:20px;color:#999;font-size:14px}.zjapp .comment-list .cl-delete[data-v-636dc866]{position:absolute;bottom:15px;right:0;color:#666;font-size:14px}.zjapp .comment-list .comment-list-loading[data-v-636dc866]{min-height:230px}",""])},"0a36":function(t,e,i){var a=i("c4ef");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("7b73790c",a,!0,{sourceMap:!1,shadowMode:!1})},"0c5f":function(t,e,i){"use strict";(function(t){i("2b45"),i("e697"),i("cc57"),i("163d");var a=i("abb5"),o=i("3148"),n=i("6144"),s=i("e2a7"),r=i("a18c"),l=i("2470"),c=i("a95f4"),d=i("7ef3"),p=i("4d47"),u=i("7e8b");e.a={name:"UserSelect",components:{DoneIcon:l.a,AddIcon:c.a,CloseIcon:d.a,WaitingIcon:p.a,ApproveItem:o.a},props:{title:{type:String},time:{type:String},user:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},multi:{type:Boolean,default:!1},date:{type:String,default:""},isLast:{type:Boolean,default:!1},modifyDate:{type:String,default:""},isRead:{type:[String,Boolean],default:""},note:{type:String,default:""},status:{type:Number},stepType:{type:Number},statusClass:{type:[Object,String]},max:{type:Number,default:1/0},maxTip:{type:String,default:""},border:{type:String,default:""},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},required:{type:Boolean,default:!0},emptyText:{type:String,default:"空"},beforeOpen:{type:Function,default:function(){}},beforeSelect:{type:Function,default:function(){}},beforeConfirm:{type:Function,default:function(){}},formCheck:{type:Boolean,default:!1},linkedData:{type:Object,default:function(){return{}}}},data:function(){return{isOpen:!1,STATUS:u.b,STATUS_WORDING:u.c,memoryKey:(this.$route?this.$route.name:r.a.history.current.name)+encodeURI(this.title||"选人组件")}},computed:{selected:function(){return console.log("this.user",this.user),this.user}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var e=this;if(this.editabled){var i=this.beforeOpen(this.linkedData);i&&i.then&&t.isFunction(i.then)?i.then((function(t){!1!==t&&e.openPopup()})).catch((function(t){$log.error(t),s.a.alert(t||"发生了错误")})):!1!==i&&this.openPopup()}},openPopup:function(){var e=this;a.a.openPopup({title:"选择"+(this.title||""),selected:this.selected,options:this.options,multi:this.multi,max:this.max,maxTip:this.maxTip,beforeSelect:this.beforeSelect,beforeConfirm:this.beforeConfirm,onSelect:function(i){var a=t.cloneDeep(e.selected);e.multi?(e.$emit("input",i,a),e.$emit("onSelect",i,a)):(e.$emit("input",i[0],a),e.$emit("onSelect",i[0],a)),e.memory&&n.a.saveObject(e.memoryKey,e.multi?i:i[0],n.a.level.user)}})},closeSelect:function(){this.isOpen=!1},getSame:function(e,i){var a=[];return t.each(e,(function(e){e&&e.id&&t.find(i,(function(t){return t.id.toString().toUpperCase()===e.id.toString().toUpperCase()}))&&a.push(e)})),a},setSelected:function(){var e,i=n.a.getObject(this.memoryKey,n.a.level.user);!1===this.editabled||t.isEmpty(this.options)||(this.multi?t.isEmpty(this.selected)?i&&i.length&&this.memory?(e=this.getSame(i,this.options)).length&&(this.$emit("input",e),this.autoSelect&&this.$emit("defaultSelect",e)):this.selectDefault&&(e=this.getSame(this.selectDefault,this.options)).length&&(this.$emit("input",e),this.autoSelect&&this.$emit("defaultSelect",e)):(e=this.getSame(this.selected,this.options)).length?this.autoSelect&&this.$emit("defaultSelect",this.selected):this.autoSelect&&this.$emit("defaultSelect",[]):!t.isEmpty(this.selected)&&this.selected.id?this.autoSelect&&this.$emit("defaultSelect",this.selected):this.memory&&!t.isEmpty(i)&&(t.isArray(i)&&(i=i[0]),t.some(this.options,{id:i.id})&&(this.$emit("input",i),this.autoSelect&&this.$emit("defaultSelect",i))))}}}}).call(this,i("391c"))},"0f4f":function(t,e,i){"use strict";i("7686")},"0f6f":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .comment-button-input[data-v-efd269da]{padding:0;margin:0;border-top:1px solid #ececec;min-height:46px}.zjapp .comment-button-input .cbi-flex[data-v-efd269da]{width:100%;display:flex}.zjapp .comment-button-input .cbi-field[data-v-efd269da]{padding:12px 15px;font-size:16px;color:#333}.zjapp .comment-button-input .cbi-field[data-v-efd269da] textarea{line-height:22px;min-height:22px;max-height:66px}.zjapp .comment-button-input .cbi-field[data-v-efd269da] textarea::-moz-placeholder{color:#c8c8c8;font-size:16px}.zjapp .comment-button-input .cbi-field[data-v-efd269da] textarea:-ms-input-placeholder{color:#c8c8c8;font-size:16px}.zjapp .comment-button-input .cbi-field[data-v-efd269da] textarea::placeholder{color:#c8c8c8;font-size:16px}.zjapp .comment-button-input .cbi-field[data-v-efd269da] .van-field__left-icon{height:22px;display:none}.zjapp .comment-button-input .cbi-field.active[data-v-efd269da] .van-field__left-icon{display:block}.zjapp .comment-button-input .cbi-field[data-v-efd269da]:before{content:"";width:1px;height:calc(100% - 30px);background:#ececec;position:absolute;right:0;top:15px;bottom:15px}.zjapp .comment-button-input .cbi-field[data-v-efd269da]:after{content:none}.zjapp .comment-button-input .cbi-right[data-v-efd269da]{position:relative;min-width:80px}.zjapp .comment-button-input .cbi-button[data-v-efd269da]{width:auto;height:28px;line-height:18px;min-width:50px;padding:5px 11px;background:linear-gradient(270deg,#55abff,#4c7aff);border-radius:14px;color:#fff;font-size:14px;position:absolute;bottom:10px;right:15px;opacity:.5}.zjapp .comment-button-input .cbi-button.active[data-v-efd269da]{opacity:1}.zjapp .comment-button-input .cbi-button[data-v-efd269da] .svg-loading{width:16px;height:16px;margin:0}.zjapp .comment-button-input .cbi-icon[data-v-efd269da]{color:#c8c8c8;font-size:16px;position:relative;top:-1px}',""])},"15e7":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAMAAAC7m5rvAAAAk1BMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////ROyVeAAAAMHRSTlMAAvqA55Q+zQVaRph2bSQQ9PHEsY/RvqV7cWo3My4L696phoV3ZmBRGwnh2sagVRmd7JA7AAABWElEQVRIx+2U2XKCQBBFYdgCKgLiGtdoTMx6/v/rgljQVUJFOq/mvNBAneLO0D3W/RKH82iolV53AOn8QWUNt1zoqbQpmF0+Bo4Ka20gsizbg0ChRZCdr6cU4u7aolrUBKLumgNOtcawu9aDRVnkMOiujeClLGbgdNfG8FgWfchV+78uK08T8hkCSdu5HzcwqNOuOloPGbjDS5lAxylYfQBfl3oJieM4h/D7Ruf7ngH2dbdUjNp6zO4Hhhr5VSE1adS0JiAEvrwJnTN5BiSNvTkgeK2t679Bdv0wgFk5/YDVztJUjSMYKKxfNWva7E7AuqUN4FOjScP1/qD1YKDXbBd8veaDa+s1DzxLo0lGlSYZVZpk1GiSUaVJRpUmGTWaZNRroWRUDE7sQr+4asbUjucbcE8tWh+huH0yXJHKYLcfQaa4TbjifdlmyYGH2Te+th0dbeufe+UH6dlKY34y9JcAAAAASUVORK5CYII="},2470:function(t,e,i){"use strict";i("163d");var a={props:{size:{type:[String,Number],default:14},color:{type:String,default:"#3DB641"}}},o=(i("2e9e"),i("17cc")),n=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticClass:"icon",style:{width:this.size+"px",height:this.size+"px"},attrs:{viewBox:"0 0 1024 1024"}},[e("path",{attrs:{fill:this.color,d:"M512 0a512 512 0 1 1 0 1024A512 512 0 0 1 512 0z m295.204571 335.433143a36.571429 36.571429 0 0 0-51.785142 0L471.04 619.885714 341.723429 490.569143a36.571429 36.571429 0 0 0-51.785143 51.712l155.209143 155.209143a36.571429 36.571429 0 0 0 51.712 0l310.345142-310.345143a36.571429 36.571429 0 0 0 0-51.712z"}})])}),[],!1,null,"7ca133fc",null);e.a=n.exports},"2aa4":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .icon[data-v-7ca133fc]{border-radius:50%;overflow:hidden}",""])},"2e96":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .beyond-hidding[data-v-43be98b8]{word-wrap:break-word}.zjapp .beyond-hidding .bh-display_section[data-v-43be98b8]{position:relative;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical}.zjapp .beyond-hidding .all[data-v-43be98b8]{position:absolute;bottom:0;right:0;background:#fff;z-index:3;width:63px;display:flex;justify-content:space-between}.zjapp .beyond-hidding .all-span[data-v-43be98b8]{color:#4275e8;margin-left:10px}",""])},"2e9e":function(t,e,i){"use strict";i("a8b0")},"2f8f":function(t,e,i){"use strict";i("e5d4")},3148:function(t,e,i){"use strict";var a={name:"ApproveItem",props:{avatar:{type:String,default:""},avatarText:{type:String,default:""},editabled:{type:Boolean,default:!0},title:{type:String,default:""},description:{type:String,default:""}},data:function(){return{data:""}},methods:{handleClick:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.$emit("click",e)}}},o=i("17cc"),n=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"workflow-media workflow-panel__bd",on:{click:t.handleClick}},[i("div",{staticClass:"workflow-media-box workflow-media-box_appmsg"},[i("div",{staticClass:"workflow-media-box__hd"},[t.avatar?i("img",{staticClass:"workflow-media-box__thumb workflow-media-box__thumb",attrs:{src:t.avatar,alt:""}}):i("div",{staticClass:"workflow-media-box__thumb workflow-media-box__thumb"},[t._v("\n        "+t._s(t.avatarText||t.title.slice(-2))+"\n      ")])]),i("div",{staticClass:"workflow-media-box__bd"},[t.title?i("h4",{staticClass:"workflow-media-box__title"},[t._v("\n        "+t._s(t.title)+"\n      ")]):t._e(),t.description?i("p",{staticClass:"workflow-media-box__desc"},[t._v("\n        "+t._s(t.description)+"\n      ")]):t._e()]),t.editabled?i("span",{staticClass:"workflow-media-box__ft"}):t._e()])])}),[],!1,null,null,null);e.a=n.exports},"37b0":function(t,e,i){var a=i("7233");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("4070d1cd",a,!0,{sourceMap:!1,shadowMode:!1})},"3eeb":function(t,e,i){"use strict";i("5ab2"),i("6d57"),i("e10e"),i("cc57"),i("163d");var a=i("28f8"),o=i("162a"),n=i("1b7e"),s=i("fd50"),r=i("f2d3");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){Object(a.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={checkNetwork:function(){return n.a.getHasNetwork().then((function(t){if(!t)return s.a.reject({errmsg:"当前无网络连接"})}))},getDetail:function(t){return o.a.request("/project-highlight/get-detail",{id:t}).then((function(t){return c(c({},t),{},{image_file:JSON.parse(t.image_file||"[]"),type:{id:t.type,name:t.type,type:Number(t.case_type)},project:{id:t.proj_id,name:t.proj_name},creator:t.user,comment_num:Number(t.comment_num)})}))},getCommentList:function(t,e,i){return o.a.request("/webapi/project-highlight/get-comment-list",{highlight_id:t,page:e,page_size:i})},postAddComment:function(t,e){return o.a.post("/webapi/project-highlight/add-comment",null,{highlight_id:t,content:e})},postDeleteComment:function(t,e){return o.a.post("/webapi/project-highlight/delete-comment",null,{highlight_id:t,comment_id:e})},getTypeList:function(){return o.a.request("/online/project-highlight/type-list").then((function(t){return{1:(t=(t||[]).map((function(t){return t.id=t.name,t.type=Number(t.case_type),t}))).filter((function(t){return 1===Number(t.case_type)})),2:t.filter((function(t){return 2===Number(t.case_type)}))}}))},restore:function(){return r.a.restore()}}},"4d47":function(t,e,i){"use strict";i("163d");var a={props:{size:{type:[String,Number],default:14},color:{type:String,default:"#DCDFE6"}}},o=(i("ad0c8"),i("17cc")),n=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticClass:"icon",style:{width:this.size+"px",height:this.size+"px"},attrs:{viewBox:"0 0 1024 1024"}},[e("path",{attrs:{fill:this.color,d:"M512 0a512 512 0 1 1 0 1024A512 512 0 0 1 512 0z m-36.571429 219.428571a36.571429 36.571429 0 0 0-36.571428 36.571429v292.571429a36.571429 36.571429 0 0 0 36.571428 36.571428h292.571429a36.571429 36.571429 0 1 0 0-73.142857H512V256a36.571429 36.571429 0 0 0-36.571429-36.571429z"}})])}),[],!1,null,"d52b5ec6",null);e.a=n.exports},"4de1":function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r}));var a=i("6bf2"),o=i.n(a),n=i("3122"),s=function(t){try{return Array.isArray(t)?t&&t[0]&&t[0].url?n.a.getThumbnailFromUrl(t[0].url):"static/photo-default.png":t?n.a.getThumbnailFromUrl(t):"static/default_img_simple.png"}catch(e){return Array.isArray(t)?"static/photo-default.png":"static/default_img_simple.png"}},r=function(t){return o()(t).calendar(null,{sameDay:"[今天]",lastDay:"[昨天]",nextDay:"YYYY.M.D",nextWeek:"YYYY.M.D",lastWeek:"YYYY.M.D",sameElse:"YYYY.M.D"})}},"53a7":function(t,e,i){var a=i("ca58");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("0ba965f3",a,!0,{sourceMap:!1,shadowMode:!1})},"625a":function(t,e,i){"use strict";i("163d");var a=i("3122"),o=i("6bf2"),n=i.n(o),s={name:"BeyondHiding",components:{},props:{data:{type:String,default:""},lineHeight:{type:String,default:"22px"},maxLine:{type:Number,default:6}},data:function(){return{show:!0,showAllButton:!1,MaxLineComputed:0}},watch:{maxLine:function(t){this.MaxLineComputed=t}},mounted:function(){this.MaxLineComputed=this.maxLine+1;var t=this.$refs.bhDisplaySection;t&&(this.showAllButton=t.offsetHeight/(parseInt(t.style.lineHeight)||1)>6)},methods:{lineHeightNum:function(t){return t.offectHeight}}},r=(i("ad130"),i("17cc")),l={name:"CommentList",components:{BeyondHiding:Object(r.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"beyond-hidding"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],ref:"bhDisplaySection",staticClass:"bh-display_section",style:{"-webkit-line-clamp":t.MaxLineComputed,"line-height":t.lineHeight}},[t._v(t._s(t.data)+"\n    "),t.showAllButton?i("div",{staticClass:"all",on:{click:function(e){t.show=!1}}},[t._v("..."),i("span",{staticClass:"all-span"},[t._v("全部")])]):t._e()]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.show,expression:"!show"}],staticClass:"bh-display_all",style:{"line-height":t.lineHeight},on:{click:function(e){t.show=!0}}},[t._v(t._s(t.data))])])}),[],!1,null,"43be98b8",null).exports},props:{commentTotal:{type:Number,default:0},list:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{getUserLogo:function(t){try{return t?a.a.getThumbnailFromUrl(t):"static/default_img_simple.png"}catch(t){return"static/default_img_simple.png"}},timeConversion:function(t){return n()(t).calendar(null,{sameDay:"[今天] HH:mm",lastDay:"[昨天] HH:mm",nextDay:"YYYY.MM.DD HH:mm",nextWeek:"YYYY.MM.DD HH:mm",lastWeek:"YYYY.MM.DD HH:mm",sameElse:"YYYY.MM.DD HH:mm"})},deleteComment:function(t){this.$emit("onDeleteComment",t.comment_id)}}},c=(i("d9fd"),Object(r.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"comment-list"},[i("div",{staticClass:"cl-total"},[t._v("评论 ("+t._s(t.commentTotal)+")")]),i("div",{staticClass:"cl-list"},t._l(t.list,(function(e){return i("div",{key:e.comment_id},[i("div",{staticClass:"cl-item"},[i("img",{staticClass:"cl-img",attrs:{src:t.getUserLogo(e.avatar)}}),i("div",{staticClass:"cl-flex"},[i("div",{staticClass:"cl-name"},[t._v(t._s(e.user_name))]),i("beyond-hiding",{staticClass:"cl-content",attrs:{"line-height":"22px","max-line":6,data:e.content}}),i("div",{staticClass:"cl-date"},[t._v(t._s(t.timeConversion(e.created_on)))])],1),e.can_del?i("div",{staticClass:"cl-delete",on:{click:function(i){t.deleteComment(e)}}},[t._v("删除")]):t._e()])])}))),i("loading-status",{staticClass:"comment-list-loading",attrs:{type:"message","is-empty":t.list.length<=0,"empty-text":"暂无评论，快来抢沙发"}})],1)}),[],!1,null,"636dc866",null));e.a=c.exports},6832:function(t,e,i){"use strict";(function(t){i("198f");var a=i("b3e2"),o=(i("163d"),i("6d57"),i("06a2"),i("cc57"),i("3bd5")),n=i("162a"),s=i("4ad6"),r=i("3122"),l=i("1601"),c=i("e2a7"),d=i("3eeb"),p=i("774b"),u=i("07d2"),f=i("e68e"),h=i("de7f"),m=i("625a"),g=i("ca02"),b=i("1b7e"),v=i("4de1"),x=i("6f9e"),w=i("7e8b");e.a={name:"ProjectHighlightDetail",components:{Item:u.default,ItemImgList:f.a,Scroller:p.default,CommentList:m.a,CommentButtonInput:g.a,Workflow:h.a},data:function(){return{isLoading:!1,workflowLoading:!1,isWorkflow:!1,canEdit:!1,problemId:"",user:o.a.getUser(),model:{},typeOptions:[{id:"质量",name:"质量"},{id:"安全文明",name:"安全文明"},{id:"工艺",name:"工艺"},{id:"综合",name:"综合"},{id:"其他",name:"其他"}],problemData:{creator:{},type:{},project:{}},commentTotal:0,commentPage:1,commentPageSize:10,commentList:[]}},computed:{caseName:function(){var t="";switch(this.problemData.type.type){case 1:t="优秀做法-";break;case 2:t="不良做法-"}return this.isWorkflow&&(t="审核列表-"),t+this.problemData.type.name},noData:function(){return this.isLoaded&&this.problemData.id},commentIsNext:function(){return this.commentList.length<this.commentTotal&&0!==this.commentTotal},isLoaded:function(){return this.isWorkflow?!this.isLoading&&!this.workflowLoading:!this.isLoading}},activated:function(){this.init()},deactivated:function(){this.canEdit=!1},methods:{init:function(){var t=this,e=this.$route.params,i=e&&e.id?e.id:"",a=!(!e||!e.isWorkflow)&&e.isWorkflow;if(this.problemId=i,this.isLoading=!1,this.isWorkflow=a,this.problemData={creator:{},type:{},project:{}},this.commentList=[],this.commentTotal=0,this.commentPage=1,this.commentPageSize=10,this.problemId){this.isLoading=!0;var o=this.getDetail(),n=this.firstGetCommentList();return Promise.all([o,n]).then((function(){t.isLoading=!1}))}},getDetail:function(){var t=this;return d.a.getDetail(this.problemId).then((function(e){e.publishDate=Object(v.b)(e.created_on),e.user.headimg_url||(e.user.headimg_url=Object(v.a)(e.user.headimg_url,"avater")),e.image_file=e.image_file.map((function(t){return{id:t.id,url:t.url,videoUrl:t.videoUrl}})),t.problemData=e})).catch((function(t){$log.error("工程案例-案例详情-error：",t)}))},openHeaderImg:function(t){var e;e="img/default_img_simple.png"===t.headimg_url?r.a.fixUrl(s.a.appCodePath()+t.headimg_url):t.headimg_url,s.a.openImageBrowser([e],0)},toUrl:function(t){t&&window.MUtils.openUrlInBrowser(t)},openIm:function(e){if($rootScope.allowIM&&1===e.is_im_user&&e.id!==this.user.user_id)if(t.has(e,"headimg_url")){var i=o.a.getUser().tenant_code+"_"+e.id;l.a.openIm(i,e.name,e.headimg_url).catch((function(t){c.a.alert(t)}))}else l.a.openUserChat(e.id).catch((function(t){c.a.alert(t)}))},praise:function(t){var e=this;if(1!==t.has_praise)return d.a.checkNetwork().then((function(){return n.a.post("/project-highlight/praise",{},{id:t.id}).then((function(){e.problemData.has_praise=1,e.problemData.praise_num=parseInt(e.problemData.praise_num||0)+1,c.a.alert("已点赞")}))})).catch((function(t){c.a.alert(t.errmsg)}));c.a.alert("一天只能点赞1次，明天再来哦~")},doEdit:function(){},handleWorkflowLoaded:function(){this.workflowLoading=!1},handleWorkflowError:function(){this.workflowLoading=!1},handleAfterTerminate:function(t){this.reloadHighlightList()},handleAfterBook:function(t){if(t&&t.isOk){c.a.alert("案例已发布"),this.$router.back();var e=Number(this.problemData.check_status)===w.b.public?0:2;return x.a.$emit("highlight-update",e)}},reloadHighlightList:function(){x.a.$emit("highlight-update",2)},handleAfterApproval:function(t){var e=this;if(t&&t.isOk)return c.a.alert("提交成功").then((function(){e.$router.back();var t=Number(e.problemData.check_status)===w.b.public?0:2;return x.a.$emit("highlight-update",t,!!e.problemData.id)}))},onDeleteComment:function(t){var e=this;$log.log("工程案例-删除评论-数据：",{"案例id":this.problemId,"评论id":t}),this.getHasNetwork().then((function(){a.a.confirm({closeOnClickOverlay:!0,className:"dialog-customize",message:"确定要删除自己的评论？",cancelButtonText:"取消",confirmButtonText:"删除"}).then((function(){d.a.postDeleteComment(e.problemId,t).then((function(t){c.a.alert("删除成功"),e.updateCommentList()})).catch((function(t){$log.error("工程案例-删除评论-error：",t)}))})).catch((function(){return!1}))}))},onPostComment:function(t,e){var i=this;$log.log("工程案例-发表评论-数据：",{"案例id":this.problemId,"发表的内容":t}),this.getHasNetwork().then((function(){d.a.postAddComment(i.problemId,t).then((function(t){i.updateCommentList(),i.$refs.commentButtonInput.result();var a=i.$refs.detailMain.offsetHeight+10;i.$refs.scroller.$el.scrollTop=a,c.a.alert("发表成功"),e&&e()})).catch((function(t){$log.error("工程案例-发表评论-error：",t),e&&e()}))}))},firstGetCommentList:function(){return this.isWorkflow?Promise.resolve([]):(this.commentList=[],this.commentPage=1,this.getCommentList())},updateCommentList:function(){this.commentPage=1,this.getCommentList()},onceAgainGetCommentList:function(){if(!this.isWorkflow)return this.commentIsNext?(this.commentPage=this.commentPage+1,this.getCommentList(!0)):void 0},getCommentList:function(t){var e=this;return d.a.getCommentList(this.problemId,this.commentPage,this.commentPageSize).then((function(i){e.commentList=t?e.commentList.concat(i.list):i.list,e.commentTotal=i.total,console.log("评论列表：",i)})).catch((function(t){e.commentList=[],$log.error("工程案例-评论列表-error：",t)}))},getHasNetwork:function(){return new Promise((function(t,e){b.a.getHasNetwork().then((function(e){e?t():c.a.alert("当前无网络连接")})).catch((function(t){$log.error("工程案例-详情-判断是否有网-error：",t)}))}))}}}}).call(this,i("391c"))},7233:function(t,e,i){var a=i("5454");(t.exports=i("690e")(!1)).push([t.i,".zjapp .project-highlight-header[data-v-4652beb3]{display:flex;align-items:center;justify-content:center;padding:8px 15px;border:none;background-image:linear-gradient(0deg,#ddd,#ddd 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .project-highlight-header .img[data-v-4652beb3]{height:30px;margin-right:8px;border-radius:15px}.zjapp .project-highlight-header .user[data-v-4652beb3]{flex:1;line-height:18px;color:#333;font-size:14px}.zjapp .project-highlight-header .im[data-v-4652beb3]{font-size:14px;color:#7a95d1;margin-left:5px}.zjapp .project-highlight-header .date[data-v-4652beb3]{padding-left:10px;white-space:nowrap;color:#999;font-size:12px}.zjapp .project-highlight-footer[data-v-4652beb3]{padding:9px 15px;background-color:#fff;border:none;background-image:linear-gradient(180deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:top;display:-moz-flex;display:flex;-moz-align-items:center;align-items:center;-webkit-box-align:center;-moz-box-align:center;-ms-flex-align:center;-moz-justify-content:center;justify-content:center}.zjapp .project-highlight-footer .view-num[data-v-4652beb3]{-moz-flex:1;flex:1;font-size:14px;line-height:16px;color:#999}.zjapp .project-highlight-footer .btn-con .btn[data-v-4652beb3]{height:28px;line-height:28px;min-width:74px}.zjapp .project-highlight-footer .num-view[data-v-4652beb3]{display:inline-block;vertical-align:top;height:18px;line-height:18px;padding-left:21px;background:url("+a(i("9434"))+") no-repeat;background-size:18px 18px}.zjapp .project-highlight-footer .num-praise[data-v-4652beb3]{background:url("+a(i("15e7"))+") no-repeat;background-size:18px 18px}.zjapp .project-highlight-footer .num-praise[data-v-4652beb3],.zjapp .project-highlight-footer .num-praise-alrealy[data-v-4652beb3]{display:inline-block;vertical-align:top;height:18px;line-height:18px;margin-top:5px;padding-left:21px;font-size:14px}.zjapp .project-highlight-footer .num-praise-alrealy[data-v-4652beb3]{background:url("+a(i("a325"))+") no-repeat;background-size:18px 18px}.zjapp .project-highlight-footer .btn[data-v-4652beb3]{border:none;background-color:#5197ff;display:block;width:100%;padding:0 5px;text-align:center;height:46px;line-height:46px;font-size:16px;color:#fff;text-decoration:none;border-radius:23px;background-image:linear-gradient(90deg,#5ea1ff,#4275e8);background-size:100% 100%}.zjapp .project-highlight-footer .btn-gradient[data-v-4652beb3]{height:45px;line-height:45px;padding:0 15px;border:none;border-radius:22.5px;background-image:linear-gradient(90deg,#5ea1ff,#4275e8);background-size:100% 100%}.zjapp .project-highlight-footer .btn-gradient-disabled[data-v-4652beb3]{background-color:#fff;color:#4275e8;background-image:linear-gradient(90deg,rgba(94,161,255,.15),rgba(66,117,232,.15))}",""])},7686:function(t,e,i){var a=i("ffe8");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("78245c1a",a,!0,{sourceMap:!1,shadowMode:!1})},"78b5":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .item[data-v-371c8aaa]{align-items:center}.zjapp .icon[data-v-371c8aaa]{color:#4275e8}.zjapp .item>[class*=icon-checkbox][data-v-371c8aaa]{margin-right:10px}.zjapp .item-disabled>[class*=icon-checkbox][data-v-371c8aaa]{color:#b2b2b2;background-color:#b2b2b2}",""])},"7e8b":function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return r}));var a,o=i("28f8"),n="workflow_switch.project_highlight",s={progress:0,doing:1,close:-1,public:2,done:3},r=(a={},Object(o.a)(a,s.progress,"待审核"),Object(o.a)(a,s.close,"已拒绝"),Object(o.a)(a,s.public,"已发布"),Object(o.a)(a,s.done,"已发布"),a)},"7ef3":function(t,e,i){"use strict";i("163d");var a={props:{size:{type:[String,Number],default:14},color:{type:String,default:"#FF3C46"}}},o=(i("b28f"),i("17cc")),n=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticClass:"icon",style:{width:this.size+"px",height:this.size+"px"},attrs:{viewBox:"0 0 1024 1024"}},[e("path",{attrs:{fill:this.color,d:"M512 0a512 512 0 1 1 0 1024A512 512 0 0 1 512 0zM356.864 305.152a36.571429 36.571429 0 1 0-51.712 51.712L460.214857 512l-155.062857 155.136a36.571429 36.571429 0 1 0 51.712 51.712L512 563.785143l155.136 155.062857a36.571429 36.571429 0 1 0 51.712-51.712L563.785143 512l155.062857-155.062857a36.571429 36.571429 0 1 0-51.712-51.712L512 460.214857z","p-id":"14252"}})])}),[],!1,null,"dfca9144",null);e.a=n.exports},"89ff":function(t,e,i){"use strict";i("37b0")},"8cfe":function(t,e,i){"use strict";i("f36f")},9434:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAMAAAC7m5rvAAAAV1BMVEUAAADc3NzJycnJycnKysrLy8vJycnJycnKysrKysrKysrKysrJycnMzMzJycnJycnMzMzKysrKysrLy8vJycnJycnIyMjKysrKysrIyMjIyMjMzMzIyMjuGoqPAAAAHHRSTlMABuKZbVDRopGIdFuxFfHFDn9AM7wr9mhh6dsjZJMAAwAAAVtJREFUSMftlNmSgyAQRSUsoiyKe5L5/+8cWmsaHDVavKXK+yTLgdvd2NmtW1+hnjOpK51Lp8xVpi0eP5GE5OSUIQ6ZoMd4Ak4LZLUsecMVc92wgOwD2AjY8qRNtIc0i+dXe0Sx+Vy1Nc4AHKZ9SoI7t2uGjNYvUrKzov1CFdJd87LkNQ7fApbrDVX56RyPM3TJITW4IQeO/KM6P1mEcj8w9/0q9I5sHDIcGqAEpQI4s+J0zIGBMgy9QzsnVFnvM8yXEEi8DRyiaj8ECjj/GeWhgHDjgcyCuHf49+198rhI4YIWrw5eKBpB9yGcNhFLM5mWkvQCpJc7PC72+XEV+LhSn3JQDZx4H/04pkKHaxG4wO43G+IsFmmjaThoNmoOlR12yNechWLdgugTZkWzR4RmAxo6xxRveCm1XRI6nbTXca+9ugt9mUuxYoo2uyijnMx1pSXjfXbr1jfoF81jK2XZRZv6AAAAAElFTkSuQmCC"},"94a7":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .icon[data-v-dfca9144]{border-radius:50%;overflow:hidden}",""])},"975c":function(t,e,i){"use strict";i("53a7")},a15f:function(t,e,i){"use strict";i("0a36")},a325:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAMAAAC7m5rvAAAAjVBMVEUAAABBdulCdelCdepBdOpCdepCdelCdepJiv9CdelCdelCdulDdutCdelCdelCdulCdepCdupIfPRVVf9CdelCdelCdupDdulCdupCd+lDdOpCeutDeOtFfvdPfupCdupCdupDdupDdupCeOpEdepBeOtEd+xCdOpCdehBdOlEdOtCdej////7/P+lvfTkjHGPAAAAK3RSTlMAZv3ladn6vwX00cqn4dau8bUgA/brt5SKd25TMRXywKqhnJt8cV5B7btL0FHq8wAAAUtJREFUSMft1NluwjAURVF8ExIyA2UsUGZou2n///OaBEqqOFJsXul+X9KRZbvzvH1Os/nQFi0dirKelRp6XEutWALynhR2b6FWgmRKuQ4EFuwAI5V3FDibsxgcVRTA3JytoVuyMUzNWQpRyRLYmDMHJiXL/dqcjWBbshAiq/M//o7MjNkWPFXWh5mpWgpEV+bBwlD1+iDzUrnA0EwtcsWHKtuB+L4/mS5bbr4bCtBV1yJuiXNu2jUIhHuSqls+9+Sgqzf+5MXqnt8tSkZCw9lMqHIy1VAs0K+zAL6/LnmAam4ncKoxgVJVTG8Mfo0BlzYWQfcxlj7AHNjYM1fAtWcxyIs9cyDsWDNX4NWS6Rt1ZrRRZ0YbdWa0UWemG3XWvNGe+dVGi4czExjUSNszdWchIKsGNqAtpRntC9LzThqpPrzmxBvve53/nrUfMYFZrO18/qgAAAAASUVORK5CYII="},a74b:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .test[data-v-02b6192e]{background-color:#fff;width:100%;height:100%}.zjapp .limit[data-v-02b6192e]{position:fixed;bottom:10px;right:20px;color:#c8c8c8}.zjapp .van-cell[data-v-02b6192e]:not(:last-child):after{border-bottom:none}.zjapp .fieldTextarea[data-v-02b6192e]{width:100%;height:100%;padding:20px 15px}",""])},a84d:function(t,e,i){var a=i("04da");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("09a6300c",a,!0,{sourceMap:!1,shadowMode:!1})},a8ab:function(t,e,i){"use strict";i.r(e);var a=i("6832").a,o=(i("89ff"),i("17cc")),n=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{title:"案例详情","show-go-root":!0}},[i("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},slot:"header-bar-right"},[t.canEdit?i("span",{on:{click:t.doEdit}},[t._v("修改")]):t._e()]),[i("div",{staticClass:"project-highlight-header"},[i("img",{directives:[{name:"track",rawName:"v-track",value:"工程案例-详情页-点击头像",expression:"'工程案例-详情页-点击头像'"}],staticClass:"img",attrs:{src:t.problemData.creator.headimg_url,alt:""},on:{click:function(e){t.openHeaderImg(t.problemData.creator)}}}),i("div",{directives:[{name:"track",rawName:"v-track",value:"工程案例-详情页-聊天",expression:"'工程案例-详情页-聊天'"}],staticClass:"user",on:{click:function(e){t.openIm(t.problemData.creator)}}},[i("span",[t._v(t._s(t.problemData.creator.name))]),t.user.user_id!==t.problemData.creator.id?i("icon",{staticClass:"im",attrs:{name:"liaotian"}}):t._e()],1),i("div",{staticClass:"date"},[t._v(t._s(t.problemData.publishDate+"分享"))])]),t.noData?i("scroller",{ref:"scroller",attrs:{"has-next":t.commentIsNext,"is-empty":!t.commentList.length},on:{loadNext:t.onceAgainGetCommentList}},[i("div",{ref:"detailMain"},[i("item",{attrs:{label:"主题"}},[i("div",{staticClass:"item-text",attrs:{slot:"right"},slot:"right"},[i("p",{staticClass:"pb5 color-black"},[t._v(t._s(t.problemData.title))]),i("item-img-list",{attrs:{editabled:!1,"online-mode":!0},model:{value:t.problemData.image_file,callback:function(e){t.$set(t.problemData,"image_file",e)},expression:"problemData.image_file"}})],1)]),t.problemData.link?i("item",{attrs:{label:"超链接"}},[i("div",{staticClass:"item-text",attrs:{slot:"right"},slot:"right"},[i("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.toUrl(t.problemData.link)}}},[i("i",{staticClass:"iconfont icon-icon-tianjiachaolianjie"}),t._v("\n              "+t._s(t.problemData.link_name)+"\n            ")])])]):t._e(),i("item",{attrs:{label:"补充说明",text:t.problemData.remark}}),i("item",{attrs:{label:"案例类型",text:t.caseName}}),i("item",{attrs:{label:"项目",text:t.problemData.project.name}}),t.isWorkflow?i("div",{staticClass:"mb10"}):i("div",{staticClass:"project-highlight-footer mb10"},[i("div",{staticClass:"view-num"},[i("span",{staticClass:"num-view"},[t._v(t._s(t.problemData.pv_num+"次围观"))])]),i("div",{staticClass:"btn-con"},[i("button",{directives:[{name:"track",rawName:"v-track",value:"工程案例-详情页-点赞",expression:"'工程案例-详情页-点赞'"}],staticClass:"btn btn-gradient",class:1===t.problemData.has_praise?"btn-gradient-disabled":"",on:{click:function(e){t.praise(t.problemData)}}},[i("span",{class:1===t.problemData.has_praise?"num-praise-alrealy":"num-praise"},[t._v("\n                "+t._s(t.problemData.praise_num)+"\n              ")])])])])],1),t.isWorkflow?i("workflow",{ref:"workflow",attrs:{"is-anchor-node":!0,"business-id":t.problemData.id},on:{loaded:t.handleWorkflowLoaded,error:t.handleWorkflowError,afterApproval:t.handleAfterApproval,afterTerminate:t.handleAfterTerminate,afterBook:t.handleAfterBook}}):t._e(),i("comment-list",{directives:[{name:"show",rawName:"v-show",value:!t.isWorkflow,expression:"!isWorkflow"}],attrs:{list:t.commentList,"comment-total":t.commentTotal},on:{onDeleteComment:t.onDeleteComment}})],1):t._e()],i("loading-status",{attrs:{"is-loading":!t.isLoaded,"is-empty":!t.problemData.id,"empty-text":"加载详情失败"}}),!t.isWorkflow&&t.noData?i("comment-button-input",{ref:"commentButtonInput",on:{onPostComment:t.onPostComment}}):t._e()],2)}),[],!1,null,"4652beb3",null);e.default=n.exports},a8b0:function(t,e,i){var a=i("2aa4");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("6e42a77a",a,!0,{sourceMap:!1,shadowMode:!1})},a95f4:function(t,e,i){"use strict";i("163d");var a={props:{size:{type:[String,Number],default:46},color:{type:String,default:"#FF3C46"}}},o=(i("0f4f"),i("17cc")),n=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{style:{width:this.size+"px",height:this.size+"px"},attrs:{viewBox:"0 0 46 46",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[e("title",[this._v("编组 4")]),e("desc",[this._v("Created with Sketch.")]),e("g",{attrs:{id:"工程案例",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[e("g",{attrs:{id:"工程案例-新增案例",transform:"translate(-51.000000, -749.000000)",stroke:"#DCDFE6"}},[e("g",{attrs:{id:"编组-3",transform:"translate(15.000000, 709.000000)"}},[e("g",{attrs:{id:"编组-4",transform:"translate(36.000000, 40.000000)"}},[e("circle",{attrs:{id:"椭圆形","stroke-width":"2",fill:"transparent",cx:"23",cy:"23",r:"22"}}),e("rect",{attrs:{id:"矩形",fill:"#D8D8D8",transform:"translate(23.000000, 23.000000) rotate(90.000000) translate(-23.000000, -23.000000) ",x:"13.5",y:"22.5",width:"19",height:"1",rx:"0.5"}}),e("rect",{attrs:{id:"矩形",fill:"#D8D8D8",x:"13.5",y:"22.5",width:"19",height:"1",rx:"0.5"}}),e("path",{attrs:{d:"M22.6464466,13.6464466 C22.5559644,13.7369288 22.5,13.8619288 22.5,14 L22.5,22.5 L14,22.5 C13.8619288,22.5 13.7369288,22.5559644 13.6464466,22.6464466 C13.5559644,22.7369288 13.5,22.8619288 13.5,23 C13.5,23.1380712 13.5559644,23.2630712 13.6464466,23.3535534 C13.7369288,23.4440356 13.8619288,23.5 14,23.5 L22.5,23.5 L22.5,32 C22.5,32.1380712 22.5559644,32.2630712 22.6464466,32.3535534 C22.7369288,32.4440356 22.8619288,32.5 23,32.5 C23.1380712,32.5 23.2630712,32.4440356 23.3535534,32.3535534 C23.4440356,32.2630712 23.5,32.1380712 23.5,32 L23.5,23.5 L32,23.5 C32.1380712,23.5 32.2630712,23.4440356 32.3535534,23.3535534 C32.4440356,23.2630712 32.5,23.1380712 32.5,23 C32.5,22.8619288 32.4440356,22.7369288 32.3535534,22.6464466 C32.2630712,22.5559644 32.1380712,22.5 32,22.5 L23.5,22.5 L23.5,14 C23.5,13.8619288 23.4440356,13.7369288 23.3535534,13.6464466 C23.2630712,13.5559644 23.1380712,13.5 22.6464466,13.6464466 Z",id:"形状结合",fill:"#D8D8D8"}})])])])])])}),[],!1,null,"e26d53fc",null);e.a=n.exports},abb5:function(t,e,i){"use strict";var a=i("329b"),o=(i("5ab2"),i("6d57"),i("e10e"),i("e204"),i("28f8")),n=(i("e697"),i("cc57"),i("9dd9"),i("6d46")),s=i.n(n),r=i("e2a7"),l=i("9eea"),c=i("774b"),d=i("07d2"),p=(i("f548"),{name:"UserSelectItem",components:{Item:d.default},props:{name:{type:String},headPortrait:{type:String,default:"static/default_img_simple.png"},multi:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},keyword:{type:String,default:""}},data:function(){return{}},computed:{showName:function(){var t="";if(""===this.keyword)t=this.name;else{var e=new RegExp("("+this.keyword+")","gmi");t=this.name.replace(e,'<span color="color-theme">$1</span>')}return t}}}),u=(i("b1b0"),i("17cc")),f=Object(u.a)(p,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("item",t._g({class:{"item-disabled":t.disabled},attrs:{border:"bottom"}},t.$listeners),[t.multi?i("icon",{attrs:{name:t.selected?"checkbox-checked":"checkbox"}}):t._e(),t.headPortrait?i("img",{staticClass:"item-headimg",attrs:{src:t.headPortrait}}):t._e(),i("div",{staticClass:"item-text",class:{"color-theme":!t.multi&&t.selected},domProps:{innerHTML:t._s(t.showName)}}),t.multi?t._e():i("icon",{attrs:{name:t.selected?"qualified":""}})],1)}),[],!1,null,"371c8aaa",null).exports,h=i("6144"),m=i("e89f"),g=i("a18c"),b=i("4360");function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function x(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(Object(i),!0).forEach((function(e){Object(o.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var w={name:"AppUserSelect",components:{appSearchBar:l.default,Scroller:c.default,Item:d.default,UserItem:f},mixins:[m.a],data:function(){return{storageKey:encodeURI(this.title||"userSelectMark"),showFixed:!1,show:!1,searchStatus:!1,keyword:"",options:[],selected:[],disabled:[],max:1/0,maxTip:"",lastSelected:[],openSet:{}}},computed:{selectedSet:function(){var t={};return s.a.isArray(this.selected)?s.a.each(this.selected,(function(e){t[e.id]=!0})):this.selected&&this.selected.id&&(t[this.selected.id]=!0),t},disabledSet:function(){var t={};return s.a.each(this.disabled||[],(function(e){t[e.id]=!0})),t},filterOptions:function(){var t=this;this.options;return this.keyword?s.a.filter(this.options,(function(e){return new RegExp("("+t.keyword+")","gmi").test(e.auditor_name)})):this.options},roleGroup:function(){var t,e=this,i=[{id:31,name:"施工单位人员",children:[]},{id:32,name:"监理单位人员",children:[]},{id:33,name:"建设单位人员",children:[]}];return t=this.keyword?s.a.filter(this.options,(function(t){return new RegExp("("+e.keyword+")","gmi").test(t.name)})):this.options,s.a.each(i,(function(e){e.children=s.a.filter(t,(function(t){return t.role===e.id}))})),s.a.filter(i,(function(t){return!s.a.isEmpty(t.children)}))},contractorGroup:function(){var t=this,e=[];if(b.a.state.global.allowGroupUserByConstructor){var i,a={id:"other",name:"其他",children:[]};i=this.keyword?s.a.filter(this.options,(function(e){return new RegExp("("+t.keyword+")","gmi").test(e.name)})):this.options,s.a.each(i,(function(t){31===t.role&&(t.contractors&&t.contractors.length?s.a.each(t.contractors,(function(i){var a=s.a.find(e,(function(t){return t.id===i.id}));a||(a=x(x({},i),{},{children:[]}),e.push(a)),a.children.push(x({},t))})):a.children.push(x({},t)))})),s.a.isEmpty(a.children)||e.push(a)}return e},groupSelectedSet:function(){var t=this,e={};return s.a.each(this.roleGroup,(function(i){var a=s.a.some(i.children,(function(e){return!t.selectedSet[e.id]}));e[i.id]=!a})),s.a.each(this.contractorGroup,(function(i){var a=s.a.some(i.children,(function(e){return!t.selectedSet[e.id]}));e[i.id]=!a})),e}},watch:{keyword:function(t){this.setSearchOpenSet()}},methods:{openPopup:function(t){console.log("params",t),t.selected=t.selected||[];var e=s.a.isArray(t.selected)?t.selected:[t.selected],i=s.a.filter(t.options,(function(t){return s.a.some(e,{id:t.auditor_id})||t.checked}));t.disabled=t.disabled||[];var a=s.a.isArray(t.disabled)?t.disabled:[t.disabled],o=s.a.filter(t.options,(function(t){return s.a.some(a,{id:t.auditor_id})||t.disabled}));this.show=!0,this.showFixed=!1,this.title=t.title,this.selected=i,this.disabled=o,this.options=t.options,this.multi=t.multi,this.onSelect=t.onSelect,this.beforeSelect=t.beforeSelect,this.beforeConfirm=t.beforeConfirm,this.max=t.max||1/0,this.maxTip=t.maxTip||"";var n=this.getLastSelected(),r=s.a.filter(t.options,(function(t){return s.a.contains(n,t.id)}));r=s.a.sortBy(r,(function(t){return s.a.indexOf(n,t.id)})),this.lastSelected=r,this.storageKey=encodeURI(this.title||"userSelectMark"),this.$emit("open")},setDefaultOpen:function(){},setSearchOpenSet:function(){this.keyword},toggleGroup:function(t){this.$set(this.openSet,t.id,!this.openSet[t.id])},getLastSetKey:function(){var t=g.a.history.current,e=t?t.name:"";return"".concat(b.a.state.global.currentProject.id,"-").concat(e,"-").concat(encodeURI(this.title))},saveLastSelected:function(t){if(t&&(s.a.isArray(t)||(t=[t]),!(t.length>3))){var e=this.getLastSelected();s.a.each(t,(function(t){e.unshift(t.id)})),(e=s.a.uniq(e)).length>3&&(e=e.splice(0,3));var i=this.getLastSetKey(),a=h.a.getUserObject("user-select-last-selected")||{};a[i]=e,h.a.saveUserObject("user-select-last-selected",a)}},getLastSelected:function(){var t=this.getLastSetKey();return(h.a.getUserObject("user-select-last-selected")||{})[t]||[]},closePopup:function(){this.show=!1,this.$emit("close")},onSure:function(){this.saveLastSelected(this.selected),this.onSelect(this.selected),this.closeEvent()},onConfirm:function(){var t=this,e=this.multi?this.beforeSelect(this.selected):null,i=this.beforeConfirm(this.selected);e instanceof Promise||(e=Promise.resolve(e)),i instanceof Promise||(i=Promise.resolve(i)),e.then((function(e){!1!==e&&i.then((function(e){!1!==e&&window.setTimeout((function(){t.onSure()}),300)}))}))},closeEvent:function(){this.closePopup(),this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch(),this.onSearchTypeChange(!1)},onScroll:function(t){t.srcElement&&t.srcElement.scrollTop&&t.srcElement.scrollTop>44?this.showFixed=!0:this.showFixed=!1},onSearchTypeChange:function(t){this.searchStatus=t,t||(this.keyword="")},selectedAll:function(t){var e=this;if(t&&t.children&&t.children.length){var i="";if(i=!this.groupSelectedSet[t.id]){var a=s.a.filter(t.children,(function(t){return!e.selectedSet[t.auditor_id]&&!e.disabledSet[t.auditor_id]})).length;if(this.selected.length+a>this.max)return void r.a.alert(this.maxTip||"最多选择".concat(this.max,"个"))}s.a.each(t.children,(function(t){if(!e.disabledSet[t.auditor_id]){var a=s.a.findIndex(e.selected,{id:t.auditor_id});a<0?i&&e.selected.push(t):i||e.selected.splice(a,1)}}))}},onSelectUser:function(t){var e=this,i=this.multi?null:this.beforeSelect(t);i instanceof Promise||(i=Promise.resolve(i)),i.then((function(i){if(!1===i)return!1;if(!e.disabledSet[t.auditor_id]){if(e.multi){var a=s.a.findIndex(e.selected,{id:t.auditor_id});if(a<0){if(e.selected.length>=e.max)return void r.a.alert(e.maxTip||"最多选择".concat(e.max,"个"));e.selected.push(t)}else e.selected.splice(a,1)}else e.selected=[t],window.setTimeout((function(){e.onSure()}),300);e.recordSearch()}}))},recordSearch:function(){this.$refs["app-search-bar"].saveHistory()}}},_=(i("a15f"),Object(u.a)(w,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{attrs:{title:t.title,mode:"dialog","on-close":t.closeEvent}},[t.multi?i("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:t.onConfirm},slot:"header-bar-right"},[t._v("\n      确定("+t._s(t.selected.length)+")\n    ")]):t._e(),t.multi&&t.showFixed&&t.selected.length?i("div",{staticClass:"selected fixed border-bottom"},[i("label",{staticClass:"selected-label"},[t._v("已选：")]),t._l(t.selected,(function(e){return i("span",{key:e.auditor_id,staticClass:"selected-item",class:{"selected-item-disabled":e.disabled}},[t._v("\n        "+t._s(e.auditor_name)+t._s(e.station_name)+"\n        "),i("icon",{staticClass:"selected-remove",attrs:{name:"unqualified"},on:{click:function(i){t.onSelectUser(e)}}})],1)}))],2):t._e(),i("scroller",{attrs:{"is-empty":!!t.keyword&&!t.options.length},on:{"&scroll":function(e){return t.onScroll(e)}}},[i("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":t.storageKey},on:{changeSearchStatus:t.onSearchTypeChange},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),!t.searchStatus||t.searchStatus&&t.keyword?[t.multi&&t.selected.length?i("div",{staticClass:"selected"},[i("label",{staticClass:"selected-label"},[t._v("已选：")]),t._l(t.selected,(function(e){return i("span",{key:e.auditor_id,staticClass:"selected-item",class:{"selected-item-disabled":e.disabled}},[t._v("\n            "+t._s(e.auditor_name)+t._s(e.station_name)+"\n            "),i("icon",{staticClass:"selected-remove",attrs:{name:"unqualified"},on:{click:function(i){t.onSelectUser(e)}}})],1)}))],2):t._e(),t._l(t.filterOptions,(function(e){return i("user-item",{key:e.auditor_id,staticClass:"item-data",attrs:{"head-portrait":e.head_portrait||"static/default_img_simple.png",name:""+e.auditor_name+(e.station_name&&"（"+e.station_name+"）"),keyword:t.keyword,multi:t.multi,selected:t.selectedSet[e.auditor_id],disabled:t.disabledSet[e.auditor_id]},on:{click:function(i){t.onSelectUser(e)}}})})),i("loading-status",{attrs:{"is-empty":!t.filterOptions.length,"empty-text":Boolean(t.keyword)?"没有查询到结果":"暂无数据",type:Boolean(t.keyword)?"search":"common"}})]:t._e()],2)],1):t._e()],1)}),[],!1,null,"d8237c5a",null).exports),y=!1;y||(y=new(a.default.extend(_))({el:document.createElement("div")}),document.body.appendChild(y.$el));e.a=y},abe7:function(t,e,i){"use strict";i("cb7b")},ad0c8:function(t,e,i){"use strict";i("ebc7")},ad130:function(t,e,i){"use strict";i("f4da")},b1b0:function(t,e,i){"use strict";i("e02a")},b28f:function(t,e,i){"use strict";i("f553")},bcce:function(t,e,i){"use strict";i("00be")},c4ef:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .selected[data-v-d8237c5a]{position:relative;z-index:3;padding:5px 15px 10px 60px;line-height:24px;background-color:#fff;max-height:134px;overflow:auto;scroll-behavior:smooth}.zjapp .selected-label[data-v-d8237c5a]{position:absolute;top:10px;left:15px;line-height:24px;font-size:16px;color:#999}.zjapp .selected-item[data-v-d8237c5a]{position:relative;display:inline-block;height:24px;line-height:20px;padding:2px 20px 2px 5px;margin:5px 5px 0 0;font-size:14px;color:#666;background-color:#f4f4f4;border-radius:4px}.zjapp .selected-remove[data-v-d8237c5a]{position:absolute;top:0;right:0;width:20px;height:24px;line-height:24px;text-align:center;font-size:8px;color:#ccc}.zjapp .selected-item-disabled[data-v-d8237c5a]{padding:2px 5px}.zjapp .selected-item-disabled .selected-remove[data-v-d8237c5a]{display:none}.zjapp .item-data[data-v-d8237c5a]{background-color:#fafafa}.zjapp .scroll-wrap[data-v-d8237c5a]{flex:1;background:#fff;height:100%;overflow:auto;transform:translateZ(0)}.zjapp .fixed[data-v-d8237c5a]{position:absolute;top:0;left:0;right:0;background-color:#fff;z-index:4}.zjapp .part-title[data-v-d8237c5a]{padding:9px 15px 5px 15px;line-height:18px;font-size:12px;color:#999;background-color:#f4f4f4}.zjapp .item[data-v-d8237c5a]{align-items:center}.zjapp .item>[class*=icon-checkbox][data-v-d8237c5a]{margin-right:10px}",""])},ca02:function(t,e,i){"use strict";i("f548");var a=i("e2a7"),o={name:"CommentButtonInput",components:{},props:{},data:function(){return{data:"",isFocus:!1}},computed:{inputStatus:function(){var t=this.data,e=this.isFocus,i=t?t.replace(/\s/g,"").length:0;return!e&&i<=0?1:e&&i<=0?2:i>0?3:4}},methods:{onInput:function(t){this.data=this.emojiFilter(t)},postComment:function(){var t=this;if(0!==(this.data?this.data.replace(/\s/g,"").length:0))return new Promise((function(e){t.$emit("onPostComment",t.data,(function(){e()}))}));a.a.alert("请输入评论")},result:function(){this.data="",this.isFocus=!1},onFocus:function(){this.isFocus=!0},onBlur:function(){this.isFocus=!1},emojiFilter:function(t){if("string"!=typeof t)return t;return t.replace(/[^\u4e00-\u9fa5a-zA-Z\d,\.。,，（）();；‘’【】:'"{}\[\]<>《》`·!！？?@#$%^&*-+|=\-\/\ ]+/g,"")}}},n=(i("2f8f"),i("17cc")),s=Object(n.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("app-button-group",{staticClass:"comment-button-input",attrs:{"fixed-bottom":""}},[i("div",{staticClass:"cbi-flex"},[i("van-field",{staticClass:"cbi-field",class:{active:1===t.inputStatus},attrs:{rows:"1",autosize:"",type:"textarea",placeholder:1===t.inputStatus?"发表评论...":"期待您的精彩评论"},on:{input:t.onInput,focus:t.onFocus,blur:t.onBlur},model:{value:t.data,callback:function(e){t.data=e},expression:"data"}},[i("template",{slot:"left-icon"},[i("Icon",{staticClass:"cbi-icon",attrs:{name:"gongchenganli-pinglun"}})],1)],2),i("div",{directives:[{name:"show",rawName:"v-show",value:1!==t.inputStatus,expression:"inputStatus !== 1"}],staticClass:"cbi-right"},[i("app-button",{staticClass:"cbi-button",class:{active:3===t.inputStatus},attrs:{"active-text":""},on:{click:t.postComment}},[t._v("\n        发表\n      ")])],1)],1)])}),[],!1,null,"efd269da",null);e.a=s.exports},ca58:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .use-padding[data-v-75715069]{min-height:50px}.zjapp .ios-bezel-less .button-wrapper[data-v-75715069],.zjapp .ios-bezel-less .use-padding[data-v-75715069]{padding-bottom:39px}.zjapp .button-wrapper[data-v-75715069]{min-height:50px;position:absolute;bottom:0;z-index:99;width:100%}",""])},cb7b:function(t,e,i){var a=i("e97b");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("78e07b9e",a,!0,{sourceMap:!1,shadowMode:!1})},d6e0:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .layout-content /deep/ .scroll-warp-complete:after{display:none}",""])},d9fd:function(t,e,i){"use strict";i("a84d")},dc23:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .icon[data-v-d52b5ec6]{border-radius:50%;overflow:hidden}",""])},de7f:function(t,e,i){"use strict";var a=i("28f8"),o=i("e3ee"),n=(i("cc57"),i("6d57"),i("06a2"),i("e204"),i("e697"),i("6bf2")),s=i.n(n),r=i("6a99"),l=i.n(r),c=i("e2a7"),d=i("162a"),p={name:"ApproveButton",props:{usePadding:{type:Boolean,default:!0},actionConfig:{type:Array,default:function(){return[]}}},data:function(){return{data:""}},methods:{handleTrigger:function(t,e){var i=this.$refs.btn[e];i&&t.async?(i&&i.setActive&&i.setActive(),t.trigger().then((function(t){return i&&i.setNormal&&i.setNormal(),t})).catch((function(){i&&i.setNormal&&i.setNormal()}))):t.trigger()}}},u=(i("975c"),i("bcce"),i("17cc")),f=Object(u.a)(p,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.usePadding?i("div",{staticClass:"use-padding"}):t._e(),i("app-button-group",{staticClass:"button-wrapper",attrs:{"fixed-bottom":""}},t._l(t.actionConfig,(function(e,a){return i("app-button",{key:e.text,ref:"btn",refInFor:!0,attrs:{plain:e.plain},on:{click:function(i){t.handleTrigger(e,a)}}},[t._v("\n      "+t._s(e.text)+"\n    ")])})))],1)}),[],!1,null,"75715069",null).exports,h=i("0c5f").a,m=Object(u.a)(h,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"workflow"},[i("div",{staticClass:"workflow-timeline"},[i("div",{staticClass:"workflow-timeline__icon"},[t.status===t.STATUS.done?i("done-icon"):t._e(),t.status===t.STATUS.close?i("close-icon"):t._e(),t.status!==t.STATUS.progress&&2!==t.status&&1!==t.status&&t.status?t._e():i("waiting-icon",{attrs:{color:1===t.stepType?"#FF8E24":void 0}})],1),i("div",{staticClass:"workflow-timeline__divider",class:{isLast:t.isLast}})]),i("div",{staticClass:"workflow-panel divider"},[i("div",{staticClass:"workflow-panel__hd"},[i("div",{staticClass:"workflow-panel__title"},[t._v("\n          "+t._s(t.title)+"\n        ")]),i("div",{staticClass:"workflow-panel__time"},[t._v("\n          "+t._s(t.time)+"\n        ")])]),t.selected.auditor_name?i("approve-item",{attrs:{"avatar-text":t.selected.avatarText,title:t.selected.auditor_name,description:t.selected.station_name,editabled:t.editabled},on:{click:t.openSelect}}):i("div",{staticClass:"workflow-media workflow-panel__bd",on:{click:t.openSelect}},[i("div",{staticClass:"workflow-media-box workflow-media-box_appmsg"},[i("div",{staticClass:"workflow-media-box__hd"},[i("div",{staticClass:"workflow-media-box__thumb workflow-media-box__thumb_add"},[i("add-icon")],1)]),i("div",{staticClass:"workflow-media-box__bd"},[i("p",{staticClass:"workflow-media-box__desc"},[t._v("\n              请添加人员\n            ")])]),i("span",{staticClass:"workflow-media-box__ft"})])])],1)])])}),[],!1,null,null,null).exports,g=i("7ef3"),b=i("2470"),v=i("4d47"),x=i("329b"),w=i("fe6f"),_={name:"AppUserSelect",data:function(){return{show:!1,right:null,title:"",value:"",maxlength:100,keyboardHeight:0}},computed:{limit:function(){return"".concat(this.maxlength-this.value.length)},limitHeight:function(){return this.keyboardHeight?Object(w.b)()?{bottom:"".concat(this.keyboardHeight+10,"px")}:{top:"94%"}:{}},rows:function(){return this.keyboardHeight?17:void 0}},mounted:function(){var t=this;window.addEventListener("native.keyboardshow",(function(e){t.keyboardHeight=e.keyboardHeight})),window.addEventListener("native.keyboardhide",(function(e){t.keyboardHeight=0}))},methods:{openPopup:function(t){var e=this;this.value="",this.show=!0,this.title=t.title,this.right=t.right,this.onConfirm=function(){return t.onConfirm(e.value)},this.$emit("open")},onConfirm:function(){console.log("123?")},closeEvent:function(){this.closePopup()},closePopup:function(){this.show=!1,this.$emit("close")}}},y=(i("8cfe"),Object(u.a)(_,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{attrs:{title:t.title,mode:"dialog","on-close":t.closeEvent}},[t.right?i("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:t.onConfirm},slot:"header-bar-right"},[t._v("\n      "+t._s(t.right)+"\n    ")]):t._e(),i("div",{staticClass:"test"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"fieldTextarea",style:{height:"calc(100% - "+(t.keyboardHeight||0)+"px)"},attrs:{maxlength:"100",placeholder:"请输入拒绝原因（必填，最多100个字符）"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),i("div",{staticClass:"limit",style:t.limitHeight},[t._v(t._s(t.limit))])])]):t._e()],1)}),[],!1,null,"02b6192e",null).exports),k=!1;k||(k=new(x.default.extend(y))({el:document.createElement("div")}),document.body.appendChild(k.$el));var j=k,C=i("7e8b"),z="project_highlight";function S(t){return"Auto"===t.stepAttrs.archived_mode}var A={name:"Workflow",components:{ApproverButton:f,UserSelect:m,closeIcon:g.a,doneIcon:b.a,waitingIcon:v.a},props:{businessId:{type:String,default:""},isAnchorNode:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},data:function(){return{data:"",actionConfig:[],popupConfig:{},init:!1,unknownError:!1,formCheck:!1,reinspect_set:[],actuals:[],flowTemplate:null,flowInstance:null,STATUS:C.b,STATUS_WORDING:C.c}},computed:{reason:function(){try{return this.actuals.find((function(t){return-1===t.status})).nodes[0].opinion}catch(t){return""}},endIndex:function(){try{return this.reason?this.actuals.findIndex((function(t){return-1===t.status})):this.actuals.length}catch(t){return""}}},mounted:function(){this.reload()},methods:{reset:function(){this.init=!1,this.actuals=[],this.actionConfig=[],this.reinspect_set=[],this.flowTemplate=null,this.flowInstance=null},reload:function(){var t=this;Promise.all([this.getDetail()]).then((function(){t.unknownError=!1,t.init=!0,t.$emit("loaded")})).catch((function(e){t.init=!0,t.unknownError=!0,t.$emit("error",e)}))},pass:function(){var t=this,e=this.flowInstance.ProcessInstance,i={flow_id:e.flow_id,business_id:e.business_id,proc_id:e.id,title:e.name,opinion:" "};d.a.post("/workflow/approval",null,{module:z,action:"pass",flowData:i}).then((function(e){t.$emit("afterApproval",e)})).catch(c.a.alert)},addSubmit:function(){var t=this;return new Promise((function(e,i){t.$emit("beforeAddSubmit",null,(function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a.length){var s=Object(o.a)(a,1),r=s[0];return i(r),c.a.alert(r)}var p=l()(t.actuals),u=!1,f=p.map((function(t){return t.selected||(u=!0),S(t)?t.nodes=[]:t.nodes=[t.selected],delete t.selected,t}));if(u){var h="有未选择的岗位哟";return i(h),c.a.alert(h)}var m={flow_id:t.flowTemplate.flow_id,business_id:t.businessId,title:n.title,actuals:f};n.id=t.businessId,d.a.post("/workflow/initiate",null,{module:z,postData:n,flowData:m}).then((function(i){e(i),t.$emit("afterAddSubmit",i)})).catch((function(t){i(t),c.a.alert(t)}))}))}))},cancel:function(){var t=this;j.openPopup({show:!0,title:"拒绝原因",right:"确定",onConfirm:function(e){if(!e)return c.a.alert("拒绝原因必须填写");var i=t.flowInstance.ProcessInstance,a={flow_id:i.flow_id,business_id:i.business_id,proc_id:i.id,title:i.name,opinion:e};d.a.post("/workflow/approval",null,{module:z,action:"cancel",flowData:a}).then((function(t){return j.closePopup(),Promise.resolve(t)})).catch(c.a.alert)},onClose:function(){}})},reject:function(){},terminate:function(){var t=this;j.openPopup({show:!0,title:"拒绝原因",right:"确定",onConfirm:function(e){if(!e)return c.a.alert("拒绝原因必须填写");var i=t.flowInstance.ProcessInstance,a={flow_id:i.flow_id,business_id:i.business_id,proc_id:i.id,title:i.name,opinion:e};d.a.post("/workflow/approval",null,{module:z,action:"terminate",flowData:a}).then((function(e){j.closePopup(),t.reload(),t.$emit("afterTerminate",e)})).catch(c.a.alert)},onClose:function(){}})},book:function(){var t=this;return new Promise((function(e,i){var a=t.flowInstance.ProcessInstance,o={flow_id:a.flow_id,business_id:a.business_id,proc_id:a.id,title:a.name,opinion:" "};d.a.post("/workflow/approval",null,{module:z,action:"book",flowData:o}).then((function(i){t.reload(),t.$emit("afterBook",i),e(i)})).catch((function(t){i(t),c.a.alert(t)}))}))},adapterUser:function(t){var e=l()(t),i=this.isAnchorNode;return e.map((function(t,e){return S(t)?(t.name="完成发布",t.selected={avatarText:"系统",auditor_name:"系统自动发布案例",station_name:""}):0!==t.needChoose&&!i&&e||(t.selected=t.nodes[0]),t.ended_time&&(t.ended_time=s()(t.ended_time).format("YYYY-MM-DD HH:mm")),t}))},adapterButtonList:function(t){var e,i="terminate",o="initiate",n="pass",s="reject",r="book",l=(e={},Object(a.a)(e,o,this.addSubmit),Object(a.a)(e,n,this.pass),Object(a.a)(e,s,this.terminate),Object(a.a)(e,i,this.terminate),Object(a.a)(e,r,this.book),e),c=[{code:o,text:"提交",plain:!1,trigger:l.initiate,active:!1,async:!0},{code:i,text:"不通过",plain:!0,trigger:l.terminate,active:!1,async:!1},{code:s,text:"不通过",plain:!0,trigger:l.reject,active:!1,async:!1},{code:r,text:"通过",plain:!1,trigger:l.book,active:!1,async:!0},{code:n,text:"通过",plain:!1,trigger:l.pass,active:!1,async:!0}];return t.forEach((function(t){var e=c.find((function(e){return e.code===t.code}));e&&(e.active=!0)})),c.filter((function(t){return t.active})).map((function(t){return t}))},selectReinspect:function(t,e){this.$set(this.actuals[e],"selected",t)},getDetail:function(){var t=this,e=this.businessId;return this.isAnchorNode?d.a.post("/workflow/get-flow-instance",null,{business_id:e,module:z}).then((function(e){t.flowInstance=l()(e),t.actuals=t.adapterUser(e.actuals),t.actionConfig=t.adapterButtonList(e.button_list)})):d.a.post("/workflow/get-flow-template",null,{business_id:e,module:z}).then((function(e){t.flowTemplate=l()(e),t.actuals=t.adapterUser(e.actuals),t.actionConfig=t.adapterButtonList(e.button_list)}))}}},D=(i("abe7"),Object(u.a)(A,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("header",{staticClass:"head"},[t._v("审批流程")]),t.init?t._e():i("div",{staticClass:"loading__box"},[i("loading-status",{attrs:{"is-empty":!0,"empty-text":"数据加载中","show-style":"search"}})],1),t._l(t.actuals,(function(e,a){return i("div",{key:e.id},[a<=t.endIndex?i("user-select",{attrs:{title:e.name,"is-last":a===t.actuals.length-1,time:e.ended_time,editabled:!!e.needChoose&&(!t.isAnchorNode||t.isEdit),user:e.selected,options:e.nodes,status:e.status,"step-type":e.step_type,memory:!1,"form-check":t.formCheck},on:{onSelect:function(e){return t.selectReinspect(e,a)}}}):t._e()],1)})),t.reason?i("div",{staticClass:"feedback-reason"},[t._v("\n    拒绝原因："+t._s(t.reason)+"\n  ")]):t._e(),t.init?i("div",{staticClass:"loading__box"},[i("loading-status",{attrs:{"is-empty":t.unknownError,"empty-text":"暂无数据，请联系管理员","show-style":"search"}})],1):t._e(),t.actionConfig.length?i("approver-button",{attrs:{"action-config":t.actionConfig}}):i("div",{staticStyle:{"padding-bottom":"40px"}})],2)}),[],!1,null,null,null));e.a=D.exports},e02a:function(t,e,i){var a=i("78b5");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("f41360a0",a,!0,{sourceMap:!1,shadowMode:!1})},e5d4:function(t,e,i){var a=i("0f6f");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("646594b2",a,!0,{sourceMap:!1,shadowMode:!1})},e89f:function(t,e,i){"use strict";var a=i("04f3"),o=i("cf09"),n=i("4360"),s=0;e.a={name:"PopupMixin",data:function(){return{backButtonEvent:null}},watch:{show:function(t){var e=this;if(t){if(this.$nextTick((function(){e.$el&&e.$el.style&&(e.$el.style.zIndex=++o.a.zIndex,s++,n.a.commit("app/SET_HAS_POPUP",!!s))})),!this.backButtonEvent){var i=this.close||this.closePopup;this.backButtonEvent=Object(a.a)(i)}}else--s<0&&(s=0),n.a.commit("app/SET_HAS_POPUP",!!s),this.backButtonEvent&&(Object(a.c)(this.backButtonEvent),this.backButtonEvent=null)}},methods:{}}},e97b:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .workflow{display:flex;margin-bottom:10px}.zjapp .workflow-timeline{margin-left:16px;padding-top:9px;display:flex;align-items:center;flex-direction:column}.zjapp .workflow-timeline__icon{width:14px;height:14px}.zjapp .workflow-timeline__icon img{width:100%;height:100%}.zjapp .workflow-timeline__divider{width:1px;transform:scaleX(.5);height:100%;background:#dcdfe6;margin-top:10px}.zjapp .workflow-timeline__divider.isLast{background:transparent}.zjapp .workflow-media{flex:1}.zjapp .workflow-media-box{padding:10px 20px 10px 14px;position:relative}.zjapp .workflow-media-box_appmsg{display:flex;align-items:center}.zjapp .workflow-media-box__hd{margin-right:10px;text-align:center;color:#fff;font-size:16px}.zjapp .workflow-media-box__thumb{width:46px;height:46px;line-height:46px;vertical-align:top;background-color:#4275e8;border-radius:50%;overflow:hidden}.zjapp .workflow-media-box__thumb_add{overflow:hidden;display:flex;justify-content:center;align-items:center;background-color:#fff;background-color:transparent;color:#ccc}.zjapp .workflow-media-box__bd{flex:1;min-width:0}.zjapp .workflow-media-box__ft{padding-right:22px;position:relative;text-align:right;color:rgba(0,0,0,.5)}.zjapp .workflow-media-box__ft:after{content:\" \";width:12px;height:24px;-webkit-mask-position:0 0;mask-position:0 0;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100%;mask-size:100%;background-color:#c8c8c8;color:rgba(0,0,0,.3);color:var(--weui-FG-2);-webkit-mask-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='12' height='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M2.454 6.58l1.06-1.06 5.78 5.779a.996.996 0 010 1.413l-5.78 5.779-1.06-1.061 5.425-5.425-5.425-5.424z' fill='%23B2B2B2' fill-rule='evenodd'/%3E%3C/svg%3E\");mask-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='12' height='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M2.454 6.58l1.06-1.06 5.78 5.779a.996.996 0 010 1.413l-5.78 5.779-1.06-1.061 5.425-5.425-5.425-5.424z' fill='%23B2B2B2' fill-rule='evenodd'/%3E%3C/svg%3E\");position:absolute;top:50%;right:0;margin-top:-12px}.zjapp .workflow-media-box__title{font-weight:600;font-size:17px;color:#333;width:auto;-webkit-line-clamp:1}.zjapp .workflow-media-box__desc,.zjapp .workflow-media-box__title{line-height:1.4;overflow:hidden;word-wrap:normal;word-wrap:break-word;word-break:break-all;margin:0;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical}.zjapp .workflow-media-box__desc{color:#666;font-size:14px;padding-top:4px;-webkit-line-clamp:2}.zjapp .workflow-panel{flex:1;display:flex;flex-direction:column;background-color:#fafafa;margin-left:14px;position:relative;margin-right:15px}.zjapp .workflow-panel.divider:before{content:\"\";position:absolute;top:7px;left:-20px;border:10px solid transparent;border-right-color:#fafafa}.zjapp .workflow-panel__hd{display:flex;padding:10px 15px 0;justify-content:space-between}.zjapp .workflow-panel__title{color:#666}.zjapp .workflow-panel__time{color:#999}.zjapp .ios-bezel-less .container{padding-bottom:39px}.zjapp .container{background:#fff}.zjapp .container .loading__box{margin-top:50px;margin-bottom:50px}.zjapp .container .head{padding:12px 15px 0;color:#333;font-size:16px;line-height:22px;margin-bottom:16px}.zjapp .container .feedback-reason{background:#fafafa;border-radius:4px;padding:10px 12px;color:#999;margin:0 15px 20px 42px}.zjapp .container a.weui-media-box{color:#000;-webkit-tap-highlight-color:rgba(0,0,0,0)}",""])},ebc7:function(t,e,i){var a=i("dc23");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("1123be28",a,!0,{sourceMap:!1,shadowMode:!1})},f36f:function(t,e,i){var a=i("a74b");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("1b5c3162",a,!0,{sourceMap:!1,shadowMode:!1})},f4da:function(t,e,i){var a=i("2e96");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("dfe0c42a",a,!0,{sourceMap:!1,shadowMode:!1})},f553:function(t,e,i){var a=i("94a7");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("02394208",a,!0,{sourceMap:!1,shadowMode:!1})},ffe8:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .icon[data-v-e26d53fc]{border-radius:50%;overflow:hidden}",""])}}]);