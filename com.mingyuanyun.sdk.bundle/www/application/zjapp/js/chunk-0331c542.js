(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-0331c542","chunk-2d2263f6"],{"0c52":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .app-stepper[data-v-03df57b7]{display:inline-block;width:110px;height:34px;margin:-2px 0;white-space:nowrap;font-size:0;line-height:0;vertical-align:top}.zjapp .app-stepper .number-input[data-v-03df57b7]{width:51px;height:34px;border:1px solid #dcdcdc;border-radius:0;font-size:14px;text-align:center;background-color:#fff;color:#111;box-sizing:border-box}.zjapp .app-stepper .number-input-focus[data-v-03df57b7]{border-color:#4275e8}.zjapp .btn-add[data-v-03df57b7],.zjapp .btn-minus[data-v-03df57b7]{display:inline-block;width:28px;height:34px;line-height:34px;padding:0;border:1px solid #dcdcdc;color:#666;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:border-box;background-color:#fff}.zjapp .btn-minus[data-v-03df57b7]{border-right:none;border-radius:4px 0 0 4px}.zjapp .btn-add[data-v-03df57b7]{border-left:none;border-radius:0 4px 4px 0}.zjapp .icon-add[data-v-03df57b7],.zjapp .icon-minus[data-v-03df57b7]{font-size:11px;vertical-align:top;display:inline-block;margin-top:10.5px}.zjapp .disabled[data-v-03df57b7]{color:#c8c8c8}.zjapp .activing[data-v-03df57b7]{color:#4275e8}",""])},"0f7b":function(t,e,i){"use strict";i("f548"),i("163d");var n,a,o={name:"AppStepper",components:{NumberInput:i("6948").a},props:{value:{type:[String,Number],default:""},max:{type:[String,Number],default:200},range:{type:Array}},data:function(){return{addActiving:!1,minusActiving:!1}},computed:{rangeMin:function(){return this.range&&this.range[0]||0},rangeMax:function(){return this.range&&this.range[1]?this.range[1]:this.max},allowAdd:function(){return""!==this.value&&this.value<this.rangeMax},allowMinus:function(){return""!==this.value&&this.value>this.rangeMin}},methods:{onChange:function(t){t&&(t=String(t).replace(/\D/g,"")),parseInt(t,10)>parseInt(this.max,10)&&(t=this.max),this.$emit("input",Number(t)),this.$emit("change",Number(t))},add:function(){if(this.allowAdd){var t=parseInt(this.value,10)+1;this.isInRange(t)&&(this.$emit("input",t),this.$emit("change",t)),this.setActiving("add")}},minus:function(){if(this.allowMinus){var t=parseInt(this.value,10)-1;this.isInRange(t)&&(this.$emit("input",t),this.$emit("change",t)),this.setActiving("minus")}},isInRange:function(t){return t>=this.rangeMin&&t<=this.rangeMax},setActiving:function(t){var e=this;t&&("minus"===t?(this.minusActiving=!0,clearTimeout(a),a=setTimeout((function(){e.minusActiving=!1}),300)):(this.addActiving=!0,clearTimeout(n),n=setTimeout((function(){e.addActiving=!1}),300)))}}},s=(i("91cb"),i("17cc")),r=Object(s.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-stepper"},[i("button",{staticClass:"btn-minus",class:{disabled:!t.allowMinus,activing:t.minusActiving},on:{click:t.minus}},[i("icon",{attrs:{name:"minus"}})],1),i("number-input",{attrs:{value:t.value,type:"int",range:t.range},on:{input:t.onChange}}),i("button",{staticClass:"btn-add",class:{disabled:!t.allowAdd,activing:t.addActiving},on:{click:t.add}},[i("icon",{attrs:{name:"add"}})],1)],1)}),[],!1,null,"03df57b7",null);e.a=r.exports},"16ff":function(t,e,i){var n=i("39e4");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("801e728a",n,!0,{sourceMap:!1,shadowMode:!1})},2699:function(t,e,i){"use strict";(function(t){i("5ab2"),i("e10e"),i("f548");var n=i("28f8"),a=(i("6d57"),i("06a2"),i("cc57"),i("e204"),i("e697"),i("774b")),o=i("07d2"),s=i("5a71"),r=i("9baf"),c=i("0f7b"),l=i("e68e"),u=i("3c64"),d=i("46ae"),p=i("5ff0"),h=i("3122"),m=i("7bac"),f=i("ed08"),g=i("e2a7"),v=i("3bd5"),b=i("162a"),x=i("1b7e"),y=i("6bf2"),w=i.n(y),k=i("7cb8"),S=i("6f9e");function _(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}e.a={name:"MeetingIndex",components:{Scroller:a.default,Item:o.default,SingleSelect:s.default,DateSelect:r.a,AppStepper:c.a,ItemImgList:l.a,ItemTextarea:u.a,SlideUpSelect:d.a},data:function(){return{id:"",pageTitle:"",isLoading:!0,contractorMemory:!0,contractorOptions:[],teamOptions:[{id:"模板班",name:"模板班"},{id:"钢筋班",name:"钢筋班"},{id:"混凝土班",name:"混凝土班"},{id:"架子班",name:"架子班"},{id:"砌筑班",name:"砌筑班"},{id:"抹灰班",name:"抹灰班"},{id:"木工班",name:"木工班"},{id:"消防班",name:"消防班"},{id:"桩基班",name:"桩基班"},{id:"幕墙班",name:"幕墙班"},{id:"防水班",name:"防水班"},{id:"水电班",name:"水电班"},{id:"杂工班",name:"杂工班"},{id:"门窗班",name:"门窗班"},{id:"地坪班",name:"地坪班"},{id:"其他",name:"其他"}],contractor:{},date:"",dateMax:"",teams:[{team:{},workers:0}],images:[],remark:"",createdOn:"",creator:""}},computed:{projId:function(){return this.$store.state.global.currentProject.id},draftDataKey:function(){return"module-meeting-data-list-"+this.$store.state.global.currentProject.id}},activated:function(){this.id=this.$route.query.id,this.pageTitle=this.id?"编辑安全晨会纪要":"新增安全晨会纪要",this.init()},methods:{init:function(){var e,i=this;return this.isLoading=!0,this.dateMax=w()().hours(23).minutes(59).toDate(),this.id?(this.contractorMemory=!1,e=m.a.getUserKey(this.draftDataKey).then((function(e){e=e||[];var n=t.find(e,{id:i.id});n&&(i.contractor=n.contractor,i.date=n.date,i.teams=n.teams,i.images=n.images,i.remark=n.remark,i.createdOn=n.createdOn,i.creator=n.creator)}))):(this.contractorMemory=!0,this.contractor={},this.date="",this.teams=[{team:{},workers:0}],this.images=[],this.remark="",this.createdOn="",this.creator="",e=Promise.resolve()),e.then((function(){p.a.getProjectContractorList(i.projId).then((function(t){i.contractorOptions=t,i.isLoading=!1}))}))},addTeam:function(){this.teams.push({team:{},workers:0}),this.save()},removeTeam:function(t){this.teams.length>1&&!isNaN(t)&&this.teams.splice(t,1),this.save()},getMeetingData:function(){return{id:this.id,contractor:this.contractor,date:this.date,teams:this.teams,images:this.images,remark:this.remark,createdOn:this.createdOn,creator:this.creator}},save:function(){var e=this;return m.a.getUserKey(this.draftDataKey).then((function(i){i=i||[];var n=e.getMeetingData();if(!n.id){var a=v.a.getUser();n.id=f.a.uuid(),n.createdOn=f.a.now(),n.creator={id:a.user_id,name:a.user_name},e.id=n.id,e.createdOn=n.createdOn,e.creator=n.creator}var o=t.findIndex(i,{id:n.id});o<0?i.push(n):i.splice(o,1,n),m.a.setUserKey(e.draftDataKey,i),S.a.$emit("module-meeting-has-draft-change")}))},saveAndBack:function(){var t=this;return this.save().then((function(){return g.a.alert("保存成功").then((function(){if("MeetingEdit"===t.$router.history.current.name)return t.$router.go(-1)}))}))},remove:function(){var t=this;g.a.popBox({title:"确定删除吗？",cancelText:"取消",okText:"删除"}).then((function(e){e&&t.deleteData(t.id).then((function(){S.a.$emit("module-meeting-has-draft-change"),t.$router.go(-1)})).catch((function(t){console.errot(t)}))}))},deleteData:function(e){var i=this;return m.a.getUserKey(this.draftDataKey).then((function(n){n=n||[];var a=t.findIndex(n,{id:e});return a>=0&&n.splice(a,1),m.a.setUserKey(i.draftDataKey,n)}))},checkData:function(){if(t.isEmpty(this.contractor))return g.a.alert("请选择施工单位"),!1;if(t.isEmpty(this.date))return g.a.alert("请选择晨会时间"),!1;var e=t.some(this.teams,(function(e){return t.isEmpty(e.team)})),i=t.some(this.teams,(function(t){return!t.workers}));return e?(g.a.alert("请选择班组"),!1):i?(g.a.alert("请输入参会人数"),!1):t.isEmpty(this.images)?(g.a.alert("请拍摄现场照片"),!1):void 0},uploadImages:function(){var e=[];return t.each(this.images,(function(t){!t.url&&t.temp&&e.push(h.a.uploadImage(t.temp).then((function(e){t.url=e}))),!t.videoUrl&&t.videoTemp&&e.push(h.a.uploadImage(t.videoTemp).then((function(e){t.videoUrl=e})))})),Promise.all(e)},submit:function(){var e=this;if(!1!==this.checkData())return x.a.getHasNetwork().then((function(t){if(!t)return Promise.reject({errmsg:"当前无网络连接"})})).then((function(){return g.a.loading("正在提交..."),e.uploadImages()})).then((function(){var i=Object(k.o)(t.map(e.images,(function(t){var e=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},t);return delete e.thumbnail,delete e.temp,delete e.videoTemp,e}))),a={proj_id:e.projId,construction_unit_id:e.contractor.id,remark:e.remark,image_files:i,register_by:e.creator.id,meeting_at:e.date,groups:Object(k.o)(t.map(e.teams,(function(t){return{name:t.team.id,num:t.workers}})))};return b.a.post("/online/safety-party/add",{},a).then((function(t){return g.a.alert("提交成功").then((function(){return!0===window.__YL_SUPER_APP__?window.zj.closeRouteChangeTransition=!0:window.closeRouteChangeTransition=!0,e.$router.replace({name:"MeetingDetail",query:{id:t.id}})}))})).then((function(){g.a.hideLoading(),e.deleteData(e.id),S.a.$emit("module-meeting-has-draft-change"),S.a.$emit("module-meeting-has-new-submitted")}))})).catch((function(t){g.a.hideLoading(),g.a.alert(t.errmsg||"提交失败"),console.error(t)}))}}}}).call(this,i("391c"))},"2c76":function(t,e,i){"use strict";i("c070")},"30c7":function(t,e,i){"use strict";i("69c5")},"38a7":function(t,e,i){"use strict";i("16ff")},"39e4":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .content[data-v-73ce749f]{display:flex;flex-direction:column;justify-content:flex-end;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}",""])},"3c64":function(t,e,i){"use strict";i("163d");var n={name:"ItemTextarea",components:{},props:{value:{type:String,default:""},placeholder:{type:String,default:""},maxlength:{type:Number,default:200},borderBottom:{type:Boolean,default:!0}},data:function(){return{textareaHeight:40,isLock:!1,blurTime:null}},computed:{lastLength:function(){var t=this.value&&this.value.length||0,e=this.maxlength-t;return e>0?e:0}},mounted:function(){var t=this;this.$nextTick((function(){t.textareaHeight=t.$refs.rule&&t.$refs.rule.offsetHeight||40}))},methods:{onfocus:function(){var t=(new Date).getTime();this.blurTime&&t-this.blurTime<300&&window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(this.$refs.input.blur(),window.cordova.plugins.Keyboard.close()),this.blurTime=null,this.$emit("focus")},onblur:function(){this.blurTime=(new Date).getTime(),this.$emit("blur")},setStatus:function(t){console.log(t),this.isLock=t},oninput:function(t){var e=this;setTimeout((function(){if(!e.isLock){var i=t.target.value;i.length>e.maxlength&&(i=i.substring(0,e.maxlength),e.$refs.input.value=i),e.$refs.rule.innerText=i,e.textareaHeight=e.$refs.rule&&e.$refs.rule.offsetHeight+20,e.$emit("input",i),e.$emit("change",i)}}),0)}}},a=(i("2c76"),i("17cc")),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-textarea",class:{"border-bottom":t.borderBottom}},[i("div",{staticClass:"item-textarea-content"},[i("textarea",{ref:"input",style:{height:t.textareaHeight+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.value},on:{focus:t.onfocus,blur:t.onblur,compositionstart:function(e){t.setStatus(!0)},compositionend:function(e){t.setStatus(!1)},input:t.oninput}}),i("div",{ref:"rule",staticClass:"rule"},[t._v("\n      "+t._s(t.value)+"\n    ")]),t.maxlength!==1/0?i("p",{staticClass:"counter"},[t._v("\n      "+t._s(t.lastLength)+"\n    ")]):t._e()])])}),[],!1,null,null,null);e.a=o.exports},"46ae":function(t,e,i){"use strict";var n=i("e1e7").a,a=i("17cc"),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("item",{attrs:{label:t.title,text:t.text,mode:t.mode,editabled:t.editabled,placeholder:t.placeholder},on:{click:t.openSelect}},[t.$slots.right?t._t("right",null,{slot:"right"}):t._e()],2)}),[],!1,null,null,null);e.a=o.exports},"4e8c":function(t,e,i){"use strict";var n=i("329b"),a=i("b056").a,o=(i("30c7"),i("17cc")),s=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePopup(e)}}},[i("transition",{attrs:{name:"slide-up"},on:{enter:function(e){t.isOpening=!0},"after-enter":function(e){t.isOpening=!1},leave:function(e){t.isClosing=!0},"after-leave":t.afterClose}},[t.showList?i("div",{staticClass:"box",style:{height:t.listHeight+"px"}},[t.allowSearching?t._e():i("div",{staticClass:"hd border-bottom"},[t._v("\n        "+t._s(t.title)+"\n        "),i("icon",{attrs:{name:"unqualified"},on:{click:t.closePopup}})],1),t.allowSearch?i("app-search-bar",{ref:"app-search-bar-checkitem-select",staticClass:"bg-white",attrs:{"history-key":t.historyKey},on:{changeSearchStatus:t.setSearchMode},model:{value:t.searchKeyword,callback:function(e){t.searchKeyword=e},expression:"searchKeyword"}}):t._e(),t.renderData&&t.renderData.length?i("scroller",{ref:"scroller",attrs:{"has-next":t.hasNextPage},on:{loadNext:t.loadNext}},[i("div",{attrs:{id:"slideUpSelectDialog"}},t._l(t.renderData,(function(e){return i("item",{key:e.id,attrs:{"icon-right":e.id===t.selected.id?"qualified":"",border:"bottom"},on:{click:function(i){t.select(e)}}},[t.showNote?[i("div",{staticClass:"item-con"},[i("p",{staticClass:"text"},[t._v(t._s(e.name))]),i("p",{staticClass:"note"},[t._v(t._s(e[t.showNote]))])])]:i("div",{staticClass:"item-text",domProps:{innerHTML:t._s(t.keywordFilter(e.name))}})],2)})))]):t._e(),i("loading-status",{attrs:{"is-empty":!t.options||!t.options.length,type:"search","empty-text":t.emptyText}},[t.allowSearching&&t.allowSearch?i("template",{slot:"empty-text"},[t._v("\n          未搜索到包含"),i("span",{staticClass:"color-blue"},[t._v(t._s(t.searchKeyword))]),t._v("的结果\n        ")]):t._e()],2)],1):t._e()])],1):t._e()}),[],!1,null,"c4404120",null).exports,r=!1;r||(r=new(n.default.extend(s))({el:document.createElement("div")}),document.body.appendChild(r.$el));e.a=r},"574c":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .item-textarea{background-color:#fff;padding:5px 15px}.zjapp .item-textarea-content{position:relative}.zjapp .item-textarea .rule,.zjapp .item-textarea textarea{width:100%;min-height:40px;line-height:20px;font-size:16px;padding:0;border:none}.zjapp .item-textarea .rule{position:absolute;top:0;left:0;visibility:hidden;word-break:break-all}.zjapp .item-textarea .counter{text-align:right;margin:0 0 -5px 0;height:15px;line-height:15px;color:#b2b2b2;font-size:12px}",""])},"69c5":function(t,e,i){var n=i("7d2b");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("172b2e44",n,!0,{sourceMap:!1,shadowMode:!1})},"7cb3":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .team-group[data-v-390ba8a9]{position:relative;padding-left:48px;margin-top:10px;background-color:#fff}.zjapp .team-group .item[data-v-390ba8a9]{padding-left:0}.zjapp .team-group .icon-remove[data-v-390ba8a9]{position:absolute;left:15px;top:37px;font-size:18px}.zjapp .team-group .icon-remove[data-v-390ba8a9]:after{content:"";position:absolute;width:36px;height:36px;top:-9px;left:-9px}',""])},"7d2b":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .content[data-v-c4404120]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-c4404120]{position:absolute;left:0;bottom:0;width:100%;flex-direction:column}.zjapp .box[data-v-c4404120],.zjapp .list-wrap[data-v-c4404120]{display:flex;background-color:#fff}.zjapp .list-wrap[data-v-c4404120]{flex-direction:row;align-items:flex-start;flex:1;height:465px}.zjapp #slideUpSelectDialog[data-v-c4404120]{padding:0 15px 0}.zjapp .hd[data-v-c4404120]{position:relative;padding:10px 45px;height:44px;line-height:22px;font-size:16px;color:#666;text-align:center;background-color:#fff}.zjapp .hd .icon-unqualified[data-v-c4404120]{position:absolute;width:44px;height:44px;top:0;right:0;line-height:44px;font-size:14px;text-align:center;color:#999}.zjapp .item[data-v-c4404120]{padding-left:0;padding-right:0}.zjapp .text[data-v-c4404120]{font-size:14px;line-height:20px;color:#333}.zjapp .note[data-v-c4404120]{font-size:12px;line-height:18px;color:#999}[data-v-c4404120] .icon-qualified{width:34px;height:34px;line-height:34px;text-align:center;color:#4275e8}",""])},"7f14":function(t,e,i){"use strict";i("fd58")},8474:function(t,e,i){"use strict";var n=i("329b"),a=(i("ed6c"),i("591c")),o=i("e89f"),s=i("4360"),r={name:"DateSelectDialog",components:{DatetimePicker:a.a},mixins:[o.a],store:s.a,data:function(){return{show:!1,showCon:!1,date:"",type:"",min:"",max:"",confirmFn:function(){}}},watch:{show:function(t){var e=this;t&&this.$nextTick((function(){e.showCon=!0}))}},methods:{open:function(t){this.date=t.date,this.type=t.type||"datetime",this.min=t.min||void 0,this.max=t.max||void 0,this.confirmFn=t.onConfirm,this.show=!0},close:function(){this.showCon=!1},afterClose:function(){this.show=!1},onConfirm:function(t){this.confirmFn&&this.confirmFn(t),this.close()},onCancel:function(t){this.close()}}},c=(i("38a7"),i("17cc")),l=Object(c.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.close(e)}}},[i("transition",{attrs:{name:"slide-up"},on:{"after-leave":t.afterClose}},[t.showCon?i("van-datetime-picker",{attrs:{type:t.type,"min-date":t.min,"max-date":t.max},on:{confirm:t.onConfirm,cancel:t.onCancel},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}):t._e()],1)],1):t._e()}),[],!1,null,"73ce749f",null).exports,u=!1;u||(u=new(n.default.extend(l))({el:document.createElement("div")}),document.body.appendChild(u.$el));e.a=u},"91cb":function(t,e,i){"use strict";i("c82d")},"9baf":function(t,e,i){"use strict";var n=i("8474"),a=i("07d2"),o=i("6bf2"),s=i.n(o),r={name:"CheckitemSelect",components:{Item:a.default},props:{label:{type:String,default:""},mode:{type:String,default:"edit"},value:{type:String,default:""},text:{type:String,default:""},placeholder:{type:String,default:"请选择"},format:{type:String,default:"YYYY-MM-DD"},editabled:{type:Boolean,default:!0},min:{type:Date},max:{type:Date},type:{type:String,default:""},formCheck:{type:Boolean,default:!1}},data:function(){return{}},computed:{showText:function(){return this.text?this.text:this.value?s()(this.value).format(this.format):""}},methods:{open:function(){var t=this;n.a.open({date:this.value?s()(this.value).toDate():new Date,min:this.min,max:this.max,type:this.type,onConfirm:function(e){var i=s()(e).format("YYYY-MM-DD HH:mm:ss");t.$emit("input",i),t.$emit("change",i)}})},close:function(){n.a.close()}}},c=i("17cc"),l=Object(c.a)(r,(function(){var t=this.$createElement;return(this._self._c||t)("item",{attrs:{label:this.label,text:this.showText,mode:this.mode,placeholder:this.placeholder,editabled:!0,"form-check":this.formCheck},on:{click:this.open}})}),[],!1,null,null,null);e.a=l.exports},b056:function(t,e,i){"use strict";(function(t){i("f548"),i("cc57"),i("9dd9");var n,a=i("07d2"),o=i("6f9e"),s=i("e89f"),r=i("9eea"),c=i("774b");e.a={name:"SlideUpSelectDialog",components:{Item:a.default,appSearchBar:r.default,Scroller:c.default},mixins:[s.a],data:function(){return{show:!1,showList:!1,isOpening:!1,isClosing:!1,title:"",selected:{},options:[],showNote:"",emptyText:"",initHeight:null,listHeight:null,componentUid:"",searchKeyword:"",allowSearch:!1,allowSearching:!1,timer:null,historyKey:null,searchOptions:[],listLimit:100,listLimitSize:100}},computed:{renderData:function(){var t=this.options;return t&&t.length>this.listLimit?t.slice(0,this.listLimit):t||[]},hasNextPage:function(){return this.options&&this.options.length>this.listLimit}},watch:{searchKeyword:function(e){var i=this;this.$nextTick((function(){i.options=e?i.fitlerByKeyword(t.cloneDeep(i.searchOptions),e):t.cloneDeep(i.searchOptions)}))},show:function(t){var e=this;t&&this.$nextTick((function(){e.showList=!0}))},showList:function(t){t&&this.scrollToSelect()}},created:function(){o.a.$on("routerBeforeEach",this.closePopup),o.a.$on("pageContentClick",this.closePopup),window.addEventListener("native.keyboardshow",this.onResize,!1),window.addEventListener("native.keyboardhide",this.onResize,!1)},destroyed:function(){o.a.$off("routerBeforeEach",this.closePopup),o.a.$off("pageContentClick",this.closePopup)},methods:{openPopup:function(e){this.componentUid=e.componentUid||"",this.title="选择"+e.title,this.options=e.options,this.searchOptions=t.cloneDeep(e.options),this.selected=t.clone(e.selected),this.showNote=e.showNote,this.emptyText=e.emptyText,this.allowSearch=e.allowSearch,this.initHeight=e.initHeight,this.historyKey=e.historyKey,n=e.callback,this.show=!0,this.onResize(),this.clearScrollToTimeout()},closePopup:function(){var t=this;if(!this.isOpening)return this.showList=!1,this.clearScrollToTimeout(),this.cloneSearch(),new Promise((function(e){t.$on("afterClosePopup",e)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},select:function(t){n(t),this.saveHistory(),this.closePopup()},scrollToSelect:function(){var t=this;this.$nextTick((function(){t.timer=window.setTimeout((function(){var e=document.querySelector("#slideUpSelectDialog .item .item-icon-right");e&&e.scrollIntoViewIfNeeded({block:"start",behavior:"smooth"}),t.clearScrollToTimeout()}),400)}))},clearScrollToTimeout:function(){clearTimeout(this.timer),this.timer=null},cloneSearch:function(){this.options=t.cloneDeep(this.searchOptions),this.searchKeyword="",this.$refs["app-search-bar-checkitem-select"]&&this.$refs["app-search-bar-checkitem-select"].cancelSearch()},saveHistory:function(){this.$refs["app-search-bar-checkitem-select"]&&this.$refs["app-search-bar-checkitem-select"].saveHistory()},setSearchMode:function(t){this.allowSearching=t,this.onResize()},onResize:function(e){var i=null,n=window.innerHeight;n-=$rootScope.viewSize.headerHeight-44,i=this.allowSearch&&this.allowSearching?n:t.minBy([.8*n,this.initHeight]),this.listHeight=i},fitlerByKeyword:function(e,i){var n=this,a=[];return t.each(e,(function(e){if(new RegExp(i,"gm").test(e.name))e.isOpen=!0,a.push(e);else if(!t.isEmpty(e.children)){var o=n.fitlerByKeyword(e.children,i);t.isEmpty(o)||(e.isOpen=!0,e.children=o,a.push(e))}})),a},keywordFilter:function(t){return this.searchKeyword?t.replace(new RegExp(this.searchKeyword,"gm"),'<span class="color-blue">'+this.searchKeyword+"</span>"):t},loadNext:function(){this.listLimit+=this.listLimitSize,this.listLimit>this.options.length&&(this.listLimit=this.options.length)},resultListLimit:function(){this.listLimit=this.listLimitSize}}}}).call(this,i("391c"))},c070:function(t,e,i){var n=i("574c");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("35590dcb",n,!0,{sourceMap:!1,shadowMode:!1})},c82d:function(t,e,i){var n=i("0c52");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("26e0fa2e",n,!0,{sourceMap:!1,shadowMode:!1})},e1e7:function(t,e,i){"use strict";(function(t){i("cc57"),i("163d");var n=i("07d2"),a=i("4e8c");e.a={name:"SlideUpSelect",components:{Item:n.default},props:{title:{type:String,default:""},value:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},placeholder:{type:String,default:"请选择"},emptyText:{type:String,default:"暂无数据"},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},showNote:{type:String},allowSearch:{type:Boolean,defalut:!1},initHeight:{type:Number,default:400},historyKey:{type:String,default:"historyHey"}},data:function(){return{isOpen:!1}},computed:{text:function(){return t.isEmpty(this.value)?this.editabled?"":"无":this.value.name}},created:function(){var t=this;a.a.$on("afterClosePopup",(function(){t.isOpen=!1}))},activated:function(){a.a.resultListLimit()},methods:{openSelect:function(){var t=this;a.a.openPopup({title:this.title,options:this.options,selected:this.value,showNote:this.showNote,emptyText:this.emptyText,allowSearch:this.allowSearch,initHeight:this.initHeight,historyKey:this.historyKey,componentUid:this._uid,callback:function(e){t.$emit("input",e),t.$emit("onSelect",e)}}),this.isOpen=!0}}}}).call(this,i("391c"))},e89f:function(t,e,i){"use strict";var n=i("04f3"),a=i("cf09"),o=i("4360"),s=0;e.a={name:"PopupMixin",data:function(){return{backButtonEvent:null}},watch:{show:function(t){var e=this;if(t){if(this.$nextTick((function(){e.$el&&e.$el.style&&(e.$el.style.zIndex=++a.a.zIndex,s++,o.a.commit("app/SET_HAS_POPUP",!!s))})),!this.backButtonEvent){var i=this.close||this.closePopup;this.backButtonEvent=Object(n.a)(i)}}else--s<0&&(s=0),o.a.commit("app/SET_HAS_POPUP",!!s),this.backButtonEvent&&(Object(n.c)(this.backButtonEvent),this.backButtonEvent=null)}},methods:{}}},ef70:function(t,e,i){"use strict";i.r(e);var n=i("2699").a,a=(i("7f14"),i("17cc")),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{title:t.pageTitle}},[t.isLoading?t._e():i("scroller",[i("single-select",{attrs:{title:"施工单位",options:t.contractorOptions,memory:t.contractorMemory},on:{onSelect:t.save},model:{value:t.contractor,callback:function(e){t.contractor=e},expression:"contractor"}}),i("date-select",{attrs:{label:"晨会时间",max:t.dateMax,format:"YYYY-MM-DD HH:mm"},on:{change:t.save},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),t._l(t.teams,(function(e,n){return i("div",{key:n,staticClass:"team-group"},[i("icon",{attrs:{name:"remove"},on:{click:function(e){t.removeTeam(n)}}}),i("slide-up-select",{attrs:{title:"班组",options:t.teamOptions},on:{onSelect:t.save},model:{value:e.team,callback:function(i){t.$set(e,"team",i)},expression:"item.team"}}),i("item",{attrs:{mode:"edit",border:"none",label:"参会人数"}},[i("template",{slot:"right"},[i("div",{staticClass:"item-con align-r"},[i("app-stepper",{attrs:{max:"9999"},on:{change:t.save},model:{value:e.workers,callback:function(i){t.$set(e,"workers",i)},expression:"item.workers"}})],1),i("div",{staticClass:"item-font ml5"},[t._v("人")])])],2)],1)})),i("app-button-group",{attrs:{seamless:""}},[i("app-button",{attrs:{plain:""},on:{click:t.addTeam}},[i("van-icon",{attrs:{name:"plus"}}),t._v("\n        新增班组及人数\n      ")],1)],1),i("item",{staticClass:"p15 mt10",attrs:{border:"bottom"}},[i("item-img-list",{attrs:{maxlength:15,"online-mode":!0},on:{callback:t.save},model:{value:t.images,callback:function(e){t.images=e},expression:"images"}})],1),i("item-textarea",{staticClass:"border-none",attrs:{placeholder:"备注"},on:{change:t.save},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}}),t.id?i("app-button-group",[i("app-button",{attrs:{type:"text"},on:{click:t.remove}},[t._v("\n        删除此草稿\n      ")])],1):t._e()],2),t.isLoading?t._e():i("app-button-group",{attrs:{"fixed-bottom":"",seamless:""}},[i("app-button",{staticStyle:{width:"50%"},attrs:{plain:""},on:{click:t.saveAndBack}},[t._v("\n      暂存\n    ")]),i("app-button",{on:{click:t.submit}},[t._v("\n      提交\n    ")])],1),i("loading-status",{attrs:{"is-loading":t.isLoading}})],1)}),[],!1,null,"390ba8a9",null);e.default=o.exports},fd58:function(t,e,i){var n=i("7cb3");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("a01e6734",n,!0,{sourceMap:!1,shadowMode:!1})}}]);