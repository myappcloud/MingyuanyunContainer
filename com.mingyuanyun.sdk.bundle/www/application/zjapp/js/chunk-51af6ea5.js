(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-51af6ea5","chunk-3adbbd26","chunk-05a7fae9"],{"0416":function(e,t,a){"use strict";a("068e")},"068e":function(e,t,a){var n=a("771c");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("85cb").default)("1ce02ce6",n,!0,{sourceMap:!1,shadowMode:!1})},"0732":function(e,t,a){var n=a("81f2");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("85cb").default)("1b5b07de",n,!0,{sourceMap:!1,shadowMode:!1})},"08d4":function(e,t,a){"use strict";a("3880")},"09ae":function(e,t,a){"use strict";(function(e){a.d(t,"c",(function(){return _})),a.d(t,"a",(function(){return N})),a.d(t,"d",(function(){return O})),a.d(t,"b",(function(){return E}));a("5ab2"),a("cc57");var n=a("28f8"),o=(a("163d"),a("6a61"),a("e697"),a("2e91")),i=(a("e10e"),a("f548"),a("6d57"),a("a044")),r=a("2b66"),s=a("82c5"),c=a("b26e"),u=a("1b7e"),l=a("7bac"),d=a("a7c3"),m=a("6bf2"),p=a.n(m);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g=a("8625"),b={};g.keys().forEach((function(e){var t=g(e).default,a=e.replace(/(\.\/|\.js)/g,"");b[a]=t}));var y=Object.keys(b).map((function(e){return e.replace("mode-","")}));function v(){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.getHasNetwork();case 2:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,l.a.getUserKey(d.a.CUSTOM_TIME_SPECIAL_INSPECT);case 7:if(t=e.sent){e.next=10;break}return e.abrupt("return",!0);case 10:if(a=Number(t),!isNaN(a)){e.next=15;break}return e.next=14,l.a.setUserKey(d.a.CUSTOM_TIME_SPECIAL_INSPECT,"");case 14:return e.abrupt("return",!0);case 15:return n=p()(a),e.abrupt("return",p()().diff(n,i.c)>i.b);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){var a=t.value;if(a&&"string"==typeof a)try{a=JSON.parse(a)}catch(e){a=null}return e[t.code]=a,e}),{})}function k(){return I.apply(this,arguments)}function I(){return(I=Object(o.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:if(e.sent){e.next=11;break}return e.next=6,l.a.getUserKey(d.a.CUSTOM_LAYOUT_SPECIAL_INSPECT);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0={};case 9:return t=e.t0,e.abrupt("return",t);case 11:return e.next=13,Object(c.c)({codes:y.map((function(e){return i.d+"_"+e}))}).catch((function(){return null}));case 13:if((a=e.sent)&&Array.isArray(a)){e.next=22;break}return e.next=17,l.a.getUserKey(d.a.CUSTOM_LAYOUT_SPECIAL_INSPECT);case 17:if(e.t1=e.sent,e.t1){e.next=20;break}e.t1={};case 20:return t=e.t1,e.abrupt("return",t);case 22:return t=w(a),e.next=25,l.a.setUserKey(d.a.CUSTOM_LAYOUT_SPECIAL_INSPECT,t);case 25:return e.next=27,l.a.setUserKey(d.a.CUSTOM_TIME_SPECIAL_INSPECT,(new Date).getTime());case 27:return e.abrupt("return",t);case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return C.apply(this,arguments)}function C(){return(C=Object(o.a)(regeneratorRuntime.mark((function t(a){var n,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.d+"_"+a,t.next=3,k();case 3:return r=t.sent,o=r[n],((o=f(f({},e.cloneDeep(b["mode-".concat(a)])),o))&&o.tree&&o.tree.btns||[]).forEach((function(e,t){e.index=t})),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function N(e,t){return S.apply(this,arguments)}function S(){return(S=Object(o.a)(regeneratorRuntime.mark((function t(a,n){var o,i,r,c,u,l,d,m,p=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=p.length>2&&void 0!==p[2]?p[2]:"edit",t.next=3,_(a);case 3:if(i=t.sent,r={edit:"detailEditForm",view:"detailViewForm"}[o]){t.next=8;break}return t.abrupt("return",[]);case 8:if(c=i&&i[r],u=i&&i.tree&&i.tree.btns||[],l=u[n]&&u[n].formConfig,d={edit:s.a,view:s.b},m=d[o]){t.next=15;break}return t.abrupt("return",[]);case 15:return t.abrupt("return",m.map((function(t){var a=t.name,n=c&&c.find((function(e){return e.name===a})),o=l&&l.find((function(e){return e.name===a})),i=e.mergeWith({},t,n,o,(function(e,t){if(Array.isArray(e))return t}));return e.cloneDeep(i)})));case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t){return e.cloneDeep(r.a.find((function(e){return e.mode===t})))}function E(e){return j.apply(this,arguments)}function j(){return(j=Object(o.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(t);case 2:return a=e.sent,e.abrupt("return",a&&a.navMenu||[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,a("391c"))},1468:function(e,t,a){"use strict";a("24d2")},"17b9":function(e,t,a){"use strict";a.r(t),t.default={mode:4,name:'可打分，按"权重+得分率"计算总分',navMenu:[{name:"全部问题",code:"allProblem"},{name:"展示描述",code:"toggleDesc"}],totalMode:"batch.template_extension.mode4_passrate_mode",defaultTotalMode:1,tree:{style:"no-point",attrs:[{key:"checkitem_extension",name:"扩展属性",type:"object",pattern:"computed",result:'JSON.parse(checkitem_extension || "{}")'},{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"score",name:"满分汇总-末级算法",type:"number",pattern:"transmit",totalMode:1,match:"!treeNodeIsEnd",filter:"hasData",result:"score || 0"},{key:"deductionLimit",name:"扣分上限汇总-末级算法",type:"number",pattern:"computed",totalMode:1,match:"treeNodeIsEnd",filter:"hasData",result:"Math.max(Number(checkitem_extension.deduction_limit) || 0, score || 0)"},{key:"score",name:"满分汇总-二级算法",type:"number",pattern:"transmit",totalMode:2,match:"treeNodeIsFirst",filter:"hasData",result:"score || 0"},{key:"deduction",name:"扣分汇总-末级算法，取末级的扣分时，要判断不能超过满分",type:"number",pattern:"transmit",totalMode:1,match:"!treeNodeIsEnd",result:"treeNodeIsEnd ? Math.min(deduction || 0,  deductionLimit || 0) : deduction"},{key:"deduction",name:"扣分上限处理-二级算法",type:"number",pattern:"computed",totalMode:2,match:"treeNodeIsEnd && isNumber(checkitem_extension.deduction_limit)",result:"Math.min(deduction || 0, checkitem_extension.deduction_limit)"},{key:"deduction",name:"扣分汇总-二级算法",type:"number",pattern:"transmit",totalMode:2,match:"!treeNodeIsEnd",result:"deduction || 0"},{key:"deduction",name:"扣分汇总-二级算法，二级检查项满分判断",type:"number",pattern:"computed",totalMode:2,match:"treeNodeLevel === 1",result:"isNumber(score) ? Math.min(deduction || 0, score) : (deduction || 0)"},{key:"scoreRate",name:"一级检查项得分率",type:"number",pattern:"computed",match:"treeNodeIsFirst",result:"score === 0 ? 0 : (score - deduction) / score"},{key:"problemNum",name:"问题总数",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"problemNum || 0"},{key:"weight",name:"权重",type:"number",pattern:"computed",result:"parseFloat(weight) || 0"}],notes:[{text:"({{ weight || 0 }}%)",color:"balck",show:"treeNodeIsFirst"},{text:"({{ score || 0 }}分)",color:"gray3",show:"!treeNodeIsFirst && treeNodeIsEnd",totalMode:1},{text:"({{ score || 0 }}分)",color:"gray3",show:"treeNodeLevel === 1",totalMode:2}],infos:[{text:"未检",color:"gray3",show:"treeNodeIsFirst && !hasData"},{text:"-{{ deduction }}分",color:"red",show:"treeNodeIsFirst && hasData"},{text:"{{ percent(scoreRate, 2) }}",color:"red",show:"treeNodeIsFirst && hasData"},{text:"{{ status }}",type:"status",show:'status === "合格"'},{text:"-{{ deduction || 0 }}分",color:"red",show:'status === "不合格"',totalMode:1},{text:"{{ problemNum }}个问题",color:"gray3",show:'treeNodeIsEnd && problemNum && status !== "合格"',totalMode:1},{text:"-{{ deduction || 0 }}分",color:"red",show:'!treeNodeIsFirst && hasData && status !== "合格"',totalMode:2},{text:"{{ problemNum }}个问题",color:"gray3",show:'!treeNodeIsFirst && hasData && status !== "合格"',totalMode:2}],icons:[{name:"mark",show:"treeNodeIsEnd && is_redline_deduction",totalMode:2}],btns:[{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && status !== "合格" && !problemNum',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]},{name:"合格",show:'!treeNodeIsFirst && treeNodeIsEnd && status !== "合格" && !problemNum',operate:"change-status",value:"合格"}]},total:{title:"当前综合得分",note:"",calc:[{key:"scoreWeightSum",name:"得分率*权重之和",match:"treeNodeIsFirst && hasData",value:"scoreRate * weight",text:"{{percent(scoreRate, 2)}} * {{weight || 0}}%"},{key:"weightSum",name:"权重之和",match:"treeNodeIsFirst && hasData",value:"weight",text:"{{weight || 0}}%"},{key:"redlineDeduction",name:"红线扣分",match:"treeNodeIsEnd && hasData",value:"redline_deduction",text:"{{redline_deduction}}"},{key:"doneCount",name:"已检数量",match:"treeNodeIsEnd && hasData",value:"1"}],result:"batch.template_extension.mode4_passrate_mode === 2 ?  Math.max((weightSum.value ? scoreWeightSum.value / weightSum.value : 0) - redlineDeduction.value * 0.01, 0): (weightSum.value ? scoreWeightSum.value / weightSum.value : 0) - redlineDeduction.value * 0.01",hasResult:'batch.status === "检查完毕" || Boolean(doneCount.value)',resultType:"percent",formula:"综合得分=(已检查的一级检查项得分率的加权平均-红线扣分*0.01)*100%",formulaCalc:"=(({{scoreWeightSum.text}})/({{weightSum.text}})-{{redlineDeduction.value}}*0.01)*100%={{result}}",formulaText:"{{formula}}{{formulaCalc}}"}}},"1def":function(e,t,a){"use strict";a.r(t),t.default={mode:5,name:"可打分，按满分减扣分计算总分",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{attrs:[{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"deduction",name:"扣分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"deduction || 0"},{key:"problemNum",name:"问题数量-非末级",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"problemNum"}],infos:[{text:"-{{ deduction > score ? score : deduction }}分",color:"red",show:"treeNodeIsFirst && (problemNum || hasData)"},{text:"满分{{ score || 0 }}",color:"gray3",show:{treeNodeIsFirst:!0}},{text:"{{ status }}",type:"status",show:{status:"合格"}},{text:"-{{ deduction || 0 }}分",color:"red",show:{status:"不合格"}},{text:"{{ problemNum }}个问题",color:"gray3",show:'!treeNodeIsFirst && treeNodeIsEnd && problemNum && status !== "不合格"'}],btns:[{name:"合格",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"change-status",value:"合格"},{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:"当前综合得分",note:"",calc:[{key:"scoreSum",name:"总满分",match:"treeNodeIsFirst",value:"score",text:"{{score }}"},{key:"deductionSum",name:"总扣分",match:"treeNodeIsFirst && hasData",value:"deduction > score ? score : deduction",text:"{{deduction > score ? score : deduction}}"}],result:"scoreSum.value - deductionSum.value",hasResult:"Boolean(scoreSum.value)",resultType:"number",numberFixed:!1,formula:"得分=总满分-总扣分",formulaCalc:"=({{scoreSum.text}})-({{deductionSum.text || 0}})={{result}}",formulaText:"{{formula}}{{formulaCalc}}\n需至少检查一项，记录合格或扣分，批次创建人才能最终结束并提交"},finishBatchCheck:[{isFilterFirst:!1,statusTotalConfig:[{status:"合格",key:"a"},{status:"不合格",key:"b"}],match:"a + b <= 0",msg:"您未录入任何检查项的检查记录，请录入后再提交"}]}},"21c0":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAA7pJREFUaAXtWEtPE1EU/s5YRDE+NuqGmGjagmCmJSx0Jz4WBlaauBETn0SJOxXfMT4WxGh0I4nxkRAXRhdufSx8/ASKEtpSNWokLojIAkyl9HimqOmUmencYQZd9CaTmXvmnPOd75x779w7QKVVMlDJQCUD/zIDFBQ4J6JbAL4j1yiqqnZQw+DHILACIcAJfREw8Q6Mlb+DfkXxzOYgCGhBOAV+dBYFb0Bs4v7wxiCwfCfAH1oWyLA5PiNYpnMzZD4IfCeAsS8dJdmfDpN5KyfCG3yI2eTCVwI80DgfhBMmhOJOAFXwlQCmJveCubY4ZvMzt3FfuMksm13PNwLMLSEJ/lTZcMjfueAbAfQPtwuB1WUJgLfzQENjeT13Gr4Q4KFwNTh/1hUkyyzJTV50petCyfOHjPmChuTDVchOrROcw7J0trnAK1bpQWjeY1BokBoHvha/UHkuS4CTdYsxiTrwVB1Acuf63/eIAC1UAXPQHROfKRCnAC0pyUghVJXE/J8ZimSyDnZSTpvGich6cdQja3qzjUrwYkJeiD1DtdZB9alhK0CHOcB3/2nwRrQMTSreiixfsgrekDkQwFI7o7mX8wo7THsCROXXdDuvfst5Xo+dS1sCpA89kAIdszOcMzlRF8WTz+3wbAkYBhRPX4fPX067QKzldJ5iQ9es301LbVehYiPui1yWGRXIdrgYx/RM6KZY5oxJZtFxRcCwk2X1qqwIM/f5Fk5nL9JuSPWPuvHjmoDhTHaSN+V2xI1jzzpEt2TYdLq1VyPATOiP3Jb1+aBbADU96kUsvZ+I2K2d4yQudVJwrO8+JBP7Sem7WfeJXiDWfkAleANTqQJ/guS30Rhy+b4/fV/umtZKevqpqi+lCvx1TjKU/G4aRry49EYgh7VewBxtcpBdrnrzRgBsnAH8bp5OaR4JwBOYM2NvSfFIgAKowBwR4OHmGvmkrXbOpoe3hFWF05+iqXoFRsbXFg4aikBl1Y3DfjbfUFavREGdAOfdDp/XIK1Dwjoo18sSXJuu+jAK2XhyEJcBIbyRwE/JR6n4a32PE3XbgPwV2RDqts5ZU14cPFSAw5YBED5Do33Qd8dLgi+oUyz1DHp7k5DbIxX5ZO0jv8ZS7iBUJ0A0UeLvuwR+Ektqo3KK6yW6IH8SrJvxjmLp+6hBVPZTXUJk1KTJ2ntT30VHeUsgf6DDyGUfiu/lspV6BFrQTfobcyAugA0V/hBfhrHx00Jkl/TSCFXvlJ9c31yaV9QqGahkoJKB/yADvwCwKfUADObhFgAAAABJRU5ErkJggg=="},"24d2":function(e,t,a){var n=a("f8e9");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("85cb").default)("0c19b09a",n,!0,{sourceMap:!1,shadowMode:!1})},"254e":function(e,t,a){"use strict";a("6d57"),a("e697"),a("9e76"),a("6a61");var n=a("2e91"),o=(a("163d"),a("a500")),i=a("329b"),r=a("07d2"),s=a("e89f"),c=a("6f9e"),u={name:"SpecialInspectNavMenuPopup",components:{Item:r.default},mixins:[s.a],data:function(){return{show:!1,showList:!1,target:null,contentTop:44,listHeight:475,menus:[]}},watch:{show:function(e){var t=this;e&&this.$nextTick((function(){t.showList=!0}))}},created:function(){c.a.$on("routerBeforeEach",this.close),c.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){c.a.$off("routerBeforeEach",this.close),c.a.$off("pageContentClick",this.onClickOther)},methods:{open:function(e){if(this.show=!0,this.menus=e.menus,this.target=e.el,e.el){var t=e.el.getBoundingClientRect();this.contentTop=t.bottom}this.listHeight=Math.min(window.innerHeight-this.contentTop-50,475)},onClose:function(){this.show=!1},close:function(){this.showList=!1},onClickOther:function(e){e&&e.target&&e.target!==this.target&&this.show&&this.close()},itemClick:function(e){e.isSwitchItem||e.handle&&e.handle()},switchChange:function(e){e.isSwitchItem&&e.handle&&e.handle()}}},l=(a("4eab"),a("17cc")),d=Object(l.a)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.show?a("div",{staticClass:"content",style:{top:e.contentTop+"px"},on:{click:function(t){return t.target!==t.currentTarget?null:e.close(t)}}},[a("transition",{attrs:{name:"slide-down"},on:{afterLeave:e.onClose}},[e.showList?a("div",{staticClass:"list",style:{"max-height":e.listHeight+"px"}},e._l(e.menus,(function(t,n){return a("item",{key:n,attrs:{label:t.name,border:"bottom"},on:{click:function(a){e.itemClick(t)}}},[a("div",{staticClass:"item-text"},[e._v(e._s(t.name))]),t.isSwitchItem?e._e():a("icon",{attrs:{name:"arrow-right"}}),t.isSwitchItem?a("van-switch",{on:{change:function(a){e.switchChange(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e()],1)}))):e._e()])],1):e._e()}),[],!1,null,"64b86a44",null).exports,m=!1;m||(m=new(i.default.extend(d))({el:document.createElement("div")}),document.body.appendChild(m.$el));var p,h,f,g,b=m,y=a("7bac"),v=a("09ae"),x=a("a044"),w=a("2757"),k={name:"SpecialInspectNavMenu",props:{batch:{type:Object},specialInspectId:{type:String},placeId:{type:String},mode:{type:[String,Number]},data:{type:Array}},data:function(){return{defaultList:[{code:"allProblem",name:"全部问题",track:"专项巡检-首页-全部问题",handle:this.gotoProblemList},{code:"toggleDesc",name:"展示描述",value:"",isPopupItem:!0,isSwitchItem:!0,getValue:this.getDescValue,handle:this.toggleDesc}],menus:[]}},computed:{hasMenu:function(){return this.menus&&this.menus.length},isPopupMenu:function(){return this.menus.length>1||this.menus.some((function(e){return e.isPopupItem}))}},watch:{batch:{handler:function(){this.initMenus()},immediate:!0}},methods:{initMenus:(g=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a,n,o,i,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mode||0===this.mode){e.next=2;break}return e.abrupt("return");case 2:if(t=this.mode,p=Object(w.c)(t),!this.data||!this.data.length){e.next=8;break}a=this.data,e.next=11;break;case 8:return e.next=10,Object(v.b)(t);case 10:a=e.sent;case 11:a=(a||[]).filter((function(e){return!e.match||p.isMatch(e.match,{batch:r.batch})})),n=a.map((function(e){var t=r.defaultList.find((function(t){return t.code===e.code}));return Object.assign({},t,e)})),e.t0=regeneratorRuntime.keys(n);case 14:if((e.t1=e.t0()).done){e.next=23;break}if(o=e.t1.value,!(i=n[o]).getValue){e.next=21;break}return e.next=20,i.getValue();case 20:i.value=e.sent;case 21:e.next=14;break;case 23:this.menus=n;case 24:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)}),clickMenu:(f=Object(n.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPopupMenu){e.next=6;break}return e.next=3,this.initMenus(this.mode);case 3:b.open({menus:this.menus,el:t&&t.target?t.target:null}),e.next=11;break;case 6:if(a=this.menus[0]){e.next=9;break}return e.abrupt("return");case 9:a.handle&&"function"==typeof a.handle&&a.handle(),a.track&&o.a.addTrack(a.track);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)}),gotoProblemList:function(){var e=this.batch.id;p.gotoProblemList(e,this.specialInspectId,this.placeId)},getDescValue:function(){return y.a.getUserKey(x.a)},toggleDesc:(h=Object(n.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDescValue();case 2:return t=e.sent,a=!t,e.next=6,y.a.setUserKey(x.a,a);case 6:this.menus.find((function(e){return"toggleDesc"===e.code})).value=a,this.$emit("change","toggleDesc",a);case 9:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})}},I=Object(l.a)(k,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.hasMenu?a("div",{staticClass:"header-btn",on:{click:e.clickMenu}},[e.isPopupMenu?a("icon",{attrs:{name:"guanbi"}}):[e._v(e._s(e.menus[0]&&e.menus[0].name))]],2):e._e()}),[],!1,null,null,null);t.a=I.exports},"2bec":function(e,t,a){"use strict";a.r(t),t.default={mode:9,name:"得分率（打分制）",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{style:"no-point",infos:[{text:"{{ level }}",color:"gray",show:{treeNodeIsEnd:!0,status:"检查完毕"}},{text:"{{ reward }}分",color:"gray",show:{treeNodeIsEnd:!0,status:"检查完毕"}},{text:"{{ status }}",type:"status",show:'treeNodeIsEnd && status !== "检查完毕" && status !== "未设置" && status !== "已甩项"'},{text:"{{ status }}",type:"status",show:'treeNodeIsEnd && status === "已甩项" && !editable'}],btns:[{name:"登记",show:{treeNodeIsEnd:!0,status:"未设置"},operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]},{name:"甩项",show:{treeNodeIsEnd:!0,status:"未设置"},operate:"change-status",value:"已甩项"},{name:"取消甩项",show:{treeNodeIsEnd:!0,status:"已甩项"},operate:"change-status",value:"未设置"}]},total:{title:"当前综合得分",calc:[{key:"rewardSum",name:"已检项的实得分之和",match:'treeNodeIsEnd && status === "检查完毕"',value:"reward || 0"},{key:"scoreSum",name:"已检项应得满分之和",match:'treeNodeIsEnd && status === "检查完毕"',value:"score || 0"},{key:"doneCount",name:"已测数量",match:'treeNodeIsEnd && status === "检查完毕"',value:"1"}],result:"scoreSum.value ? rewardSum.value / scoreSum.value : 0",hasResult:'batch.status === "检查完毕" || Boolean(doneCount.value)',resultType:"percent",formula:"综合得分 =（已检项的实得分之和 / 已检项应得满分之和）*100%",formulaCalc:"=({{rewardSum.value}}/{{scoreSum.value}})*100%={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},finishBatchCheck:[{isFilterFirst:!1,statusTotalConfig:[{status:"未设置",key:"a"},{status:"草稿",key:"b"}],match:"a + b > 0",type:"notify",msg:"有未检查的检查项，请检查完之后重试"}]}},"2d6e":function(e,t,a){var n=a("7eb2");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("85cb").default)("53a2fbaa",n,!0,{sourceMap:!1,shadowMode:!1})},"2e80":function(e,t,a){var n=a("9e2b");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("85cb").default)("3ccc3358",n,!0,{sourceMap:!1,shadowMode:!1})},3411:function(e,t,a){"use strict";a("ef1c")},3880:function(e,t,a){var n=a("b66d");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("85cb").default)("1e2c6191",n,!0,{sourceMap:!1,shadowMode:!1})},"3c77":function(e,t,a){"use strict";a("9dd9"),a("f548");var n=a("28f8"),o=(a("163d"),a("7bac")),i=a("4360");o.a.getUserObject("tree-base-open-set-memory").then((function(e){i.a.commit("components/SET_TREE_BASE_OPEN_SET",e||{})}));var r={name:"TreeBase",props:{data:{type:Array,default:function(){return[]}},keyword:{type:String,default:""},level:{type:Number,default:0},iconPosition:{type:String,default:"left"},indentSize:{type:Number,default:14},memoryOpenSet:{type:Boolean,default:!1},defaultOpenLevel:{type:Number,default:0},hasSlotLeft:{type:Boolean,default:!1},hasSlotRight:{type:Boolean,default:!1},listStyle:{type:Object,default:function(){return{}}},nodeStyle:{type:Object,default:function(){return{}}},textStyle:{type:Object,default:function(){return{}}}},data:function(){return{selfOpenSet:{}}},computed:{openSet:function(){return this.memoryOpenSet?i.a.state.components.treeBaseOpenSet:this.selfOpenSet},showSlotLeft:function(){return this.level?this.hasSlotLeft:!!this.$scopedSlots.left},showSlotRight:function(){return this.level?this.hasSlotRight:!!this.$scopedSlots.right}},methods:{itemClick:function(e){if(e.children&&e.children.length){if(this.memoryOpenSet)!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},i.a.state.components.treeBaseOpenSet,e);i.a.commit("components/SET_TREE_BASE_OPEN_SET",t),o.a.saveUserObject("tree-base-open-set-memory",t)}(Object(n.a)({},e.id,!this.isNodeOpen(e.id)));else this.$set(this.selfOpenSet,e.id,!this.isNodeOpen(e.id));this.$emit("onClickFoldNode",e)}else this.$emit("onClickEndNode",e);this.$emit("onClickNode",e)},isNodeOpen:function(e){return void 0===this.openSet[e]?this.level<this.defaultOpenLevel:this.openSet[e]},onClickNode:function(e){this.$emit("onClickNode",e)},onClickFoldNode:function(e){this.$emit("onClickFoldNode",e)},onClickEndNode:function(e){this.$emit("onClickEndNode",e)},keywordFilter:function(e){return this.keyword?e.replace(new RegExp(this.keyword,"gm"),'<span class="color-blue">'+this.keyword+"</span>"):e}}},s=(a("08d4"),a("17cc")),c=Object(s.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tree-con"},e._l(e.data,(function(t){return a("div",{key:t.id,staticClass:"tree-list",style:Object.assign({},e.listStyle["level-all"],e.listStyle["level-"+e.level])},[a("div",{staticClass:"tree-node border-bottom",class:"tree-node-level-"+e.level,style:Object.assign({},e.nodeStyle["level-all"],e.nodeStyle["level-"+e.level]),on:{click:function(a){e.itemClick(t)}}},[a("div",{staticClass:"tree-indent",style:{width:e.indentSize*e.level+"px"}}),"left"===e.iconPosition?a("div",{staticClass:"tree-icon",class:{"icon-dropdown":t.children&&t.children.length&&(void 0===e.openSet[t.id]?e.level<e.defaultOpenLevel:e.openSet[t.id]),"icon-dropright":t.children&&t.children.length&&!(void 0===e.openSet[t.id]?e.level<e.defaultOpenLevel:e.openSet[t.id])}}):e._e(),a("div",{staticClass:"tree-main"},[e.showSlotLeft?e._t("left",null,{data:t}):a("div",{staticClass:"tree-text",style:Object.assign({},e.textStyle["level-all"],e.textStyle["level-"+e.level]),domProps:{innerHTML:e._s(e.keywordFilter(t.name))}})],2),e.showSlotRight?e._t("right",null,{data:t}):e._e(),"right"===e.iconPosition&&t.children&&t.children.length?a("icon",{staticClass:"icon-right",attrs:{name:(void 0===e.openSet[t.id]?e.level<e.defaultOpenLevel:e.openSet[t.id])?"arrow-up":"arrow-down"}}):e._e()],2),e._t("siblings",null,{data:t}),t.children&&t.children.length&&(void 0===e.openSet[t.id]?e.level<e.defaultOpenLevel:e.openSet[t.id])?[a("tree-base",{key:"children-"+t.id,attrs:{data:t.children,level:e.level+1,keyword:e.keyword,"default-open-level":e.defaultOpenLevel,"memory-open-set":e.memoryOpenSet,"icon-position":e.iconPosition,"has-slot-left":e.showSlotLeft,"has-slot-right":e.showSlotRight,"indent-size":e.indentSize,"list-style":e.listStyle,"node-style":e.nodeStyle,"text-style":e.textStyle},on:{onClickNode:e.onClickNode,onClickFoldNode:e.onClickFoldNode,onClickEndNode:e.onClickEndNode},scopedSlots:e._u([{key:"left",fn:function(t){return[e._t("left",null,{data:t.data})]}},{key:"right",fn:function(t){return[e._t("right",null,{data:t.data})]}},{key:"siblings",fn:function(t){return[e._t("siblings",null,{data:t.data})]}}])})]:e._e()],2)})))}),[],!1,null,"0083fc0a",null);t.a=c.exports},"3e1e":function(e,t,a){"use strict";a("2e80")},"41d2":function(e,t,a){"use strict";(function(e){a("cc57"),a("6d57"),a("6a61");var n,o,i=a("2e91"),r=a("28f8"),s=a("254e"),c=a("774b"),u=a("07d2"),l=a("f7ab"),d=a("4aef"),m=a("f369"),p=a("3c77"),h=a("a044"),f=a("3bd5"),g=a("2757"),b=a("e2a7"),y=a("6f9e"),v=a("c726"),x=a("8d95"),w=a("9416");t.a={name:"SpecialInspectCheckitemList",components:{NavMenu:s.a,Scroller:c.default,Item:u.default,SynchronizeTipBar:l.a,StatusText:d.a,CheckGuide:m.a,TreeBase:p.a},data:function(){return{title:Object(w.a)(x.a.SPECIAL_INSPECT)||h.e,isLoading:!0,batchId:"",placeId:"",batchData:{},placeData:{},listData:[],passrateMode:1,isBatchChecker:!1,editable:!1,statusStyleExtend:Object(r.a)({},h.w,"color-orange")}},created:function(){var e=this;Object(y.e)((function(){return e.init()}))},activated:function(){this.batchId=this.$route.query.batchId,this.placeId=this.$route.query.placeId,this.init()},methods:{init:(o=Object(i.a)(regeneratorRuntime.mark((function t(){var a,o,i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.getBatchById(this.batchId);case 2:return this.batchData=t.sent,this.passrateMode=this.batchData&&this.batchData.template_extension&&this.batchData.template_extension.mode11_passrate_mode||1,a=this.batchData&&this.batchData.mode,n=Object(g.c)(a),t.next=8,this.getPlaceData();case 8:return t.next=10,this.getListData();case 10:return o=f.a.getUser().user_id,i=this.batchData.root_id||this.batchData.parent_id||this.batchData.id,t.next=14,g.a.getBatchUsers(i);case 14:r=t.sent,this.isBatchChecker=e.some(r,{user_id:o}),this.editable="检查完毕"!==this.batchData.status&&this.isBatchChecker,this.isLoading=!1;case 18:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),onPullDown:function(){var e=this;n.recoverDraftFromMmkv().then((function(){return e.init()}))},getPlaceData:function(){var e=this;return n.getBatchPlace(this.placeId).then((function(t){if(!t)return e.$router.go(-1),b.a.alert("测区不存在"),Promise.reject("测区不存在");e.placeData=t||{}}))},getListData:function(){var e=this;return this.placeId?n.getBatchPlaceCheckitems(this.placeId).then((function(t){(t||[]).forEach((function(t){e.setUnqualifiedNum(t)})),e.listData=t})):Promise.reject("缺少测区id")},setUnqualifiedNum:function(e){var t=this;if(!e)return 0;if(e.children&&e.children.length){var a=0;return e.children.forEach((function(e){a+=t.setUnqualifiedNum(e)})),e.unqualifiedNum=a,e.unqualifiedNum}return"检查完毕"===this.batchData.status&&"未设置"===e.status&&(e.status="已甩项"),e.unqualifiedNum="不合格"===e.status?1:0,e.unqualifiedNum},editPlace:function(){var e=this;if(this.editable){var t={building_id:this.placeData.building_id,unit_id:this.placeData.unit,floor:this.placeData.floor,room_id:this.placeData.room_id,full_name:this.placeData.name};v.a.open({title:"选择测区",selected:t,projectId:this.batchData.proj_id,callback:function(t){v.a.close();var a={id:e.placeData.id,name:t.fullname,building_id:t.building&&t.building.id||"",unit:t.unit&&t.unit.id||"",floor:t.floor&&t.floor.id||"",room_id:t.room&&t.room.id||""};return n.updateBatchPlace(a).then((function(){return e.init()})).catch((function(e){$log.error(e),b.a.alert("修改测区失败")}))}})}},deletePlace:function(){var e=this;return b.a.popBox({title:"确定删除测区吗？",cancelText:"取消",okText:"删除"}).then((function(t){if(t)return n.deleteBatchPlace(e.placeData).then((function(){e.$router.go(-1)}))})).catch((function(e){$log.log(e),b.a.alert(e)}))},onClickNode:function(e){["合格","不合格","草稿"].some((function(t){return t===e.status}))&&(this.editable?this.$router.push({name:"SpecialInspecDetailEdit",query:{specialInspectId:e.special_inspect_id,placeId:e.place_id}}):this.$router.push({name:"SpecialInspecDetailView",query:{specialInspectId:e.special_inspect_id,placeId:e.place_id}}))},setQualified:function(e){var t={id:e.id,status:"合格"};return n.submitSpecialInspectData(t).then((function(){e.status="合格"}))},setUnqualified:function(e){this.$router.push({name:"SpecialInspecDetailEdit",query:{specialInspectId:e.special_inspect_id,placeId:e.place_id}})}}}}).call(this,a("391c"))},"4aef":function(e,t,a){"use strict";var n=a("dd16").a,o=a("17cc"),i=Object(o.a)(n,(function(){var e=this.$createElement;return(this._self._c||e)("span",{class:this.classSet[this.status]},[this._v(this._s(this.text||this.status))])}),[],!1,null,null,null);t.a=i.exports},"4e84":function(e,t,a){"use strict";a("5ab2"),a("6d57"),a("e10e");var n=a("28f8"),o=(a("cc57"),a("fc9f")),i=function(e){var t="select * from section \n      where proj_id = '".concat(e,"' \n      order by name");return o.a.query(t)},r=function(e){var t="select b.*, sb.section_id from building b\n      join section_building sb on b.id = sb.building_id\n      where b.proj_id = '".concat(e,"' \n      order by b.sort, b.code");return o.a.query(t)},s=function(e){var t="select b.* from section_building sb \n      left join building b on sb.building_id = b.id \n      where sb.section_id = '".concat(e,"' \n      order by b.sort, b.code");return o.a.query(t)},c=function(e){var t="select * from build_unit \n      where building_id = '".concat(e,"'\n      order by sort");return o.a.query(t)},u=function(e){var t="select * from building_floor \n      where building_id = '".concat(e,"' \n      order by sort");return o.a.query(t)},l=function(e,t,a){var n=t?" and unit = '".concat(t,"' "):"",i="select * from room where \n      building_id = '".concat(e,"' and floor = '").concat(a,"' ").concat(n," \n      order by sort");return o.a.query(i)},d=a("7cb8");function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a={getSections:function(e){return i(e)},getBuildingsByProject:function(e){return r(e)},getBuildingsBySection:function(e){return s(e)},getUnits:function(e){return c(e).then((function(e){return((e=e.filter((function(e){return!!e.name})))||[]).map((function(e){return p(p({},e),{},{id:e.name,name:Object(d.a)(e.name,"单元")})}))}))},getFloors:function(e){return u(e).then((function(e){return(e||[]).map((function(e){return p(p({},e),{},{id:e.floor,name:Object(d.a)(e.floor,"层")})}))}))},getRooms:function(e,t,a){return l(e,t,a).then((function(e){return(e||[]).map((function(e){return p(p({},e),{},{name:e.room_no})}))}))}}},"4eab":function(e,t,a){"use strict";a("c090")},"515e":function(e,t,a){"use strict";var n=a("329b"),o=a("f1e4").a,i=(a("0416"),a("17cc")),r=Object(i.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"slide-right"}},[e.show?a("page-content",{class:{"content-not-empty":e.content.length},attrs:{mode:"dialog",title:"检查指引","on-close":e.closePopup}},[!e.isLoading&&e.title?a("div",{staticClass:"check-guide-detail-hd border-bottom"},[a("h2",{staticClass:"check-guide-detail-title pb10"},[e._v(e._s(e.title))])]):e._e(),!e.isLoading&&e.content.length?a("div",{staticClass:"check-guide-detail-content"},e._l(e.content,(function(t,n){return a("p",{key:n},[t.isImg&&t.src?a("img",{class:{"img-not-ready":!t.ready,error:"rejected"===t.status},attrs:{src:e.getThumbnail(t)},on:{error:function(a){e.imgError(t,n)},click:function(a){e.imgClick(t)}}}):e._e(),t.isImg?e._e():a("span",[e._v("\n          "+e._s(t.val)+"\n        ")])])}))):e._e(),a("loading-status",{attrs:{"is-loading":e.isLoading,"is-empty":!e.content.length,"empty-text":"PC端未设置检查指引"}})],1):e._e()],1)}),[],!1,null,"691b2f0f",null).exports,s=!1;s||(s=new(n.default.extend(r))({el:document.createElement("div")}),document.body.appendChild(s.$el));t.a=s},"535a":function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,".zjapp .content[data-v-64b86a44]{position:fixed;width:100%;bottom:0;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .content .item[data-v-64b86a44]{justify-content:space-between}.zjapp .content .van-cell__title[data-v-64b86a44],.zjapp .content[data-v-64b86a44] .item-label{color:#333}",""])},"65e9":function(e,t,a){"use strict";(function(e){a("5ab2"),a("6d57"),a("e10e");var n=a("28f8"),o=a("4360"),i=a("48f4"),r=a("162a"),s=a("f2d3"),c=a("6906"),u=a("a18c"),l=a("c745");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a={name:"SynchronizeTipBar",props:{isTodo:{type:Boolean},useDownload:{type:Boolean,default:!0},enterDoCheck:{type:Boolean,default:!0},buildingId:{type:String,default:""},automaticUpdateCallback:{type:Function,default:null}},data:function(){return{currentModuleCode:"",oneUpdateData:!0}},computed:{projId:function(){return o.a.state.global.currentProject.id},waitUploadNum:function(){return o.a.state.global.waitUploadNum},hasTopProgress:function(){return o.a.state.global.hasTopProgress},hasChanged:function(){if(!this.useDownload)return!1;if(this.currentModuleCode){var e,t=i.default.isModuleNeedBuilding(this.currentModuleCode)&&!this.isTodo;return!(t&&!this.buildingId)&&(e=this.isTodo?o.a.state.global.todoChangedStatus||{}:o.a.state.global.businessChangedStatus||{},t?!!e[this.currentModuleCode]&&e[this.currentModuleCode][this.buildingId]:e[this.currentModuleCode])}return!1},show:function(){return(this.hasChanged||this.waitUploadNum)&&!this.hasTopProgress},oneDataSync:function(){return this.$store.state.app.oneDataSync}},watch:{hasChanged:function(e){var t=this;e&&this.$nextTick((function(){setTimeout((function(){var e=t.$refs["synchronize-tip-bar"];if(e&&e.style){e.style.display="none";e.offsetHeight;e.style.display="block"}}),100)}))},buildingId:function(e){this.currentModuleCode&&i.default.isModuleNeedBuilding(this.currentModuleCode)&&e&&(console.log("楼栋重新加载，是否再次自动加载数据：",this.oneUpdateData),this.oneUpdateData&&this.automaticLogic(),this.checkSync())},show:function(e){e?this.$emit("show"):this.$emit("hide")}},activated:function(){this.init()},methods:{init:function(){this.getCurrentModuleCode(),this.enterDoCheck&&!u.a.isBack&&this.checkSync(),this.automaticLogic()},automaticLogic:function(){var e=this;this.$router.isBack||(this.oneUpdateData=!0,l.a.getAutomaticLoadData().then((function(t){$log.log("是否要自动加载 ===> ",t&&e.oneDataSync&&"function"==typeof e.automaticUpdateCallback),t&&e.oneDataSync&&"function"==typeof e.automaticUpdateCallback&&e.dataSync().then((function(t){console.log("是否需要初始化页面 ====> ",Boolean(t)),t&&e.automaticUpdateCallback()}))})))},getCurrentModuleCode:function(){var e=i.default.getCurrentModuleCode(),t=this.isTodo?"todo":"";this.currentModuleCode=e||t},checkSync:function(){var t=this,a="checkDataUpdate",n=this.currentModuleCode,r=this.buildingId,u=o.a.state.global.isLeader?this.projId:"";return!i.default.isModuleNeedBuilding(n)||r||this.isTodo?(this.isTodo&&(a+="_todo"),n&&(a+="_".concat(n)),r&&(a+="_".concat(r)),c.a.execAfterInterval(120,a).then((function(){return t.isTodo?"todo"===n?s.a.getModuleList().then((function(t){var a=e.map(t,"code");return i.default.hasTodoChangedData("",a)})):i.default.hasTodoChangedData("",[n]):i.default.hasBusinessChangedData(u,[n],r)})).then((function(e){if(t.isTodo){var a=m({},o.a.state.global.todoChangedStatus);a[n]=e,o.a.commit("global/SET_TODO_CHANGED_STATUS",a)}else{var i=m({},o.a.state.global.businessChangedStatus);if(r){var s=i[n]?i[n]:{};s[r]=e,i[n]=s}else i[n]=e;o.a.commit("global/SET_BUSINESS_CHANGED_STATUS",i)}})).catch((function(e){return e&&!0===e.timeNotTo?($log.debug(e.msg),!1):$q.reject(e)}))):Promise.resolve()},dataSync:function(){var e=this.currentModuleCode,t=this.buildingId,a=i.default.isModuleNeedBuilding(e),n=a&&!t;return $log.log(["模块名：",e," 楼栋id：",t," 当前模块是否需要楼栋id：",a," 判断是否终止自动更新：",n]),n?Promise.resolve():(this.oneUpdateData=!1,r.a.beginManualUpdate(),i.default.checkSync(t).then((function(e){return r.a.endManualUpdate(),e})).catch((function(e){$log.error("自动更新错误",e),r.a.endManualUpdate()})))}}}}).call(this,a("391c"))},"771c":function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,".zjapp .content-not-empty[data-v-691b2f0f] .layout-content{display:auto;overflow:auto;padding-bottom:100px}.zjapp .check-guide-detail-hd[data-v-691b2f0f]{margin-left:30px;padding:25px 30px 5px 0}.zjapp .check-guide-detail-title[data-v-691b2f0f]{margin:0;line-height:20px;font-size:18px;color:#111;font-weight:700;word-break:break-all}.zjapp .check-guide-detail-info[data-v-691b2f0f]{line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .check-guide-detail-content[data-v-691b2f0f]{padding:30px;line-height:30px;color:#333;font-size:16px}.zjapp .check-guide-detail-content p[data-v-691b2f0f]{margin-bottom:30px;min-height:1em}.zjapp .check-guide-detail-content img[data-v-691b2f0f]{max-width:100%}.zjapp .check-guide-detail-content .img-not-ready[data-v-691b2f0f]{width:80px;height:auto}.zjapp .error[data-v-691b2f0f]{max-width:50%}",""])},7965:function(e,t,a){"use strict";a.r(t),t.default={mode:8,name:"质量风险",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{style:"no-point",attrs:[{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"temporary_storage",name:"暂存的问题数量",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"temporary_storage || 0"},{key:"deduction",name:"扣分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"deduction || 0"},{key:"scoreCount",name:"参与计算的总分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"treeNodeIsEnd ? (hasData ? score : 0) : (scoreCount || 0)"},{key:"scoreRate",name:"得分率",type:"number",pattern:"computed",match:"treeNodeIsFirst",result:'hasData ? (scoreCount - deduction) / scoreCount : ""'}],notes:[{text:"({{score}}分)",color:"gray3",show:{treeNodeIsEnd:!0,treeNodeIsFirst:!1}}],infos:[{text:"暂存",color:"orange",show:"!!temporary_storage"},{text:"-{{deduction}}分",color:"red",show:"treeNodeIsFirst && hasData && !temporary_storage"},{text:"{{ percent(scoreRate, 2) }}",color:"gray3",show:"treeNodeIsFirst && hasData && !temporary_storage"},{text:"未检",color:"gray3",show:"treeNodeIsFirst && !hasData && !temporary_storage"},{text:"-{{deduction}}分",color:"red",show:'treeNodeIsEnd && status === "不合格" && !temporary_storage'},{text:"{{problem_num}}个问题",color:"gray3",show:'treeNodeIsEnd && status === "不合格" && !temporary_storage'},{text:"{{ status }}",type:"status",show:'treeNodeIsEnd && status === "合格" && !temporary_storage'}],icons:[{name:"mark",show:"treeNodeIsEnd && is_redline_deduction"}],btns:[{name:"合格",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置",temporary_storage:0},operate:"change-status",value:"合格"},{name:"扣分",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置",temporary_storage:0},operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:"当前综合得分",calc:[{key:"scoreSum",name:"已检项的应得分",match:"treeNodeIsFirst && hasData",value:"scoreCount"},{key:"deductionSum",name:"扣分值",match:"treeNodeIsFirst && hasData",value:"deduction"},{key:"redlineDeductionACount",name:"星标项A级扣分的数量",match:'treeNodeIsEnd && hasData && is_redline_deduction && deduction_level === "A"',value:"1"},{key:"redlineDeductionBCount",name:"星标项B级扣分的数量",match:'treeNodeIsEnd && hasData && is_redline_deduction && deduction_level === "B"',value:"1"},{key:"redlineDeductionCCount",name:"星标项C级扣分的数量",match:'treeNodeIsEnd && hasData && is_redline_deduction && deduction_level === "C"',value:"1"}],result:"(scoreSum.value - deductionSum.value) / scoreSum.value - (((redlineDeductionACount.value < (batch.template_extension.A_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionACount.value, batch.template_extension.A_valid_max || Infinity)) * (batch.template_extension.A || 0)) + ((redlineDeductionBCount.value < (batch.template_extension.B_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionBCount.value, batch.template_extension.B_valid_max || Infinity)) * (batch.template_extension.B || 0)) + ((redlineDeductionCCount.value < (batch.template_extension.C_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionCCount.value, batch.template_extension.C_valid_max || Infinity)) * (batch.template_extension.C || 0))) * 0.01",hasResult:"Boolean(scoreSum.value)",resultType:"percent",formula:"综合得分 =（（已检项的应得分-扣分值）/应得分-星标项的加扣分值*0.01）*100%",formulaCalc:"=(({{scoreSum.value}}-{{deductionSum.value}})/{{scoreSum.value}}-{{((redlineDeductionACount.value < (batch.template_extension.A_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionACount.value, batch.template_extension.A_valid_max || Infinity)) * (batch.template_extension.A || 0)) + ((redlineDeductionBCount.value < (batch.template_extension.B_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionBCount.value, batch.template_extension.B_valid_max || Infinity)) * (batch.template_extension.B || 0)) + ((redlineDeductionCCount.value < (batch.template_extension.C_valid_min || -Infinity) ? 0 : Math.min(redlineDeductionCCount.value, batch.template_extension.C_valid_max || Infinity)) * (batch.template_extension.C || 0))}}*0.01)*100%={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},finishBatchCheck:[{isFilterFirst:!1,statusTotalConfig:[{status:"合格",key:"a"},{status:"不合格",key:"b"}],match:"a + b <= 0",msg:"您未录入任何检查项的检查记录，请录入后再提交"}]}},"7eb2":function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,".zjapp .synchronize-tip-bar[data-v-66826030]{height:30px;padding:5px 15px;line-height:20px;text-align:center;background-color:#ffe6e6;color:#ff6060;font-size:14px}.zjapp .synchronize-tip-bar .icon-caution[data-v-66826030]{line-height:20px;margin-right:5px}@media screen and (-webkit-min-device-pixel-ratio:1){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 100%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:1.5){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2.625){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 38.0952%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:3){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:4){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 25%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}",""])},"81f2":function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,'.zjapp .main[data-v-2cac8864]{position:fixed;width:100%;bottom:0}.zjapp .arrow[data-v-2cac8864]{position:absolute;top:-7px;right:18px;width:0;height:0;border-bottom:7px solid #fff;border-right:7px solid transparent;border-left:7px solid transparent}.zjapp .content[data-v-2cac8864]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-2cac8864]{display:flex;flex-direction:column;background-color:#fff;overflow:auto}.zjapp .box-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1}.zjapp .detail-hd[data-v-2cac8864]{display:flex;padding:6px 15px}.zjapp .detail-arrow-right[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-right[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:12px;border:5px solid transparent;border-left:5px solid #c8c8c8}.zjapp .detail-arrow-down[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-down[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:15px;border:5px solid transparent;border-top:5px solid #c8c8c8}.zjapp .detail-title[data-v-2cac8864]{flex:1;line-height:34px;color:#111;font-size:16px}.zjapp .detail-bd[data-v-2cac8864]{padding:8px 15px 8px 35px;background-color:#fafafa}.zjapp .text-line[data-v-2cac8864]{font-size:14px;color:#666;line-height:30px;margin-bottom:30px}.zjapp .detail-hd-single[data-v-2cac8864]{padding:6px 0;margin:0 15px}.zjapp .detail-bd-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1;padding:8px 15px;background-color:#fff}',""])},"82c5":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o}));var n=[{id:"title",name:"title",type:"text",isExtend:!0,display:!0,label:"",value:"检查项名称",extendOptions:{border:"bottom",fontSize:16,color:"#333",weight:500}},{id:"rule",name:"rule",isExtend:!0,type:"text",label:"",value:"检查项规则",display:!1,extendOptions:{border:"bottom",fontSize:14,color:"#999"}},{id:"status",type:"radio",label:"检查结果",name:"status",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[{key:"不合格",label:"不合格"}],itemLayout:"horizontal",options:[{key:"不合格",label:"不合格"},{key:"合格",label:"合格"}],relations:[]},{id:"divider",type:"divider",label:"分割线",name:"divider",display:!0,height:"10"},{id:"deduction",name:"deduction",label:"扣分",value:"",isExtend:!0,type:"number-input",extendOptions:{decimal:2,range:[0,999999.99],unit:"分",mode:"edit"},display:!0,required:!0,rules:[{pattern:/^[+-]?(0|([1-9]\d*))(\.\d+)?$/,message:"请输入扣分"}],relations:[{type:"formula",func:"DISPLAY([#{status},不合格,=])"}]},{id:"images",name:"images",label:"",value:[],isExtend:!0,type:"images",extendOptions:{maxlength:15},display:!0},{id:"remark",name:"remark",label:"",value:"",isExtend:!0,type:"textarea",extendOptions:{placeholder:"补充说明"},display:!0}],o=[{id:"title",name:"title",type:"text",isExtend:!0,display:!0,label:"",value:"检查项名称",extendOptions:{border:"bottom",fontSize:16,color:"#333",weight:500}},{id:"rule",name:"rule",isExtend:!0,type:"text",label:"",value:"检查项规则",display:!1,extendOptions:{border:"bottom",fontSize:14,color:"#999"},relations:[{type:"formula",func:"DISPLAY([#{rule},,=])"}]},{id:"status",name:"status",isExtend:!0,type:"text",label:"检查结果",extendOptions:{mode:"edit"},display:!0,value:""},{id:"divider",type:"divider",label:"分割线",name:"divider",display:!0,height:"10"},{id:"deduction",name:"deduction",label:"扣分",value:"",isExtend:!0,type:"text",display:!0,extendOptions:{mode:"edit"},relations:[{type:"formula",func:"DISPLAY([#{status},不合格, =])"}]},{id:"images",name:"images",label:"",value:[],isExtend:!0,type:"images",disabled:!0,extendOptions:{maxlength:15},display:!0},{id:"remark",name:"remark",label:"补充说明",value:"",isExtend:!0,type:"text",display:!0}]},8625:function(e,t,a){var n={"./mode-1.js":"b464","./mode-10.js":"def6","./mode-100.js":"b48c","./mode-11.js":"c1d9","./mode-2.js":"bfb1","./mode-3.js":"a2fc","./mode-4.js":"17b9","./mode-5.js":"1def","./mode-6.js":"879f","./mode-7.js":"f6b4f","./mode-8.js":"7965","./mode-9.js":"2bec","./mode-99.js":"e8cb"};function o(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id="8625"},"879f":function(e,t,a){"use strict";a.r(t),t.default={mode:6,name:"合同巡检",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{attrs:[{key:"unqualifiedItemNum",name:"不合格的项数",type:"number",pattern:"computed",match:"treeNodeIsEnd",result:'status === "不合格" ? 1 : 0'},{key:"unqualifiedItemNum",name:"不合格的项数",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"unqualifiedItemNum || 0"},{key:"status",name:"状态 status 处理，保存草稿时，没有修改 speical_inspect 表的状态",type:"string",pattern:"computed",match:"treeNodeIsEnd",result:'{{status === "未设置" && problem_id ? "草稿" : status }}'}],infos:[{text:"{{ unqualifiedItemNum }}项不合格",color:"gray3",show:{treeNodeIsFirst:!0}},{text:"{{ status }}",type:"status",show:'treeNodeIsEnd && status !== "未设置"'}],btns:[{name:"合格",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"change-status",value:"合格"},{name:"不合格",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:'{{batch.status === "检查中" ? "当前" : ""}}合格率',note:"{{unqualifiedCount.value}}项不合格",calc:[{key:"unqualifiedCount",name:"不合格项数",match:'treeNodeIsEnd && status === "不合格"',value:"1"},{key:"qualifiedCount",name:"参与检查的合格项数",match:'treeNodeIsEnd && status === "合格"',value:"1"},{key:"count",name:"参与检查的全部项数",match:'treeNodeIsEnd && (status === "合格" || status === "不合格")',value:"1"}],result:"qualifiedCount.value / count.value",hasResult:"Boolean(count.value)",resultType:"percent",formula:"合格率=参与检查的合格项数/参与检查的全部项数*100%",formulaCalc:"={{qualifiedCount.value}}/{{count.value}}*100%={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},finishBatchCheck:[{isFilterFirst:!0,statusTotalConfig:[{status:"合格",key:"a"},{status:"不合格",key:"b"}],match:"a + b <= 0",type:"notify",msg:"至少有一项检查记录"}]}},"91c1":function(e,t,a){"use strict";(function(e){a("5ab2"),a("6d57"),a("e10e"),a("9a33");var n=a("28f8"),o=a("e68e"),i=a("6f9e"),r=a("bcc7"),s=a("e89f");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a={name:"CheckGuideDetailDrop",components:{ItemImgList:o.a},mixins:[s.a],data:function(){return{show:!1,showList:!1,isLoading:!1,isOpening:!1,isClosing:!1,contentTop:64,listHeight:510,module:"",itemIds:[],data:[],target:""}},watch:{show:function(e){var t=this;e&&this.$nextTick((function(){t.showList=!0}))}},created:function(){i.a.$on("routerBeforeEach",this.closePopup),i.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){i.a.$off("routerBeforeEach",this.closePopup),i.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(t){this.show=!0,this.$emit("open"),this.module=t.module,this.itemIds=t.itemIds,this.options=t.options;var a=document.querySelector(".layout-main .layout-header");if(this.contentTop=a.offsetHeight,t.el){var n=t.el.getBoundingClientRect();this.contentTop=n.bottom}this.target=t.el,this.listHeight=e.minBy([window.innerHeight-this.contentTop-50,510]),this.getData()},closePopup:function(){var e=this;if(!this.isOpening)return this.showList=!1,this.$emit("close"),new Promise((function(t){e.$on("afterClosePopup",t)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(e){e&&e.target&&e.target!==this.target&&this.show&&this.closePopup()},getData:function(){var t=this;return this.options&&this.options.length?(this.data=e.map(this.options,(function(e){return u(u({},e),{},{isOpen:!1})})),Promise.resolve()):r.a.getMeasureCheckItem(this.itemIds).then((function(a){t.data=e.map(a,(function(t){var a=t.content?t.content.trim():"",n=a?a.split("\n"):[],o=t.content_image?JSON.parse(t.content_image):[],i=e.filter(n,(function(e){return!/<img([\s\S]*)>/gm.test(e)}));return e.each(o,(function(e){e.url=e.url.split("@")[0]})),{id:t.id,name:t.full_name,textArr:i,contentImage:o,isOpen:!1}}))})).catch((function(e){console.error(e)}))},toggleItem:function(e){this.data.length>1&&this.$set(e,"isOpen",!e.isOpen)}}}}).call(this,a("391c"))},"9b3e":function(e,t,a){"use strict";a.r(t);var n=a("41d2").a,o=(a("1468"),a("17cc")),i=Object(o.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-content",{attrs:{title:e.title}},[a("nav-menu",{attrs:{slot:"header-bar-right",batch:e.batchData,mode:e.batchData.mode,"place-id":e.placeId},slot:"header-bar-right"}),a("synchronize-tip-bar"),a("scroller",{attrs:{"is-empty":e.isLoading},on:{pullDown:e.onPullDown}},[a("item",{staticClass:"bg-sub-theme",attrs:{border:"bottom","icon-right":e.editable?"arrow-right":""},on:{click:e.editPlace}},[a("div",{staticClass:"item-text"},[e._v(e._s(e.placeData.name))]),e.editable?a("div",{staticClass:"item-font color-gray"},[e._v("修改")]):e._e()]),a("tree-base",{attrs:{data:e.listData,"memory-open-set":!0,"icon-position":"right","indent-size":0},on:{onClickNode:e.onClickNode},scopedSlots:e._u([{key:"left",fn:function(t){var n=t.data;return a("div",{staticClass:"tree-text"},[n.treeNodeIsFirst?a("icon",{attrs:{name:"part-title"}}):e._e(),2===e.passrateMode&&n.isDeductionItem&&n.treeNodeIsEnd?a("i",{staticClass:"icon-mark"}):e._e(),e._v("\n        "+e._s(n.name)+"\n      ")],1)}},{key:"right",fn:function(t){var n=t.data;return[n.treeNodeIsEnd?e._e():a("div",{staticClass:"item-font ml5 color-gray3 ws-nowrap"},[e._v("\n          "+e._s(n.unqualifiedNum)+"项不合格\n        ")]),n.treeNodeIsEnd?["不合格"===n.status?a("div",{staticClass:"item-font ml5 color-gray3 mr5"},[e._v("\n            -"+e._s(n.deduction)+"分\n          ")]):e._e(),"未设置"!==n.status?a("div",{staticClass:"item-font"},[a("status-text",{attrs:{status:n.status,extend:e.statusStyleExtend}})],1):e._e(),"未设置"===n.status&&e.editable?a("div",{staticClass:"item-operate"},[a("app-button",{attrs:{type:"operate","has-loading":!1},on:{click:function(t){t.stopPropagation(),e.setUnqualified(n)}}},[e._v("\n              不合格\n            ")])],1):e._e(),"未设置"===n.status&&e.editable?a("div",{staticClass:"item-operate"},[a("app-button",{attrs:{type:"operate","has-loading":!1},on:{click:function(t){t.stopPropagation(),e.setQualified(n)}}},[e._v("\n              合格\n            ")])],1):e._e()]:e._e()]}},{key:"siblings",fn:function(t){var n=t.data;return n.treeNodeIsEnd?a("item",{staticClass:"item-rule",class:{"bg-level-end":n.treeNodeLevel>1},attrs:{border:"bottom"}},[a("div",{staticClass:"item-text"},[e._v(e._s(n.rule&&n.rule.value||""))]),a("check-guide",{staticClass:"special-inspect-guide",attrs:{"item-id":n.special_inspect_id,module:"special-inspect"}})],1):e._e()}}])}),e.editable?a("app-button-group",[a("app-button",{attrs:{type:"text"},on:{click:e.deletePlace}},[e._v("\n        删除测区\n      ")])],1):e._e(),a("loading-status",{attrs:{"is-loading":e.isLoading}})],1)],1)}),[],!1,null,"0d258aee",null);t.default=i.exports},"9e2b":function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,"[data-v-0f3c0354] .layout-content{display:flex;flex-direction:column;overflow:hidden;background:#fff}.zjapp .page-scroll[data-v-0f3c0354]{flex:1;overflow:auto;padding-bottom:100px}.zjapp .bread-crumb[data-v-0f3c0354]{padding:8px 15px;font-size:16px;line-height:30px;color:#999}.zjapp .bread-crumb .level-item i[data-v-0f3c0354]{font-size:12px;margin:0 10px}.zjapp .bread-crumb .level-item:last-child>i[data-v-0f3c0354]{display:none}.zjapp .bread-crumb .active[data-v-0f3c0354]{color:#4275e8}.zjapp .empty-msg[data-v-0f3c0354]{display:flex;align-items:center;justify-content:center;color:#c8c8c8;margin-top:30px}.zjapp .empty-msg .line[data-v-0f3c0354]{width:48px;margin:0 8px;border-top:1px solid #e4e4e4}[data-v-0f3c0354] .icon-qualified{color:#4275e8}.zjapp .place-item[data-v-0f3c0354]{align-items:center}",""])},a2fc:function(e,t,a){"use strict";a.r(t),t.default={mode:3,name:"可打分，按得分率计算总分",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{attrs:[{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"problemNum",name:"问题数量-非末级",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"problemNum"},{key:"score",name:"满分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",filter:"hasData",result:"score || 0"},{key:"deduction",name:"扣分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"Math.min(deduction, score)"},{key:"scoreRate",name:"得分率",type:"number",pattern:"computed",match:"treeNodeIsFirst",result:'hasData ? (score - deduction) / score : ""'}],notes:[{text:"({{ score || 0 }}分)",color:"gray3",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0}}],infos:[{text:"-{{ deduction > score ? score : deduction }}分",color:"red",show:"treeNodeIsFirst && (problemNum || hasData)"},{text:"{{ percent(scoreRate, 2) }}",color:"red",show:"treeNodeIsFirst && (problemNum || hasData)"},{text:"未检",color:"gray3",show:"treeNodeIsFirst && !problemNum && !hasData"},{text:"{{ status }}",type:"status",show:{status:"合格"}},{text:"-{{ deduction || 0 }}分",color:"red",show:{status:"不合格"}},{text:"{{ problemNum }}个问题",color:"gray3",show:'!treeNodeIsFirst && treeNodeIsEnd && problemNum && status !== "合格"'}],btns:[{name:"合格",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"change-status",value:"合格"},{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:"当前综合得分",note:"",calc:[{key:"numerator",name:"得分之和（分子）",match:"treeNodeIsFirst && hasData",value:"score - deduction",text:"{{score - deduction}}"},{key:"denominator",name:"满分之和（分母）",match:"treeNodeIsFirst && hasData",value:"score",text:"{{score}}"}],result:"denominator.value ? numerator.value / denominator.value : 0",hasResult:'batch.status === "检查完毕" || Boolean(denominator.value)',resultType:"percent",formula:"得分＝检查过的项目得分之和/检查过的项目满分之和*100%",formulaCalc:"=\n{{numerator.value}}/{{denominator.value}}*100%={{result}}",formulaText:"{{formula}}{{formulaCalc}}"}}},b464:function(e,t,a){"use strict";a.r(t),t.default={mode:1,name:"可打分，按权重计算总分",navMenu:[{name:"全部问题",code:"allProblem"}],tree:{attrs:[{key:"hasData",name:"有检查数据-末级",type:"boolean",method:"some",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" || status === "不合格"'},{key:"hasData",name:"有检查数据-非末级",type:"boolean",method:"some",pattern:"transmit",match:"!treeNodeIsEnd",result:"hasData"},{key:"deduction",name:"扣分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"deduction || 0"},{key:"deduction",name:"扣分，不超总分",type:"number",pattern:"computed",totalMode:1,match:"treeNodeIsFirst",result:"Math.min(deduction || 0, score || 0)"},{key:"problemNum",name:"问题数量-非末级",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"problemNum"}],infos:[{text:"-{{ deduction > score ? score : deduction }}分",color:"red",show:"treeNodeIsFirst && (problemNum || hasData)"},{text:"满分{{ score || 0 }}",color:"gray3",show:{treeNodeIsFirst:!0}},{text:"{{ status }}",type:"status",show:{status:"合格"}},{text:"-{{ deduction || 0 }}分",color:"red",show:{status:"不合格"}},{text:"{{ problemNum }}个问题",color:"gray3",show:'!treeNodeIsFirst && treeNodeIsEnd && problemNum && status !== "合格"'}],btns:[{name:"合格",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"change-status",value:"合格"},{name:"扣分",show:'!treeNodeIsFirst && treeNodeIsEnd && !problemNum && status !== "合格"',operate:"route-to-edit",formConfig:[{name:"status",value:"不合格"}]}]},total:{title:"当前综合得分",note:"",calc:[{key:"numerator",name:"得分*权重（分子）",match:"treeNodeIsFirst && hasData",value:"(score - deduction) * weight / 100",text:"{{score - deduction}}*{{weight}}%"},{key:"denominator",name:"权重（分母）",match:"treeNodeIsFirst && hasData",value:"weight / 100",text:"{{weight}}%"}],result:"numerator.value / denominator.value",hasResult:"Boolean(denominator.value)",resultType:"number",formula:"得分=∑（有记录的一级检查项得分*该项权重）/∑（有记录的一级检查项权重）",formulaCalc:"=({{numerator.text}})/({{denominator.text}})={{result}}",formulaText:"{{formula}}{{formulaCalc}}"},detailEditForm:[{name:"deduction",label:"倒扣分"}],detailViewForm:[],problemForm:[]}},b48c:function(e,t,a){"use strict";a.r(t),t.default={mode:100,name:"组合嵌套模板",totalMode:"batch.template_extension.total_score_algorithm",defaultTotalMode:1,tree:{attrs:[{key:"algorithm",name:"当前层级算法",pattern:"computed",match:"template_mode === 100",result:"template_extension && template_extension.total_score_algorithm || 1"},{key:"scoreWeightSum",name:"子级“得分*权重”总和",type:"number",pattern:"transmit",match:"template_mode === 100",filter:"hasVal(score)",result:"parseFloat(score) / 100 * parseFloat(weight) / 100"},{key:"scoreWeightSumText",name:"子级“得分*权重”总和，文本",type:"string",pattern:"transmit",match:"template_mode === 100",filter:"hasVal(score)",result:"{{percent(parseFloat(score) / 100, 2)}} * {{weight}}%"},{key:"weightSum",name:"子级“权重”总和",type:"number",pattern:"transmit",match:"template_mode === 100 && algorithm === 2",filter:"hasVal(score)",result:"parseFloat(weight) / 100"},{key:"weightSumText",name:"子级“权重”总和，文本",type:"string",pattern:"transmit",match:"template_mode === 100 && algorithm === 2",filter:"hasVal(score)",result:"{{weight}}%"},{key:"score",name:"当前层级得分-加权",pattern:"computed",match:"template_mode === 100 && algorithm === 1",result:"percent(scoreWeightSum, 2)"},{key:"score",name:"当前层级得分-加权平均",pattern:"computed",match:"template_mode === 100 && algorithm === 2",result:"percent(scoreWeightSum / weightSum, 2)"},{key:"score",name:"得分，百分比显示规范",pattern:"computed",match:'template_mode !== 100 && hasVal(score) && socre.substr(-1) === "%"',result:"percent(parseFloat(score) / 100, 2)"},{key:"formula",name:"得分公式-加权",type:"string",pattern:"computed",match:"template_mode === 100 && algorithm === 1",result:"得分=组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n"},{key:"formulaClac",name:"得分公式-加权，计算过程",type:"string",pattern:"computed",match:"template_mode === 100 && algorithm === 1 && hasVal(score)",result:"={{scoreWeightSumText}}={{score}}"},{key:"formula",name:"得分公式-加权平均",type:"string",pattern:"computed",match:"template_mode === 100 && algorithm === 2",result:"得分=（组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n）/（权重1+权重2+...+权重n）"},{key:"formulaClac",name:"得分公式-加权平均，计算过程",type:"string",pattern:"computed",match:"template_mode === 100 && algorithm === 2 && hasVal(score)",result:"=({{scoreWeightSumText}})/{{weightSumText}}={{score}}"}]},total:[{totalMode:1,title:"总得分",calc:[{key:"scoreWeightSum",name:"得分*权重总和",match:"treeNodeIsFirst && hasVal(score)",value:"parseFloat(score) / 100 * parseFloat(weight) / 100",text:"{{percent(parseFloat(score) / 100, 2)}} * {{weight}}%"},{key:"doneCount",name:"完成检查的数量",match:"treeNodeIsFirst && hasVal(score)",value:"1"}],result:"scoreWeightSum.value",hasResult:"Boolean(doneCount)",resultType:"percent",formula:"得分=组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n",formulaCalc:"={{scoreWeightSum.text}}={{result}}",formulaText:"{{formula}}{{formulaCalc}}"},{totalMode:2,title:"总得分",calc:[{key:"scoreWeightSum",name:"得分*权重总和",match:"treeNodeIsFirst && hasVal(score)",value:"parseFloat(score) / 100 * parseFloat(weight) / 100",text:"{{percent(parseFloat(score) / 100, 2)}} * {{weight}}%"},{key:"weightSum",name:"权重总和",match:"treeNodeIsFirst && hasVal(score)",value:"parseFloat(weight) / 100",text:"{{weight}}%"},{key:"doneCount",name:"完成检查的数量",match:"treeNodeIsFirst && hasVal(score)",value:"1"}],result:"scoreWeightSum.value / weightSum.value",hasResult:"Boolean(doneCount)",resultType:"percent",formula:"得分=（组合评分表1*权重1+组合评分表2*权重2+...+组合评分表n*权重n）/（权重1+权重2+...+权重n）",formulaCalc:"=({{scoreWeightSum.text}})/({{weightSum.text}})={{result}}",formulaText:"{{formula}}{{formulaCalc}}"}]}},b66d:function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,'.zjapp .tree-node[data-v-0083fc0a]{display:flex;flex-direction:row;align-items:center;justify-content:center;padding:8px 15px}.zjapp .tree-main[data-v-0083fc0a]{flex:1}.zjapp .tree-text[data-v-0083fc0a]{font-size:14px;color:#333;line-height:20px;padding:5px 0;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2}.zjapp .tree-indent[data-v-0083fc0a]{width:14px;height:20px}.zjapp .tree-icon[data-v-0083fc0a]{position:relative;width:20px;height:20px;line-height:20px;color:#c8c8c8;font-size:26px}.zjapp .icon-dropdown[data-v-0083fc0a]:before,.zjapp .icon-dropright[data-v-0083fc0a]:before{content:"";position:absolute;width:0;height:0;border:6px solid #c8c8c8}.zjapp .icon-dropdown[data-v-0083fc0a]:before{top:7px;left:0;border-left-color:transparent}.zjapp .icon-dropdown[data-v-0083fc0a]:before,.zjapp .icon-dropright[data-v-0083fc0a]:before{border-right-color:transparent;border-bottom-color:transparent}.zjapp .icon-dropright[data-v-0083fc0a]:before{top:4px;left:2px;border-top-color:transparent}.zjapp .icon-right[data-v-0083fc0a]{margin-left:10px;color:#c8c8c8;line-height:30px}',""])},bfb1:function(e,t,a){"use strict";a.r(t),t.default={mode:2,name:"无打分，仅记录是否合格，计算合格率",tree:{attrs:[{key:"status",name:"草稿状态处理，不合格的草稿状态保存在 problem，没有存在检查项",type:"string",pattern:"computed",match:'treeNodeIsEnd && status === "未设置" && problem_id',result:"草稿"},{key:"qualifiedNum",name:"合格的数量-末级",type:"number",pattern:"computed",match:"treeNodeIsEnd",result:'status === "合格" ? 1 : 0'},{key:"qualifiedNum",name:"合格的数量-非末级",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"qualifiedNum"},{key:"unqualifiedNum",name:"不合格的数量",type:"number",pattern:"computed",match:"treeNodeIsEnd",result:'status === "不合格" ? 1 : 0'},{key:"unqualifiedNum",name:"不合格的数量",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"unqualifiedNum"}],infos:[{text:"{{ unqualifiedNum || 0 }}项不合格",color:"gray3",show:{treeNodeIsFirst:!0}},{text:"{{ status }}",type:"status",show:'status !== "未设置" && status !== "已甩项"'},{text:"{{ status }}",type:"status",show:'!editable && status === "已甩项"'}],btns:[{name:"登记",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"route-to-edit"},{name:"甩项",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"未设置"},operate:"change-status",value:"已甩项",tips:"甩项成功"},{name:"取消甩项",show:{treeNodeIsFirst:!1,treeNodeIsEnd:!0,status:"已甩项"},operate:"change-status",value:"未设置",tips:"取消甩项"}]},total:{title:"当前合格率",note:"{{ unqualifiedNum.value }}项不合格",calc:[{key:"qualifiedNum",name:"合格项总数",match:"treeNodeIsFirst",value:"qualifiedNum",text:"{{qualifiedNum}}"},{key:"unqualifiedNum",name:"不合格项数",match:"treeNodeIsFirst",value:"unqualifiedNum",text:"{{unqualifiedNum}}"}],result:"Boolean(qualifiedNum.value + unqualifiedNum.value) ? qualifiedNum.value / (qualifiedNum.value + unqualifiedNum.value) : 0",hasResult:'batch.status === "检查完毕" ? true : Boolean(qualifiedNum.value + unqualifiedNum.value)',resultType:"percent",formula:"合格率=合格项总数/（合格项数+不合格项数）*100%",formulaCalc:"={{qualifiedNum.value}}/{{qualifiedNum.value + unqualifiedNum.value}}*100%={{result}}",formulaText:"{{formula}}{{formulaCalc}}"},detailEditForm:[{name:"deduction",display:!1,relations:[]}],finishBatchCheck:[{isFilterFirst:!0,statusTotalConfig:[{status:"未设置",key:"a"},{status:"草稿",key:"b"}],match:"a + b > 0",msg:"有未检查的检查项，请检查完之后重试"}],detailViewForm:[],problemForm:[]}},c090:function(e,t,a){var n=a("535a");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("85cb").default)("3acca9c2",n,!0,{sourceMap:!1,shadowMode:!1})},c1d9:function(e,t,a){"use strict";a.r(t),t.default={mode:11,name:"观感效果",navMenu:[{name:"全部问题",code:"allProblem"}],detailEditForm:[{name:"rule",display:!0}],detailViewForm:[{name:"rule",display:!0}]}},c726:function(e,t,a){"use strict";var n=a("329b"),o=(a("5ab2"),a("28f8")),i=(a("ed63"),a("8cf2"),a("e697"),a("6d57"),a("e10e"),a("cc57"),a("e204"),a("e89f")),r=a("07d2"),s=a("4e84");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(o.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=["building","unit","floor","room"],d=["unit"],m={name:"PlaceSelectDialog",components:{Item:r.default},mixins:[i.a],data:function(){return{show:!1,isLoading:!0,title:"",items:[],optionalItems:[],curItem:"",options:[],hasUnit:!1,projectId:"",sectionId:"",selected:{},defaultSelected:{},beforeConfirm:function(){},callback:function(){}}},computed:{crumbs:function(){var e=[],t=this.items,a=this.curItem,n=t.findIndex((function(e){return e===a}));if(n>=0)for(var o=0;o<=n;o++){var i=t[o],r=t[o-1],s=r?this.selected[r]&&this.selected[r].name:"全部";("unit"!==r||s)&&e.push({name:s,item:i})}return e},hasSelected:function(){return!!this.selected&&!!Object.keys(this.selected).length},prevItem:function(){var e=this,t=this.items.findIndex((function(t){return t===e.curItem}));return this.items[t-1]},nextItem:function(){var e=this,t=this.items.findIndex((function(t){return t===e.curItem}));return this.items[t+1]}},methods:{open:function(e){if(this.items=e.items||l,this.optionalItems=e.optionalItems||d,!this.items||!this.items.length)return Promise.reject(new Error("palce-select open() 参数错误"));this.curItem=this.items[0],this.projectId=e.projectId,this.sectionId=e.sectionId,this.defaultSelected=e.selected,this.title=e.title,this.beforeConfirm="function"==typeof e.beforeConfirm?e.beforeConfirm:function(){},this.callback="function"==typeof e.callback?e.callback:function(){},this.init(),this.show=!0},close:function(){this.show=!1},getDefaultId:function(e){if(!this.defaultSelected)return"";var t=this.defaultSelected[e];switch(e){case"section":return t&&t.id||"";case"building":return this.defaultSelected.building_id||t&&t.id||"";case"unit":return this.defaultSelected.unit_id||t&&t.id||"";case"floor":return("string"==typeof t?t:t&&t.id)||"";case"room":return this.defaultSelected.room_id||t&&t.id||""}},init:function(){var e=this,t=Promise.resolve(),a=!0;return this.selected={},this.curItem=this.items[0],this.items.forEach((function(n){t=t.then((function(){if(a)return e.getOptions(n).then((function(t){var o=e.getDefaultId(n),i=o&&(t||[]).find((function(e){return e.id===o}));if(!t||!t.length)return e.$set(e.selected,n,null),void(a=!!e.optionalItems.includes(n));i?(e.$set(e.selected,n,u({},i)),e.options=t,e.curItem=n,a=!0):(n===e.items[0]&&(e.options=t),a=!1)}))}))})),t},crumbClick:function(e){var t=this;this.curItem=e.item;var a=this.items.findIndex((function(e){return e===t.curItem}));return this.clearChildrenFromIndex(a),this.getOptions().then((function(e){if(t.options=e,"unit"===t.curItem&&(!t.options||!t.options.length)&&t.nextItem)return t.curItem=t.nextItem,t.getOptions().then((function(e){t.options=e}))}))},clearChildrenFromIndex:function(e){for(var t=this.items,a=e;a<t.length;a++){var n=t[a];this.$delete(this.selected,n)}},getOptions:function(e){var t=this;this.isLoading=!0,e=e||this.curItem;var a=this.items;return Promise.resolve().then((function(){var n=t.projectId,o=t.sectionId||t.selected&&t.selected.section&&t.selected.section.id,i=t.selected&&t.selected.building&&t.selected.building.id,r=t.selected&&t.selected.unit&&t.selected.unit.id,c=t.selected&&t.selected.floor&&t.selected.floor.id;switch(e){case"section":return s.a.getSections(n);case"building":return a.some((function(e){return"section"===e}))?s.a.getBuildingsBySection(o):s.a.getBuildingsByProject(n);case"unit":return s.a.getUnits(i);case"floor":return s.a.getFloors(i);case"room":return s.a.getRooms(i,r,c)}})).then((function(a){return"unit"===e&&(t.hasUnit=a&&a.length),a})).catch((function(e){$log.error(e)})).finally((function(){t.isLoading=!1}))},selectedItem:function(e){var t=this,a=this.items,n=this.curItem;if(n&&e){this.$set(this.selected,n,u({},e));var o=a.findIndex((function(e){return e===n}));this.clearChildrenFromIndex(o+1),this.nextItem?(this.curItem=this.nextItem,this.getOptions().then((function(e){if(t.options=e,"unit"===t.curItem&&(!t.options||!t.options.length)&&t.nextItem)return t.curItem=t.nextItem,t.getOptions().then((function(e){t.options=e}))})).then((function(){t.options&&t.options.length||t.finish()}))):this.finish()}},finish:function(){var e=this,t={fullname:""};this.items.forEach((function(a){var n=e.selected[a];n&&(t[a]=n,"floor"===a&&e.selected.room||(t.fullname+=n.name))}));var a=this.beforeConfirm&&this.beforeConfirm(t);a instanceof Promise||(a=Promise.resolve(a)),a.then((function(a){if(!1===a)return!1;e.callback&&e.callback(t)}))}}},p=(a("3e1e"),a("17cc")),h=Object(p.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"slide-right"}},[e.show?a("page-content",{attrs:{mode:"dialog",title:e.title,"on-close":e.close}},[a("div",{staticClass:"bread-crumb"},e._l(e.crumbs,(function(t){return a("span",{key:t.item,staticClass:"level-item",class:{active:t.item===(e.hasUnit||"unit"!==e.prevItem?e.curItem:e.prevItem)},on:{click:function(a){e.crumbClick(t)}}},[e._v("\n        "+e._s(t.name)),a("icon",{attrs:{name:"arrow-right"}})],1)}))),!e.isLoading&&e.options.length?a("div",{ref:"placeSelectScroll",staticClass:"page-scroll"},[e._l(e.options,(function(t,n){return a("item",{key:n,staticClass:"border-bottom place-item",attrs:{text:t.name,"icon-right":e.selected[e.curItem]&&e.selected[e.curItem].id===t.id?"qualified":""},on:{click:function(a){e.selectedItem(t)}}})})),a("div",{staticClass:"empty-msg"},[a("span",{staticClass:"line"}),e._v("\n        就这么多了\n        "),a("span",{staticClass:"line"})])],2):e._e(),!e.isLoading&&e.options.length?a("app-button-group",{attrs:{"fixed-bottom":""}},[a("app-button",{attrs:{disabled:!e.hasSelected},on:{click:e.finish}},[e._v("\n        确定\n      ")])],1):e._e(),a("loading-status",{attrs:{"is-loading":e.isLoading,"is-empty":!e.options||!e.options.length,"empty-text":"没有信息"}})],1):e._e()],1)}),[],!1,null,"0f3c0354",null).exports,f=!1;f||(f=new(n.default.extend(h))({el:document.createElement("div")}),document.body.appendChild(f.$el));t.a=f},d1d1:function(e,t,a){"use strict";(function(e){var n=a("fd50"),o=a("bcc7"),i=a("515e"),r=a("07d2"),s=a("7bac"),c=a("a7c3"),u=a("4360");t.a={name:"CheckGuideList",components:{Item:r.default},store:u.a,data:function(){return{isLoading:!0,listData:[],module:"",itemId:"",batchId:"",sectionId:"",options:""}},computed:{moduleAttribute:function(){return this.$store.state.global.moduleAttribute}},methods:{init:function(t){var a,o=this;for(var i in this.module=t.module,this.itemId=t.itemId,this.batchId=t.batchId,this.sectionId=t.sectionId,this.options=t.options,t)this[i]=t[i];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module];var r=!1;e.isEmpty(this.itemId)?!e.isEmpty(this.checkType)&&e.isEmpty(this.sectionId)?a=this.initByType():e.isEmpty(this.batchId)?e.isEmpty(this.options)?e.isEmpty(this.sectionId)?a=n.a.when():(r=!0,a=this.initByBidsection()):a=this.initByOptions():a=this.initByBatch():a=this.initById(),this.isLoading=!0,a.then((function(t){var a=o.moduleAttribute[o.module]||{};!e.isEmpty(a)&&a.setUsualItems&&r?s.a.getUserKey(o.mmkvCode()).then((function(e){e=null===e?t:o.mergeArray(o.deepClone(t),e),o.listData=e||[],o.isLoading=!1})):(o.listData=t||[],o.isLoading=!1)}))},mmkvCode:function(){var e=this.moduleAttribute[this.module]||{};return c.a[e.mmkv_item]+"_"+this.sectionId},mergeArray:function(t,a){var n=this;return e.filter(t,(function(t){var o=a[t.id];return e.isEmpty(t.subitem)||(t.subitem=n.mergeArray(t.subitem,a)),!e.isEmpty(o)||"desc"===t.type}))},clickItem:function(e){e.subitem&&e.subitem.length?this.$set(e,"isOpen",!e.isOpen):"special-inspect"===this.module?i.a.openPopup({itemId:e.id,module:this.module}):i.a.openPopup({itemId:e.item_id,module:this.module})},initById:function(){var e=this;if("special-inspect"!==this.module)return o.a.getCheckItem(this.itemId,this.checkType).then((function(t){return t?e.sectionId?o.a.getBidSectionCheckItemListByCode(e.sectionId,t.code):o.a.getCheckItemTreeByCode(t.code):n.a.when()}))},initByType:function(){return o.a.getCheckItemGuidelineList(this.checkType)},initByBatch:function(){return n.a.when()},initByBidsection:function(){return o.a.getBidSectionCheckItemTreeByType(this.sectionId,this.checkType)},initByOptions:function(){return n.a.resolve(this.options)},deepClone:function(e){return JSON.parse(JSON.stringify(e))}}}}).call(this,a("391c"))},dc98:function(e,t,a){"use strict";a("0732")},dd16:function(e,t,a){"use strict";(function(e){t.a={name:"StatusText",props:{status:{type:String},text:{type:String},extend:{type:Object,default:function(){return{}}},statusStyles:{type:Object,default:function(){return{}}}},data:function(){return{classSet:e.extend({"草稿":"color-gray","暂存":"color-gray","检查中":"color-orange","待整改":"color-red","待复验":"color-orange","待验收":"color-red","待报验":"color-red","待申请进场":"color-red","待初验":"color-red","待送检":"color-red","待上传报告":"color-red","待退场":"color-red","待建设单位验收":"color-red","待区域验收":"color-red","供应链退回":"color-red","预创建":"color-status-blue","已提交":"color-green","已整改":"color-green","已验收":"color-green","已通过":"color-green","已退场":"color-gray","已关闭":"color-gray","非正常关闭":"color-gray","已退回":"color-red","已完成":"color-green","已甩项":"color-gray","检查完毕":"color-green","送检合格":"color-green","复验合格":"color-green","验收合格":"color-green","验收不合格":"color-red","未验收":"color-orange","待点评":"color-orange","已点评":"color-green","合格":"color-green","不合格":"color-red","待审核":"color-orange","已发布":"color-green","已拒绝":"color-red","进度正常":"color-green","进度滞后":"color-red","正常":"color-green","滞后":"color-red","施工单位验收合格":"color-green","监理单位验收合格":"color-green","建设单位验收合格":"color-green","施工单位验收不合格":"color-red","监理单位验收不合格":"color-red","建设单位验收不合格":"color-red"},this.extend)}},mounted:function(){}}}).call(this,a("391c"))},def6:function(e,t,a){"use strict";a.r(t),t.default={mode:10,name:"加/扣分",navMenu:[{name:"全部问题",code:"allProblem",match:"batch.template_extension.score_mode === 2"}],totalMode:"batch.template_extension.score_mode",defaultTotalMode:1,tree:{attrs:[{key:"deduction",name:"扣分/加分",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"deduction || 0"}],infos:[{text:"{{ status }}",type:"status",show:'status === "草稿"'},{totalMode:1,text:'{{deduction ? "+" : ""}}{{ deduction }}',color:"gray",show:"treeNodeIsFirst && !treeNodeIsEnd"},{totalMode:2,text:'{{deduction ? "-" : ""}}{{ deduction }}',color:"gray",show:"treeNodeIsFirst && !treeNodeIsEnd"},{totalMode:1,text:"+{{ deduction }}",color:"green",show:'treeNodeIsEnd && status !== "草稿" && status !== "未设置"'},{totalMode:2,text:"-{{ deduction }}",color:"red",show:'treeNodeIsEnd && status !== "草稿" && status !== "未设置"'}],btns:[{name:"打分",show:{treeNodeIsEnd:!0,status:"未设置"},operate:"route-to-edit"}]},total:[{totalMode:1,title:"当前综合得分",calc:[{key:"deductionSum",name:"加分值之和",match:'treeNodeIsEnd && status !== "未设置" && status !== "草稿"',value:"deduction"},{key:"doneCount",name:"已测的数量",match:'status !== "未设置" && status !== "草稿"',value:"1"}],result:"deductionSum.value",hasResult:'batch.status === "检查完毕" || Boolean(doneCount.value)',resultType:"number",numberFixed:!1,formula:"当前综合得分=加分值之和",formulaCalc:"={{result}}",formulaText:"{{formula}}{{formulaCalc}}"},{totalMode:2,title:"当前综合得分",calc:[{key:"deductionSum",name:"扣分值之和",match:'treeNodeIsEnd && status !== "未设置" && status !== "草稿"',value:"deduction"},{key:"doneCount",name:"已测的数量",match:'status !== "未设置" && status !== "草稿"',value:"1"}],result:"-deductionSum.value",hasResult:'batch.status === "检查完毕" || Boolean(doneCount.value)',resultType:"number",numberFixed:!1,formula:"当前综合得分=扣分值之和",formulaCalc:"={{result}}",formulaText:"{{formula}}{{formulaCalc}}"}]}},e89f:function(e,t,a){"use strict";var n=a("04f3"),o=a("cf09"),i=a("4360"),r=0;t.a={name:"PopupMixin",data:function(){return{backButtonEvent:null}},watch:{show:function(e){var t=this;if(e){if(this.$nextTick((function(){t.$el&&t.$el.style&&(t.$el.style.zIndex=++o.a.zIndex,r++,i.a.commit("app/SET_HAS_POPUP",!!r))})),!this.backButtonEvent){var a=this.close||this.closePopup;this.backButtonEvent=Object(n.a)(a)}}else--r<0&&(r=0),i.a.commit("app/SET_HAS_POPUP",!!r),this.backButtonEvent&&(Object(n.c)(this.backButtonEvent),this.backButtonEvent=null)}},methods:{}}},e8cb:function(e,t,a){"use strict";a.r(t),t.default={mode:99,name:"组合模板",totalMode:"batch.template_extension.total_score_algorithm",defaultTotalMode:1,total:[{totalMode:1,title:"总得分",note:'{{hasResult ? "" : "未检查完毕"}}',calc:[{key:"scoreWeight",name:"得分*权重总和",match:'status === "检查完毕"',value:"(parseFloat(score) || 0) / 100 * weight / 100",text:'{{(score.includes("%") ? score : score + "%")}}*{{weight}}%'},{key:"finishCount",name:"检查完毕的数量",match:'status === "检查完毕"',value:"1"}],result:"scoreWeight.value",hasResult:"Boolean(finishCount.value)",resultType:"percent",formula:"总分=得分1*权重1+...+得分n*权重n",formulaCalc:"=({{scoreWeight.text}})={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},{totalMode:2,title:"总得分",note:'{{hasResult ? "" : "未检查完毕"}}',calc:[{key:"scoreWeight",name:"得分*权重总和",match:'status === "检查完毕"',value:"(parseFloat(score) || 0) / 100 * weight / 100",text:'{{(score.includes("%") ? score : score + "%")}}*{{weight}}%'},{key:"weightSum",name:"权重总和",match:'status === "检查完毕"',value:"weight / 100",text:"{{weight}}%"},{key:"finishCount",name:"检查完毕的数量",match:'status === "检查完毕"',value:"1"}],result:"scoreWeight.value / weightSum.value",hasResult:"Boolean(finishCount.value)",resultType:"percent",formula:"总分 = (得分1*权重1+...+得分n*权重n) / (权重1+…+权重n)",formulaCalc:"=({{scoreWeight.text}}) / ({{weightSum.text}})={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"}]}},e9ea:function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,".zjapp .guide-box[data-v-ff0679ce]{flex:1;display:flex}.zjapp .page-scroll[data-v-ff0679ce]{flex:1;overflow:auto;padding-bottom:100px;transform:translateZ(0)}.zjapp .sublist[data-v-ff0679ce]{padding-left:25px;padding-top:1px;background-color:#fff}.zjapp .sublist>.sublist[data-v-ff0679ce]{padding-left:10px;padding-top:0}",""])},ef1c:function(e,t,a){var n=a("e9ea");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("85cb").default)("2e832052",n,!0,{sourceMap:!1,shadowMode:!1})},f1e4:function(e,t,a){"use strict";(function(e){a("5ab2"),a("e10e");var n=a("28f8"),o=(a("9e76"),a("6d57"),a("9a33"),a("f548"),a("cc57"),a("4ad6")),i=a("e89f"),r=a("bcc7"),s=a("3122"),c=a("6e1b"),u=a("c130"),l=a("0636");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a={name:"CheckGuideDetail",components:{},mixins:[i.a],data:function(){return{show:!1,isLoading:!0,isImageDownloading:!1,title:"",content:[],module:"",itemId:""}},methods:{openPopup:function(t){var a=this;for(var n in this.value=!0,this.show=!0,this.module=t.module,this.itemId=t.itemId,this.$emit("open"),t)this[n]=t[n];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module],this.isLoading=!0,("special-inspect"===this.module?c.a.getSpecialInspectCheckItemDetail(this.itemId):"templet-plan"===this.module?u.a.getTempletDetail(this.itemId):"material"===this.module?l.a.getMaterialDetail(this.itemId):r.a.getCheckItem(this.itemId,this.checkType)).then((function(t){console.log("checkitemData",t),t=t||{},a.checkitemData=t,a.title=t.full_name||t.name,"special-inspect"!==a.module&&"inspect"!==a.module&&"fly-inspect"!==a.module&&"material"!==a.module||(t.content=t.guideline||t.content);var n=t.content?t.content.trim():"";if(n=(n=(n=(n=(n=n.replace(/<\/p><p>/gm,"\n")).replace(/<p>/gm,"")).replace(/<\/p>/gm,"")).replace(/<br>/gm,"")).replace(/<br \/>/gm,""),/(<img[^\>]*>)/gm.test(n)){var o=n.split(/(<img[^\>]*>)/gm);(o=o.filter((function(e){return!!e}))).forEach((function(e,t){e&&!/^\s*\n/.test(e)&&t&&!/\n\s*$/.test(o[t-1])&&(o[t]="\n"+e)})),n=o.join("")}var i=n?n.split("\n"):[];a.content=e.map(i,(function(e,t){var a;if(/<img([\s\S]*)>/gm.test(e)){var n=e.split(/\ssrc="([^"]*)"/gm)[1],o=n?n.match(/[\w|-]{36}/gm)[0]:(new Date).getTime()+"-"+t;a={isImg:!0,src:"",url:n,status:"pending",id:o,ready:!0}}else a={isImg:!1,val:e};return a})),a.downloadImage(),a.isLoading=!1})).catch((function(e){$log.log(e)}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},getThumbnail:function(e){return"pending"===e.status?s.a.IMAGE_LOADING:"rejected"===e.status?s.a.IMAGE_RELOAD:"dev"===APP_ENV?e.url:"fulfilled"===e.status?e.src:($log.log("检查指引-显示图片：",e),s.a.IMAGE_PLACEHOLD)},imgError:function(e,t){$log.error("检查指引-加载图片出现错误：",e);var a=m({},e);a.status="rejected",this.$set(this.content,t,a)},downloadImage:function(t){var a=this;t=t?[t]:this.imageList(),e.each(t,(function(t){var n=m({},t),o=e.map(a.content,(function(e){return e.id})).indexOf(t.id);s.a.isNeedDownload(t.url).then((function(e){e?s.a.download(t.url).then((function(e){n.status="fulfilled",n.src=s.a.fixUrl(e),a.$set(a.content,o,n)})).catch((function(e){$log.error("检查指引-下载图片：",e)})):(n.status="fulfilled",n.src=s.a.fixUrl(s.a.getPathFromUrl(t.url)),a.$set(a.content,o,n))}))}))},imageList:function(){return e.filter(this.content,(function(e){return e.isImg}))},imgClick:function(t){var a=this;if("pending"===t.status)return!1;if("rejected"===t.status)return this.downloadImage(t),$log.log("检查指引-点击重新加载-重新下载图片：",t),!1;var n=this.imageList(),i=e.map(n,(function(e){return e.id})).indexOf(t.id);n=e.map(n,(function(e){return a.getThumbnail(e)})),o.a.openImageBrowser(n,i)}}}}).call(this,a("391c"))},f369:function(e,t,a){"use strict";var n=a("fd50"),o=a("bcc7"),i=a("329b"),r=a("d1d1").a,s=(a("3411"),a("17cc")),c={name:"CheckGuideList",components:{GuideList:Object(s.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"guide-box"},[!e.isLoading&&e.listData.length?a("div",{staticClass:"page-scroll"},e._l(e.listData,(function(t,n){return a("div",{key:n},[a("item",{attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){e.clickItem(t)}}},[a("div",{staticClass:"item-text fw-b color-blue one-line"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,n){return a("div",{key:n,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){e.clickItem(t)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,n){return a("div",{key:n,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){e.clickItem(t)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])]),t.isOpen?e._l(t.subitem,(function(t,n){return a("div",{key:n,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":t.subitem&&t.subitem.length?t.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){e.clickItem(t)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[e._v(e._s(t.item_name))])])],1)})):e._e()],2)})):e._e()],2)})):e._e()],2)}))):e._e(),a("loading-status",{attrs:{"is-loading":e.isLoading,"is-empty":!e.listData.length,"empty-text":"没有检查项"}})],1)}),[],!1,null,"ff0679ce",null).exports},mixins:[a("e89f").a],data:function(){return{show:!1}},methods:{openPopup:function(e){var t=this;this.value=!0,this.show=!0,this.$nextTick((function(){t.$refs["guide-list"].init(e),t.$emit("open")}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")}}},u=Object(s.a)(c,(function(){var e=this.$createElement,t=this._self._c||e;return t("transition",{attrs:{name:"slide-right"}},[this.show?t("page-content",{attrs:{mode:"dialog",title:"检查指引","on-close":this.closePopup}},[t("guide-list",{ref:"guide-list"})],1):this._e()],1)}),[],!1,null,null,null).exports,l=!1;l||(l=new(i.default.extend(u))({el:document.createElement("div")}),document.body.appendChild(l.$el));var d=l,m=a("515e"),p=a("91c1").a,h=(a("dc98"),Object(s.a)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.show?a("div",{staticClass:"main",style:{top:e.contentTop+"px"}},[a("i",{staticClass:"arrow"}),a("div",{staticClass:"content",on:{click:function(t){return t.target!==t.currentTarget?null:e.closePopup(t)}}},[a("transition",{attrs:{name:"slide-down"},on:{enter:function(t){e.isOpening=!0},"after-enter":function(t){e.isOpening=!1},leave:function(t){e.isClosing=!0},"after-leave":e.afterClose}},[e.showList?a("div",{staticClass:"box",style:{height:e.listHeight+"px"}},e._l(e.data,(function(t,n){return a("div",{key:n,class:{"border-bottom":e.data.length>1,"box-single":1===e.data.length}},[a("div",{staticClass:"detail-hd",class:{"border-bottom":e.data.length<=1,"detail-hd-single":e.data.length<=1},on:{click:function(a){e.toggleItem(t)}}},[e.data.length>1?a("i",{class:{"detail-arrow-right":!t.isOpen,"detail-arrow-down":t.isOpen}}):e._e(),a("div",{staticClass:"detail-title"},[e._v(e._s(t.name))])]),e.data.length<=1||t.isOpen?a("div",{staticClass:"detail-bd",class:{"detail-bd-single":e.data.length<=1}},[e._l(t.textArr,(function(t,n){return a("p",{key:n,staticClass:"text-line"},[e._v("\n              "+e._s(t)+"\n            ")])})),a("item-img-list",{attrs:{editabled:!1},model:{value:t.contentImage,callback:function(a){e.$set(t,"contentImage",a)},expression:"item.contentImage"}}),a("loading-status",{attrs:{"is-empty":!t.textArr.length&&!t.contentImage.length,"empty-text":"PC端未设置检查指引"}})],2):e._e()])}))):e._e()])],1)]):e._e()}),[],!1,null,"2cac8864",null).exports),f=!1;f||(f=new(i.default.extend(h))({el:document.createElement("div")}),document.body.appendChild(f.$el));var g=f,b={name:"CheckGuide",components:{},props:{module:{type:String,default:""},mode:{type:String,default:"page"},itemId:{type:String,default:""},itemIds:{type:Array,default:function(){return[]}},batchId:{type:String,default:""},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}},optionsPromise:{type:Function,default:function(){}},beforeOpen:{type:Function,default:function(){}}},data:function(){return{isLoading:!1}},methods:{openCheckGuide:function(){var e=this,t=this.beforeOpen&&this.beforeOpen();t instanceof Promise||(t=Promise.resolve(t)),t.then((function(t){!1!==t&&("drop"===e.mode?g.openPopup({itemIds:e.itemIds,el:e.$refs["check-guide-btn"],options:e.options}):("templet-plan"===e.module?n.a.when(!1):e.itemId&&e.sectionId?o.a.hasChildSectionCheckItem(e.itemId,e.sectionId):e.itemId?o.a.hasChildCheckItem(e.itemId):n.a.when(!0)).then((function(t){t?d.openPopup({module:e.module,itemId:e.itemId,batchId:e.batchId,sectionId:e.sectionId,options:e.options}):m.a.openPopup({itemId:e.itemId,module:e.module})})))}))}}},y=Object(s.a)(b,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"check-guide-btn",staticClass:"header-btn",on:{click:function(t){e.openCheckGuide()}}},[a("icon",{attrs:{name:"nav-info"}})],1)}),[],!1,null,null,null);t.a=y.exports},f6b4f:function(e,t,a){"use strict";a.r(t),t.default={mode:7,name:"实测实量",totalMode:"batch.template_extension.pass_rate_mode",defaultTotalMode:1,tree:{style:'{{batch.status === "检查完毕" ? "finished" : "default"}}',attrs:[{key:"weight",name:"权重",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:"weight || 0",totalMode:3},{key:"measurement_points",name:"实测点数",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:'treeNodeIsEnd && status !== "检查完毕" ? 0 : measurement_points || 0'},{key:"problem_points",name:"问题点数",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",result:'treeNodeIsEnd && status !== "检查完毕" ? 0 : problem_points || 0'},{key:"passrate",name:"合格率",type:"number",pattern:"computed",result:'measurement_points ? (measurement_points - problem_points) / measurement_points : ""'},{key:"passrateWeightSum",name:"合格率*权重 汇总",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",filter:"measurement_points",result:"passrate * (weight || 0) / 100",totalMode:3},{key:"weightSum",name:"权重 汇总",type:"number",pattern:"transmit",match:"!treeNodeIsEnd",filter:"measurement_points",result:"(weight || 0) / 100",totalMode:3}],notes:[{text:"({{ weight || 0 }}%)",color:"black",show:"treeNodeIsFirst",totalMode:2},{text:"({{ weight || 0 }}%)",color:'{{batch.status === "检查中" || treeNodeIsFirst ? "black" : "gray"}}',totalMode:3}],infos:[{text:"{{ percent(passrate, 2) }}",color:'{{batch.status === "检查中" ? "gray" : "black"}}',show:"treeNodeIsFirst",totalMode:1},{text:"{{ percent(passrate, 2) }}",color:'{{batch.status === "检查中" ? "gray" : "black"}}',show:"treeNodeIsFirst",totalMode:2},{text:"{{ percent(passrateWeightSum / weightSum, 2) }}",color:'{{batch.status === "检查中" ? "gray" : "black"}}',show:"treeNodeIsFirst && measurement_points",totalMode:3},{text:"暂存",color:"orange",show:'treeNodeIsEnd && status === "检查中"'},{text:"{{percent(passrate, 2)}}",color:'{{batch.status === "检查中" ? "gray" : "black"}}',show:'treeNodeIsEnd && status === "检查完毕"'}]},total:[{totalMode:1,title:'{{batch.status === "检查中" ? "当前" : ""}}合格率',calc:[{key:"measurement_points",name:"总实测点数",match:'treeNodeIsEnd && status === "检查完毕"',value:"measurement_points",text:"{{measurement_points}}"},{key:"qualified_points",name:"总合格点数",match:'treeNodeIsEnd && status === "检查完毕"',value:"measurement_points - problem_points",text:"{{measurement_points - problem_points}}"}],result:"qualified_points.value / measurement_points.value",hasResult:"Boolean(measurement_points.value)",resultType:"percent",formula:"总合格率=总合格点数/总实测点数*100%",formulaCalc:"={{qualified_points.value}}/{{measurement_points.value}}*100%={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},{totalMode:2,title:'{{batch.status === "检查中" ? "当前" : ""}}合格率',calc:[{key:"passrateWeightSum",name:"一级检查项合格率*权重和",match:"treeNodeIsFirst && measurement_points",value:"passrate * (weight || 0) / 100",text:"{{percent(passrate, 2)}}*{{weight || 0}}%"},{key:"weightSum",name:"一级检查项权重总和",match:"treeNodeIsFirst && measurement_points",value:"(weight || 0) / 100",text:"{{weight || 0}}%"}],result:"passrateWeightSum.value / weightSum.value",hasResult:"Boolean(weightSum.value)",resultType:"percent",formula:"总合格率 = ( 一级检查项1合格率*一级检查项1权重+一级检查项2合格率*一级检查项2权重+...+一级检查项n合格率*一级检查项n权重) / (一级检查项1权重+一级检查项2权重+...+一级检查项n权重)",formulaCalc:"=({{passrateWeightSum.text}})/({{weightSum.text}})={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"},{totalMode:3,title:'{{batch.status === "检查中" ? "当前" : ""}}合格率',calc:[{key:"passrateWeightSum",name:"末级检查项合格率*权重和",match:"treeNodeIsEnd && measurement_points",value:"passrate * (weight || 0) / 100",text:"{{percent(passrate, 2)}}*{{ (weight || 0)}}%"},{key:"weightSum",name:"末级检查项权重总和",match:"treeNodeIsEnd && measurement_points",value:"(weight || 0) / 100",text:"{{ (weight || 0)}}%"}],result:"passrateWeightSum.value / weightSum.value",hasResult:"Boolean(weightSum.value)",resultType:"percent",formula:"总合格率 = ( 末级检查项1合格率*末级检查项1权重+末级检查项2合格率*末级检查项2权重+...+末级检查项n合格率*末级检查项n权重) / (末级检查项1权重+末级检查项2权重+...+末级检查项n权重)",formulaCalc:"=({{passrateWeightSum.text}})/({{weightSum.text}})={{result}}",formulaText:"{{formula}}\n{{formulaCalc}}"}],finishBatchCheck:[{isFilterFirst:!1,statusTotalConfig:[{status:"检查完毕",key:"a"},{status:"不合格",key:"b"}],match:"a <= 0",type:"alert",msg:"至少1项有记录"},{isFilterFirst:!1,statusTotalConfig:[{status:"检查中",key:"a"}],calc:"a > 0",type:"notify",msg:'有<span class="color-orange pl5 pr5">{{a}}</span>项暂存，请先填写完整或删除草稿后再提交'}]}},f7ab:function(e,t,a){"use strict";var n=a("65e9").a,o=(a("f7d4"),a("17cc")),i=Object(o.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.show?a("div",{ref:"synchronize-tip-bar",staticClass:"synchronize-tip-bar"},[a("icon",{attrs:{name:"caution"}}),e.waitUploadNum?a("span",[e._v("您有"+e._s(e.waitUploadNum)+"条数据待上传")]):e._e(),!e.waitUploadNum&&e.hasChanged?a("span",[e._v("有新数据")]):e._e(),e._v("\n  ，下拉可"+e._s(e.waitUploadNum?"上传":"刷新")+"\n")],1):e._e()}),[],!1,null,"66826030",null);t.a=i.exports},f7d4:function(e,t,a){"use strict";a("2d6e")},f8e9:function(e,t,a){var n=a("5454");(e.exports=a("690e")(!1)).push([e.i,"[data-v-0d258aee] .tree-list{margin-bottom:10px}[data-v-0d258aee] .tree-node{align-items:start;position:relative;background-color:#fafafa}[data-v-0d258aee] .tree-node-level-0,[data-v-0d258aee] .tree-node-level-1{background-color:#fff}[data-v-0d258aee] .tree-node .tree-text{color:#666;font-size:16px}[data-v-0d258aee] .tree-node-level-0 .tree-text{color:#111;font-weight:700}[data-v-0d258aee] .tree-node-level-1 .tree-text{color:#333}.zjapp .btn-operate[data-v-0d258aee]{width:auto;margin-left:10px}.zjapp .app-btn-operate[data-v-0d258aee]{height:30px;line-height:28px;padding:0 15px;border:1px solid #4275e8;color:#4275e8;background-color:#fff;background-image:none;font-size:16px;min-width:auto;border-radius:15px}[data-v-0d258aee] .app-btn-operate .svg-loading{margin-top:4px}.zjapp .bg-level-end[data-v-0d258aee]{background-color:#fafafa}.zjapp .item-rule[data-v-0d258aee] .item-text{color:#999}.zjapp .special-inspect-guide[data-v-0d258aee]{height:30px;padding:4px 0;color:#4275e8}.zjapp .icon-mark[data-v-0d258aee]{display:inline-block;vertical-align:top;width:20px;height:20px;background:url("+n(a("21c0"))+") 0 no-repeat;background-size:16px 16px}",""])}}]);