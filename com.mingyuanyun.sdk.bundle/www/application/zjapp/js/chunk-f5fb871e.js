(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-f5fb871e","chunk-739f37c8","chunk-2d2263f6"],{"017a":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .item[data-v-1a7b90ef]{align-items:center}.zjapp .icon[data-v-1a7b90ef]{color:#4275e8}.zjapp .item>[class*=icon-checkbox][data-v-1a7b90ef]{margin-right:10px}.zjapp .item-disabled>[class*=icon-checkbox][data-v-1a7b90ef]{color:#b2b2b2;background-color:#b2b2b2}",""])},"0c52":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .app-stepper[data-v-03df57b7]{display:inline-block;width:110px;height:34px;margin:-2px 0;white-space:nowrap;font-size:0;line-height:0;vertical-align:top}.zjapp .app-stepper .number-input[data-v-03df57b7]{width:51px;height:34px;border:1px solid #dcdcdc;border-radius:0;font-size:14px;text-align:center;background-color:#fff;color:#111;box-sizing:border-box}.zjapp .app-stepper .number-input-focus[data-v-03df57b7]{border-color:#4275e8}.zjapp .btn-add[data-v-03df57b7],.zjapp .btn-minus[data-v-03df57b7]{display:inline-block;width:28px;height:34px;line-height:34px;padding:0;border:1px solid #dcdcdc;color:#666;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:border-box;background-color:#fff}.zjapp .btn-minus[data-v-03df57b7]{border-right:none;border-radius:4px 0 0 4px}.zjapp .btn-add[data-v-03df57b7]{border-left:none;border-radius:0 4px 4px 0}.zjapp .icon-add[data-v-03df57b7],.zjapp .icon-minus[data-v-03df57b7]{font-size:11px;vertical-align:top;display:inline-block;margin-top:10.5px}.zjapp .disabled[data-v-03df57b7]{color:#c8c8c8}.zjapp .activing[data-v-03df57b7]{color:#4275e8}",""])},"0f7b":function(t,e,a){"use strict";a("f548"),a("163d");var i,n,o={name:"AppStepper",components:{NumberInput:a("6948").a},props:{value:{type:[String,Number],default:""},max:{type:[String,Number],default:200},range:{type:Array}},data:function(){return{addActiving:!1,minusActiving:!1}},computed:{rangeMin:function(){return this.range&&this.range[0]||0},rangeMax:function(){return this.range&&this.range[1]?this.range[1]:this.max},allowAdd:function(){return""!==this.value&&this.value<this.rangeMax},allowMinus:function(){return""!==this.value&&this.value>this.rangeMin}},methods:{onChange:function(t){t&&(t=String(t).replace(/\D/g,"")),parseInt(t,10)>parseInt(this.max,10)&&(t=this.max),this.$emit("input",Number(t)),this.$emit("change",Number(t))},add:function(){if(this.allowAdd){var t=parseInt(this.value,10)+1;this.isInRange(t)&&(this.$emit("input",t),this.$emit("change",t)),this.setActiving("add")}},minus:function(){if(this.allowMinus){var t=parseInt(this.value,10)-1;this.isInRange(t)&&(this.$emit("input",t),this.$emit("change",t)),this.setActiving("minus")}},isInRange:function(t){return t>=this.rangeMin&&t<=this.rangeMax},setActiving:function(t){var e=this;t&&("minus"===t?(this.minusActiving=!0,clearTimeout(n),n=setTimeout((function(){e.minusActiving=!1}),300)):(this.addActiving=!0,clearTimeout(i),i=setTimeout((function(){e.addActiving=!1}),300)))}}},s=(a("91cb"),a("17cc")),r=Object(s.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-stepper"},[a("button",{staticClass:"btn-minus",class:{disabled:!t.allowMinus,activing:t.minusActiving},on:{click:t.minus}},[a("icon",{attrs:{name:"minus"}})],1),a("number-input",{attrs:{value:t.value,type:"int",range:t.range},on:{input:t.onChange}}),a("button",{staticClass:"btn-add",class:{disabled:!t.allowAdd,activing:t.addActiving},on:{click:t.add}},[a("icon",{attrs:{name:"add"}})],1)],1)}),[],!1,null,"03df57b7",null);e.a=r.exports},"105d":function(t,e,a){var i=a("99f0");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("e4faa610",i,!0,{sourceMap:!1,shadowMode:!1})},"1a09":function(t,e,a){"use strict";a("4e60")},"1fe5":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .scroll-wrap[data-v-91d8f174]{flex:1;overflow:auto;padding-bottom:100px}.zjapp .date[data-v-91d8f174]{padding-right:30px}.zjapp .unit[data-v-91d8f174]{position:absolute;right:15px;top:10px}.zjapp .cell-item[data-v-91d8f174]{position:relative;font-size:16px;line-height:30px}.zjapp .cell-item input[data-v-91d8f174]{border:none;margin:0;display:block;height:34px;color:#111;vertical-align:middle;line-height:16px;text-align:right}.zjapp .cell-item .fr[data-v-91d8f174]{color:#b2b2b2;line-height:30px}.zjapp .cell-item i[data-v-91d8f174]{float:right;margin-top:2px}.zjapp .cell-item .gray[data-v-91d8f174]{color:#666}.zjapp .cell-item[data-v-91d8f174] .van-cell__value{padding-left:90px}.zjapp .cell-item[data-v-91d8f174] .van-cell__value .custom-text{position:absolute;left:0}.zjapp .cell-item[data-v-91d8f174] .van-cell__right-icon{color:#c8c8c8}",""])},"34b6":function(t,e,a){"use strict";var i=a("d23f").a,n=(a("c6cf"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("popup-has-header",{attrs:{height:"93%",title:t.title},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.multi?a("template",{slot:"header_left"},[a("span",{staticClass:"f-gray",on:{click:t.closeEvent}},[t._v("取消")])]):t._e(),a("template",{slot:"header_right"},[t.multi?a("div",{staticClass:"f-blue",attrs:{slot:"header-bar-right"},on:{click:t.onConfirm},slot:"header-bar-right"},[t._v("\n        确定("+t._s(t.selected.length)+")\n      ")]):t._e()]),a("template",{slot:"body_main"},[a("div",{staticClass:"body-box"},[a("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":t.storageKey},on:{changeSearchStatus:t.onSearchTypeChange},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),!t.searchStatus||t.searchStatus&&t.keyword?[t.multi&&t.selected.length?a("div",{ref:"select-box",staticClass:"selected"},[a("label",{staticClass:"selected-label"},[t._v("已选：")]),a("div",{staticClass:"select_result"},t._l(t.selected,(function(e){return a("span",{key:e.id,staticClass:"selected-item",class:{"selected-item-disabled":e.disabled}},[t._v("\n                "+t._s(e.name)+"\n                "),a("icon",{staticClass:"selected-remove",attrs:{name:"unqualified"},on:{click:function(a){t.onSelectUser(e)}}})],1)})))]):t._e(),!t.searchStatus||t.searchStatus&&t.keyword?a("van-tabs",{model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.roleGroup,(function(e){return a("van-tab",{key:e.id,attrs:{title:e.name}},[a("div",{staticClass:"tab-box",style:"height: "+t.maxScrollHeight+"px;"},[t.canSelectAllRole&&e.children&&e.children.length?a("item",{key:-1,attrs:{text:"全选",border:"bottom"}},[a("icon",{attrs:{slot:"icon-right",name:t.allRoleSelected?"checkbox-checked":"checkbox"},on:{click:function(e){return e.stopPropagation(),t.selectAllRole(e)}},slot:"icon-right"})],1):t._e(),31===e.id&&t.contractorGroup&&t.contractorGroup.length?[t._l(t.contractorGroup,(function(e){return[a("item",{key:e.id,attrs:{text:e.name,border:"bottom"},on:{click:function(a){t.toggleGroup(e)}}},[a("icon",{staticClass:"triangle",class:{"triangle-down":t.openSet[e.id]},attrs:{slot:"icon-left",name:"triangle-right"},slot:"icon-left"}),t.multi?a("icon",{attrs:{slot:"icon-right",name:t.groupSelectedSet[e.id]?"checkbox-checked":"checkbox"},on:{click:function(a){a.stopPropagation(),t.selectedAll(e)}},slot:"icon-right"}):t._e()],1),t.openSet[e.id]?t._l(e.children,(function(i){return a("user-item",{key:e.id+i.id,staticClass:"item-data",attrs:{"head-portrait":t.getImageThumbnail(i.head_portrait),name:i.name,post:i.post,keyword:t.keyword,multi:t.multi,selected:t.selectedSet[i.id],disabled:t.disabledSet[i.id]},on:{click:function(e){t.onSelectUser(i)}}})})):t._e()]}))]:t._l(e.children,(function(e){return a("user-item",{key:e.id,staticClass:"item-data",attrs:{"head-portrait":t.getImageThumbnail(e.head_portrait),name:(e.role_name||"")+e.name,post:e.post,keyword:t.keyword,multi:t.multi,selected:t.selectedSet[e.id],disabled:t.disabledSet[e.id]},on:{click:function(a){t.onSelectUser(e)}}})})),a("loading-status",{attrs:{"is-empty":!e.children.length,"empty-text":Boolean(t.keyword)&&e.id?"没有查询到结果":"暂无数据",type:Boolean(t.keyword)?"search":"common"}})],2)])}))):t._e()]:t._e()],2)])],2)],1)}),[],!1,null,"3ce9ba4e",null);e.a=o.exports},3518:function(t,e,a){var i=a("5454");(t.exports=a("690e")(!1)).push([t.i,".zjapp .item-user-unit[data-v-43750b3d]{position:relative;display:inline-block;vertical-align:top;font-size:0}.zjapp .item-user-unit.bg[data-v-43750b3d]{background:#f4f4f4;border-radius:4px;padding-left:6px;margin:0 5px 5px}.zjapp .item-user-name[data-v-43750b3d]{font-size:16px;display:inline-block;vertical-align:middle}.zjapp .icon-im-btn[data-v-43750b3d]{position:relative;z-index:5;display:inline-block;vertical-align:middle;width:34px;height:22px;background:url("+i(a("f77a"))+") no-repeat 6px;background-size:16px 10px}.zjapp .popup-user-im[data-v-43750b3d]{position:absolute;z-index:5;bottom:30px;left:50%;margin-left:-65px;padding:0 5px;width:130px;height:60px;background-color:rgba(0,0,0,.8);border-radius:5px}.zjapp .popup-user-im-item[data-v-43750b3d]{float:left;width:60px;height:60px;text-align:center;color:#fff;padding-top:10px}.zjapp .popup-user-im-item.disabled[data-v-43750b3d]{color:#666}.zjapp .popup-user-im-arrow[data-v-43750b3d]{position:absolute;bottom:-5px;left:50%;margin-left:-5px;border:5px solid transparent;border-bottom:none;border-top-color:rgba(0,0,0,.8)}.zjapp .popup-user-im-icon[data-v-43750b3d]{display:block;font-size:21px}.zjapp .popup-user-im-text[data-v-43750b3d]{font-size:12px;line-height:16px;margin-top:4px}.zjapp .popup-user-posi-bottom[data-v-43750b3d]{bottom:auto;top:30px}.zjapp .popup-user-posi-bottom .popup-user-im-arrow[data-v-43750b3d]{top:-5px;bottom:auto;border-top:none;border-bottom:5px solid rgba(0,0,0,.8)}",""])},4460:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .item-text[data-v-74990eb9]{padding:2px 0;margin-bottom:-4px}.zjapp .item-text .bg[data-v-74990eb9]{display:inline-block;background:#f4f4f4;border-radius:4px;padding:3px 6px;margin-bottom:4px}.zjapp .item-text .bg+.bg[data-v-74990eb9]{margin-left:4px}",""])},"4e60":function(t,e,a){var i=a("3518");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("6d528d9e",i,!0,{sourceMap:!1,shadowMode:!1})},"528f":function(t,e,a){"use strict";var i=a("8e75").a,n=(a("f4c1"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("item",{attrs:{label:t.title,mode:t.mode,editabled:t.editabled,border:t.border},on:{click:t.openSelect}},[!t.multi&&t.title?a("div",{class:{"item-label":!0,"color-gray2":"view"===t.mode},attrs:{slot:"left"},slot:"left"},[t._v("\n      "+t._s(t.title)+"\n      "),""!==t.isRead?a("span",{staticClass:"item-status-read",class:{"color-red":!t.isRead,"color-gray2":t.isRead}},[t._v("\n        "+t._s(t.isRead?"已读":"未读")+"\n      ")]):t._e()]):t._e(),t.multi?t._e():a("div",{class:{"item-text":!0,"align-r":"edit"===t.mode,"color-gray1":"edit"===t.mode&&t.selected&&t.selected.id,"item-placeholder":"edit"===t.mode&&!(t.selected&&t.selected.id),"border-editabled":"view"===t.mode&&t.editabled},attrs:{slot:"right"},slot:"right"},[a("div",{staticClass:"item-display-flex"},[t.selected&&t.selected.id?a("div",{staticClass:"item-flex"},["edit"===t.mode?a("span",{staticClass:"bg"},[t._v(t._s(t.selected.name))]):a("check-user-contact",{attrs:{list:[t.selected]}})],1):t._e(),t.note&&t.selected&&t.selected.id?a("div",{staticClass:"item-note color-gray"},[t._v("\n          "+t._s(t.note)+"\n        ")]):t._e()]),t.selected&&t.selected.id?t._e():a("span",{class:{"item-placeholder":t.editabled&&!t.formCheck,"item-text-error":t.formCheck}},[t._v("\n        "+t._s("edit"===t.mode?t.required?"请选择":"选填":t.emptyText)+"\n      ")]),t.date&&!t.editabled?a("div",{staticClass:"color-light mt10"},[a("span",[t._v(t._s(t.date))]),t.modifyDate?a("span",{staticClass:"ml10"},[t._v("提交")]):t._e(),t.status?a("span",{staticClass:"ml10",class:t.statusClass},[t._v("\n          "+t._s(t.status)+"\n        ")]):t._e()]):t._e(),t.modifyDate&&!t.editabled?a("div",{staticClass:"color-light mt10"},[a("span",[t._v(t._s(t.modifyDate))]),a("span",{staticClass:"ml10"},[t._v("最后修改")])]):t._e()]),t.multi?a("div",{class:{"item-text":!0,"align-r":"edit"===t.mode,"color-gray1":"edit"===t.mode&&t.selected&&t.selected.length,"item-placeholder":"edit"===t.mode&&!(t.selected&&t.selected.length),"border-editabled":"view"===t.mode&&t.editabled},attrs:{slot:"right"},slot:"right"},[t.selected&&t.selected.length?["edit"===t.mode?t._l(t.selected,(function(e,i){return a("span",{key:i,staticClass:"bg"},[t._v("\n            "+t._s(e.name)+"\n          ")])})):a("check-user-contact",{attrs:{list:t.selected}})]:a("span",{class:{"item-placeholder":t.editabled&&!t.formCheck,"item-text-error":t.formCheck}},[t._v("\n        "+t._s(t.editabled?t.required?"请选择":"选填":t.emptyText)+"\n      ")])],2):t._e()]),a("popup-user-select",{ref:"popup-user-select"})],1)}),[],!1,null,"74990eb9",null);e.a=o.exports},"5b2c":function(t,e,a){"use strict";a.r(e);var i=a("fed4").a,n=(a("c1ab"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-content",{attrs:{title:"add"==t.type?"新建批次":"编辑批次","show-go-root":!0}},[a("div",{staticClass:"scroll-wrap"},[a("div",{staticClass:"list"},[a("item",{attrs:{label:"批次名称",mode:"edit"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.batchName,expression:"data.batchName"},{name:"track",rawName:"v-track",value:"现场检查-修改批次-修改名称",expression:"'现场检查-修改批次-修改名称'"}],ref:"batch_add_name_input",staticClass:"input-align-r f16",attrs:{slot:"right",type:"text",placeholder:"请填写"},domProps:{value:t.data.batchName},on:{input:function(e){e.target.composing||t.$set(t.data,"batchName",e.target.value)}},slot:"right"})]),a("single-select",{attrs:{title:"所属标段",options:t.data.bidsectionData,mode:"edit",editabled:"add"===t.type},model:{value:t.data.batchBidsection,callback:function(e){t.$set(t.data,"batchBidsection",e)},expression:"data.batchBidsection"}}),a("user-select",{attrs:{options:t.data.inspectorData,title:"检查人",multi:!0,"before-open":t.isCheckItemSelected},on:{onSelect:t.selectCheckMan},model:{value:t.data.batchInspector,callback:function(e){t.$set(t.data,"batchInspector",e)},expression:"data.batchInspector"}}),a("item",{attrs:{label:"整改期限",mode:"edit"}},[a("template",{slot:"right"},[a("div",{staticClass:"item-con align-r"},[a("app-stepper",{staticClass:"date",attrs:{max:"999"},model:{value:t.data.timeLimit,callback:function(e){t.$set(t.data,"timeLimit",e)},expression:"data.timeLimit"}})],1),a("div",{staticClass:"item-font ml5"},[t._v("天")])])],2),a("user-select",{attrs:{title:"负责人",multi:!1,options:t.data.hasRightUsers},on:{onSelect:t.selectMaster},model:{value:t.data.batchCharger,callback:function(e){t.$set(t.data,"batchCharger",e)},expression:"data.batchCharger"}}),a("user-select",{attrs:{options:t.data.ccOptions,title:"抄送人",multi:!0,"before-open":t.isCheckItemSelected},on:{onSelect:t.selectCCMan},model:{value:t.data.cc,callback:function(e){t.$set(t.data,"cc",e)},expression:"data.cc"}})],1),a("app-button-group",["add"===t.type?a("app-button",{on:{click:t.saveBatch}},[t._v(" 提交 ")]):a("app-button",{on:{click:t.saveBatch}},[t._v(" 保存 ")])],1)],1)])}),[],!1,null,"91d8f174",null);e.default=o.exports},"6be0":function(t,e,a){var i=a("4460");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("9260fce2",i,!0,{sourceMap:!1,shadowMode:!1})},7583:function(t,e,a){"use strict";a("c351")},"774b":function(t,e,a){"use strict";a.r(e);var i=a("d18d").a,n=(a("b225"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"scroll-warp",staticClass:"scroll-warp",class:{"scroll-warp-pulling":t.pulling,"scroll-warp-complete":!t.hasNext&&!t.isEmpty,"scroll-warp-empty":t.isEmpty},style:{"padding-bottom":t.numberKeyboardCoverHeight+"px"},on:{scroll:t.onScroll,touchstart:t.onTouchstart,touchmove:t.onTouchmove,touchend:t.onTouchend}},[t.allowPullDown?a("div",{staticClass:"pull-refresh-warp",style:{height:t.pullDist+"px"}},[a("div",{staticClass:"pull-refresh"},[a("div",{staticClass:"animation-refresher",class:{refreshing:t.refreshing}}),t.updateTime?a("p",{staticClass:"pull-refresh-date"},[t._v("最后成功同步："+t._s(t.updateTime))]):t._e()])]):t._e(),t._t("default"),t.loading?a("div",{staticClass:"page-loading"},[a("svg",{staticClass:"svg-loading",attrs:{viewBox:"0 0 80 80"}},[a("circle",{attrs:{cx:"40",cy:"40",r:"36"}})])]):t._e(),t.hasNext||t.isEmpty?t._e():[t.$slots.end?t._t("end"):t._e(),!t.$slots.end&&t.endText?a("div",{staticClass:"end-text"},[t._v("\n      "+t._s(t.endText)+"\n    ")]):t._e()]],2)}),[],!1,null,"2b1a346c",null);e.default=o.exports},"7af7":function(t,e,a){var i=a("1fe5");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("07afebe6",i,!0,{sourceMap:!1,shadowMode:!1})},"8e75":function(t,e,a){"use strict";(function(t){a("2b45"),a("e697"),a("cc57"),a("163d");var i=a("07d2"),n=a("6144"),o=a("9864"),s=a("e2a7"),r=a("a18c"),c=a("34b6");e.a={name:"UserSelect",components:{Item:i.default,CheckUserContact:o.a,PopupUserSelect:c.a},props:{title:{type:String},value:{type:[Object,Array]},options:{type:Array,default:function(){return[]}},multi:{type:Boolean,default:!1},date:{type:String,default:""},modifyDate:{type:String,default:""},isRead:{type:[String,Boolean],default:""},note:{type:String,default:""},status:{type:String,default:""},statusClass:{type:[Object,String]},max:{type:Number,default:1/0},maxTip:{type:String,default:""},border:{type:String,default:""},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},required:{type:Boolean,default:!0},emptyText:{type:String,default:"空"},beforeOpen:{type:Function,default:function(){}},beforeSelect:{type:Function,default:function(){}},beforeConfirm:{type:Function,default:function(){}},formCheck:{type:Boolean,default:!1},linkedData:{type:Object,default:function(){return{}}}},data:function(){return{isOpen:!1,memoryKey:(this.$route?this.$route.name:r.a.history.current.name)+encodeURI(this.title||"选人组件")}},computed:{selected:function(){return this.multi?t.isArray(this.value)?this.value:t.isEmpty(this.value)?[]:[this.value]:t.isArray(this.value)?this.value[0]||{}:t.isEmpty(this.value)?{}:this.value}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var e=this;if(this.editabled){var a=this.beforeOpen(this.linkedData);a&&a.then&&t.isFunction(a.then)?a.then((function(t){!1!==t&&e.openPopup()})).catch((function(t){$log.error(t),s.a.alert(t||"发生了错误")})):!1!==a&&this.openPopup()}},openPopup:function(){var e=this;this.$refs["popup-user-select"].openPopup({title:"选择"+(this.title||""),selected:this.selected,options:this.options,multi:this.multi,max:this.max,maxTip:this.maxTip,beforeSelect:this.beforeSelect,beforeConfirm:this.beforeConfirm,onSelect:function(a){var i=t.cloneDeep(e.selected);e.multi?(e.$emit("input",a,i),e.$emit("onSelect",a,i)):(e.$emit("input",a[0],i),e.$emit("onSelect",a[0],i)),e.memory&&n.a.saveObject(e.memoryKey,e.multi?a:a[0],n.a.level.user)}})},closeSelect:function(){this.isOpen=!1},getSame:function(e,a){var i=[];return t.each(e,(function(e){e&&e.id&&t.find(a,(function(t){return t.id.toString().toUpperCase()===e.id.toString().toUpperCase()}))&&i.push(e)})),i},setSelected:function(){var e,a=n.a.getObject(this.memoryKey,n.a.level.user);!1===this.editabled||t.isEmpty(this.options)||(this.multi?t.isEmpty(this.selected)?a&&a.length&&this.memory?(e=this.getSame(a,this.options)).length&&(this.$emit("input",e),this.autoSelect&&this.$emit("defaultSelect",e)):this.selectDefault&&(e=this.getSame(this.selectDefault,this.options)).length&&(this.$emit("input",e),this.autoSelect&&this.$emit("defaultSelect",e)):(e=this.getSame(this.selected,this.options)).length?this.autoSelect&&this.$emit("defaultSelect",this.selected):this.autoSelect&&this.$emit("defaultSelect",[]):!t.isEmpty(this.selected)&&this.selected.id?this.autoSelect&&this.$emit("defaultSelect",this.selected):this.memory&&!t.isEmpty(a)&&(t.isArray(a)&&(a=a[0]),t.some(this.options,{id:a.id})&&(this.$emit("input",a),this.autoSelect&&this.$emit("defaultSelect",a))))}}}}).call(this,a("391c"))},"91cb":function(t,e,a){"use strict";a("c82d")},"936a":function(t,e,a){var i=a("e46b"),n=a("e7ad").isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&n(t)}})},9455:function(t,e,a){"use strict";a("f272")},9864:function(t,e,a){"use strict";var i=a("cdce").a,n=(a("1a09"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"root"},[t.list.length?t._e():a("div",{staticClass:"item-user-unit"},[a("span",{staticClass:"item-user-name"},[t._v("\n      无\n    ")])]),t._l(t.list,(function(e,i){return a("div",{key:i,staticClass:"item-user-unit bg"},[a("span",{staticClass:"item-user-name"},[t._v("\n      "+t._s(e&&e.name?e.name:"")+"\n    ")]),a("div",{staticClass:"icon-im-btn",on:{click:function(a){if(a.stopPropagation(),a.target!==a.currentTarget)return null;t.openImPopup(e,a)}}},[t.popupOpenItemId===e.id?a("div",{staticClass:"popup-user-im",class:{"popup-user-posi-bottom":t.popupUserPosiBottom},style:{left:t.popupL}},[a("div",{directives:[{name:"track",rawName:"v-track",value:"公共-发起聊天",expression:"'公共-发起聊天'"}],staticClass:"popup-user-im-item",class:{disabled:t.isImDisabled(e)},on:{click:function(a){t.openIm(e)}}},[a("icon",{staticClass:"popup-user-im-icon",attrs:{name:"liaotian"}}),a("p",{staticClass:"popup-user-im-text"},[t._v("聊天")])],1),e.mobile&&t.userInfo.user_id!==e.id?a("a",{directives:[{name:"track",rawName:"v-track",value:"公共-打电话",expression:"'公共-打电话'"}],staticClass:"popup-user-im-item",attrs:{href:"tel:"+e.mobile}},[a("icon",{staticClass:"popup-user-im-icon",attrs:{name:"dianhua"}}),a("p",{staticClass:"popup-user-im-text"},[t._v("电话")])],1):a("div",{staticClass:"popup-user-im-item disabled"},[a("icon",{staticClass:"popup-user-im-icon",attrs:{name:"dianhua"}}),a("p",{staticClass:"popup-user-im-text"},[t._v("电话")])],1),a("div",{staticClass:"popup-user-im-arrow",style:{left:t.arrowL}})]):t._e()])])}))],2)}),[],!1,null,"43750b3d",null);e.a=o.exports},"99f0":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .popup-customize-use-header[data-v-5fef0434]{display:flex;flex-direction:column;font-size:14px}[data-v-5fef0434] .popup-customize-use-header.van-popup--bottom.van-popup--round{border-radius:10px 10px 0 0}.zjapp .popup-customize-use-header .popup-header[data-v-5fef0434]{display:flex;align-items:center;justify-content:space-between;padding:0 15px;height:46px;border:none;background-image:linear-gradient(0deg,#ececec,#ececec 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .popup-customize-use-header .popup-header .popup-header__left[data-v-5fef0434]{width:80px;flex-shrink:0}.zjapp .popup-customize-use-header .popup-header .popup-header__title[data-v-5fef0434]{flex:1;text-align:center;font-size:18px}.zjapp .popup-customize-use-header .popup-header .popup-header__right[data-v-5fef0434]{width:80px;flex-shrink:0;font-weight:800;text-align:right}.zjapp .popup-customize-use-header .popup-body[data-v-5fef0434]{display:flex;position:relative;height:calc(100% - 46px);overflow:hidden}.zjapp .f-blue[data-v-5fef0434]{color:#4275e8}.zjapp .f-gray[data-v-5fef0434]{color:#666}",""])},"9d55":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .scroll-warp[data-v-2b1a346c]{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}.zjapp .scroll-warp-pulling[data-v-2b1a346c]{overflow:hidden}.zjapp .scroll-warp-complete[data-v-2b1a346c]:after{content:"";display:block;height:100px}.zjapp .scroll-warp-empty[data-v-2b1a346c]{display:flex;flex-direction:column}.zjapp .pull-refresh-warp[data-v-2b1a346c]{position:relative;height:0;overflow:hidden}.zjapp .pull-refresh[data-v-2b1a346c]{position:absolute;left:0;bottom:0;height:70px;width:100%;padding:6px;text-align:center}.zjapp .pull-refresh-date[data-v-2b1a346c]{margin-top:4px;height:16px;line-height:16px;font-size:12px;color:#bcbcbc}.zjapp .page-loading[data-v-2b1a346c]{padding:10px;text-align:center}.zjapp .end-text[data-v-2b1a346c]{color:#c8c8c8;background:#f4f4f4;position:relative;line-height:76px;height:76px;text-align:center}.zjapp .end-text[data-v-2b1a346c]:after,.zjapp .end-text[data-v-2b1a346c]:before{content:"";position:absolute;width:48px;height:1px;background:#e4e4e4;top:50%;margin-top:-1px}.zjapp .end-text[data-v-2b1a346c]:after{left:50%;transform:translateX(-92px)}.zjapp .end-text[data-v-2b1a346c]:before{right:50%;transform:translateX(90px)}.zjapp .end-slot[data-v-2b1a346c]{padding:30px;line-height:18px;text-align:center;color:#c8c8c8}',""])},a207:function(t,e,a){var i=a("c081");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("4bbf528c",i,!0,{sourceMap:!1,shadowMode:!1})},b225:function(t,e,a){"use strict";a("ef48")},b747:function(t,e,a){"use strict";a("f548"),a("9dd9"),a("cc57");var i={name:"UserSelectItem",components:{Item:a("07d2").default},props:{name:{type:String},post:{type:String},headPortrait:{type:String,default:""},multi:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},keyword:{type:String,default:""}},data:function(){return{}},computed:{showName:function(){var t="";if(""===this.keyword)t=this.name;else{var e=new RegExp("("+this.keyword+")","gmi");t=this.name.replace(e,'<span color="color-theme">$1</span>')}return t}}},n=(a("7583"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("item",t._g({class:{"item-disabled":t.disabled},attrs:{border:"bottom"}},t.$listeners),[t.headPortrait?a("img",{staticClass:"item-headimg",attrs:{src:t.headPortrait}}):t._e(),a("div",{staticClass:"item-text",class:{"color-theme":!t.multi&&t.selected}},[a("span",{domProps:{innerHTML:t._s(t.showName)}}),t.post?a("span",[t._v("("+t._s(t.post)+")")]):t._e()]),t.multi?a("icon",{attrs:{name:t.selected?"checkbox-checked":"checkbox"}}):a("icon",{attrs:{name:t.selected?"qualified":""}})],1)}),[],!1,null,"1a7b90ef",null);e.a=o.exports},bf9f:function(t,e,a){"use strict";var i={props:{title:{type:String,default:""},value:{type:Boolean,default:!1},height:{type:String,default:"70%"}},data:function(){return{show:this.value}},watch:{value:function(t){t!==this.show&&(this.show=t)},show:function(t){t!==this.value&&this.$emit("input",t)}},methods:{closePopup:function(){this.show=!1}}},n=(a("f4c9"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-popup",t._g({staticClass:"popup-customize-use-header",style:{height:t.height},attrs:{position:"bottom",round:"","get-container":"#app","safe-area-inset-bottom":"","close-on-popstate":""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},t.$listeners),[a("div",{staticClass:"popup-header"},[a("div",{staticClass:"popup-header__left"},[t._t("header_left")],2),a("div",{staticClass:"popup-header__title"},[t._v(t._s(t.title))]),a("div",{staticClass:"popup-header__right"},[t._t("header_right",[a("icon",{staticClass:"f-gray",attrs:{name:"nav-close"},on:{click:t.closePopup}})])],2)]),a("div",{staticClass:"popup-body"},[t._t("body_main")],2)])],1)}),[],!1,null,"5fef0434",null);e.a=o.exports},c081:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .f-blue[data-v-3ce9ba4e]{color:#4275e8!important}.zjapp .f-gray[data-v-3ce9ba4e]{color:#666}[data-v-3ce9ba4e] .app-search-bar .border-bottom{background-image:none}[data-v-3ce9ba4e] .van-tabs__nav{padding-left:8%;padding-right:8%}[data-v-3ce9ba4e] .van-tabs__wrap:after{border-width:0;border-bottom-width:1px}.zjapp .triangle[data-v-3ce9ba4e]{font-size:14px;margin-right:8px;color:#c8c8c8;transform:rotate(0deg)}.zjapp .triangle.translate[data-v-3ce9ba4e]{color:transparent}.zjapp .triangle-down[data-v-3ce9ba4e]{transform:rotate(90deg)}.zjapp .tab-box[data-v-3ce9ba4e]{overflow:auto;padding-bottom:50px}.zjapp .selected[data-v-3ce9ba4e]{position:relative;flex-shrink:0;z-index:3;padding:5px 15px 10px 60px;line-height:24px;background-color:#fff;scroll-behavior:smooth;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .selected-label[data-v-3ce9ba4e]{position:absolute;top:10px;left:15px;line-height:24px;font-size:16px;color:#999}.zjapp .selected-item[data-v-3ce9ba4e]{position:relative;display:inline-block;min-height:24px;line-height:20px;padding:2px 20px 2px 5px;margin:5px 5px 0 0;font-size:14px;color:#666;background-color:#f4f4f4;border-radius:4px}.zjapp .select_result[data-v-3ce9ba4e]{max-height:90px;overflow-y:auto}.zjapp .selected-remove[data-v-3ce9ba4e]{position:absolute;top:0;right:0;width:20px;height:24px;line-height:24px;text-align:center;font-size:8px;color:#ccc}.zjapp .selected-item-disabled[data-v-3ce9ba4e]{padding:2px 5px}.zjapp .selected-item-disabled .selected-remove[data-v-3ce9ba4e]{display:none}.zjapp .scroll-wrap[data-v-3ce9ba4e]{flex:1;background:#fff;height:100%;overflow:auto;transform:translateZ(0)}.zjapp .fixed[data-v-3ce9ba4e]{position:absolute;top:0;left:0;right:0;background-color:#fff;z-index:4}.zjapp .part-title[data-v-3ce9ba4e]{padding:9px 15px 5px 15px;line-height:18px;font-size:12px;color:#999;background-color:#f4f4f4}.zjapp .item[data-v-3ce9ba4e]{align-items:center}.zjapp .item>[class*=icon-checkbox][data-v-3ce9ba4e]{margin-right:10px}.zjapp .body-box[data-v-3ce9ba4e]{display:flex;flex-direction:column;width:100%;flex:1}",""])},c1ab:function(t,e,a){"use strict";a("7af7")},c351:function(t,e,a){var i=a("017a");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("73ddfab9",i,!0,{sourceMap:!1,shadowMode:!1})},c62c:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .app-radio[data-v-2340da0b]{position:relative;line-height:20px;font-size:0}.zjapp .app-radio>*[data-v-2340da0b]{display:inline-block;vertical-align:middle}.zjapp .app-radio .app-radio-icon[data-v-2340da0b]{width:20px;height:20px;border:1px solid #d9d9d9;border-radius:20px}.zjapp .app-radio .app-radio-icon+*[data-v-2340da0b]{margin-left:10px;font-size:16px}.zjapp .app-radio .checked-icon[data-v-2340da0b]{position:relative;border:1px solid #4275e8}.zjapp .app-radio .checked-icon[data-v-2340da0b]:before{content:" ";background:#4275e8;display:inline-block;width:14px;height:14px;border-radius:20px;position:absolute;top:2px;left:2px}',""])},c6cf:function(t,e,a){"use strict";a("a207")},c82d:function(t,e,a){var i=a("0c52");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("26e0fa2e",i,!0,{sourceMap:!1,shadowMode:!1})},cdce:function(t,e,a){"use strict";(function(t){a("cc57");var i=a("4360"),n=a("3bd5"),o=a("1601"),s=a("e2a7"),r=a("6f9e");e.a={name:"CheckUserContact",props:{list:{type:Array,default:function(){return[]}}},data:function(){return{popupOpenItemId:"",popupL:"50%",arrowL:"50%",popupUserPosiBottom:!1}},computed:{allowIM:function(){return window&&window.$rootScope&&window.$rootScope.allowIM},userInfo:function(){return n.a.getUser()}},created:function(){r.a.$on("pageContentClick",this.closeImPopup)},destroyed:function(){r.a.$off("pageContentClick",this.closeImPopup)},methods:{hasIm:function(t){return!!parseInt(t.is_im_user)},openImPopup:function(t,e){if($log.log("打开聊天窗口",t),r.a.$emit("pageContentClick"),this.popupOpenItemId=t.id,e&&e.target){var a=e.target.getBoundingClientRect(),n=window.innerWidth,o=i.a.state.app.isIOS?i.a.state.app.isIOSBezelLess?88:64:44;a.top<o+68?this.popupUserPosiBottom=!0:this.popupUserPosiBottom=!1,n-a.right<50?(this.popupL=16-(50-(n-a.right))+"px",this.arrowL=50-(n-a.right)+65+"px"):(this.popupL="50%",this.arrowL="50%")}},closeImPopup:function(){this.popupOpenItemId=""},openIm:function(e){var a=this.isImDisabled(e),i=this.allowIM&&!a;if(console.log(a,i,this.allowIM),i)if(t.has(e,"headimg_url")){var n=this.userInfo.tenant_code+"_"+e.id;o.a.openIm(n,e.name,e.headimg_url).catch((function(t){s.a.alert(t)}))}else o.a.openUserChat(e.id).catch((function(t){s.a.alert(t)}));else s.a.alert("聊天功能优化中暂不可用")},isImDisabled:function(t){return 1!==parseInt(t.is_im_user)||t.id===this.userInfo.user_id}}}}).call(this,a("391c"))},d18d:function(t,e,a){"use strict";(function(t){a("2b45");var i,n=a("4360"),o=a("48f4"),s=a("162a"),r=a("e2a7"),c=a("a500"),l=a("6f9e"),d={};e.a={name:"Scroller",props:{buildingId:{type:String,default:""},hasNext:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},isSync:{type:Boolean,default:!0},endText:{type:String,default:""},memoryScrollTop:{type:Boolean,default:!0},keepScrollTop:{type:Boolean},hasPullDown:{type:Boolean,default:!0},onPullDown:{type:Function}},data:function(){return{pullDist:0,refreshing:!1,pulling:!1,loading:!1,scrollTop:0,isCurrKeyboard:!1,gapBottom:0}},computed:{allowPullDown:function(){return this.hasPullDown&&(!!this.$listeners.pullDown||!!this.onPullDown)},updateTime:function(){return n.a.state.global.businessDownloadTime},numberKeyboardCoverHeight:function(){return n.a.state.global.isNumberInputOpen?n.a.state.global.numberKeyboardHeight-this.gapBottom:0}},mounted:function(){var t=this;l.a.$on("numberKeyboardOpen",this.onNumberKeyboardOpen),this.$nextTick((function(){var e=t.$refs["scroll-warp"]&&t.$refs["scroll-warp"].getBoundingClientRect&&t.$refs["scroll-warp"].getBoundingClientRect();e&&(t.gapBottom=document.documentElement.clientHeight-e.bottom),t.$el&&t.$el.addEventListener("focus",(function(e){var a=e&&e.target,i=a&&a.tagName&&a.tagName.toLowerCase();if("input"===i||"textarea"===i){window.addEventListener("resize",(function e(){var i=a.getBoundingClientRect(),n=t.$el.getBoundingClientRect(),o=i.bottom-n.bottom;o>0&&t.scrollBy(o),window.removeEventListener("resize",e,!1)}),!1)}}),!0)}))},destroyed:function(){l.a.$off("numberKeyboardOpen",this.onNumberKeyboardOpen)},activated:function(){var t=this.keepScrollTop||this.$router.isBack&&this.memoryScrollTop;this.scrollTop&&t&&(this.$refs["scroll-warp"].scrollTop=this.scrollTop)},deactivated:function(){this.memoryScrollTop&&(this.scrollTop=this.$refs["scroll-warp"].scrollTop)},methods:{onScroll:function(t){var e=this,a=this.$refs["scroll-warp"].scrollTop,i=this.$refs["scroll-warp"].scrollHeight;if(a+this.$refs["scroll-warp"].clientHeight>=i-5&&!this.loading&&this.hasNext){this.loading=!0;var n=this.$listeners.loadNext();n&&n.then&&"function"==typeof n.then?n.then((function(){e.loading=!1})):this.loading=!1}this.$emit("scroll",t)},getTouchDiretion:function(t){if(!(d&&t&&t.touches&&t.touches[0]))return"";var e=t.touches[0].clientX,a=t.touches[0].clientY;return Math.abs(a-d.y)>Math.abs(e-d.x)&&Math.abs(a-d.y)>=3?a>d.y?"down":"up":""},onTouchstart:function(t){this.allowPullDown&&t.touches&&1===t.touches.length&&(d={x:t.touches[0].clientX,y:t.touches[0].clientY,scrollTop:this.$refs["scroll-warp"].scrollTop,pullDist:this.pullDist})},onTouchmove:function(t){if(this.allowPullDown&&t.touches&&1===t.touches.length){var e=this.$refs["scroll-warp"].scrollTop,a=t.touches[0].clientY,i=a-d.y,n=this.getTouchDiretion(t);"down"===n?!this.refreshing&&e<=0?(this.pulling=!0,this.pullDist=(i-d.scrollTop)/2,t.preventDefault()):this.pulling=!1:"up"===n?this.pullDist>0&&(this.pullDist=d.pullDist-(d.y-a),t.preventDefault()):this.pullDist=d.pullDist}},onTouchend:function(){var t=this;this.allowPullDown&&(d={},this.pulling=!1,this.pullDist>=70&&this.isSync?this.refreshing?this.makePullTo(70):this.makePullTo(70).then((function(){if(t.refreshing=!0,t.onPullDown){var e=t.onPullDown();e&&e.then&&"function"==typeof e?e.finally((function(){t.refreshing=!1,t.makePullTo(0)})):(t.refreshing=!1,t.makePullTo(0))}else t.dataSync().then((function(){t.refreshing=!1,t.makePullTo(0),t.$emit("pullDown")})).catch((function(){t.refreshing=!1,t.makePullTo(0),t.$emit("pullDown")}))})):(this.refreshing=!1,this.makePullTo(0)))},makePullTo:function(t){var e=this,a=this.pullDist,i=t,n=i-a,o=a;return a===i?Promise.resolve():new Promise((function(t){!function s(){window.requestAnimationFrame((function(){o+=n/6,e.pullDist=o,a<i&&o<i||a>i&&o>i?s():(e.pullDist=i,e.refreshing=!1,t())}))}()}))},dataSync:function(){var t,e=o.default.getCurrentModuleCode(),a=o.default.getCurrentRoute(),i=a.meta&&a.meta.isTodo;if(o.default.isModuleNeedBuilding(e)&&!i){if(!this.buildingId)return new Promise((function(t){setTimeout((function(){t()}),500)}));t=this.buildingId}return c.a.addTrack("公共-手动下拉刷新","",""),s.a.beginManualUpdate(),o.default.checkSync(t).then((function(t){return s.a.endManualUpdate(),t})).catch((function(t){$log.error("下拉刷新错误",t),t&&"Error: Network Error"===t.toString()?r.a.alert("当前网络无法同步数据"):r.a.alert(t),s.a.endManualUpdate()}))},getScrollHeight:function(){return this.$refs["scroll-warp"].offsetHeight},getScrollTop:function(){return this.$refs["scroll-warp"].scrollTop},setScrollTop:function(t){this.$refs["scroll-warp"].scrollTop=t},scrollBy:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=this.getScrollTop(),o=n+t,s=Math.round(a/16.7),r=t/s,c=n,l=i=+new Date;return n===o?Promise.resolve():new Promise((function(t){!function a(){window.requestAnimationFrame((function(){l===i&&(c+=r,e.$refs["scroll-warp"].scrollTop=c,n<o&&c<o||n>o&&c>o?a():(e.$refs["scroll-warp"].scrollTop=o,t()))}))}()}))},scrollTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,a=this.getScrollTop(),i=t-a;return this.scrollBy(i,e)},scrollToEle:function(t){var e=t.keyboardHeight||232,a=(t=t.$el?t.$el:t).getBoundingClientRect(),i=this.$refs["scroll-warp"].getBoundingClientRect();if(a&&i){var o=document.documentElement.clientHeight-(n.a.state.global.isNumberInputOpen?e:0),s=i.bottom<o?i.bottom:o,r=i.top-a.top,c=a.bottom-s;r>0?this.scrollBy(-r-10):c>0&&this.scrollBy(c+10)}},isCurrent:function(e,a){var i=this;e.length&&t.each(e,(function(t){t._uid===a?i.isCurrKeyboard=!0:i.isCurrent(t.$children,a)}))},onNumberKeyboardOpen:function(t){this.isCurrKeyboard=!1,this.isCurrent(this.$children,t._uid),this.isCurrKeyboard&&this.scrollToEle(t)}}}}).call(this,a("391c"))},d23f:function(t,e,a){"use strict";(function(t){a("5ab2"),a("e10e"),a("e204"),a("6d57"),a("ed63"),a("8cf2"),a("e697");var i=a("28f8"),n=(a("cc57"),a("9dd9"),a("163d"),a("936a"),a("e2a7")),o=a("9eea"),s=a("774b"),r=a("07d2"),c=a("b747"),l=a("6144"),d=a("a18c"),p=a("4360"),u=a("bf9f"),h=a("3122");function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?f(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var b={31:"施工单位",32:"监理单位",33:"建设单位"};e.a={name:"AppUserSelect",components:{appSearchBar:o.default,Scroller:s.default,Item:r.default,UserItem:c.a,PopupHasHeader:u.a},data:function(){return{getImageThumbnail:h.a.getImageThumbnail.bind(h.a),storageKey:encodeURI(this.title||"userSelectMark"),show:!1,searchStatus:!1,keyword:"",options:[],selected:[],disabled:[],max:1/0,maxTip:"",title:"",multi:!1,lastSelected:[],openSet:{},active:0,maxScrollHeight:0}},computed:{allRoleSelected:function(){var t=this,e=(this.roleGroup[this.active]||{}).children;return(void 0===e?[]:e).map((function(e){return t.disabledSet[e.id]?null:e.id})).filter(Boolean).every((function(e){return t.selectedSet[e]}))},canSelectAllRole:function(){return this.multi&&!Number.isFinite(this.max)},selectedSet:function(){var e={};return t.isArray(this.selected)?t.each(this.selected,(function(t){e[t.id]=!0})):this.selected&&this.selected.id&&(e[this.selected.id]=!0),e},disabledSet:function(){var e={};return t.each(this.disabled||[],(function(t){e[t.id]=!0})),e},roleGroup:function(){var e,a=this,i=[{id:31,name:"施工单位",children:[]},{id:32,name:"监理单位",children:[]},{id:33,name:"建设单位",children:[]}];e=this.keyword?t.filter(this.options,(function(t){return new RegExp("("+a.keyword.trim()+")","gmi").test(t.name)})):this.options,t.each(i,(function(a){a.children=t.filter(e,(function(t){return t.role===a.id}))}));var n=this.lastSelected.map((function(t){return m(m({},t),{},{role_name:"".concat(b[t.role],"-")})}));return console.log(n),i.push({name:"最近选择",children:n||[]}),i},contractorGroup:function(){var e=this,a=[];if(p.a.state.global.allowGroupUserByConstructor){var i,n={id:"other",name:"其他",children:[]};i=this.keyword?t.filter(this.options,(function(t){return new RegExp("("+e.keyword+")","gmi").test(t.name)})):this.options,t.each(i,(function(e){31===e.role&&(e.contractors&&e.contractors.length?t.each(e.contractors,(function(i){var n=t.find(a,(function(t){return t.id===i.id}));n||(n=m(m({},i),{},{children:[]}),a.push(n)),n.children.push(m({},e))})):n.children.push(m({},e)))})),t.isEmpty(n.children)||a.push(n)}return a},groupSelectedSet:function(){var e=this,a={};return t.each(this.roleGroup,(function(i){var n=t.some(i.children,(function(t){return!e.selectedSet[t.id]}));a[i.id]=!n})),t.each(this.contractorGroup,(function(i){var n=t.some(i.children,(function(t){return!e.selectedSet[t.id]}));a[i.id]=!n})),a}},watch:{keyword:function(t){this.setSearchOpenSet()},selected:function(){var t=this;this.$nextTick((function(){var e=t.$refs["select-box"],a=0;e&&(a=e.offsetHeight||0),$log.log("user-select选人组件",{desc:"选取结果高度",data:a}),t.maxScrollHeight=Math.floor(.93*$rootScope.viewSize.height-144-a)}))}},methods:{openPopup:function(e){this.active=0,e.selected=e.selected||[];var a=t.isArray(e.selected)?e.selected:[e.selected],i=t.filter(e.options,(function(e){return t.some(a,{id:e.id})||e.checked}));e.disabled=e.disabled||[];var n=t.isArray(e.disabled)?e.disabled:[e.disabled],o=t.filter(e.options,(function(e){return t.some(n,{id:e.id})||e.disabled}));this.show=!0,this.title=e.title,this.selected=i,this.disabled=o,this.options=e.options,this.multi=e.multi,this.onSelect=e.onSelect,this.beforeSelect=e.beforeSelect,this.beforeConfirm=e.beforeConfirm,this.max=e.max||1/0,this.maxTip=e.maxTip||"";var s=this.getLastSelected(),r=t.filter(e.options,(function(e){return t.includes(s,e.id)}));r=t.sortBy(r,(function(e){return t.indexOf(s,e.id)})),this.lastSelected=r,this.storageKey=encodeURI(this.title||"userSelectMark"),this.setDefaultOpen(),this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch(),this.$emit("open")},setDefaultOpen:function(){var e=this;this.openSet={};var a=t.uniqBy(t.map(this.selected,"role"));t.each(a,(function(t){e.$set(e.openSet,t,!0)}));var i=[];t.each(this.selected,(function(t){t&&t.contractors&&t.contractors.length&&(i=i.concat(t.contractors))})),i=t.uniqBy(i,"id"),t.each(i,(function(t){e.$set(e.openSet,t.id,!0)}))},setSearchOpenSet:function(){var e=this;this.keyword?(t.each(this.roleGroup,(function(t){e.$set(e.openSet,t.id,!0)})),t.each(this.contractorGroup,(function(t){e.$set(e.openSet,t.id,!0)}))):this.setDefaultOpen()},toggleGroup:function(t){this.$set(this.openSet,t.id,!this.openSet[t.id])},getLastSetKey:function(){var t=d.a.history.current,e=t?t.name:"";return"".concat(p.a.state.global.currentProject.id,"-").concat(e,"-").concat(encodeURI(this.title))},saveLastSelected:function(e){if(e&&(t.isArray(e)||(e=[e]),!(e.length>11))){var a=this.getLastSelected();t.each(e,(function(t){a.unshift(t.id)})),(a=t.uniqBy(a)).length>11&&(a=a.splice(0,11));var i=this.getLastSetKey(),n=l.a.getUserObject("user-select-last-selected")||{};n[i]=a,l.a.saveUserObject("user-select-last-selected",n)}},getLastSelected:function(){var t=this.getLastSetKey();return(l.a.getUserObject("user-select-last-selected")||{})[t]||[]},closePopup:function(){this.show=!1,this.$emit("close")},onSure:function(){this.saveLastSelected(this.selected),this.onSelect(this.selected),this.closeEvent()},onConfirm:function(){var t=this,e=this.multi?this.beforeSelect(this.selected):null,a=this.beforeConfirm(this.selected);e instanceof Promise||(e=Promise.resolve(e)),a instanceof Promise||(a=Promise.resolve(a)),e.then((function(e){!1!==e&&a.then((function(e){!1!==e&&window.setTimeout((function(){t.onSure()}),300)}))}))},closeEvent:function(){this.closePopup(),this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch(),this.onSearchTypeChange(!1)},onSearchTypeChange:function(t){this.searchStatus=t,t||(this.keyword="")},selectAllRole:function(){var t=this,e=this.roleGroup[this.active]||{},a=e.children||[],i=this.allRoleSelected;$log.log("user-select选人组件",{desc:"全选=>单位id-单位名称-选择之前的状态",data:{id:e.id,name:e.name,allSelected:i}});var n=a.filter((function(e){return!t.disabledSet[e.id]}));i?n.forEach((function(e){var a=t.selected.findIndex((function(t){return t.id===e.id}));~a&&t.selected.splice(a,1)})):n.forEach((function(e){~t.selected.findIndex((function(t){return t.id===e.id}))||t.selected.push(e)})),this.recordSearch()},selectedAll:function(e){var a=this;if(e&&e.children&&e.children.length){var i="";if(i=!this.groupSelectedSet[e.id]){var o=t.filter(e.children,(function(t){return!a.selectedSet[t.id]&&!a.disabledSet[t.id]})).length;if(this.selected.length+o>this.max)return void n.a.alert(this.maxTip||"最多选择".concat(this.max,"个"))}t.each(e.children,(function(e){if(!a.disabledSet[e.id]){var n=t.findIndex(a.selected,{id:e.id});n<0?i&&a.selected.unshift(e):i||a.selected.splice(n,1)}}))}},onSelectUser:function(e){var a=this;$log.log("user-select选人组件",{desc:"单选",data:e});var i=this.multi?null:this.beforeSelect(e);i instanceof Promise||(i=Promise.resolve(i)),i.then((function(i){if(!1===i)return!1;if(!a.disabledSet[e.id]){if(a.multi){var o=t.findIndex(a.selected,{id:e.id});if(o<0){if(a.selected.length>=a.max)return void n.a.alert(a.maxTip||"最多选择".concat(a.max,"个"));a.selected.unshift(e)}else a.selected.splice(o,1)}else a.selected=[e],window.setTimeout((function(){a.onSure()}),300);a.recordSearch()}}))},recordSearch:function(){this.$refs["app-search-bar"].saveHistory()}}}}).call(this,a("391c"))},dc52:function(t,e,a){"use strict";var i={props:{text:{type:String,default:""},checked:{type:Boolean,default:!1},changeRadio:{type:Function,default:function(){return 0}}},data:function(){return{status:!1}},watch:{checked:function(t){this.status=t}},created:function(){this.status=this.checked},methods:{clickEvent:function(){this.status=!0,this.$emit("changeRadio",this.status)}}},n=(a("9455"),a("17cc")),o=Object(n.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-radio",on:{click:this.clickEvent}},[e("span",{class:{"app-radio-icon":!0,"checked-icon":this.status}}),this.text?e("span",[this._v(this._s(this.text))]):e("span",[this._t("default")],2)])}),[],!1,null,"2340da0b",null);e.a=o.exports},e89f:function(t,e,a){"use strict";var i=a("04f3"),n=a("cf09"),o=a("4360"),s=0;e.a={name:"PopupMixin",data:function(){return{backButtonEvent:null}},watch:{show:function(t){var e=this;if(t){if(this.$nextTick((function(){e.$el&&e.$el.style&&(e.$el.style.zIndex=++n.a.zIndex,s++,o.a.commit("app/SET_HAS_POPUP",!!s))})),!this.backButtonEvent){var a=this.close||this.closePopup;this.backButtonEvent=Object(i.a)(a)}}else--s<0&&(s=0),o.a.commit("app/SET_HAS_POPUP",!!s),this.backButtonEvent&&(Object(i.c)(this.backButtonEvent),this.backButtonEvent=null)}},methods:{}}},ef48:function(t,e,a){var i=a("9d55");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("a1a65c0c",i,!0,{sourceMap:!1,shadowMode:!1})},f272:function(t,e,a){var i=a("c62c");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("6a97aac3",i,!0,{sourceMap:!1,shadowMode:!1})},f4c1:function(t,e,a){"use strict";a("6be0")},f4c9:function(t,e,a){"use strict";a("105d")},f77a:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAeCAYAAABqpJ3BAAAAAXNSR0IArs4c6QAAAnlJREFUWAntmD1PFEEYx2dmbxUhd0eABAQsjAap0AIagYYYayWUxMaCaIJQGg1kQ0VNAdkY/QA0JH4AQyEdDRdB74xGQ4CYUABnJMfezsM8JHvKMs8ei4GdGDe57O3zMvP7z8vO7HBW5QIAPjmX65Oc93JgrcDY5Sop5+JW9ZY4Z5sCYGnqSdd7zhWNunhUbdPul2zRLz5mTNyKirtoHwD7lEnVvXk+cmNXUJVjy5sIj7yqJzqRDRktSoBsHuwHJgYof/J23rS4/GOH7AEc88lDRhMgIykAJ2x0evJeZCQFJPW2idMsyEgKiFNQkrH/BSTZ+li3tgdcF+ykwU5b/4mV2Jn5nPHs/acM2PXTFpJk3DEBL9y1q8LzRkHwxrhQtiXEw4G27o5r6Q7MLawXCwvvNpY9X0pdWXHjdWWgrbISO26u0y/740zwDBUcZR+6197TdbP+TiolbPw1N9S0NGQvidWvexu6vLjxujLQdjQHJuY+9B5IeKZ2eFeowGr2oOX/jNPZAr/Op7MF8dRdOK9W2iXIRzxiX0Qlm2AXjKd+qRXN+1sYHPPhMnS2IEbn09mCeOpuLb6d3b//YOyjD+XbaqN65o+VwvefWzjms3V2puyDt/ZtbxUnsVR7Xl3lceN1ZaCt8hZy3HyT55dGla2FCjbRXhGAcI67WXtQ3h7BDwYTYXVMxwRgwPw8WCvbuWHVOXd1CabZTggIAF/O5tzgv8l37V7IZOAw278rQI2tUlitac/ISPYAqEMk04DDPMhICsATsHCCac/ISArA4zvGZN406N88Mo+MpAA8e0xb6ddmipB5ZENGch0IlJpyuIsT9mjMhw53DwElT/W1PxsJFAAAAABJRU5ErkJggg=="},fed4:function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e"),a("cc57");var i=a("28f8"),n=a("dc52"),o=a("528f"),s=a("5a71"),r=a("0f7b"),c=a("07d2"),l=a("fd50"),d=a("3bd5"),p=a("f97c"),u=a("3516"),h=a("7b81"),f=a("37d5"),m=a("e2a7"),b=a("a500");function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={components:{AppStepper:r.a,appRadio:n.a,UserSelect:o.a,SingleSelect:s.default,Item:c.default},data:function(){return{type:"add",viewTitle:"新建批次",batchId:"",showSectionDialog:!1,showCheckManDialog:!1,showMasterDialog:!1,showCCDialog:!1,batch:{},data:this.initData()}},activated:function(){$log.log("现场检查添加批次，activated"),this.init()},destroyed:function(){window.clearTimeout(this.timeoutEvent)},methods:{initData:function(){return{timeoutEvent:null,bidsectionData:[],inspectorData:[],hasRightUsers:[],ccOptions:[],batchName:"",timeLimit:7,type:"随机检查",checkItem:{id:"",name:""},building:{id:"",name:"",unit:""},cc:[],ccStr:"",purpose:"正式",batchBidsection:{},batchInspector:[],batchInspectorStr:"",batchCharger:{}}},init:function(){var e=this,a=this.$route.params,i=p.a.getDefaultProject().id;this.batch={},this.batchId=a&&a.id?a.id:"",this.data=this.initData(),l.a.when().then((function(){if(e.batchId)return e.type="edit",e.viewTitle="编辑批次",e.loadData();e.type="add",e.viewTitle="新建批次",e.$nextTick((function(){e.timeoutEvent=window.setTimeout((function(){e.$refs.batch_add_name_input.focus()}),500)}))})).then((function(){var t=d.a.getUser();if("add"===e.type)e.data.batchCharger=v(v({},t),{},{id:t.user_id,name:t.user_name});else if("edit"===e.type)return h.a.getUsersByIds([e.batch.in_charge_by||e.batch.created_by]).then((function(t){t.length&&(e.data.batchCharger={id:t[0].id,name:t[0].name})}))})).then((function(){f.default.getProjectCheckUsers(i,[31,32,33]).then((function(a){e.data.inspectorData=t.map(a,(function(a){var i=!1,n=!1;return a.user_id===e.data.batchCharger.id&&(i=!0,n=!0),t.extend({},a,{checked:i,disabled:n})}))}))})).catch((function(t){$log.error(t)})),u.a.getSectionList(i).then((function(a){e.data.bidsectionData=t.map(a,(function(t){return{id:t.id,name:t.name+"（"+t.proj_name+"）",proj_id:t.proj_id}}))})),f.default.getProjectUsers(i,[34]).then((function(t){e.data.hasRightUsers=t})),f.default.getProjectUsers(i,[31,32,33]).then((function(t){e.data.ccOptions=t}))},isCheckItemSelected:function(){if(!this.data.batchBidsection.name)return m.a.alert("请选择所属标段"),!1;this.batchId&&b.a.addTrack("现场检查-修改批次-修改检查人")},closePopupRight:function(){this.showSectionDialog=!1,this.showCheckManDialog=!1,this.showMasterDialog=!1,this.showCCDialog=!1},selectSection:function(t){this.data.batchBidsection=t},selectCheckMan:function(e,a){var i=t.map(e,(function(t){return{id:t.user_id,name:t.user_name,checked:!0}}));this.$set(this.data,"batchInspector",i),this.$set(this.data,"batchInspectorStr",a)},selectMaster:function(t,e){this.$set(this.data,"batchCharger",v(v({},t),{},{id:t.user_id,name:t.user_name}))},selectCCMan:function(e,a){var i=t.map(e,(function(t){return{id:t.user_id,name:t.user_name,checked:!0}}));this.$set(this.data,"cc",i),this.$set(this.data,"ccStr",a)},loadData:function(){var e=this;return u.a.getBatchUsers(this.batchId).then((function(a){var i=[];e.data.batchInspector=t.map(a,(function(t){return i.push(t.user_name),{id:t.user_id,name:t.user_name,checked:!0}})),e.data.batchInspectorStr=i.join("、")})),u.a.getBatchCCs(this.batchId).then((function(a){var i=[];e.data.cc=t.map(a,(function(t){return i.push(t.user_name),{id:t.user_id,name:t.user_name}})),e.data.ccStr=i.join("、")})),u.a.getBatch(this.batchId).then((function(t){e.batch=t,e.data.batchName=t.name,e.data.timeLimit=t.repair_deadline,e.data.purpose=t.batch_purpose||"正式",e.data.batchBidsection={id:t.section_id,name:t.section_name+"（"+t.proj_name+"）",proj_id:t.proj_id}}))},swtichPurpose:function(t){this.$set(this.data,"purpose",t)},saveBatch:function(){var e=this;if(""!==this.data.batchName)if(this.data.batchBidsection&&this.data.batchBidsection.id)if(void 0!==this.data.timeLimit&&null!==this.data.timeLimit)if(this.data.batchInspector&&this.data.batchInspector.length){if(this.data.batchCharger.id){var a=!1,i=t.map(this.data.batchInspector,(function(t){return t.id===e.data.batchCharger.id&&(a=!0),t.id}));a||i.unshift(this.data.batchCharger.id);var n={batch:{id:this.batchId,batch_type:"安全文明",proj_id:this.data.batchBidsection.proj_id,bidsection_id:this.data.batchBidsection.id,name:this.data.batchName,repair_deadline:this.data.timeLimit,building_id:this.data.building.id,unit:this.data.building.unit,item_id:this.data.checkItem.id,batch_purpose:this.data.purpose||"正式",in_charge_by:this.data.batchCharger.id},batch_user:i,batch_cc:t.map(this.data.cc,(function(t){return t.id})),batch_room:t.map(this.batchRoom,(function(t){return{building_id:t.building_id,room_id:t.id,unit:t.unit}}))};return m.a.loading("请稍等..."),$log.log("现场检查添加批次，执行保存"),u.a.uploadBatch(n).then((function(t){$rootScope.newBatch=t,e.$router.go(-1)})).catch((function(t){m.a.alert(t)})).finally((function(){m.a.hideLoading()}))}m.a.alert("请选择负责人")}else m.a.alert("请选择检查人");else m.a.alert("请输入默认整改期限");else m.a.alert("请选择所属标段");else m.a.alert("请输入批次名称")}}}}).call(this,a("391c"))}}]);