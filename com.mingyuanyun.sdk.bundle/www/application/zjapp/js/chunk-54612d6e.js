(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-54612d6e"],{"183d":function(e,t,a){var i=a("8ccb");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("85cb").default)("a07982f2",i,!0,{sourceMap:!1,shadowMode:!1})},"2d6e":function(e,t,a){var i=a("7eb2");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("85cb").default)("53a2fbaa",i,!0,{sourceMap:!1,shadowMode:!1})},"3f58":function(e,t,a){"use strict";a("183d")},"65e9":function(e,t,a){"use strict";(function(e){a("5ab2"),a("6d57"),a("e10e");var i=a("28f8"),o=a("4360"),n=a("48f4"),r=a("162a"),s=a("f2d3"),c=a("6906"),d=a("a18c"),l=a("c745");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a={name:"SynchronizeTipBar",props:{isTodo:{type:Boolean},useDownload:{type:Boolean,default:!0},enterDoCheck:{type:Boolean,default:!0},buildingId:{type:String,default:""},automaticUpdateCallback:{type:Function,default:null}},data:function(){return{currentModuleCode:"",oneUpdateData:!0}},computed:{projId:function(){return o.a.state.global.currentProject.id},waitUploadNum:function(){return o.a.state.global.waitUploadNum},hasTopProgress:function(){return o.a.state.global.hasTopProgress},hasChanged:function(){if(!this.useDownload)return!1;if(this.currentModuleCode){var e,t=n.default.isModuleNeedBuilding(this.currentModuleCode)&&!this.isTodo;return!(t&&!this.buildingId)&&(e=this.isTodo?o.a.state.global.todoChangedStatus||{}:o.a.state.global.businessChangedStatus||{},t?!!e[this.currentModuleCode]&&e[this.currentModuleCode][this.buildingId]:e[this.currentModuleCode])}return!1},show:function(){return(this.hasChanged||this.waitUploadNum)&&!this.hasTopProgress},oneDataSync:function(){return this.$store.state.app.oneDataSync}},watch:{hasChanged:function(e){var t=this;e&&this.$nextTick((function(){setTimeout((function(){var e=t.$refs["synchronize-tip-bar"];if(e&&e.style){e.style.display="none";e.offsetHeight;e.style.display="block"}}),100)}))},buildingId:function(e){this.currentModuleCode&&n.default.isModuleNeedBuilding(this.currentModuleCode)&&e&&(console.log("楼栋重新加载，是否再次自动加载数据：",this.oneUpdateData),this.oneUpdateData&&this.automaticLogic(),this.checkSync())},show:function(e){e?this.$emit("show"):this.$emit("hide")}},activated:function(){this.init()},methods:{init:function(){this.getCurrentModuleCode(),this.enterDoCheck&&!d.a.isBack&&this.checkSync(),this.automaticLogic()},automaticLogic:function(){var e=this;this.$router.isBack||(this.oneUpdateData=!0,l.a.getAutomaticLoadData().then((function(t){$log.log("是否要自动加载 ===> ",t&&e.oneDataSync&&"function"==typeof e.automaticUpdateCallback),t&&e.oneDataSync&&"function"==typeof e.automaticUpdateCallback&&e.dataSync().then((function(t){console.log("是否需要初始化页面 ====> ",Boolean(t)),t&&e.automaticUpdateCallback()}))})))},getCurrentModuleCode:function(){var e=n.default.getCurrentModuleCode(),t=this.isTodo?"todo":"";this.currentModuleCode=e||t},checkSync:function(){var t=this,a="checkDataUpdate",i=this.currentModuleCode,r=this.buildingId,d=o.a.state.global.isLeader?this.projId:"";return!n.default.isModuleNeedBuilding(i)||r||this.isTodo?(this.isTodo&&(a+="_todo"),i&&(a+="_".concat(i)),r&&(a+="_".concat(r)),c.a.execAfterInterval(120,a).then((function(){return t.isTodo?"todo"===i?s.a.getModuleList().then((function(t){var a=e.map(t,"code");return n.default.hasTodoChangedData("",a)})):n.default.hasTodoChangedData("",[i]):n.default.hasBusinessChangedData(d,[i],r)})).then((function(e){if(t.isTodo){var a=u({},o.a.state.global.todoChangedStatus);a[i]=e,o.a.commit("global/SET_TODO_CHANGED_STATUS",a)}else{var n=u({},o.a.state.global.businessChangedStatus);if(r){var s=n[i]?n[i]:{};s[r]=e,n[i]=s}else n[i]=e;o.a.commit("global/SET_BUSINESS_CHANGED_STATUS",n)}})).catch((function(e){return e&&!0===e.timeNotTo?($log.debug(e.msg),!1):$q.reject(e)}))):Promise.resolve()},dataSync:function(){var e=this.currentModuleCode,t=this.buildingId,a=n.default.isModuleNeedBuilding(e),i=a&&!t;return $log.log(["模块名：",e," 楼栋id：",t," 当前模块是否需要楼栋id：",a," 判断是否终止自动更新：",i]),i?Promise.resolve():(this.oneUpdateData=!1,r.a.beginManualUpdate(),n.default.checkSync(t).then((function(e){return r.a.endManualUpdate(),e})).catch((function(e){$log.error("自动更新错误",e),r.a.endManualUpdate()})))}}}}).call(this,a("391c"))},"66f8":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAMAAAAPdrEwAAAAXVBMVEUAAADJycni4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLIyMjIyMji4uLIyMjIyMjJycnPz8/IyMjIyMjIyMji4uLi4uLIyMjLy8vJycnIyMjZ2dnJycnIyMji4uLa2tqOIKRyAAAAHHRSTlMAMwHxuR7zvWllS+Yh871H/eeEgGQgGNjDs5Q0bEl4+QAAAURJREFUWMPt2GkOwiAQhmGKOxWwLnVjvP8xbY11UvlBzQxxm+8Ab56ka1DDZ5y1zqgMW4fb1vxlE+5jd+t9l95r3vJkHB4bTzjJixFgGkYLzUcGgFVXXgEAwsnkZpcufQEAhBPJ7abz7uabTwEQTibDbIePzG4GCKeTexWNcDJ5qZ6GcEZyDKeT03A6OYazkXFLhNPJaTidHMMJZDpcbyMyAZ4k0+ExmQAnk2M4gZyCb2OWPwSmHXy/vAmM20Q/GXwzCud4007hbPulPp0L8s6n9stvFS408wXLfNt6ShdMk7SkJf2facW030z7Mgxc6V9MYzndzpeuXkybajDafM5llLSkJU1585WeL30vYztfuuJLm6qPNl9xGSUtaUm/MV3zlOtHGg8tjjVL+dikbMajlowHRHmPtXDeWZ6udV7JZLLP2hV1pKxnDHsrZAAAAABJRU5ErkJggg=="},"757f":function(e,t,a){"use strict";a.r(t);var i=a("adb8").a,o=(a("3f58"),a("17cc")),n=Object(o.a)(i,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("page-content",{attrs:{"is-special-header":!0}},[e.model.isLoading?[i("span",{staticClass:"text",attrs:{slot:"header-bar"},slot:"header-bar"},[e._v("...")])]:e.projectList&&e.projectList.length?i("drop-down-select-single",{ref:"home-index-company-select",attrs:{slot:"header-bar",options:e.projectList,type:"home",selected:e.selectProject},on:{select:e.onSelectProject},slot:"header-bar"}):[i("span",{staticClass:"text",attrs:{slot:"header-bar"},slot:"header-bar"},[e._v("无项目权限或未建标段")])],i("scroller",{attrs:{"is-empty":e.loading},on:{pullDown:e.onRefresh}},[e.loading?e._e():i("div",{staticClass:"home-page-bg"},[i("div",{staticClass:"home-page-module"},[i("synchronize-tip-bar",{attrs:{"use-download":!1}}),i("div",[!e.model.isLoading&&e.model.moduleList.length<=2?e._l(e.model.moduleList,(function(t,a){return i("div",{directives:[{name:"track",rawName:"v-track",value:"schedule-plan"===t.code?"工作台-进入进度管理":"",expression:"item.code === 'schedule-plan' ? '工作台-进入进度管理' : ''"}],key:a,staticClass:"module-item",on:{click:function(a){e.enterModule(t)}}},["project-highlight"===t.code?i("div",{staticClass:"item-icon"},[t.isHasNewData?i("img",{staticClass:"active-icon",attrs:{src:t.activeIcon,alt:t.name}}):e._e(),t.isHasNewData?e._e():i("img",{attrs:{src:t.icon,alt:t.name}})]):e._e(),"project-highlight"!==t.code?i("div",{staticClass:"item-icon"},[i("img",{attrs:{src:t.icon,alt:t.name}})]):e._e(),i("div",{staticClass:"item-name",domProps:{textContent:e._s(t.name)}})])})):e._e(),!e.model.isLoading&&e.model.moduleList.length>2?i("div",{staticClass:"clearfix"},e._l(e.model.moduleList,(function(t,a){return i("div",{directives:[{name:"track",rawName:"v-track",value:"schedule-plan"===t.code?"工作台-进入进度管理":"",expression:"item.code === 'schedule-plan' ? '工作台-进入进度管理' : ''"}],key:a,staticClass:"module-item-grid",on:{click:function(a){e.enterModule(t)}}},["project-highlight"===t.code?i("div",{staticClass:"item-icon"},[t.isHasNewData?i("img",{staticClass:"active-icon",attrs:{src:t.activeIcon,alt:t.name}}):e._e(),t.isHasNewData?e._e():i("img",{attrs:{src:t.icon,alt:t.name}})]):e._e(),"project-highlight"!==t.code?i("div",{staticClass:"item-icon"},[i("img",{attrs:{src:t.icon,alt:t.name}})]):e._e(),i("div",{staticClass:"item-name",domProps:{textContent:e._s(t.name)}})])}))):e._e(),e.model.isLoading||e.model.moduleList.length?e._e():i("div",{staticClass:"module-empty"},[e._v("功能模块马上登场，请稍候...")]),e.model.isLoading?i("div",{staticClass:"module-item"},[e._v("...")]):e._e()],2)],1),i("div",{staticClass:"list home-page-news"},[i("div",{staticClass:"news-title"},[i("span",{staticClass:"icon"}),e._v("公告\n        ")]),i("div",{staticClass:"news-list"},[e.model.isNoticeLoading?e._e():e._l(e.model.noticeList,(function(t,a){return i("div",{key:a,staticClass:"news-item",on:{click:function(a){e.newsDetail(t)}}},[i("div",{staticClass:"news-item-con"},[i("p",{staticClass:"title one-line"},[e._v(e._s(t.title||""))]),i("p",{staticClass:"detail one-line"},[e._v(e._s(t.detail||""))])]),i("div",{staticClass:"news-item-date"},[e._v(e._s(e._f("formatDate")(t.publish_time,"MM-DD")))])])})),e.model.isNoticeLoading?i("div",{staticClass:"news-item-empty"},[e._v("加载中...")]):e._e(),e.model.isNoticeLoading||e.model.noticeList.length?e._e():i("div",{staticClass:"news-item-empty"},[i("span",{staticClass:"icon"},[i("img",{attrs:{src:a("66f8"),alt:""}})]),i("span",{domProps:{textContent:e._s(e.projectSelected.id?"暂无公告":"请先选择一个项目")}})])],2)])]),i("loading-status",{attrs:{"is-loading":e.loading}})],1)],2)}),[],!1,null,"7986326c",null);t.default=n.exports},"7eb2":function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,".zjapp .synchronize-tip-bar[data-v-66826030]{height:30px;padding:5px 15px;line-height:20px;text-align:center;background-color:#ffe6e6;color:#ff6060;font-size:14px}.zjapp .synchronize-tip-bar .icon-caution[data-v-66826030]{line-height:20px;margin-right:5px}@media screen and (-webkit-min-device-pixel-ratio:1){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 100%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:1.5){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2.625){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 38.0952%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:3){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:4){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 25%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}",""])},"8ccb":function(e,t,a){var i=a("5454");(e.exports=a("690e")(!1)).push([e.i,".zjapp .project-select[data-v-7986326c]{text-align:center;padding:0 10px;line-height:44px}.zjapp .project-select .text[data-v-7986326c]{pointer-events:none}.zjapp .project-select-con[data-v-7986326c]{display:inline-block;position:relative;padding-right:23px;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;pointer-events:none;vertical-align:top}.zjapp .project-select-con .arrow[data-v-7986326c]{position:absolute;top:13px;right:0;width:18px;height:18px;background:url("+i(a("7fb27"))+') no-repeat;background-size:100% 100%;transition:transform .2s}.zjapp .project-select-con .arrow.active[data-v-7986326c]{transform:rotate(180deg)}.zjapp .notice-detail-wrip[data-v-7986326c]{width:100%;height:100%}.zjapp .notice-detail-wrip .layout-main[data-v-7986326c]{height:100%}.zjapp .notice-detail-wrip .layout-main .layout-content[data-v-7986326c]{background-color:#fff}.zjapp .home-page-bg[data-v-7986326c]{position:relative;padding:10px 0 20px 0;background:#fff}.zjapp .home-page-bg>div[data-v-7986326c]{position:relative;z-index:2}.zjapp .home-page-bg[data-v-7986326c]:after,.zjapp .home-page-bg[data-v-7986326c]:before{position:absolute;top:0;left:0;content:" ";display:block;width:100%;height:200px;background:linear-gradient(90deg,#2c5cf7 0,rgba(44,92,247,.8));z-index:0}.zjapp .home-page-bg[data-v-7986326c]:after{z-index:1;background:linear-gradient(1turn,#fff,hsla(0,0%,100%,0))}.zjapp .home-page-module[data-v-7986326c]{position:relative;padding:25px 0;margin:0 10px;min-height:190px;background-color:#fff;margin-bottom:10px;overflow:hidden;box-shadow:0 0 20px rgba(66,117,232,.2);border-radius:10px}.zjapp .home-page-module .module-item[data-v-7986326c]{text-align:center;padding:8px 0 10px}.zjapp .home-page-module .module-item-grid[data-v-7986326c]{float:left;width:33.3333%;text-align:center;padding:8px 0 10px}.zjapp .home-page-module .item-icon[data-v-7986326c]{height:27px;text-align:center}.zjapp .home-page-module .item-icon img[data-v-7986326c]{width:27px;height:27px}.zjapp .home-page-module .item-icon .active-icon[data-v-7986326c]{width:31px;height:44px;position:relative;bottom:16px}.zjapp .home-page-module .item-name[data-v-7986326c]{line-height:22px;margin-top:8px;color:#666;font-size:14px}.zjapp .home-page-module .module-empty[data-v-7986326c]{text-align:center;color:#b2b2b2}.zjapp .home-page-module .synchronize-tip-bar[data-v-7986326c]{position:absolute;top:0;left:0;width:100%;border-top-left-radius:10px;border-top-right-radius:10px}.zjapp .home-page-news[data-v-7986326c]{margin-top:10px}.zjapp .home-page-news .news-title[data-v-7986326c]{height:40px;line-height:14px;font-size:14px;padding:21px 15px 5px;color:#666}.zjapp .home-page-news .news-title .icon[data-v-7986326c]{display:inline-block;vertical-align:top;width:4px;height:14px;margin-right:6px;background:#f7c141;border-radius:2px}.zjapp .home-page-news .news-list[data-v-7986326c]{padding-left:20px}.zjapp .home-page-news .news-item[data-v-7986326c]{position:relative;padding:8px 75px 8px 0;border:none;background-image:linear-gradient(0deg,#e6e6e6,#e6e6e6 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .home-page-news .news-item[data-v-7986326c]:last-child{background:none!important}.zjapp .home-page-news .title[data-v-7986326c]{line-height:26px;font-size:15px;color:#111}.zjapp .home-page-news .detail[data-v-7986326c]{line-height:18px;font-size:12px;color:#b2b2b2}.zjapp .home-page-news .news-item-date[data-v-7986326c]{position:absolute;top:50%;right:15px;margin-top:-13px;line-height:26px;font-size:12px;color:#b2b2b2}.zjapp .home-page-news .news-item-empty[data-v-7986326c]{padding:26px 15px 26px 0;line-height:22px;text-align:center;color:#b2b2b2}.zjapp .home-page-news .news-item-empty .icon[data-v-7986326c]{display:inline-block;vertical-align:top;width:22px;height:22px;margin-right:10px}.zjapp .home-page-news .news-item-empty .icon img[data-v-7986326c]{width:22px}',""])},adb8:function(e,t,a){"use strict";(function(e){a("e697"),a("cc57"),a("6a61");var i,o=a("2e91"),n=a("774b"),r=a("f7ab"),s=a("e2a7"),c=a("ed08"),d=a("f97c"),l=a("48f4"),p=a("c656"),u=a("6144"),h=a("6f9e"),g=(a("162a"),a("2137"));a("1b7e"),a("7bac");t.a={name:"WorkBench",components:{Scroller:n.default,SynchronizeTipBar:r.a,DropDownSelectSingle:g.a},data:function(){return{loading:!1,showPopup:!1,selectProject:{},model:{isLoading:!0,moduleList:[],noticeList:[],defaultProject:{}}}},computed:{projectList:function(){return this.$store.state.global.allProjectsTreeData},allProjects:function(){return this.$store.state.global.allProjects},projectSelected:function(){return this.$store.state.global.currentProject}},created:function(){var e=this;this.loading=!0,Object(h.e)(this.init),h.a.$on("guangmingWakeUp",(function(){e.init()}))},activated:function(){this.init()},methods:{init:function(){var e=this;d.a.init().then((function(){e.loading=!1,e.model=d.a,e.getProjects()}))},getProjects:(i=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("global/setAllProjects");case 2:this.selectProject=this.projectSelected,this.selectProject&&!e.isEmpty(this.selectProject)&&this.onSelectProject(this.selectProject,{name:this.selectProject.parent_name});case 4:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)}),onSelectProject:function(e,t){var a=this;this.selectProject=e,e.parent_name=t&&t.name,e.parent_name&&this.$store.commit("global/SET_CURRENT_PROJECT",e),this.model.saveAsDefaultProject(e),p.a.getProjNotice(this.projectSelected.id).then((function(e){a.model.noticeList=e})),l.default.setLocalChanged(),l.default.showTopProgress(),l.default.executeSync()},enterModule:function(t){if("photos"===t.code)return this.$router.push({name:t.routerName});if(t&&t.code)if(e.isEmpty(this.projectSelected))s.a.alert("请先选择一个项目");else{var a=e.find(this.model.moduleList.concat(this.model.headList),(function(e){return e.code===t.code}));this.projectSelected.expire_time&&this.projectSelected.expire_time<=c.a.now()&&"报表"!==a.name?s.a.alert("该项目租期已过"):this.$router.push({name:t.routerName})}else s.a.alert("无效的模块编码")},newsDetail:function(e){u.a.saveObject("workBrenchCacheNotice",e),this.$router.push({path:"/notice",param:{id:e.id}})},onRefresh:function(){this.init()}}}}).call(this,a("391c"))},f7ab:function(e,t,a){"use strict";var i=a("65e9").a,o=(a("f7d4"),a("17cc")),n=Object(o.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.show?a("div",{ref:"synchronize-tip-bar",staticClass:"synchronize-tip-bar"},[a("icon",{attrs:{name:"caution"}}),e.waitUploadNum?a("span",[e._v("您有"+e._s(e.waitUploadNum)+"条数据待上传")]):e._e(),!e.waitUploadNum&&e.hasChanged?a("span",[e._v("有新数据")]):e._e(),e._v("\n  ，下拉可"+e._s(e.waitUploadNum?"上传":"刷新")+"\n")],1):e._e()}),[],!1,null,"66826030",null);t.a=n.exports},f7d4:function(e,t,a){"use strict";a("2d6e")}}]);