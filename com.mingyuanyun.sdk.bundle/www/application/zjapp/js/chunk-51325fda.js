(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-51325fda"],{1257:function(t,e,i){"use strict";i.r(e);var a=i("b2b9").a,r=i("17cc"),n=Object(r.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{title:"视频监控"}},[i("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:function(e){t.changeTab()}},slot:"header-bar-right"},[t._v("\n    "+t._s(t.tabName[t.type])+"\n  ")]),t.isLoading?t._e():i(t.comments[t.type],{tag:"component",attrs:{list:t.list,"edit-data":t.editData}}),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":t.isEmpty,"empty-text":t.allowVideoMonitor?t.emptyTips:"请升级到最新版本"}})],1)}),[],!1,null,null,null);e.default=n.exports},"29fc":function(t,e,i){"use strict";i("80cb")},"2cbf":function(t,e,i){var a=i("7573");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("0f2e1eb5",a,!0,{sourceMap:!1,shadowMode:!1})},"3c4f":function(t,e,i){var a=i("5454");(t.exports=i("690e")(!1)).push([t.i,".zjapp .video-monitor[data-v-7f953220]{background:#fff}.zjapp .video-monitor .monitor-title[data-v-7f953220]{height:46px;padding:12px 15px;color:#333;line-height:22px;font-size:16px;font-weight:700}.zjapp .video-monitor .monitor-title-cion[data-v-7f953220]{display:inline-block;vertical-align:top;width:18px;height:22px;margin-right:8px;background:url("+a(i("5611"))+') no-repeat 0 2px;background-size:18px 18px}.zjapp .video-monitor .monitor-video-box[data-v-7f953220]{position:relative;background:no-repeat 50%;background-size:cover}.zjapp .video-monitor .icon-monitor-play[data-v-7f953220]{position:absolute;top:50%;left:50%;width:50px;height:50px;margin:-25px 0 0 -25px;background:#fff;color:#111;text-align:center;line-height:50px;font-size:32px;border-radius:25px}.zjapp .video-monitor .icon-monitor-play[data-v-7f953220]:before{content:" ";position:absolute;display:block;width:0;height:0;top:15px;left:20px;border-top:10px solid transparent;border-right:10px solid transparent;border-bottom:10px solid transparent;border-left:18px solid #000}',""])},"5f9e":function(t,e,i){"use strict";i("f97c");var a=i("774b"),r=i("6dfe"),n=(i("e223"),{components:{Scroller:a.a,MapItem:r.a},props:{editData:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{gotoHorizontal:function(){this.$router.push({name:"HorizontalMap"})}}}),o=(i("69bc"),i("17cc")),s=Object(o.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return this.editData.url?e("div",{staticClass:"vertical-map"},[e("map-item",{attrs:{"edit-data":this.editData}}),e("div",{staticClass:"settting",on:{click:this.gotoHorizontal}},[e("i",{staticClass:"iconfont icon-shoujifanzhuan"})])],1):this._e()}),[],!1,null,"14ad938b",null);e.a=s.exports},"69bc":function(t,e,i){"use strict";i("2cbf")},7573:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .vertical-map[data-v-14ad938b]{height:100%}.zjapp .vertical-map .settting[data-v-14ad938b]{position:fixed;display:flex;align-items:center;justify-content:center;right:16px;bottom:80px;width:60px;height:60px;border-radius:50%;color:#fff;background-image:linear-gradient(#55abff,#4c7aff);z-index:999;opacity:.9;box-shadow:1px 1px 4px rgba(0,0,0,.4)}.zjapp .vertical-map .settting .icon-shoujifanzhuan[data-v-14ad938b]{font-size:24px}",""])},"80cb":function(t,e,i){var a=i("3c4f");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("345dd229",a,!0,{sourceMap:!1,shadowMode:!1})},"831b":function(t,e,i){t.exports=i.p+"img/default-monitor-list.a3dd8002.jpg"},"8fff":function(t,e,i){"use strict";i("6a61");var a,r=i("2e91"),n=(i("fd50"),i("24de"),i("4ad6"),i("774b")),o=i("f24e"),s={name:"VideoMonitor",components:{Scroller:n.a},props:{list:{type:Array,default:function(){return[]}}},data:function(){return{proj_id:"",videoHeight:0,isLoading:!1,retMsg:{200:"操作成功",10001:"参数错误",10002:"accessToken异常或过期",10004:"用户不存在",10005:"appKey异常",10017:"appKey不存在",20002:"设备不存在",20007:"设备不在线",20014:"deviceSerial不合法",20018:"该用户不拥有该设备",20032:"该用户下通道不存在",60020:"不支持该命令",60060:"地址未绑定",49999:"数据异常"},statusMsg:{0:"未使用或直播已关闭",1:"使用中",2:"已过期",3:"直播已暂停"},exceptionMsg:{0:"正常",1:"设备不在线",2:"设备开启视频加密",3:"设备删除",4:"失效",5:"未绑定",6:"账户下流量已超出"}}},created:function(){this.videoHeight=.58*$rootScope.viewSize.width},methods:{playVideo:(a=Object(r.a)(regeneratorRuntime.mark((function t(e,i){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("hik"===i){t.next=5;break}return t.next=3,o.a.getVideoDetail(e.url);case 3:a=t.sent,e.data=a.data;case 5:t.t0=i,t.next="gld"===t.t0?8:"ys"===t.t0?10:"url"===t.t0?12:"hik"===t.t0?14:15;break;case 8:return o.a.playGld(e),t.abrupt("break",15);case 10:return o.a.playYsy(e),t.abrupt("break",15);case 12:return o.a.playUrl({url:e.data,title:e.title}),t.abrupt("break",15);case 14:o.a.playHik(e);case 15:case"end":return t.stop()}}),t)}))),function(t,e){return a.apply(this,arguments)})}},c=(i("29fc"),i("17cc")),l=Object(c.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.list.length?i("scroller",{attrs:{"is-empty":!t.list.length,"has-next":!1}},[i("div",{staticClass:"scroll-wrap"},t._l(t.list,(function(e,a){return i("div",{key:e.title+a,staticClass:"video-monitor"},[i("div",{staticClass:"monitor-title border-bottom"},[i("i",{staticClass:"monitor-title-cion"}),t._v("\n        "+t._s(e.title)+"\n      ")]),i("div",{directives:[{name:"track",rawName:"v-track",value:"视频监控-播放",expression:"'视频监控-播放'"}],staticClass:"monitor-video-box",style:"height: "+t.videoHeight+"px; background-image: url("+e.cover_url+")",on:{click:function(i){t.playVideo(e,e.video_type)}}},[i("i",{staticClass:"ion-ios-play icon-monitor-play"})])])})))]):t._e()}),[],!1,null,"7f953220",null);e.a=l.exports},b2b9:function(t,e,i){"use strict";(function(t){i("6a61");var a,r,n=i("2e91"),o=i("1b7e"),s=(i("162a"),i("8fff")),c=i("5f9e"),l=i("e2a7"),p=i("f24e"),u=i("f97c"),d=i("4ad6"),f=i("831b"),h=i.n(f),g=i("cba0"),m=i("6144");e.a={components:{ListMap:s.a,VerticalMap:c.a},data:function(){return{tabName:{list:"平面图模式",map:"列表模式"},type:"list",comments:{map:c.a,list:s.a},emptyTips:"",isLoading:!1,allowVideoMonitor:!1,proj_id:"",list:[],editData:{},isEmpty:!1}},activated:function(){if(!this.$router.isBack){var t=this.$route.params;this.proj_id=t&&t.id?t.id:u.a.getDefaultProject().id;var e=m.a.getUserString("zj-video-tab");this.type=e||"list",this.init(),this.getData()}},methods:{init:function(){this.editData={url:"",points:[]},this.list=[]},changeTab:function(t){this.type=t||("map"===this.type?"list":"map"),m.a.saveUserString("zj-video-tab",this.type),this.getData()},getData:function(){var t=this;return this.isLoading=!0,"list"===this.type?this.getList().catch((function(e){t.isLoading=!1,l.a.alert(e.errmsg||e)})):this.getEditData().catch((function(e){t.isLoading=!1,l.a.alert(e.errmsg||e)}))},getList:(r=Object(n.a)(regeneratorRuntime.mark((function e(){var i,a,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.list.length>0)){e.next=2;break}return e.abrupt("return",this.isLoading=!1);case 2:return e.next=4,o.a.getHasNetwork();case 4:if(!e.sent){e.next=9;break}this.emptyTips="未对接摄像头",e.next=11;break;case 9:return this.emptyTips="当前无网络连接",e.abrupt("return",Promise.reject({errmsg:"当前无网络连接"}));case 11:return e.next=13,Object(g.c)({proj_id:this.proj_id}).catch((function(t){return $log.log("获取视频监控插件失败",t),Promise.reject({errmsg:"当前无网络连接"})}));case 13:return i=e.sent,this.list=i,t.each(this.list,(function(t){t.cover_url&&r.loadImage(t.cover_url).then((function(e){t.cover_url=e})),r.$set(t,"cover_url",h.a)})),e.next=18,d.a.allowVideoMonitor();case 18:a=e.sent,this.allowVideoMonitor=a,this.isLoading=!1,this.isEmpty=!this.list.length||!this.allowVideoMonitor;case 22:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)}),getEditData:(a=Object(n.a)(regeneratorRuntime.mark((function t(){var e,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.allowVideoMonitor();case 2:if(e=t.sent,this.allowVideoMonitor=e,this.emptyTips="查无点位，请在后台设置",!this.editData.url){t.next=7;break}return t.abrupt("return",this.isLoading=!1);case 7:return t.abrupt("return",p.a.getPointData(this.proj_id).then((function(t){i.editData=t,i.isLoading=!1,i.isEmpty=!t.url})));case 8:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)}),loadImage:function(t){if(!t)return Promise.reject(null);var e=new Image;return e.src=t,new Promise((function(i,a){e.onload=function(){$log.log("视频图片加载成功！",t),i(t)},e.onerror=function(e){$log.log("视频图片加载失败！",t),a(e)}}))}}}}).call(this,i("391c"))}}]);