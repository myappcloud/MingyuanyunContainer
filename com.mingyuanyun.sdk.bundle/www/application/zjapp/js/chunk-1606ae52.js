(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-1606ae52","chunk-59fa3e5d","chunk-0b5b35be","chunk-1cd94a56","chunk-2b8a39de","chunk-606c3122"],{"045f":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .text-area-border{border:1px solid #eee;border-bottom:null}",""])},"0732":function(t,e,a){var i=a("81f2");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("1b5b07de",i,!0,{sourceMap:!1,shadowMode:!1})},1020:function(t,e,a){var i=a("11a3");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("46f0e6b7",i,!0,{sourceMap:!1,shadowMode:!1})},"10d4":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .multi-select-list-title[data-v-89cd976c]{position:relative;color:#888;font-size:14px;line-height:30px;min-height:40px;margin-bottom:0;margin-top:0;padding:8px 16px;background-color:#f2f2f2}.zjapp .item[data-v-89cd976c]{padding:16px}.zjapp .search-item>div[data-v-89cd976c]{padding-right:35px}.zjapp .search-item i[data-v-89cd976c]{position:absolute;color:#ccc;font-size:26px;right:0;top:50%;transform:translateY(-50%)}.zjapp .van-popup--right[data-v-89cd976c]{width:100%;height:100%}[data-v-89cd976c] .van-cell__title{color:#4174e9;font-weight:700}[data-v-89cd976c] .van-collapse-item__content{transform:translateZ(0);padding:0 0 0 25px}[data-v-89cd976c] .van-collapse-item__content .van-cell{padding-left:0}",""])},1154:function(t,e,a){var i=a("045f");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("186d4104",i,!0,{sourceMap:!1,shadowMode:!1})},"11a3":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .task-wrap[data-v-739a75ec]{padding-bottom:80px}",""])},1430:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .material-v2-task{padding-bottom:80px}",""])},"151e":function(t,e,a){"use strict";a("7204")},1551:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .material-name[data-v-50dd32ab]{min-height:44px}.zjapp .txt[data-v-50dd32ab]{text-align:right}.zjapp .item-text[data-v-50dd32ab]{color:#666}",""])},"15f5":function(t,e,a){"use strict";(function(t){a("cc57"),a("6d57");var i=a("3bd5"),n=a("fc9f"),r=a("fd50"),s={getTaskInfo:function(t){return n.a.queryOne("select ms.*, ms.material as material_name, c.name as recipient_unit_name,                     log.id as log_id, cu.name as created_by_name, ru.name as recipient_name,                    section.id as section_id, section.name as section_name, mso.id as supply_id                     from material_task as ms                     left join material_task_log log on ms.id = log.task_id and log.status = '待送检'                     left join user as cu on ms.created_by = cu.id                     left join user as ru on ms.recipient = ru.id                     left join contractor as c on ms.recipient_unit = c.id                     left join section on ms.bidsection_id = section.id                     left join material_supply_order as mso on ms.id = mso.task_id                     where ms.id = ?",[t])},getCurrentUserOperation:function(t){var e=i.a.getUser().user_id;return n.a.queryOne("select mt.id as task_id, mt.status, mtpu.user_id as user_id, mtl.status_before as log_status_before,                   mtl.status as log_status, mtl.occurrence_date, mtl.operate_status                    from material_task as mt                    left join material_task_process_user as mtpu on mtpu.task_id = mt.id and mtpu.task_process_id = mt.current_task_process_id                    left join material_task_log as mtl on mtl.task_id = mt.id and mtl.task_process_id = mt.current_task_process_id                    where mt.id = ? and mtpu.user_id = ?",[t,e])},getProcessDetails:function(t){return n.a.query("select mtl.*, cu.name as user_name, cu.mobile as user_mobile, c.name as recipient_unit_name from material_task_process as mtp                    inner join material_task_log as mtl on mtl.task_process_id = mtp.id                   left join user as cu on mtl.operate_user = cu.id                    left join contractor as c on mtl.recipient_unit = c.id                    where mtp.task_id = ? and mtl.status != '已退场'",[t])},getProcess:function(t){return n.a.query("select * from material_task_process where task_id = ?",[t])},getProcessUser:function(t,e){return n.a.query("select mtp.*, cu.*                     from material_task_process_user as mtp                     left join user as cu on mtp.user_id = cu.id                     where mtp.task_id = ? and mtp.task_process_id = ?",[t,e])},getPhotoRequirement:function(t,e){return n.a.query("SELECT * from material_task_photo_requirement where task_id = ? and task_process_id = ?",[t,e])},getPhotoDetails:function(t){return n.a.query("SELECT * from material_task_photo_requirement where task_id = ?",[t])},getUserStatus:function(t,e){return n.a.query("select * from material_task_log where task_id = ? and task_process_id = ?",[t,e])},deleteLocalData:function(e){var a=[];return t.forEach([{name:"material_task",field:"id"},{name:"material_task_log",field:"task_id"},{name:"material_task_detail",field:"task_id"},{name:"material_task_user",field:"task_id"},{name:"material_task_cc",field:"task_id"},{name:"material_task_photo_requirement",field:"task_id"},{name:"material_task_process",field:"task_id"},{name:"material_task_process_user",field:"task_id"},{name:"todo",field:"biz_id"}],(function(t){a.push(n.a.executeSql("delete from ".concat(t.name," where ").concat(t.field," = ?"),[e]))})),r.a.all(a)},deleteTask:function(e){return n.a.executeSql("delete from material_task where id = ?",[e]).then((function(){return r.a.all(t.map(["material_task_log","material_task_detail","material_task_user","material_task_cc","material_task_photo_requirement"],(function(t){return n.a.delete(t,{taskId:e})})))}))},getTaskByStatus:function(t,e,a,i){var r="select mtl.*, ru.name as recipient_name, ru.mobile as recipient_mobile, ru.is_im_user as recipient_im,                       su.name as supervisor_name, su.mobile as supervisor_mobile, su.is_im_user as supervisor_im,                      ou.name as operate_user_name, ou.mobile as operate_user_mobile, ou.is_im_user as operate_user_im,                      c.name as recipient_unit_name                       from material_task_log mtl                       left join user as ru on mtl.recipient = ru.id                       left join user as su on mtl.supervisor = su.id                       left join user as ou on mtl.operate_user = ou.id                       left join contractor as c on mtl.recipient_unit = c.id                       where mtl.task_id =?";return(e=e||"")&&(r+=" and ifnull(mtl.status_before, '') = '"+e+"'"),(a=a||"")&&(r+=" and ifnull(mtl.status, '') = '"+a+"'"),r+=" order by mtl.created_on desc",!1===i?n.a.query(r,[t]):n.a.queryOne(r,[t])}};e.a=s}).call(this,a("391c"))},"1db3":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .custom-material-dialog /deep/ .van-dialog__content{padding:20px}.zjapp .custom-material-dialog /deep/ .van-dialog__content span{display:inline-block;color:#333;height:30px;line-height:30px;padding:0 13px;text-align:center;font-size:15px;border:1px solid #dcdcdc;border-radius:4px}.zjapp .custom-material-dialog /deep/ .van-dialog__content span.checked{position:relative;border-color:#4275e8;color:#4275e8!important}.zjapp .custom-material-dialog /deep/ .van-dialog__content span.checked:before{position:absolute;content:" ";display:block;border:1px solid #4275e8;border-top:none;border-right:none;width:8px;height:4px;transform:rotate(-45deg);right:3px;bottom:5px}.zjapp .custom-material-dialog /deep/ .van-dialog__content>span{margin:0 5px 5px 0}',""])},"1f31":function(t,e,a){var i=a("b887");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("a6b15162",i,!0,{sourceMap:!1,shadowMode:!1})},2286:function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return s})),a.d(e,"f",(function(){return o})),a.d(e,"a",(function(){return c}));var i={add:{allowSection:!0,allowMaterial:!0,allowPeople:!0,allowIsConstructerBtn:!0,allowIsNews:!0,allowSupplyOrderTaskVoide:!1},edit:{allowSection:!0,allowMaterial:!1,allowPeople:!0,allowIsConstructerBtn:!0,allowIsNews:!1,allowSupplyOrderTaskVoide:!1}},n={TASK:"任务",APPROACH:"进场",BACK:"退场",INSPECT:"送检",REPORT:"报告"},r=[3],s={1:"receiver",2:"checker",3:"constructer",4:"areaChecker"},o="view",c="edit"},"28e7":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-2f568a40]{height:100%;overflow:auto}",""])},2904:function(t,e,a){"use strict";var i=a("64ce").a,n=(a("eca2"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"materialV2TaskEdit",staticClass:"material-v2-task"},[a("single-select",{attrs:{options:t.sectionOptions,editabled:t.allowSection,title:"所属标段"},on:{onSelect:t.onChangeSection},model:{value:t.taskData.section,callback:function(e){t.$set(t.taskData,"section",e)},expression:"taskData.section"}}),a("material-info-select",{attrs:{options:t.materialList,"before-open":t.checkSectionIsAvailable,editabled:t.allowMaterial,title:"材料名称",grouping:"category_name","right-btn":t.allowCustomMaterialName?"手工添加":"","custom-type":"3"},on:{onSelect:t.onChangeMaterialName},model:{value:t.taskData.material,callback:function(e){t.$set(t.taskData,"material",e)},expression:"taskData.material"}}),t.taskData.material&&t.taskData.material.name?a("material-info-select",{ref:"selectMaterialType",attrs:{options:t.materialTypeList,"before-open":t.onCheckMaterialType,multi:!0,"standard-unit":t.taskData.material.quantity_unit,editabled:t.allowMaterial,"custom-type":"2",title:"材料类型","right-btn":t.allowCustomMaterialType?"手工添加":"",required:!1},on:{onSelect:t.onChangeMaterialType},model:{value:t.taskData.materialType,callback:function(e){t.$set(t.taskData,"materialType",e)},expression:"taskData.materialType"}}):t._e(),a("material-task-supplier",{attrs:{options:t.supplierOptions,"section-id":t.taskData.section&&t.taskData.section.id},model:{value:t.taskData.supplier,callback:function(e){t.$set(t.taskData,"supplier",e)},expression:"taskData.supplier"}}),t.allowUsingMaterialContract||t.taskData.contract&&t.taskData.contract.id?a("material-task-contract",{ref:"MaterialTaskContractRef",on:{onSelect:t.onSetMaterialTaskContract},model:{value:t.taskData.contract,callback:function(e){t.$set(t.taskData,"contract",e)},expression:"taskData.contract"}}):t._e(),a("item",{attrs:{label:"使用部位",border:"bottom",mode:"edit"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.taskData.place,expression:"taskData.place"}],staticClass:"input-align-r f16",attrs:{slot:"right",type:"text",placeholder:t.placeRequired?"必填":"选填"},domProps:{value:t.taskData.place},on:{input:function(e){e.target.composing||t.$set(t.taskData,"place",e.target.value)}},slot:"right"})]),a("item-textarea",{attrs:{"default-height":400,placeholder:"补充说明（选填）"},model:{value:t.taskData.remark,callback:function(e){t.$set(t.taskData,"remark",e)},expression:"taskData.remark"}}),a("div",{staticClass:"mt10"},[t._l(t.taskData.flowUsers,(function(e){return[a("user-select",{key:e.node_id,attrs:{title:e.name,options:t.userOptionsObj[e.type],editabled:t.allowPeople},model:{value:e.users,callback:function(a){t.$set(e,"users",a)},expression:"item.users"}}),1===e.node_id?a("single-select",{key:"contractor-"+e.node_id,attrs:{options:t.contractorOptions,"before-open":t.checkSectionIsAvailable,title:"接收单位"},model:{value:e.contractor,callback:function(a){t.$set(e,"contractor",a)},expression:"item.contractor"}}):t._e()]}))],2),a("div",{staticClass:"mt10"},[a("user-select",{attrs:{title:"抄送人",options:t.userOptionsObj.cc,multi:!0,required:!1,editabled:t.allowPeople},model:{value:t.taskData.cc,callback:function(e){t.$set(t.taskData,"cc",e)},expression:"taskData.cc"}}),t.allowIsNews?t._e():a("user-select",{attrs:{title:"创建人",editabled:!1},model:{value:t.taskData.creater,callback:function(e){t.$set(t.taskData,"creater",e)},expression:"taskData.creater"}})],1),a("app-button-group",{staticClass:"ctrl",attrs:{direction:"column"}},[t.allowIsNews?a("app-button",{on:{click:t.onSubmit}},[t._v("提交")]):a("app-button",{on:{click:t.onSaveTask}},[t._v("保存")])],1)],1)}),[],!1,null,null,null);e.a=r.exports},"299f":function(t,e,a){var i=a("8b97");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("692b574b",i,!0,{sourceMap:!1,shadowMode:!1})},"29be":function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e");var i=a("28f8"),n=(a("cc57"),a("163d"),a("07d2")),r=a("a5c6"),s=a("6144");function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"SingleSelect",components:{Item:n.default},props:{title:{type:String,default:""},border:{type:String,default:""},pageTitle:{type:String,default:""},placeholder:{type:String,default:""},value:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},optionsDisabled:{type:Array,default:function(){return[]}},required:{type:Boolean,default:!0},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},beforeOpen:{type:Function,default:function(){}},searchBar:{type:Boolean,default:!0},grouping:{type:String,default:""},autoOpen:{type:Boolean,default:!1},rightBtn:{type:String,default:""},rightBtnEvent:{type:Function,default:function(){return 0}},ifToggle:{type:Boolean,default:!1},formCheck:{type:Boolean,default:!1},editorAddData:{type:Boolean,default:!1},lineLimit:{type:[Number,String],default:1}},data:function(){return{memoryKey:this.$route.name+encodeURI(this.title)}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var e=this;if(this.editabled){var a=this.beforeOpen();a&&a.then&&t.isFunction(a.then)?a.then((function(t){!1!==t&&e.openPopup()})):!1!==a&&this.openPopup()}},openPopup:function(){var e=this;if(this.optionsDisabled&&this.optionsDisabled.length){var a={};t.each(this.optionsDisabled,(function(t){t.id&&(a[t.id]=t)})),t.each(this.options,(function(t,i){a[t.id]?e.options[i].disabled=!0:e.options[i].disabled=!1}))}r.a.openPopup({title:this.pageTitle||"选择"+this.title,selected:this.value,options:this.options,required:this.required,searchBar:this.searchBar,grouping:this.grouping,autoOpen:this.autoOpen,rightBtn:this.rightBtn,ifToggle:this.ifToggle,lineLimit:this.lineLimit,editorAddData:this.editorAddData,onSelect:function(a){var i=t.cloneDeep(e.value);a=t.isArray(a)?t.map(a,(function(t){return c({},t)})):c({},a),e.$emit("input",a,i),e.$emit("onSelect",a,i)},rightBtnEvent:function(a){var i=t.cloneDeep(e.value);e.$emit("rightBtnEvent",a,i)}})},closePopup:function(){r.a.closePopup()},onSelect:function(t){s.a.saveObject(this.memoryKey,t,s.a.level.user),this.$emit("input",t[0]),this.$emit("onSelect",t[0])},setSelected:function(){var e=s.a.getObject(this.memoryKey,s.a.level.user);!1===this.editabled||t.isEmpty(this.options)||(t.isEmpty(this.value)?this.memory&&!t.isEmpty(e)&&t.some(this.options,{id:e.id})&&(this.$emit("input",e),this.autoSelect&&this.$emit("onSelect",e)):this.autoSelect&&this.$emit("onSelect",this.value))}}}}).call(this,a("391c"))},"2b06":function(t,e,a){"use strict";(function(t){a("6a61");var i,n=a("2e91"),r=(a("6d57"),a("0287")),s={defaultDraft:Object(r.a)({key:function(t){return t=t||this.options,"".concat(r.a.keys.MATERIAL_V2,"_").concat(t.taskId)}}),createPrimaryKeys:function(t){return function(e){return e.primaryKeys=e.primaryKeys||{},e.primaryKeys.uuId===t.uuId}}},o=s.defaultDraft,c=null,l={},u={defaultMMKV:function(t){c=s.createPrimaryKeys(l={uuId:t})},setMMKVModel:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.primaryKeys=l,e.taskId=t,o.config({model:e,taskId:t,modelKeys:["primaryKeys","taskId","photo_requirements","remark","brands","approach_date","back_date","current_task_process_id","cc"]})},get:function(e){if(!l||t.keys(l).length)return u.setMMKVModel(e),o.get(c).then((function(t){return t||{}}))},set:(i=Object(n.a)(regeneratorRuntime.mark((function e(a,i){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l||t.keys(l).length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u.get(a);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:n=e.t0,i&&t.keys(i).length&&t.forIn(i,(function(t,e){n[e]=t})),u.setMMKVModel(a,n),o.save(c);case 11:case"end":return e.stop()}}),e)}))),function(t,e){return i.apply(this,arguments)}),remove:function(){o.remove(c)}};e.a=u}).call(this,a("391c"))},"2c76":function(t,e,a){"use strict";a("c070")},"2dd6":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .single-item[data-v-6920dde7]{min-height:44px}.zjapp .single-item>div[data-v-6920dde7]{display:flex}.zjapp .single-item>div>span[data-v-6920dde7]{flex:1;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical}.zjapp .single-item>div>span[data-v-6920dde7] label{color:#4174e9}.zjapp .single-item i[data-v-6920dde7]{line-height:24px;font-size:24px;color:#4275e8}.zjapp .single-item .disabled-item[data-v-6920dde7]{color:#aaa}",""])},"2ddb":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .supplier-editor[data-v-e465319c]{margin-bottom:10px;padding:8px;display:flex;justify-content:space-between;align-items:center;height:52px;color:#4275e8;background-color:#fff}.zjapp .supplier-editor .icon[data-v-e465319c]{border-left:1px solid #c8c8c8;padding-left:12px}.zjapp .supplier-editor .icon-edit[data-v-e465319c]{color:#c8c8c8;font-size:18px}.zjapp .supplier-editor .icon-qualified[data-v-e465319c]{color:#4275e8}.zjapp .supplier-editor .margin-r[data-v-e465319c]{margin-right:10px}.zjapp .list-title[data-v-e465319c]{position:relative;top:0;color:#888;font-size:14px;line-height:30px;min-height:40px;margin-bottom:0;margin-top:0;padding:8px 16px 2px}.zjapp .search-item>div[data-v-e465319c]{padding-right:35px}.zjapp .search-item i[data-v-e465319c]{position:absolute;color:#ccc;font-size:26px;right:0;top:50%;transform:translateY(-50%)}.zjapp .van-popup--right[data-v-e465319c]{width:100%;height:100%}[data-v-e465319c] .van-cell__title{color:#4174e9;font-weight:700}[data-v-e465319c] .van-collapse-item__content{transform:translateZ(0);padding:0 0 0 25px}[data-v-e465319c] .van-collapse-item__content .van-cell{padding-left:0}",""])},"2dea":function(t,e,a){var i=a("10d4");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("d2d2cc46",i,!0,{sourceMap:!1,shadowMode:!1})},"2f9d":function(t,e,a){"use strict";(function(t){var i=a("fc9f");e.a={getTemplateDirs:function(t){return i.a.query("select * from template_manage_dirs where parent_id = ? order by pinyin, name",[t])},getDirsAndCount:function(t,e){return i.a.query('select tmd.* ,                 (select count(1) from template_manage tm                     join template_manage_projs tmp on tmp.template_manage_id = tm.id                     where tmp.proj_id = ? and tm.code like tmd.code || ".%"                 ) as file_count                 from template_manage_dirs tmd where tmd.parent_id = ? order by pinyin, name',[t,e])},getTemplateList:function(t,e){return i.a.query("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and tm.template_manage_dir_id = ? order by tm.pinyin, tm.name ",[t,e])},updateDownloadTime:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s="replace into template_manage_local (id, download_time, name, url, local_download_time) values (?, ?, ?, ?, ?)";return i.a.executeSql(s,[t,e,a,n,r])},getMaterialTemplate:function(t,e){return i.a.queryOne("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and material_id = ? ",[t,e])},getProcessTemplate:function(t,e){return i.a.queryOne("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and tm.process_check_id = ? ",[t,e])},getRecord:function(t){return i.a.queryOne("select * from template_manage where id = ?",[t])},getLocal:function(t){return i.a.query("select * from template_manage_local")},delLocalByIds:function(e){t.isArray(e)||(e=[e]);var a="DELETE FROM template_manage_local WHERE id in ("+t.map(e,(function(t){return"'"+t+"'"})).join(", ")+")";return i.a.executeSql(a)}}}).call(this,a("391c"))},"302b":function(t,e,a){"use strict";a("8934")},"30c7":function(t,e,a){"use strict";a("69c5")},"3156b":function(t,e,a){"use strict";a("163d");var i={name:"SingleSelectItem",props:{item:{type:Object,default:function(){return{id:"",name:""}}},checked:{type:Boolean,default:!1},renderField:{type:String,default:"name"},lineLimit:{type:[Number,String],default:1}},methods:{selectItem:function(t){t.disabled||this.$emit("click",t)}}},n=(a("9788"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-cell",{staticClass:"single-item",attrs:{clickable:!0},on:{click:function(e){t.selectItem(t.item)}}},[a("span",{class:{"disabled-item":t.item.disabled},style:{"-webkit-line-clamp":"unlimited"===t.lineLimit?"initial":t.lineLimit},domProps:{innerHTML:t._s(t.item[t.renderField])}}),t.checked?a("van-icon",{attrs:{name:"success"}}):t._e()],1)}),[],!1,null,"6920dde7",null);e.a=r.exports},3186:function(t,e,a){var i=a("7073");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("5f05c55f",i,!0,{sourceMap:!1,shadowMode:!1})},3263:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .material-name[data-v-341e7465]{min-height:44px}.zjapp .wrap-scroll[data-v-341e7465]{padding-top:10px;padding-bottom:80px;display:flex;flex:1;flex-direction:column;height:100%;overflow:auto}.zjapp .txt[data-v-341e7465]{text-align:right}.zjapp .item-text[data-v-341e7465]{color:#666}.zjapp .brand-item[data-v-341e7465]{position:relative;margin-top:10px}.zjapp .brand-item>.item-icon-remove[data-v-341e7465]{left:14px}.zjapp .brand-item+.brand-item>span[data-v-341e7465] .item{padding-left:44px!important}.zjapp .add-btn[data-v-341e7465]{height:44px;line-height:44px;text-align:center;font-size:16px;background-color:#fff;color:#4275e8;border:none;background-image:linear-gradient(180deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0),linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px,100% 1px;background-repeat:no-repeat;background-position:top,bottom}.zjapp .mt10[data-v-341e7465]{margin-top:10px}.zjapp .alignL[data-v-341e7465]{text-align:left}.zjapp .photo-type[data-v-341e7465]{margin-top:7px;margin-bottom:15px;font-size:16px}.zjapp .photo-list[data-v-341e7465]{flex-direction:column;padding-bottom:15px;background-color:#fff}.zjapp .pic-list[data-v-341e7465]{padding:10px 0 10px 15px;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .brand-info-item[data-v-341e7465]{background:#fff;padding-left:45px;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .brand-info-item[data-v-341e7465] .item{padding-left:0}.zjapp .brand-info-item .brand-type[data-v-341e7465]{position:relative}.zjapp .item-icon-remove[data-v-341e7465]{position:absolute;display:inline-block;height:20px;width:20px;border-radius:30px;background-color:#ff3d3d;left:-30px;top:12px;z-index:1}.zjapp .item-icon-remove[data-v-341e7465]:before{content:" ";position:absolute;display:inline-block;width:13px;height:2px;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff}.zjapp .spec-item[data-v-341e7465]{position:relative;display:flex;min-height:44px;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .spec-item .item-text[data-v-341e7465]{line-height:36px}.zjapp .spec-item .align-r[data-v-341e7465]{position:relative;width:160px;padding-top:7px;padding-right:18px}.zjapp .spec-item .align-r[data-v-341e7465] .number-input{width:100%;padding-right:16px}.zjapp .spec-item .align-r[data-v-341e7465] .number-input input{text-align:right}.zjapp .spec-item .align-r .text[data-v-341e7465]{position:absolute;right:26px;top:14px}.zjapp .spec-item .align-r.unit_2[data-v-341e7465] .number-input{padding-right:30px}.zjapp .spec-item .align-r.unit_3[data-v-341e7465] .number-input{padding-right:42px}.zjapp .color-b2b2b2[data-v-341e7465]{color:#b2b2b2}',""])},3411:function(t,e,a){"use strict";a("ef1c")},3730:function(t,e,a){"use strict";var i=a("329b"),n=a("b65c").a,r=(a("50d5e"),a("17cc")),s=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{attrs:{title:t.title,mode:"dialog","on-close":t.closeEvent}},[t.rightBtn?a("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:function(e){t.checkBoxAliRight?t.submit():t.rightBtnEvent(t.category)}},slot:"header-bar-right"},[t._v(t._s(t.checkBoxAliRight?t.rightBtn+"("+t.realChecked.length+")":t.rightBtn))]):t._e(),a("scroller",{staticClass:"bg-white",attrs:{"has-next":!t.searchStatus&&!t.grouping&&t.optionsLimit<t.options.length,"end-text":"","is-empty":0===t.optionsShow.length},on:{loadNext:t.pageOptions}},[t.searchBar?a("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":t.storageKey},on:{changeSearchStatus:t.onSearchTypeChange,input:t.onInput},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):t._e(),t.showSelected&&(t.searchStatus&&t.isHasVal||!t.searchStatus)?a("div",[a("div",{staticClass:"multi-select-list-title"},[t._v("已选")]),a("div",{staticClass:"item"},[t._v(t._s(t.selectedNames||"请选择"))])]):t._e(),t.listTile&&(t.searchStatus&&t.isHasVal||!t.searchStatus)?a("div",{staticClass:"multi-select-list-title"},[t._v("全部")]):t._e(),t.searchStatus?[t.keyword?[t.grouping?a("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.searchData,(function(e,i){return a("van-collapse-item",{key:i,attrs:{title:e.name,name:i}},t._l(e.children,(function(e,i){return a("item",{key:i,attrs:{checked:!!t.checkedItem[e.id],item:e,"render-field":"rename"},on:{click:t.selectItem}})})))}))):t._l(t.searchData,(function(e,i){return a("item",{key:i,attrs:{checked:!!t.checkedItem[e.id],item:e,disabled:e.disabled,"render-field":"rename"},on:{click:t.selectItem}})}))]:t._e()]:[t.grouping?a("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.optionsShow,(function(e,i){return a("van-collapse-item",{key:i,attrs:{title:e.name,name:i}},[t._l(e.children,(function(e,i){return a("item",{key:i,attrs:{checked:!!t.checkedItem[e.id],item:e},on:{click:t.selectItem}})})),t._v("\n            "+t._s(e.id)+"\n          ")],2)}))):t._l(t.optionsShow,(function(e,i){return a("item",{key:i,attrs:{checked:!!t.checkedItem[e.id],item:e,"align-right":t.checkBoxAliRight,disabled:e.disabled},on:{click:t.selectItem}})})),t.optionsShow.length?t._e():a("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容",type:"search"}})]],2),t.checkBoxAliRight?t._e():a("app-button-group",{staticClass:"ctrl",attrs:{"fixed-bottom":""}},[a("app-button",{on:{click:t.submit}},[t._v("提交")])],1)],1):t._e()],1)}),[],!1,null,"89cd976c",null).exports,o=!1;o||(o=new(i.default.extend(s))({el:document.createElement("div")}),document.body.appendChild(o.$el));e.a=o},"3c64":function(t,e,a){"use strict";a("163d");var i={name:"ItemTextarea",components:{},props:{value:{type:String,default:""},placeholder:{type:String,default:""},maxlength:{type:Number,default:200},borderBottom:{type:Boolean,default:!0}},data:function(){return{textareaHeight:40,isLock:!1,blurTime:null}},computed:{lastLength:function(){var t=this.value&&this.value.length||0,e=this.maxlength-t;return e>0?e:0}},mounted:function(){var t=this;this.$nextTick((function(){t.textareaHeight=t.$refs.rule&&t.$refs.rule.offsetHeight||40}))},methods:{onfocus:function(){var t=(new Date).getTime();this.blurTime&&t-this.blurTime<300&&window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(this.$refs.input.blur(),window.cordova.plugins.Keyboard.close()),this.blurTime=null,this.$emit("focus")},onblur:function(){this.blurTime=(new Date).getTime(),this.$emit("blur")},setStatus:function(t){console.log(t),this.isLock=t},oninput:function(t){var e=this;setTimeout((function(){if(!e.isLock){var a=t.target.value;a.length>e.maxlength&&(a=a.substring(0,e.maxlength),e.$refs.input.value=a),e.$refs.rule.innerText=a,e.textareaHeight=e.$refs.rule&&e.$refs.rule.offsetHeight+20,e.$emit("input",a),e.$emit("change",a)}}),0)}}},n=(a("2c76"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item-textarea",class:{"border-bottom":t.borderBottom}},[a("div",{staticClass:"item-textarea-content"},[a("textarea",{ref:"input",style:{height:t.textareaHeight+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.value},on:{focus:t.onfocus,blur:t.onblur,compositionstart:function(e){t.setStatus(!0)},compositionend:function(e){t.setStatus(!1)},input:t.oninput}}),a("div",{ref:"rule",staticClass:"rule"},[t._v("\n      "+t._s(t.value)+"\n    ")]),t.maxlength!==1/0?a("p",{staticClass:"counter"},[t._v("\n      "+t._s(t.lastLength)+"\n    ")]):t._e()])])}),[],!1,null,null,null);e.a=r.exports},"3e47":function(t,e,a){"use strict";(function(t){a("e697"),a("9e76"),a("cc57"),a("6d57"),a("ed63"),a("8cf2");var i=a("fd50"),n=a("e2a7"),r=a("ed08"),s=a("4ad6"),o=a("3122"),c=a("162a"),l=a("a078"),u=a("2f9d"),d=a("4360"),p=a("a18c"),h=a("6bf2"),f=a.n(h),m=a("4daa"),g={},b=[],v={},k=[],y={_downloadTemplate:function(t,e,a){if(t in g)return y._checkQueue();var o=a,p=r.a.formatFiletypes(o),h=s.a.appDataPath()+"template",m=h+"/"+t+"."+p,b=i.a.defer(),k=g[t]=v[t]=v[t]||{progress:0},_=d.a.state.templateManage.support_bimface.includes(p);return _&&(m+=".zip"),k.promise=b.promise,$log.log("download url",o),$log.log("download localPath",m),c.a.startBackgroundTask(),c.a.canUpdate(!1).then((function(){return s.a.isFileExists(h)})).then((function(t){return t?s.a.isFileExists(m).then((function(t){if(t)return s.a.deleteFile(m)})):s.a.mkdir(h)})).then((function(){return k.progress=0,s.a.downloadFile(o,m).then((function(e){if($log.log("service ext",p),_){var a=h+"/"+t;return $log.log("localUnzipPath",a),s.a.isFileExists(a).then((function(t){if(t)return s.a.deleteFile(a)})).then((function(){return s.a.unzipFile(m,a).catch((function(){return i.a.reject("使用此功能请升级到最新版本")}))})).then((function(){return s.a.deleteFile(m)})).then((function(){return a}))}return e})).then((function(i){return b.resolve(i),k.download_time=k.upload_time,k.progress=-1,u.a.updateDownloadTime(t,k.upload_time,e,a,f()().format("YYYY-MM-DD HH:mm")).then((function(){return delete g[t],y._checkQueue()}))}),null,(function(t){k.progress=t,b.notify(t)}))})).catch((function(e){return k.progress=-1,e&&s.a.getAppFullVersion().then((function(t){t.fullVersion=t.fullVersion.slice(0,5),1===r.a.versionCompare("3.0.5",t.fullVersion)?n.a.popBoxExt({content:"使用此模块需更新APP到最新版",buttons:["取消","去更新"],cssClass:"popup-app-update",callback:function(t,e){switch(t){case 0:_btnSelected="cancel",$ionicBackdrop.release();break;case 1:$ionicBackdrop.release(),s.a.getDeviceInfo().then((function(t){var e="Android"===t.platform?l.a.appUpdate.Android:l.a.appUpdate.IOS;s.a.openUrlInBrowser(e)})),e.preventDefault(),_btnSelected="update"}}}):($log.error("下载错误: ",e),n.a.alert(e))})),delete g[t],b.reject(e),y._checkQueue()})).finally((function(){c.a.finishBackgroundTask()})),b.promise},downloadSingleTemplate:function(t,e,a){var o,l=a;if(t in g)return o=n.a.topProcess({title:$rootScope.isIPhoneFullScreen?"下载中":"正在下载文件...",successTitle:"下载完成"}),g[t].promise.then(null,null,(function(t){o.loading(t)})).finally((function(){o.close()}));var p=r.a.formatFiletypes(l),h=s.a.appDataPath()+"template",m=h+"/"+t+"."+p,b=g[t]=v[t]=v[t]||{},k=d.a.state.templateManage.support_bimface.includes(p);return k&&(m+=".zip"),b.progress=0,o=n.a.topProcess({title:$rootScope.isIPhoneFullScreen?"下载中":"正在下载文件...",successTitle:"下载完成"}),c.a.beginManualUpdate(),c.a.startBackgroundTask(),b.promise=c.a.canUpdate(!1).then((function(){return s.a.isFileExists(h)})).then((function(t){return t?s.a.isFileExists(m).then((function(t){if(t)return s.a.deleteFile(m)})):s.a.mkdir(h)})).then((function(){return s.a.downloadFile(l,m).then((function(e){if(k){var a=h+"/"+t;return s.a.isFileExists(a).then((function(t){if(t)return s.a.deleteFile(a)})).then((function(){return s.a.unzipFile(m,a)})).then((function(){return s.a.deleteFile(m)})).then((function(){return a}))}return e})).then((function(i){return b.download_time=b.upload_time,b.progress=-1,u.a.updateDownloadTime(t,b.upload_time,e,a,f()().format("YYYY-MM-DD HH:mm")).then((function(){delete g[t]}))}),null,(function(t){b.progress=t,o.loading(t)}))})).catch((function(e){return o.close(),b.progress=-1,delete g[t],e?($log.error("下载错误: ",e),i.a.reject(e)):i.a.reject("下载样板发生错误")})).finally((function(){o.close(),c.a.finishBackgroundTask(),c.a.endManualUpdate()}))},fetchBimfaceSupported:function(){var t="bimface_mime_type";return c.a.post("/setting/get-setting-value",null,{code:[t]}).then((function(e){try{return JSON.parse(e[t])}catch(t){return[]}}))},addDownloadQueue:function(t,e,a){if(!g[t]){b.push({id:t,name:e,url:a}),v[t]=v[t]||{progress:0},v[t].progress=0;var n=i.a.defer();return y._checkQueue().then(null,null,(function(t){return n.notify(t)})),n.promise}},_checkQueue:function(){if(!b.length)return c.a.endManualUpdate(),i.a.when();var e=t.keys(g).length;if(e>=3)return i.a.when();0===e&&c.a.beginManualUpdate();var a=i.a.defer(),n=b.shift(),r=n.id,s=n.name,o=n.url;return y._downloadTemplate(r,s,o).then((function(t){return a.resolve(t)}),null,(function(t){return a.notify(t)})),a.promise},getTemplateListCount:function(t,e){return i.a.all([u.a.getTemplateDirs(e),u.a.getTemplateList(t,e)]).then((function(t){return t[0].concat(t[1]).length}))},getTemplateList:function(e,a){return $log.log(e,"projId"),i.a.all([u.a.getDirsAndCount(e,a),u.a.getTemplateList(e,a)]).then((function(e){var a=e[0],i=e[1];return t.each(a,(function(t){t.file_type="folder",t.child_num=t.file_count})),t.each(i,(function(t){v[t.id]=v[t.id]||{progress:-1},v[t.id].download_time=t.download_time,v[t.id].upload_time=t.upload_time,t.downloadInfo=v[t.id],t.file_size=r.a.formatFilesize(t.file_size),t.file_type=t.url&&t.url.match(/[^\.]+$/)?t.url.match(/[^\.]+$/)[0]:"",t.child_num=1})),a.concat(i)}))},openTemplate:function(t,e,a){return new Promise((function(i,n){var c=r.a.formatFiletypes(a),l=d.a.state.templateManage.support_bimface.includes(c),u=s.a.appDataPath()+"template/"+t+"."+c;"pdf"===c||"docx"===c||"doc"===c||"xls"===c||"xlsx"===c||"ppt"===c||"pptx"===c?s.a.openPDF(u,e).then((function(t){i(t)})).catch((function(t){n(t)})):"jpg"===c||"jpeg"===c||"png"===c?s.a.openImageBrowser([o.a.fixUrl(u)],0).then((function(t){i(t)})).catch((function(t){n(t)})):l?(u=s.a.appDataPath()+"template/"+t,$log.log("localPath",u),$log.log("name",e),p.a.push({path:"/bimface",query:{mode:"view",layout:"fullScreen",url:u,name:e,ext:c}}),i()):n("未知的文件类型")}))},getMaterialTemplate:function(t,e){var a={projId:t,materialId:e};return Object(m.a)(a).then((function(t){var e=t&&t.length?t[0]:null;return e&&(v[e.id]=v[e.id]||{progress:-1},v[e.id].download_time=e.download_time,v[e.id].upload_time=e.upload_time,e.downloadInfo=v[e.id],e.file_size=r.a.formatFilesize(e.file_size)),e}))},getProcessTemplate:function(t,e){var a={projId:t,processId:e};return Object(m.b)(a).then((function(t){var e=t&&t.length?t[0]:null;return e&&(v[e.id]=v[e.id]||{progress:-1},v[e.id].download_time=e.download_time,v[e.id].upload_time=e.upload_time,e.downloadInfo=v[e.id],e.file_size=r.a.formatFilesize(e.file_size)),e}))},openDirs:function(t,e){return y.getTemplateList(t,e.id).then((function(a){var r=$rootScope.$new();r.listConllection=a||[],k.push(r),r.title=e.name,r.close=function(t){if(t)for(;k.length;)k.pop().modal.remove();else k.pop().modal.remove()},$ionicModal.fromTemplateUrl("templates/template-manage/template-list.html?v=20190415",{scope:r,animation:"slide-in-right"}).then((function(t){r.modal=t,r.modal.show()})),r.openDOC=function(){var e=this.item;if("folder"===e.file_type)return y.openDirs(t,e);e.downloadInfo.progress<0&&e.downloadInfo.download_time===e.downloadInfo.upload_time&&y.openTemplate(e.id).catch((function(t){n.a.alert(t)}))},r.uploadCallback=function(){y.getTemplateList(t,e.id).then((function(t){r.listConllection=t||[]}))},r.downloadTemplate=function(t,e,a){a&&a.stopPropagation();var n=this;i.a.when().then((function(){a.target.style.display="none"})).then((function(){n.item.downloadInfo.progress=0})).then((function(){setTimeout((function(){y.addDownloadQueue(t,e)}),10)}))}}))},_getTemplateList:function(e){var a=e.projId,n=e.parent_id,s=e.keywords,o=e.mtime_sort,l=e.name_sort;return i.a.all([c.a.post("/template-manage/list",{proj_id:a,parent_id:n,keywords:s,mtime_sort:o,name_sort:l}),y._getLocalTemplateList()]).then((function(e){var a=e[0].list.filter((function(t){return t.is_dir})),i=e[0].list.filter((function(t){return!t.is_dir})),n=e[1];return t.each(a,(function(t){t.file_type="folder",t.child_num=t.docs_num})),t.each(i,(function(t){v[t.id]=v[t.id]||{progress:-1};var e=n.find((function(e){return e.id===t.id}));v[t.id].download_time=e?e.download_time:"",v[t.id].upload_time=t.upload_time,t.downloadInfo=v[t.id],t.file_size=r.a.formatFilesize(t.file_size),t.file_type=r.a.formatFiletypes(t.url||t.name),t.child_num=1})),a.concat(i)}))},_getLocalTemplateList:function(){return u.a.getLocal().then((function(t){return t.filter((function(t){return t.name&&t.url}))}))},removeTemplate:function(t){return u.a.delLocalByIds(t)},getViewToken:function(t){return c.a.post("/template-manage/get-view-token",null,{id:t})},coverterBimface:function(t){return new Promise((function(e,a){var i=20;!function n(){if(i<=0)return void a("timeout");var r=function(){setTimeout((function(){i--,n()}),2e3)};c.a.request("/template-manage/offline-data-uri",{id:t}).then((function(t){t?e(t):r()})).catch((function(){r()}))}()}))}};e.a=y}).call(this,a("391c"))},"3f00":function(t,e,a){var i=a("a14f");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("eb0bf718",i,!0,{sourceMap:!1,shadowMode:!1})},"45dc":function(t,e,a){var i=a("624c");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("9f5f8384",i,!0,{sourceMap:!1,shadowMode:!1})},"46ae":function(t,e,a){"use strict";var i=a("e1e7").a,n=a("17cc"),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("item",{attrs:{label:t.title,text:t.text,mode:t.mode,editabled:t.editabled,placeholder:t.placeholder},on:{click:t.openSelect}},[t.$slots.right?t._t("right",null,{slot:"right"}):t._e()],2)}),[],!1,null,null,null);e.a=r.exports},"4daa":function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"a",(function(){return o}));var i=a("5e8d"),n=a("162a"),r=a("da71");function s(t){return Object(i.a)().then((function(){var e=r.a.processTemplate.url;return n.a.request(e,t)}))}function o(t){return Object(i.a)().then((function(){var e=r.a.materialTemplate.url;return n.a.request(e,t)}))}},"4e01":function(t,e,a){var i=a("7440");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("24bcf62e",i,!0,{sourceMap:!1,shadowMode:!1})},"4e8c":function(t,e,a){"use strict";var i=a("329b"),n=a("b056").a,r=(a("30c7"),a("17cc")),s=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePopup(e)}}},[a("transition",{attrs:{name:"slide-up"},on:{enter:function(e){t.isOpening=!0},"after-enter":function(e){t.isOpening=!1},leave:function(e){t.isClosing=!0},"after-leave":t.afterClose}},[t.showList?a("div",{staticClass:"box",style:{height:t.listHeight+"px"}},[t.allowSearching?t._e():a("div",{staticClass:"hd border-bottom"},[t._v("\n        "+t._s(t.title)+"\n        "),a("icon",{attrs:{name:"unqualified"},on:{click:t.closePopup}})],1),t.allowSearch?a("app-search-bar",{ref:"app-search-bar-checkitem-select",staticClass:"bg-white",attrs:{"history-key":t.historyKey},on:{changeSearchStatus:t.setSearchMode},model:{value:t.searchKeyword,callback:function(e){t.searchKeyword=e},expression:"searchKeyword"}}):t._e(),t.renderData&&t.renderData.length?a("scroller",{ref:"scroller",attrs:{"has-next":t.hasNextPage},on:{loadNext:t.loadNext}},[a("div",{attrs:{id:"slideUpSelectDialog"}},t._l(t.renderData,(function(e){return a("item",{key:e.id,attrs:{"icon-right":e.id===t.selected.id?"qualified":"",border:"bottom"},on:{click:function(a){t.select(e)}}},[t.showNote?[a("div",{staticClass:"item-con"},[a("p",{staticClass:"text"},[t._v(t._s(e.name))]),a("p",{staticClass:"note"},[t._v(t._s(e[t.showNote]))])])]:a("div",{staticClass:"item-text",domProps:{innerHTML:t._s(t.keywordFilter(e.name))}})],2)})))]):t._e(),a("loading-status",{attrs:{"is-empty":!t.options||!t.options.length,type:"search","empty-text":t.emptyText}},[t.allowSearching&&t.allowSearch?a("template",{slot:"empty-text"},[t._v("\n          未搜索到包含"),a("span",{staticClass:"color-blue"},[t._v(t._s(t.searchKeyword))]),t._v("的结果\n        ")]):t._e()],2)],1):t._e()])],1):t._e()}),[],!1,null,"c4404120",null).exports,o=!1;o||(o=new(i.default.extend(s))({el:document.createElement("div")}),document.body.appendChild(o.$el));e.a=o},"50d5e":function(t,e,a){"use strict";a("2dea")},"50e0":function(t,e,a){"use strict";(function(t){a("6a61");var i,n,r,s,o,c=a("2e91"),l=a("2286"),u=a("f369"),d=a("7460"),p=a("2904"),h=a("b4c6"),f=a("6a2a"),m=a("521d"),g=a("e46c"),b=a("a317"),v=a("71b1");e.a={name:"MaterialV2Detail",components:{CheckGuide:u.a,TemplateGuide:d.a,TaskEdit:p.a,TaskDetail:h.a,ApproachEdit:f.a,ApproachDetail:m.a,BackEdit:g.a,BackDetail:b.a},data:function(){return{isLoading:!1,isSupervision:!1,isShowTamplate:!1,proj_id:"",tabs:[],curTabIndex:1,defaultTabIndex:1,taskInfos:{},taskDetails:{},taskMode:null,viewSize:$rootScope.viewSize,approachLoading:!1,approachEmpty:!1,approachMode:null,backMode:null,backData:{},backDetails:{}}},computed:{task_id:function(){return this.$route.params.id}},created:function(){console.log("退场-详情-created===>"),this.init()},activated:function(){console.log("退场-详情-activated===>"),this.init()},deactivated:function(){this.setDefaultData()},methods:{init:(o=Object(c.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getBaseData();case 2:return t.next=4,this.getTaskDetails();case 4:return t.next=6,this.getTabs();case 6:return t.next=8,this.getTabMode();case 8:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),setDefaultData:function(){this.taskMode=null,this.approachMode=null,this.backMode=null},getBaseData:(s=Object(c.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.getCurrentUserProjectRoles();case 2:this.isSupervision=t.sent;case 3:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)}),getTaskDetails:(r=Object(c.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.getTaskBaseInfo(this.task_id);case 2:return this.taskInfos=t.sent,t.next=5,v.a.getTaskDetails(this.task_id);case 5:return this.taskDetails=t.sent,this.proj_id=this.taskDetails.proj_id,t.next=9,this.getPermissions();case 9:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)}),getPermissions:(n=Object(c.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.getCurrentUserOperation(this.task_id);case 2:a=e.sent,this.approachEmpty=Boolean("待申请进场"===this.taskInfos.status&&t.isEmpty(a));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),getTabs:function(){console.log("this.taskInfos",this.taskInfos),this.tabs=v.a.getTabs(this.taskInfos.status),this.curTabIndex=this.tabs.length-1,this.defaultTabIndex=this.tabs.length-1},getTabMode:function(){var t=this.taskInfos.status;switch(console.log("status",t),t){case"待申请进场":this.taskMode=l.f,this.approachMode=l.a;break;case"已验收":this.taskMode=l.f,this.approachMode=l.f;break;case"待退场":this.taskMode=l.f,this.approachMode=l.f,this.backMode=l.a;break;case"已退场":this.taskMode=l.f,this.approachMode=l.f,this.backMode=l.f}},getTemplateStatus:function(t){this.isShowTamplate=t},onChangeTab:function(t){this.curTabIndex=t,t&&(this.taskMode=l.f)},onChangeTabName:function(t){this.curTabIndex=t,this.$refs.materialTabContent.swipeTo(t)},onEditTask:function(){this.taskMode=l.a},onSaveTask:function(){this.taskMode=l.f,this.getTaskDetails()},onCheckApproach:(i=Object(c.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.approachMode=l.f,t.next=3,this.getTaskDetails();case 3:if("back"!==e){t.next=7;break}return this.backMode=l.a,t.next=7,this.getTabs();case 7:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)}),onSubmitBack:function(){this.backMode=l.f,this.getTaskDetails()}}}}).call(this,a("391c"))},"515e":function(t,e,a){"use strict";var i=a("329b"),n=a("f1e4").a,r=(a("302b"),a("17cc")),s=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{class:{"content-not-empty":t.content.length},attrs:{mode:"dialog",title:"检查指引","on-close":t.closePopup}},[!t.isLoading&&t.title?a("div",{staticClass:"check-guide-detail-hd border-bottom"},[a("h2",{staticClass:"check-guide-detail-title pb10"},[t._v(t._s(t.title))])]):t._e(),!t.isLoading&&t.content.length?a("div",{staticClass:"check-guide-detail-content"},t._l(t.content,(function(e,i){return a("span",{key:i},[e.isImg&&e.src?a("p",[a("img",{class:{"img-not-ready":!e.ready,error:"rejected"===e.status},attrs:{src:t.getThumbnail(e)},on:{error:function(a){t.imgError(e,i)},click:function(a){t.imgClick(e)}}})]):t._e(),e.isHref&&e.url?a("span",{staticClass:"href-text",on:{click:function(a){t.openHref(e.url)}}},[t._v("\n          "+t._s(e.val)+"\n        ")]):a("span",[t._v("\n          "+t._s(e.val)+"\n        ")]),e.joinBrToSplitLine?a("br"):t._e()])}))):t._e(),a("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.content.length,"empty-text":"PC端未设置检查指引"}})],1):t._e()],1)}),[],!1,null,"092cce02",null).exports,o=!1;o||(o=new(i.default.extend(s))({el:document.createElement("div")}),document.body.appendChild(o.$el));e.a=o},"521d":function(t,e,a){"use strict";a("6a61");var i,n,r=a("2e91"),s=a("07d2"),o=a("3c64"),c=a("774b"),l=a("cd05"),u=a("6948"),d=a("7a80"),p=a("5ba8"),h={name:"MaterialV2ApproachBrandView",components:{NumberInput:u.a,MaterialInfoSelect:d.a},props:{brands:{type:Array,default:function(){return[]}},standardUnit:{type:String,default:""},allowSupplyOrderEdit:{type:Boolean,default:!1}},computed:{},deactivated:function(){},methods:{}},f=(a("7394"),a("17cc")),m=Object(f.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"brand-info"},t._l(t.brands,(function(e,i){return a("div",{key:"brand"+i},[a("div",{staticClass:"brand-name"},[t._v(t._s(e.name))]),t._l(e.standard,(function(e,i){return a("div",{key:"standard"+i},[a("div",{staticClass:"brand-type",class:{"brand-supply":t.allowSupplyOrderEdit}},[a("div",{staticClass:"flex one-line label"},[t._v(t._s(e.name))]),e.specification&&e.specification.length?t._e():[t.allowSupplyOrderEdit?a("div",{staticClass:"item-ele align-r",class:e.quantity_unit?"unit_"+e.quantity_unit.length:"unit_"+t.standardUnit.length},[a("number-input",{staticClass:"color-theme",attrs:{type:"positive",decimal:3,"overflow-auto-recover":!1,range:[0,999999.999]},model:{value:e.num,callback:function(a){t.$set(e,"num",a)},expression:"item.num"}}),a("span",{staticClass:"text"},[t._v(t._s(e.quantity_unit||t.standardUnit))])],1):a("div",{staticClass:"quantity"},[t._v("\n            "+t._s(e.num+(e.quantity_unit||t.standardUnit))+"\n          ")])]],2),e.specification&&e.specification.length?t._l(e.specification,(function(i,n){return a("div",{key:"specification"+n},[a("div",{staticClass:"brand-spec",class:{"brand-supply":t.allowSupplyOrderEdit}},[a("div",{staticClass:"label"},[t._v(t._s(i.name))]),t.allowSupplyOrderEdit?a("div",{staticClass:"item-ele align-r",class:e.quantity_unit?"unit_"+e.quantity_unit.length:"unit_"+t.standardUnit.length},[a("number-input",{staticClass:"color-theme",attrs:{type:"positive",decimal:3,"overflow-auto-recover":!1,range:[0,999999.999]},model:{value:i.num,callback:function(e){t.$set(i,"num",e)},expression:"spec.num"}}),a("span",{staticClass:"text"},[t._v(t._s(e.quantity_unit||t.standardUnit))])],1):a("div",{staticClass:"quantity"},[t._v("\n              "+t._s(i.num+(e.quantity_unit||t.standardUnit))+"\n            ")])])])})):t._e()],2)}))],2)})))}),[],!1,null,"74612de7",null).exports,g=a("924c"),b=(a("6bf2"),a("5e1b"),{name:"MaterialV2ApproachDetail",components:{Item:s.default,ItemTextarea:o.a,Scroller:c.default,UserSelect:l.a,ApproachBrandView:m,MaterialPhotoType:g.a},props:{taskId:{type:String,default:""},taskInfo:{type:Object,default:function(){}}},data:function(){return{isLoading:!1,viewSize:$rootScope.viewSize,brands:[],receiverImg:[],processDetails:[]}},computed:{},created:function(){console.log("进场-详情-created===>"),this.init()},activated:function(){console.log("进场-详情-activated===>"),this.init()},deactivated:function(){},methods:{init:(n=Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getApproachDetails();case 2:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),getApproachDetails:(i=Object(r.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoading=!0,this.taskId,e=this.taskInfo.status,t.next=5,p.a.getBrands(this.taskId,e);case 5:return this.brands=t.sent,t.next=8,p.a.getPhotoDetails(this.taskId);case 8:return this.receiverImg=t.sent,t.next=11,p.a.getProcessDetails(this.taskId);case 11:this.processDetails=t.sent,console.log("this.brands",this.brands),this.isLoading=!1;case 14:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})}}),v=Object(f.a)(b,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content",style:{height:t.viewSize.contentHeight-40+"px"}},[t.isLoading?t._e():a("scroller",{ref:"scroller"},[[a("approach-brand-view",{attrs:{brands:t.brands,"standard-unit":t.taskInfo.quantity_unit}}),a("item",{staticClass:"mt10",attrs:{label:"进场时间",text:t.taskInfo.entry_date}}),t._l(t.processDetails,(function(e){return a("div",{key:e.id,staticClass:"mt10"},[a("material-photo-type",{attrs:{mode:"view"},model:{value:e.photoRequirement,callback:function(a){t.$set(e,"photoRequirement",a)},expression:"item.photoRequirement"}}),e.remark?a("item",{attrs:{label:"补充说明",text:e.remark}}):t._e(),a("user-select",{attrs:{title:"接收人",mode:"view",editabled:!1},model:{value:e.user,callback:function(a){t.$set(e,"user",a)},expression:"item.user"}}),a("item",{attrs:{label:"提交时间",text:t._f("formatDate")(e.created_on||"")}})],1)}))]],2),t.isLoading?a("loading-status",{attrs:{"is-loading":t.isLoading}}):t._e()],1)}),[],!1,null,"22b9b3b5",null);e.a=v.exports},"53bf":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .single-item[data-v-b3cb8602]{min-height:44px}.zjapp .single-item .checkbox[data-v-b3cb8602]{font-size:14px;color:transparent;text-align:center;line-height:inherit;width:20px;height:20px;box-sizing:border-box;border:1px solid #dcdcdc;transition:.2s;border-radius:100%;display:inline-block;vertical-align:middle}.zjapp .single-item .checkbox i[data-v-b3cb8602]{display:none}.zjapp .single-item .checkbox.checked[data-v-b3cb8602]{color:#fff;border-color:#1989fa;background-color:#1989fa}.zjapp .single-item .checkbox.checked i[data-v-b3cb8602]{display:inline-block}.zjapp .single-item .checkbox.disabled[data-v-b3cb8602]{border-color:#b2b2b2}.zjapp .single-item .checkboxtxt[data-v-b3cb8602]{flex:1;margin-left:8px}.zjapp .single-item .disabled-text[data-v-b3cb8602]{color:#b2b2b2}.zjapp .wrapper[data-v-b3cb8602]{display:flex;align-items:center}",""])},"574c":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .item-textarea{background-color:#fff;padding:5px 15px}.zjapp .item-textarea-content{position:relative}.zjapp .item-textarea .rule,.zjapp .item-textarea textarea{width:100%;min-height:40px;line-height:20px;font-size:16px;padding:0;border:none}.zjapp .item-textarea .rule{position:absolute;top:0;left:0;visibility:hidden;word-break:break-all}.zjapp .item-textarea .counter{text-align:right;margin:0 0 -5px 0;height:15px;line-height:15px;color:#b2b2b2;font-size:12px}",""])},"5a71":function(t,e,a){"use strict";a.r(e);var i=a("29be").a,n=a("17cc"),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("item",{class:t.required,attrs:{label:t.title,text:t.value&&t.value.id?t.value.name:"view"===t.mode?"无":"",mode:t.mode,editabled:t.editabled,placeholder:t.required?t.placeholder||"请选择":"选填","form-check":t.formCheck,border:t.border},on:{click:t.openSelect}})}),[],!1,null,null,null);e.default=r.exports},"5ba8":function(t,e,a){"use strict";(function(t){a("2b45"),a("fc58"),a("6d57"),a("cc57");var i=a("0e4d"),n=a("94ef"),r=a("76ff"),s=a("4b67"),o=a("d703"),c=a("fd50"),l=a("7cb8"),u=a("e3c6"),d=a("9ba8"),p=a("613e"),h=a("9bcb");function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,i=Object(o.a)(t);if(e){var n=Object(o.a)(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return Object(s.a)(this,a)}}var m=new(function(e){Object(r.a)(s,e);var a=f(s);function s(){var t;return Object(i.a)(this,s),(t=a.call(this)).state={},t}return Object(n.a)(s,[{key:"getSpecificationList",value:function(t){return d.a.getMaterialSpecifications(t)}},{key:"getBrandsList",value:function(e,a){var i=[];return d.a.getMaterialBrands(e).then((function(e){return t.each(e,(function(t){i.push({id:t.id,name:t.name})})),t.each(a,(function(e){if(/^custom\-[\d]+$/.test(e.id)){if(t.some(i,{id:e.id}))return;i.push({id:e.id,name:e.name})}})),i}))}},{key:"getBrands",value:function(e,a){var i=this;return h.a.getTaskDetails(e).then((function(e){var n=[],r={},s=t.uniqBy(e,(function(t){return t.brand_id+t.material_type_id+(t.specification_id||"")}));if("待申请进场"===a){var o=t.difference(t.map(e,"id"),t.map(s,"id"));t.isEmpty(o)||h.a.deleteTaskDetailById(o)}return e=t.groupBy(s,"brand_name"),t.each(e,(function(e){r={brand_id:e[0].brand_id,brand_name:e[0].brand_name,material_types:[]};var a=t.groupBy(e,"material_type_name");t.each(a,(function(t){var e=t[0],a={detailId:e.id,material_type_id:e.material_type_id,material_type_name:e.material_type_name,quantity_unit:e.quantity_unit||"",quantity:e.quantity,inspection_num:e.inspection_num,retest_num:e.retest_num};(t.length>1||e.specification_name)&&(a.specifications=t),r.material_types.push(a)})),r.quantity_unit=r.material_types[0].quantity_unit,n.push(r)})),i.formatbrands(n,"quantity")}))}},{key:"formatbrands",value:function(e,a){var i,n=[];return t.each(e,(function(e){i=[],t.each(e.material_types,(function(e){var n={id:e.material_type_id,name:e.material_type_name,quantity_unit:e.quantity_unit,detailId:e.detailId,data:{id:e.material_type_id,name:e.material_type_name},num:isNaN(e[a])?"":e[a]};e.specifications&&(n.specification=t.map(e.specifications,(function(t){return{id:t.specification_id,name:t.specification_name,num:isNaN(t[a])?"":t[a],detailId:t.id}}))),i.push(n)})),n.push({id:e.brand_id,name:e.brand_name,standard:i})})),n}},{key:"getPhotoList",value:function(e,a){return this.getPhotoRequirement(e,a).then((function(e){return t.forEach(e,(function(t){t.image_file=t.image_file||[]})),e})).catch((function(t){console.log("err",t)}))}},{key:"checkParams",value:function(e){var a=e.approach_date,i=e.brands,n=e.photoList;e.remark,e.task_id;if("待申请进场"!==e.task_info.status)return Promise.reject("任务状态异常");if(t.some(i,(function(t){return!t.id})))return Promise.reject("请选择品牌");if(t.some(i,(function(e){return t.some(e.standard,(function(t){return!t.id}))})))return Promise.reject("请选择类型");var r=[];if(t.each(i,(function(e){r=r.concat(t.map(e.standard,"id"))})),t.some(i,(function(e){return t.some(e.standard,(function(t){return t.specificationList&&t.specificationList.length&&(!t.specification||!t.specification.length)}))})))return Promise.reject("请选择规格");if(t.some(i,(function(e){return t.some(e.standard,(function(e){return e.specification&&e.specification.length?t.some(e.specification,(function(t){return void 0===t.num||null===t.num||""===t.num})):void 0===e.num||null===e.num||""===e.num}))})))return Promise.reject("请添加所有的数量");if(t.isEmpty(i))return Promise.reject("请选择品牌和类型");var s=!0,o="";if(t.each(i,(function(e){return e.name?t.isEmpty(e.standard)?(s=!1,o="请选择类型",!1):void t.each(e.standard,(function(t){if(!t.name)return s=!1,o="请选择类型",!1;if(t.specification&&t.specification.length)for(var e=0;e<t.specification.length;e++){var a=t.specification[e];/^\d+(?=\.{0,1}\d+$|$)/.test(a.num)?a.name||(s=!1,o="请输入规格名称",$log.log("材料验收规格数量异常")):(s=!1,o="请输入正确的规格数量",$log.log("材料验收规格数量异常"))}else if(!/^\d+(?=\.{0,1}\d+$|$)/.test(t.num)||t.num<0)return s=!1,o="请填写正确的数量",!1})):(s=!1,o="请选择品牌",!1)})),!s)return Promise.reject(o);if(!a)return Promise.reject("请选择进场时间");var c=!0;if(t.each(n,(function(e){t.isEmpty(e.image_file)&&(c=!1)})),!c)return Promise.reject("请按要求拍照");t.each(i,(function(e){/^custom\-[\d]+$/.test(e.id)&&(e.id=""),t.each(e.standard,(function(e){/^custom\-[\d]+$/.test(e.id)&&(e.id=""),t.each(e.specification||[],(function(t){/^custom\-[\d]+$/.test(t.id)&&(t.id="")}))}))}))}},{key:"formatCheckbrands",value:function(e){var a=[];return t.forEach(e,(function(e){e.is_manual=e.id?0:1;var i=[];e.standard&&e.standard.length&&t.forEach(e.standard,(function(e){var a={id:e.id,name:e.name,quantity_unit:e.quantity_unit,is_manual:e.id?0:1};if(e.specification&&e.specification.length){var n=[];t.forEach(e.specification,(function(t){n.push({id:t.id,name:t.name,quantity:t.num,quantity_unit:e.quantity_unit,is_manual:t.id?0:1})})),a.specification=n}else a.quantity=e.num;i.push(a)})),a.push({id:e.id,name:e.name,is_manual:e.is_manual,material_type:i})})),a}},{key:"setCheckParams",value:function(e){var a=e.approach_date,i=e.brands,n=e.photoList,r=e.remark,s=e.task_id,o=e.task_info,c=e.task_cc;if(!this.checkParams(e))return{};var u=[];t.forEach(n,(function(t){u.push({id:t.id,image_file:Object(l.o)(t.image_file)})}));var d=this.formatCheckbrands(i);return{task_id:s,occurrence_date:a,remark:r,task_download_time:o.download_time,photo_requirements:u,brands:d,log_image_file:u[0]&&u[0].image_file,task_cc:c}}},{key:"receiverSubmit",value:function(e){var a=this,i=e.approach_date,n=e.brands,r=e.photoList,s=e.remark,o=e.task_id,u=e.task_info,d=e.task_cc,h=this.checkParams(e);if(h)return h;var f=[],m=[];return t.forEach(r,(function(t){m.push(a.uploadImages(t.image_file).then((function(e){f.push({id:t.id,image_file:Object(l.o)(e)})})))})),c.a.all(m).then((function(){var t=a.formatCheckbrands(n),r={task_id:o,occurrence_date:i,remark:s,task_download_time:u.download_time,photo_requirements:f,brands:t,log_image_file:f[0]&&f[0].image_file,task_cc:d};return Object(p.d)({data:Object(l.o)(r)},e.task_id)}))}},{key:"receiverBack",value:function(e){var a=this,i=e.approach_date,n=e.brands,r=e.photoList,s=e.remark,o=e.task_id,u=e.task_info,d=e.task_cc,h=this.checkParams(e);if(h)return h;var f=[],m=[];return t.forEach(r,(function(t){m.push(a.uploadImages(t.image_file).then((function(e){f.push({id:t.id,image_file:Object(l.o)(e)})})))})),c.a.all(m).then((function(){var t=a.formatCheckbrands(n),r={task_id:o,occurrence_date:i,remark:s,task_download_time:u.download_time,photo_requirements:f,brands:t,log_image_file:f[0]&&f[0].image_file,task_cc:d};return Object(p.f)({data:Object(l.o)(r)},e.task_id)}))}}]),s}(u.a));e.a=m}).call(this,a("391c"))},"5e1b":function(t,e,a){"use strict";var i=a("329b"),n=(a("6d57"),a("e10e"),a("6bf2")),r=a.n(n);var s={name:"DatepickerDialog",components:{},mixins:[a("e89f").a],props:{},data:function(){return{show:!1,isLoading:!0,today:"",currentYear:"",currentMonth:"",currentDate:"",yearsList:[],monthsList:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],weeksList:["日","一","二","三","四","五","六"],showYearSelect:!1,showMonthSelect:!1,dayList:[]}},methods:{openPopup:function(t){this.value=!0,this.show=!0,this.from=t.from,this.to=t.to,this.inputDate=r()(t.inputDate).isValid()?r()(r()(t.inputDate).format("YYYY-MM-DD")):r()(r()().format("YYYY-MM-DD")),this.callback=t.callback,this.today=r()(r()().format("YYYY-MM-DD")).valueOf(),this.from?this.fromDate=r()(r()(this.from).format("YYYY-MM-DD")).valueOf():this.fromDate=0,this.to?this.toDate=r()(r()(this.to).format("YYYY-MM-DD")).valueOf():this.toDate=1/0,this.selctedDateEpoch=r()(r()(this.inputDate).format("YYYY-MM-DD")).valueOf(),this.refreshDateList(this.inputDate),this.$emit("open")},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeSelectList:function(){this.showYearSelect=!1,this.showMonthSelect=!1},prevMonth:function(){this.currentDate=r()(this.currentDate).subtract(1,"month"),this.currentMonth=this.monthsList[this.currentDate.month()],this.currentYear=this.currentDate.year(),this.refreshDateList(this.currentDate)},nextMonth:function(){this.currentDate=r()(this.currentDate).add(1,"month"),this.currentMonth=this.monthsList[this.currentDate.month()],this.currentYear=this.currentDate.year(),this.refreshDateList(this.currentDate)},selectYear:function(){this.showYearSelect=!this.showYearSelect,this.showMonthSelect=!1},setYear:function(t){this.currentYear=t,this.yearChanged(t),this.showYearSelect=!1},selectMonth:function(){this.showYearSelect=!1,this.showMonthSelect=!this.showMonthSelect},setMonth:function(t){this.currentMonth=t,this.monthChanged(t),this.showMonthSelect=!1},dateSelected:function(t){t&&0!==Object.keys(t).length&&(this.selctedDateEpoch=t.epoch,this.callback(this.selctedDateEpoch),this.closePopup())},monthChanged:function(t){var e=this.monthsList.indexOf(t);this.currentDate.month(e),this.refreshDateList(this.currentDate)},yearChanged:function(t){this.currentDate.year(t),this.refreshDateList(this.currentDate)},refreshDateList:function(t){var e=[];this.isLoading=!0,t=r()(r()(t).format("YYYY-MM-DD")),this.currentDate=t,this.currentYear="",this.currentMonth="";var a,i,n=this.currentDate.daysInMonth();this.yearsList=function(t,e){var a=[],i=2015,n=2100;i=t?r()(t).year():i,n=e?r()(e).year():n;for(var s=i;s<=n;s++)a.push(s);return a}(),this.dayList=[];var s=r()(this.currentDate).startOf("month").day();this.firstDayEpoch=r()(this.currentDate).startOf("month").valueOf(),this.lastDayEpoch=r()(this.currentDate).endOf("month").startOf("day").valueOf();for(var o=1;o<=n;o++)i=(a=r()(this.currentDate).date(o)).valueOf()<this.fromDate||a.valueOf()>this.toDate,e.push({date:a.date(),month:a.month(),year:a.year(),day:a.day(),epoch:a.valueOf(),disabled:i}),this.dayList=e;for(var c=0;c<s;c++)this.dayList.unshift({});this.rows=[0,7,14,21,28,35],this.cols=[0,1,2,3,4,5,6],this.currentMonth=this.monthsList[t.month()],this.currentYear=this.currentDate.year(),this.numColumns=7,this.isLoading=!1}}},o=(a("80d8"),a("17cc")),c=Object(o.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{attrs:{mode:"dialog",title:"选择日期","on-close":t.closePopup},on:{click:function(e){t.closeSelectList()}}},[t.isLoading?t._e():a("div",{staticClass:"datepicker-hd"},[a("div",{class:{"datepicker-prev":!0,disabled:t.firstDayEpoch-864e5<t.fromDate},on:{click:t.prevMonth}},[a("icon",{attrs:{name:"arrow-left"}})],1),a("div",{staticClass:"datepicker-hd-center"},[a("div",{staticClass:"datepicker-year",on:{click:function(e){return e.stopPropagation(),t.selectYear(e)}}},[t._v("\n          "+t._s(t.currentYear)+"\n\n          "),a("transition",{attrs:{name:"spread"}},[t.showYearSelect?a("div",{staticClass:"select-list",on:{click:function(t){t.stopPropagation()}}},t._l(t.yearsList,(function(e,i){return a("div",{key:i,class:{"select-item":!0,"item-selected":t.currentYear===e},on:{click:function(a){t.setYear(e)}}},[t._v("\n                "+t._s(e)+"\n              ")])}))):t._e()])],1),a("div",{staticClass:"datepicker-month",on:{click:function(e){e.stopPropagation(),t.selectMonth()}}},[t._v("\n          "+t._s(t.currentMonth)+"\n          "),a("transition",{attrs:{name:"spread"}},[t.showMonthSelect?a("div",{staticClass:"select-list",on:{click:function(t){t.stopPropagation()}}},t._l(t.monthsList,(function(e,i){return a("div",{key:i,class:{"select-item":!0,"item-selected":t.currentMonth===e},on:{click:function(a){t.setMonth(e)}}},[t._v("\n                "+t._s(e)+"\n              ")])}))):t._e()])],1)]),a("div",{class:{"datepicker-next":!0,disabled:t.lastDayEpoch+864e5>t.toDate},on:{click:t.nextMonth}},[a("icon",{attrs:{name:"arrow-right"}})],1)]),t.isLoading?t._e():a("div",{staticClass:"calendar"},[a("div",{staticClass:"weeks-row"},t._l(t.weeksList,(function(e,i){return a("div",{key:i,staticClass:"weeks-cell"},[t._v("\n          "+t._s(e)+"\n        ")])}))),t._l(t.rows,(function(e,i){return a("div",{key:i,staticClass:"date-row"},t._l(t.cols,(function(i,n){return a("div",{key:n,staticClass:"date-cell",class:{"date-cell-selected":t.dayList[e+i]&&t.dayList[e+i].epoch===t.selctedDateEpoch,today:t.dayList[e+i]&&t.dayList[e+i].epoch===t.today,disabled:t.dayList[e+i]&&t.dayList[e+i].disabled},on:{click:function(a){t.dateSelected(t.dayList[e+i])}}},[t._v("\n          "+t._s(t.dayList[e+i]&&t.dayList[e+i].date)+"\n        ")])})))}))],2)]):t._e()],1)}),[],!1,null,"0a266c44",null).exports,l=!1;l||(l=new(i.default.extend(c))({el:document.createElement("div")}),document.body.appendChild(l.$el));e.a=l},"602d":function(t,e,a){var i=a("3263");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("faa0ce62",i,!0,{sourceMap:!1,shadowMode:!1})},"613e":function(t,e,a){"use strict";(function(t){a.d(e,"a",(function(){return h})),a.d(e,"b",(function(){return f})),a.d(e,"g",(function(){return m})),a.d(e,"c",(function(){return g})),a.d(e,"d",(function(){return b})),a.d(e,"f",(function(){return v})),a.d(e,"e",(function(){return k}));a("6a61");var i,n=a("2e91"),r=a("e2a7"),s=a("5e8d"),o=a("da71"),c=a("e3c6"),l=a("162a"),u=a("48f4"),d=new c.a,p={updateMaterialData:(i=Object(n.a)(regeneratorRuntime.mark((function e(a,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=3;break}return e.next=3,d.deleteLocalData(a);case 3:if(t.isEmpty(i)){e.next=7;break}return e.next=6,d.insertRemoteData(i);case 6:u.default.setLocalChanged();case 7:case"end":return e.stop()}}),e)}))),function(t,e){return i.apply(this,arguments)}),popup:function(t){t&&t.errmsg&&r.a.alert(t.errmsg)}};function h(t){return Object(s.a)().then((function(){var e=o.a.getProcessConfig.url;return l.a.request(e,t)}))}function f(t){return Object(s.a)().then((function(){var e=o.a.createTask.url;return l.a.post(e,null,t).then(function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.updateMaterialData("",e);case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).catch((function(t){if(-1===t.errcode)return Promise.reject("请在有网络的环境下新建任务")}))}function m(e,a){return Object(s.a)().then((function(){var i=o.a.updateTask.url;return l.a.post(i,null,e).then((function(t){return p.updateMaterialData(a,t)})).catch((function(e){if(p.popup(e),e&&!t.isEmpty(e.data))return p.updateMaterialData(a,e.data)}))}))}function g(t){return Object(s.a)().then((function(){var e=o.a.deleteTask.url;return l.a.post(e,null,t)}))}function b(e,a){return Object(s.a)().then((function(){var i=o.a.recipientQualified.url;return l.a.post(i,null,e).then((function(t){return p.updateMaterialData(a,t)})).catch((function(e){if(p.popup(e),e&&!t.isEmpty(e.data))return p.updateMaterialData(a,e.data)}))}))}function v(e,a){return Object(s.a)().then((function(){var i=o.a.recipientUnqualified.url;return l.a.post(i,null,e).then((function(t){return p.updateMaterialData(a,t)})).catch((function(e){if(p.popup(e),e&&!t.isEmpty(e.data))return p.updateMaterialData(a,e.data)}))}))}function k(e,a){return Object(s.a)().then((function(){var i=o.a.recipientSendback.url;return l.a.post(i,null,e).then((function(t){return p.updateMaterialData(a,t)})).catch((function(e){if(p.popup(e),e&&!t.isEmpty(e.data))return p.updateMaterialData(a,e.data)}))}))}}).call(this,a("391c"))},"624c":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .task-void-dialog[data-v-918e1df2] .van-dialog__content{height:140px;padding:32px 20px}.zjapp .task-void-dialog .text-area-border[data-v-918e1df2]{border:1px solid #eee;border-bottom:null}",""])},6272:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .number-input[data-v-74068386]{position:relative;display:inline-block;vertical-align:top;width:61px;height:30px;border:1px solid #e5e5e5;border-radius:3px;text-align:center;font-size:14px;color:#333}@media screen and (min-width:320px){.zjapp .number-input[data-v-74068386]{width:50px}}@media screen and (min-width:360px){.zjapp .number-input[data-v-74068386]{width:58px}}@media screen and (min-width:375px){.zjapp .number-input[data-v-74068386]{width:61px}}.zjapp .text[data-v-74068386]{position:relative;display:inline-block;vertical-align:top;width:100%;height:100%;line-height:28px;overflow:hidden}.zjapp .text.disabled[data-v-74068386]{background:#f5f5f5;color:#666}.zjapp .value[data-v-74068386]{position:absolute;top:50%;right:0;margin-top:-14px;min-width:100%;height:28px;color:inherit}.zjapp .placeholder[data-v-74068386],.zjapp .value[data-v-74068386]{line-height:28px;pointer-events:none}.zjapp .placeholder[data-v-74068386]{display:inline-block;vertical-align:top;width:100%;height:100%;color:#b2b2b2}.zjapp .icon-minus[data-v-74068386]{position:absolute;top:-9px;right:-9px;width:18px;height:18px;border-radius:9px;background-color:#ff4546}.zjapp .icon-minus[data-v-74068386]:before{content:"";position:absolute;left:4px;top:8px;width:10px;height:2px;background-color:#fff}.zjapp .icon-minus[data-v-74068386]:after{content:"";position:absolute;left:-5px;top:-5px;width:28px;height:28px;border-radius:9px}.zjapp .number-input-select-all .value-handle[data-v-74068386]{background-color:#cbdaf9}.zjapp .number-input.unqualified[data-v-74068386]{border:1px solid #ffe8e8;background-color:#fff3f3;color:#ff5050}.zjapp .number-input.qualified .text[data-v-74068386]{color:#333}.zjapp .number-input.number-input-focus[data-v-74068386]{border-color:#4275e8;box-shadow:0 0 8px 0 rgba(66,117,232,.37)}.zjapp .number-input.number-input-empty[data-v-74068386]{border-color:#ff3d3d;box-shadow:0 0 8px 0 rgba(255,59,48,.37)}',""])},6481:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content-not-empty[data-v-092cce02] .layout-content{display:auto;overflow:auto;padding-bottom:100px}.zjapp .check-guide-detail-hd[data-v-092cce02]{margin-left:30px;padding:25px 30px 5px 0}.zjapp .check-guide-detail-title[data-v-092cce02]{margin:0;line-height:20px;font-size:18px;color:#111;font-weight:700;word-break:break-all}.zjapp .check-guide-detail-info[data-v-092cce02]{line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .check-guide-detail-content[data-v-092cce02]{padding:30px;line-height:30px;color:#333;font-size:16px}.zjapp .check-guide-detail-content p[data-v-092cce02]{margin-bottom:30px;min-height:1em}.zjapp .check-guide-detail-content img[data-v-092cce02]{max-width:100%}.zjapp .check-guide-detail-content .img-not-ready[data-v-092cce02]{width:80px;height:auto}.zjapp .check-guide-detail-content .href-text[data-v-092cce02]{text-decoration:underline;color:#4275e8}.zjapp .error[data-v-092cce02]{max-width:50%}",""])},"64ce":function(t,e,a){"use strict";(function(t){a("f548"),a("163d"),a("e697"),a("6a61");var i,n,r,s,o,c,l,u=a("2e91"),d=a("2286"),p=a("07d2"),h=a("3c64"),f=a("cd05"),m=a("5a71"),g=a("7a80"),b=a("fee3"),v=a("f711"),k=a("f5bd"),y=a("3bd5"),_=a("e2a7"),x=a("e320");e.a={name:"MaterialV2TaskEdit",components:{Item:p.default,ItemTextarea:h.a,UserSelect:f.a,SingleSelect:m.default,MaterialInfoSelect:g.a,MaterialTaskSupplier:b.a,MaterialTaskVoidDialog:v.a,MaterialTaskContract:k.a},props:{status:{type:String,default:"add"},taskId:{type:String,default:""},taskDetails:{type:Object,default:function(){}}},data:function(){return{allowSection:!0,allowMaterial:!0,allowPeople:!0,allowIsNews:!0,allowSupplyOrder:!1,allowSupplyOrderTaskVoide:!1,sectionOptions:[],materialList:[],materialTypeList:[],supplierOptions:[],contractorOptions:[],userOptionsObj:{},taskData:{section:{},material:{},materialType:[],supplier:{},place:"",remark:"",contract:{},cc:{},receiver:{},flowUsers:[]},supplierData:{},showSupplier:!1,allowCustomMaterialName:!1,allowCustomMaterialType:!1,allowUsingMaterialContract:!1}},computed:{proj_id:function(){return this.$route.query.projId||this.taskData.proj_id},placeRequired:function(){return x.a.getPlaceRequired()},statusComputed:function(){var t=this.$route.query.status;return t||(t=this.status),t},statusData:function(){return d.e[this.statusComputed]||{}},curUserData:function(){var t=y.a.getUser();return{id:t.user_id,name:t.user_name}}},watch:{},created:function(){this.taskId&&this.init()},activated:function(){this.init()},methods:{init:function(){this.getPermissions(),this.getInitBaseData(),this.taskId?(this.setTaskData(),this.setEditPermissions(),this.getSupplierOptions(),this.getContractorOptions()):(this.setEditPermissions(),this.resetDefaultData())},resetDefaultData:function(){this.taskData={section:{},material:{},materialType:[],supplier:{},place:"",remark:"",contract:{},cc:{},receiver:{},flowUsers:[]}},setTaskData:function(){this.taskData=this.taskDetails},setEditPermissions:function(){var t=this.statusData,e=(t.allowSection,t.allowMaterial),a=(t.allowPeople,t.allowIsConstructerBtn),i=t.allowIsNews,n=t.allowSupplyOrderTaskVoide,r=this.taskData.status&&"待申请进场"===this.taskData.status;this.allowSection=r,this.allowMaterial=e,this.allowPeople=r,this.allowIsConstructerBtn=a,this.allowIsNews=i,this.allowSupplyOrderTaskVoide=n},getPermissions:(l=Object(u.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.a.isAllowCustomMaterial("MATERIAL_NAME");case 2:return this.allowCustomMaterialName=t.sent,t.next=5,x.a.isAllowCustomMaterial("MATERIAL_TYPE");case 5:this.allowCustomMaterialType=t.sent,this.allowUsingMaterialContract=this.$store.state.global.allGrayRelease.UsingMaterialContract;case 7:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)}),getInitBaseData:(c=Object(u.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.a.getSectionList(this.proj_id);case 2:return this.sectionOptions=t.sent,t.next=5,x.a.getUserOptions(this.proj_id);case 5:this.userOptionsObj=t.sent;case 6:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)}),checkSectionIsAvailable:function(){if(!this.taskData.section||!this.taskData.section.id||t.isEmpty(this.contractorOptions))return _.a.alert("请先选择标段"),!1},onChangeSection:(o=Object(u.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.taskData.section&&this.taskData.section.id,!this.allowIsNews){t.next=7;break}return this.$set(this.taskData,"material",{}),this.$set(this.taskData,"supplier",{}),t.next=6,x.a.getSectionMaterial(e);case 6:this.materialList=t.sent;case 7:this.getSupplierOptions(),this.getContractorOptions();case 9:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),getSupplierOptions:(s=Object(u.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.taskData.section&&this.taskData.section.id,t.next=3,x.a.selectMaterialSupplier(e,this.taskData.supplier);case 3:this.supplierOptions=t.sent;case 4:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)}),getContractorOptions:(r=Object(u.a)(regeneratorRuntime.mark((function t(e){var a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e||this.curUserData.id,i=this.taskData.section&&this.taskData.section.id,t.next=4,x.a.getContractorOptions(a,i);case 4:this.contractorOptions=t.sent;case 5:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)}),getFlowUsers:(n=Object(u.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.a.getFlowUsers(e);case 2:this.taskData.flowUsers=t.sent;case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)}),onChangeMaterialName:(i=Object(u.a)(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.taskData.section&&this.taskData.section.id,a=this.taskData.material&&this.taskData.material.id,t.next=3,x.a.getSectionTypeList(e,a);case 3:this.materialTypeList=t.sent,this.taskData.materialType=null,this.getFlowUsers(a);case 6:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)}),onCheckMaterialType:function(){var e=this.taskData.section,a=this.taskData.material;return t.isEmpty(e)?(_.a.alert("请先选择标段"),!1):t.isEmpty(a)?(_.a.alert("请先选择材料名称"),!1):void 0},onChangeMaterialType:function(t){},onSetMaterialTaskContract:function(t){this.$set(this.taskData,"contract",t)},onSubmit:function(){var e=this;return x.a.submitTask(this.taskData,this.proj_id).then((function(a){var i=(e.taskData.flowUsers&&e.taskData.flowUsers.length?e.taskData.flowUsers:[]).find((function(t){return 1===Number(t.node_id)&&t.users&&t.users.id===e.curUserData.id}));if(t.isEmpty(i))e.$router.back();else if(a.material_task&&a.material_task.length){var n=a.material_task[0].id;e.$router.replace({name:"MaterialV2Detail",params:{id:n}},!1)}})).catch((function(t){_.a.alert(t)}))},onSaveTask:function(){var t=this;return x.a.saveTask(this.taskId,this.taskData,this.proj_id).then((function(){_.a.alert("保存成功"),t.$emit("onSave")})).catch((function(e){_.a.alert(e.errmsg),t.$emit("onSave")}))}}}}).call(this,a("391c"))},6948:function(t,e,a){"use strict";a("2b45"),a("163d");var i=a("329b"),n=a("8c3d").a,r=(a("b55a"),a("17cc")),s=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-up"},on:{leave:t.startClose,afterLeave:t.onClose}},[t.show?a("div",{staticClass:"number-keyboard-con",class:{"ios-bezel-less":t.isIOSBezelLess},style:{"z-index":t.zIndex},on:{touchstart:t.keyTouchstart,touchend:t.keyTouchend}},["true-or-false"===t.type?[a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"row-span-3 keys-row"},[a("div",{staticClass:"keys col color-green",attrs:{direct:"setTure"}},[a("icon",{attrs:{name:"qualified"}}),t._v("\n            合格\n          ")],1),a("div",{staticClass:"keys col color-red",attrs:{direct:"setFalse"}},[a("icon",{attrs:{name:"unqualified"}}),t._v("\n            不合格\n          ")],1)]),a("div",{staticClass:"row-span-1"},[a("div",{staticClass:"keys-row"},[a("div",{staticClass:"keys keys-ok",attrs:{direct:"closeKeyboard"}},[a("icon",{attrs:{name:"keyboard-close"}})],1)]),a("div",{staticClass:"keys-row"},[a("div",{staticClass:"keys keys-delete",attrs:{direct:"delete"}},[a("icon",{attrs:{name:"keyboard-delete"}})],1)])])]),a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys keys-prev",class:{disabled:!t.hasPrev},attrs:{direct:"prev"}},[t._v("\n          上一项\n        ")]),a("div",{staticClass:"keys keys-next",class:{disabled:!t.hasNext},attrs:{direct:"next"}},[t._v("\n          下一项\n        ")])])]:[a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys",attrs:{direct:"1"}},[t._v("1")]),a("div",{staticClass:"keys",attrs:{direct:"2"}},[t._v("2")]),a("div",{staticClass:"keys",attrs:{direct:"3"}},[t._v("3")]),a("div",{staticClass:"keys keys-ok",attrs:{direct:"closeKeyboard"}},[a("icon",{attrs:{name:"keyboard-close"}})],1)]),a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys",attrs:{direct:"4"}},[t._v("4")]),a("div",{staticClass:"keys",attrs:{direct:"5"}},[t._v("5")]),a("div",{staticClass:"keys",attrs:{direct:"6"}},[t._v("6")]),a("div",{staticClass:"keys keys-delete",attrs:{direct:"delete"}},[a("icon",{attrs:{name:"keyboard-delete"}})],1)]),a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys",attrs:{direct:"7"}},[t._v("7")]),a("div",{staticClass:"keys",attrs:{direct:"8"}},[t._v("8")]),a("div",{staticClass:"keys",attrs:{direct:"9"}},[t._v("9")]),a("div",{staticClass:"keys keys-prev",class:{disabled:!t.hasPrev},attrs:{direct:"prev"}},[t._v("\n          上一项\n        ")])]),a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys",class:{disabled:t.isDisabledMinus},attrs:{direct:"-"}},[t._v("-")]),a("div",{staticClass:"keys",attrs:{direct:"0"}},[t._v("0")]),a("div",{staticClass:"keys",class:{disabled:t.isDisabledPoint},attrs:{direct:"."}},[t._v(".")]),a("div",{staticClass:"keys keys-next",class:{disabled:!t.hasNext},attrs:{direct:"next"}},[t._v("\n          下一项\n        ")])])]],2):t._e()])}),[],!1,null,"6337f428",null).exports,o=!1;o||(o=new(i.default.extend(s))({el:document.createElement("div")}),document.body.appendChild(o.$el));var c=o,l=a("6f9e"),u=a("4360"),d={name:"NumberInput",props:{value:{type:[String,Number]},type:{type:String,default:"all"},decimal:{type:Number,default:2},placeholder:{type:String,default:""},nextEvent:{type:Function},range:{type:Array,default:function(){return[]}},overflowAutoRecover:{type:Boolean,default:!1},required:{type:Boolean},emptyAutoRecover:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},isSetEmptyTip:{type:Boolean,default:!1}},data:function(){return{rawValue:"",isFocusing:!1,isSelectAll:!1,keyboardHeight:u.a.state.app.isIOSBezelLess?266:"true-or-false"===this.type?176:232}},computed:{min:function(){return isNaN(this.range[0])?-1/0:parseFloat(this.range[0])},max:function(){return isNaN(this.range[1])?1/0:parseFloat(this.range[1])}},created:function(){l.a.$on("numberInputBlur",this.setBlur),l.a.$on("numberKeyboardClose",this.setBlur)},beforeDestroy:function(){this.isFocusing&&c.closeKeyboard()},destroyed:function(){l.a.$off("numberInputBlur",this.setBlur),l.a.$off("numberKeyboardClose",this.setBlur)},methods:{hasVal:function(t){return null!=t&&""!==t},openKeyboard:function(){this.disabled||(this.isFocusing?this.isSelectAll=!1:(l.a.$emit("numberInputBlur"),this.setFocus(),c.openKeyboard({inputComponent:this})))},setFocus:function(){this.isFocusing=!0,"true-or-false"!==this.type&&(this.isSelectAll=!0),this.rawValue=this.value,c.$on("keyboardInput",this.input),c.$on("keyboardAssign",this.assign),c.$on("keyboardDelete",this.deleteValue),c.$on("keyboardClear",this.clear),this.$emit("focus")},setBlur:function(){if(this.isFocusing){var t=this.checkValue();this.isFocusing=!1,this.isSelectAll=!1,c.$off("keyboardInput",this.input),c.$off("keyboardAssign",this.assign),c.$off("keyboardDelete",this.deleteValue),c.$off("keyboardClear",this.clear),this.$emit("input",t),this.$emit("blur",t),this.$nextTick((function(){c.calcTab()}))}},input:function(t){var e=this.hasVal(this.value)?this.value.toString():"",a="";this.isSelectAll?(a=t,this.isSelectAll=!1):a=e+t,console.log("newValue =====",a),this.$emit("input",a),c.setKeysStatus(a,this.type)},assign:function(t){this.isSelectAll=!1,this.$emit("input",t),c.setKeysStatus(t,this.type)},deleteValue:function(){var t=this.hasVal(this.value)?this.value.toString():"",e="";this.hasVal(t)&&(e=this.isSelectAll?"":t.substr(0,t.length-1)),this.$emit("input",e),c.setKeysStatus(e,this.type)},clear:function(){this.$emit("input",""),c.setKeysStatus("",this.type)},checkValue:function(){var t=this.hasVal(this.value)?this.value.toString():"";"-"===t&&(t=""),"."===t.substr(-1)&&(t=t.substr(0,t.length-1));var e=t.indexOf(".");return e>0&&(t=parseFloat(t.substring(0,e+this.decimal+1))),t=parseFloat(t),isNaN(t)?this.required&&this.emptyAutoRecover?(t=this.rawValue,this.$emit("onEmpty")):t="":(t<this.min&&(t=this.overflowAutoRecover?this.rawValue:this.min,this.$emit("overflowRange")),t>this.max&&(t=this.overflowAutoRecover?this.rawValue:this.max,this.$emit("overflowRange"))),t}}},p=(a("6abe"),Object(r.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"number-input component-number-input",class:{"number-input-focus":t.isFocusing,"number-input-empty":t.isSetEmptyTip&&!t.value&&!t.isFocusing,"number-input-select-all":t.isSelectAll,qualified:"true-or-false"===t.type&&1===t.value,unqualified:"true-or-false"===t.type&&0===t.value}},[a("div",{staticClass:"text",class:{disabled:t.disabled},on:{click:function(e){return e.stopPropagation(),t.openKeyboard(e)}}},[t.hasVal(t.value)?a("span",{staticClass:"value"},[a("span",{staticClass:"value-handle"},[t._v(t._s("true-or-false"===t.type?1===t.value?"合格":"不合格":t.value))])]):a("span",{staticClass:"placeholder"},[t._v("\n      "+t._s(t.placeholder)+"\n    ")])]),t._t("extend")],2)}),[],!1,null,"74068386",null));e.a=p.exports},"69c5":function(t,e,a){var i=a("7d2b");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("172b2e44",i,!0,{sourceMap:!1,shadowMode:!1})},"6a2a":function(t,e,a){"use strict";var i=a("bee0").a,n=(a("f44c"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content",style:{height:t.viewSize.contentHeight-40+"px"}},[t.isLoading?t._e():a("scroller",{ref:"scroller"},[a("item",{staticClass:"material-name",attrs:{label:"材料名称",mode:"edit"}},[a("div",{staticClass:"item-text txt",attrs:{slot:"right"},slot:"right"},[t._v(t._s(t.taskInfo.material_name))])]),a("approach-brand",{attrs:{"brands-options":t.brandsOptions,"standard-unit":t.taskInfo.quantity_unit,"material-type-list":t.materialTypeList,"allow-custom-brand":t.allowCustomBrand,"allow-custom-type":t.allowCustomType,"allow-custom-spec":t.allowCustomSpec,"is-submit-data":t.isSubmitData},on:{onSave:t.onSave},model:{value:t.brands,callback:function(e){t.brands=e},expression:"brands"}}),a("div",{staticClass:"mt10"},[a("item",{attrs:{mode:"edit",label:"进场时间",editabled:!0,text:t.approach_date},on:{click:t.selectApproachDate}}),a("material-photo-type",{on:{onSave:t.onSave},model:{value:t.receiverImg,callback:function(e){t.receiverImg=e},expression:"receiverImg"}}),a("item-textarea",{staticClass:"border-tb mt10",attrs:{placeholder:"补充说明"},on:{blur:function(e){t.onSave({remark:t.remark})}},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}}),a("user-select",{attrs:{options:t.ccOptions,title:"抄送人",multi:!0,editabled:t.isSupervision,required:!1},on:{onSelect:function(){return t.onSave({cc:t.taskInfo.cc})}},model:{value:t.taskInfo.cc,callback:function(e){t.$set(t.taskInfo,"cc",e)},expression:"taskInfo.cc"}}),a("app-button-group",{attrs:{direction:"column"}},[a("app-button",{on:{click:t.onSubmit}},[t._v(" 合格验收 ")]),a("app-button",{attrs:{type:"warning",plain:"",rimless:""},on:{click:t.onBack}},[t._v(" 不合格退场 ")])],1)],1)],1),t.isLoading?a("loading-status",{attrs:{"is-loading":t.isLoading}}):t._e()],1)}),[],!1,null,"50dd32ab",null);e.a=r.exports},"6abe":function(t,e,a){"use strict";a("bebe")},7073:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,"[data-v-738adc7a] .item-img-list,[data-v-738adc7a] .item-img-list li,[data-v-738adc7a] .photo-list{transform:translateZ(0)}.zjapp .photo-type[data-v-738adc7a]{margin-top:7px;margin-bottom:15px;font-size:16px}.zjapp .photo-list[data-v-738adc7a]{flex-direction:column;padding-bottom:15px;background-color:#fff}.zjapp .pic-list[data-v-738adc7a]{padding:10px 0 10px 15px;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .photo-type-desc[data-v-738adc7a]{font-size:14px;background-color:#f0f0f0;padding:10px;color:#666;border-radius:3px}",""])},"71b1":function(t,e,a){"use strict";(function(t){a("2b45"),a("fc58"),a("163d"),a("6a61");var i=a("2e91"),n=(a("6d57"),a("0e4d")),r=a("94ef"),s=a("76ff"),o=a("4b67"),c=a("d703"),l=a("2286"),u=a("7cb8"),d=a("6bf2"),p=a.n(d),h=a("e3c6"),f=a("9bcb"),m=a("15f5");function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,i=Object(c.a)(t);if(e){var n=Object(c.a)(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return Object(o.a)(this,a)}}var b=new(function(e){Object(s.a)(c,e);var a,o=g(c);function c(){var t;return Object(n.a)(this,c),(t=o.call(this)).state={},t}return Object(r.a)(c,[{key:"getTabs",value:function(t){return"待申请进场"===t||"待验收"===t||"已验收"===t?[l.d.TASK,l.d.APPROACH]:"待退场"===t||"已退场"===t?[l.d.TASK,l.d.APPROACH,l.d.BACK]:void 0}},{key:"getProcess",value:function(e,a){return m.a.getProcess(e).then((function(n){return t.forEach(n,function(){var t=Object(i.a)(regeneratorRuntime.mark((function t(i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.getProcessUser(e,i.id);case 2:i.users=t.sent,i.contractor=a,i.node_id=Number(i.node_id),i.type=l.c[i.node_id];case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n}))}},{key:"getTaskBaseInfo",value:function(e){var a=this;return m.a.getTaskInfo(e).then(function(){var t=Object(i.a)(regeneratorRuntime.mark((function t(i){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:i.recipient_unit,name:i.recipient_unit_name},t.next=3,a.getProcess(e,n);case 3:return i.flowUsers=t.sent,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).then((function(i){return a.getTaskCcList(e,"被抄送").then((function(e){return i.cc=t.map(e,(function(t){return{id:t.cc,name:t.cc_name,mobile:t.cc_mobile,is_im_user:t.is_im_user}})),i}))}))}},{key:"getTaskDetails",value:function(t){return this.getTaskBaseInfo(t).then((function(t){var e={task_id:t.id,proj_id:t.proj_id,material:{id:t.material_id,name:t.material_name,quantity_unit:t.quantity_unit},defaultMaterialId:t.material_id,place:t.used_part,supplier:{name:t.supplier,id:"-1"},contractor:{id:t.recipient_unit,name:t.recipient_unit_name},created_by:t.created_by,creater:{id:t.created_by,name:t.created_by_name},flowUsers:t.flowUsers,isReceiver:!1,cc:t.cc,section:{id:t.section_id,name:t.section_name},needConstructer:!!t.constructer,created_on:t.created_on,remark:t.remark,sync:t.allow_task_accept_together,contract:{id:t.contract_id,name:t.contract_name},status:t.status,download_time:t.download_time};return t.processUsers&&t.processUsers.length&&(e.isReceiver=!0),t.material_type_list?e.materialType=JSON.parse(t.material_type_list):e.materialType=[],e}))}},{key:"getTaskLogByStatus",value:function(t,e,a,i){return f.a.getTaskByStatus(t,e,a,i)}},{key:"getBackData",value:(a=Object(i.a)(regeneratorRuntime.mark((function t(e,a){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getAllList(a);case 2:return i=t.sent,t.abrupt("return",this.getTaskBaseInfo(e).then((function(t){return{id:"",taskId:e,status:t.status,date:p()().format("YYYY-MM-DD"),image_file:[],remark:"",created_by:t.created_by,cc:[],backUser:{id:t.created_by,name:t.created_by_name},back_date:t.created_on,userOptions:i,ccOptions:i,download_time:t.download_time}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"getBackDetails",value:function(t){return this.getTaskLogByStatus(t,"","已退场").then((function(e){return console.log("data=-=-=-=-=-=-=-=-=-=-=->",e),{id:e.id,taskId:t,status:e.status,date:e.occurrence_date,image_file:Object(u.f)(e.image_file),remark:e.remark,cc:Object(u.f)(e.cc),backUser:{id:e.supervisor,name:e.supervisor_name,mobile:e.supervisor_mobile,is_im_user:e.supervisor_im},created_by:e.created_by}}))}}]),c}(h.a));e.a=b}).call(this,a("391c"))},7204:function(t,e,a){var i=a("eb78");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("5640fad0",i,!0,{sourceMap:!1,shadowMode:!1})},7394:function(t,e,a){"use strict";a("4e01")},7440:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .brand-info[data-v-74612de7]{background-color:#fff;padding:15px 15px 0 15px;font-size:16px;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0)}.zjapp .brand-info[data-v-74612de7],.zjapp .brand-name[data-v-74612de7]{border:none;background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .brand-name[data-v-74612de7]{color:#4275e8;padding-bottom:10px;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 50%,transparent 0)}.zjapp .brand-type[data-v-74612de7]{color:#333;padding:10px 0 10px 10px}.zjapp .brand-spec[data-v-74612de7],.zjapp .brand-type[data-v-74612de7]{display:flex;justify-content:space-between}.zjapp .brand-spec[data-v-74612de7]{padding:10px 0 10px 30px}.zjapp .brand-spec .quantity[data-v-74612de7],.zjapp .brand-type .quantity[data-v-74612de7]{white-space:nowrap;margin-left:10px}.zjapp .brand-supply .label[data-v-74612de7]{padding-top:6px;max-width:calc(100% - 142px)}.zjapp .brand-supply .item-text[data-v-74612de7]{line-height:36px}.zjapp .brand-supply .align-r[data-v-74612de7]{position:relative;width:142px}.zjapp .brand-supply .align-r[data-v-74612de7] .number-input{width:100%;padding-right:25px}.zjapp .brand-supply .align-r[data-v-74612de7] .number-input input{text-align:right}.zjapp .brand-supply .align-r .text[data-v-74612de7]{position:absolute;right:11px;top:8px}.zjapp .brand-supply .align-r.unit_2[data-v-74612de7] .number-input{padding-right:40px}.zjapp .brand-supply .align-r.unit_3[data-v-74612de7] .number-input{padding-right:55px}",""])},7460:function(t,e,a){"use strict";a("cc57");var i=a("e2a7"),n=a("ed08"),r=a("3e47"),s={name:"TemplateGuide",components:{Converting:a("e8e4").a},props:{projId:{type:String,default:""},module:{type:String,default:""},connectId:{type:String,default:""}},data:function(){return{templateData:null,inConverting:!1}},watch:{connectId:function(t){this.init()}},activated:function(){this.init()},methods:{init:function(){var t=this,e=this.connectId;return e?Promise.resolve().then((function(){return"process"===t.module?r.a.getProcessTemplate(t.projId,e):"material"===t.module?r.a.getMaterialTemplate(t.projId,e):void 0})).then((function(a){e===t.connectId&&(t.templateData=a,t.$emit("queryHasTemplate",!!a))})).catch((function(e){t.templateData=null,t.$emit("queryHasTemplate",!1),console.error(e)})):Promise.resolve()},downloadTemplate:function(){var t=this.templateData.url,e=n.a.formatFiletypes(t);"dwg"!==e&&"rvt"!==e?this.openTemplateGuide():this.handleCovertingAndDownload()},handleCovertingAndDownload:function(){var t=this,e=this.templateData.id;this.inConverting=!0,r.a.coverterBimface(e).then((function(e){t.templateData.url=e,$log.log("converting url",e),t.inConverting=!1,t.openTemplateGuide()})).catch((function(){t.inConverting=!1,$log.log("转换失败")}))},openTemplateGuide:function(){var t=this;return Promise.resolve().then((function(){var e=t.templateData.downloadInfo;if(!e.download_time||e.upload_time>e.download_time)return r.a.downloadSingleTemplate(t.templateData.id,t.templateData.name,t.templateData.url)})).then((function(){return r.a.openTemplate(t.templateData.id,t.templateData.name,t.templateData.url).catch((function(t){i.a.alert(t)}))})).catch((function(t){i.a.alert(t)}))}}},o=(a("d81a"),a("17cc")),c=Object(o.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.templateData?a("div",{staticClass:"header-btn",on:{click:function(e){t.downloadTemplate()}}},[t.inConverting?a("converting",{staticClass:"cover"}):t._e(),t.inConverting?t._e():a("span",[t._v("样板")])],1):t._e()}),[],!1,null,"02a5f460",null);e.a=c.exports},"7a80":function(t,e,a){"use strict";var i=a("ab83").a,n=(a("cbc1"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t.multi?a("multi-select",{ref:"multiSelectDialog",attrs:{options:t.options,title:t.title,"right-btn":t.rightBtn,editabled:t.editabled},on:{onSelect:t.onHandleSelect,rightBtnEvent:t.showCustomDialog},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[t._t("default")],2):a("single-select",{ref:"singleSelectDialog",attrs:{options:t.options,"options-disabled":t.optionsDisabled,title:t.title,"right-btn":t.rightBtn,grouping:t.grouping,"auto-open":!0,"before-open":t.beforeOpen,"standard-unit":t.standardUnit,editabled:t.editabled,"form-check":t.formCheck},on:{onSelect:t.onHandleSelect,rightBtnEvent:t.showCustomDialog},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),a("van-dialog",{attrs:{"show-cancel-button":"","get-container":"body","class-name":"custom-material-dialog","cancel-button-color":"#666","before-close":t.customSubmit},model:{value:t.showCustom,callback:function(e){t.showCustom=e},expression:"showCustom"}},[a("div",{on:{click:function(){t.$refs["custom-input"].blur()}}},["3"===t.customType?t._l(t.materialCategory,(function(e,i){return a("span",{key:"cate-"+i,staticClass:"mr5 mb5",class:t.customMaterialCategory===e?"checked":"",on:{click:function(a){t.selectMaterialCategory(e)}}},[t._v(t._s(e))])})):t._e(),a("div",{class:{"new-name":!0,error:t.customFormError&&!t.customName}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.customName,expression:"customName"}],ref:"custom-input",attrs:{placeholder:"请输入"+t.title,maxlength:"20"},domProps:{value:t.customName},on:{click:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.customName=e.target.value)}}})]),"2"===t.customType||"3"===t.customType?[a("p",{class:{error:t.customFormError&&!t.customMaterialUnit}},[t._v("请选择数量单位")]),a("div",{staticClass:"untis"},t._l(t.units,(function(e,i){return a("span",{key:"unit-"+i,class:t.customMaterialUnit===e.name?"checked":"",on:{click:function(a){t.selectCustomMaterialUnit(e)}}},[t._v(t._s(e.name))])})))]:t._e()],2)])],1)}),[],!1,null,"0f53bf7e",null);e.a=r.exports},"7cd3":function(t,e,a){var i=a("1db3");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("a86bfdc2",i,!0,{sourceMap:!1,shadowMode:!1})},"7d2b":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-c4404120]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-c4404120]{position:absolute;left:0;bottom:0;width:100%;flex-direction:column}.zjapp .box[data-v-c4404120],.zjapp .list-wrap[data-v-c4404120]{display:flex;background-color:#fff}.zjapp .list-wrap[data-v-c4404120]{flex-direction:row;align-items:flex-start;flex:1;height:465px}.zjapp #slideUpSelectDialog[data-v-c4404120]{padding:0 15px 0}.zjapp .hd[data-v-c4404120]{position:relative;padding:10px 45px;height:44px;line-height:22px;font-size:16px;color:#666;text-align:center;background-color:#fff}.zjapp .hd .icon-unqualified[data-v-c4404120]{position:absolute;width:44px;height:44px;top:0;right:0;line-height:44px;font-size:14px;text-align:center;color:#999}.zjapp .item[data-v-c4404120]{padding-left:0;padding-right:0}.zjapp .text[data-v-c4404120]{font-size:14px;line-height:20px;color:#333}.zjapp .note[data-v-c4404120]{font-size:12px;line-height:18px;color:#999}[data-v-c4404120] .icon-qualified{width:34px;height:34px;line-height:34px;text-align:center;color:#4275e8}",""])},"80d8":function(t,e,a){"use strict";a("e60b")},"81f2":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .main[data-v-2cac8864]{position:fixed;width:100%;bottom:0}.zjapp .arrow[data-v-2cac8864]{position:absolute;top:-7px;right:18px;width:0;height:0;border-bottom:7px solid #fff;border-right:7px solid transparent;border-left:7px solid transparent}.zjapp .content[data-v-2cac8864]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-2cac8864]{display:flex;flex-direction:column;background-color:#fff;overflow:auto}.zjapp .box-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1}.zjapp .detail-hd[data-v-2cac8864]{display:flex;padding:6px 15px}.zjapp .detail-arrow-right[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-right[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:12px;border:5px solid transparent;border-left:5px solid #c8c8c8}.zjapp .detail-arrow-down[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-down[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:15px;border:5px solid transparent;border-top:5px solid #c8c8c8}.zjapp .detail-title[data-v-2cac8864]{flex:1;line-height:34px;color:#111;font-size:16px}.zjapp .detail-bd[data-v-2cac8864]{padding:8px 15px 8px 35px;background-color:#fafafa}.zjapp .text-line[data-v-2cac8864]{font-size:14px;color:#666;line-height:30px;margin-bottom:30px}.zjapp .detail-hd-single[data-v-2cac8864]{padding:6px 0;margin:0 15px}.zjapp .detail-bd-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1;padding:8px 15px;background-color:#fff}',""])},"855c":function(t,e,a){"use strict";(function(t){a("cc57"),a("6a61");var i,n,r=a("2e91"),s=a("e68e"),o=a("07d2"),c=a("3c64"),l=a("cd05"),u=a("774b"),d=a("3bd5"),p=a("e2a7"),h=a("6bf2"),f=a.n(h),m=a("5e1b"),g=a("9fb4"),b=a("2b06");e.a={name:"MaterialV2BackEdit",components:{Item:o.default,ItemImgList:s.a,ItemTextarea:c.a,UserSelect:l.a,Scroller:u.default},props:{taskId:{type:String,default:""},taskInfo:{type:Object,default:function(){}}},data:function(){return{backData:{},draftData:{}}},computed:{curUserId:function(){var t=d.a.getUser(),e=t.user_id;t.user_name;return e},backEmpty:function(){return!(this.curUserId===this.backData.recipient)}},created:function(){console.log("退场-编辑-created===>"),this.init()},activated:function(){console.log("退场-编辑-activated===>"),this.init()},methods:{init:(n=Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getDraftData();case 2:return t.next=4,this.getBackData();case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),getDraftData:(i=Object(r.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.taskId,b.a.defaultMMKV(e),t.next=4,b.a.get(e);case 4:this.draftData=t.sent;case 5:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)}),getBackData:function(){var e=this;return g.a.getBackData(this.taskInfo).then((function(a){if(!t.isEmpty(e.draftData)){var i=e.draftData;a.cc=i.cc||a.cc,a.date=i.back_date||a.date,a.image_file=i.photo_requirements&&i.photo_requirements.length?i.photo_requirements:a.image_file,a.remark=i.remark||a.remark}e.backData=a}))},selectBackDate:function(){var t=this;m.a.openPopup({inputDate:f()(this.backData.date).toDate(),callback:function(e){t.backData.date=f()(e).format("YYYY-MM-DD"),t.onSave({back_date:t.backData.date})}})},beforeSelect:function(t){return p.a.confirm("确定将退场操作人修改为【"+t.name+"】吗？").then((function(t){return t}))},onSelectPic:function(t){this.$set(this.backData,"image_file",t),this.onSave({photo_requirements:t})},changeBackChecker:function(){},prepareTakePicture:function(){},onSave:function(t){var e=this.taskInfo.id;b.a.defaultMMKV(e),b.a.set(e,t)},onSubmit:function(){var e=this;if(!t.isEmpty(this.backData.image_file))return console.log("提交退场",this.backData),p.a.confirm("确定提交退场吗？").then((function(t){if(t)return g.a.submit(e.backData).then((function(){e.$emit("onSubmitBack"),e.onRemoveDraft()}))}));p.a.alert("请添加退场照片")},onRemoveDraft:function(){var t=this.taskInfo.id;b.a.defaultMMKV(t),b.a.remove(t)}}}}).call(this,a("391c"))},"88c7":function(t,e,a){"use strict";var i=a("c7df").a,n=a("17cc"),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{on:{click:t.openSelect}},[t.$slots.default?t._t("default"):a("item",{class:t.required,attrs:{label:t.title,text:t.selectVal,mode:t.mode,editabled:t.editabled,placeholder:t.required?"请选择":"选填"}},[t.$slots.right?t._t("right",null,{slot:"right"}):t._e()],2)],2)}),[],!1,null,null,null);e.a=r.exports},8934:function(t,e,a){var i=a("6481");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("266da06d",i,!0,{sourceMap:!1,shadowMode:!1})},"8b97":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .cover[data-v-02a5f460] path{fill:#fff!important}",""])},"8c3d":function(t,e,a){"use strict";(function(t){a("ed63"),a("163d"),a("2b45"),a("e204"),a("cc57");var i,n,r=a("07d2"),s=a("cf09"),o=a("6f9e"),c=a("4360"),l=[],u=[0,1,2,3,4,5,6,7,8,9,".","-"];function d(t){return null!=t&&""!==t}e.a={name:"NumberKeyboard",components:{Item:r.default},data:function(){return{show:!1,isClosing:!1,zIndex:0,willOpenParams:null,inputComponent:"",type:"",hasPrev:!1,hasNext:!1,isDisabledMinus:!1,isDisabledPoint:!1}},computed:{isIOSBezelLess:function(){return c.a.state.app.isIOSBezelLess}},watch:{isClosing:function(t){var e=this;this.$nextTick((function(){!t&&e.willOpenParams&&e.openKeyboard(e.willOpenParams)}))}},created:function(){o.a.$on("routerBeforeEach",this.closeKeyboard),o.a.$on("pageContentClick",this.closeKeyboard)},destroyed:function(){o.a.$off("routerBeforeEach",this.closeKeyboard),o.a.$off("pageContentClick",this.closeKeyboard)},methods:{openKeyboard:function(t){this.isClosing?this.willOpenParams=t:(this.willOpenParams=null,this.show=!0,this.inputComponent=t.inputComponent,this.zIndex=s.a?++s.a.zIndex:1,c.a.commit("global/SET_IS_NUMBER_INPUT_OPEN",!0),c.a.commit("global/SET_NUMBER_KEYBOARD_HEIGHT",c.a.state.app.isIOSBezelLess?266:"true-or-false"===this.inputComponent.type?176:232),this.calcTab(),this.type=this.inputComponent.type,this.setKeysStatus(this.inputComponent.value,this.inputComponent.type),o.a.$emit("numberKeyboardOpen",this.inputComponent))},closeKeyboard:function(){this.show=!1,o.a.$emit("numberKeyboardClose")},startClose:function(){this.isClosing=!0},onClose:function(){this.isClosing=!1,c.a.commit("global/SET_IS_NUMBER_INPUT_OPEN",!1),o.a.$emit("afterNumberKeyboardClose")},input:function(t){"-"===t&&this.isDisabledMinus||"."===t&&this.isDisabledPoint||this.$emit("keyboardInput",t)},delete:function(t){var e=this;this.$emit("keyboardDelete"),i=setTimeout((function(){e.$emit("keyboardClear")}),500)},calcTab:function(){var e=function t(e){return e&&e.$parent?"Scroller"===e.$parent.$options.name?e.$parent:t(e.$parent):null}(this.inputComponent),a=e&&e.$el.querySelectorAll(".component-number-input");if(l=[],a&&t.each(a,(function(t){l.push(t.__vue__)})),t.isEmpty(l))this.hasPrev=!1,this.hasNext=!1;else{var i=t.findIndex(l,this.inputComponent);this.hasPrev=i>0,this.hasNext=i<l.length-1}this.inputComponent&&this.inputComponent.nextEvent&&(this.hasNext=!0)},prev:function(){var e=t.findIndex(l,this.inputComponent),a=l[e-1];a&&(o.a.$emit("numberInputBlur"),a.setFocus(),this.openKeyboard({inputComponent:a}))},next:function(){var e=t.findIndex(l,this.inputComponent),a=l[e+1];a?(o.a.$emit("numberInputBlur"),a.setFocus(),this.openKeyboard({inputComponent:a})):this.inputComponent&&this.inputComponent.nextEvent&&this.inputComponent.nextEvent()},setTure:function(){this.$emit("keyboardAssign",1)},setFalse:function(){this.$emit("keyboardAssign",0)},setKeysStatus:function(t,e){t=d(t)?t.toString():"",d(t)||e.indexOf("positive")>=0?this.isDisabledMinus=!0:this.isDisabledMinus=!1,!/\d/.test(t)||t.indexOf(".")>=0||e.indexOf("int")>=0?this.isDisabledPoint=!0:this.isDisabledPoint=!1},setKeyActiving:function(t,e){t&&t.classList.contains("keys")&&!t.classList.contains("disabled")&&(e?t.classList.add("activing"):t.classList.remove("activing"))},keyTouchstart:function(t){var e=t&&t.target;if(e){+new Date,n=e,this.setKeyActiving(e,!0);var a=e.getAttribute("direct");"closeKeyboard"!==a&&this.clickHandler(a)}},keyTouchend:function(t){var e=t&&t.target;if(e){this.setKeyActiving(e,!1),this.setKeyActiving(n,!1);var a=e.getAttribute("direct");"delete"===a?clearTimeout(i):"closeKeyboard"===a&&this.clickHandler(a)}},clickHandler:function(t){t&&(isNaN(t)||(t=Number(t)),"function"==typeof this[t]?this[t]():u.includes(t)&&this.input(t))}}}}).call(this,a("391c"))},"8f73":function(t,e,a){"use strict";a("b9df")},9094:function(t,e,a){"use strict";a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return o})),a.d(e,"a",(function(){return c}));var i=a("5e8d"),n=a("da71"),r=a("162a");function s(){return Object(i.a)().then((function(){var t=n.a.materialList.url;return r.a.request(t)}))}function o(t){return Object(i.a)().then((function(){var e=n.a.contractorListByProject.url;return r.a.request(e,t)}))}function c(t){return Object(i.a)().then((function(){var e=n.a.getContractList.url;return r.a.request(e,t)}))}},9120:function(t,e,a){var i=a("2ddb");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("cb55f532",i,!0,{sourceMap:!1,shadowMode:!1})},"91c1":function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e"),a("9a33");var i=a("28f8"),n=a("e68e"),r=a("6f9e"),s=a("bcc7"),o=a("e89f");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"CheckGuideDetailDrop",components:{ItemImgList:n.a},mixins:[o.a],data:function(){return{show:!1,showList:!1,isLoading:!1,isOpening:!1,isClosing:!1,contentTop:64,listHeight:510,module:"",itemIds:[],data:[],target:""}},watch:{show:function(t){var e=this;t&&this.$nextTick((function(){e.showList=!0}))}},created:function(){r.a.$on("routerBeforeEach",this.closePopup),r.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){r.a.$off("routerBeforeEach",this.closePopup),r.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(e){this.show=!0,this.$emit("open"),this.module=e.module,this.itemIds=e.itemIds,this.options=e.options;var a=document.querySelector(".layout-main .layout-header");if(this.contentTop=a.offsetHeight,e.el){var i=e.el.getBoundingClientRect();this.contentTop=i.bottom}this.target=e.el,this.listHeight=t.minBy([window.innerHeight-this.contentTop-50,510]),this.getData()},closePopup:function(){var t=this;if(!this.isOpening)return this.showList=!1,this.$emit("close"),new Promise((function(e){t.$on("afterClosePopup",e)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(t){t&&t.target&&t.target!==this.target&&this.show&&this.closePopup()},getData:function(){var e=this;return this.options&&this.options.length?(this.data=t.map(this.options,(function(t){return l(l({},t),{},{isOpen:!1})})),Promise.resolve()):s.a.getMeasureCheckItem(this.itemIds).then((function(a){e.data=t.map(a,(function(e){var a=e.content?e.content.trim():"",i=a?a.split("\n"):[],n=e.content_image?JSON.parse(e.content_image):[],r=t.filter(i,(function(t){return!/<img([\s\S]*)>/gm.test(t)}));return t.each(n,(function(t){t.url=t.url.split("@")[0]})),{id:e.id,name:e.full_name,textArr:r,contentImage:n,isOpen:!1}}))})).catch((function(t){console.error(t)}))},toggleItem:function(t){this.data.length>1&&this.$set(t,"isOpen",!t.isOpen)}}}}).call(this,a("391c"))},"924c":function(t,e,a){"use strict";a("163d");var i=a("07d2"),n=a("e68e"),r=(a("5ba8"),{name:"MaterialV2PhotoType",components:{Item:i.default,ItemImgList:n.a},props:{mode:{type:String,default:"edit"},value:{type:Array,default:function(){return[]}},maxLength:{type:Number,default:50},allowMultiSelect:{type:Boolean,default:!0}},data:function(){return{}},computed:{},deactivated:function(){},methods:{pushInSaveStack:function(){this.$emit("input",this.value),this.$emit("onSave",{photo_requirements:this.value})}}}),s=(a("ec60"),a("17cc")),o=Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.value&&t.value.length?a("div",{staticClass:"photo-type-content"},t._l(t.value,(function(e,i){return a("div",{key:""+i+e.id,staticClass:"photo-list pic-list"},[a("p",{staticClass:"mb15 photo-type"},[t._v(t._s(e.title))]),a("item-img-list",{attrs:{maxlength:t.maxLength,editabled:"edit"===t.mode,"allow-multi-select":t.allowMultiSelect},on:{callback:function(e){t.pushInSaveStack()}},model:{value:e.image_file,callback:function(a){t.$set(e,"image_file",a)},expression:"item.image_file"}}),e.content?a("div",{staticClass:"pr15 pb10 mt15"},[a("div",{staticClass:"photo-type-desc"},[t._v("\n        "+t._s(e.content)+"\n      ")])]):t._e()],1)}))):t._e()}),[],!1,null,"738adc7a",null);e.a=o.exports},9293:function(t,e,a){"use strict";var i=a("c242").a,n=(a("b99b"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._l(t.value,(function(e,i){return a("div",{key:e.id,staticClass:"brand-item"},[i?a("i",{staticClass:"item-icon-remove",on:{click:function(e){e.stopPropagation(),t.removeBrand(i)}}}):t._e(),a("material-info-select",{attrs:{options:t.brandsOptions,"options-disabled":t.value,title:"品牌","right-btn":t.allowCustomBrand?"手工添加":""},on:{onSelect:function(a){return t.onSelectBrands(e,a)}},model:{value:e.selectedBrand,callback:function(a){t.$set(e,"selectedBrand",a)},expression:"brand['selectedBrand']"}}),t._l(e.standard,(function(n,r){return a("div",{key:""+r+n.id,staticClass:"brand-info-item"},[a("div",{staticClass:"brand-type"},[a("i",{staticClass:"item-icon-remove",on:{click:function(a){a.stopPropagation(),t.removeType(e,r)}}}),a("material-info-select",{attrs:{options:t.materialTypeList,"options-disabled":e.standard,"standard-unit":t.standardUnit,"custom-type":"2","place-holder":"请输入材料类型",title:"类型","right-btn":t.allowCustomType?"手工添加":""},on:{onSelect:t.onMaterialTypeSelect},model:{value:e.standard[r],callback:function(a){t.$set(e.standard,r,a)},expression:"brand.standard[key]"}})],1),n.specificationList&&n.specificationList.length&&n.specification&&n.specification.length?[t._l(n.specification,(function(i,r){return a("div",{key:r+i.name,staticClass:"spec-item"},[a("i",{staticClass:"item-icon-remove",on:{click:function(a){a.stopPropagation(),t.removeSpec(n.specification,r,n,e)}}}),a("div",{staticClass:"item-text"},[t._v(t._s(i.name))]),a("div",{staticClass:"item-ele align-r",class:n.quantity_unit?"unit_"+n.quantity_unit.length:"unit_"+t.standardUnit.length},[a("number-input",{staticClass:"color-theme",attrs:{type:"positive",decimal:3,"overflow-auto-recover":!1,range:[0,999999.999],"is-set-empty-tip":t.isSubmitData},on:{blur:function(e){t.pushInSaveStack()}},model:{value:i.num,callback:function(e){t.$set(i,"num",e)},expression:"specification.num"}}),a("span",{staticClass:"text"},[t._v(t._s(n.quantity_unit||t.standardUnit))])],1)])})),a("material-info-select",{attrs:{options:n.specificationList,multi:!0,title:"规格","right-btn":t.allowCustomSpec?"手工添加":"","place-holder":"请输入材料规格"},on:{onSelect:function(e){return t.onSelectSpecification(n,e)}},model:{value:n.specification,callback:function(e){t.$set(n,"specification",e)},expression:"type.specification"}},[a("div",{staticClass:"add-btn alignL"},[t._v("+ 新增规格")])])]:t._e(),!n.specificationList||!n.specificationList.length||n.specification&&n.specification.length?t._e():[a("material-info-select",{attrs:{options:n.specificationList,multi:!0,title:"规格","right-btn":t.allowCustomSpec?"手工添加":"","place-holder":"请输入材料规格"},on:{onSelect:function(e){return t.onSelectSpecification(n,e)}},model:{value:n.specification,callback:function(e){t.$set(n,"specification",e)},expression:"type.specification"}})],!n||!n.id||n.specificationList&&n.specificationList.length?t._e():[a("div",{staticClass:"spec-item"},[a("div",{staticClass:"item-text"},[t._v("数量")]),a("div",{staticClass:"item-ele align-r",class:n.quantity_unit?"unit_"+n.quantity_unit.length:"unit_"+t.standardUnit.length},[a("number-input",{key:"num_"+i,staticClass:"color-theme",attrs:{type:"positive",decimal:3,"overflow-auto-recover":!1,range:[0,999999.999],"is-set-empty-tip":t.isSubmitData},on:{blur:function(e){t.pushInSaveStack()}},model:{value:n.num,callback:function(e){t.$set(n,"num",e)},expression:"type.num"}}),a("span",{staticClass:"text"},[t._v(t._s(n.quantity_unit||t.standardUnit))])],1)])]],2)})),t.hadBrand&&t.value[i].id?a("div",{staticClass:"add-btn",on:{click:function(a){t.addStandard(e)}}},[t._v("\n      + 新增类型\n    ")]):t._e()],2)})),a("div",{staticClass:"add-btn mt10",on:{click:t.addBrands}},[t._v("+ 新增品牌")])],2)}),[],!1,null,"341e7465",null);e.a=r.exports},"942a":function(t,e,a){var i=a("1430");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("6164e25a",i,!0,{sourceMap:!1,shadowMode:!1})},9446:function(t,e,a){var i=a("2dd6");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("2192cd00",i,!0,{sourceMap:!1,shadowMode:!1})},9788:function(t,e,a){"use strict";a("9446")},"9e20":function(t,e,a){"use strict";a("7cd3")},"9e8c":function(t,e,a){"use strict";a("3f00")},"9fb4":function(t,e,a){"use strict";(function(t){a("2b45"),a("fc58"),a("6a61");var i=a("2e91"),n=a("0e4d"),r=a("94ef"),s=a("76ff"),o=a("4b67"),c=a("d703"),l=a("6bf2"),u=a.n(l),d=a("7cb8"),p=a("e3c6"),h=a("613e");function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,i=Object(c.a)(t);if(e){var n=Object(c.a)(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return Object(o.a)(this,a)}}var m=new(function(e){Object(s.a)(l,e);var a,o,c=f(l);function l(){var t;return Object(n.a)(this,l),(t=c.call(this)).state={},t}return Object(r.a)(l,[{key:"getBackData",value:(o=Object(i.a)(regeneratorRuntime.mark((function t(e){var a,i,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("task_base",e),a=e.id,i=e.proj_id,t.next=5,this.getAllList(i);case 5:return n=t.sent,r={id:"",taskId:a,status:e.status,date:u()().format("YYYY-MM-DD"),image_file:[],remark:"",created_by:e.created_by,recipient:e.recipient,cc:e.cc||[],backUser:{id:e.recipient,name:e.recipient_name},back_date:e.created_on,userOptions:n,ccOptions:n,download_time:e.download_time},t.abrupt("return",r);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"getBackDetails",value:function(t){return this.getTaskLogByStatus(t,"","已退场").then((function(e){return{id:e.id,backLogId:e.id,taskId:t,status:e.status,date:e.occurrence_date?u()(e.occurrence_date).format("YYYY-MM-DD"):u()().format("YYYY-MM-DD"),image_file:Object(d.f)(e.image_file||"[]"),remark:e.remark,cc:e.cc||[],checker:{id:e.operate_user,name:e.operate_user_name,mobile:e.operate_user_mobile,is_im_user:e.operate_user_im},checker_date:u()(e.created_on).format("YYYY-MM-DD HH:mm"),created_by:e.created_by}})).catch((function(t){console.log("err",t)}))}},{key:"submit",value:(a=Object(i.a)(regeneratorRuntime.mark((function e(a){var i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uploadImages(a.image_file);case 2:return i=e.sent,n={task_id:a.taskId,task_download_time:a.download_time,sendback_date:a.date,log_image_file:Object(d.o)(i),remark:a.remark,task_cc:t.map(a.cc||[],"id")},e.abrupt("return",Object(h.e)({data:Object(d.o)(n)},a.taskId));case 5:case"end":return e.stop()}}),e,this)}))),function(t){return a.apply(this,arguments)})}]),l}(p.a));e.a=m}).call(this,a("391c"))},a093:function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e"),a("f548");var i=a("28f8"),n=(a("9dd9"),a("cc57"),a("e204"),a("9eea")),r=a("3156b"),s=a("774b"),o=a("e89f"),c=a("6f9e");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"AppSingleSelect",components:{appSearchBar:n.default,item:r.a,Scroller:s.default},mixins:[o.a],props:{},data:function(){return{activeTab:[],storageKey:encodeURI(this.title||"singleSelectMark"),storageVal:[],keyword:"",searchStatus:!1,checkedItem:{},show:!1,searchData:[],options:[],optionsLimit:20,pagingOptions:!1,searchBar:!0,category:[],ifToggle:!1,editorAddData:!1,lineLimit:1}},computed:{optionsShow:function(){return this.options&&this.options.length?this.grouping?this.getGroupData():this.options.slice(0,this.optionsLimit):[]}},watch:{keyword:function(t){var e=this;this.$nextTick((function(){e.filterList(t)}))}},methods:{openPopup:function(e){if(console.log(e),this.value=!0,this.show=!0,this.category=[],c.a.$on("closeDialog",this.closePopup),this.title=e.title,this.selected=e.selected,this.checkedItem=e.selected,this.options=e.options,this.onSelect=e.onSelect,this.searchBar=e.searchBar,this.grouping=e.grouping,this.rightBtn=e.rightBtn,this.rightBtnEvent=e.rightBtnEvent,this.ifToggle=e.ifToggle,this.lineLimit=e.lineLimit,this.editorAddData=e.editorAddData,e.grouping&&e.autoOpen){var a=t.uniqBy(t.map(this.options,e.grouping));this.activeTab=t.map(a,(function(t,e){return e}))}this.storageKey=encodeURI(this.title||"singleSelectMark"),this.$emit("open")},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeEvent:function(){c.a.$off("closeDialog",this.closePopup),this.value=!1,this.show=!1,this.keyword="",this.searchStatus=!1,this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch()},customAddSupplier:function(t){return this.options.findIndex((function(e){return e.name===t}))},selectItem:function(t){var e=this;this.ifToggle&&this.checkedItem.id===t.id?this.checkedItem={}:this.checkedItem=t,this.onSelect(this.checkedItem),this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].saveHistory(),window.setTimeout((function(){e.closeEvent()}),300)},onSearchTypeChange:function(t){this.searchStatus=t},filterList:function(t){var e,a,i=this,n=new RegExp("("+t+")","gmi");if(this.category=[],this.keyword=t,this.searchData=[],!t)return!1;this.options.map((function(t){return n.test(t.name)&&(a=u(u({},t),{},{rename:t.name.replace(n,"<label>$1</label>")}),i.grouping?-1===(e=i.category.indexOf(a[i.grouping]))?(i.category.push(a[i.grouping]),i.searchData.push({name:a[i.grouping],children:[a]})):i.searchData[e].children.push(a):i.searchData.push(a)),t}))},pageOptions:function(){this.optionsLimit=this.optionsLimit+20,this.pagingOptions=!1},getGroupData:function(){var t,e=this,a=[];return this.category=[],this.options.map((function(i){return-1===(t=e.category.indexOf(i[e.grouping]))?(e.category.push(i[e.grouping]),a.push({name:i[e.grouping],children:[i]})):a[t].children.push(i),i})),a}}}}).call(this,a("391c"))},a14f:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .convert[data-v-13aac6b6]{-webkit-animation:rotate-data-v-13aac6b6 2s linear infinite;animation:rotate-data-v-13aac6b6 2s linear infinite}.zjapp .icon[data-v-13aac6b6]{fill:#4275e8}@-webkit-keyframes rotate-data-v-13aac6b6{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes rotate-data-v-13aac6b6{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}",""])},a220:function(t,e,a){"use strict";a.r(e);var i=a("50e0").a,n=(a("ddce"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-content",{attrs:{"show-go-root":!0,title:t.taskInfos.name}},[a("template-guide",{attrs:{slot:"header-bar-right",module:"material","proj-id":t.taskInfos.proj_id,"connect-id":t.taskInfos.material_id},on:{queryHasTemplate:t.getTemplateStatus},slot:"header-bar-right"}),t.isShowTamplate?t._e():a("check-guide",{attrs:{slot:"header-bar-right",module:"material","item-id":t.taskInfos.material_id},slot:"header-bar-right"}),t.isLoading?t._e():a("div",{staticClass:"wrap detail-wrap",style:{height:t.viewSize.contentHeight+"px"}},[a("div",{staticClass:"tabs"},t._l(t.tabs,(function(e,i){return a("span",{key:i,class:{active:i===t.curTabIndex},on:{click:function(e){t.onChangeTabName(i)}}},[t._v(t._s(e)+"\n      ")])}))),a("van-swipe",{ref:"materialTabContent",staticClass:"swipe-content",attrs:{"show-indicators":!1,loop:!1,"initial-swipe":t.defaultTabIndex},on:{change:t.onChangeTab}},[a("van-swipe-item",["edit"===t.taskMode?a("task-edit",{attrs:{"task-details":t.taskDetails,status:"edit","task-id":t.task_id},on:{onSave:t.onSaveTask}}):t._e(),"view"===t.taskMode?a("task-detail",{attrs:{"task-details":t.taskDetails,"edit-task":t.onEditTask,mode:t.taskMode}}):t._e()],1),a("van-swipe-item",[t.approachEmpty?t._e():["edit"===t.approachMode?a("approach-edit",{attrs:{"task-id":t.task_id,"task-info":t.taskInfos,"is-supervision":t.isSupervision},on:{onCheck:t.onCheckApproach}}):t._e(),"view"===t.approachMode?a("approach-detail",{attrs:{"task-id":t.task_id,"task-info":t.taskInfos}}):t._e()],t.approachEmpty?[a("loading-status",{attrs:{"is-empty":t.approachEmpty,"empty-text":"暂无进场记录"}})]:t._e()],2),"待退场"===t.taskInfos.status||"已退场"===t.taskInfos.status?a("van-swipe-item",["edit"===t.backMode?a("back-edit",{attrs:{"task-id":t.task_id,"task-info":t.taskInfos},on:{onSubmitBack:t.onSubmitBack}}):t._e(),"view"===t.backMode?a("back-detail",{attrs:{"task-id":t.task_id}}):t._e()],1):t._e()],1)],1)],1)}),[],!1,null,"f3ba54c4",null);e.default=r.exports},a317:function(t,e,a){"use strict";var i=a("e68e"),n=a("cd05"),r=a("07d2"),s=a("9fb4"),o={name:"MaterialV2BackDetail",components:{Item:r.default,ItemImgList:i.a,UserSelect:n.a},props:{taskId:{type:String,default:""}},data:function(){return{backDetails:{}}},created:function(){this.init()},activated:function(){this.init()},methods:{init:function(){this.getBackDetails()},getBackDetails:function(){var t=this;return s.a.getBackDetails(this.taskId).then((function(e){t.backDetails=e}))}}},c=(a("8f73"),a("17cc")),l=Object(c.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("item",{attrs:{label:"退场时间",text:t.backDetails.date}}),a("item",{attrs:{label:"相关照片"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.backDetails.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":t.backDetails.created_by},model:{value:t.backDetails.image_file,callback:function(e){t.$set(t.backDetails,"image_file",e)},expression:"backDetails.image_file"}})],1)]),a("item",{attrs:{label:"补充说明",text:t.backDetails.remark}}),a("user-select",{attrs:{title:"退场操作人",mode:"view",date:t._f("formatDate")(t.backDetails.checker_date),editabled:!1},model:{value:t.backDetails.checker,callback:function(e){t.$set(t.backDetails,"checker",e)},expression:"backDetails.checker"}}),a("user-select",{attrs:{title:"抄送人",mode:"view",multi:!0,editabled:!1},model:{value:t.backDetails.cc,callback:function(e){t.$set(t.backDetails,"cc",e)},expression:"backDetails.cc"}})],1)}),[],!1,null,"2f568a40",null);e.a=l.exports},a5c6:function(t,e,a){"use strict";var i=a("329b"),n=a("a093").a,r=(a("f3d7"),a("17cc")),s=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{attrs:{title:t.title,mode:"dialog","on-close":t.closeEvent}},[t.rightBtn&&!t.editorAddData||t.rightBtn&&t.editorAddData&&(!t.selected.name||t.customAddSupplier(t.selected.name)>-1)?a("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:function(e){t.rightBtnEvent(t.category)}},slot:"header-bar-right"},[t._v("\n      "+t._s(t.rightBtn)+"\n    ")]):t._e(),a("scroller",{attrs:{"has-next":!t.searchStatus&&!t.grouping&&t.optionsLimit<t.options.length,"end-text":"","is-empty":0===t.optionsShow.length},on:{loadNext:t.pageOptions}},[t.searchBar?a("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":t.storageKey},on:{changeSearchStatus:t.onSearchTypeChange},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):t._e(),t.searchStatus?[t.keyword?[t.grouping?a("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.searchData,(function(e,i){return a("van-collapse-item",{key:i,attrs:{title:e.name,name:i}},t._l(e.children,(function(e,i){return a("item",{key:i,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit,"render-field":"rename"},on:{click:t.selectItem}})})))}))):t._e(),t.grouping&&!t.searchData.length?a("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容","show-style":"search"}}):t._e(),t.grouping?t._e():[t._l(t.searchData,(function(e,i){return a("item",{key:i,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit,"render-field":"rename"},on:{click:t.selectItem}})})),t.searchData.length?t._e():a("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容","show-style":"search"}})]]:t._e()]:["-1"===t.selected.id&&t.customAddSupplier(t.selected.name)<0&&t.editorAddData?a("div",{staticClass:"supplier-editor",on:{click:t.closePopup}},[a("span",{staticClass:"title"},[t._v(t._s(t.selected.name))]),a("span",{staticClass:"icon"},[a("i",{staticClass:"iconfont icon-edit margin-r",on:{click:t.rightBtnEvent}}),a("i",{staticClass:"iconfont icon-qualified"})])]):t._e(),t.grouping?a("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.optionsShow,(function(e,i){return a("van-collapse-item",{key:i,attrs:{title:e.name,name:i}},t._l(e.children,(function(e,i){return a("item",{key:i,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit},on:{click:t.selectItem}})})))}))):t._l(t.optionsShow,(function(e,i){return a("item",{key:i,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit},on:{click:t.selectItem}})})),t.optionsShow.length?t._e():a("loading-status",{attrs:{"is-empty":!0,"empty-text":"暂无数据","show-style":"search"}})]],2)],1):t._e()],1)}),[],!1,null,"e465319c",null).exports,o=!1;o||(o=new(i.default.extend(s))({el:document.createElement("div")}),document.body.appendChild(o.$el));e.a=o},a63e:function(t,e,a){"use strict";a("45dc")},ab83:function(t,e,a){"use strict";(function(t){var i=a("4c09"),n=(a("e697"),a("cc57"),a("5a71")),r=a("88c7"),s=a("6f9e"),o=a("e2a7"),c=a("a500");e.a={name:"MaterialInfoSelect",components:{SingleSelect:n.default,MultiSelect:r.a},props:{title:{type:String,default:""},value:{type:[Object,Array]},multi:{type:Boolean,default:!1},options:{type:Array,default:function(){return[]}},optionsDisabled:{type:Array,default:function(){return[]}},rightBtn:{type:String,default:""},customType:{type:String,default:"1"},grouping:{type:String,default:""},beforeOpen:{type:Function},standardUnit:{type:String,default:""},editabled:{type:Boolean,default:!0},formCheck:{type:Boolean,default:!1}},data:function(){return{selected:this.multi?[]:{},showCustom:!1,customMaterialCategory:"",customName:"",customMaterialUnit:"",customFormError:!1,materialCategory:[],units:[{id:"包",name:"包"},{id:"卷",name:"卷"},{id:"匹",name:"匹"},{id:"套",name:"套"},{id:"桶",name:"桶"},{id:"支",name:"支"},{id:"只",name:"只"},{id:"组",name:"组"},{id:"根",name:"根"},{id:"箱",name:"箱"},{id:"米",name:"米"},{id:"台",name:"台"},{id:"盏",name:"盏"},{id:"个",name:"个"},{id:"片",name:"片"},{id:"块",name:"块"},{id:"吨",name:"吨"},{id:"樘",name:"樘"},{id:"棵",name:"棵"},{id:"株",name:"株"},{id:"件",name:"件"},{id:"公斤",name:"公斤"},{id:"平方米",name:"平方米"},{id:"立方米",name:"立方米"},{id:"其它",name:"其它"}]}},watch:{value:function(t){this.selected=t},showCustom:function(t){var e=this;t&&this.$nextTick((function(){e.$refs["custom-input"].focus()}))}},mounted:function(){this.value&&(this.selected=this.value)},methods:{onHandleSelect:function(e){t.has(e,"num")&&(e.num=""),this.selected=e,this.$emit("input",e),this.$emit("onSelect",e),s.a.$emit("closeDialog")},showCustomDialog:function(t){this.customMaterialUnit=this.standardUnit,this.materialCategory=t,this.customMaterialCategory=t[0],this.showCustom=!0,c.a.addTrack("材料验收-手工添加材料".concat(this.title),"","")},selectMaterialCategory:function(t){this.customMaterialCategory=t},selectCustomMaterialUnit:function(t){this.customMaterialUnit=t.name},customSubmit:function(e,a){var n,r,s=this;if("confirm"===e){if(!this.customName)return this.customFormError=!0,a(!1);switch(this.customType){case"1":(r=t.find(this.options,(function(t){return t.name===s.customName})))?n=r:(n={id:"custom-"+(new Date).getTime(),name:this.customName,checked:!0},this.options.push(n));break;case"2":if(!this.customMaterialUnit)return this.customFormError=!0,a(!1);(r=t.find(this.options,(function(t){return t.name===s.customName})))?n=r:(n={id:"custom-"+(new Date).getTime(),name:this.customName,checked:!0,quantity_unit:this.customMaterialUnit},this.options.push(n));break;case"3":if(!this.customMaterialUnit)return this.customFormError=!0,a(!1);if(r=t.find(this.options,(function(t){return t.name===s.customName&&t.category_name===s.customMaterialCategory})))n=r;else{var c=(this.options||[]).find((function(t){return t[s.grouping]===s.customMaterialCategory})),l=t.isEmpty(c)?"":c.category_id;if(n={id:"custom-"+(new Date).getTime(),name:this.customName,checked:!0,quantity_unit:this.customMaterialUnit,category_name:this.customMaterialCategory,category_id:l},!this.customMaterialCategory)return o.a.alert("请在PC添加材料阶段后再添加材料"),a(!1);this.options.push(n)}}n.disabled?o.a.alert("“"+this.customName+"”已存在，且不可选"):this.multi?(this.selected=this.$refs.multiSelectDialog.getDialogValue(),this.$refs.multiSelectDialog.setDialogValue([].concat(Object(i.a)(this.selected),[n]))):this.onHandleSelect(n),this.resetData(),a()}else this.resetData(),a()},resetData:function(){this.showCustom=!1,this.customMaterialCategory="",this.customName="",this.customMaterialUnit="",this.customFormError=!1}}}}).call(this,a("391c"))},b056:function(t,e,a){"use strict";(function(t){a("f548"),a("cc57"),a("9dd9");var i,n=a("07d2"),r=a("6f9e"),s=a("e89f"),o=a("9eea"),c=a("774b");e.a={name:"SlideUpSelectDialog",components:{Item:n.default,appSearchBar:o.default,Scroller:c.default},mixins:[s.a],data:function(){return{show:!1,showList:!1,isOpening:!1,isClosing:!1,title:"",selected:{},options:[],showNote:"",emptyText:"",initHeight:null,listHeight:null,componentUid:"",searchKeyword:"",allowSearch:!1,allowSearching:!1,timer:null,historyKey:null,searchOptions:[],listLimit:100,listLimitSize:100}},computed:{renderData:function(){var t=this.options;return t&&t.length>this.listLimit?t.slice(0,this.listLimit):t||[]},hasNextPage:function(){return this.options&&this.options.length>this.listLimit}},watch:{searchKeyword:function(e){var a=this;this.$nextTick((function(){a.options=e?a.fitlerByKeyword(t.cloneDeep(a.searchOptions),e):t.cloneDeep(a.searchOptions)}))},show:function(t){var e=this;t&&this.$nextTick((function(){e.showList=!0}))},showList:function(t){t&&this.scrollToSelect()}},created:function(){r.a.$on("routerBeforeEach",this.closePopup),r.a.$on("pageContentClick",this.closePopup),window.addEventListener("native.keyboardshow",this.onResize,!1),window.addEventListener("native.keyboardhide",this.onResize,!1)},destroyed:function(){r.a.$off("routerBeforeEach",this.closePopup),r.a.$off("pageContentClick",this.closePopup)},methods:{openPopup:function(e){this.componentUid=e.componentUid||"",this.title="选择"+e.title,this.options=e.options,this.searchOptions=t.cloneDeep(e.options),this.selected=t.clone(e.selected),this.showNote=e.showNote,this.emptyText=e.emptyText,this.allowSearch=e.allowSearch,this.initHeight=e.initHeight,this.historyKey=e.historyKey,i=e.callback,this.show=!0,this.onResize(),this.clearScrollToTimeout()},closePopup:function(){var t=this;if(!this.isOpening)return this.showList=!1,this.clearScrollToTimeout(),this.cloneSearch(),new Promise((function(e){t.$on("afterClosePopup",e)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},select:function(t){i(t),this.saveHistory(),this.closePopup()},scrollToSelect:function(){var t=this;this.$nextTick((function(){t.timer=window.setTimeout((function(){var e=document.querySelector("#slideUpSelectDialog .item .item-icon-right");e&&e.scrollIntoViewIfNeeded({block:"start",behavior:"smooth"}),t.clearScrollToTimeout()}),400)}))},clearScrollToTimeout:function(){clearTimeout(this.timer),this.timer=null},cloneSearch:function(){this.options=t.cloneDeep(this.searchOptions),this.searchKeyword="",this.$refs["app-search-bar-checkitem-select"]&&this.$refs["app-search-bar-checkitem-select"].cancelSearch()},saveHistory:function(){this.$refs["app-search-bar-checkitem-select"]&&this.$refs["app-search-bar-checkitem-select"].saveHistory()},setSearchMode:function(t){this.allowSearching=t,this.onResize()},onResize:function(e){var a=null,i=window.innerHeight;i-=$rootScope.viewSize.headerHeight-44,a=this.allowSearch&&this.allowSearching?i:t.minBy([.8*i,this.initHeight]),this.listHeight=a},fitlerByKeyword:function(e,a){var i=this,n=[];return t.each(e,(function(e){if(new RegExp(a,"gm").test(e.name))e.isOpen=!0,n.push(e);else if(!t.isEmpty(e.children)){var r=i.fitlerByKeyword(e.children,a);t.isEmpty(r)||(e.isOpen=!0,e.children=r,n.push(e))}})),n},keywordFilter:function(t){return this.searchKeyword?t.replace(new RegExp(this.searchKeyword,"gm"),'<span class="color-blue">'+this.searchKeyword+"</span>"):t},loadNext:function(){this.listLimit+=this.listLimitSize,this.listLimit>this.options.length&&(this.listLimit=this.options.length)},resultListLimit:function(){this.listLimit=this.listLimitSize}}}}).call(this,a("391c"))},b2ef:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .wrap[data-v-f3ba54c4]{display:flex;flex-direction:column;transform:translateZ(0)}.zjapp .wrap.detail-wrap[data-v-f3ba54c4]{padding-top:40px;max-height:100%}.zjapp .wrap .tabs[data-v-f3ba54c4]{position:relative;height:40px;margin-top:-40px;line-height:40px;background-color:#fff;text-align:center;font-size:14px;z-index:1;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .wrap .tabs span[data-v-f3ba54c4]{display:inline-block;padding:0 18px;position:relative}.zjapp .wrap .tabs .active[data-v-f3ba54c4]{color:#4275e8}.zjapp .wrap .tabs .active[data-v-f3ba54c4]:after{position:absolute;content:" ";display:block;width:6px;height:6px;border-radius:6px;background:#4275e8;bottom:-3px;left:50%;transform:translateX(-50%);transition:transform}.zjapp .wrap .swipe-content[data-v-f3ba54c4]{height:100%}.zjapp .wrap .swipe-content .van-swipe-item[data-v-f3ba54c4]{overflow:auto}.zjapp .wrap .edit-task[data-v-f3ba54c4]{display:block;margin-top:10px}',""])},b4c6:function(t,e,a){"use strict";a("cc57");var i=a("07d2"),n=a("cd05"),r=a("5a71"),s=a("e2a7"),o=a("3bd5"),c=a("e320"),l={name:"MaterialV2TaskDetail",components:{Item:i.default,UserSelect:n.a,SingleSelect:r.default},props:{mode:{type:String,default:"view"},taskDetails:{type:Object,default:function(){return{}}},editTask:{type:Function}},data:function(){return{reason:""}},computed:{selectedMaterialType:function(){var t=[];return this.taskDetails.materialType&&this.taskDetails.materialType.map((function(e){t.push(e.name)})),t.join("、")},editAuthority:function(){var t=this.$store.state.user.isSuper,e=o.a.getUser();return!!t||e.user_id===this.taskDetails.created_by},deleteAuthority:function(){return!!this.$store.state.user.isSuper||!(!this.editAuthority||"待申请进场"!==this.taskDetails.status)}},methods:{deleteTask:function(){var t=this;c.a.deleteLocalData(this.taskDetails.task_id);var e={title:"确定删除任务？",cancelText:"取消",okText:"删除",callback:function(e){if(e)return c.a.deleteTask(t.taskDetails.task_id).then((function(){t.$router.back()}))}};return s.a.popBox(e)}}},u=(a("bd48c"),a("17cc")),d=Object(u.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-wrap"},[t.taskDetails.shipping_no?a("item",{attrs:{label:"送货单",text:t.taskDetails.shipping_no}}):t._e(),a("item",{attrs:{label:"所属标段",text:t.taskDetails.section&&t.taskDetails.section.name}}),a("item",{attrs:{label:"材料名称",text:t.taskDetails.material&&t.taskDetails.material.name}}),t.selectedMaterialType?a("item",{attrs:{label:"材料类型",text:t.selectedMaterialType}}):t._e(),a("item",{attrs:{label:"使用部位",text:t.taskDetails.place||"无"}}),a("item",{attrs:{label:"材料供应商",text:t.taskDetails.supplier?t.taskDetails.supplier.name:"无"}}),t.taskDetails.contract&&t.taskDetails.contract.id&&t.taskDetails.contract.name?a("item",{attrs:{label:"所属合同",text:t.taskDetails.contract?t.taskDetails.contract.name:"无"}}):t._e(),t.taskDetails.remark?a("item",{attrs:{label:"补充说明",text:t.taskDetails.remark}}):t._e(),t._l(t.taskDetails.flowUsers,(function(e){return[a("user-select",{key:e.node_id,attrs:{title:e.name,mode:"view",editabled:!1},model:{value:e.users,callback:function(a){t.$set(e,"users",a)},expression:"item.users"}}),1===e.node_id?a("single-select",{key:"contractor-"+e.node_id,attrs:{title:"接收单位",mode:"view",editabled:!1},model:{value:e.contractor,callback:function(a){t.$set(e,"contractor",a)},expression:"item.contractor"}}):t._e()]})),a("user-select",{attrs:{title:"抄送人",mode:"view",multi:!0,editabled:!1},model:{value:t.taskDetails.cc,callback:function(e){t.$set(t.taskDetails,"cc",e)},expression:"taskDetails.cc"}}),a("user-select",{attrs:{title:"创建人",date:t._f("formatDate")(t.taskDetails.created_on),mode:"view",editabled:!1},model:{value:t.taskDetails.creater,callback:function(e){t.$set(t.taskDetails,"creater",e)},expression:"taskDetails.creater"}}),t.taskDetails.sendback_reason?a("item",{attrs:{label:"退回原因",text:t.taskDetails.sendback_reason}}):t._e(),(t.editAuthority||t.deleteAuthority)&&"view"===t.mode?a("app-button-group",[t.deleteAuthority?a("app-button",{attrs:{type:"warning",plain:"",rimless:""},on:{click:t.deleteTask}},[t._v("\n      删除\n    ")]):t._e(),t.editAuthority?a("app-button",{on:{click:t.editTask}},[t._v(" 修改 ")]):t._e()],1):t._e()],2)}),[],!1,null,"739a75ec",null);e.a=d.exports},b55a:function(t,e,a){"use strict";a("c001")},b65c:function(t,e,a){"use strict";(function(t){a("5ab2"),a("e10e"),a("f548"),a("9dd9"),a("cc57");var i=a("28f8"),n=(a("6d57"),a("de78"),a("9eea")),r=a("b850"),s=a("774b"),o=a("e89f");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"AppMultiSelect",components:{appSearchBar:n.default,item:r.a,Scroller:s.default},mixins:[o.a],props:{},data:function(){return{activeTab:[],storageKey:encodeURI(this.title||"multiSelectMark"),storageVal:[],keyword:"",searchStatus:!1,isHasVal:!1,checkedItem:{},show:!1,searchData:[],showSelected:!1,listTile:"",selectedNames:"",options:[],optionsLimit:20,pagingOptions:!1,searchBar:!0,category:[]}},computed:{optionsShow:function(){return this.options&&this.options.length?this.grouping?this.getGroupData():this.options.slice(0,this.optionsLimit):[]},realChecked:function(){return Object.values(this.checkedItem).filter((function(t){return!!t}))}},watch:{keyword:function(t){var e=this;this.$nextTick((function(){e.filterList(t)}))}},methods:{openPopup:function(e){this.value=!0,this.show=!0,this.title=e.title,this.selected=e.selected,this.options=e.options,this.onSelect=e.onSelect,this.searchBar=e.searchBar,this.grouping=e.grouping,this.rightBtn=e.rightBtn,this.rightBtnEvent=e.rightBtnEvent,this.checkBoxAliRight=e.checkBoxAliRight,this.showSelected=e.showSelected,this.listTile=e.listTile,this.beforeCheck=e.beforeCheck,t.isEmpty(this.selected)&&(this.selectedNames=""),this.setValue(e.selected),this.$emit("open")},setValue:function(t){var e={};t&&t.length?(t.forEach((function(t){t&&(e[t.id]=t)})),this.checkedItem=e):this.checkedItem={}},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeEvent:function(){this.value=!1,this.show=!1,this.keyword="",this.searchStatus=!1,this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch()},selectItem:function(e){var a=this;if(!e.disabled){var i=this.beforeCheck&&this.beforeCheck(e);i instanceof Promise||(i=Promise.resolve(i)),i.then((function(i){if(!1!==i){var n=l({},a.checkedItem);if(a.$refs["app-search-bar"]&&a.$refs["app-search-bar"].saveHistory(),a.checkedItem[e.id]?delete n[e.id]:n[e.id]=e,a.checkedItem=n,a.showSelected){var r=[];t.each(a.checkedItem,(function(t){r.push(t.name)})),a.selectedNames=r.join("、")}}}))}},onSearchTypeChange:function(t){this.searchStatus=t},onInput:function(t){this.isHasVal=!!t},filterList:function(t){var e,a,i=this,n=new RegExp("("+t+")","gmi");if(this.category=[],this.keyword=t,this.searchData=[],!t)return!1;this.options.map((function(t){return n.test(t.name)&&(a=l(l({},t),{},{rename:t.name.replace(n,"<label>$1</label>")}),i.grouping?-1===(e=i.category.indexOf(a[i.grouping]))?(i.category.push(a[i.grouping]),i.searchData.push({name:a[i.grouping],children:[a]})):i.searchData[e].children.push(a):i.searchData.push(a)),t}))},pageOptions:function(){this.optionsLimit=this.optionsLimit+20,this.pagingOptions=!1},getGroupData:function(){var t,e=this,a=[];return this.category=[],this.options.map((function(i){return-1===(t=e.category.indexOf(i[e.grouping]))?(e.category.push(i[e.grouping]),a.push({name:i[e.grouping],children:[i]})):a[t].children.push(i),i})),a},submit:function(){var t=Object.values(this.checkedItem);this.onSelect(t),this.closeEvent()},getHadSelectValue:function(){return Object.values(this.checkedItem)}}}}).call(this,a("391c"))},b850:function(t,e,a){"use strict";var i={name:"MultiSelectItem",props:{item:{type:Object,default:function(){return{id:"",name:""}}},checked:{type:Boolean,default:!1},alignRight:{type:Boolean,default:!1},renderField:{type:String,default:"name"},disabled:{type:Boolean,default:!1}},methods:{selectItem:function(t){this.disabled||this.$emit("click",t)}}},n=(a("c85b"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-cell",{staticClass:"single-item",attrs:{clickable:!0},on:{click:function(e){t.selectItem(t.item)}}},[a("div",{staticClass:"wrapper"},[a("span",{class:{checkbox:!0,checked:t.checked,disabled:t.disabled},style:{order:t.alignRight?10:0}},[a("i",{staticClass:"van-icon van-icon-success"})]),a("div",{staticClass:"checkboxtxt",class:{"disabled-text":t.disabled}},[a("span",{domProps:{innerHTML:t._s(t.item[t.renderField])}}),t.alignRight?a("p",{staticClass:"f12 color-gray"},[t._v(t._s(t.item.code))]):t._e()])])])}),[],!1,null,"b3cb8602",null);e.a=r.exports},b887:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .custom-material-dialog[data-v-0f53bf7e] .van-dialog__content{padding:20px}.zjapp .custom-material-dialog[data-v-0f53bf7e] .van-dialog__content span{display:inline-block;color:#333;height:30px;line-height:30px;padding:0 13px;text-align:center;font-size:15px;border:1px solid #dcdcdc;border-radius:4px}.zjapp .custom-material-dialog[data-v-0f53bf7e] .van-dialog__content span.checked{position:relative;border-color:#4275e8;color:#4275e8!important}.zjapp .custom-material-dialog[data-v-0f53bf7e] .van-dialog__content span.checked:before{position:absolute;content:" ";display:block;border:1px solid #4275e8;border-top:none;border-right:none;width:8px;height:4px;transform:rotate(-45deg);right:3px;bottom:5px}.zjapp .custom-material-dialog[data-v-0f53bf7e] .van-dialog__content .untis{margin:0 -3px}.zjapp .custom-material-dialog[data-v-0f53bf7e] .van-dialog__content .untis span{padding:0;width:50px;margin:0 3px 5px 3px;font-size:14px;color:#666}.zjapp .custom-material-dialog[data-v-0f53bf7e] .van-dialog__content p{padding:14px 0 10px 0;line-height:20px;color:#999;font-size:12px}.zjapp .custom-material-dialog[data-v-0f53bf7e] .van-dialog__content p.error{color:#ff3d3d}.zjapp .custom-material-dialog .new-name[data-v-0f53bf7e]{margin-top:10px}.zjapp .custom-material-dialog .new-name input[data-v-0f53bf7e]{width:100%;height:40px;padding:10px;border-radius:0;font-size:14px;border:none;background-image:linear-gradient(180deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0),linear-gradient(270deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0),linear-gradient(0deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0),linear-gradient(90deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0);background-size:100% 1px,1px 100%,100% 1px,1px 100%;background-repeat:no-repeat;background-position:top,100% 0,bottom,0 0}.zjapp .custom-material-dialog .new-name.error input[data-v-0f53bf7e]::-webkit-input-placeholder{color:#ff3d3d}',""])},b907:function(t,e,a){var i=a("b2ef");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("7cf33694",i,!0,{sourceMap:!1,shadowMode:!1})},b99b:function(t,e,a){"use strict";a("602d")},b9df:function(t,e,a){var i=a("28e7");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("c02f380a",i,!0,{sourceMap:!1,shadowMode:!1})},bd48c:function(t,e,a){"use strict";a("1020")},bebe:function(t,e,a){var i=a("6272");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("53478790",i,!0,{sourceMap:!1,shadowMode:!1})},bee0:function(t,e,a){"use strict";(function(t){a("e697"),a("6a61");var i,n,r,s,o,c,l=a("2e91"),u=a("07d2"),d=a("3c64"),p=a("cd05"),h=a("774b"),f=a("9293"),m=a("924c"),g=a("e2a7"),b=a("6bf2"),v=a.n(b),k=a("5e1b"),y=a("5ba8"),_=(a("0636"),a("2b06"));e.a={name:"MaterialV2ApproachEdit",components:{Item:u.default,ItemTextarea:d.a,UserSelect:p.a,Scroller:h.default,ApproachBrand:f.a,MaterialPhotoType:m.a},props:{taskId:{type:String,default:""},taskInfo:{type:Object,default:function(){}},isSupervision:{type:Boolean,default:!0}},data:function(){return{isLoading:!1,viewSize:$rootScope.viewSize,brands:[],brandsOptions:[],materialTypeList:[],ccOptions:[],allowCustomBrand:!1,allowCustomType:!1,allowCustomSpec:!1,approach_date:v()().format("YYYY-MM-DD"),receiverImg:[],remark:"",draftData:{},isSubmitData:!1}},computed:{},created:function(){console.log("进场-编辑-created===>"),this.init()},activated:function(){console.log("进场-编辑-activated===>"),this.init()},deactivated:function(){},methods:{init:(c=Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.next=3,this.getDraftData();case 3:return t.next=5,this.getBaseData();case 5:return t.next=7,this.getPermissions();case 7:return t.next=9,this.getBrandData();case 9:return t.next=11,this.getOtherData();case 11:this.isLoading=!1;case 12:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)}),getDraftData:(o=Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return _.a.defaultMMKV(this.taskId),t.next=3,_.a.get(this.taskId);case 3:this.draftData=t.sent;case 4:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),getBaseData:(s=Object(l.a)(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.taskInfo.material_id||"",a=this.taskInfo.section_id||"",t.next=3,y.a.getBrandsList(e,this.brands);case 3:return this.brandsOptions=t.sent,t.next=6,y.a.getSectionTypeList(a,e);case 6:return this.materialTypeList=t.sent,t.next=9,y.a.getCcList(this.taskInfo.proj_id||"");case 9:this.ccOptions=t.sent;case 10:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)}),getPermissions:(r=Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Boolean,t.next=3,y.a.isAllowCustomMaterial("MATERIAL_BRAND");case 3:return t.t1=t.sent,this.allowCustomBrand=(0,t.t0)(t.t1),t.t2=Boolean,t.next=8,y.a.isAllowCustomMaterial("MATERIAL_TYPE");case 8:return t.t3=t.sent,this.allowCustomType=(0,t.t2)(t.t3),t.t4=Boolean,t.next=13,y.a.isAllowCustomMaterial("MATERIAL_FORMAT");case 13:t.t5=t.sent,this.allowCustomSpec=(0,t.t4)(t.t5);case 15:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)}),getBrandData:(n=Object(l.a)(regeneratorRuntime.mark((function e(){var a,i,n,r,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.getSpecificationList(this.taskInfo.material_id);case 2:a=e.sent,i=t.groupBy(a,"material_type_id"),n=[],t.each(this.materialTypeList,(function(e){var a=e;t.has(i,e.id)&&(a.specificationList=i[e.id]),n.push(a)})),(r=this.draftData&&this.draftData.brands&&this.draftData.brands.length?this.draftData.brands:[])&&!r.length&&(r=[{standard:[],selectedBrand:{}}],(s=this.taskInfo.material_type_list?JSON.parse(this.taskInfo.material_type_list):[]).length?t.each(s,(function(e){var a=t.find(n,(function(t){return t.id===e.id}));a&&(a=t.clone(a),r[0].standard.push(a))})):r[0].standard.push({num:""})),this.brands=r;case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),getOtherData:(i=Object(l.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.draftData&&this.draftData.photo_requirements&&this.draftData.photo_requirements.length)){t.next=4;break}t.t0=this.draftData.photo_requirements,t.next=7;break;case 4:return t.next=6,y.a.getPhotoList(this.taskId,this.taskInfo.current_task_process_id);case 6:t.t0=t.sent;case 7:this.receiverImg=t.t0,this.remark=this.draftData&&this.draftData.remark||"",this.approach_date=this.draftData&&this.draftData.approach_date||v()().format("YYYY-MM-DD"),this.isSubmitData=!1;case 11:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)}),selectApproachDate:function(){var t=this;k.a.openPopup({inputDate:v()(this.approach_date).toDate(),callback:function(e){t.approach_date=v()(e).format("YYYY-MM-DD"),t.onSave({approach_date:t.approach_date})}})},onSave:function(t){_.a.defaultMMKV(this.taskId),_.a.set(this.taskId,t)},onSubmit:function(){var e=this,a={task_id:this.taskId,task_info:this.taskInfo,brands:this.brands,photoList:this.receiverImg,remark:this.remark,approach_date:this.approach_date,task_cc:t.map(this.taskInfo.cc||[],"id")};return this.isSubmitData=!0,y.a.receiverSubmit(a).then((function(){e.onCheck("check"),e.isSubmitData=!1})).catch((function(t){g.a.alert(t)}))},onBack:function(){var e=this,a={task_id:this.taskId,task_info:this.taskInfo,brands:this.brands,photoList:this.receiverImg,remark:this.remark,approach_date:this.approach_date,task_cc:t.map(this.taskInfo.cc||[],"id")};return this.isSubmitData=!0,y.a.receiverBack(a).then((function(){e.onCheck("back"),e.isSubmitData=!1})).catch((function(t){g.a.alert(t)}))},onCheck:function(t){this.$emit("onCheck",t),this.onRemoveDraft()},onRemoveDraft:function(){_.a.defaultMMKV(this.taskId),_.a.remove(this.taskId)}}}}).call(this,a("391c"))},c001:function(t,e,a){var i=a("f53a");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("bd5eb062",i,!0,{sourceMap:!1,shadowMode:!1})},c070:function(t,e,a){var i=a("574c");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("35590dcb",i,!0,{sourceMap:!1,shadowMode:!1})},c242:function(t,e,a){"use strict";(function(t){a("e697"),a("cc57");var i=a("6948"),n=a("7a80");a("5ba8");e.a={name:"MaterialV2ApproachBrand",components:{NumberInput:i.a,MaterialInfoSelect:n.a},props:{value:{type:Array,default:function(){return[]}},brandsOptions:{type:Array,default:function(){return[]}},standardUnit:{type:String,default:""},materialTypeList:{type:Array,default:function(){return[]}},allowCustomBrand:{type:Boolean,default:!1},allowCustomType:{type:Boolean,default:!1},allowCustomSpec:{type:Boolean,default:!1},isSubmitData:{type:Boolean,default:!1}},data:function(){return{hadBrand:!0}},computed:{},deactivated:function(){},methods:{onSelectBrands:function(t,e){this.hadBrand=!1,t.id=e.id,t.name=e.name,this.hadBrand=!0,this.pushInSaveStack()},onMaterialTypeSelect:function(){this.pushInSaveStack()},removeBrand:function(t){console.log(this.approachData),this.value.splice(t,1),this.pushInSaveStack()},removeType:function(t,e){console.log(this.approachData),t.standard.splice(e,1),$log.log("删除类型"),this.pushInSaveStack()},removeSpec:function(t,e,a,i){t.splice(e,1),a.specification=t,this.pushInSaveStack()},onSelectSpecification:function(e,a){e.specification=t.map(a,(function(a){var i=t.find(e.specification,{id:a.id});return{id:a.id,name:a.name,num:(i?i.num:"")||""}})),this.pushInSaveStack()},addStandard:function(t){console.log("新增类型"),t.standard||this.$set(t,"standard",[]),t.standard.push({data:{},num:""}),this.pushInSaveStack()},addBrands:function(){this.value||(this.value=[]),this.value.push({standard:[]}),this.pushInSaveStack()},pushInSaveStack:function(){console.log("this.value",this.value),this.$emit("input",this.value),this.$emit("onSave",{brands:this.value})}}}}).call(this,a("391c"))},c7df:function(t,e,a){"use strict";(function(t){a("cc57");var i=a("07d2"),n=a("3730"),r=a("6144");e.a={name:"MultiSelect",components:{Item:i.default},props:{title:{type:String,default:""},value:{type:Array,default:function(){return[]}},options:{type:Array,default:function(){return[]}},selectedText:{type:String,default:""},required:{type:Boolean,default:!0},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},beforeOpen:{type:Function,default:function(){}},beforeCheck:{type:Function,default:function(){}},searchBar:{type:Boolean,default:!0},checkBoxAliRight:{type:Boolean,default:!1},grouping:{type:String,default:""},rightBtn:{type:String,default:""},rightBtnEvent:{type:Function,default:function(){return 0}}},data:function(){return{memoryKey:this.$route.name+encodeURI(this.title)}},computed:{selectVal:function(){return""!==this.selectedText?this.selectedText:this.value&&this.value.length?this.value.map((function(t){return t.name})).join("、"):"view"===this.mode?"无":""}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var e=this;if(this.editabled){var a=this.beforeOpen();a&&a.then&&t.isFunction(a.then)?a.then((function(t){!1!==t&&e.openPopup()})):!1!==a&&this.openPopup()}},renderSelected:function(t){n.a.selectItem(t)},openPopup:function(){var t=this;n.a.openPopup({title:"选择"+this.title,selected:this.value,options:this.options,required:this.required,searchBar:this.searchBar,grouping:this.grouping,rightBtn:this.rightBtn,checkBoxAliRight:this.checkBoxAliRight,beforeCheck:this.beforeCheck,onSelect:function(e){t.$emit("input",e),t.$emit("onSelect",e)},rightBtnEvent:function(e){t.$emit("rightBtnEvent",e)}})},setDialogValue:function(t){n.a.setValue(t)},getDialogValue:function(){return n.a.getHadSelectValue()},closePopup:function(){n.a.closePopup()},onSelect:function(t){this.$emit("input",t),this.$emit("onSelect",t)},setSelected:function(){var e=r.a.getObject(this.memoryKey,r.a.level.user);!1===this.editabled||t.isEmpty(this.options)||(t.isEmpty(this.value)?this.memory&&!t.isEmpty(e)&&t.some(this.options,{id:e.id})&&(this.$emit("input",e),this.autoSelect&&this.$emit("onSelect",e)):this.autoSelect&&this.$emit("onSelect",this.value))}}}}).call(this,a("391c"))},c85b:function(t,e,a){"use strict";a("f6e3")},cbc1:function(t,e,a){"use strict";a("1f31")},cf0d:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .layout-main[data-v-0a266c44] .layout-content{overflow:auto}.zjapp .datepicker-hd[data-v-0a266c44]{display:flex;text-align:center;padding:5px 5px 15px 5px}.zjapp .datepicker-hd-center[data-v-0a266c44]{flex:1;display:flex;padding:10px 5px}.zjapp .datepicker-month[data-v-0a266c44],.zjapp .datepicker-year[data-v-0a266c44]{position:relative;flex:1;border:none;border-bottom:1px solid #4374ea;padding:0;line-height:26px;font-size:14px;text-align:center}.zjapp .datepicker-month[data-v-0a266c44]{margin-left:10px}.zjapp .datepicker-month[data-v-0a266c44]:after,.zjapp .datepicker-year[data-v-0a266c44]:after{position:absolute;top:50%;right:5px;margin-top:-3px;width:0;height:0;border-top:5px solid;border-right:5px solid transparent;border-left:5px solid transparent;content:"";pointer-events:none;color:#4374ea}.zjapp .datepicker-next[data-v-0a266c44],.zjapp .datepicker-prev[data-v-0a266c44]{width:10%;padding:10px 5px;font-size:24px;color:#4374ea}.zjapp .select-list[data-v-0a266c44]{position:absolute;top:27px;left:0;width:100%;max-height:380px;overflow:auto;background-color:#fff;box-shadow:0 0 5px #333}.zjapp .select-item[data-v-0a266c44]{padding:5px;height:38px;line-height:28px}.zjapp .item-selected[data-v-0a266c44]{background-color:#4374ea;color:#fff}.zjapp .weeks-row[data-v-0a266c44]{padding:5px;display:flex}.zjapp .weeks-cell[data-v-0a266c44]{flex:1;line-height:20px;text-align:center;font-size:14px;font-weight:700}.zjapp .date-row[data-v-0a266c44]{padding:0 5px;display:flex}.zjapp .date-cell[data-v-0a266c44]{flex:1;height:50px;line-height:50px;text-align:center;font-size:14px}.zjapp .date-cell-selected[data-v-0a266c44]{background-color:#4374ea;color:#fff;font-weight:700}.zjapp .date-cell.today[data-v-0a266c44]{border:1px solid #4374ea}.zjapp .disabled[data-v-0a266c44]{pointer-events:none;color:#aaa}',""])},d1d1:function(t,e,a){"use strict";(function(t){var i=a("fd50"),n=a("bcc7"),r=a("515e"),s=a("07d2"),o=a("7bac"),c=a("a7c3"),l=a("4360");e.a={name:"CheckGuideList",components:{Item:s.default},store:l.a,data:function(){return{isLoading:!0,listData:[],module:"",itemId:"",batchId:"",sectionId:"",options:""}},computed:{moduleAttribute:function(){return this.$store.state.global.moduleAttribute}},methods:{init:function(e){var a,n=this;for(var r in this.module=e.module,this.itemId=e.itemId,this.batchId=e.batchId,this.sectionId=e.sectionId,this.options=e.options,e)this[r]=e[r];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module];var s=!1;t.isEmpty(this.itemId)?!t.isEmpty(this.checkType)&&t.isEmpty(this.sectionId)?a=this.initByType():t.isEmpty(this.batchId)?t.isEmpty(this.options)?t.isEmpty(this.sectionId)?a=i.a.when():(s=!0,a=this.initByBidsection()):a=this.initByOptions():a=this.initByBatch():a=this.initById(),this.isLoading=!0,a.then((function(e){var a=n.moduleAttribute[n.module]||{};!t.isEmpty(a)&&a.setUsualItems&&s?o.a.getUserKey(n.mmkvCode()).then((function(t){t=null===t?e:n.mergeArray(n.deepClone(e),t),n.listData=t||[],n.isLoading=!1})):(n.listData=e||[],n.isLoading=!1)}))},mmkvCode:function(){var t=this.moduleAttribute[this.module]||{};return c.a[t.mmkv_item]+"_"+this.sectionId},mergeArray:function(e,a){var i=this;return t.filter(e,(function(e){var n=a[e.id];return t.isEmpty(e.subitem)||(e.subitem=i.mergeArray(e.subitem,a)),!t.isEmpty(n)||"desc"===e.type}))},clickItem:function(t){t.subitem&&t.subitem.length?this.$set(t,"isOpen",!t.isOpen):"special-inspect"===this.module?r.a.openPopup({itemId:t.id,module:this.module}):r.a.openPopup({itemId:t.item_id,module:this.module})},initById:function(){var t=this;if("special-inspect"!==this.module)return n.a.getCheckItem(this.itemId,this.checkType).then((function(e){return e?t.sectionId?n.a.getBidSectionCheckItemListByCode(t.sectionId,e.code):n.a.getCheckItemTreeByCode(e.code):i.a.when()}))},initByType:function(){return n.a.getCheckItemGuidelineList(this.checkType)},initByBatch:function(){return i.a.when()},initByBidsection:function(){return n.a.getBidSectionCheckItemTreeByType(this.sectionId,this.checkType)},initByOptions:function(){return i.a.resolve(this.options)},deepClone:function(t){return JSON.parse(JSON.stringify(t))}}}}).call(this,a("391c"))},d406:function(t,e,a){var i=a("1551");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("7a5328cb",i,!0,{sourceMap:!1,shadowMode:!1})},d81a:function(t,e,a){"use strict";a("299f")},dc98:function(t,e,a){"use strict";a("0732")},ddce:function(t,e,a){"use strict";a("b907")},e1e7:function(t,e,a){"use strict";(function(t){a("cc57"),a("163d");var i=a("07d2"),n=a("4e8c");e.a={name:"SlideUpSelect",components:{Item:i.default},props:{title:{type:String,default:""},value:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},placeholder:{type:String,default:"请选择"},emptyText:{type:String,default:"暂无数据"},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},showNote:{type:String},allowSearch:{type:Boolean,defalut:!1},initHeight:{type:Number,default:400},historyKey:{type:String,default:"historyHey"}},data:function(){return{isOpen:!1}},computed:{text:function(){return t.isEmpty(this.value)?this.editabled?"":"无":this.value.name}},created:function(){var t=this;n.a.$on("afterClosePopup",(function(){t.isOpen=!1}))},activated:function(){n.a.resultListLimit()},methods:{openSelect:function(){var t=this;n.a.openPopup({title:this.title,options:this.options,selected:this.value,showNote:this.showNote,emptyText:this.emptyText,allowSearch:this.allowSearch,initHeight:this.initHeight,historyKey:this.historyKey,componentUid:this._uid,callback:function(e){t.$emit("input",e),t.$emit("onSelect",e)}}),this.isOpen=!0}}}}).call(this,a("391c"))},e320:function(t,e,a){"use strict";(function(t){a("2b45"),a("fc58"),a("cc57"),a("6a61");var i=a("2e91"),n=(a("ed63"),a("8cf2"),a("163d"),a("6d57"),a("0e4d")),r=a("94ef"),s=a("76ff"),o=a("4b67"),c=a("d703"),l=a("2286"),u=a("3bd5"),d=a("e2a7"),p=a("4360"),h=a("7cb8"),f=a("e3c6"),m=a("48f4"),g=a("0136"),b=a("613e"),v=a("15f5");function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,i=Object(c.a)(t);if(e){var n=Object(c.a)(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return Object(o.a)(this,a)}}var y=new(function(e){Object(s.a)(c,e);var a,o=k(c);function c(){var t;return Object(n.a)(this,c),(t=o.call(this)).state={},t}return Object(r.a)(c,[{key:"getPlaceRequired",value:function(){return p.a.state.global.isPlaceRequired.material}},{key:"selectMaterialSupplier",value:function(t,e){return this.getContractorList(t).then((function(t){return e&&-1===e.id&&t.unshift(e),t}))}},{key:"getFlowUsers",value:function(e){var a=u.a.getUser(),i={id:a.user_id,name:a.user_name},n={item_id:e};return Object(b.a)(n).then((function(e){return t.forEach(e,(function(t){1===Number(t.node_id)?t.users=i:t.users=l.b.includes(t.node_id)?[]:{},t.type=l.c[t.node_id],t.contractor={}})),e}))}},{key:"getUserOptions",value:(a=Object(i.a)(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCcList(e);case 2:return t.t0=t.sent,t.next=5,this.getAllList(e);case 5:return t.t1=t.sent,t.next=8,this.getCheckerList(e);case 8:return t.t2=t.sent,t.next=11,this.getConstructerList(e);case 11:return t.t3=t.sent,a={cc:t.t0,receiver:t.t1,checker:t.t2,constructer:t.t3},t.abrupt("return",a);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"submitTask",value:function(e,a){var i=t.cloneDeep(e);if(t.isEmpty(i.section)||!i.section.id)return Promise.reject("请选择所属标段");if(t.isEmpty(i.material)||!i.material.id)return Promise.reject("请选择材料");if(!i.supplier||!i.supplier.id)return Promise.reject("请选择材料供应商");if(this.getPlaceRequired()&&!i.place)return Promise.reject("请填写使用部位");if(i.flowUsers&&i.flowUsers.length){var n="";if(t.forEach(i.flowUsers,(function(e){return t.isEmpty(e.users)||!e.users.id?(n="请选择".concat(e.name),!1):1!==e.node_id||!t.isEmpty(e.contractor)&&e.contractor.id?void 0:(n="请选择接收单位",!1)})),n)return Promise.reject(n)}/^custom\-[\d]+$/.test(i.material.id)&&(i.material.id="");var r=[];i.materialType&&i.materialType.length&&t.each(i.materialType,(function(t){/^custom\-[\d]+$/.test(t.id)&&(t.id=""),r.push({id:t.id,name:t.name,is_manual:t.id?0:1,quantity_unit:t.quantity_unit})}));var s=t.filter(i.flowUsers,(function(t){return 1===t.node_id})),o=s&&s.length&&s[0].users?s[0].users.id:"",c=s&&s.length&&s[0].contractor?s[0].contractor.id:"",l={proj_id:a,bidsection_id:i.section&&i.section.id,category_name:i.material.category_name||"",category_id:i.material.category_id||"",material:{id:i.material.id,name:i.material.name,quantity_unit:i.material.quantity_unit,is_manual:i.material.id?0:1},material_type:r||[],used_part:i.place,contract:i.contract,remark:i.remark,recipient:o,recipient_unit:c,supervisor:"",supplier:i.supplier.name,task_cc:t.map(i.cc||[],"id")};return Object(b.b)({data:Object(h.o)(l)})}},{key:"saveTask",value:function(e,a,i){var n=t.cloneDeep(a);/^custom\-[\d]+$/.test(n.material.id)&&(n.material.id="");var r=t.filter(n.flowUsers,(function(t){return 1===t.node_id})),s=r&&r.length&&r[0].users?r[0].users.id:"",o=r&&r.length&&r[0].contractor?r[0].contractor.id:"",c={task_id:e,proj_id:i,bidsection_id:n.section&&n.section.id,used_part:n.place,contract:n.contract,remark:n.remark,recipient:s,recipient_unit:o,task_cc:t.map(n.cc||[],"id"),task_download_time:a.download_time};return Object(b.g)({data:Object(h.o)(c)},e)}},{key:"deleteTask",value:function(t){$log.log("材料验收--\x3e删除任务",t);var e={id:t};return Object(b.c)(e).then((function(){return v.a.deleteTask(t)})).then((function(){return g.a.removeTodo(t)})).then((function(){m.default.setLocalChanged()})).catch((function(t){return d.a.alert(t)}))}}]),c}(f.a));e.a=y}).call(this,a("391c"))},e3c6:function(t,e,a){"use strict";(function(t){a.d(e,"a",(function(){return v}));a("06a2"),a("6d57"),a("163d"),a("6a61");var i=a("2e91"),n=a("0e4d"),r=a("94ef"),s=a("ed08"),o=a("4ad6"),c=a("7cb8"),l=a("3516"),u=a("37d5"),d=a("3122"),p=a("c745"),h=a("5ff0"),f=a("9ba8"),m=a("59f8"),g=a("9bcb"),b=a("15f5"),v=function(){function e(){Object(n.a)(this,e)}var a,v,k;return Object(r.a)(e,[{key:"getSectionList",value:function(t){return l.a.getSectionList(t)}},{key:"getSectionMaterial",value:function(t){return f.a.getSectionMaterial(t)}},{key:"getContractorList",value:function(t){return h.a.getContractorList(t)}},{key:"getSectionTypeList",value:function(t,e){return f.a.getSectionMaterialTypes(t,e)}},{key:"getGlobalStorage",value:function(t){return m.a.getValue(t)}},{key:"isAllowCustomMaterial",value:(k=Object(i.a)(regeneratorRuntime.mark((function t(e){var a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getGlobalStorage("allow_add_material_via_app");case 2:return a=t.sent,i="1"===a||"0"===a?"1"===a:Number(JSON.parse(a)[e]),t.abrupt("return",i);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return k.apply(this,arguments)})},{key:"getContractorOptions",value:(v=Object(i.a)(regeneratorRuntime.mark((function t(e,a){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=null,t.next=3,p.a.allowGroupUserByConstructor();case 3:if(!t.sent){t.next=8;break}return t.next=7,p.a.getOwnedContractorList(e);case 7:i=t.sent;case 8:if(i&&0!==i.length||!a){t.next=12;break}return t.next=11,h.a.getContractorList(a);case 11:i=t.sent;case 12:return t.abrupt("return",i);case 13:case"end":return t.stop()}}),t)}))),function(t,e){return v.apply(this,arguments)})},{key:"getUserList",value:function(t,e){return u.default.getProjectUsers(t,e)}},{key:"getCcList",value:function(t){return this.getAllList(t)}},{key:"getConstructerList",value:function(t){return this.getUserList(t,[33])}},{key:"getCheckerList",value:function(t){return this.getAllList(t)}},{key:"getAllList",value:function(t){return this.getUserList(t,[31,32,33])}},{key:"getCurrentUserProjectRoles",value:function(){return u.default.getCurrentUserProjectRoles().then((function(e){return!!t.some(e,t.matches({role_type:32}))}))}},{key:"getMaterialPhotoType",value:function(t,e){return b.a.getMaterialPhotoType(t,e)}},{key:"getPhotoRequirement",value:function(t,e){return b.a.getPhotoRequirement(t,e)}},{key:"getPhotoDetails",value:function(e){return b.a.getPhotoDetails(e).then((function(e){return t.forEach(e,(function(t){t.image_file=Object(c.f)(t.image_file||"[]")})),e}))}},{key:"getProcessDetails",value:(a=Object(i.a)(regeneratorRuntime.mark((function e(a){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPhotoDetails(a);case 2:return n=e.sent,e.abrupt("return",b.a.getProcessDetails(a).then((function(e){return t.forEach(e,function(){var t=Object(i.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.user={id:e.operate_user,name:e.user_name,mobile:e.user_mobile},e.recipient_unit={id:e.recipient_unit,name:e.recipient_unit_name},e.photoRequirement=n;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e})));case 4:case"end":return e.stop()}}),e,this)}))),function(t){return a.apply(this,arguments)})},{key:"getTaskLogByStatus",value:function(e,a,i,n){var r=this;return b.a.getTaskByStatus(e,a,i,n).then((function(a){return r.getTaskCcList(e,"被抄送").then((function(e){return a.cc=t.map(e,(function(t){return{id:t.cc,name:t.cc_name,mobile:t.cc_mobile,is_im_user:t.is_im_user}})),a}))}))}},{key:"getTaskCcList",value:function(t,e){return g.a.getTaskCcList(t,e)}},{key:"getCurrentUserOperation",value:function(t){return b.a.getCurrentUserOperation(t)}},{key:"deleteLocalData",value:function(t){return b.a.deleteLocalData(t)}},{key:"uploadImages",value:function(e){var a=[];return t.each(e,(function(t){!t.url&&t.temp?a.push(d.a.uploadImage(t.temp).then((function(e){t.url=e,delete t.temp}))):delete t.temp,!t.videoUrl&&t.videoTemp?a.push(d.a.uploadImage(t.videoTemp).then((function(e){t.videoUrl=e,delete t.videoTemp}))):delete t.videoTemp})),Promise.all(a).then((function(){return e}))}},{key:"insertRemoteData",value:function(e){var a=[];return t.forIn(e,(function(t,e){var i={operation:"replace_insert",table:e,rows:t};a.push(i)})),console.log("insert",a),this.importData({result:a})}},{key:"importData",value:function(t){var e=o.a.appDataPath()+"temp/"+(s.a.uuid()+".json");return o.a.createFile(e,JSON.stringify(t)).then((function(){return o.a.importDataFromFile([e])})).finally((function(){return o.a.deleteFile(e)}))}}]),e}()}).call(this,a("391c"))},e46c:function(t,e,a){"use strict";var i=a("855c").a,n=(a("151e"),a("17cc")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t.backEmpty?t._e():[a("scroller",{ref:"scroller"},[a("item",{attrs:{mode:"edit",label:"退场时间",editabled:!0,text:t.backData.date},on:{click:t.selectBackDate}}),a("div",{staticClass:"picture"},[a("p",{staticClass:"title-name"},[t._v("相关照片")]),a("item-img-list",{attrs:{maxlength:50,"allow-multi-select":!0,"prepare-callback":function(){return t.prepareTakePicture(t.backData,"back","","")}},on:{callback:t.onSelectPic},model:{value:t.backData.image_file,callback:function(e){t.$set(t.backData,"image_file",e)},expression:"backData.image_file"}})],1),a("item-textarea",{staticClass:"border-tb",attrs:{placeholder:"补充说明"},on:{blur:function(e){t.onSave({remark:t.backData.remark})}},model:{value:t.backData.remark,callback:function(e){t.$set(t.backData,"remark",e)},expression:"backData.remark"}}),a("user-select",{attrs:{options:t.backData.userOptions,title:"退场操作人","before-select":t.beforeSelect,editabled:!1},on:{onSelect:t.changeBackChecker},model:{value:t.backData.backUser,callback:function(e){t.$set(t.backData,"backUser",e)},expression:"backData.backUser"}}),a("user-select",{attrs:{title:"抄送人",options:t.backData.ccOptions,multi:!0,required:!1},on:{onSelect:function(){return t.onSave({cc:t.backData.cc})}},model:{value:t.backData.cc,callback:function(e){t.$set(t.backData,"cc",e)},expression:"backData.cc"}})],1),a("app-button-group",[a("app-button",{on:{click:t.onSubmit}},[t._v(" 提交退场 ")])],1)],t.backEmpty?[a("loading-status",{attrs:{"is-empty":t.backEmpty,"empty-text":"暂无退场记录"}})]:t._e()],2)}),[],!1,null,"16e05848",null);e.a=r.exports},e60b:function(t,e,a){var i=a("cf0d");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("1be2b028",i,!0,{sourceMap:!1,shadowMode:!1})},e8e4:function(t,e,a){"use strict";a("163d");var i={name:"ProgressRound",props:{size:{type:[String,Number],default:24}},data:function(){return{girth:22*Math.PI}},computed:{barWidth:function(){return this.girth*(Number(this.progress)||0)/100},isWaiting:function(){return 0===(Number(this.progress)||0)}}},n=(a("9e8c"),a("17cc")),r=Object(n.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticClass:"convert",style:{width:this.size+"px",height:this.size+"px"},attrs:{t:"1597203904175",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{staticClass:"icon",attrs:{d:"M194.047757 125.823843l2.133331 0.170666a42.922613 42.922613 0 0 1 33.023959 21.119974l85.333226 147.797148a42.666613 42.666613 0 1 1-73.898574 42.666614L183.893103 239.231701A424.959469 424.959469 0 0 0 85.333227 511.99936c0 235.647705 191.018428 426.666133 426.666133 426.666133a426.3248 426.3248 0 0 0 165.589126-33.279958 42.666613 42.666613 0 0 1 33.151959 78.591902A508.586031 508.586031 0 0 1 511.99936 1023.99872C229.247713 1023.99872 0 794.751007 0 511.99936c0-143.786487 59.605259-278.058319 162.559797-374.271532 2.474664-2.346664 5.247993-4.437328 8.362656-6.229326l0.426666-0.255999a42.32528 42.32528 0 0 1 1.663998-0.853333l-2.090664 1.109332c1.706665-0.981332 3.413329-1.834664 5.16266-2.559997l1.194665-0.426666a36.394621 36.394621 0 0 1 3.498663-1.151998l1.365331-0.341333a32.981292 32.981292 0 0 1 3.839996-0.767999l0.511999-0.042667a38.655952 38.655952 0 0 1 7.55199-0.426666zM511.99936 0c282.751647 0 511.99936 229.247713 511.99936 511.99936a510.250029 510.250029 0 0 1-152.917142 364.97021 42.666613 42.666613 0 0 1-49.493272 7.509324 42.83728 42.83728 0 0 1-18.51731-17.194645l-85.333227-147.797148a42.666613 42.666613 0 0 1 73.898575-42.666614l56.575929 97.919878A424.703469 424.703469 0 0 0 938.665493 511.99936c0-235.647705-191.018428-426.666133-426.666133-426.666133-44.842611 0-88.746556 6.911991-130.474504 20.309308A42.666613 42.666613 0 0 1 355.412889 24.405303 511.700694 511.700694 0 0 1 511.99936 0z","p-id":"13796"}})])}),[],!1,null,"13aac6b6",null);e.a=r.exports},e9ea:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .guide-box[data-v-ff0679ce]{flex:1;display:flex}.zjapp .page-scroll[data-v-ff0679ce]{flex:1;overflow:auto;padding-bottom:100px;transform:translateZ(0)}.zjapp .sublist[data-v-ff0679ce]{padding-left:25px;padding-top:1px;background-color:#fff}.zjapp .sublist>.sublist[data-v-ff0679ce]{padding-left:10px;padding-top:0}",""])},eb78:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-16e05848]{display:flex;flex-direction:column;flex:1;padding-bottom:10px;height:100%;overflow:auto}.zjapp .content .picture[data-v-16e05848]{padding-left:15px;padding-bottom:15px;background-color:#fff}.zjapp .content .title-name[data-v-16e05848]{font-size:16px;padding:10px 0 10px 0}",""])},ec60:function(t,e,a){"use strict";a("3186")},eca2:function(t,e,a){"use strict";a("942a")},ee75:function(t,e,a){"use strict";a("1154")},ef1c:function(t,e,a){var i=a("e9ea");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("2e832052",i,!0,{sourceMap:!1,shadowMode:!1})},f1e4:function(t,e,a){"use strict";(function(t){a("5ab2"),a("e10e");var i=a("28f8"),n=(a("9dd9"),a("616f"),a("9e76"),a("ed63"),a("8cf2"),a("6d57"),a("9a33"),a("f548"),a("cc57"),a("4ad6")),r=a("e89f"),s=a("bcc7"),o=a("3122"),c=a("6e1b"),l=a("c130"),u=a("0636");function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"CheckGuideDetail",components:{},mixins:[r.a],data:function(){return{show:!1,isLoading:!0,isImageDownloading:!1,title:"",content:[],module:"",itemId:""}},methods:{openPopup:function(e){var a=this;for(var i in this.value=!0,this.show=!0,this.module=e.module,this.itemId=e.itemId,this.$emit("open"),e)this[i]=e[i];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module],this.isLoading=!0,("special-inspect"===this.module?c.a.getSpecialInspectCheckItemDetail(this.itemId):"templet-plan"===this.module?l.a.getTempletDetail(this.itemId):"material"===this.module?u.a.getMaterialDetail(this.itemId):s.a.getCheckItem(this.itemId,this.checkType)).then((function(e){console.log("checkitemData",e),e=e||{},a.checkitemData=e,a.title=e.full_name||e.name,"special-inspect"!==a.module&&"inspect"!==a.module&&"fly-inspect"!==a.module&&"material"!==a.module||(e.content=e.guideline||e.content);var i=e.content?e.content.trim():"",n="【------<REPLACE_SRT>-------】";i=(i=(i=(i=(i=(i=i.replace(/<\/p><p>/gm,"\n")).replace(/<p>/gm,"")).replace(/<\/p>/gm,"")).replace(/<br>/gm,"")).replace(/<br \/>/gm,"")).replace(/\n/gm,"".concat(n,"\n"));var r=/(<img[^\>]*>|<a[^>]*href=['"][^"]*['"][^>]*>.*?<\/a>)/gm;if(r.test(i)){var s=i.split(r);(s=s.filter((function(t){return!!t}))).forEach((function(t,e){t&&!/^\s*\n/.test(t)&&e&&!/\n\s*$/.test(s[e-1])&&(s[e]="\n"+t)})),i=s.join("")}var o=i?i.split("\n"):[],c=t.map(o,(function(t,e){if(t!==n&&!t.includes(n)){var a=o[e+1];a&&a===n&&(t+=n)}var i;if(/<img([\s\S]*)>/gm.test(t)){var r=t.split(/\ssrc="([^"]*)"/gm)[1],s=r?r.match(/[\w|-]{36}/gm)[0]:(new Date).getTime()+"-"+e;i={isImg:!0,isHref:!1,src:"",url:r,status:"pending",id:s,ready:!0}}else if(/<a.*<\/a>/gm.test(t)){var c=t.split(/href="([^"]*)".*>(.*)<\/a>/);i={isImg:!1,isHref:!0,val:c[2],url:c[1]}}else i={isImg:!1,isHref:!1,val:t};return i.val&&(i.joinBrToSplitLine=t!==n&&t.endsWith(n)),i}));a.content=[];for(var l=0;l<c.length;l++){var u=c[l];!(u.val===n)&&(u.val&&(u.val=u.val.replace(new RegExp("".concat(n),"gm"),"")),a.content.push(u))}a.downloadImage(),a.isLoading=!1})).catch((function(t){$log.log(t)}))},openHref:function(t){n.a.openUrl(t)},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},getThumbnail:function(t){return"pending"===t.status?o.a.IMAGE_LOADING:"rejected"===t.status?o.a.IMAGE_RELOAD:"dev"===APP_ENV?t.url:"fulfilled"===t.status?t.src:($log.log("检查指引-显示图片：",t),o.a.IMAGE_PLACEHOLD)},imgError:function(t,e){$log.error("检查指引-加载图片出现错误：",t);var a=p({},t);a.status="rejected",this.$set(this.content,e,a)},downloadImage:function(e){var a=this;e=e?[e]:this.imageList(),t.each(e,(function(e){var i=p({},e),n=t.map(a.content,(function(t){return t.id})).indexOf(e.id);o.a.isNeedDownload(e.url).then((function(t){t?o.a.download(e.url).then((function(t){i.status="fulfilled",i.src=o.a.fixUrl(t),a.$set(a.content,n,i)})).catch((function(t){$log.error("检查指引-下载图片：",t)})):(i.status="fulfilled",i.src=o.a.fixUrl(o.a.getPathFromUrl(e.url)),a.$set(a.content,n,i))}))}))},imageList:function(){return t.filter(this.content,(function(t){return t.isImg}))},imgClick:function(e){var a=this;if("pending"===e.status)return!1;if("rejected"===e.status)return this.downloadImage(e),$log.log("检查指引-点击重新加载-重新下载图片：",e),!1;var i=this.imageList(),r=t.map(i,(function(t){return t.id})).indexOf(e.id);i=t.map(i,(function(t){return a.getThumbnail(t)})),n.a.openImageBrowser(i,r)}}}}).call(this,a("391c"))},f369:function(t,e,a){"use strict";var i=a("fd50"),n=a("bcc7"),r=a("329b"),s=a("d1d1").a,o=(a("3411"),a("17cc")),c={name:"CheckGuideList",components:{GuideList:Object(o.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"guide-box"},[!t.isLoading&&t.listData.length?a("div",{staticClass:"page-scroll"},t._l(t.listData,(function(e,i){return a("div",{key:i},[a("item",{attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){t.clickItem(e)}}},[a("div",{staticClass:"item-text fw-b color-blue one-line"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,i){return a("div",{key:i,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){t.clickItem(e)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,i){return a("div",{key:i,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){t.clickItem(e)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,i){return a("div",{key:i,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){t.clickItem(e)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])])],1)})):t._e()],2)})):t._e()],2)})):t._e()],2)}))):t._e(),a("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.listData.length,"empty-text":"没有检查项"}})],1)}),[],!1,null,"ff0679ce",null).exports},mixins:[a("e89f").a],data:function(){return{show:!1}},methods:{openPopup:function(t){var e=this;this.value=!0,this.show=!0,this.$nextTick((function(){e.$refs["guide-list"].init(t),e.$emit("open")}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")}}},l=Object(o.a)(c,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"slide-right"}},[this.show?e("page-content",{attrs:{mode:"dialog",title:"检查指引","on-close":this.closePopup}},[e("guide-list",{ref:"guide-list"})],1):this._e()],1)}),[],!1,null,null,null).exports,u=!1;u||(u=new(r.default.extend(l))({el:document.createElement("div")}),document.body.appendChild(u.$el));var d=u,p=a("515e"),h=a("91c1").a,f=(a("dc98"),Object(o.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{staticClass:"main",style:{top:t.contentTop+"px"}},[a("i",{staticClass:"arrow"}),a("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePopup(e)}}},[a("transition",{attrs:{name:"slide-down"},on:{enter:function(e){t.isOpening=!0},"after-enter":function(e){t.isOpening=!1},leave:function(e){t.isClosing=!0},"after-leave":t.afterClose}},[t.showList?a("div",{staticClass:"box",style:{height:t.listHeight+"px"}},t._l(t.data,(function(e,i){return a("div",{key:i,class:{"border-bottom":t.data.length>1,"box-single":1===t.data.length}},[a("div",{staticClass:"detail-hd",class:{"border-bottom":t.data.length<=1,"detail-hd-single":t.data.length<=1},on:{click:function(a){t.toggleItem(e)}}},[t.data.length>1?a("i",{class:{"detail-arrow-right":!e.isOpen,"detail-arrow-down":e.isOpen}}):t._e(),a("div",{staticClass:"detail-title"},[t._v(t._s(e.name))])]),t.data.length<=1||e.isOpen?a("div",{staticClass:"detail-bd",class:{"detail-bd-single":t.data.length<=1}},[t._l(e.textArr,(function(e,i){return a("p",{key:i,staticClass:"text-line"},[t._v("\n              "+t._s(e)+"\n            ")])})),a("item-img-list",{attrs:{editabled:!1},model:{value:e.contentImage,callback:function(a){t.$set(e,"contentImage",a)},expression:"item.contentImage"}}),a("loading-status",{attrs:{"is-empty":!e.textArr.length&&!e.contentImage.length,"empty-text":"PC端未设置检查指引"}})],2):t._e()])}))):t._e()])],1)]):t._e()}),[],!1,null,"2cac8864",null).exports),m=!1;m||(m=new(r.default.extend(f))({el:document.createElement("div")}),document.body.appendChild(m.$el));var g=m,b={name:"CheckGuide",components:{},props:{module:{type:String,default:""},mode:{type:String,default:"page"},itemId:{type:String,default:""},itemIds:{type:Array,default:function(){return[]}},batchId:{type:String,default:""},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}},optionsPromise:{type:Function,default:function(){}},beforeOpen:{type:Function,default:function(){}}},data:function(){return{isLoading:!1}},methods:{openCheckGuide:function(){var t=this,e=this.beforeOpen&&this.beforeOpen();e instanceof Promise||(e=Promise.resolve(e)),e.then((function(e){!1!==e&&("drop"===t.mode?g.openPopup({itemIds:t.itemIds,el:t.$refs["check-guide-btn"],options:t.options}):("templet-plan"===t.module?i.a.when(!1):t.itemId&&t.sectionId?n.a.hasChildSectionCheckItem(t.itemId,t.sectionId):t.itemId?n.a.hasChildCheckItem(t.itemId):i.a.when(!0)).then((function(e){e?d.openPopup({module:t.module,itemId:t.itemId,batchId:t.batchId,sectionId:t.sectionId,options:t.options}):p.a.openPopup({itemId:t.itemId,module:t.module})})))}))}}},v=Object(o.a)(b,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"check-guide-btn",staticClass:"header-btn",on:{click:function(e){t.openCheckGuide()}}},[a("icon",{attrs:{name:"nav-info"}})],1)}),[],!1,null,null,null);e.a=v.exports},f3d7:function(t,e,a){"use strict";a("9120")},f44c:function(t,e,a){"use strict";a("d406")},f53a:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .number-keyboard-con[data-v-6337f428]{position:absolute;left:0;bottom:0;width:100%;padding:4px 0;background-color:#fafafa;box-shadow:0 -4px 8px 0 rgba(0,0,0,.08);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.zjapp .ios-bezel-less[data-v-6337f428]{padding-bottom:34px}.zjapp .keyboard-row[data-v-6337f428],.zjapp .keys-row[data-v-6337f428]{display:flex}.zjapp .row-span-1[data-v-6337f428]{flex:1}.zjapp .row-span-2[data-v-6337f428]{flex:2}.zjapp .row-span-3[data-v-6337f428]{flex:3}.zjapp .keys[data-v-6337f428]{flex:1;height:48px;line-height:48px;text-align:center;font-size:18px;margin:4px;border:1px solid rgba(5,5,5,.07);border-radius:8px;background-color:#fff;padding:0}.zjapp .keys-next[data-v-6337f428],.zjapp .keys-prev[data-v-6337f428]{font-size:14px;color:#4275e8}.zjapp .keys-ok[data-v-6337f428]{font-size:14px;color:#999}.zjapp .keys-delete[data-v-6337f428]{color:#999}.zjapp .icon[data-v-6337f428]{pointer-events:none}.zjapp .icon-keyboard-close[data-v-6337f428]{font-size:20px;color:#999}.zjapp .icon-keyboard-delete[data-v-6337f428]{vertical-align:top;margin-top:13px;font-size:14px;color:#333}.zjapp .activing[data-v-6337f428]{background-color:#ececec}.zjapp .disabled[data-v-6337f428]{color:#999}.zjapp .col[data-v-6337f428]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:104px;line-height:36px}",""])},f5bd:function(t,e,a){"use strict";a("6a61");var i,n=a("2e91"),r=a("46ae"),s=(a("e2a7"),a("9094")),o=a("e89f"),c=a("24de"),l="没有相关合同",u="当前无网络",d={name:"MaterialTaskContract",components:{SlideUpSelect:r.a},mixins:[o.a],props:{value:{type:Object,default:function(){return{}}}},data:function(){return{emptyText:l,list:[]}},computed:{proj_id:function(){return this.$store.state.global.currentProject.id}},created:function(){this.init()},activated:function(){this.init()},methods:{init:function(){this.contractList(),this.emptyText=l},contractList:(i=Object(n.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.checkHasNetwork(!0);case 3:return t.next=5,Object(s.a)({proj_id:this.proj_id});case 5:e=(e=t.sent).map((function(t){return{id:t.contract_id,name:t.contract_name}})),this.list=e,$log.log("材料验收-查询合同列表"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),t.t0&&t.t0.noNetwork&&(this.emptyText=u),$log.error("材料验收-获取合同列表-error->",t.t0);case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return i.apply(this,arguments)}),onSelect:function(t){this.$emit("onSelect",t)}}},p=a("17cc"),h=Object(p.a)(d,(function(){var t=this.$createElement;return(this._self._c||t)("slide-up-select",{attrs:{value:this.value,title:"所属合同",options:this.list,"empty-text":this.emptyText,"allow-search":!0,"init-height":500,"history-key":"material-task-contract"},on:{onSelect:this.onSelect}})}),[],!1,null,null,null);e.a=h.exports},f6e3:function(t,e,a){var i=a("53bf");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("d3b0c900",i,!0,{sourceMap:!1,shadowMode:!1})},f711:function(t,e,a){"use strict";var i=a("3c64"),n=a("e2a7"),r=a("04f3"),s={name:"MaterialTaskVoidDialog",components:{ItemTextarea:i.a},data:function(){return{show:!1,reason:"",backButtonEvent:null}},activated:function(){this.show=!1},methods:{open:function(){this.reason="",this.backButtonEvent||(this.backButtonEvent=Object(r.a)(this.close))},close:function(t){this.show=!1,this.backButtonEvent&&(Object(r.c)(this.backButtonEvent),this.backButtonEvent=null)},beforeClose:function(t,e){if("cancel"!==t){var a=this.reason.trim();if(!a||a.length<=0)return n.a.alert("请输入作废原因"),void e(!1);this.$emit("submit",a,e)}else e()}}},o=(a("a63e"),a("17cc")),c=Object(o.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-dialog",{attrs:{"show-cancel-button":"","get-container":"body","class-name":"dialog-customize task-void-dialog","before-close":t.beforeClose},on:{open:t.open,close:t.close},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",[a("item-textarea",{ref:"textarea-supplier",staticClass:"text-area-border",attrs:{placeholder:"请输入作废原因",maxlength:50},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}})],1)])],1)}),[],!1,null,"918e1df2",null);e.a=c.exports},fee3:function(t,e,a){"use strict";a("5ab2"),a("6d57"),a("e10e"),a("cc57");var i=a("28f8"),n=a("e2a7"),r=a("3c64"),s=a("5a71");function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var l={name:"MaterialTaskSupplier",components:{ItemTextarea:r.a,SingleSelect:s.default},props:{value:{type:Object,default:function(){}},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}}},data:function(){return{selected:{},showSupplier:!1,supplierData:{}}},watch:{value:function(t){this.selected=t}},mounted:function(){this.value&&(this.selected=this.value)},methods:{showSupplierDialog:function(t){var e=this;t.stopPropagation?(t.stopPropagation(),this.supplierData=c({},this.selected)):this.resetSupplierData(),this.showSupplier=!0,setTimeout((function(){e.$refs["textarea-supplier"].$refs.input.focus()}),50)},checkSectionIsAvailable:function(){if(!this.sectionId)return n.a.alert("请先选择标段"),!1},supplierSubmit:function(t,e){var a=this;if("confirm"===t){var i=this.supplierData.name=this.supplierData.name.trim();if(i.length<1)return e(!1);this.options.some((function(t){if(t.name===i)return a.supplierData.id=t.id,!0})),this.selected=c({},this.supplierData),this.$refs.singleSelectDialog.closePopup(),e()}else this.resetSupplierData(),e();this.changeSelected(this.selected)},resetSupplierData:function(){this.supplierData={id:"-1",name:""}},changeSelected:function(t){this.selected=t,this.$emit("input",t)}}},u=(a("9e20"),a("ee75"),a("17cc")),d=Object(u.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("single-select",{ref:"singleSelectDialog",attrs:{options:t.options,"before-open":t.checkSectionIsAvailable,"right-btn":"手工添加","editor-add-data":!0,title:"材料供应商"},on:{rightBtnEvent:t.showSupplierDialog,onSelect:t.changeSelected},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),a("van-dialog",{attrs:{"show-cancel-button":"","get-container":"body","cancel-button-color":"#666","class-name":"custom-material-dialog","before-close":t.supplierSubmit},model:{value:t.showSupplier,callback:function(e){t.showSupplier=e},expression:"showSupplier"}},[a("div",[a("item-textarea",{ref:"textarea-supplier",staticClass:"text-area-border",attrs:{placeholder:"请输入材料供应商名称",maxlength:20},model:{value:t.supplierData.name,callback:function(e){t.$set(t.supplierData,"name",e)},expression:"supplierData.name"}})],1)])],1)}),[],!1,null,null,null);e.a=d.exports}}]);