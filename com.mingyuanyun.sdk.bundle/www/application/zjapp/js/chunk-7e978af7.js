(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-7e978af7","chunk-0b5b35be","chunk-59fa3e5d","chunk-3adbbd26","chunk-2d0d2f53","chunk-2709989a"],{"0416":function(t,e,i){"use strict";i("068e")},"068e":function(t,e,i){var n=i("771c");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("1ce02ce6",n,!0,{sourceMap:!1,shadowMode:!1})},"0732":function(t,e,i){var n=i("81f2");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("1b5b07de",n,!0,{sourceMap:!1,shadowMode:!1})},"0aac":function(t,e,i){"use strict";i("2814")},"0c52":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .app-stepper[data-v-03df57b7]{display:inline-block;width:110px;height:34px;margin:-2px 0;white-space:nowrap;font-size:0;line-height:0;vertical-align:top}.zjapp .app-stepper .number-input[data-v-03df57b7]{width:51px;height:34px;border:1px solid #dcdcdc;border-radius:0;font-size:14px;text-align:center;background-color:#fff;color:#111;box-sizing:border-box}.zjapp .app-stepper .number-input-focus[data-v-03df57b7]{border-color:#4275e8}.zjapp .btn-add[data-v-03df57b7],.zjapp .btn-minus[data-v-03df57b7]{display:inline-block;width:28px;height:34px;line-height:34px;padding:0;border:1px solid #dcdcdc;color:#666;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:border-box;background-color:#fff}.zjapp .btn-minus[data-v-03df57b7]{border-right:none;border-radius:4px 0 0 4px}.zjapp .btn-add[data-v-03df57b7]{border-left:none;border-radius:0 4px 4px 0}.zjapp .icon-add[data-v-03df57b7],.zjapp .icon-minus[data-v-03df57b7]{font-size:11px;vertical-align:top;display:inline-block;margin-top:10.5px}.zjapp .disabled[data-v-03df57b7]{color:#c8c8c8}.zjapp .activing[data-v-03df57b7]{color:#4275e8}",""])},"0f7b":function(t,e,i){"use strict";i("f548"),i("163d");var n,a,r={name:"AppStepper",components:{NumberInput:i("6948").a},props:{value:{type:[String,Number],default:""},max:{type:[String,Number],default:200},range:{type:Array}},data:function(){return{addActiving:!1,minusActiving:!1}},computed:{rangeMin:function(){return this.range&&this.range[0]||0},rangeMax:function(){return this.range&&this.range[1]?this.range[1]:this.max},allowAdd:function(){return""!==this.value&&this.value<this.rangeMax},allowMinus:function(){return""!==this.value&&this.value>this.rangeMin}},methods:{onChange:function(t){t&&(t=String(t).replace(/\D/g,"")),parseInt(t,10)>parseInt(this.max,10)&&(t=this.max),this.$emit("input",Number(t)),this.$emit("change",Number(t))},add:function(){if(this.allowAdd){var t=parseInt(this.value,10)+1;this.isInRange(t)&&(this.$emit("input",t),this.$emit("change",t)),this.setActiving("add")}},minus:function(){if(this.allowMinus){var t=parseInt(this.value,10)-1;this.isInRange(t)&&(this.$emit("input",t),this.$emit("change",t)),this.setActiving("minus")}},isInRange:function(t){return t>=this.rangeMin&&t<=this.rangeMax},setActiving:function(t){var e=this;t&&("minus"===t?(this.minusActiving=!0,clearTimeout(a),a=setTimeout((function(){e.minusActiving=!1}),300)):(this.addActiving=!0,clearTimeout(n),n=setTimeout((function(){e.addActiving=!1}),300)))}}},o=(i("91cb"),i("17cc")),s=Object(o.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-stepper"},[i("button",{staticClass:"btn-minus",class:{disabled:!t.allowMinus,activing:t.minusActiving},on:{click:t.minus}},[i("icon",{attrs:{name:"minus"}})],1),i("number-input",{attrs:{value:t.value,type:"int",range:t.range},on:{input:t.onChange}}),i("button",{staticClass:"btn-add",class:{disabled:!t.allowAdd,activing:t.addActiving},on:{click:t.add}},[i("icon",{attrs:{name:"add"}})],1)],1)}),[],!1,null,"03df57b7",null);e.a=s.exports},1059:function(t,e,i){"use strict";var n=i("ebf1").a,a=(i("9dea"),i("17cc")),r=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"redio-box-group",class:"align-"+t.align+" "+t.customClass},t._l(t.options,(function(e,n){return i("span",{key:n,staticClass:"radio-box",class:{selected:"array"===t.optionsType?t.value===e:"object"===t.optionsType&&t.value===n},on:{click:function(e){t.onSelect(n)}}},[t._v("\n    "+t._s(e)+"\n  ")])})))}),[],!1,null,"b0a30924",null);e.a=r.exports},"114f":function(t,e,i){"use strict";(function(t){i("5ab2"),i("e10e"),i("6d57"),i("e697"),i("cc57"),i("163d");var n=i("28f8"),a=i("8693"),r=i("5b5e"),o=i("06f6"),s=i("242b"),c=i("6144"),l=i("3bd5"),u=i("3122"),d=i("2a15"),p=(i("3516"),i("6e1b"));function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var m=l.a.getUser();e.a={defaultPlaceKey:"special-inspect-prolbem-pure-default-place",getProblemData:function(e){return r.a.getCheckProblemInfo(e).then((function(e){return f(f({},e),{},{id:e.id,status:e.status,proj_id:e.proj_id,place:{building_id:e.building_id,unit_id:e.unit,floor:e.floor,room_id:e.room_id,full_name:e.place},bidsection_id:e.bidsection_id,batch_id:e.batch_id,batch_type:e.batch_type,created_by:e.created_by,checkItem:{id:e.item_id,name:e.item_name,full_name:e.item_full_name,parentId:e.item_parent_id},description:{id:e.desc_id,name:e.desc},image_file:JSON.parse(e.image_file||"[]"),remark:e.remark,repair_requirements:e.repair_requirements,level:e.emergency_degree||"一般",deadline:void 0===e.deadline||null===e.deadline?7:Number(e.deadline),building_id:e.building_id,unit:e.unit,floor:e.floor,room_id:e.room_id,place_point:JSON.parse(e.problem_values||"[]"),drawing_file:JSON.parse(e.drawing_file||"[]"),repair_set:e.repair_set,process_mode:e.process_mode,repair:e.repair&&e.repair.id?f({},e.repair):e.repair_set&&e.repair_set.id?f({},e.repair_set):{},repair_image_file:JSON.parse(e.repair_image_file||"[]"),contractor:{id:e.contractor_id,name:e.contractor_name},reinspect_set:e.reinspect_set,cc_set:e.cc_set_array||[],sent_back:e.sent_back&&e.sent_back.id?f({},e.sent_back):{},sent_back_image_file:JSON.parse(e.sent_back_image_file||"[]"),regist:{id:e.regist.id,name:e.regist.name,mobile:e.regist.mobile,is_im_user:e.regist.is_im_user},currentReinspectBy:t.find(t.clone(e.reinspectBy),(function(t){return t.id===l.a.getUser().user_id}))||{reinspect_image_file:[],reinspect_remark:""}})})).then((function(t){var e=t&&t.biz_id||"";return e?a.a.getSpecialInspectData(e).then((function(e){return t.checkItem={id:e.checkitem_id,name:e.checkitem_name,full_name:e.checkitem_full_name,parentId:e.checkitem_parent_id},t.specialInspectId=e.id,t})):t})).then((function(t){return p.a.getBatchDetailAndCheckers(t.batch_id).then((function(e){return t.batchDetail=e,t}))})).catch((function(t){console.error(t)}))},createNewData:function(t,e){var i=this;return Promise.resolve().then((function(){return t?e?a.a.getPlaceSpecialInspectData(t,e):a.a.getSpecialInspectCheckItemDetail(t):Promise.reject(new Error("专项巡检，创建问题，缺少 specialInspectId"))})).then((function(t){return Promise.resolve().then((function(){if(e)return a.a.getBatchPlace(e).then((function(t){if(t.building_id)return{building_id:t.building_id,unit_id:t.unit,floor:t.floor,room_id:t.room_id,full_name:t.name}}))})).then((function(e){return t.defaultPlace=e||c.a.getObject(i.defaultPlaceKey,c.a.level.user)||{},t}))})).then((function(e){return{status:"",proj_id:e.proj_id,place:e.defaultPlace||{},batch_id:e.batch_id,batch_type:"专项巡检",checkItem:{id:e.item_id||e.checkitem_id,name:e.item_name||e.checkitem_name,full_name:e.full_name||e.checkitem_full_name},description:{},image_file:[],remark:"",level:"一般",deadline:7,repair_set:{},contractor:{},cc_set:[],reinspect_set:[],bidsection_id:"",building_id:e.defaultPlace&&e.defaultPlace.building_id||"",unit:e.defaultPlace&&e.defaultPlace.unit_id||"",floor:e.defaultPlace&&e.defaultPlace.floor||"",room_id:e.defaultPlace&&e.defaultPlace.room_id||"",place_point:[],deduction:1,redline_deduction:0,biz_id:t,biz_children_id:e.id,created_by:m.user_id,checkitem_extension:JSON.parse(e.checkitem_extension||"{}")}}))},getDiagram:function(t){return Promise.resolve().then((function(){if(t){var e=t.building_id,i=t.unit_id,n=t.floor,a=t.room_id;return a?o.default.getRoomTypeDiagram(a):i&&n?s.a.getDiagram(e,i,n,1):n?s.a.getDiagram(e,"",n,2):void 0}}))},getProblemList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return t=Array.isArray(t)?t:[t],Promise.resolve().then((function(){return a.a.getProblemList(t,e)})).then((function(t){return(t||[]).forEach((function(t){t.thumbnail=u.a.getDefaultThumbnailFromList(t.image_file,"专项巡检"),"检查完毕"===t.status&&(t.status="已提交")})),t}))},getBatchProblemList:function(t){var e=this;return Promise.resolve().then((function(){return a.a.getAllProblemIncloudRootSpecialInspectIds(t)})).then((function(t){var i=(t||[]).map((function(t){return t.id}));return e.getProblemList(i)}))},getPlaceProblemList:function(t){var e=this;return a.a.getMode11SpecilInspectByPlaceId(t).then((function(i){var n=(i||[]).map((function(t){return t.special_inspect_id}));return e.getProblemList(n,t)}))},deleteBatchDraftProblem:function(t){return d.a.deleteBatchDraftProblem(t)}}}).call(this,i("391c"))},1405:function(t,e,i){"use strict";i("6d57"),i("e10e");var n=i("07d2"),a=i("c726"),r=i("4e84"),o={name:"PlaceSelect",components:{Item:n.default},props:{title:{type:String},dialogTitle:{type:String},mode:{type:String,default:"edit"},items:{type:Array},selected:{type:Object},selectedText:{type:String},projectId:{type:String},sectionId:{type:String},beforeConfirm:{type:Function},ifHasDataShow:{type:Boolean}},data:function(){return{show:!this.ifHasDataShow}},computed:{hasSelected:function(){return this.selected&&Object.keys(this.selected).length}},created:function(){var t=this;this.$watch((function(){return t.projectId+t.sectionId}),this.checkHasData,{immediate:!0})},methods:{open:function(){var t=this;a.a.open({title:this.dialogTitle||"选择检查部位",items:this.items,projectId:this.projectId,sectionId:this.sectionId,selected:this.selected,beforeConfirm:this.beforeConfirm,callback:function(e){t.$emit("onSelect",e)}})},close:function(){a.a.close()},checkHasData:function(){var t=this;if(this.ifHasDataShow)return Promise.resolve().then((function(){var e=t.items?t.items[0]:"building";return"section"===e&&t.projectId?r.a.getSections(t.projectId):"building"===e&&t.sectionId?r.a.getBuildingsBySection(t.sectionId):"building"===e&&t.projectId?r.a.getBuildingsByProject(t.projectId):void 0})).then((function(e){t.show=!t.ifHasDataShow||e&&!!e.length}))}}},s=i("17cc"),c=Object(s.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("item",{attrs:{label:t.title,text:t.hasSelected?t.selectedText:"",mode:t.mode,editabled:!0},on:{click:t.open}},[t.$slots.title?t._t("title",null,{slot:"left"}):t._e()],2):t._e()}),[],!1,null,null,null);e.a=c.exports},"19a7":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .redio-box-group[data-v-b0a30924]{font-size:0;margin-top:-10px}.zjapp .redio-box-group.align-l[data-v-b0a30924]{text-align:left}.zjapp .redio-box-group.align-r[data-v-b0a30924]{text-align:right}.zjapp .radio-box[data-v-b0a30924]{display:inline-block;height:34px;line-height:32px;min-width:60px;padding:0 5px;margin:10px 0 0 10px;border:1px solid #d9d9d9;background:#fff;color:#666;vertical-align:top;font-size:14px;text-align:center;border-radius:3px}.zjapp .radio-box[data-v-b0a30924]:first-child{margin-left:0}.zjapp .radio-box.selected[data-v-b0a30924]{border-color:#4275e8;color:#4275e8}",""])},2814:function(t,e,i){var n=i("5033");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("9db19832",n,!0,{sourceMap:!1,shadowMode:!1})},"29be":function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e");var n=i("28f8"),a=(i("cc57"),i("163d"),i("07d2")),r=i("a5c6"),o=i("6144");function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"SingleSelect",components:{Item:a.default},props:{title:{type:String,default:""},border:{type:String,default:""},pageTitle:{type:String,default:""},placeholder:{type:String,default:""},value:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},optionsDisabled:{type:Array,default:function(){return[]}},required:{type:Boolean,default:!0},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},beforeOpen:{type:Function,default:function(){}},searchBar:{type:Boolean,default:!0},grouping:{type:String,default:""},autoOpen:{type:Boolean,default:!1},rightBtn:{type:String,default:""},rightBtnEvent:{type:Function,default:function(){return 0}},ifToggle:{type:Boolean,default:!1},formCheck:{type:Boolean,default:!1},editorAddData:{type:Boolean,default:!1},lineLimit:{type:[Number,String],default:1}},data:function(){return{memoryKey:this.$route.name+encodeURI(this.title)}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var e=this;if(this.editabled){var i=this.beforeOpen();i&&i.then&&t.isFunction(i.then)?i.then((function(t){!1!==t&&e.openPopup()})):!1!==i&&this.openPopup()}},openPopup:function(){var e=this;if(this.optionsDisabled&&this.optionsDisabled.length){var i={};t.each(this.optionsDisabled,(function(t){t.id&&(i[t.id]=t)})),t.each(this.options,(function(t,n){i[t.id]?e.options[n].disabled=!0:e.options[n].disabled=!1}))}r.a.openPopup({title:this.pageTitle||"选择"+this.title,selected:this.value,options:this.options,required:this.required,searchBar:this.searchBar,grouping:this.grouping,autoOpen:this.autoOpen,rightBtn:this.rightBtn,ifToggle:this.ifToggle,lineLimit:this.lineLimit,editorAddData:this.editorAddData,onSelect:function(i){var n=t.cloneDeep(e.value);i=t.isArray(i)?t.map(i,(function(t){return c({},t)})):c({},i),e.$emit("input",i,n),e.$emit("onSelect",i,n)},rightBtnEvent:function(i){var n=t.cloneDeep(e.value);e.$emit("rightBtnEvent",i,n)}})},closePopup:function(){r.a.closePopup()},onSelect:function(t){o.a.saveObject(this.memoryKey,t,o.a.level.user),this.$emit("input",t[0]),this.$emit("onSelect",t[0])},setSelected:function(){var e=o.a.getObject(this.memoryKey,o.a.level.user);!1===this.editabled||t.isEmpty(this.options)||(t.isEmpty(this.value)?this.memory&&!t.isEmpty(e)&&t.some(this.options,{id:e.id})&&(this.$emit("input",e),this.autoSelect&&this.$emit("onSelect",e)):this.autoSelect&&this.$emit("onSelect",this.value))}}}}).call(this,i("391c"))},"2a15":function(t,e,i){"use strict";var n=i("fc9f");e.a={deleteBatchDraftProblem:function(t){return n.a.executeSql("delete from checkquality_problem where batch_id = ? and status = '草稿'",[t])}}},"2c76":function(t,e,i){"use strict";i("c070")},"2dd6":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .single-item[data-v-6920dde7]{min-height:44px}.zjapp .single-item>div[data-v-6920dde7]{display:flex}.zjapp .single-item>div>span[data-v-6920dde7]{flex:1;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical}.zjapp .single-item>div>span[data-v-6920dde7] label{color:#4174e9}.zjapp .single-item i[data-v-6920dde7]{line-height:24px;font-size:24px;color:#4275e8}.zjapp .single-item .disabled-item[data-v-6920dde7]{color:#aaa}",""])},"2ddb":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .supplier-editor[data-v-e465319c]{margin-bottom:10px;padding:8px;display:flex;justify-content:space-between;align-items:center;height:52px;color:#4275e8;background-color:#fff}.zjapp .supplier-editor .icon[data-v-e465319c]{border-left:1px solid #c8c8c8;padding-left:12px}.zjapp .supplier-editor .icon-edit[data-v-e465319c]{color:#c8c8c8;font-size:18px}.zjapp .supplier-editor .icon-qualified[data-v-e465319c]{color:#4275e8}.zjapp .supplier-editor .margin-r[data-v-e465319c]{margin-right:10px}.zjapp .list-title[data-v-e465319c]{position:relative;top:0;color:#888;font-size:14px;line-height:30px;min-height:40px;margin-bottom:0;margin-top:0;padding:8px 16px 2px}.zjapp .search-item>div[data-v-e465319c]{padding-right:35px}.zjapp .search-item i[data-v-e465319c]{position:absolute;color:#ccc;font-size:26px;right:0;top:50%;transform:translateY(-50%)}.zjapp .van-popup--right[data-v-e465319c]{width:100%;height:100%}[data-v-e465319c] .van-cell__title{color:#4174e9;font-weight:700}[data-v-e465319c] .van-collapse-item__content{transform:translateZ(0);padding:0 0 0 25px}[data-v-e465319c] .van-collapse-item__content .van-cell{padding-left:0}",""])},"2e80":function(t,e,i){var n=i("9e2b");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("3ccc3358",n,!0,{sourceMap:!1,shadowMode:!1})},"3156b":function(t,e,i){"use strict";i("163d");var n={name:"SingleSelectItem",props:{item:{type:Object,default:function(){return{id:"",name:""}}},checked:{type:Boolean,default:!1},renderField:{type:String,default:"name"},lineLimit:{type:[Number,String],default:1}},methods:{selectItem:function(t){t.disabled||this.$emit("click",t)}}},a=(i("9788"),i("17cc")),r=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("van-cell",{staticClass:"single-item",attrs:{clickable:!0},on:{click:function(e){t.selectItem(t.item)}}},[i("span",{class:{"disabled-item":t.item.disabled},style:{"-webkit-line-clamp":"unlimited"===t.lineLimit?"initial":t.lineLimit},domProps:{innerHTML:t._s(t.item[t.renderField])}}),t.checked?i("van-icon",{attrs:{name:"success"}}):t._e()],1)}),[],!1,null,"6920dde7",null);e.a=r.exports},3411:function(t,e,i){"use strict";i("ef1c")},"3c64":function(t,e,i){"use strict";i("163d");var n={name:"ItemTextarea",components:{},props:{value:{type:String,default:""},placeholder:{type:String,default:""},maxlength:{type:Number,default:200},borderBottom:{type:Boolean,default:!0}},data:function(){return{textareaHeight:40,isLock:!1,blurTime:null}},computed:{lastLength:function(){var t=this.value&&this.value.length||0,e=this.maxlength-t;return e>0?e:0}},mounted:function(){var t=this;this.$nextTick((function(){t.textareaHeight=t.$refs.rule&&t.$refs.rule.offsetHeight||40}))},methods:{onfocus:function(){var t=(new Date).getTime();this.blurTime&&t-this.blurTime<300&&window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(this.$refs.input.blur(),window.cordova.plugins.Keyboard.close()),this.blurTime=null,this.$emit("focus")},onblur:function(){this.blurTime=(new Date).getTime(),this.$emit("blur")},setStatus:function(t){console.log(t),this.isLock=t},oninput:function(t){var e=this;setTimeout((function(){if(!e.isLock){var i=t.target.value;i.length>e.maxlength&&(i=i.substring(0,e.maxlength),e.$refs.input.value=i),e.$refs.rule.innerText=i,e.textareaHeight=e.$refs.rule&&e.$refs.rule.offsetHeight+20,e.$emit("input",i),e.$emit("change",i)}}),0)}}},a=(i("2c76"),i("17cc")),r=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item-textarea",class:{"border-bottom":t.borderBottom}},[i("div",{staticClass:"item-textarea-content"},[i("textarea",{ref:"input",style:{height:t.textareaHeight+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.value},on:{focus:t.onfocus,blur:t.onblur,compositionstart:function(e){t.setStatus(!0)},compositionend:function(e){t.setStatus(!1)},input:t.oninput}}),i("div",{ref:"rule",staticClass:"rule"},[t._v("\n      "+t._s(t.value)+"\n    ")]),t.maxlength!==1/0?i("p",{staticClass:"counter"},[t._v("\n      "+t._s(t.lastLength)+"\n    ")]):t._e()])])}),[],!1,null,null,null);e.a=r.exports},"3e1e":function(t,e,i){"use strict";i("2e80")},"4e84":function(t,e,i){"use strict";i("5ab2"),i("6d57"),i("e10e");var n=i("28f8"),a=(i("cc57"),i("fc9f")),r=function(t){var e="select * from section \n      where proj_id = '".concat(t,"' \n      order by name");return a.a.query(e)},o=function(t){var e="select b.*, sb.section_id from building b\n      join section_building sb on b.id = sb.building_id\n      where b.proj_id = '".concat(t,"' \n      order by b.sort, b.code");return a.a.query(e)},s=function(t){var e="select b.* from section_building sb \n      left join building b on sb.building_id = b.id \n      where sb.section_id = '".concat(t,"' \n      order by b.sort, b.code");return a.a.query(e)},c=function(t){var e="select * from build_unit \n      where building_id = '".concat(t,"'\n      order by sort");return a.a.query(e)},l=function(t){var e="select * from building_floor \n      where building_id = '".concat(t,"' \n      order by sort");return a.a.query(e)},u=function(t,e,i){var n=e?" and unit = '".concat(e,"' "):"",r="select * from room where \n      building_id = '".concat(t,"' and floor = '").concat(i,"' ").concat(n," \n      order by sort");return a.a.query(r)},d=i("7cb8");function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={getSections:function(t){return r(t)},getBuildingsByProject:function(t){return o(t)},getBuildingsBySection:function(t){return s(t)},getUnits:function(t){return c(t).then((function(t){return((t=t.filter((function(t){return!!t.name})))||[]).map((function(t){return h(h({},t),{},{id:t.name,name:Object(d.a)(t.name,"单元")})}))}))},getFloors:function(t){return l(t).then((function(t){return(t||[]).map((function(t){return h(h({},t),{},{id:t.floor,name:Object(d.a)(t.floor,"层")})}))}))},getRooms:function(t,e,i){return u(t,e,i).then((function(t){return(t||[]).map((function(t){return h(h({},t),{},{name:t.room_no})}))}))}}},5033:function(t,e,i){var n=i("5454");(t.exports=i("690e")(!1)).push([t.i,".zjapp .drawing-con[data-v-fba5990a]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;font-size:0;line-height:0}.zjapp .drawing-con canvas[data-v-fba5990a]{display:block;height:100%;width:100%;background:url("+n(i("eb66"))+") #fff;background-size:4px 4px}.zjapp .loading-text[data-v-fba5990a]{margin-top:15px;color:#aaa}.zjapp .error-text[data-v-fba5990a],.zjapp .loading-text[data-v-fba5990a]{padding:0 15px;line-height:20px;text-align:center;font-size:16px}.zjapp .error-text[data-v-fba5990a]{color:#ff3d3d}",""])},"515e":function(t,e,i){"use strict";var n=i("329b"),a=i("f1e4").a,r=(i("0416"),i("17cc")),o=Object(r.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{class:{"content-not-empty":t.content.length},attrs:{mode:"dialog",title:"检查指引","on-close":t.closePopup}},[!t.isLoading&&t.title?i("div",{staticClass:"check-guide-detail-hd border-bottom"},[i("h2",{staticClass:"check-guide-detail-title pb10"},[t._v(t._s(t.title))])]):t._e(),!t.isLoading&&t.content.length?i("div",{staticClass:"check-guide-detail-content"},t._l(t.content,(function(e,n){return i("p",{key:n},[e.isImg&&e.src?i("img",{class:{"img-not-ready":!e.ready,error:"rejected"===e.status},attrs:{src:t.getThumbnail(e)},on:{error:function(i){t.imgError(e,n)},click:function(i){t.imgClick(e)}}}):t._e(),e.isImg?t._e():i("span",[t._v("\n          "+t._s(e.val)+"\n        ")])])}))):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.content.length,"empty-text":"PC端未设置检查指引"}})],1):t._e()],1)}),[],!1,null,"691b2f0f",null).exports,s=!1;s||(s=new(n.default.extend(o))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},"574c":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .item-textarea{background-color:#fff;padding:5px 15px}.zjapp .item-textarea-content{position:relative}.zjapp .item-textarea .rule,.zjapp .item-textarea textarea{width:100%;min-height:40px;line-height:20px;font-size:16px;padding:0;border:none}.zjapp .item-textarea .rule{position:absolute;top:0;left:0;visibility:hidden;word-break:break-all}.zjapp .item-textarea .counter{text-align:right;margin:0 0 -5px 0;height:15px;line-height:15px;color:#b2b2b2;font-size:12px}",""])},"5a71":function(t,e,i){"use strict";var n=i("29be").a,a=i("17cc"),r=Object(a.a)(n,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("item",{class:t.required,attrs:{label:t.title,text:t.value&&t.value.id?t.value.name:"view"===t.mode?"无":"",mode:t.mode,editabled:t.editabled,placeholder:t.required?t.placeholder||"请选择":"选填","form-check":t.formCheck,border:t.border},on:{click:t.openSelect}})}),[],!1,null,null,null);e.a=r.exports},"5b5e":function(t,e,i){"use strict";(function(t){i("9e76"),i("163d"),i("e697");var n,a=i("fd50"),r=i("3bd5"),o=i("ed08"),s=i("4ad6"),c=i("3122"),l=i("3516"),u=i("37d5"),d=i("f2d3"),h=i("48f4"),f=i("6bf2"),m=i.n(f),g=i("4360"),b=i("4921"),v=i("334f"),_=i("b725"),y=i("6b81"),x=i("2f02"),k=i("7364"),w=i("59f8"),P=i("c745"),j=i("0136"),I=function(e,i){var n=r.a.getUser();return v.a.getProblemCCAllColumn(e).then((function(a){if(t.some(a,(function(t){return t.cc===n.user_id&&t.type===i})))return v.a.updateProblemReadingTime(e);var r={id:n.user_id,name:n.user_name,type:i,reading_time:o.a.getNowDate()};return v.a.appendCC(e,r).then((function(){return v.a.updateProblemReadingTime(e)}))}))},C=function(t){var e=t.status;return"已关闭"===t.status&&(e="非正常关闭"),a.a.resolve({status_text:e})};n={getCheckProblemDraftList:function(t){return b.a.getCheckProblemDraftList(t).catch((function(t){return $log.error(t),a.a.reject(t)}))},getCheckProblemList:function(e){var i=r.a.getUser().user_id;return b.a.getCheckProblemList(e,i).then((function(r){return t.map(r,(function(t){n.getProblemLocalStatus({status:t.status}).then((function(e){t.status_text=e.status_text}))})),b.a.getCheckProblemCount(e,i).then((function(t){return a.a.resolve({data:r,total:t.count})}))})).catch((function(t){return $log.error(t),a.a.reject(t)}))},getCheckProblemInfo:function(e){return e?a.a.all([b.a.getCheckProblem(e),_.a.getRepair(e),y.a.getMutliReinspect(e),v.a.getCC(e),v.a.getProblemCCAllColumn(e),y.a.getReinspectByList(e)]).then((function(e){var i=e[0],n=e[5],r=e[1];r&&(i.repair_set=r,i.has_read=r.has_read);var o=e[2];t.isEmpty(o)?i.reinspect_set=[]:i.reinspect_set=o;var s=e[3];s&&s.length>0&&(i.cc_set_id_array=t.map(s,(function(t){return{id:t.user_id}})),i.cc_set_name_array=t.map(s,(function(t){return{name:t.user_name}})),i.cc_set_array=t.map(s,(function(t){return{id:t.user_id,name:t.user_name,mobile:t.mobile,is_im_user:t.is_im_user}})));var c=e[4];return c&&c.length>0&&(i.cc_set_all_id_array=t.map(c,(function(t){return{id:t.cc}}))),i.regist_by||i.sent_back_by||i.repair_by||i.reinspect_by?u.default.getAllProjectUsers(i.proj_id).then((function(e){if(i.regist_by){var a=t.find(e,(function(t){return t.user_id===i.regist_by}));a&&(i.regist=a)}if(i.sent_back_by){var r=t.find(e,(function(t){return t.user_id===i.sent_back_by}));r&&(i.sent_back={id:r.user_id,name:r.user_name,mobile:r.mobile,is_im_user:r.is_im_user})}if(i.repair_by){var o=t.find(e,(function(t){return t.user_id===i.repair_by}));o&&(i.repair=o)}return t.isEmpty(n)||(i.reinspectBy=t.map(n,(function(i){var n=t.find(e,(function(t){return t.user_id===i.reinspect}));return n?{id:n.user_id,name:n.user_name,mobile:n.mobile,is_im_user:n.is_im_user,reinspect_date:i.reinspect_date,reinspect_remark:i.reinspect_remark,reinspect_image_file:JSON.parse(i.reinspect_image_file||"[]"),reinspectById:i.id}:{id:i.reinspect,name:"该用户已被删除",mobile:"",is_im_user:null,reinspect_date:i.reinspect_date,reinspect_remark:"",reinspect_image_file:[],reinspectById:i.id}})),i.reinspectBy=t.filter(i.reinspectBy,(function(t){return!!t})),i.reinspect=t.filter(i.reinspectBy,(function(t){return!!t.reinspect_date}))),i.regist=i.regist||{},i.sent_back=i.sent_back||{},i.repair=i.repair||{},i.reinspect=i.reinspect||[],i})):(i.regist={},i.sent_back={},i.repair={},i.reinspect=[],a.a.resolve(i))})).catch((function(t){$log.log(t)})):a.a.resolve({})},submit:function(e,i,n){if(!1===n)return function(t,e){var i=r.a.getUser();return t.repair_deadline="",t.regist_by=i.user_id,t.regist_date=o.a.getNowDate(),t.created_by=i.user_id,t.created_on=o.a.getNowDate(),t.image_file=JSON.stringify(t.image_file),t.drawing_file&&(t.drawing_file=JSON.stringify(t.drawing_file)),$log.log("专项巡检--\x3e不通知整改"),b.a.submit(t).then((function(){return k.a.saveProblemStatusLog(t.proj_id,"",t.batch_id,t.id,"已提交","","",t.image_file)})).then((function(){return I(t.id,"登记人")})).then((function(e){return h.default.addSyncGroup([["checkquality_problem",t.id],["checkquality_cc",t.id]])})).then((function(){if("special-inspect-problem"!==e)return j.a.saveTodo({biz_id:t.id,proj_id:t.proj_id,module_code:e||"",type:2})})).catch((function(t){return $log.error(t),a.a.reject(t)}))}(e,i);if("待提交"!==e.status&&"草稿"!==e.status&&"合格草稿"!==e.status&&"不合格草稿"!==e.status)return a.a.reject("问题单状态异常");if(!e.checkItem.id)return a.a.reject("请先选择检查项");if(!e.repair_set||!e.repair_set.id)return a.a.reject("请选择问题的整改人");if(t.isEmpty(e.reinspect_set))return a.a.reject("请选择问题的复验人");var s=r.a.getUser();e.status="待整改";var c=new Date;return c.setDate(c.getDate()+Number(e.deadline)),e.repair_deadline=m()(c).format("YYYY-MM-DD"),"special-inspect-problem"===i&&e.regist_by&&e.regist_date&&e.created_by&&e.created_on||(e.regist_by=s.user_id,e.regist_date=o.a.getNowDate(),e.created_by=s.user_id,e.created_on=o.a.getNowDate()),e.image_file=JSON.stringify(e.image_file),e.drawing_file&&(e.drawing_file=JSON.stringify(e.drawing_file)),$log.log("现场检查--\x3e提交问题"),b.a.submit(e).then((function(){return k.a.saveProblemStatusLog(e.proj_id,e.bidsection_id,e.batch_id,e.id,"已提交","","",e.image_file)})).then((function(){return I(e.id,"登记人")})).then((function(){if("special-inspect-problem"!==i){var t=e.created_by===e.repair_set.id?1:2;return j.a.insertTodoData(e.created_by,e.id,i,t,0)}})).then((function(){return y.a.getReinspectByList(e.id)})).then((function(i){return h.default.addSyncGroup([["checkquality_problem",e.id],["checkquality_repair",e.id],["checkquality_reinspect",e.id],["checkquality_reinspect_by",t.map(i,"id")],["checkquality_cc",e.id]])})).catch((function(t){return $log.error(t),a.a.reject(t)}))},save:function(e){if("待提交"!==e.status&&"草稿"!==e.status&&"合格草稿"!==e.status&&"不合格草稿"!==e.status)return a.a.reject("问题单状态异常。");if(!/^\+?[0-9]*$/.test(e.deadline))return a.a.reject("整改期限必须是正整数");var i={id:e.id,remark:e.remark,image_file:e.image_file,batch_id:e.batch_id,batch_type:e.batch_type,bidsection_id:e.bidsection_id||"",proj_id:e.proj_id,created_by:e.created_by,created_on:o.a.getNowDate(),status:e.status,room_id:e.room_id||"",building_id:e.building_id||"",unit:e.unit||"",floor:e.floor||"",biz_id:e.biz_id||"",biz_children_id:e.biz_children_id||"",deduction:void 0===e.deduction?"":e.deduction,redline_deduction:4===e.mode||8===e.mode?e.redline_deduction:0,contract_id:e.contract&&e.contract.id?e.contract.id:"",voice_file:t.isEmpty(e.voice_file)?null:JSON.stringify(e.voice_file)};return e.repair_requirements&&(i.repair_requirements=e.repair_requirements||""),e.checkItem&&e.checkItem.id&&(i.item_id=e.checkItem.id),e.place&&e.place.full_name&&(i.place=e.place.full_name),e.contractor&&e.contractor.id&&(i.contractor_id=e.contractor.id),e.description&&e.description.id?i.desc_id=e.description.id:i.desc_id="",i.emergency_degree=e.level,e.deadline&&(i.deadline=e.deadline),e.place_point&&(i.problem_values=JSON.stringify(e.place_point)),i.image_file=JSON.stringify(e.image_file),e.drawing_file&&(i.drawing_file=JSON.stringify(e.drawing_file)),(e.process_mode||null===e.process_mode)&&(i.process_mode=e.process_mode),8===e.mode&&(i.deduction_level=e.deduction_level),e.id?b.a.update(i,e.cc_set,e.repair_set,e.reinspect_set).then((function(){return a.a.resolve(e.id)})).catch((function(t){return $log.error(t),a.a.reject(t)})):(i.id=o.a.uuid(),b.a.insert(i).then((function(){return b.a.update(i,e.cc_set,e.repair_set,e.reinspect_set)})).then((function(){return a.a.resolve(i.id)})).catch((function(t){return $log.error(t),a.a.reject(t)})))},delete:function(t){return b.a.getCheckProblem(t).then((function(e){return"待提交"===e.status||"草稿"===e.status||"合格草稿"===e.status||"不合格草稿"===e.status?b.a.delete(t).catch((function(t){return $log.error(t),a.a.reject(t)})):($log.log("问题单状态异常："+t),a.a.reject("问题单状态异常"))}))},repair:function(e,i){if("待整改"!==e.status)return a.a.reject("问题单状态异常");var n=r.a.getUser();e.status="待复验",e.repair_by=n.user_id,e.repair_date=o.a.getNowDate();var s=JSON.stringify(e.repair_image_file);return b.a.getCheckProblem(e.id).then((function(n){if(!n||"待整改"===n.status)return $log.log("现场检查--\x3e完成整改"),b.a.repairProblem(e.id,e.status,e.repair_by,e.repair_remark,e.repair_date,s).then((function(){return k.a.saveProblemStatusLog(e.proj_id,e.bidsection_id,e.batch_id,e.id,"已整改","",e.repair_remark,s)})).then((function(){return I(e.id,"操作人")})).then((function(){if("special-inspect-problem"!==i){var n=2;t.filter(e.reinspect_set,{user_id:e.repair_by}).length&&(n=1);var a=j.a.getTodoSort(e.status,e.repair_deadline,e.close_date,e.repair_date,e.sent_back_times,e.emergency_degree,"check");return j.a.insertTodoData(e.repair_by,e.id,"check",n,a)}})).then((function(){return h.default.addSyncGroup([["checkquality_problem",e.id],["checkquality_cc",e.id]])}));$log.log("提交整改时数据已变为")})).catch((function(t){return $log.error(t),a.a.reject(t)}))},reinspectPass:function(e,i){if("待复验"!==e.status)return a.a.reject("问题单状态异常");e.currentReinspectBy=e.currentReinspectBy||{};var n=r.a.getUser(),s="",c=t.isEmpty(e.currentReinspectBy.reinspect_image_file)?"":JSON.stringify(e.currentReinspectBy.reinspect_image_file);return b.a.getCheckProblem(e.id).then((function(r){if(!r||"待复验"===r.status)return y.a.reinspectPass(e.id,n.user_id,o.a.now(),c,e.currentReinspectBy.reinspect_remark||"").then((function(){return y.a.getReinspectByList(e.id).then((function(i){var r=t.every(i,(function(t){return!!t.reinspect_date})),c=t.find(i,{reinspect:n.user_id});return c?(s=c.id,r?(e.status="已通过",e.respect_by=n.user_id,e.reinspect_completed_date=o.a.getNowDate(),b.a.reinspectProblemPass(e.id,e.status,e.reinspect_completed_date,e.respect_by).then((function(){return k.a.saveProblemStatusLog(e.proj_id,e.bidsection_id,e.batch_id,e.id,"已复验","","","")}))):void 0):a.a.reject("问题单复验人异常")}))})).then((function(){return I(e.id,"操作人")})).then((function(){if("special-inspect-problem"!==i){var t=j.a.getTodoSort(e.status,e.repair_deadline,e.close_date,e.repair_date,e.sent_back_times,e.emergency_degree,"check");return j.a.insertTodoData(n.user_id,e.id,i||"check",2,t)}})).then((function(){return h.default.addSyncGroup([["checkquality_problem",e.id],["checkquality_reinspect_by",s],["checkquality_cc",e.id]])}))})).catch((function(t){return $log.error(t),a.a.reject(t)}))},reinspectReject:function(e,i){var n=[["checkquality_problem",e.id],["checkquality_cc",e.id]];if("待复验"!==e.status)return a.a.reject("问题单状态异常");if(!e.sent_back_remark)return a.a.reject("请填写退回原因");var s=r.a.getUser();e.sent_back_times?e.sent_back_times++:e.sent_back_times=1,e.status="待整改",e.sent_back_date=o.a.getNowDate(),e.sent_back_by=s.user_id;var c=JSON.stringify(e.sent_back_image_file);return $log.log("现场检查--\x3e复验退回"),b.a.reinspectProblemReject(e.id,e.status,e.sent_back_date,e.sent_back_remark,c,e.sent_back_by,e.sent_back_times).then((function(){return k.a.saveProblemStatusLog(e.proj_id,e.bidsection_id,e.batch_id,e.id,"已退回",e.sent_back_remark,"",c)})).then((function(){return y.a.clearReinspectByData(e.id)})).then((function(){return I(e.id,"操作人")})).then((function(){if("special-inspect-problem"!==i){var t=2;e.repair_set.id&&e.repair_set.id===s.user_id&&(t=1);var n=j.a.getTodoSort(e.status,e.repair_deadline,e.close_date,e.repair_date,e.sent_back_times,e.emergency_degree,"check");return j.a.insertTodoData(s.user_id,e.id,"check",t,n)}})).then((function(){return y.a.getReinspectByList(e.id).then((function(e){n.push(["checkquality_reinspect_by",t.map(e,"id")])}))})).then((function(){if(1===e.has_read)return _.a.update({has_read:0},{checkquality_problem_id:e.id}).then((function(){n.push(["checkquality_repair",e.id])}))})).then((function(){return h.default.addSyncGroup(n)})).catch((function(t){return $log.error(t),a.a.reject(t)}))},close:function(t,e){if("待整改"!==t.status)return a.a.reject("问题单状态异常");if(!t.close_reason)return a.a.reject("请填写关闭原因");var i=r.a.getUser();return t.close_date=o.a.getNowDate(),t.status="已关闭",$log.log("现场检查--\x3e非正常关闭"),b.a.closeProblem(t.id,t.status,t.close_date,t.close_reason).then((function(){return k.a.saveProblemStatusLog(t.proj_id,t.bidsection_id,t.batch_id,t.id,"已关闭",t.close_reason,"","")})).then((function(){return I(t.id,"操作人")})).then((function(){if("special-inspect-problem"!==e){var n=j.a.getTodoSort(t.status,t.repair_deadline,t.close_date,t.repair_date,t.sent_back_times,t.emergency_degree,"check");return j.a.insertTodoData(i.user_id,t.id,"check",2,n)}})).then((function(){return h.default.addSyncGroup([["checkquality_problem",t.id],["checkquality_cc",t.id]])})).catch((function(t){return $log.error(t),a.a.reject(t)}))},changeRepair:function(t,e,i){if(!t.repair_set||!t.repair_set.id)return a.a.reject("请指定一个整改人");var n=r.a.getUser();return $log.log("现场检查--\x3e修改整改人"),b.a.updateProblemModifiedBy(t.id).then((function(){if(e)return b.a.updateProblemContractor(t.id,t.contractor.id)})).then((function(){if(e){var i=t.contractor&&t.contractor.id||"";return b.a.updateProblemContractor(t.id,i)}})).then((function(){return _.a.changeProblemRepairer(t)})).then((function(){return x.a.saveProblemFpInfo(t.proj_id,t.bidsection_id,t.batch_id,t.id,t.repair_set.id,t.repair_set_old.id,"分配整改人")})).then((function(){return I(t.id,"操作人")})).then((function(){if("special-inspect-problem"!==i){var e=2;t.repair_set.id&&t.repair_set.id===n.user_id&&(e=1);var a=j.a.getTodoSort(t.status,t.repair_deadline,t.close_date,t.repair_date,t.sent_back_times,t.emergency_degree,"check");return j.a.insertTodoData(n.user_id,t.id,"check",e,a)}})).then((function(){return h.default.addSyncGroup([["checkquality_problem",t.id],["checkquality_repair",t.id],["checkquality_cc",t.id],["checkquality_problem_fpinfo",t.id]])})).catch((function(t){return $log.error(t),a.a.reject(t)}))},changeReinspect:function(e,i){if(t.isEmpty(e.reinspect_set))return a.a.reject("请指定一个复验人");var n=r.a.getUser();return $log.log("现场检查--\x3e修改复验人"),b.a.updateProblemModifiedBy(e.id).then((function(){return y.a.changeProblemReinspect(e.id,e.reinspect_set,!0)})).then((function(){var i=t.map(e.reinspect_set,(function(t){return t.id})).join(","),n=t.map(e.reinspect_set_old,(function(t){return t.id})).join(",");return x.a.saveProblemFpInfo(e.proj_id,e.bidsection_id,e.batch_id,e.id,i,n,"分配复验人")})).then((function(){return I(e.id,"操作人")})).then((function(){if("special-inspect-problem"!==i){var a=2;t.filter(e.reinspect_set,{user_id:n.user_id}).length&&"待复验"===e.status&&(a=1);var r=j.a.getTodoSort(e.status,e.repair_deadline,e.close_date,e.repair_date,e.sent_back_times,e.emergency_degree,"check");return j.a.insertTodoData(n.user_id,e.id,"check",a,r)}})).then((function(){return y.a.getReinspectByList(e.id)})).then((function(i){return h.default.addSyncGroup([["checkquality_problem",e.id],["checkquality_reinspect",e.id],["checkquality_reinspect_by",t.map(i,"id")],["checkquality_cc",e.id],["checkquality_problem_fpinfo",e.id]])})).catch((function(t){return $log.error(t),a.a.reject(t)}))},changeCC:function(t){return $log.log("现场检查--\x3e修改抄送人"),b.a.updateProblemModifiedBy(t.id).then((function(){return v.a.saveProblemCC(t.id,t.cc_set)})).then((function(){return h.default.addSyncGroup([["checkquality_problem",t.id],["checkquality_cc",t.id]])})).catch((function(t){return $log.error(t),a.a.reject(t)}))},changeContractor:function(t){return t.contractor&&t.contractor.id?($log.log("现场检查--\x3e修改责任单位"),b.a.updateProblemContractor(t.id,t.contractor.id).then((function(){return h.default.addSyncGroup([["checkquality_problem",t.id]])})).catch((function(t){return $log.error(t),a.a.reject(t)}))):a.a.reject("请指定责任单位")},changeRepairDeadline:function(t){if(!/^(\d+)-(\d{1,2})-(\d{1,2})$/.test(t.repair_deadline))return a.a.reject("整改期限需要一个日期格式的值");var e=m()(t.repair_deadline).format("YYYY-MM-DD"),i=m()().format("YYYY-MM-DD");return t.is_timeout=e<i,$log.log("现场检查--\x3e修改整改期限"),b.a.updateProblemRepairDeadline(t.id,t.repair_deadline).then((function(){return h.default.addSyncGroup([["checkquality_problem",t.id]])})).catch((function(t){return $log.error(t),a.a.reject(t)}))},getProblemLocalStatusById:function(t){return C({status:p.status})},getProblemLocalStatus:C,saveRepairInfo:function(t,e,i){return i=JSON.stringify(i),b.a.saveRepairInfo(t,e,i).then((function(){return b.a.getCheckProblemDraft(t).then((function(e){return d.a.backUpDraft(t,e.proj_id,"checkquality_problem",e)}))}))},problemRead:function(t){return _.a.update({has_read:1},{checkquality_problem_id:t}).then((function(){return h.default.addSyncGroup([["checkquality_problem",t],["checkquality_repair",t]])}))},takePictureAndSave:function(t){return c.a.takePicture().then((function(e){if(e)return l.a.getBatch(t).then((function(t){var i={proj_id:t.proj_id,bidsection_id:t.bidsection_id,batch_id:t.id,deadline:t.repair_deadline,batch_type:t.batch_type,created_by:r.a.getUser().user_id,created_on:o.a.now(),image_file:[e],status:"待提交"};return n.save(i)}))})).catch((function(t){return $log.error(t),a.a.reject(t)}))},saveByPicture:function(t,e){return t?l.a.getBatch(e).then((function(e){var i={proj_id:e.proj_id,bidsection_id:e.bidsection_id,batch_id:e.id,deadline:e.repair_deadline,batch_type:e.batch_type,created_by:r.a.getUser().user_id,created_on:o.a.now(),image_file:[{temp:t}],status:"待提交"};return n.save(i)})).catch((function(t){return $log.error(t),a.a.reject(t)})):a.a.when()},createProblem:function(t,e){return l.a.getBatch(e).then((function(e){var i={proj_id:e.proj_id,bidsection_id:e.bidsection_id,batch_id:e.id,deadline:e.repair_deadline,batch_type:e.batch_type,created_by:r.a.getUser().user_id,created_on:o.a.now(),image_file:[{temp:t}],status:"待提交"};return n.save(i)}))},takePicture:function(){return c.a.takePicture()},allowSelectPicture:function(){return w.a.getValue("upload_from_phone_albums").then((function(t){return"1"===t}))},reinspectByConflict:function(e){return t.isEmpty(e.reinspectBy)?a.a.when():y.a.removeProblemReinspectBy(e.reinspectBy[0].checkquality_problem_id).then((function(){return y.a.insertReinspectByList(e.reinspectBy)})).then((function(){return TodoRepository.removeProblemTodo(e.reinspectBy[0].checkquality_problem_id)})).then((function(){return TodoRepository.insertTodoList(e.todo)}))},copyProblem:function(e){return a.a.all([b.a.getProblemAllColumn(e),_.a.getRepairAllColumn(e),y.a.getReinspectAllColumn(e),y.a.getReinspectByList(e),v.a.getProblemCCAllColumn(e)]).then((function(e){var i=e[0],n=e[1],s=e[2],c=e[3],l=e[4];if(i.id=o.a.uuid(),i.status="待提交",i.regist_by="",i.repair_by="",i.repair_remark="",i.repair_date="",i.repair_image_file="",i.sent_back_by="",i.sent_back_date="",i.sent_back_times=0,i.sent_back_remark="",i.sent_back_image_file="",i.reinspect_by="",i.reinspect_completed_date="",i.close_date="",i.close_reason="",i.created_by=r.a.getUser().user_id,i.created_on=o.a.now(),i.modified_by=r.a.getUser().user_id,i.download_time="",i.update_timestamp="",i.repair_deadline&&!i.deadline&&i.regist_date){for(var u=i.repair_deadline.match(/\d+/g),d=0;d<u.length;d++)u[d]=parseInt(u[d]);for(var p=new Date(u[0],u[1]-1,u[2],u[3]||0,u[4]||0,u[5]||0),h=i.regist_date.match(/\d+/g),f=0;f<h.length;f++)h[f]=parseInt(h[f]);var m=new Date(h[0],h[1]-1,h[2],h[3]||0,h[4]||0,h[5]||0);i.deadline=Math.ceil((p.getTime()-m.getTime())/864e5)}i.regist_date="",i.repair_deadline="",t.each(n,(function(t){t.id=o.a.uuid(),t.checkquality_problem_id=i.id,t.download_time=""})),t.each(s,(function(t){t.id=o.a.uuid(),t.checkquality_problem_id=i.id,t.download_time=""})),t.each(c,(function(t){t.id=o.a.uuid(),t.checkquality_problem_id=i.id,t.reinspect_date="",n.reinspect_remark="",n.reinspect_image_file="",t.download_time=""}));var g=t.filter(l,(function(t){return"默认"===t.type}));return g=t.map(g,(function(t){return{id:t.cc}})),l=t.filter(l,(function(t){return"被抄送"===t.type})),l=t.map(l,(function(t){return{id:t.cc}})),a.a.all([b.a.insert(i),_.a.insert(n),y.a.insertReinspect(s),y.a.insertReinspectByList(c),v.a.saveProblemCC(i.id,l),v.a.saveDefaultCc(i.id,g)])}))},removeLocalInvalidProblem:function(e){var i=a.a.when();return e.problem_repair&&(i=i.then((function(){return _.a.removeInvalidData(e.problem.id,t.map(e.problem_repair,"id"))}))),e.problem_reinspect&&(i=i.then((function(){return y.a.removeInvalidData(e.problem.id,t.map(e.problem_reinspect,"id"))}))),e.problem_cc&&(i=i.then((function(){return v.a.removeInvalidData(e.problem.id,t.map(e.problem_cc,"id"))}))),e.children_Problem&&(i=i.then((function(){return b.a.removeInvalidChildProblem(e.problem.id,e.children_Problem)}))),i},removeLocalInvalidProblem1:function(e,i){var n=i.checkquality_problem;return a.a.when().then((function(){if(i.checkquality_problem)return b.a.deleteProblemById(n.id)})).then((function(){if(i.checkquality_repair)return _.a.removeInvalidData(n.id,t.map(i.checkquality_repair,"id"))})).then((function(){if(i.checkquality_cc)return v.a.removeInvalidData(n.id,t.map(i.checkquality_cc,"id"))}))},removeClosedBatchProblem:function(){return l.a.getClosedBatchIdList().then((function(t){return n.deleteBatchProblems(t)}))},deleteBatchProblems:function(e){return $log.log("删除已关闭批次的问题"),b.a.getProblemsByBatch(e).then((function(e){var i=a.a.when(),n=["image_file","repair_image_file","sent_back_image_file"],r=[];return t.each(e,(function(e){for(var i=0;i<n.length;++i){var a=e[n[i]]=JSON.parse(e[n[i]]||"[]");t.each(a,(function(t){t.local&&r.push(t.local),t.thumbnail&&r.push(t.thumbnail),t.temp&&r.push(t.temp)}))}})),t.each(r,(function(t){i=i.then((function(){return s.a.isFileExists(t)})).then((function(e){if(e)return s.a.deleteFile(t)}))})),i})).then((function(){return b.a.deleteProblemByBatch(e)}))},getLeaderComments:function(e){return b.a.getLeaderComments(e).then((function(e){return t.each(e,(function(t){t.user={id:t.user_id,name:t.user_name,mobile:t.mobile,is_im_user:t.is_im_user},t.image_file&&(t.image_file=JSON.parse(t.image_file))})),e}))},getPhotoRequired:function(t,e){var i=g.a.state.global.allGrayRelease.UsingProjectParameter;return P.a.getProjParameter(t,"is_photo_required",e).then((function(t){return i&&t&&t.length?Number(t[0].value):g.a.state.global.isPhotoRequired[e]})).catch((function(t){console.log("error",t)}))}},e.a=n}).call(this,i("391c"))},6272:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .number-input[data-v-74068386]{position:relative;display:inline-block;vertical-align:top;width:61px;height:30px;border:1px solid #e5e5e5;border-radius:3px;text-align:center;font-size:14px;color:#333}@media screen and (min-width:320px){.zjapp .number-input[data-v-74068386]{width:50px}}@media screen and (min-width:360px){.zjapp .number-input[data-v-74068386]{width:58px}}@media screen and (min-width:375px){.zjapp .number-input[data-v-74068386]{width:61px}}.zjapp .text[data-v-74068386]{position:relative;display:inline-block;vertical-align:top;width:100%;height:100%;line-height:28px;overflow:hidden}.zjapp .text.disabled[data-v-74068386]{background:#f5f5f5;color:#666}.zjapp .value[data-v-74068386]{position:absolute;top:50%;right:0;margin-top:-14px;min-width:100%;height:28px;color:inherit}.zjapp .placeholder[data-v-74068386],.zjapp .value[data-v-74068386]{line-height:28px;pointer-events:none}.zjapp .placeholder[data-v-74068386]{display:inline-block;vertical-align:top;width:100%;height:100%;color:#b2b2b2}.zjapp .icon-minus[data-v-74068386]{position:absolute;top:-9px;right:-9px;width:18px;height:18px;border-radius:9px;background-color:#ff4546}.zjapp .icon-minus[data-v-74068386]:before{content:"";position:absolute;left:4px;top:8px;width:10px;height:2px;background-color:#fff}.zjapp .icon-minus[data-v-74068386]:after{content:"";position:absolute;left:-5px;top:-5px;width:28px;height:28px;border-radius:9px}.zjapp .number-input-select-all .value-handle[data-v-74068386]{background-color:#cbdaf9}.zjapp .number-input.unqualified[data-v-74068386]{border:1px solid #ffe8e8;background-color:#fff3f3;color:#ff5050}.zjapp .number-input.qualified .text[data-v-74068386]{color:#333}.zjapp .number-input.number-input-focus[data-v-74068386]{border-color:#4275e8;box-shadow:0 0 8px 0 rgba(66,117,232,.37)}.zjapp .number-input.number-input-empty[data-v-74068386]{border-color:#ff3d3d;box-shadow:0 0 8px 0 rgba(255,59,48,.37)}',""])},6948:function(t,e,i){"use strict";i("2b45"),i("163d");var n=i("329b"),a=i("8c3d").a,r=(i("b55a"),i("17cc")),o=Object(r.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-up"},on:{leave:t.startClose,afterLeave:t.onClose}},[t.show?i("div",{staticClass:"number-keyboard-con",class:{"ios-bezel-less":t.isIOSBezelLess},style:{"z-index":t.zIndex},on:{touchstart:t.keyTouchstart,touchend:t.keyTouchend}},["true-or-false"===t.type?[i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"row-span-3 keys-row"},[i("div",{staticClass:"keys col color-green",attrs:{direct:"setTure"}},[i("icon",{attrs:{name:"qualified"}}),t._v("\n            合格\n          ")],1),i("div",{staticClass:"keys col color-red",attrs:{direct:"setFalse"}},[i("icon",{attrs:{name:"unqualified"}}),t._v("\n            不合格\n          ")],1)]),i("div",{staticClass:"row-span-1"},[i("div",{staticClass:"keys-row"},[i("div",{staticClass:"keys keys-ok",attrs:{direct:"closeKeyboard"}},[i("icon",{attrs:{name:"keyboard-close"}})],1)]),i("div",{staticClass:"keys-row"},[i("div",{staticClass:"keys keys-delete",attrs:{direct:"delete"}},[i("icon",{attrs:{name:"keyboard-delete"}})],1)])])]),i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys keys-prev",class:{disabled:!t.hasPrev},attrs:{direct:"prev"}},[t._v("\n          上一项\n        ")]),i("div",{staticClass:"keys keys-next",class:{disabled:!t.hasNext},attrs:{direct:"next"}},[t._v("\n          下一项\n        ")])])]:[i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys",attrs:{direct:"1"}},[t._v("1")]),i("div",{staticClass:"keys",attrs:{direct:"2"}},[t._v("2")]),i("div",{staticClass:"keys",attrs:{direct:"3"}},[t._v("3")]),i("div",{staticClass:"keys keys-ok",attrs:{direct:"closeKeyboard"}},[i("icon",{attrs:{name:"keyboard-close"}})],1)]),i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys",attrs:{direct:"4"}},[t._v("4")]),i("div",{staticClass:"keys",attrs:{direct:"5"}},[t._v("5")]),i("div",{staticClass:"keys",attrs:{direct:"6"}},[t._v("6")]),i("div",{staticClass:"keys keys-delete",attrs:{direct:"delete"}},[i("icon",{attrs:{name:"keyboard-delete"}})],1)]),i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys",attrs:{direct:"7"}},[t._v("7")]),i("div",{staticClass:"keys",attrs:{direct:"8"}},[t._v("8")]),i("div",{staticClass:"keys",attrs:{direct:"9"}},[t._v("9")]),i("div",{staticClass:"keys keys-prev",class:{disabled:!t.hasPrev},attrs:{direct:"prev"}},[t._v("\n          上一项\n        ")])]),i("div",{staticClass:"keyboard-row"},[i("div",{staticClass:"keys",class:{disabled:t.isDisabledMinus},attrs:{direct:"-"}},[t._v("-")]),i("div",{staticClass:"keys",attrs:{direct:"0"}},[t._v("0")]),i("div",{staticClass:"keys",class:{disabled:t.isDisabledPoint},attrs:{direct:"."}},[t._v(".")]),i("div",{staticClass:"keys keys-next",class:{disabled:!t.hasNext},attrs:{direct:"next"}},[t._v("\n          下一项\n        ")])])]],2):t._e()])}),[],!1,null,"6337f428",null).exports,s=!1;s||(s=new(n.default.extend(o))({el:document.createElement("div")}),document.body.appendChild(s.$el));var c=s,l=i("6f9e"),u=i("4360"),d={name:"NumberInput",props:{value:{type:[String,Number]},type:{type:String,default:"all"},decimal:{type:Number,default:2},placeholder:{type:String,default:""},nextEvent:{type:Function},range:{type:Array,default:function(){return[]}},overflowAutoRecover:{type:Boolean,default:!1},required:{type:Boolean},emptyAutoRecover:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},isSetEmptyTip:{type:Boolean,default:!1}},data:function(){return{rawValue:"",isFocusing:!1,isSelectAll:!1,keyboardHeight:u.a.state.app.isIOSBezelLess?266:"true-or-false"===this.type?176:232}},computed:{min:function(){return isNaN(this.range[0])?-1/0:parseFloat(this.range[0])},max:function(){return isNaN(this.range[1])?1/0:parseFloat(this.range[1])}},created:function(){l.a.$on("numberInputBlur",this.setBlur),l.a.$on("numberKeyboardClose",this.setBlur)},beforeDestroy:function(){this.isFocusing&&c.closeKeyboard()},destroyed:function(){l.a.$off("numberInputBlur",this.setBlur),l.a.$off("numberKeyboardClose",this.setBlur)},methods:{hasVal:function(t){return null!=t&&""!==t},openKeyboard:function(){this.disabled||(this.isFocusing?this.isSelectAll=!1:(l.a.$emit("numberInputBlur"),this.setFocus(),c.openKeyboard({inputComponent:this})))},setFocus:function(){this.isFocusing=!0,"true-or-false"!==this.type&&(this.isSelectAll=!0),this.rawValue=this.value,c.$on("keyboardInput",this.input),c.$on("keyboardAssign",this.assign),c.$on("keyboardDelete",this.deleteValue),c.$on("keyboardClear",this.clear),this.$emit("focus")},setBlur:function(){if(this.isFocusing){var t=this.checkValue();this.isFocusing=!1,this.isSelectAll=!1,c.$off("keyboardInput",this.input),c.$off("keyboardAssign",this.assign),c.$off("keyboardDelete",this.deleteValue),c.$off("keyboardClear",this.clear),this.$emit("input",t),this.$emit("blur",t),this.$nextTick((function(){c.calcTab()}))}},input:function(t){var e=this.hasVal(this.value)?this.value.toString():"",i="";this.isSelectAll?(i=t,this.isSelectAll=!1):i=e+t,console.log("newValue =====",i),this.$emit("input",i),c.setKeysStatus(i,this.type)},assign:function(t){this.isSelectAll=!1,this.$emit("input",t),c.setKeysStatus(t,this.type)},deleteValue:function(){var t=this.hasVal(this.value)?this.value.toString():"",e="";this.hasVal(t)&&(e=this.isSelectAll?"":t.substr(0,t.length-1)),this.$emit("input",e),c.setKeysStatus(e,this.type)},clear:function(){this.$emit("input",""),c.setKeysStatus("",this.type)},checkValue:function(){var t=this.hasVal(this.value)?this.value.toString():"";"-"===t&&(t=""),"."===t.substr(-1)&&(t=t.substr(0,t.length-1));var e=t.indexOf(".");return e>0&&(t=parseFloat(t.substring(0,e+this.decimal+1))),t=parseFloat(t),isNaN(t)?this.required&&this.emptyAutoRecover?(t=this.rawValue,this.$emit("onEmpty")):t="":(t<this.min&&(t=this.overflowAutoRecover?this.rawValue:this.min,this.$emit("overflowRange")),t>this.max&&(t=this.overflowAutoRecover?this.rawValue:this.max,this.$emit("overflowRange"))),t}}},p=(i("6abe"),Object(r.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"number-input component-number-input",class:{"number-input-focus":t.isFocusing,"number-input-empty":t.isSetEmptyTip&&!t.value&&!t.isFocusing,"number-input-select-all":t.isSelectAll,qualified:"true-or-false"===t.type&&1===t.value,unqualified:"true-or-false"===t.type&&0===t.value}},[i("div",{staticClass:"text",class:{disabled:t.disabled},on:{click:function(e){return e.stopPropagation(),t.openKeyboard(e)}}},[t.hasVal(t.value)?i("span",{staticClass:"value"},[i("span",{staticClass:"value-handle"},[t._v(t._s("true-or-false"===t.type?1===t.value?"合格":"不合格":t.value))])]):i("span",{staticClass:"placeholder"},[t._v("\n      "+t._s(t.placeholder)+"\n    ")])]),t._t("extend")],2)}),[],!1,null,"74068386",null));e.a=p.exports},"6abe":function(t,e,i){"use strict";i("bebe")},"771c":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .content-not-empty[data-v-691b2f0f] .layout-content{display:auto;overflow:auto;padding-bottom:100px}.zjapp .check-guide-detail-hd[data-v-691b2f0f]{margin-left:30px;padding:25px 30px 5px 0}.zjapp .check-guide-detail-title[data-v-691b2f0f]{margin:0;line-height:20px;font-size:18px;color:#111;font-weight:700;word-break:break-all}.zjapp .check-guide-detail-info[data-v-691b2f0f]{line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .check-guide-detail-content[data-v-691b2f0f]{padding:30px;line-height:30px;color:#333;font-size:16px}.zjapp .check-guide-detail-content p[data-v-691b2f0f]{margin-bottom:30px;min-height:1em}.zjapp .check-guide-detail-content img[data-v-691b2f0f]{max-width:100%}.zjapp .check-guide-detail-content .img-not-ready[data-v-691b2f0f]{width:80px;height:auto}.zjapp .error[data-v-691b2f0f]{max-width:50%}",""])},"81f2":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .main[data-v-2cac8864]{position:fixed;width:100%;bottom:0}.zjapp .arrow[data-v-2cac8864]{position:absolute;top:-7px;right:18px;width:0;height:0;border-bottom:7px solid #fff;border-right:7px solid transparent;border-left:7px solid transparent}.zjapp .content[data-v-2cac8864]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-2cac8864]{display:flex;flex-direction:column;background-color:#fff;overflow:auto}.zjapp .box-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1}.zjapp .detail-hd[data-v-2cac8864]{display:flex;padding:6px 15px}.zjapp .detail-arrow-right[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-right[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:12px;border:5px solid transparent;border-left:5px solid #c8c8c8}.zjapp .detail-arrow-down[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-down[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:15px;border:5px solid transparent;border-top:5px solid #c8c8c8}.zjapp .detail-title[data-v-2cac8864]{flex:1;line-height:34px;color:#111;font-size:16px}.zjapp .detail-bd[data-v-2cac8864]{padding:8px 15px 8px 35px;background-color:#fafafa}.zjapp .text-line[data-v-2cac8864]{font-size:14px;color:#666;line-height:30px;margin-bottom:30px}.zjapp .detail-hd-single[data-v-2cac8864]{padding:6px 0;margin:0 15px}.zjapp .detail-bd-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1;padding:8px 15px;background-color:#fff}',""])},"8c3d":function(t,e,i){"use strict";(function(t){i("ed63"),i("163d"),i("2b45"),i("e204"),i("cc57");var n,a,r=i("07d2"),o=i("cf09"),s=i("6f9e"),c=i("4360"),l=[],u=[0,1,2,3,4,5,6,7,8,9,".","-"];function d(t){return null!=t&&""!==t}e.a={name:"NumberKeyboard",components:{Item:r.default},data:function(){return{show:!1,isClosing:!1,zIndex:0,willOpenParams:null,inputComponent:"",type:"",hasPrev:!1,hasNext:!1,isDisabledMinus:!1,isDisabledPoint:!1}},computed:{isIOSBezelLess:function(){return c.a.state.app.isIOSBezelLess}},watch:{isClosing:function(t){var e=this;this.$nextTick((function(){!t&&e.willOpenParams&&e.openKeyboard(e.willOpenParams)}))}},created:function(){s.a.$on("routerBeforeEach",this.closeKeyboard),s.a.$on("pageContentClick",this.closeKeyboard)},destroyed:function(){s.a.$off("routerBeforeEach",this.closeKeyboard),s.a.$off("pageContentClick",this.closeKeyboard)},methods:{openKeyboard:function(t){this.isClosing?this.willOpenParams=t:(this.willOpenParams=null,this.show=!0,this.inputComponent=t.inputComponent,this.zIndex=o.a?++o.a.zIndex:1,c.a.commit("global/SET_IS_NUMBER_INPUT_OPEN",!0),c.a.commit("global/SET_NUMBER_KEYBOARD_HEIGHT",c.a.state.app.isIOSBezelLess?266:"true-or-false"===this.inputComponent.type?176:232),this.calcTab(),this.type=this.inputComponent.type,this.setKeysStatus(this.inputComponent.value,this.inputComponent.type),s.a.$emit("numberKeyboardOpen",this.inputComponent))},closeKeyboard:function(){this.show=!1,s.a.$emit("numberKeyboardClose")},startClose:function(){this.isClosing=!0},onClose:function(){this.isClosing=!1,c.a.commit("global/SET_IS_NUMBER_INPUT_OPEN",!1),s.a.$emit("afterNumberKeyboardClose")},input:function(t){"-"===t&&this.isDisabledMinus||"."===t&&this.isDisabledPoint||this.$emit("keyboardInput",t)},delete:function(t){var e=this;this.$emit("keyboardDelete"),n=setTimeout((function(){e.$emit("keyboardClear")}),500)},calcTab:function(){var e=function t(e){return e&&e.$parent?"Scroller"===e.$parent.$options.name?e.$parent:t(e.$parent):null}(this.inputComponent),i=e&&e.$el.querySelectorAll(".component-number-input");if(l=[],i&&t.each(i,(function(t){l.push(t.__vue__)})),t.isEmpty(l))this.hasPrev=!1,this.hasNext=!1;else{var n=t.findIndex(l,this.inputComponent);this.hasPrev=n>0,this.hasNext=n<l.length-1}this.inputComponent&&this.inputComponent.nextEvent&&(this.hasNext=!0)},prev:function(){var e=t.findIndex(l,this.inputComponent),i=l[e-1];i&&(s.a.$emit("numberInputBlur"),i.setFocus(),this.openKeyboard({inputComponent:i}))},next:function(){var e=t.findIndex(l,this.inputComponent),i=l[e+1];i?(s.a.$emit("numberInputBlur"),i.setFocus(),this.openKeyboard({inputComponent:i})):this.inputComponent&&this.inputComponent.nextEvent&&this.inputComponent.nextEvent()},setTure:function(){this.$emit("keyboardAssign",1)},setFalse:function(){this.$emit("keyboardAssign",0)},setKeysStatus:function(t,e){t=d(t)?t.toString():"",d(t)||e.indexOf("positive")>=0?this.isDisabledMinus=!0:this.isDisabledMinus=!1,!/\d/.test(t)||t.indexOf(".")>=0||e.indexOf("int")>=0?this.isDisabledPoint=!0:this.isDisabledPoint=!1},setKeyActiving:function(t,e){t&&t.classList.contains("keys")&&!t.classList.contains("disabled")&&(e?t.classList.add("activing"):t.classList.remove("activing"))},keyTouchstart:function(t){var e=t&&t.target;if(e){+new Date,a=e,this.setKeyActiving(e,!0);var i=e.getAttribute("direct");"closeKeyboard"!==i&&this.clickHandler(i)}},keyTouchend:function(t){var e=t&&t.target;if(e){this.setKeyActiving(e,!1),this.setKeyActiving(a,!1);var i=e.getAttribute("direct");"delete"===i?clearTimeout(n):"closeKeyboard"===i&&this.clickHandler(i)}},clickHandler:function(t){t&&(isNaN(t)||(t=Number(t)),"function"==typeof this[t]?this[t]():u.includes(t)&&this.input(t))}}}}).call(this,i("391c"))},"8f39":function(t,e,i){"use strict";i.r(e);var n=i("e6ed").a,a=i("17cc"),r=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{title:"登记问题","show-go-root":!0}},[t.isLoading?t._e():[i("scroller",[i("item",{staticClass:"p15"},[i("item-img-list",{attrs:{maxlength:15},on:{callback:t.saveProblem},model:{value:t.problemData.image_file,callback:function(e){t.$set(t.problemData,"image_file",e)},expression:"problemData.image_file"}})],1),i("div",{staticClass:"mt10"},[i("place-select",{ref:"checkEditPlaceSelect",attrs:{title:"部位","if-has-data-show":"","project-id":t.problemData.proj_id,selected:t.problemData.place,"selected-text":t.problemData.place&&t.problemData.place.full_name},on:{onSelect:t.onPlaceSelect}},[i("div",{staticClass:"item-label",attrs:{slot:"title"},slot:"title"},[t._v("\n            部位"),t.problemData.place_point&&t.problemData.place_point.length>0?i("span",{staticClass:"icon-huxing-mark ml10",on:{click:function(e){e.stopPropagation(),t.showHuxingMark(null,null)}}},[t._v("\n              图\n            ")]):t._e()])]),t.descriptionData&&t.descriptionData.length?i("single-select",{attrs:{title:"描述","if-toggle":!0,"line-limit":"unlimited",options:t.descriptionData},model:{value:t.problemData.description,callback:function(e){t.$set(t.problemData,"description",e)},expression:"problemData.description"}}):t._e(),i("item-textarea",{attrs:{placeholder:"补充说明"},model:{value:t.problemData.remark,callback:function(e){t.$set(t.problemData,"remark",e)},expression:"problemData.remark"}}),i("item",{attrs:{label:"严重程度",mode:"edit",border:"bottom"}},[i("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[i("radio-box",{attrs:{options:t.edOptions},on:{onSelect:t.setLevel},model:{value:t.problemData.level,callback:function(e){t.$set(t.problemData,"level",e)},expression:"problemData.level"}})],1)])],1),i("div",{staticClass:"measure-need-repair pt10 pb10"},[i("div",{staticClass:"ui-checkbox-square",class:{"color-theme":t.needRepair}},[i("van-checkbox",{attrs:{shape:"square"},model:{value:t.needRepair,callback:function(e){t.needRepair=e},expression:"needRepair"}},[t._v("通知整改")])],1)]),t.needRepair?[i("item",{attrs:{label:"整改期限",mode:"edit"}},[i("template",{slot:"right"},[i("div",{staticClass:"item-con align-r"},[i("app-stepper",{staticClass:"date",attrs:{max:"999"},model:{value:t.problemData.deadline,callback:function(e){t.$set(t.problemData,"deadline",e)},expression:"problemData.deadline"}})],1),i("div",{staticClass:"item-font ml5"},[t._v("天")])])],2),i("user-select",{attrs:{title:"整改人",multi:!1,options:t.repairOptions,memory:!0,"auto-select":!0},on:{defaultSelect:function(e){t.loadContractor(!0)},onSelect:t.selectRepair},model:{value:t.problemData.repair_set,callback:function(e){t.$set(t.problemData,"repair_set",e)},expression:"problemData.repair_set"}}),i("single-select",{attrs:{title:"责任单位","if-toggle":!0,options:t.contractorOptions},on:{onSelect:t.saveProblem},model:{value:t.problemData.contractor,callback:function(e){t.$set(t.problemData,"contractor",e)},expression:"problemData.contractor"}}),i("user-select",{attrs:{title:"复验人",multi:!0,options:t.reinspectOptions,memory:!0,max:4,"max-tip":"最多4个复验人"},on:{onSelect:t.saveProblem},model:{value:t.problemData.reinspect_set,callback:function(e){t.$set(t.problemData,"reinspect_set",e)},expression:"problemData.reinspect_set"}}),i("user-select",{attrs:{title:"抄送人",multi:!0,options:t.ccOptions,required:!1},on:{onSelect:t.saveProblem},model:{value:t.problemData.cc_set,callback:function(e){t.$set(t.problemData,"cc_set",e)},expression:"problemData.cc_set"}})]:t._e(),t.problemData.id||"草稿"===t.problemData.status?i("app-button-group",[i("app-button",{attrs:{type:"text"},on:{click:t.delProblem}},[t._v(" 删除此草稿 ")])],1):t._e()],2),t.isLoading?t._e():i("app-button-group",{attrs:{"fixed-bottom":"",seamless:""}},[i("app-button",{staticStyle:{width:"50%"},attrs:{plain:""},on:{click:t.saveProblemAndBack}},[t._v(" 暂存 ")]),i("app-button",{on:{click:t.submit}},[t._v(" 提交 ")])],1)],i("loading-status",{attrs:{"is-loading":t.isLoading}})],2)}),[],!1,null,"73addf2e",null);e.default=r.exports},9120:function(t,e,i){var n=i("2ddb");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("cb55f532",n,!0,{sourceMap:!1,shadowMode:!1})},"91c1":function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e"),i("9a33");var n=i("28f8"),a=i("e68e"),r=i("6f9e"),o=i("bcc7"),s=i("e89f");function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"CheckGuideDetailDrop",components:{ItemImgList:a.a},mixins:[s.a],data:function(){return{show:!1,showList:!1,isLoading:!1,isOpening:!1,isClosing:!1,contentTop:64,listHeight:510,module:"",itemIds:[],data:[],target:""}},watch:{show:function(t){var e=this;t&&this.$nextTick((function(){e.showList=!0}))}},created:function(){r.a.$on("routerBeforeEach",this.closePopup),r.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){r.a.$off("routerBeforeEach",this.closePopup),r.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(e){this.show=!0,this.$emit("open"),this.module=e.module,this.itemIds=e.itemIds,this.options=e.options;var i=document.querySelector(".layout-main .layout-header");if(this.contentTop=i.offsetHeight,e.el){var n=e.el.getBoundingClientRect();this.contentTop=n.bottom}this.target=e.el,this.listHeight=t.minBy([window.innerHeight-this.contentTop-50,510]),this.getData()},closePopup:function(){var t=this;if(!this.isOpening)return this.showList=!1,this.$emit("close"),new Promise((function(e){t.$on("afterClosePopup",e)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(t){t&&t.target&&t.target!==this.target&&this.show&&this.closePopup()},getData:function(){var e=this;return this.options&&this.options.length?(this.data=t.map(this.options,(function(t){return l(l({},t),{},{isOpen:!1})})),Promise.resolve()):o.a.getMeasureCheckItem(this.itemIds).then((function(i){e.data=t.map(i,(function(e){var i=e.content?e.content.trim():"",n=i?i.split("\n"):[],a=e.content_image?JSON.parse(e.content_image):[],r=t.filter(n,(function(t){return!/<img([\s\S]*)>/gm.test(t)}));return t.each(a,(function(t){t.url=t.url.split("@")[0]})),{id:e.id,name:e.full_name,textArr:r,contentImage:a,isOpen:!1}}))})).catch((function(t){console.error(t)}))},toggleItem:function(t){this.data.length>1&&this.$set(t,"isOpen",!t.isOpen)}}}}).call(this,i("391c"))},"91cb":function(t,e,i){"use strict";i("c82d")},9446:function(t,e,i){var n=i("2dd6");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("2192cd00",n,!0,{sourceMap:!1,shadowMode:!1})},9788:function(t,e,i){"use strict";i("9446")},"9dea":function(t,e,i){"use strict";i("fda1")},"9e2b":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,"[data-v-0f3c0354] .layout-content{display:flex;flex-direction:column;overflow:hidden;background:#fff}.zjapp .page-scroll[data-v-0f3c0354]{flex:1;overflow:auto;padding-bottom:100px}.zjapp .bread-crumb[data-v-0f3c0354]{padding:8px 15px;font-size:16px;line-height:30px;color:#999}.zjapp .bread-crumb .level-item i[data-v-0f3c0354]{font-size:12px;margin:0 10px}.zjapp .bread-crumb .level-item:last-child>i[data-v-0f3c0354]{display:none}.zjapp .bread-crumb .active[data-v-0f3c0354]{color:#4275e8}.zjapp .empty-msg[data-v-0f3c0354]{display:flex;align-items:center;justify-content:center;color:#c8c8c8;margin-top:30px}.zjapp .empty-msg .line[data-v-0f3c0354]{width:48px;margin:0 8px;border-top:1px solid #e4e4e4}[data-v-0f3c0354] .icon-qualified{color:#4275e8}.zjapp .place-item[data-v-0f3c0354]{align-items:center}",""])},a093:function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e"),i("f548");var n=i("28f8"),a=(i("9dd9"),i("cc57"),i("e204"),i("9eea")),r=i("3156b"),o=i("774b"),s=i("e89f"),c=i("6f9e");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"AppSingleSelect",components:{appSearchBar:a.default,item:r.a,Scroller:o.default},mixins:[s.a],props:{},data:function(){return{activeTab:[],storageKey:encodeURI(this.title||"singleSelectMark"),storageVal:[],keyword:"",searchStatus:!1,checkedItem:{},show:!1,searchData:[],options:[],optionsLimit:20,pagingOptions:!1,searchBar:!0,category:[],ifToggle:!1,editorAddData:!1,lineLimit:1}},computed:{optionsShow:function(){return this.options&&this.options.length?this.grouping?this.getGroupData():this.options.slice(0,this.optionsLimit):[]}},watch:{keyword:function(t){var e=this;this.$nextTick((function(){e.filterList(t)}))}},methods:{openPopup:function(e){if(console.log(e),this.value=!0,this.show=!0,this.category=[],c.a.$on("closeDialog",this.closePopup),this.title=e.title,this.selected=e.selected,this.checkedItem=e.selected,this.options=e.options,this.onSelect=e.onSelect,this.searchBar=e.searchBar,this.grouping=e.grouping,this.rightBtn=e.rightBtn,this.rightBtnEvent=e.rightBtnEvent,this.ifToggle=e.ifToggle,this.lineLimit=e.lineLimit,this.editorAddData=e.editorAddData,e.grouping&&e.autoOpen){var i=t.uniqBy(t.map(this.options,e.grouping));this.activeTab=t.map(i,(function(t,e){return e}))}this.storageKey=encodeURI(this.title||"singleSelectMark"),this.$emit("open")},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeEvent:function(){c.a.$off("closeDialog",this.closePopup),this.value=!1,this.show=!1,this.keyword="",this.searchStatus=!1,this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch()},customAddSupplier:function(t){return this.options.findIndex((function(e){return e.name===t}))},selectItem:function(t){var e=this;this.ifToggle&&this.checkedItem.id===t.id?this.checkedItem={}:this.checkedItem=t,this.onSelect(this.checkedItem),this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].saveHistory(),window.setTimeout((function(){e.closeEvent()}),300)},onSearchTypeChange:function(t){this.searchStatus=t},filterList:function(t){var e,i,n=this,a=new RegExp("("+t+")","gmi");if(this.category=[],this.keyword=t,this.searchData=[],!t)return!1;this.options.map((function(t){return a.test(t.name)&&(i=u(u({},t),{},{rename:t.name.replace(a,"<label>$1</label>")}),n.grouping?-1===(e=n.category.indexOf(i[n.grouping]))?(n.category.push(i[n.grouping]),n.searchData.push({name:i[n.grouping],children:[i]})):n.searchData[e].children.push(i):n.searchData.push(i)),t}))},pageOptions:function(){this.optionsLimit=this.optionsLimit+20,this.pagingOptions=!1},getGroupData:function(){var t,e=this,i=[];return this.category=[],this.options.map((function(n){return-1===(t=e.category.indexOf(n[e.grouping]))?(e.category.push(n[e.grouping]),i.push({name:n[e.grouping],children:[n]})):i[t].children.push(n),n})),i}}}}).call(this,i("391c"))},a300:function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e");var n=i("28f8"),a=i("e89f"),r=i("e2a7"),o=i("4360"),s=i("e223");function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}e.a={name:"DrawingDialog",store:o.a,components:{Drawing:s.a},mixins:[a.a],data:function(){return{show:!1,mode:"",url:"",points:[],folder:"",maxMarks:1/0,onmark:function(){}}},methods:{openPopup:function(t){return this.mode=t.mode,this.url=t.url,this.points=t.points,this.folder=t.folder,this.maxMarks=isNaN(t.maxMarks)?1/0:t.maxMarks,this.onmark=t.onmark,this.show=!0,this.$emit("open"),this},closePopup:function(){this.show=!1,this.$emit("close")},undo:function(){this.points.pop()},sure:function(){this.points.length?(this.closePopup(),this.onmark&&this.onmark(this.points)):r.a.alert("请先在户型图标记位置")},pointLight:function(e){this.points=t.map(this.points,(function(t,i){var a=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},t);return e===i?a.color="#4275e8":a.found?a.color="#14ff56":a.color="#ff4546",a}))},onclick:function(t){var e=this;if("view"===this.mode){if(t.clickPoint&&"points"===t.clickPoint.tag){var i=t.clickPoint.index;this.pointLight(i)}}else if("mark-val-group"===this.mode){if(this.points.length>=maxMarks)return void r.a.alert("爆点个数不能大于实测点数");this.points.push({x:t.x,y:t.y})}else if("multiple-remark"===this.mode)this.points.push({x:t.x,y:t.y});else{var n={x:t.x,y:t.y};this.points=[n],setTimeout((function(){e.closePopup(),e.onmark&&e.onmark(n)}),200)}}}}}).call(this,i("391c"))},a5c6:function(t,e,i){"use strict";var n=i("329b"),a=i("a093").a,r=(i("f3d7"),i("17cc")),o=Object(r.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{attrs:{title:t.title,mode:"dialog","on-close":t.closeEvent}},[t.rightBtn&&!t.editorAddData||t.rightBtn&&t.editorAddData&&(!t.selected.name||t.customAddSupplier(t.selected.name)>-1)?i("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:function(e){t.rightBtnEvent(t.category)}},slot:"header-bar-right"},[t._v("\n      "+t._s(t.rightBtn)+"\n    ")]):t._e(),i("scroller",{attrs:{"has-next":!t.searchStatus&&!t.grouping&&t.optionsLimit<t.options.length,"end-text":"","is-empty":0===t.optionsShow.length},on:{loadNext:t.pageOptions}},[t.searchBar?i("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":t.storageKey},on:{changeSearchStatus:t.onSearchTypeChange},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):t._e(),t.searchStatus?[t.keyword?[t.grouping?i("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.searchData,(function(e,n){return i("van-collapse-item",{key:n,attrs:{title:e.name,name:n}},t._l(e.children,(function(e,n){return i("item",{key:n,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit,"render-field":"rename"},on:{click:t.selectItem}})})))}))):t._e(),t.grouping&&!t.searchData.length?i("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容","show-style":"search"}}):t._e(),t.grouping?t._e():[t._l(t.searchData,(function(e,n){return i("item",{key:n,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit,"render-field":"rename"},on:{click:t.selectItem}})})),t.searchData.length?t._e():i("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容","show-style":"search"}})]]:t._e()]:["-1"===t.selected.id&&t.customAddSupplier(t.selected.name)<0&&t.editorAddData?i("div",{staticClass:"supplier-editor",on:{click:t.closePopup}},[i("span",{staticClass:"title"},[t._v(t._s(t.selected.name))]),i("span",{staticClass:"icon"},[i("i",{staticClass:"iconfont icon-edit margin-r",on:{click:t.rightBtnEvent}}),i("i",{staticClass:"iconfont icon-qualified"})])]):t._e(),t.grouping?i("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.optionsShow,(function(e,n){return i("van-collapse-item",{key:n,attrs:{title:e.name,name:n}},t._l(e.children,(function(e,n){return i("item",{key:n,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit},on:{click:t.selectItem}})})))}))):t._l(t.optionsShow,(function(e,n){return i("item",{key:n,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit},on:{click:t.selectItem}})})),t.optionsShow.length?t._e():i("loading-status",{attrs:{"is-empty":!0,"empty-text":"暂无数据","show-style":"search"}})]],2)],1):t._e()],1)}),[],!1,null,"e465319c",null).exports,s=!1;s||(s=new(n.default.extend(o))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},b55a:function(t,e,i){"use strict";i("c001")},b6da:function(t,e,i){"use strict";var n=i("329b"),a=i("a300").a,r=i("17cc"),o=Object(r.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{attrs:{mode:"dialog",title:"户型图","on-close":t.closePopup}},[i("drawing",{staticStyle:{flex:"1"},attrs:{url:t.url,points:t.points,folder:t.folder},on:{onclick:t.onclick}}),"multiple-remark"===t.mode?i("app-button-group",{attrs:{"fixed-bottom":"",seamless:""}},[i("app-button",{staticStyle:{width:"50%"},attrs:{type:t.points.length?"warning":"normal",plain:""},on:{click:t.undo}},[t._v("\n        撤销\n      ")]),i("app-button",{on:{click:t.sure}},[t._v(" 确定 ")])],1):t._e()],1):t._e()],1)}),[],!1,null,null,null).exports,s=!1;s||(s=new(n.default.extend(o))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},bebe:function(t,e,i){var n=i("6272");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("53478790",n,!0,{sourceMap:!1,shadowMode:!1})},c001:function(t,e,i){var n=i("f53a");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("bd5eb062",n,!0,{sourceMap:!1,shadowMode:!1})},c070:function(t,e,i){var n=i("574c");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("35590dcb",n,!0,{sourceMap:!1,shadowMode:!1})},c40a:function(t,e,i){"use strict";(function(t){i("cc57"),i("6d57"),i("6f84"),i("163d");var n=i("a32d"),a=i.n(n),r=i("e900"),o=i("3122"),s=i("4ad6"),c=i("3bd5"),l=i("1b7e");function u(t){var e=t.changedTouches.length,i=t.touches.length;return 1===e||2===e||2===i}function d(t){return 1===t.touches.length}e.a={name:"Drawing",props:{url:{type:String},points:{type:Array,default:function(){return[]}},regions:{type:Array,default:function(){return[]}},pointColor:{type:String,default:"#ff4546"},pointRadius:{type:Number,default:7},scaleMax:{type:Number,default:4},clickDelay:{type:Number,default:500},folder:{type:String,default:"house-image"},onlineMode:{type:Boolean,default:!1},contentScroll:{type:Boolean,default:!0}},data:function(){return{isDownloading:!1,error:"",canvas:null,ctx:null,img:null,src:"",width:0,height:0,x:0,y:0,scale:1,defaultScale:1,pixelRatio:1,markPosition:null,markPositionImageData:[],markCoordinates:[],pinchRatio:0,scaleBetween:[],isPinch:!1,clickPoints:[],touchStart:{x:0,y:0,cx:0,cy:0,time:0}}},watch:{url:function(){this.getImage()},points:function(t){this.ctx&&this.draw()},regions:function(t){this.ctx&&this.draw()}},mounted:function(){this.getImage()},destroyed:function(){this.canvas&&(this.canvas.width=0,this.canvas.height=0)},methods:{getImage:function(){var e=this;if(this.isDownloading=!0,this.url){var i=c.a.getUser().user_id,n=a.a.replaceAll(this.url,"\\?x-oss-process=image\\/resize,","@"),r=a.a.strRightBack(n,"/");if(!r)return this.error="户型图地址错误",void(this.isDownloading=!1);this.error="";var u=[s.a.appImagePath()+i+"/"+this.folder+"/"+r,s.a.appImagePath()+i+"/house-image/"+r,s.a.appImagePath()+i+"/drawing/"+r,s.a.appImagePath()+i+"/location-image/"+r,s.a.appImagePath()+i+"/images/"+r,s.a.appDataPath()+i+"/"+this.folder+"/"+r,s.a.appDataPath()+i+"/house-image/"+r,s.a.appDataPath()+i+"/drawing/"+r,s.a.appDataPath()+i+"/location-image/"+r,s.a.appDataPath()+i+"/images/"+r],d=Promise.resolve();return"dev"===APP_ENV||this.onlineMode?d=d.then((function(){return e.url})):t.each(u,(function(t){d=d.then((function(e){return e||s.a.isFileExists(t).then((function(e){if(e)return o.a._fixPath(t)}))}))})),d.then((function(t){if(!t)return l.a.getHasNetwork().then((function(t){return t?o.a.download(e.url,!0,e.folder).then((function(t){e.src=t})):Promise.reject("当前无网络")}));e.src=t})).then((function(){e.src?(e.img=new Image,e.img.onload=function(){e.img.complete?(e.isDownloading=!1,e.$nextTick(e.init)):(e.error="加载图片失败",e.isDownloading=!1)},e.img.onerror=function(){e.error="加载图片失败",e.isDownloading=!1},e.img.src=e.src):(e.error="下载户型图失败",e.isDownloading=!1)})).catch((function(i){e.error=t.isString(i)?i:"下载户型图失败",e.isDownloading=!1}))}this.error="户型图地址错误",this.isDownloading=!1},init:function(){if(this.$refs["drawing-canvas"]){var t=this.$refs.content;this.canvas=this.$refs["drawing-canvas"],this.ctx=this.canvas.getContext("2d"),this.width=t.offsetWidth,this.height=t.offsetHeight,this.pixelRatio=this.getPixelRatio(this.ctx),this.canvas.style.height=this.height+"px",this.canvas.style.width=this.width+"px",this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,!this.ctx.extended&&Object(r.a)(this.ctx),this.bindTouchEvent(),this.calc(),this.draw()}},getPixelRatio:function(t){var e=t.backingStorePixelRatio||CanvasRenderingContext2D.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e},calc:function(t){var e=this.width/this.img.width,i=this.img.height*e,n=this.height||i;i>this.height&&(e*=n/i),this.scale=e*this.pixelRatio,this.defaultScale=this.scale,this.scaleBetween=[this.scale,this.scale*this.scaleMax]},winToCanvas:function(t,e){var i=this.canvas.getBoundingClientRect();return{x:t-i.left*(this.canvas.width/(i.width*this.pixelRatio)),y:e-i.top*(this.canvas.height/(i.height*this.pixelRatio))}},isBoundary:function(t){switch(t){case"t":if(0===this.y)return!0;break;case"r":if(this.x<=this.canvas.width-this.img.width*this.scale)return!0;break;case"b":if(this.y<=this.img.height*this.scaleBetween[0]-this.img.height*this.scale)return!0;break;case"l":if(0===this.x)return!0}return!1},bindTouchEvent:function(){this.canvas.addEventListener("touchstart",this.onTouchstart),this.canvas.addEventListener("touchmove",this.onTouchmove),this.canvas.addEventListener("touchend",this.touchMoveAndEndHandler)},unbindTouchEvent:function(){this.canvas.removeEventListener("touchstart",this.onTouchstart),this.canvas.removeEventListener("touchmove",this.onTouchmove),this.canvas.removeEventListener("touchend",this.touchMoveAndEndHandler)},onTouchstart:function(t){if(this.isPinch=!1,d(t)){var e=t.touches[0],i=this.winToCanvas(e.clientX,e.clientY);this.touchStart={x:i.x,y:i.y,cx:e.clientX,cy:e.clientY,time:Date.now()}}else if(u(t)){var n,a=t.touches[0],r=t.touches[1],o=this.winToCanvas(a.clientX,a.clientY),s=this.winToCanvas(r.clientX,r.clientY);n=Math.sqrt(Math.pow(s.x-o.x,2)+Math.pow(s.y-o.y,2)),this.pinchRatio=this.scale/n}},onTouchmove:function(t){if(!1===this.contentScroll&&(t.preventDefault(),t.stopPropagation()),d(t))this.touchStart.cy>t.pageY&&this.isBoundary("b")||this.touchStart.cy<t.pageY&&this.isBoundary("t")||this.touchStart.cx>t.pageX&&this.isBoundary("r")||this.touchStart.cx<t.pageX&&this.isBoundary("l")||t.stopPropagation(),this.touchMoveAndEndHandler(t);else if(u(t)){t.stopPropagation();var e,i,n,a,r,o=t.touches[0],s=t.touches[1],c=this.winToCanvas(o.clientX,o.clientY),l=this.winToCanvas(s.clientX,s.clientY);i=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2)),this.isPinch=!0,(e=this.pinchRatio*i)>this.scaleBetween[0]&&e<this.scaleBetween[1]&&(a={x:((n={x:(c.x+l.x)/2*this.pixelRatio,y:(c.y+l.y)/2*this.pixelRatio}).x-this.x)/(this.img.width*this.scale),y:(n.y-this.y)/(this.img.height*this.scale)},n.newX=this.x+this.img.width*e*a.x,n.newY=this.y+this.img.height*e*a.y,r={x:n.newX-n.x,y:n.newY-n.y},e<this.scale&&this.setRange(this.x-r.x,this.y-r.y,e),e>this.scale&&(this.x=this.x-r.x,this.y=this.y-r.y),e!==this.scale&&(this.scale=e,this.draw()))}},touchMoveAndEndHandler:function(t){var e,i,n=t.type,a={touchmove:t.touches[0],touchend:t.changedTouches[0]}[n],r=this.winToCanvas(a.clientX,a.clientY);e=(r.x-this.touchStart.x)*this.pixelRatio,i=(r.y-this.touchStart.y)*this.pixelRatio,"touchend"===n&&Date.now()-this.touchStart.time<this.clickDelay&&Math.abs(a.clientX-this.touchStart.cx)<6&&Math.abs(a.clientY-this.touchStart.cy)<6?this.clickHandler(t):"touchmove"!==n||this.isPinch||(this.touchStart.x=r.x,this.touchStart.y=r.y,this.setRange(this.x+e,this.y+i,this.scale),this.draw())},isCanClick:function(t){for(var e=!1,i=0;i<this.markPosition.length;i++)if(parseFloat(t.x)>parseFloat(this.markPosition[i].x)&&parseFloat(t.x)<parseFloat(this.markPosition[i].x)+parseFloat(this.markPosition[i].w)&&parseFloat(t.y)>parseFloat(this.markPosition[i].y)&&parseFloat(t.y)<parseFloat(this.markPosition[i].y)+parseFloat(this.markPosition[i].h)){e=!0;break}return e},clickHandler:function(t){var e=t.changedTouches[0];if(this.mark){var i=this.winToCanvas(e.clientX,e.clientY),n={x:(i.x-this.x/this.pixelRatio)/(this.img.width*this.scale/this.pixelRatio),y:(i.y-this.y/this.pixelRatio)/(this.img.height*this.scale/this.pixelRatio)};if(i={x:n.x*this.img.width,y:n.y*this.img.height},this.isCanClick(i)){this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(i.x*this.scale/this.pixelRatio+this.x/this.pixelRatio,i.y*this.scale/this.pixelRatio+this.y/this.pixelRatio,this.scale===this.defaultScale?this.pointRadius:this.pointRadius*(1+(this.scale-this.defaultScale)/this.pixelRatio),0,2*Math.PI,!1),this.ctx.fill(),this.ctx.restore();var a={x:i.x,y:i.y};this.markCoordinates.push(a),this.points.push(a)}return!1}this.redraw(t,this.winToCanvas(e.clientX,e.clientY))},setRange:function(t,e,i){var n=this.img.width*i,a=this.img.height*i,r=this.canvas.width,o=this.canvas.height,s=this.img.height*this.scaleBetween[0];t=n<r?(r-n)/2:(t=t+n<r?r-n:t)>0?0:t,e=a<o?(o-a)/2:(e=e+a<s?s-a:e)>0?0:e,this.x=t,this.y=e},draw:function(){this.setRange(this.x,this.y,this.scale),this.drawImage(),this.drawPoints(),this.drawRegions()},redraw:function(t,e){this.clickPoints=[],this.drawImage(),this.drawPoints(e),this.drawRegions(e),this.clickCallback(t,this.clickPoints)},clickCallback:function(t,e){var i;e.some((function(t,e){return"points"===t.tag?(i=t,!0):(i=t,!1)}));var n=t.changedTouches[0],a=this.winToCanvas(n.clientX,n.clientY),r=(a.x-this.x/this.pixelRatio)/(this.img.width*this.scale/this.pixelRatio),o=(a.y-this.y/this.pixelRatio)/(this.img.height*this.scale/this.pixelRatio);(a={x:parseFloat((r*this.img.width).toFixed(2)),y:parseFloat((o*this.img.height).toFixed(2))}).y>=0&&a.x>=0&&a.y<=this.img.height&&a.x<=this.img.width&&this.$emit("onclick",{type:i?"point":"",points:this.points,point:i,clickPoint:i,x:a.x,y:a.y,scale:this.scale/this.pixelRatio})},drawImage:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.img,0,0,this.img.width,this.img.height,this.x,this.y,this.img.width*this.scale,this.img.height*this.scale)},drawPoints:function(t){var e=this;this.points.forEach((function(i,n){e.drawPoint(i.x*e.scale/e.pixelRatio+e.x/e.pixelRatio,i.y*e.scale/e.pixelRatio+e.y/e.pixelRatio,e.pointRadius,n,t,i.color)}))},drawPoint:function(t,e,i,n,a,r){this.ctx.save(),this.ctx.beginPath(),this.ctx.shadowBlur=i/2,this.ctx.shadowColor="black",this.ctx.fillStyle=r||this.pointColor,this.ctx.arc(t,e,i,0,2*Math.PI,!1),this.ctx.fill(),this.ctx.shadowBlur=0,this.ctx.shadowColor="transparent",this.ctx.restore(),i*=2,this.ctx.save(),this.ctx.beginPath(),this.ctx.strokeStyle="transparent",this.ctx.fillStyle="transparent",this.ctx.rect(t-i,e-i,2*i,2*i),this.ctx.stroke(),this.ctx.restore(),a&&this.ctx.isPointInPath(a.x*this.pixelRatio,a.y*this.pixelRatio)&&this.clickPoints.push({tag:"points",pos:a,index:n})},drawRegions:function(t){var e=this;this.regions&&this.regions.length&&this.regions.forEach((function(i,n){var a,r,o,s;e.ctx.beginPath(),i.area.forEach((function(t,i){var n=t[0]*e.scale/e.pixelRatio+e.x/e.pixelRatio,c=t[1]*e.scale/e.pixelRatio+e.y/e.pixelRatio;i?e.ctx.lineTo(n,c):e.ctx.moveTo(n,c),a=void 0===a?n:a<n?a:n,r=void 0===r?n:r>n?r:n,o=void 0===o?c:o<c?o:c,s=void 0===s?c:s>c?s:c})),e.ctx.closePath(),e.ctx.fillStyle="rgba(255, 144, 0, 0.4)",e.ctx.fill(),e.ctx.lineWidth=3,e.ctx.strokeStyle="#feda8e",e.ctx.stroke(),e.ctx.lineWidth=2,e.ctx.strokeStyle="rgba(0, 0, 0, 0.8)",e.ctx.stroke(),t&&e.ctx.isPointInPath(t.x*e.pixelRatio,t.y*e.pixelRatio)&&e.clickPoints.push({tag:"region",pos:t,index:n,regionData:i}),e.ctx.font='18px bold -apple-system, "Helvetica Neue", Roboto, "Segoe UI", sans-serif',e.ctx.textAlign="center",e.ctx.lineWidth=4,e.ctx.strokeStyle="#ffffff",e.ctx.strokeText(i.name,(r+a)/2,(s+o)/2+10),e.ctx.fillStyle="#111111",e.ctx.fillText(i.name,(r+a)/2,(s+o)/2+10)}))}}}}).call(this,i("391c"))},c726:function(t,e,i){"use strict";var n=i("329b"),a=(i("5ab2"),i("28f8")),r=(i("ed63"),i("8cf2"),i("e697"),i("6d57"),i("e10e"),i("cc57"),i("e204"),i("e89f")),o=i("07d2"),s=i("4e84");function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){Object(a.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var u=["building","unit","floor","room"],d=["unit"],p={name:"PlaceSelectDialog",components:{Item:o.default},mixins:[r.a],data:function(){return{show:!1,isLoading:!0,title:"",items:[],optionalItems:[],curItem:"",options:[],hasUnit:!1,projectId:"",sectionId:"",selected:{},defaultSelected:{},beforeConfirm:function(){},callback:function(){}}},computed:{crumbs:function(){var t=[],e=this.items,i=this.curItem,n=e.findIndex((function(t){return t===i}));if(n>=0)for(var a=0;a<=n;a++){var r=e[a],o=e[a-1],s=o?this.selected[o]&&this.selected[o].name:"全部";("unit"!==o||s)&&t.push({name:s,item:r})}return t},hasSelected:function(){return!!this.selected&&!!Object.keys(this.selected).length},prevItem:function(){var t=this,e=this.items.findIndex((function(e){return e===t.curItem}));return this.items[e-1]},nextItem:function(){var t=this,e=this.items.findIndex((function(e){return e===t.curItem}));return this.items[e+1]}},methods:{open:function(t){if(this.items=t.items||u,this.optionalItems=t.optionalItems||d,!this.items||!this.items.length)return Promise.reject(new Error("palce-select open() 参数错误"));this.curItem=this.items[0],this.projectId=t.projectId,this.sectionId=t.sectionId,this.defaultSelected=t.selected,this.title=t.title,this.beforeConfirm="function"==typeof t.beforeConfirm?t.beforeConfirm:function(){},this.callback="function"==typeof t.callback?t.callback:function(){},this.init(),this.show=!0},close:function(){this.show=!1},getDefaultId:function(t){if(!this.defaultSelected)return"";var e=this.defaultSelected[t];switch(t){case"section":return e&&e.id||"";case"building":return this.defaultSelected.building_id||e&&e.id||"";case"unit":return this.defaultSelected.unit_id||e&&e.id||"";case"floor":return("string"==typeof e?e:e&&e.id)||"";case"room":return this.defaultSelected.room_id||e&&e.id||""}},init:function(){var t=this,e=Promise.resolve(),i=!0;return this.selected={},this.curItem=this.items[0],this.items.forEach((function(n){e=e.then((function(){if(i)return t.getOptions(n).then((function(e){var a=t.getDefaultId(n),r=a&&(e||[]).find((function(t){return t.id===a}));if(!e||!e.length)return t.$set(t.selected,n,null),void(i=!!t.optionalItems.includes(n));r?(t.$set(t.selected,n,l({},r)),t.options=e,t.curItem=n,i=!0):(n===t.items[0]&&(t.options=e),i=!1)}))}))})),e},crumbClick:function(t){var e=this;this.curItem=t.item;var i=this.items.findIndex((function(t){return t===e.curItem}));return this.clearChildrenFromIndex(i),this.getOptions().then((function(t){if(e.options=t,"unit"===e.curItem&&(!e.options||!e.options.length)&&e.nextItem)return e.curItem=e.nextItem,e.getOptions().then((function(t){e.options=t}))}))},clearChildrenFromIndex:function(t){for(var e=this.items,i=t;i<e.length;i++){var n=e[i];this.$delete(this.selected,n)}},getOptions:function(t){var e=this;this.isLoading=!0,t=t||this.curItem;var i=this.items;return Promise.resolve().then((function(){var n=e.projectId,a=e.sectionId||e.selected&&e.selected.section&&e.selected.section.id,r=e.selected&&e.selected.building&&e.selected.building.id,o=e.selected&&e.selected.unit&&e.selected.unit.id,c=e.selected&&e.selected.floor&&e.selected.floor.id;switch(t){case"section":return s.a.getSections(n);case"building":return i.some((function(t){return"section"===t}))?s.a.getBuildingsBySection(a):s.a.getBuildingsByProject(n);case"unit":return s.a.getUnits(r);case"floor":return s.a.getFloors(r);case"room":return s.a.getRooms(r,o,c)}})).then((function(i){return"unit"===t&&(e.hasUnit=i&&i.length),i})).catch((function(t){$log.error(t)})).finally((function(){e.isLoading=!1}))},selectedItem:function(t){var e=this,i=this.items,n=this.curItem;if(n&&t){this.$set(this.selected,n,l({},t));var a=i.findIndex((function(t){return t===n}));this.clearChildrenFromIndex(a+1),this.nextItem?(this.curItem=this.nextItem,this.getOptions().then((function(t){if(e.options=t,"unit"===e.curItem&&(!e.options||!e.options.length)&&e.nextItem)return e.curItem=e.nextItem,e.getOptions().then((function(t){e.options=t}))})).then((function(){e.options&&e.options.length||e.finish()}))):this.finish()}},finish:function(){var t=this,e={fullname:""};this.items.forEach((function(i){var n=t.selected[i];n&&(e[i]=n,"floor"===i&&t.selected.room||(e.fullname+=n.name))}));var i=this.beforeConfirm&&this.beforeConfirm(e);i instanceof Promise||(i=Promise.resolve(i)),i.then((function(i){if(!1===i)return!1;t.callback&&t.callback(e)}))}}},h=(i("3e1e"),i("17cc")),f=Object(h.a)(p,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{attrs:{mode:"dialog",title:t.title,"on-close":t.close}},[i("div",{staticClass:"bread-crumb"},t._l(t.crumbs,(function(e){return i("span",{key:e.item,staticClass:"level-item",class:{active:e.item===(t.hasUnit||"unit"!==t.prevItem?t.curItem:t.prevItem)},on:{click:function(i){t.crumbClick(e)}}},[t._v("\n        "+t._s(e.name)),i("icon",{attrs:{name:"arrow-right"}})],1)}))),!t.isLoading&&t.options.length?i("div",{ref:"placeSelectScroll",staticClass:"page-scroll"},[t._l(t.options,(function(e,n){return i("item",{key:n,staticClass:"border-bottom place-item",attrs:{text:e.name,"icon-right":t.selected[t.curItem]&&t.selected[t.curItem].id===e.id?"qualified":""},on:{click:function(i){t.selectedItem(e)}}})})),i("div",{staticClass:"empty-msg"},[i("span",{staticClass:"line"}),t._v("\n        就这么多了\n        "),i("span",{staticClass:"line"})])],2):t._e(),!t.isLoading&&t.options.length?i("app-button-group",{attrs:{"fixed-bottom":""}},[i("app-button",{attrs:{disabled:!t.hasSelected},on:{click:t.finish}},[t._v("\n        确定\n      ")])],1):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.options||!t.options.length,"empty-text":"没有信息"}})],1):t._e()],1)}),[],!1,null,"0f3c0354",null).exports,m=!1;m||(m=new(n.default.extend(f))({el:document.createElement("div")}),document.body.appendChild(m.$el));e.a=m},c82d:function(t,e,i){var n=i("0c52");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("26e0fa2e",n,!0,{sourceMap:!1,shadowMode:!1})},d1d1:function(t,e,i){"use strict";(function(t){var n=i("fd50"),a=i("bcc7"),r=i("515e"),o=i("07d2"),s=i("7bac"),c=i("a7c3"),l=i("4360");e.a={name:"CheckGuideList",components:{Item:o.default},store:l.a,data:function(){return{isLoading:!0,listData:[],module:"",itemId:"",batchId:"",sectionId:"",options:""}},computed:{moduleAttribute:function(){return this.$store.state.global.moduleAttribute}},methods:{init:function(e){var i,a=this;for(var r in this.module=e.module,this.itemId=e.itemId,this.batchId=e.batchId,this.sectionId=e.sectionId,this.options=e.options,e)this[r]=e[r];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module];var o=!1;t.isEmpty(this.itemId)?!t.isEmpty(this.checkType)&&t.isEmpty(this.sectionId)?i=this.initByType():t.isEmpty(this.batchId)?t.isEmpty(this.options)?t.isEmpty(this.sectionId)?i=n.a.when():(o=!0,i=this.initByBidsection()):i=this.initByOptions():i=this.initByBatch():i=this.initById(),this.isLoading=!0,i.then((function(e){var i=a.moduleAttribute[a.module]||{};!t.isEmpty(i)&&i.setUsualItems&&o?s.a.getUserKey(a.mmkvCode()).then((function(t){t=null===t?e:a.mergeArray(a.deepClone(e),t),a.listData=t||[],a.isLoading=!1})):(a.listData=e||[],a.isLoading=!1)}))},mmkvCode:function(){var t=this.moduleAttribute[this.module]||{};return c.a[t.mmkv_item]+"_"+this.sectionId},mergeArray:function(e,i){var n=this;return t.filter(e,(function(e){var a=i[e.id];return t.isEmpty(e.subitem)||(e.subitem=n.mergeArray(e.subitem,i)),!t.isEmpty(a)||"desc"===e.type}))},clickItem:function(t){t.subitem&&t.subitem.length?this.$set(t,"isOpen",!t.isOpen):"special-inspect"===this.module?r.a.openPopup({itemId:t.id,module:this.module}):r.a.openPopup({itemId:t.item_id,module:this.module})},initById:function(){var t=this;if("special-inspect"!==this.module)return a.a.getCheckItem(this.itemId,this.checkType).then((function(e){return e?t.sectionId?a.a.getBidSectionCheckItemListByCode(t.sectionId,e.code):a.a.getCheckItemTreeByCode(e.code):n.a.when()}))},initByType:function(){return a.a.getCheckItemGuidelineList(this.checkType)},initByBatch:function(){return n.a.when()},initByBidsection:function(){return a.a.getBidSectionCheckItemTreeByType(this.sectionId,this.checkType)},initByOptions:function(){return n.a.resolve(this.options)},deepClone:function(t){return JSON.parse(JSON.stringify(t))}}}}).call(this,i("391c"))},dc98:function(t,e,i){"use strict";i("0732")},e223:function(t,e,i){"use strict";var n=i("c40a").a,a=(i("0aac"),i("17cc")),r=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._g({ref:"content",staticClass:"drawing-con"},t.$listeners),[t.isDownloading?[i("p",[i("svg",{staticClass:"svg-loading",attrs:{viewBox:"0 0 80 80"}},[i("circle",{attrs:{cx:"40",cy:"40",r:"36"}})])]),i("p",{staticClass:"loading-text"},[t._v("正在下载...")])]:[t.error?t._e():i("canvas",{ref:"drawing-canvas"}),t.error?i("p",{staticClass:"error-text"},[t._v(t._s(t.error))]):t._e()]],2)}),[],!1,null,"fba5990a",null);e.a=r.exports},e6ed:function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e");var n=i("28f8"),a=(i("e697"),i("9a33"),i("cc57"),i("774b")),r=i("f369"),o=i("07d2"),s=i("e68e"),c=i("3c64"),l=i("5a71"),u=i("1059"),d=i("cd05"),p=i("0f7b"),h=i("6948"),f=i("1405"),m=i("fd50"),g=i("e2a7"),b=i("6144"),v=i("5b5e"),_=i("3bd5"),y=i("b6da"),x=(i("06f6"),i("242b"),i("c745")),k=i("37d5"),w=i("5ff0"),P=(i("48f4"),i("6e1b")),j=i("e87d"),I=i("a500"),C=i("c058"),O=i("114f"),S=i("7bac"),D=i("a7c3");function $(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var B=_.a.getUser();e.a={name:"SpecialInspectProblemPureEdit",components:{Scroller:a.default,AppStepper:p.a,CheckGuide:r.a,Item:o.default,ItemImgList:s.a,ItemTextarea:c.a,SingleSelect:l.a,RadioBox:u.a,UserSelect:d.a,NumberInput:h.a,PlaceSelect:f.a},data:function(){return{isLoading:!1,specialInspectId:"",placeId:"",problemId:"",problemData:{},editalbe:!0,needRepair:!1,templateType:"",descriptionData:[],pageStatus:"",repairOptions:[],contractorOptions:[],reinspectOptions:[],ccOptions:[]}},computed:{edOptions:function(){return this.$store.state.global.problemLevelOptions},checkitemId:function(){return this.problemData&&this.problemData.checkItem&&this.problemData.checkItem.id||""},sectionId:function(){return this.problemData&&this.problemData.sec_id&&this.problemData.place.sec_id||""},buildingId:function(){return this.problemData&&this.problemData.place&&this.problemData.place.building_id||""},unit:function(){return this.problemData&&this.problemData.place&&this.problemData.place.unit||""}},watch:{needRepair:function(t){t&&this.getDefaultSettings()}},activated:function(){var t=this;this.specialInspectId=this.$route.query.specialInspectId,this.placeId=this.$route.query.placeId,this.problemId=this.$route.query.problemId,S.a.getUserKey(D.a.RECORDING_RECTITY).then((function(e){t.needRepair=e||!1})),this.init()},methods:{init:function(){var e=this;return this.isLoading=!0,Promise.resolve().then((function(){return e.problemId?O.a.getProblemData(e.problemId):O.a.createNewData(e.specialInspectId,e.placeId)})).then((function(e){return O.a.getDiagram(e.place).then((function(i){return e.drawing_file=t.isEmpty(i)?[]:[i],e}))})).then((function(t){e.problemData=t})).then((function(){k.default.getProjectUsers(e.problemData.proj_id,[31,32,33]).then((function(t){e.repairOptions=t,e.ccOptions=t,e.reinspectOptions=t}))})).then((function(){return e.loadContractor()})).then((function(){return P.a.getCheckItemDescList(e.checkitemId).then((function(t){t&&t.length>0?e.descriptionData=t:e.descriptionData=[]}))})).then((function(){e.editalbe=B.user_id===e.problemData.created_by,e.isLoading=!1})).catch((function(t){$log.error(t)}))},loadContractor:function(e){var i=this;return x.a.allowGroupUserByConstructor().then((function(n){if(n&&i.problemData.repair_set&&i.problemData.repair_set.id){var a=i.problemData.repair_set.id;return x.a.getOwnedContractorList(a).then((function(n){if(t.isEmpty(n))return w.a.getProjectContractorList(i.problemData.proj_id).then((function(t){i.contractorOptions=t}));e&&(i.problemData.contractor=n[0]),i.contractorOptions=n}))}return w.a.getProjectContractorList(i.problemData.proj_id).then((function(t){i.contractorOptions=t}))}))},getPlaceOptions:function(){return k.default.getPlaceList(this.problemData.proj_id)},showHuxingMark:function(e,i){var n=this,a=m.a.defer(),r=e;return e=e||this.problemData.drawing_file[0],i=i||{room_id:this.problemData.room_id,building_id:this.problemData.building_id,unit_id:this.problemData.unit,floor:this.problemData.floor},y.a.openPopup({mode:"multiple-remark",url:e.url,points:this.problemData.room_id===i.room_id?this.problemData.place_point:[],onmark:function(e){var i;i=t.isArray(e)?e:[e],n.$set(n.problemData,"place_point",i),r||n.saveProblem(),a.resolve()}}),a.promise},selectRepair:function(t){var e=this;return this.loadContractor(!0).then((function(){return e.saveProblem()}))},delProblem:function(){var t=this;this.editalbe&&g.a.popBox({title:"确定删除吗？",cancelText:"取消",okText:"删除"}).then((function(e){e&&v.a.delete(t.problemData.id).then((function(){t.$router.go(-1)})).catch((function(t){g.a.alert(t)}))}))},submit:function(){var e=this,i=this.problemData,n=(i.template_extension,i.image_file,this.problemData);if(this.formCheck=!0,this.needRepair){if(!n.repair_set.id)return g.a.alert("请选择整改人"),!1;if(t.isEmpty(n.reinspect_set))return g.a.alert("请选择复验人"),!1}if(!t.isEmpty(n.drawing_file)&&t.isEmpty(n.place_point))return g.a.notify("尚未标记户型图","去标记").then((function(){return e.showHuxingMark(null,{room_id:e.problemData.room_id,building_id:e.problemData.building_id,unit_id:e.problemData.unit,floor:e.problemData.floor,full_name:e.problemData.place.full_name})})),!1;this.editalbe&&($log.log("提交问题",n),g.a.loading("正在提交"),(n.id?m.a.when():this.saveProblem()).then((function(){return e.needRepair||(n.status="检查完毕"),v.a.submit(t.clone(n),"special-inspect-problem",Boolean(e.needRepair)).then((function(){return C.a.addLog({relation_id:n.id,business_type:"special-inspect",event:"登记问题",diff:{remark:n.remark,desc:t.isEmpty(n.description)?"":n.description.name},images:n.image_file})})).then((function(){if(e.needRepair)return C.a.addLog({relation_id:e.problemData.id,business_type:"special-inspect",event:"通知整改"})})).then((function(){e.recordingNeedRepair(),g.a.alert("提交成功"),e.$router.go(-1)})).catch((function(t){g.a.alert(t)})).finally((function(){g.a.hideLoading()}))})))},onPlaceSelect:function(e){var i=this,n={sec_id:e.building&&e.building.section_id||"",building_id:e.building&&e.building.id||"",floor:e.floor&&e.floor.id||"",full_name:e.fullname,room_id:e.room&&e.room.id||"",unit_id:e.unit&&e.unit.id||""};O.a.getDiagram(n).then((function(e){if(!t.isEmpty(e))return i.showHuxingMark(e,n).then((function(){i.problemData.drawing_file=[e],i.setPlace(n),i.$refs.checkEditPlaceSelect.close()}));i.problemData.place_point=[],i.problemData.drawing_file=[],i.setPlace(n),i.$refs.checkEditPlaceSelect.close()}))},getDefaultSettings:function(){var e=this,i=this.problemData;P.a.getDefaultSettings(this.sectionId,this.buildingId,this.unit,this.checkitemId).then((function(n){if(n){var a=n.repair,r=n.contractor_id,o=(n.reinspect||"").split(","),s=(n.cc||"").split(",");a&&j.a.getUser(a).then((function(t){i.repair_set={id:t.id,name:t.name}})),o.length&&j.a.getUsersByIds(o).then((function(t){i.reinspect_set=t})),s.length&&j.a.getUsersByIds(s).then((function(t){i.cc_set=t})),r&&e.contractorOptions.length&&(i.contractor=t.find(e.contractorOptions,(function(t){if(r===t.id)return!0})))}})).then((function(){return loadContractor(!0)}))},saveProblemAndBack:function(){var t=this;return this.saveProblem().then((function(){g.a.alert("保存成功"),setTimeout((function(){t.$router.go(-1)}),500)}))},saveProblem:function(){var t=this;return this.problemData.status="草稿",v.a.save(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?$(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},this.problemData)).then((function(e){t.problemData.id=e})).catch((function(t){$log.error(t)}))},setPlace:function(t,e){t.full_name&&(this.problemData.place=t,this.problemData.building_id=t.building_id,this.problemData.unit=t.unit_id,this.problemData.floor=t.floor,this.problemData.room_id=t.room_id,this.problemData.bidsection_id=t.sec_id,this.needRepair&&this.getDefaultSettings()),!e&&this.saveProblem(),b.a.saveObject(O.a.defaultPlaceKey,t,b.a.level.user)},setLevel:function(){I.a.addTrack("专项巡检-编辑草稿问题-切换紧急程度","",""),this.saveProblem()},recordingNeedRepair:function(){S.a.setUserKey(D.a.RECORDING_RECTITY,this.needRepair)}}}}).call(this,i("391c"))},e900:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a}));i("f548");function n(t){var e,i,n,a=(i=(e=t).backingStorePixelRatio||CanvasRenderingContext2D.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,(window.devicePixelRatio||1)/i);1!==a&&(!function(t,e){for(var i in t)t.hasOwnProperty(i)&&e(t[i],i)}({fillRect:"all",clearRect:"all",strokeRect:"all",moveTo:"all",lineTo:"all",arc:[0,1,2],arcTo:"all",bezierCurveTo:"all",isPointinPath:"all",isPointinStroke:"all",quadraticCurveTo:"all",rect:"all",translate:"all",createRadialGradient:"all",createLinearGradient:"all"},(function(e,i){var n;t[i]=(n=t[i],function(){var t,i,r=Array.prototype.slice.call(arguments);if("all"===e)r=r.map((function(t){return t*a}));else if(Array.isArray(e))for(t=0,i=e.length;t<i;t++)r[e[t]]*=a;return n.apply(this,r)})})),t.stroke=(n=t.stroke,function(){this.lineWidth*=a,n.apply(this,arguments),this.lineWidth/=a}),t.fillText=function(t){return function(){var e=Array.prototype.slice.call(arguments);e[1]*=a,e[2]*=a,this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,(function(t,e,i){return e*a+i})),t.apply(this,e),this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,(function(t,e,i){return e/a+i}))}}(t.fillText),t.strokeText=function(t){return function(){var e=Array.prototype.slice.call(arguments);e[1]*=a,e[2]*=a,this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,(function(t,e,i){return e*a+i})),t.apply(this,e),this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,(function(t,e,i){return e/a+i}))}}(t.strokeText),t.extended=!0)}var a=function(t){var e,i;(e=t).getContext=(i=e.getContext,function(t){var e,a,r=i.call(this,t);return"2d"===t&&(e=r.backingStorePixelRatio||CanvasRenderingContext2D.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1,(a=(window.devicePixelRatio||1)/e)>1&&(this.style.height=this.height+"px",this.style.width=this.width+"px",this.width*=a,this.height*=a)),n(r),r})}},e9ea:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .guide-box[data-v-ff0679ce]{flex:1;display:flex}.zjapp .page-scroll[data-v-ff0679ce]{flex:1;overflow:auto;padding-bottom:100px;transform:translateZ(0)}.zjapp .sublist[data-v-ff0679ce]{padding-left:25px;padding-top:1px;background-color:#fff}.zjapp .sublist>.sublist[data-v-ff0679ce]{padding-left:10px;padding-top:0}",""])},ebf1:function(t,e,i){"use strict";(function(t){e.a={name:"RadioBox",props:{options:{type:[Array,Object],default:function(){return[]}},value:{type:String,default:""},align:{type:String,default:"r"},customClass:{type:String,default:""}},data:function(){return{}},computed:{optionsType:function(){return t.isArray(this.options)?"array":t.isObject(this.options)?"object":""}},methods:{onSelect:function(t){var e;"array"===this.optionsType?e=this.options[t]:"object"===this.optionsType&&(e=t),this.$emit("input",e),this.$emit("onSelect",e)}}}}).call(this,i("391c"))},ef1c:function(t,e,i){var n=i("e9ea");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("2e832052",n,!0,{sourceMap:!1,shadowMode:!1})},f1e4:function(t,e,i){"use strict";(function(t){i("5ab2"),i("e10e");var n=i("28f8"),a=(i("9e76"),i("6d57"),i("9a33"),i("f548"),i("cc57"),i("4ad6")),r=i("e89f"),o=i("bcc7"),s=i("3122"),c=i("6e1b"),l=i("c130"),u=i("0636");function d(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function p(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?d(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"CheckGuideDetail",components:{},mixins:[r.a],data:function(){return{show:!1,isLoading:!0,isImageDownloading:!1,title:"",content:[],module:"",itemId:""}},methods:{openPopup:function(e){var i=this;for(var n in this.value=!0,this.show=!0,this.module=e.module,this.itemId=e.itemId,this.$emit("open"),e)this[n]=e[n];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module],this.isLoading=!0,("special-inspect"===this.module?c.a.getSpecialInspectCheckItemDetail(this.itemId):"templet-plan"===this.module?l.a.getTempletDetail(this.itemId):"material"===this.module?u.a.getMaterialDetail(this.itemId):o.a.getCheckItem(this.itemId,this.checkType)).then((function(e){console.log("checkitemData",e),e=e||{},i.checkitemData=e,i.title=e.full_name||e.name,"special-inspect"!==i.module&&"inspect"!==i.module&&"fly-inspect"!==i.module&&"material"!==i.module||(e.content=e.guideline||e.content);var n=e.content?e.content.trim():"";if(n=(n=(n=(n=(n=n.replace(/<\/p><p>/gm,"\n")).replace(/<p>/gm,"")).replace(/<\/p>/gm,"")).replace(/<br>/gm,"")).replace(/<br \/>/gm,""),/(<img[^\>]*>)/gm.test(n)){var a=n.split(/(<img[^\>]*>)/gm);(a=a.filter((function(t){return!!t}))).forEach((function(t,e){t&&!/^\s*\n/.test(t)&&e&&!/\n\s*$/.test(a[e-1])&&(a[e]="\n"+t)})),n=a.join("")}var r=n?n.split("\n"):[];i.content=t.map(r,(function(t,e){var i;if(/<img([\s\S]*)>/gm.test(t)){var n=t.split(/\ssrc="([^"]*)"/gm)[1],a=n?n.match(/[\w|-]{36}/gm)[0]:(new Date).getTime()+"-"+e;i={isImg:!0,src:"",url:n,status:"pending",id:a,ready:!0}}else i={isImg:!1,val:t};return i})),i.downloadImage(),i.isLoading=!1})).catch((function(t){$log.log(t)}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},getThumbnail:function(t){return"pending"===t.status?s.a.IMAGE_LOADING:"rejected"===t.status?s.a.IMAGE_RELOAD:"dev"===APP_ENV?t.url:"fulfilled"===t.status?t.src:($log.log("检查指引-显示图片：",t),s.a.IMAGE_PLACEHOLD)},imgError:function(t,e){$log.error("检查指引-加载图片出现错误：",t);var i=p({},t);i.status="rejected",this.$set(this.content,e,i)},downloadImage:function(e){var i=this;e=e?[e]:this.imageList(),t.each(e,(function(e){var n=p({},e),a=t.map(i.content,(function(t){return t.id})).indexOf(e.id);s.a.isNeedDownload(e.url).then((function(t){t?s.a.download(e.url).then((function(t){n.status="fulfilled",n.src=s.a.fixUrl(t),i.$set(i.content,a,n)})).catch((function(t){$log.error("检查指引-下载图片：",t)})):(n.status="fulfilled",n.src=s.a.fixUrl(s.a.getPathFromUrl(e.url)),i.$set(i.content,a,n))}))}))},imageList:function(){return t.filter(this.content,(function(t){return t.isImg}))},imgClick:function(e){var i=this;if("pending"===e.status)return!1;if("rejected"===e.status)return this.downloadImage(e),$log.log("检查指引-点击重新加载-重新下载图片：",e),!1;var n=this.imageList(),r=t.map(n,(function(t){return t.id})).indexOf(e.id);n=t.map(n,(function(t){return i.getThumbnail(t)})),a.a.openImageBrowser(n,r)}}}}).call(this,i("391c"))},f369:function(t,e,i){"use strict";var n=i("fd50"),a=i("bcc7"),r=i("329b"),o=i("d1d1").a,s=(i("3411"),i("17cc")),c={name:"CheckGuideList",components:{GuideList:Object(s.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"guide-box"},[!t.isLoading&&t.listData.length?i("div",{staticClass:"page-scroll"},t._l(t.listData,(function(e,n){return i("div",{key:n},[i("item",{attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text fw-b color-blue one-line"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,n){return i("div",{key:n,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,n){return i("div",{key:n,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,n){return i("div",{key:n,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])])],1)})):t._e()],2)})):t._e()],2)})):t._e()],2)}))):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.listData.length,"empty-text":"没有检查项"}})],1)}),[],!1,null,"ff0679ce",null).exports},mixins:[i("e89f").a],data:function(){return{show:!1}},methods:{openPopup:function(t){var e=this;this.value=!0,this.show=!0,this.$nextTick((function(){e.$refs["guide-list"].init(t),e.$emit("open")}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")}}},l=Object(s.a)(c,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"slide-right"}},[this.show?e("page-content",{attrs:{mode:"dialog",title:"检查指引","on-close":this.closePopup}},[e("guide-list",{ref:"guide-list"})],1):this._e()],1)}),[],!1,null,null,null).exports,u=!1;u||(u=new(r.default.extend(l))({el:document.createElement("div")}),document.body.appendChild(u.$el));var d=u,p=i("515e"),h=i("91c1").a,f=(i("dc98"),Object(s.a)(h,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"main",style:{top:t.contentTop+"px"}},[i("i",{staticClass:"arrow"}),i("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePopup(e)}}},[i("transition",{attrs:{name:"slide-down"},on:{enter:function(e){t.isOpening=!0},"after-enter":function(e){t.isOpening=!1},leave:function(e){t.isClosing=!0},"after-leave":t.afterClose}},[t.showList?i("div",{staticClass:"box",style:{height:t.listHeight+"px"}},t._l(t.data,(function(e,n){return i("div",{key:n,class:{"border-bottom":t.data.length>1,"box-single":1===t.data.length}},[i("div",{staticClass:"detail-hd",class:{"border-bottom":t.data.length<=1,"detail-hd-single":t.data.length<=1},on:{click:function(i){t.toggleItem(e)}}},[t.data.length>1?i("i",{class:{"detail-arrow-right":!e.isOpen,"detail-arrow-down":e.isOpen}}):t._e(),i("div",{staticClass:"detail-title"},[t._v(t._s(e.name))])]),t.data.length<=1||e.isOpen?i("div",{staticClass:"detail-bd",class:{"detail-bd-single":t.data.length<=1}},[t._l(e.textArr,(function(e,n){return i("p",{key:n,staticClass:"text-line"},[t._v("\n              "+t._s(e)+"\n            ")])})),i("item-img-list",{attrs:{editabled:!1},model:{value:e.contentImage,callback:function(i){t.$set(e,"contentImage",i)},expression:"item.contentImage"}}),i("loading-status",{attrs:{"is-empty":!e.textArr.length&&!e.contentImage.length,"empty-text":"PC端未设置检查指引"}})],2):t._e()])}))):t._e()])],1)]):t._e()}),[],!1,null,"2cac8864",null).exports),m=!1;m||(m=new(r.default.extend(f))({el:document.createElement("div")}),document.body.appendChild(m.$el));var g=m,b={name:"CheckGuide",components:{},props:{module:{type:String,default:""},mode:{type:String,default:"page"},itemId:{type:String,default:""},itemIds:{type:Array,default:function(){return[]}},batchId:{type:String,default:""},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}},optionsPromise:{type:Function,default:function(){}},beforeOpen:{type:Function,default:function(){}}},data:function(){return{isLoading:!1}},methods:{openCheckGuide:function(){var t=this,e=this.beforeOpen&&this.beforeOpen();e instanceof Promise||(e=Promise.resolve(e)),e.then((function(e){!1!==e&&("drop"===t.mode?g.openPopup({itemIds:t.itemIds,el:t.$refs["check-guide-btn"],options:t.options}):("templet-plan"===t.module?n.a.when(!1):t.itemId&&t.sectionId?a.a.hasChildSectionCheckItem(t.itemId,t.sectionId):t.itemId?a.a.hasChildCheckItem(t.itemId):n.a.when(!0)).then((function(e){e?d.openPopup({module:t.module,itemId:t.itemId,batchId:t.batchId,sectionId:t.sectionId,options:t.options}):p.a.openPopup({itemId:t.itemId,module:t.module})})))}))}}},v=Object(s.a)(b,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"check-guide-btn",staticClass:"header-btn",on:{click:function(e){t.openCheckGuide()}}},[i("icon",{attrs:{name:"nav-info"}})],1)}),[],!1,null,null,null);e.a=v.exports},f3d7:function(t,e,i){"use strict";i("9120")},f53a:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .number-keyboard-con[data-v-6337f428]{position:absolute;left:0;bottom:0;width:100%;padding:4px 0;background-color:#fafafa;box-shadow:0 -4px 8px 0 rgba(0,0,0,.08);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.zjapp .ios-bezel-less[data-v-6337f428]{padding-bottom:34px}.zjapp .keyboard-row[data-v-6337f428],.zjapp .keys-row[data-v-6337f428]{display:flex}.zjapp .row-span-1[data-v-6337f428]{flex:1}.zjapp .row-span-2[data-v-6337f428]{flex:2}.zjapp .row-span-3[data-v-6337f428]{flex:3}.zjapp .keys[data-v-6337f428]{flex:1;height:48px;line-height:48px;text-align:center;font-size:18px;margin:4px;border:1px solid rgba(5,5,5,.07);border-radius:8px;background-color:#fff;padding:0}.zjapp .keys-next[data-v-6337f428],.zjapp .keys-prev[data-v-6337f428]{font-size:14px;color:#4275e8}.zjapp .keys-ok[data-v-6337f428]{font-size:14px;color:#999}.zjapp .keys-delete[data-v-6337f428]{color:#999}.zjapp .icon[data-v-6337f428]{pointer-events:none}.zjapp .icon-keyboard-close[data-v-6337f428]{font-size:20px;color:#999}.zjapp .icon-keyboard-delete[data-v-6337f428]{vertical-align:top;margin-top:13px;font-size:14px;color:#333}.zjapp .activing[data-v-6337f428]{background-color:#ececec}.zjapp .disabled[data-v-6337f428]{color:#999}.zjapp .col[data-v-6337f428]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:104px;line-height:36px}",""])},fda1:function(t,e,i){var n=i("19a7");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("cb2469e8",n,!0,{sourceMap:!1,shadowMode:!1})}}]);