(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["report-water-percolation-project-list"],{"0a47":function(t,e,a){"use strict";a.r(e);var r=a("4377").a,o=(a("11e3"),a("17cc")),i=Object(o.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-content",{attrs:{title:t.title,"show-go-root":"Report"}},[a("div",{staticClass:"report-closed-water-list-wrap"},["error"!==t.errorType?a("div",{staticClass:"filter-tabs"},t._l(t.tabData,(function(e,r){return a("div",{key:r,staticClass:"filter-tab",class:{current:t.filterType===e.status},on:{click:function(a){t.changeTab(e.status)}}},[a("i",{directives:[{name:"show",rawName:"v-show",value:r>0,expression:"index > 0"}],staticClass:"status",class:e.status}),t._v("\n        "+t._s(e.name)+"\n        "),a("br"),t._v("\n        "+t._s(e.number)+"\n      ")])}))):t._e(),t.list.length?a("scroller",{staticClass:"place-box"},[a("place-list",{directives:[{name:"track",rawName:"v-track",value:"闭水试验报表-进入房间",expression:"'闭水试验报表-进入房间'"}],attrs:{data:t.list,"has-title":!0,"new-style":!0,"status-class":{"合格":"bg-green","不合格":"bg-red","已放水待验收":"bg-orange"}},on:{click:t.goDataetail}})],1):t._e(),a("loading-status",{style:{"margin-top":!t.list.length&&t.resData.length?"-50px":""},attrs:{"is-loading":t.isLoading,"is-empty":!t.resData.length||!t.list.length,type:t.errorType,"empty-text":"report"===t.errorType?"没有报表数据":""}})],1)])}),[],!1,null,"5938460e",null);e.default=i.exports},"11e3":function(t,e,a){"use strict";a("cafd")},1482:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .report-closed-water-list-wrap[data-v-5938460e]{height:100%;overflow:hidden;background-color:#fff}.zjapp .report-closed-water-list-wrap .filter-tabs[data-v-5938460e]{display:flex;margin:0 0 15px 0}.zjapp .report-closed-water-list-wrap .filter-tab[data-v-5938460e]{flex:1;min-height:44px;line-height:16px;padding:10px 5px 0;text-align:center;font-size:12px;color:#999;background-color:#fafafa;border-right:1px solid #ececec;border-bottom:1px solid #ececec}.zjapp .report-closed-water-list-wrap .filter-tab .status[data-v-5938460e]{display:inline-block;width:8px;height:8px;margin:0 0 1px 0;border-radius:50%;border:1px solid #dcdcdc;background-color:#fff}.zjapp .report-closed-water-list-wrap .filter-tab .status.uncheck[data-v-5938460e]{border-color:#ff8e24;background-color:#ff8e24}.zjapp .report-closed-water-list-wrap .filter-tab .status.qualified[data-v-5938460e]{border-color:#0bc666;background-color:#0bc666}.zjapp .report-closed-water-list-wrap .filter-tab .status.unqualified[data-v-5938460e]{border-color:#ff3c46;background-color:#ff3c46}.zjapp .report-closed-water-list-wrap .filter-tab[data-v-5938460e]:last-child{border-right:none}.zjapp .report-closed-water-list-wrap .filter-tab.current[data-v-5938460e]{border-bottom:none;background-color:#fff;color:#666}.zjapp .report-closed-water-list-wrap .place-box[data-v-5938460e]{height:100%;padding-bottom:100px;overflow:auto}",""])},4377:function(t,e,a){"use strict";(function(t){a("163d");var r=a("e2a7"),o=a("774b"),i=a("efa7"),s=a("7cb8"),n=a("162a");e.a={name:"ReportWaterPercolationList",components:{Scroller:o.default,PlaceList:i.a},data:function(){return{isLoading:!0,errorType:"report",resData:[],list:[],title:"...",projId:"",buildingId:"",unit:"",filterType:"",tabData:[{name:"全部",status:"all",number:0},{name:"未放水",status:"unwatering",number:0},{name:"待验收",status:"uncheck",number:0},{name:"合格",status:"qualified",number:0},{name:"不合格",status:"unqualified",number:0}]}},activated:function(){this.$router.isBack||this.init()},methods:{init:function(){this.resData=[],this.list=[];var t=this.$route.query,e=t.proj_id,a=t.building_name,r=t.building_id,o=t.unit,i=t.filter;this.title=a+Object(s.a)(o,"单元"),this.projId=e,this.filterType=i,this.buildingId=r,this.unit=o,this.getReportData(i)},getReportData:function(e){var a=this;this.isLoading=!0,this.errorType="report";var o={proj_id:this.projId,building_id:this.buildingId,unit:this.unit};n.a.request("/report/close-water-test-list",o).then((function(r){a.resData=r;var o=[r.length,0,0,0,0],i=o[0],s=o[1],n=o[2],l=o[3],c=o[4];t.each(r,(function(t){t.status||(s+=1),"已放水待验收"===t.status&&(n+=1),"合格"===t.status&&(l+=1),"不合格"===t.status&&(c+=1)})),a.tabData[0].number=i,a.tabData[1].number=s,a.tabData[2].number=n,a.tabData[3].number=l,a.tabData[4].number=c,a.list=a.formatData(r,e)})).catch((function(t){a.resData=[],a.list=[],a.errorType="error",r.a.alert(t)})).finally((function(){a.isLoading=!1}))},formatData:function(e,a){var r=this,o="all";"unwatering"===a?o="":"uncheck"===a?o="已放水待验收":"unqualified"===a?o="不合格":"qualified"===a&&(o="合格"),"all"!==o&&(e=t.filter(e,(function(t){return t.status===o})));var i=[],n=t.groupBy(e,(function(t){return t.floorName=Object(s.a)(t.floor,"层"),t.name=t.room_no,t.room_name=t.room_no,t.floor}));return t.each(n,(function(t,e){i.push({building_id:r.buildingId,floor:e,floorName:Object(s.a)(e,"层"),name:Object(s.a)(e,"层"),children:t,floor_sort:Number((t[0]||{}).floor_sort)})})),i=t.sortBy(i,"floor_sort"),console.log({list:i}),i},goDataetail:function(t){if(t.status){var e={id:t.id,title:this.title+t.floorName+t.room_name,roomId:t.room_id};this.$router.push({name:"ReportWaterPercolationDetail",query:e})}},changeTab:function(t){this.filterType=t,this.list=this.formatData(this.resData,t)}}}}).call(this,a("391c"))},cafd:function(t,e,a){var r=a("1482");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,a("85cb").default)("45197a4a",r,!0,{sourceMap:!1,shadowMode:!1})}}]);