(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-55a1622d"],{"116e":function(t,a,e){var i=e("63c4");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,e("85cb").default)("705e9c2b",i,!0,{sourceMap:!1,shadowMode:!1})},"63c4":function(t,a,e){(t.exports=e("690e")(!1)).push([t.i,".zjapp .page-user[data-v-6cc6db10]{background:#f2f2f2}.zjapp .tips-text[data-v-6cc6db10]{padding:10px 15px;color:#8c8c8c;font-size:14px;line-height:16px}",""])},cb02:function(t,a,e){"use strict";(function(t){var i=e("3bd5"),n=e("e2a7"),c=e("fd50"),o=e("116c"),r=e("162a"),s=e("48f4"),u=e("24de"),l=e("aaa9"),d=e("07d2"),h=e("c745"),p=e("a500"),f=e("b5fb");a.a={name:"Setting",components:{Item:d.default},data:function(){return{user:{},checked:!1,automatic_load_data:!1,picture_saving_album:!1,allowDownloadImageSetting:!1,allowSettingWaterMark:!1}},computed:{isSuperApp:function(){return!0===window.__YL_SUPER_APP__}},mounted:function(){var t=this;this.user=i.a.getUser(),o.a.getDataConn(this.user.tenant_code,this.user.user_code).then((function(a){t.checked=a||!1})),this.getPictureAlbumData()},activated:function(){var t=this;h.a.allowDownloadImageSetting().then((function(a){t.allowDownloadImageSetting=a})),h.a.getAutomaticLoadData().then((function(a){t.automatic_load_data=a})),f.a.getSettingWaterMarkLimit().then((function(a){t.allowSettingWaterMark=!!a.length}))},methods:{getPictureAlbumData:function(){var t=this;h.a.getPictureAlbumSetting().then((function(a){t.picture_saving_album=!!a&&a.picture_saving_album}))},switchChecked:function(t){var a=this;o.a.setDataConn(this.user.tenant_code,this.user.user_code,this.checked?"1":"0").then((function(t){n.a.alert("设置成功"),a.checked?p.a.addTrack("我-首页-启用仅wifi"):p.a.addTrack("我-首页-关闭仅wifi")}),(function(t){a.checked=!a.checked,n.a.alert(t)}))},switchPhotoChecked:function(){var t=this;h.a.savePictureAlbumSetting({picture_saving_album:this.picture_saving_album}).then((function(){n.a.alert("设置成功")})).catch((function(a){t.picture_saving_album=!t.picture_saving_album,n.a.alert(a)}))},batchDownLoad:function(){var t=this;h.a.allowProcessAccept().then((function(){t.$router.push("/user-batch-download")}))},downloadSetting:function(){this.$router.push({name:"AutoDownloadSetting"})},watermarkSetting:function(){this.$router.push({name:"waterMarkSetting"})},clearData:function(){var a=this;return $rootScope.execCheckAppUpdate?n.a.alert("后台正在进行App更新检测，请稍后重试"):r.a.isBackgroundTaskWorking()?n.a.alert("后台正在进行问题数据更新，请稍后重试"):void u.a.checkHasNetwork().then((function(){n.a.confirm("清除全部已下载和在本机创建的数据，不影响已上传数据，确定要清楚数据？").then((function(e){if(e){s.default.clearDownloadImageQueue();var i="";n.a.loading("正在备份数据..."),$log.log("正在上传数据库文件..."),l.a.uploadDebugData().then((function(t){return i=t,$log.log("正在提交备份数据..."),l.a.backupDatabase(t)})).then((function(){n.a.hideLoading()})).catch((function(a){return n.a.hideLoading(),c.a.when().then((function(){if(a&&a.isNotify)n.a.alert(a.msg);else{if("当前网络无法同步数据"!==a)return t.isString(a)||(a=JSON.stringify(a)),$log.error("备份数据失败",a),n.a.alert("备份数据失败，产品团队会排查问题并通知您"),l.a.submitFeedback({remark:a,debug_file:i,is_sys_submit:1}).catch((function(t){}));n.a.alert(a)}})).then((function(){return n.a.confirm("备份数据失败，是否继续清除数据？").then((function(t){if(!t)return c.a.reject(a)}))}))})).then((function(){return r.a.beginManualUpdate(),s.default.executeUpload().then((function(){a.$router.push({name:"DataClear"})})).catch((function(e){if(e&&e.isNotify)n.a.alert(e.msg);else{if("当前网络无法同步数据"!==e)return t.isString(e)||(e=JSON.stringify(e)),n.a.alert("上传数据失败，产品团队会排查问题并通知您"),l.a.submitFeedback({remark:e,debug_file:i,is_sys_submit:1}).catch((function(){})).then((function(){return n.a.confirm("上传数据失败，是否继续清除数据？").then((function(t){t&&a.$router.push({name:"DataClear"})}))}));n.a.alert(e)}})).finally((function(){r.a.endManualUpdate()}))}))}}))}))},switchLoadData:function(t){h.a.setAutomaticLoadData(t)}}}}).call(this,e("391c"))},e002:function(t,a,e){"use strict";e.r(a);var i=e("cb02").a,n=(e("f437"),e("17cc")),c=Object(n.a)(i,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("page-content",{attrs:{title:"设置"}},[t.isSuperApp?t._e():e("item",{staticClass:"mt10"},[e("div",{staticClass:"item-text"},[t._v("仅WiFi上传下载")]),e("van-switch",{staticStyle:{"margin-top":"3px"},attrs:{size:"26px"},on:{change:t.switchChecked},model:{value:t.checked,callback:function(a){t.checked=a},expression:"checked"}})],1),e("item",{staticClass:"mt10"},[e("div",{staticClass:"item-text"},[t._v("自动加载模块数据")]),e("van-switch",{staticStyle:{"margin-top":"3px"},attrs:{size:"26px"},on:{change:t.switchLoadData},model:{value:t.automatic_load_data,callback:function(a){t.automatic_load_data=a},expression:"automatic_load_data"}})],1),e("item",{staticClass:"mt10"},[e("div",{staticClass:"item-text"},[t._v("拍照后在手机相册留存副本")]),e("van-switch",{staticStyle:{"margin-top":"3px"},attrs:{size:"26px"},on:{change:t.switchPhotoChecked},model:{value:t.picture_saving_album,callback:function(a){t.picture_saving_album=a},expression:"picture_saving_album"}})],1),t.isSuperApp?t._e():e("item",{staticClass:"mt10",attrs:{text:"批量下载离线数据","icon-right":"arrow-right"},on:{click:t.batchDownLoad}}),t.allowDownloadImageSetting&&!t.isSuperApp?e("item",{staticClass:"mt10",attrs:{text:"自动下载内容","icon-right":"arrow-right"},on:{click:t.downloadSetting}}):t._e(),t.allowSettingWaterMark?e("item",{staticClass:"mt10",attrs:{text:"水印开关","icon-right":"arrow-right"},on:{click:t.watermarkSetting}}):t._e(),t.isSuperApp?t._e():e("item",{directives:[{name:"track",rawName:"v-track",value:"我-个人信息-清除数据",expression:"'我-个人信息-清除数据'"}],staticClass:"mt10",attrs:{text:"清除数据","icon-right":"arrow-right"},on:{click:t.clearData}})],1)}),[],!1,null,"6cc6db10",null);a.default=c.exports},f437:function(t,a,e){"use strict";e("116e")}}]);