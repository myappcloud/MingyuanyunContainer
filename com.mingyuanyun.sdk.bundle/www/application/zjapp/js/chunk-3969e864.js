(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-3969e864"],{"6d8b":function(t,e,i){"use strict";i.r(e);var a=i("f1d7").a,o=(i("d3d5"),i("17cc")),r=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{title:"人员进出场登记","show-go-root":!0}},[i("div",{staticClass:"app-search-bar has-history-list bg-white"},[i("div",{staticClass:"app-search-input-wrap border-bottom"},[i("div",{staticClass:"app-search-input-box"},[i("app-label",{staticClass:"app-search-label app-search-label-focus",attrs:{for:"app-search-bar-input"}},[i("icon",{staticClass:"app-search-icon",attrs:{name:"sousuo-user"}})],1),i("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],ref:"app-search-bar-input",staticClass:"app-search-input",attrs:{id:"app-search-bar-input",type:"text",placeholder:"请输入人员名称"},domProps:{value:t.keyword},on:{input:function(e){e.target.composing||(t.keyword=e.target.value)}}}),t.keyword?i("app-label",{staticClass:"app-search-clear",attrs:{for:"app-search-bar-input"},on:{click:t.clearKeyword}}):t._e()],1)]),t.keyword?[!t.isLoading&&t.list&&t.list.length?i("scroller",{attrs:{"has-next":t.list.length<t.total},on:{loadNext:t.nextPage}},t._l(t.list,(function(e){return i("item",{key:e.id,attrs:{text:e.name+" "+(e.mobile?"(":"")+e.mobile+(e.mobile?")":""),border:"bottom"},on:{click:function(i){t.gotoAdd(e)}}})}))):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.list||!t.list.length,type:"search","empty-text":"没有查询到相关人员"}},[i("app-button",{staticClass:"btn-empty-add",attrs:{slot:"empty-content",name:"添加临时进出场人员"},on:{click:function(e){t.gotoAdd()}},slot:"empty-content"})],1)]:i("div",{staticClass:"app-search-history",class:{"app-search-history-empty":!t.searchHistory.length}},[t.searchHistory&&t.searchHistory.length?i("item",{staticClass:"item-history-title",attrs:{text:"搜索历史",border:"bottom"}},[i("icon",{attrs:{slot:"icon-right",name:"delete"},on:{click:t.deleteHistoryAll},slot:"icon-right"})],1):t._e(),t._l(t.searchHistory,(function(e){return i("item",{key:e.id,staticClass:"item-history",attrs:{border:"bottom"},on:{click:function(i){t.gotoAdd(e)}}},[i("div",{staticClass:"item-text"},[t._v(t._s(e.name+" ("+e.mobile+")"))]),i("icon",{attrs:{name:"nav-close"},on:{click:function(i){i.stopPropagation(),t.deleteHistory(e)}}})],1)})),i("div",{staticClass:"align-c mt10"},[t.searchHistory.length?i("app-button",{staticClass:"btn-empty-add",attrs:{name:"添加临时进出场人员"},on:{click:function(e){t.gotoAdd()}}}):t._e()],1),i("loading-status",{attrs:{"is-empty":!t.searchHistory.length,type:"search","empty-text":"没有搜索历史"}},[i("app-button",{staticClass:"btn-empty-add",attrs:{slot:"empty-content",name:"添加临时进出场人员"},on:{click:function(e){t.gotoAdd()}},slot:"empty-content"})],1)],2)],2)])}),[],!1,null,"3e42b4a4",null);e.default=r.exports},"774b":function(t,e,i){"use strict";var a=i("d18d").a,o=(i("b225"),i("17cc")),r=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"scroll-warp",staticClass:"scroll-warp",class:{"scroll-warp-pulling":t.pulling,"scroll-warp-complete":!t.hasNext&&!t.isEmpty,"scroll-warp-empty":t.isEmpty},style:{"padding-bottom":t.numberKeyboardCoverHeight+"px"},on:{scroll:t.onScroll,touchstart:t.onTouchstart,touchmove:t.onTouchmove,touchend:t.onTouchend}},[t.allowPullDown?i("div",{staticClass:"pull-refresh-warp",style:{height:t.pullDist+"px"}},[i("div",{staticClass:"pull-refresh"},[i("div",{staticClass:"animation-refresher",class:{refreshing:t.refreshing}}),t.updateTime?i("p",{staticClass:"pull-refresh-date"},[t._v("最后成功同步："+t._s(t.updateTime))]):t._e()])]):t._e(),t._t("default"),t.loading?i("div",{staticClass:"page-loading"},[i("svg",{staticClass:"svg-loading",attrs:{viewBox:"0 0 80 80"}},[i("circle",{attrs:{cx:"40",cy:"40",r:"36"}})])]):t._e(),t.hasNext||t.isEmpty?t._e():[t.$slots.end?t._t("end"):t._e(),!t.$slots.end&&t.endText?i("div",{staticClass:"end-text"},[t._v("\n      "+t._s(t.endText)+"\n    ")]):t._e()]],2)}),[],!1,null,"2b1a346c",null);e.a=r.exports},"7fdb":function(t,e,i){var a=i("cc9e");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("b806d882",a,!0,{sourceMap:!1,shadowMode:!1})},"9d55":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .scroll-warp[data-v-2b1a346c]{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}.zjapp .scroll-warp-pulling[data-v-2b1a346c]{overflow:hidden}.zjapp .scroll-warp-complete[data-v-2b1a346c]:after{content:"";display:block;height:100px}.zjapp .scroll-warp-empty[data-v-2b1a346c]{display:flex;flex-direction:column}.zjapp .pull-refresh-warp[data-v-2b1a346c]{position:relative;height:0;overflow:hidden}.zjapp .pull-refresh[data-v-2b1a346c]{position:absolute;left:0;bottom:0;height:70px;width:100%;padding:6px;text-align:center}.zjapp .pull-refresh-date[data-v-2b1a346c]{margin-top:4px;height:16px;line-height:16px;font-size:12px;color:#bcbcbc}.zjapp .page-loading[data-v-2b1a346c]{padding:10px;text-align:center}.zjapp .end-text[data-v-2b1a346c]{color:#c8c8c8;background:#f4f4f4;position:relative;line-height:76px;height:76px;text-align:center}.zjapp .end-text[data-v-2b1a346c]:after,.zjapp .end-text[data-v-2b1a346c]:before{content:"";position:absolute;width:48px;height:1px;background:#e4e4e4;top:50%;margin-top:-1px}.zjapp .end-text[data-v-2b1a346c]:after{left:50%;transform:translateX(-92px)}.zjapp .end-text[data-v-2b1a346c]:before{right:50%;transform:translateX(90px)}.zjapp .end-slot[data-v-2b1a346c]{padding:30px;line-height:18px;text-align:center;color:#c8c8c8}',""])},b225:function(t,e,i){"use strict";i("ef48")},cc9e:function(t,e,i){var a=i("5454");(t.exports=i("690e")(!1)).push([t.i,".zjapp .app-search-bar[data-v-3e42b4a4]{display:flex;flex-direction:column;min-height:44px}.zjapp .app-search-bar.has-history-list[data-v-3e42b4a4]{flex:1;min-height:100%}.zjapp .app-search-input-wrap[data-v-3e42b4a4]{display:flex;flex-direction:row;padding:8px;background-color:#fff}.zjapp .app-search-input-box[data-v-3e42b4a4]{position:relative;flex:1;height:28px}.zjapp .app-search-label[data-v-3e42b4a4]{position:absolute;z-index:2;top:0;left:50%;height:28px;line-height:28px;display:flex;align-items:center;padding-left:0;transform:translateX(-50%);transition:left .4s cubic-bezier(.4,.6,.2,1),transform .4s cubic-bezier(.4,.6,.2,1)}.zjapp .app-search-label-focus[data-v-3e42b4a4]{left:12px;transform:translateX(0)}.zjapp .app-search-input[data-v-3e42b4a4]{height:28px;padding:5px 32px 5px 33px;width:100%;overflow:hidden;background-color:#f4f4f4;border:none;border-radius:14px}.zjapp .app-search-icon[data-v-3e42b4a4]{position:absolute;top:7px;left:0;color:#cacaca;font-size:14px}.zjapp .app-search-placeholder[data-v-3e42b4a4]{color:#999;font-size:14px;margin-left:21px;white-space:nowrap}.zjapp .app-search-clear[data-v-3e42b4a4]{position:absolute;top:-8px;right:-8px;width:60px;height:44px;background:url("+a(i("7b08"))+") 50% no-repeat;background-size:16px 16px}.zjapp .app-search-cancel[data-v-3e42b4a4]{height:44px;line-height:44px;padding:0 15px;margin:-8px -8px -8px 0;font-size:16px;color:#4275e8}.zjapp .app-search-history[data-v-3e42b4a4]{flex:1;overflow:auto}.zjapp .app-search-history-empty[data-v-3e42b4a4]{display:flex;flex-direction:column}.zjapp .list-title[data-v-3e42b4a4]{font-size:14px;line-height:30px;padding:8px 16px 2px}.zjapp .item-history-title[data-v-3e42b4a4] .item-text{color:#999}.zjapp .item-history-title[data-v-3e42b4a4] .icon{position:relative;display:block;min-width:24px;height:30px;line-height:30px;text-align:right;font-size:14px;color:#999}.zjapp .item-history[data-v-3e42b4a4] .item-text{color:#666}.zjapp .btn-empty-add[data-v-3e42b4a4]{display:inline-block;margin-top:15px;width:auto;height:30px;line-height:28px;font-size:14px}",""])},d18d:function(t,e,i){"use strict";(function(t){i("2b45");var a,o=i("4360"),r=i("48f4"),s=i("162a"),n=i("e2a7"),l=i("a500"),c=i("6f9e"),p={};e.a={name:"Scroller",props:{buildingId:{type:String,default:""},hasNext:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},isSync:{type:Boolean,default:!0},endText:{type:String,default:""},memoryScrollTop:{type:Boolean,default:!0},keepScrollTop:{type:Boolean},hasPullDown:{type:Boolean,default:!0},onPullDown:{type:Function}},data:function(){return{pullDist:0,refreshing:!1,pulling:!1,loading:!1,scrollTop:0,isCurrKeyboard:!1,gapBottom:0}},computed:{allowPullDown:function(){return this.hasPullDown&&(!!this.$listeners.pullDown||!!this.onPullDown)},updateTime:function(){return o.a.state.global.businessDownloadTime},numberKeyboardCoverHeight:function(){return o.a.state.global.isNumberInputOpen?o.a.state.global.numberKeyboardHeight-this.gapBottom:0}},mounted:function(){var t=this;c.a.$on("numberKeyboardOpen",this.onNumberKeyboardOpen),this.$nextTick((function(){var e=t.$refs["scroll-warp"]&&t.$refs["scroll-warp"].getBoundingClientRect&&t.$refs["scroll-warp"].getBoundingClientRect();e&&(t.gapBottom=document.documentElement.clientHeight-e.bottom),t.$el&&t.$el.addEventListener("focus",(function(e){var i=e&&e.target,a=i&&i.tagName&&i.tagName.toLowerCase();if("input"===a||"textarea"===a){window.addEventListener("resize",(function e(){var a=i.getBoundingClientRect(),o=t.$el.getBoundingClientRect(),r=a.bottom-o.bottom;r>0&&t.scrollBy(r),window.removeEventListener("resize",e,!1)}),!1)}}),!0)}))},destroyed:function(){c.a.$off("numberKeyboardOpen",this.onNumberKeyboardOpen)},activated:function(){var t=this.keepScrollTop||this.$router.isBack&&this.memoryScrollTop;this.scrollTop&&t&&(this.$refs["scroll-warp"].scrollTop=this.scrollTop)},deactivated:function(){this.memoryScrollTop&&(this.scrollTop=this.$refs["scroll-warp"].scrollTop)},methods:{onScroll:function(t){var e=this,i=this.$refs["scroll-warp"].scrollTop,a=this.$refs["scroll-warp"].scrollHeight;if(i+this.$refs["scroll-warp"].clientHeight>=a-5&&!this.loading&&this.hasNext){this.loading=!0;var o=this.$listeners.loadNext();o&&o.then&&"function"==typeof o.then?o.then((function(){e.loading=!1})):this.loading=!1}this.$emit("scroll",t)},getTouchDiretion:function(t){if(!(p&&t&&t.touches&&t.touches[0]))return"";var e=t.touches[0].clientX,i=t.touches[0].clientY;return Math.abs(i-p.y)>Math.abs(e-p.x)&&Math.abs(i-p.y)>=3?i>p.y?"down":"up":""},onTouchstart:function(t){this.allowPullDown&&t.touches&&1===t.touches.length&&(p={x:t.touches[0].clientX,y:t.touches[0].clientY,scrollTop:this.$refs["scroll-warp"].scrollTop,pullDist:this.pullDist})},onTouchmove:function(t){if(this.allowPullDown&&t.touches&&1===t.touches.length){var e=this.$refs["scroll-warp"].scrollTop,i=t.touches[0].clientY,a=i-p.y,o=this.getTouchDiretion(t);"down"===o?!this.refreshing&&e<=0?(this.pulling=!0,this.pullDist=(a-p.scrollTop)/2,t.preventDefault()):this.pulling=!1:"up"===o?this.pullDist>0&&(this.pullDist=p.pullDist-(p.y-i),t.preventDefault()):this.pullDist=p.pullDist}},onTouchend:function(){var t=this;this.allowPullDown&&(p={},this.pulling=!1,this.pullDist>=70&&this.isSync?this.refreshing?this.makePullTo(70):this.makePullTo(70).then((function(){if(t.refreshing=!0,t.onPullDown){var e=t.onPullDown();e&&e.then&&"function"==typeof e?e.finally((function(){t.refreshing=!1,t.makePullTo(0)})):(t.refreshing=!1,t.makePullTo(0))}else t.dataSync().then((function(){t.refreshing=!1,t.makePullTo(0),t.$emit("pullDown")})).catch((function(){t.refreshing=!1,t.makePullTo(0),t.$emit("pullDown")}))})):(this.refreshing=!1,this.makePullTo(0)))},makePullTo:function(t){var e=this,i=this.pullDist,a=t,o=a-i,r=i;return i===a?Promise.resolve():new Promise((function(t){!function s(){window.requestAnimationFrame((function(){r+=o/6,e.pullDist=r,i<a&&r<a||i>a&&r>a?s():(e.pullDist=a,e.refreshing=!1,t())}))}()}))},dataSync:function(){var t,e=r.default.getCurrentModuleCode(),i=r.default.getCurrentRoute(),a=i.meta&&i.meta.isTodo;if(r.default.isModuleNeedBuilding(e)&&!a){if(!this.buildingId)return new Promise((function(t){setTimeout((function(){t()}),500)}));t=this.buildingId}return l.a.addTrack("公共-手动下拉刷新","",""),s.a.beginManualUpdate(),r.default.checkSync(t).then((function(t){return s.a.endManualUpdate(),t})).catch((function(t){$log.error("下拉刷新错误",t),t&&"Error: Network Error"===t.toString()?n.a.alert("当前网络无法同步数据"):n.a.alert(t),s.a.endManualUpdate()}))},getScrollHeight:function(){return this.$refs["scroll-warp"].offsetHeight},getScrollTop:function(){return this.$refs["scroll-warp"].scrollTop},setScrollTop:function(t){this.$refs["scroll-warp"].scrollTop=t},scrollBy:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=this.getScrollTop(),r=o+t,s=Math.round(i/16.7),n=t/s,l=o,c=a=+new Date;return o===r?Promise.resolve():new Promise((function(t){!function i(){window.requestAnimationFrame((function(){c===a&&(l+=n,e.$refs["scroll-warp"].scrollTop=l,o<r&&l<r||o>r&&l>r?i():(e.$refs["scroll-warp"].scrollTop=r,t()))}))}()}))},scrollTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=this.getScrollTop(),a=t-i;return this.scrollBy(a,e)},scrollToEle:function(t){var e=t.keyboardHeight||232,i=(t=t.$el?t.$el:t).getBoundingClientRect(),a=this.$refs["scroll-warp"].getBoundingClientRect();if(i&&a){var r=document.documentElement.clientHeight-(o.a.state.global.isNumberInputOpen?e:0),s=a.bottom<r?a.bottom:r,n=a.top-i.top,l=i.bottom-s;n>0?this.scrollBy(-n-10):l>0&&this.scrollBy(l+10)}},isCurrent:function(e,i){var a=this;e.length&&t.each(e,(function(t){t._uid===i?a.isCurrKeyboard=!0:a.isCurrent(t.$children,i)}))},onNumberKeyboardOpen:function(t){this.isCurrKeyboard=!1,this.isCurrent(this.$children,t._uid),this.isCurrKeyboard&&this.scrollToEle(t)}}}}).call(this,i("391c"))},d3d5:function(t,e,i){"use strict";i("7fdb")},ef48:function(t,e,i){var a=i("9d55");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("a1a65c0c",a,!0,{sourceMap:!1,shadowMode:!1})},f1d7:function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e"),i("e204");var a=i("28f8"),o=(i("c0c3"),i("07d2")),r=i("774b"),s=i("6144"),n=(i("1b7e"),i("162a")),l=(i("e2a7"),i("7bac"));function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function p(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){Object(a.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var h="ncov-enter-user-search";e.a={name:"NcovEnterSearch",components:{item:o.a,Scroller:r.a},data:function(){return{bidsectionId:"",keyword:"",pageindex:1,pagesize:20,list:[],total:0,isLoading:!0,searchTimer:null,searchHistory:[],allSearchHistory:{}}},computed:{projId:function(){return this.$store.state.global.currentProject.id}},watch:{keyword:function(t){var e=this;clearTimeout(this.searchTimer),this.searchTimer=setTimeout((function(){e.search()}),1e3)}},activated:function(){var t=s.a.getUserObject("ncov-index-section-default"+this.projId)||{};this.bidsectionId=t.id||"",this.keyword="",this.getHistory()},methods:{getHistory:function(){var t=this;l.a.getUserKey(h).then((function(e){e=e||{},t.allSearchHistory=e,t.searchHistory=e[t.bidsectionId]||[]}))},search:function(){this.keyword?(this.pageindex=1,this.isLoading=!0,this.getList()):this.list=[]},getList:function(){var e=this;return n.a.request("/online/ncov-approach/get-user-list",{page:this.pageindex,pageSize:this.pagesize,keyword:this.keyword,bidsection_id:this.bidsectionId}).then((function(i){if(console.log("rrrr ====",i),i&&i.list){var a=t.map(i.list||[],(function(t){return p(p({},t),{},{name:t.fullname})}));1===e.pageindex?e.list=a:e.list=e.list.concat(a),e.total=parseInt(i.total)}else console.error("加载列表失败");e.isLoading=!1})).catch((function(t){console.error(t),e.isLoading=!1}))},nextPage:function(){return this.pageindex++,this.getList()},clearKeyword:function(){this.keyword=""},saveHistory:function(e){e&&(t.some(this.searchHistory,(function(t){return t.id===e.id}))||(this.searchHistory.unshift(e),this.allSearchHistory[this.bidsectionId]=this.searchHistory,l.a.setUserKey(h,this.allSearchHistory)))},deleteHistory:function(e){if(e){var i=t.findIndex(this.searchHistory,{id:e.id});this.searchHistory.splice(i,1),this.allSearchHistory[this.bidsectionId]=this.searchHistory,l.a.setUserKey(h,this.allSearchHistory)}},deleteHistoryAll:function(){this.searchHistory=[],this.allSearchHistory[this.bidsectionId]=this.searchHistory,l.a.setUserKey(h,this.allSearchHistory)},gotoAdd:function(t){this.saveHistory(t);var e={name:"ncovEnterAdd"};t&&t.idcard&&(e.query={idcard:t.idcard}),this.$router.push(e)}}}}).call(this,i("391c"))}}]);