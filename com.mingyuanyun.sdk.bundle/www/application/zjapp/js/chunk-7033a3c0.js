(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-7033a3c0","chunk-739f37c8"],{"134d":function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var a=r("8220"),n=r("210a"),i=(r("5ab2"),r("6d57"),r("e10e"),r("28f8")),o=(r("f548"),r("8d95")),s=r("a730"),l={};function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}s.keys().forEach((function(e){l[o.a.SPECIAL_INSPECT+"-"+e.replace(/(\.\/|\.js)/g,"")]=s(e).default}));var u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(i.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},l);function p(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i,o=t[1],s=t[2],l=o;return s&&(l=l+"-"+s),(i=u[l])||(i=n.a),Object(a.a)(i,t)}},"210a":function(e,t,r){"use strict";(function(e){r("5ab2"),r("e10e"),r("6d57"),r("cc57"),r("6a61");var a=r("2e91"),n=r("0e4d"),i=r("94ef"),o=r("28f8"),s=r("aa77"),l=r("37d5"),c=r("6fb0"),u=r("c745"),p=r("5ff0"),d=r("5b5e"),f=r("a044"),m=r("e2a7");function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(){function t(e,r,a,i,s){Object(n.a)(this,t),Object(o.a)(this,"fullTempCode",""),Object(o.a)(this,"formConfig",[]),Object(o.a)(this,"optionsData",{}),Object(o.a)(this,"publicOptions",{reinspect_set:null,cc_set:null,repair_set:null,contractor:null}),this.data={},this.projectId=e,this.moduleCode=r,this.templateType=a,this.busFormOptions=i,this.problemData=s||{}}var r,h,g,y,_,v,x,O,k;return Object(i.a)(t,[{key:"getPlaceList",value:(k=Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.default.getPlaceList(this.projectId);case 2:e.sent;case 3:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"getProjectUsers",value:(O=Object(a.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.default.getProjectUsers(this.projectId,c.a);case 2:r=t.sent,this.publicOptions.reinspect_set=e.clone(r),this.publicOptions.cc_set=e.clone(r),this.publicOptions.repair_set=e.clone(r);case 6:case"end":return t.stop()}}),t,this)}))),function(){return O.apply(this,arguments)})},{key:"initData",value:(x=Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fullTempCode=this.moduleCode,this.templateType&&(this.fullTempCode=this.fullTempCode+"-"+this.templateType),this.getFormConfig(),e.next=5,this.getFormOptionsData();case 5:this.setFormOptions(),this.setExtendOptions(),this.setFormValue();case 8:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"getFormConfig",value:function(){this.formConfig=s.a[this.fullTempCode]||[]}},{key:"setContractor",value:(v=Object(a.a)(regeneratorRuntime.mark((function e(t,r){var a,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.formConfig.filter((function(e){return"single-select"===e.type&&"contractor"===e.name}))).length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.loadContractor(t,r);case 5:n=e.sent,i=n.options,o=n.firstCtt,a.forEach((function(e){e.options=i,o&&(e.value=o)}));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"setContract",value:(_=Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.formConfig.filter((function(e){return"slide-up-select"===e.type&&"contract"===e.name})).length;case 2:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"loadContractor",value:(y=Object(a.a)(regeneratorRuntime.mark((function t(r,a){var n,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],i={},t.next=4,u.a.allowGroupUserByConstructor();case 4:if(!t.sent||!a){t.next=13;break}return t.next=8,u.a.getOwnedContractorList(a);case 8:if(o=t.sent,e.isEmpty(o)){t.next=13;break}return r&&(i=o[0]),n=o,t.abrupt("return",{options:n,firstCtt:i});case 13:return t.next=15,p.a.getProjectContractorList(this.projectId);case 15:return n=t.sent,t.abrupt("return",{options:n,firstCtt:i});case 17:case"end":return t.stop()}}),t,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"setFormOptions",value:function(){var e=this;this.optionsData=b(b({},this.busFormOptions),this.publicOptions),this.formConfig.forEach((function(t){e.optionsData[t.name]&&(t.options=e.optionsData[t.name])}))}},{key:"setExtendOptions",value:function(){var e=this;this.formConfig.forEach((function(t){"place-select"===t.type&&(t.extendOptions=t.extendOptions||{},t.extendOptions.projectId=e.projectId)}))}},{key:"getFormOptionsData",value:(g=Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.formConfig&&0!==this.formConfig.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getProjectUsers();case 4:return e.next=6,this.setContractor();case 6:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"setFormValue",value:function(){var e=this;this.formConfig.forEach((function(t){e.problemData.hasOwnProperty(t.name)&&e.problemData[t.name]&&(t.value=e.problemData[t.name])}))}},{key:"saveProblem",value:(h=Object(a.a)(regeneratorRuntime.mark((function t(r,a){var n,i,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i in(n=e.clone(r)).status=f.w,a)n[i]=a[i];return t.next=5,d.a.save(e.clone(n));case 5:t.sent,m.a.alert("保存成功"),setTimeout((function(){o.$router.go(-1)}),500);case 8:case"end":return t.stop()}}),t)}))),function(e,t){return h.apply(this,arguments)})},{key:"submitProblem",value:(r=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}]),t}();t.a=g}).call(this,r("391c"))},"26e9":function(e,t,r){"use strict";t.a={CHECK_NAME:"现场检查",CHECK_SAFETY_NAME:"安全检查",CHECK_QUALITY_NAME:"质量检查",MEASURE_V3_NAME:"实测实量",LASER_SCANNING_MEASURE_NAME:"激光扫描实测",PROCESS_NEW_INDEX_NAME:"工序移交",PILE_ACCEPT_NAME:"桩基验收",PROCESS_ACCEPT_NAME:"工序验收",PROCESS_ACCEPT_V2_NAME:"工序验收",PROCESS_ACCEPT_V3_NAME:"工序验收",MATERIAL_NAME:"材料验收",INVENTORY_NAME:"材料盘点",TEMPLET_PLAN_NAME:"样板管理",TEMPLET_PLAN_V2_NAME:"样板管理",TEMPLATE_MANAGE_NAME:"常用文档",IMAGE_PROCESS_NAME:"形象进度",SCHEDULE_PLAN_NAME:"进度管理",CLOSED_WATER_TEST_NAME:"闭水试验",WATER_POURING_TEST_NAME:"淋水试验",SPECIAL_INSPECT_NAME:"专项巡检",MEASURE_INSPECT_NAME:"实测巡检",FLY_INSPECT_NAME:"飞检&专项",MONITOR_NAME:"视频监控",PROJECT_HIGHLIGHT_NAME:"工程案例",MEETING_NAME:"安全晨会",PHOTOS_NAME:"APP相册",NCOV_ANTI_EPIDEMIC_NAME:"防疫宝",TRACEABILITY_NAME:"材料溯源"}},"6fb0":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=[31,32,33]},"774b":function(e,t,r){"use strict";r.r(t);var a=r("d18d").a,n=(r("b225"),r("17cc")),i=Object(n.a)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"scroll-warp",staticClass:"scroll-warp",class:{"scroll-warp-pulling":e.pulling,"scroll-warp-complete":!e.hasNext&&!e.isEmpty,"scroll-warp-empty":e.isEmpty},style:{"padding-bottom":e.numberKeyboardCoverHeight+"px"},on:{scroll:e.onScroll,touchstart:e.onTouchstart,touchmove:e.onTouchmove,touchend:e.onTouchend}},[e.allowPullDown?r("div",{staticClass:"pull-refresh-warp",style:{height:e.pullDist+"px"}},[r("div",{staticClass:"pull-refresh"},[r("div",{staticClass:"animation-refresher",class:{refreshing:e.refreshing}}),e.updateTime?r("p",{staticClass:"pull-refresh-date"},[e._v("最后成功同步："+e._s(e.updateTime))]):e._e()])]):e._e(),e._t("default"),e.loading?r("div",{staticClass:"page-loading"},[r("svg",{staticClass:"svg-loading",attrs:{viewBox:"0 0 80 80"}},[r("circle",{attrs:{cx:"40",cy:"40",r:"36"}})])]):e._e(),e.hasNext||e.isEmpty?e._e():[e.$slots.end?e._t("end"):e._e(),!e.$slots.end&&e.endText?r("div",{staticClass:"end-text"},[e._v("\n      "+e._s(e.endText)+"\n    ")]):e._e()]],2)}),[],!1,null,"2b1a346c",null);t.default=i.exports},"8bfe":function(e,t,r){var a={"./1.js":"8e7a","./2.js":"e2f5","./5.js":"fab6","./6.js":"f172"};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="8bfe"},"8e7a":function(e,t,r){"use strict";r.r(t),t.default=[{id:"deduction",name:"deduction",type:"number-input",value:"",text:"",label:"此问题扣分",display:!0,required:!0,rules:[{pattern:/^[+-]?(0|([1-9]\d*))(\.\d+)?$/,message:"请输入扣分"}],isExtend:!0,extendOptions:{decimal:2,range:[0,999999.99],unit:"分",mode:"edit"}},{id:"divider",type:"divider",label:"分割线",name:"divider",display:!0,height:"10"},{id:"images",name:"images",label:"",value:[],isExtend:!0,type:"images",extendOptions:{maxlength:15},display:!0},{id:"place",name:"place",label:"部位",value:{},isExtend:!0,type:"place-select",extendOptions:{},extendValue:{place_point:"",drawing_file:""},display:!0},{id:"remark",name:"remark",label:"",value:"",isExtend:!0,type:"textarea",extendOptions:{placeholder:"补充说明"},display:!0},{id:"level",type:"radio",label:"严重程度",name:"level",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[],itemLayout:"horizontal",options:[{key:"一般",label:"一般"},{key:"紧急",label:"紧急"}],relations:[]},{id:"need_repair",type:"checkbox",label:"",name:"need_repair",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[],itemLayout:"horizontal",options:[{key:"false",label:"通知整改"}]},{id:"deadline",type:"stepper",isExtend:!0,label:"整改期限",name:"deadline",display:!0,disabled:!1,require:!1,value:"",unit:"天"},{id:"repair_set",type:"user-select",isExtend:!0,label:"整改人",name:"repair_set",display:!0,disabled:!1,require:!1,value:{},options:[],relations:[{type:"formula",func:"DISPLAY([#{need_repair},true, =])"}]},{id:"contractor",type:"single-select",isExtend:!0,label:"责任单位",name:"contractor",display:!0,disabled:!1,require:!1,value:{},options:[]},{id:"reinspect_set",type:"user-select",isExtend:!0,label:"复验人",name:"reinspect_set",display:!0,disabled:!1,require:!1,value:{},options:[]},{id:"cc_set",type:"user-select",isExtend:!0,label:"抄送人",name:"cc_set",display:!0,disabled:!1,require:!1,value:{},options:[]}]},"9d55":function(e,t,r){(e.exports=r("690e")(!1)).push([e.i,'.zjapp .scroll-warp[data-v-2b1a346c]{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}.zjapp .scroll-warp-pulling[data-v-2b1a346c]{overflow:hidden}.zjapp .scroll-warp-complete[data-v-2b1a346c]:after{content:"";display:block;height:100px}.zjapp .scroll-warp-empty[data-v-2b1a346c]{display:flex;flex-direction:column}.zjapp .pull-refresh-warp[data-v-2b1a346c]{position:relative;height:0;overflow:hidden}.zjapp .pull-refresh[data-v-2b1a346c]{position:absolute;left:0;bottom:0;height:70px;width:100%;padding:6px;text-align:center}.zjapp .pull-refresh-date[data-v-2b1a346c]{margin-top:4px;height:16px;line-height:16px;font-size:12px;color:#bcbcbc}.zjapp .page-loading[data-v-2b1a346c]{padding:10px;text-align:center}.zjapp .end-text[data-v-2b1a346c]{color:#c8c8c8;background:#f4f4f4;position:relative;line-height:76px;height:76px;text-align:center}.zjapp .end-text[data-v-2b1a346c]:after,.zjapp .end-text[data-v-2b1a346c]:before{content:"";position:absolute;width:48px;height:1px;background:#e4e4e4;top:50%;margin-top:-1px}.zjapp .end-text[data-v-2b1a346c]:after{left:50%;transform:translateX(-92px)}.zjapp .end-text[data-v-2b1a346c]:before{right:50%;transform:translateX(90px)}.zjapp .end-slot[data-v-2b1a346c]{padding:30px;line-height:18px;text-align:center;color:#c8c8c8}',""])},a730:function(e,t,r){var a={"./8.js":"d5ca"};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="a730"},aa77:function(e,t,r){"use strict";r("5ab2"),r("6d57"),r("e10e");var a=r("28f8"),n=(r("f548"),r("8d95")),i=r("8bfe"),o={};i.keys().forEach((function(e){o[n.a.SPECIAL_INSPECT+"-"+e.replace(/(\.\/|\.js)/g,"")]=i(e).default}));var s=o;function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.a=c(c({},s),{},{check:[{type:"",options:[],value:"",text:"",label:""}]})},b225:function(e,t,r){"use strict";r("ef48")},d18d:function(e,t,r){"use strict";(function(e){r("2b45");var a,n=r("4360"),i=r("48f4"),o=r("162a"),s=r("e2a7"),l=r("a500"),c=r("6f9e"),u={};t.a={name:"Scroller",props:{buildingId:{type:String,default:""},hasNext:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},isSync:{type:Boolean,default:!0},endText:{type:String,default:""},memoryScrollTop:{type:Boolean,default:!0},keepScrollTop:{type:Boolean},hasPullDown:{type:Boolean,default:!0},onPullDown:{type:Function}},data:function(){return{pullDist:0,refreshing:!1,pulling:!1,loading:!1,scrollTop:0,isCurrKeyboard:!1,gapBottom:0}},computed:{allowPullDown:function(){return this.hasPullDown&&(!!this.$listeners.pullDown||!!this.onPullDown)},updateTime:function(){return n.a.state.global.businessDownloadTime},numberKeyboardCoverHeight:function(){return n.a.state.global.isNumberInputOpen?n.a.state.global.numberKeyboardHeight-this.gapBottom:0}},mounted:function(){var e=this;c.a.$on("numberKeyboardOpen",this.onNumberKeyboardOpen),this.$nextTick((function(){var t=e.$refs["scroll-warp"]&&e.$refs["scroll-warp"].getBoundingClientRect&&e.$refs["scroll-warp"].getBoundingClientRect();t&&(e.gapBottom=document.documentElement.clientHeight-t.bottom),e.$el&&e.$el.addEventListener("focus",(function(t){var r=t&&t.target,a=r&&r.tagName&&r.tagName.toLowerCase();if("input"===a||"textarea"===a){window.addEventListener("resize",(function t(){var a=r.getBoundingClientRect(),n=e.$el.getBoundingClientRect(),i=a.bottom-n.bottom;i>0&&e.scrollBy(i),window.removeEventListener("resize",t,!1)}),!1)}}),!0)}))},destroyed:function(){c.a.$off("numberKeyboardOpen",this.onNumberKeyboardOpen)},activated:function(){var e=this.keepScrollTop||this.$router.isBack&&this.memoryScrollTop;this.scrollTop&&e&&(this.$refs["scroll-warp"].scrollTop=this.scrollTop)},deactivated:function(){this.memoryScrollTop&&(this.scrollTop=this.$refs["scroll-warp"].scrollTop)},methods:{onScroll:function(e){var t=this,r=this.$refs["scroll-warp"].scrollTop,a=this.$refs["scroll-warp"].scrollHeight;if(r+this.$refs["scroll-warp"].clientHeight>=a-5&&!this.loading&&this.hasNext){this.loading=!0;var n=this.$listeners.loadNext();n&&n.then&&"function"==typeof n.then?n.then((function(){t.loading=!1})):this.loading=!1}this.$emit("scroll",e)},getTouchDiretion:function(e){if(!(u&&e&&e.touches&&e.touches[0]))return"";var t=e.touches[0].clientX,r=e.touches[0].clientY;return Math.abs(r-u.y)>Math.abs(t-u.x)&&Math.abs(r-u.y)>=3?r>u.y?"down":"up":""},onTouchstart:function(e){this.allowPullDown&&e.touches&&1===e.touches.length&&(u={x:e.touches[0].clientX,y:e.touches[0].clientY,scrollTop:this.$refs["scroll-warp"].scrollTop,pullDist:this.pullDist})},onTouchmove:function(e){if(this.allowPullDown&&e.touches&&1===e.touches.length){var t=this.$refs["scroll-warp"].scrollTop,r=e.touches[0].clientY,a=r-u.y,n=this.getTouchDiretion(e);"down"===n?!this.refreshing&&t<=0?(this.pulling=!0,this.pullDist=(a-u.scrollTop)/2,e.preventDefault()):this.pulling=!1:"up"===n?this.pullDist>0&&(this.pullDist=u.pullDist-(u.y-r),e.preventDefault()):this.pullDist=u.pullDist}},onTouchend:function(){var e=this;this.allowPullDown&&(u={},this.pulling=!1,this.pullDist>=70&&this.isSync?this.refreshing?this.makePullTo(70):this.makePullTo(70).then((function(){if(e.refreshing=!0,e.onPullDown){var t=e.onPullDown();t&&t.then&&"function"==typeof t?t.finally((function(){e.refreshing=!1,e.makePullTo(0)})):(e.refreshing=!1,e.makePullTo(0))}else e.dataSync().then((function(){e.refreshing=!1,e.makePullTo(0),e.$emit("pullDown")})).catch((function(){e.refreshing=!1,e.makePullTo(0),e.$emit("pullDown")}))})):(this.refreshing=!1,this.makePullTo(0)))},makePullTo:function(e){var t=this,r=this.pullDist,a=e,n=a-r,i=r;return r===a?Promise.resolve():new Promise((function(e){!function o(){window.requestAnimationFrame((function(){i+=n/6,t.pullDist=i,r<a&&i<a||r>a&&i>a?o():(t.pullDist=a,t.refreshing=!1,e())}))}()}))},dataSync:function(){var e,t=i.default.getCurrentModuleCode(),r=i.default.getCurrentRoute(),a=r.meta&&r.meta.isTodo;if(i.default.isModuleNeedBuilding(t)&&!a){if(!this.buildingId)return new Promise((function(e){setTimeout((function(){e()}),500)}));e=this.buildingId}return l.a.addTrack("公共-手动下拉刷新","",""),o.a.beginManualUpdate(),i.default.checkSync(e).then((function(e){return o.a.endManualUpdate(),e})).catch((function(e){$log.error("下拉刷新错误",e),e&&"Error: Network Error"===e.toString()?s.a.alert("当前网络无法同步数据"):s.a.alert(e),o.a.endManualUpdate()}))},getScrollHeight:function(){return this.$refs["scroll-warp"].offsetHeight},getScrollTop:function(){return this.$refs["scroll-warp"].scrollTop},setScrollTop:function(e){this.$refs["scroll-warp"].scrollTop=e},scrollBy:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=this.getScrollTop(),i=n+e,o=Math.round(r/16.7),s=e/o,l=n,c=a=+new Date;return n===i?Promise.resolve():new Promise((function(e){!function r(){window.requestAnimationFrame((function(){c===a&&(l+=s,t.$refs["scroll-warp"].scrollTop=l,n<i&&l<i||n>i&&l>i?r():(t.$refs["scroll-warp"].scrollTop=i,e()))}))}()}))},scrollTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=this.getScrollTop(),a=e-r;return this.scrollBy(a,t)},scrollToEle:function(e){var t=e.keyboardHeight||232,r=(e=e.$el?e.$el:e).getBoundingClientRect(),a=this.$refs["scroll-warp"].getBoundingClientRect();if(r&&a){var i=document.documentElement.clientHeight-(n.a.state.global.isNumberInputOpen?t:0),o=a.bottom<i?a.bottom:i,s=a.top-r.top,l=r.bottom-o;s>0?this.scrollBy(-s-10):l>0&&this.scrollBy(l+10)}},isCurrent:function(t,r){var a=this;t.length&&e.each(t,(function(e){e._uid===r?a.isCurrKeyboard=!0:a.isCurrent(e.$children,r)}))},onNumberKeyboardOpen:function(e){this.isCurrKeyboard=!1,this.isCurrent(this.$children,e._uid),this.isCurrKeyboard&&this.scrollToEle(e)}}}}).call(this,r("391c"))},d5ca:function(e,t,r){"use strict";r.r(t);r("2b45"),r("fc58");var a=r("0e4d"),n=r("76ff"),i=r("4b67"),o=r("d703"),s=r("210a");r("5b5e");function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=Object(o.a)(e);if(t){var n=Object(o.a)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return Object(i.a)(this,r)}}s.a},e2f5:function(e,t,r){"use strict";r.r(t),t.default=[{id:"divider",type:"divider",label:"分割线",name:"divider",display:!0,height:"10"},{id:"images",name:"images",label:"",value:[],isExtend:!0,type:"images",extendOptions:{maxlength:15},display:!0},{id:"place",name:"place",label:"部位",value:{},isExtend:!0,type:"place-select",extendOptions:{},extendValue:{place_point:"",drawing_file:""},display:!0},{id:"remark",name:"remark",label:"",value:"",isExtend:!0,type:"textarea",extendOptions:{placeholder:"补充说明"},display:!0},{id:"level",type:"radio",label:"严重程度",name:"level",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[],itemLayout:"horizontal",options:[{key:"紧急问题",label:"紧急问题"},{key:"0",label:"0"},{key:"特急33",label:"特急33"}],relations:[]},{id:"need_repair",type:"checkbox",label:"",name:"need_repair",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[],itemLayout:"horizontal",options:[{key:"false",label:"通知整改"}]},{id:"deadline",type:"stepper",isExtend:!0,label:"整改期限",name:"deadline",display:!0,disabled:!1,require:!1,value:"",unit:"天"},{id:"repair_set",type:"user-select",isExtend:!0,label:"整改人",name:"repair_set",display:!0,disabled:!1,require:!1,value:{},options:[],relations:[{type:"formula",func:"DISPLAY([#{need_repair},true, =])"}]},{id:"contractor",type:"single-select",isExtend:!0,label:"责任单位",name:"contractor",display:!0,disabled:!1,require:!1,value:{},options:[]},{id:"reinspect_set",type:"user-select",isExtend:!0,label:"复验人",name:"reinspect_set",display:!0,disabled:!1,require:!1,value:{},options:[]},{id:"cc_set",type:"user-select",isExtend:!0,label:"抄送人",name:"cc_set",display:!0,disabled:!1,require:!1,value:{},options:[]}]},e88b:function(e,t,r){"use strict";(function(e){r("5ab2"),r("e10e"),r("6d57"),r("cc57"),r("163d"),r("6a61");var a=r("2e91"),n=r("0e4d"),i=r("94ef"),o=r("28f8"),s=r("5b5e"),l=r("8693"),c=r("3516"),u=r("6144"),p=r("06f6"),d=r("242b"),f=r("6e1b"),m=r("26e9"),h=r("3bd5"),b=r("2757"),g=r("3122");function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=h.a.getUser(),x=function(){function t(e,r,a){Object(n.a)(this,t),Object(o.a)(this,"inspectData",{}),Object(o.a)(this,"problemData",{}),Object(o.a)(this,"contractOptions",[]),Object(o.a)(this,"descriptionData",[]),Object(o.a)(this,"batchData",{}),this.data={},this.specialInspectId=e,this.placeId=r,this.problemId=a}var r,h,y,x,O,k,w,E;return Object(i.a)(t,[{key:"getDiagram",value:(E=Object(a.a)(regeneratorRuntime.mark((function e(t){var r,a,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(r=t.building_id,a=t.unit_id,n=t.floor,!(i=t.room_id)){e.next=7;break}return e.abrupt("return",p.default.getRoomTypeDiagram(i));case 7:if(!a||!n){e.next=11;break}return e.abrupt("return",d.a.getDiagram(r,a,n,1));case 11:if(!n){e.next=13;break}return e.abrupt("return",d.a.getDiagram(r,"",n,2));case 13:case"end":return e.stop()}}),e)}))),function(e){return E.apply(this,arguments)})},{key:"_getProblemData",value:(w=Object(a.a)(regeneratorRuntime.mark((function e(t){var r,a,n,i,o,u,p,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.getCheckProblemInfo(t);case 2:if(r=e.sent,a=_(_({},r),{},{id:r.id,status:r.status,proj_id:r.proj_id,place:{building_id:r.building_id,unit_id:r.unit,floor:r.floor,room_id:r.room_id,full_name:r.place},bidsection_id:r.bidsection_id,batch_id:r.batch_id,batch_type:r.batch_type,created_by:r.created_by,checkItem:{id:r.item_id,name:r.item_name,full_name:r.item_full_name,parentId:r.item_parent_id},description:{id:r.desc_id,name:r.desc},image_file:JSON.parse(r.image_file||"[]"),remark:r.remark,repair_requirements:r.repair_requirements,level:r.emergency_degree||"一般",deadline:void 0===r.deadline||null===r.deadline?7:Number(r.deadline),building_id:r.building_id,unit:r.unit,floor:r.floor,room_id:r.room_id,place_point:JSON.parse(r.problem_values||"[]"),drawing_file:JSON.parse(r.drawing_file||"[]"),repair_set:r.repair_set,process_mode:r.process_mode,repair:r.repair&&r.repair.id?_({},r.repair):r.repair_set&&r.repair_set.id?_({},r.repair_set):{},repair_image_file:JSON.parse(r.repair_image_file||"[]"),contractor:{id:r.contractor_id,name:r.contractor_name},reinspect_set:r.reinspect_set,cc_set:r.cc_set_array||[],sent_back:r.sent_back&&r.sent_back.id?_({},r.sent_back):{},sent_back_image_file:JSON.parse(r.sent_back_image_file||"[]"),regist:{id:r.regist.id,name:r.regist.name,mobile:r.regist.mobile,is_im_user:r.regist.is_im_user}}),!(n=a&&a.biz_id||"")){e.next=12;break}return e.next=8,l.a.getSpecialInspectData(n);case 8:i=e.sent,this.inspectData=i,a.checkItem={id:i.checkitem_id,name:i.checkitem_name,full_name:i.checkitem_full_name,parentId:i.checkitem_parent_id},a.specialInspectId=i.id;case 12:if(11!==a.mode||a.batch_type!==m.a.SPECIAL_INSPECT_NAME){e.next=22;break}return o=c.a.getBatch(a.batch_id),u=o.root_id||o.parent_id||o.id,p=o.status,e.next=18,c.a.getBatchUsers(u);case 18:d=e.sent,f=(d||[]).map((function(e){return{name:e.name,user_id:e.user_id}})),a.batchStatus=p,a.inspector=f;case 22:return e.abrupt("return",a);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"createNewData",value:(k=Object(a.a)(regeneratorRuntime.mark((function e(t,r){var a,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return e.next=3,l.a.getPlaceSpecialInspectData(t,r);case 3:this.inspectData=e.sent,e.next=9;break;case 6:return e.next=8,l.a.getSpecialInspectCheckItemDetail(t);case 8:this.inspectData=e.sent;case 9:if(a=this.inspectData,!r){e.next=16;break}return e.next=13,l.a.getBatchPlace(r);case 13:(n=e.sent).building_id&&(i={building_id:n.building_id,unit_id:n.unit,floor:n.floor,room_id:n.room_id,full_name:n.name}),a.defaultPlace=i||u.a.getObject("special-inspect-prolbem-pure-default-place",u.a.level.user)||{};case 16:return e.abrupt("return",{status:"",proj_id:a.proj_id,place:a.defaultPlace||{},batch_id:a.batch_id,batch_type:"专项巡检",checkItem:{id:a.item_id||a.checkitem_id,name:a.item_name||a.checkitem_name,full_name:a.full_name||a.checkitem_full_name},description:{},image_file:[],remark:"",level:"一般",deadline:7,repair_set:{},contractor:{},cc_set:[],reinspect_set:[],bidsection_id:"",building_id:a.defaultPlace&&a.defaultPlace.building_id||"",unit:a.defaultPlace&&a.defaultPlace.unit_id||"",floor:a.defaultPlace&&a.defaultPlace.floor||"",room_id:a.defaultPlace&&a.defaultPlace.room_id||"",place_point:[],deduction:1,redline_deduction:0,biz_id:t,biz_children_id:a.id,created_by:v.user_id,checkitem_extension:JSON.parse(a.checkitem_extension||"{}")});case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"getCheckItemDescList",value:(O=Object(a.a)(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.get(this.problemData,"checkItem.id"),(a=f.a.getCheckItemDescList(r))&&a.length>0?this.descriptionData=a:this.descriptionData=[];case 3:case"end":return t.stop()}}),t,this)}))),function(){return O.apply(this,arguments)})},{key:"getContractListData",value:(x=Object(a.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.getBatchContractList(t);case 2:r=e.sent,this.contractOptions=r;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"getBatchData",value:(y=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",new Error("缺少批次id"));case 2:return e.next=4,b.b.getBatchById(t);case 4:this.batchData=e.sent;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"getProblemData",value:(h=Object(a.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.problemId){t.next=6;break}return t.next=3,this._getProblemData(this.problemId);case 3:this.problemData=t.sent,t.next=9;break;case 6:return t.next=8,this.createNewData(this.specialInspectId,this.placeId);case 8:this.problemData=t.sent;case 9:return t.next=11,this.getDiagram(this.problemData.place);case 11:return r=t.sent,this.problemData.drawing_file=e.isEmpty(r)?[]:[r],t.next=15,this.getCheckItemDescList();case 15:return t.next=17,this.getBatchData(this.problemData.batch_id);case 17:return t.next=19,this.getContractListData(this.problemData.batch_id);case 19:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"getProblemList",value:(r=Object(a.a)(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.isArray(this.specialInspectId)?this.specialInspectId:[this.specialInspectId],e.next=3,l.a.getProblemList(t,this.placeId);case 3:return(r=(r=e.sent)||[]).forEach((function(e){e.thumbnail=g.a.getDefaultThumbnailFromList(e.image_file,"专项巡检"),"检查完毕"===e.status&&(e.status="已提交")})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]),t}();t.a=x}).call(this,r("391c"))},ef3f:function(e,t,r){"use strict";r.r(t);r("5ab2"),r("6d57"),r("e10e"),r("163d");var a=r("28f8"),n=(r("6a61"),r("2e91")),i=r("a044"),o=r("07d2"),s=r("fe80").a,l=r("17cc"),c=Object(l.a)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("page-content",{attrs:{title:"登记问题","show-go-root":!0}},[e.isLoading?e._e():[r("scroller",[e._t("before"),r("app-mform",{ref:"form",attrs:{"form-data":e.appFromData,hooks:e.getHooks()},on:{change:e.change}}),e.problemData.id||"草稿"===e.problemData.status?r("app-button-group",[r("app-button",{attrs:{type:"text"},on:{click:e.delProblem}},[e._v("\n          删除此草稿\n        ")])],1):e._e()],2),e._t("submit-btn")],e.isLoading?e._e():r("app-button-group",{attrs:{"fixed-bottom":"",seamless:""}},[r("app-button",{staticStyle:{width:"50%"},attrs:{plain:""},on:{click:e.saveProblemAndBack}},[e._v("\n      暂存\n    ")]),r("app-button",{on:{click:e.submit}},[e._v("\n      提交\n    ")])],1),r("loading-status",{attrs:{"is-loading":e.isLoading}})],2)}),[],!1,null,"27e1383e",null).exports,u=r("e88b");function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}var d,f={name:"PageProblemEdit",components:{CmpProblemEdit:c,Item:o.default},data:function(){return{specialInspectId:"",placeId:"",problemId:"",problemService:null,MODULE_CODE:i.d,templateType:0,isLoading:!1,inspectDataData:{},problemData:{},batchData:{},config8:{deductionKeyList:["A","B","c"],qualityType:"",mode8DeductionItems:[],formData:{deduction:"",deduction_level:"",redline_deduction:{}}}}},activated:function(){this.specialInspectId=this.$route.query.specialInspectId,this.placeId=this.$route.query.placeId,this.problemId=this.$route.query.problemId,this.templateType=this.$route.query.mode,this.problemService=new u.a(this.specialInspectId,this.placeId,this.problemId),this.$router.isBack||(this.isLoading=!0),this.init()},methods:{init:(d=Object(n.a)(regeneratorRuntime.mark((function e(){var t,r,a,n,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.problemService.getProblemData();case 2:t=this.problemService,r=t.problemData,a=t.batchData,this.problemData=r,this.templateType=a.mode,this.batchData=a,this.inspectDataData=this.problemService.inspectData,(n={}).contract=this.problemService.contractOptions,o=r.proj_id,s={moduleCode:i.d,projectId:o,templateType:this.templateType,problemData:r,formOptions:n,edit:!!this.problemId},this.initCustomData(),console.log(i.d,o,this.templateType),this.$refs.cmpProblemEdit.init(s).then((function(e){}));case 14:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)}),initCustomData:function(){if(8===this.templateType){var e=this.problemData.checkitem_extension||{};this.config8.mode8DeductionItems=this.config8.deductionKeyList.map((function(t){var r=e[t];return r?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({key:t,isSet:!0},r):{key:t,isSet:!1}})),this._recordProblemPoints(this.config8.formData.deduction_level||"A")}},_recordProblemPoints:function(e){this.qualityType=e,this.config8.formData.deduction=this.problemData.checkitem_extension?this.problemData.checkitem_extension[e].score:0,this.config8.formData.redline_deduction=this.problemData.template_extension?Number(this.problemData.template_extension[e]):null},selectionLevel:function(e){this._recordProblemPoints(e),this.saveProblem()},saveProblem:function(){}}},m=Object(l.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("cmp-problem-edit",{ref:"cmpProblemEdit"},[r("item",{attrs:{slot:"before",text:e.inspectDataData.full_name,border:"bottom"},slot:"before"}),8===e.templateType?[r("item",{staticClass:"deduction-title",attrs:{border:"bottom"}},[r("div",{staticClass:"item-text"},[r("span",{staticClass:"color-gray"},[e._v("此问题扣分：")]),r("span",{staticClass:"color-red"},[e._v(e._s(e.problemData.deduction?"-":"")+e._s(e.problemData.deduction)+"分")])])]),e._l(e.config8.mode8DeductionItems,(function(t){return r("item",{key:t.key,staticClass:"deduction-item",attrs:{text:t.key+"级："+(t.isSet?(t.remark?t.remark+", ":"")+t.score+"分":"暂无扣分"),"icon-right":e.config8.qualityType===t.key?"qualified":"",border:"bottom"},on:{click:function(r){t.isSet&&e.selectionLevel(t.key)}}})}))]:e._e()],2)}),[],!1,null,"936e7cfe",null);t.default=m.exports},ef48:function(e,t,r){var a=r("9d55");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r("85cb").default)("a1a65c0c",a,!0,{sourceMap:!1,shadowMode:!1})},f172:function(e,t,r){"use strict";r.r(t),t.default=[{id:"images",name:"images",label:"",value:[],isExtend:!0,type:"images",extendOptions:{maxlength:15},display:!0},{id:"contract",name:"contract",label:"选择合同",value:{},isExtend:!0,type:"slide-up-select",extendOptions:{},display:!0},{id:"place",name:"place",label:"部位",value:{},isExtend:!0,type:"place-select",extendOptions:{},extendValue:{place_point:"",drawing_file:""},display:!0},{id:"remark",name:"remark",label:"",value:"",isExtend:!0,type:"textarea",extendOptions:{placeholder:"补充说明"},display:!0},{id:"level",type:"radio",label:"严重程度",name:"level",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[],itemLayout:"horizontal",options:[{key:"紧急问题",label:"紧急问题"},{key:"0",label:"0"},{key:"特急33",label:"特急33"}],relations:[]},{id:"need_repair",type:"checkbox",label:"",name:"need_repair",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[],itemLayout:"horizontal",options:[{key:"false",label:"通知整改"}]},{id:"deadline",type:"stepper",isExtend:!0,label:"整改期限",name:"deadline",display:!0,disabled:!1,require:!1,value:"",unit:"天"},{id:"repair_set",type:"user-select",isExtend:!0,label:"整改人",name:"repair_set",display:!0,disabled:!1,require:!1,value:{},options:[],relations:[{type:"formula",func:"DISPLAY([#{need_repair},true, =])"}]},{id:"contractor",type:"single-select",isExtend:!0,label:"责任单位",name:"contractor",display:!0,disabled:!1,require:!1,value:{},options:[]},{id:"reinspect_set",type:"user-select",isExtend:!0,label:"复验人",name:"reinspect_set",display:!0,disabled:!1,require:!1,value:{},options:[]},{id:"cc_set",type:"user-select",isExtend:!0,label:"抄送人",name:"cc_set",display:!0,disabled:!1,require:!1,value:{},options:[]}]},fab6:function(e,t,r){"use strict";r.r(t),t.default=[{id:"deduction",name:"deduction",type:"number-input",value:"",text:"",label:"此问题扣分",display:!0,required:!0,rules:[{pattern:/^[+-]?(0|([1-9]\d*))(\.\d+)?$/,message:"请输入扣分"}],isExtend:!0,extendOptions:{decimal:2,range:[0,999999.99],unit:"分",mode:"edit"}},{id:"divider",type:"divider",label:"分割线",name:"divider",display:!0,height:"10"},{id:"images",name:"images",label:"",value:[],isExtend:!0,type:"images",extendOptions:{maxlength:15},display:!0},{id:"place",name:"place",label:"部位",value:{},isExtend:!0,type:"place-select",extendOptions:{},extendValue:{place_point:"",drawing_file:""},display:!0},{id:"remark",name:"remark",label:"",value:"",isExtend:!0,type:"textarea",extendOptions:{placeholder:"补充说明"},display:!0},{id:"level",type:"radio",label:"严重程度",name:"level",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[],itemLayout:"horizontal",options:[{key:"一般",label:"一般"},{key:"紧急",label:"紧急"}]},{id:"need_repair",type:"checkbox",label:"",name:"need_repair",display:!0,disabled:!1,require:!1,direction:"horizontal",value:[],itemLayout:"horizontal",options:[{key:"false",label:"通知整改"}]},{id:"deadline",type:"stepper",isExtend:!0,label:"整改期限",name:"deadline",display:!0,disabled:!1,require:!1,value:"",unit:"天"},{id:"repair_set",type:"user-select",isExtend:!0,label:"整改人",name:"repair_set",display:!0,disabled:!1,require:!1,value:{},options:[],relations:[{type:"calc",func:"#{need_repair}.length",action:"setDisplay"}]},{id:"contractor",type:"single-select",isExtend:!0,label:"责任单位",name:"contractor",display:!0,disabled:!1,require:!1,value:{},options:[]},{id:"reinspect_set",type:"user-select",isExtend:!0,label:"复验人",name:"reinspect_set",display:!0,disabled:!1,require:!1,value:{},options:[]},{id:"cc_set",type:"user-select",isExtend:!0,label:"抄送人",name:"cc_set",display:!0,disabled:!1,require:!1,value:{},options:[]}]},fe80:function(e,t,r){"use strict";(function(e){r("6d57"),r("cc57"),r("6a61");var a,n,i,o,s,l=r("2e91"),c=r("e2a7"),u=r("774b"),p=r("5b5e"),d=r("c058"),f=r("134d"),m=r("a044");t.a={name:"ProblemEditCmp",components:{Scroller:u.default},props:{},data:function(){return{editFlag:"add",isLoading:!1,problemData:{},appFromData:[],service:null}},activated:function(){},created:function(){},methods:{getHooks:function(){return{afterChangeHook:function(e){console.log(e,"=---")}}},saveProblem:function(){var e=this.$refs.form.getFormData();this.service.saveProblem(this.problemData,e)},saveProblemAndBack:(s=Object(l.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveProblem().then((function(){c.a.alert("保存成功"),setTimeout((function(){t.$router.go(-1)}),500)})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)}),submit:(o=Object(l.a)(regeneratorRuntime.mark((function t(){var r,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.problemData,this.formCheck=!0,!this.needRepair){t.next=9;break}if(r.repair_set.id){t.next=6;break}return c.a.alert("请选择整改人"),t.abrupt("return",!1);case 6:if(!e.isEmpty(r.reinspect_set)){t.next=9;break}return c.a.alert("请选择复验人"),t.abrupt("return",!1);case 9:if(e.isEmpty(r.drawing_file)||!e.isEmpty(r.place_point)){t.next=12;break}return c.a.notify("尚未标记户型图","去标记").then((function(){return a.showHuxingMark(null,{room_id:a.problemData.room_id,building_id:a.problemData.building_id,unit_id:a.problemData.unit,floor:a.problemData.floor,full_name:a.problemData.place.full_name})})),t.abrupt("return",!1);case 12:if(this.editalbe){t.next=14;break}return t.abrupt("return");case 14:if(c.a.loading("正在提交"),r.id){t.next=18;break}return t.next=18,this.saveProblem();case 18:return this.needRepair||(r.status="检查完毕"),t.abrupt("return",p.a.submit(e.clone(r),"special-inspect-problem",Boolean(this.needRepair)).then((function(){return d.a.addLog({relation_id:r.id,business_type:"special-inspect",event:"登记问题",diff:{remark:r.remark,desc:e.isEmpty(r.description)?"":r.description.name},images:r.image_file})})).then((function(){if(a.needRepair)return d.a.addLog({relation_id:a.problemData.id,business_type:"special-inspect",event:"通知整改"})})).then((function(){c.a.alert("提交成功"),a.$router.go(-1)})).catch((function(e){c.a.alert(e)})).finally((function(){c.a.hideLoading()})));case 20:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),delProblem:(i=Object(l.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.editalbe){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.a.popBox(m.f);case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:p.a.delete(this.problemData.id).then((function(){t.$router.go(-1)})).catch((function(e){c.a.alert(e)}));case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),init:(n=Object(l.a)(regeneratorRuntime.mark((function e(t){var r,a,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.projectId,a=t.moduleCode,n=t.templateType,i=t.formOptions,o=t.problemData,this.service=Object(f.a)(r,a,n,i),e.next=4,this.service.initData();case 4:if(this.appFromData=this.service.formConfig,this.problemData=o,console.log(this.appFromData,"问题界面配置"),!this.moduleCode){e.next=9;break}return e.abrupt("return");case 9:console.log(1);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)}),change:(a=Object(l.a)(regeneratorRuntime.mark((function e(t){var r,a,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t,"--"),"repair_set"!==t.name||"user-select"!==t.type){e.next=8;break}return e.next=4,this.service.loadContractor(!0,t.value.id);case 4:r=e.sent,a=r.options,n=r.firstCtt,this.appFromData.forEach((function(e){"single-select"===e.type&&"contractor"===e.name&&(i.$refs.form.setOptions(e.name,a),e.options=a,n&&i.$refs.form.setValue(e.name,n))}));case 8:"repair_set"===t.name&&t.type,console.log(t,this.appFromData,"问题界面配置");case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}}}).call(this,r("391c"))}}]);