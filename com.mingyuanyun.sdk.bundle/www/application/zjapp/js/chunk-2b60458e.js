(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-2b60458e"],{"2d6e":function(t,e,o){var a=o("7eb2");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("85cb").default)("53a2fbaa",a,!0,{sourceMap:!1,shadowMode:!1})},"5b85":function(t,e,o){var a=o("e2a8");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("85cb").default)("45a0f20c",a,!0,{sourceMap:!1,shadowMode:!1})},"65e9":function(t,e,o){"use strict";(function(t){o("5ab2"),o("6d57"),o("e10e");var a=o("28f8"),i=o("4360"),n=o("48f4"),r=o("162a"),d=o("f2d3"),s=o("6906"),l=o("a18c"),c=o("c745");function u(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function p(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach((function(e){Object(a.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}e.a={name:"SynchronizeTipBar",props:{isTodo:{type:Boolean},useDownload:{type:Boolean,default:!0},enterDoCheck:{type:Boolean,default:!0},buildingId:{type:String,default:""},automaticUpdateCallback:{type:Function,default:null}},data:function(){return{currentModuleCode:"",oneUpdateData:!0}},computed:{projId:function(){return i.a.state.global.currentProject.id},waitUploadNum:function(){return i.a.state.global.waitUploadNum},hasTopProgress:function(){return i.a.state.global.hasTopProgress},hasChanged:function(){if(!this.useDownload)return!1;if(this.currentModuleCode){var t,e=n.default.isModuleNeedBuilding(this.currentModuleCode)&&!this.isTodo;return!(e&&!this.buildingId)&&(t=this.isTodo?i.a.state.global.todoChangedStatus||{}:i.a.state.global.businessChangedStatus||{},e?!!t[this.currentModuleCode]&&t[this.currentModuleCode][this.buildingId]:t[this.currentModuleCode])}return!1},show:function(){return(this.hasChanged||this.waitUploadNum)&&!this.hasTopProgress},oneDataSync:function(){return this.$store.state.app.oneDataSync}},watch:{hasChanged:function(t){var e=this;t&&this.$nextTick((function(){setTimeout((function(){var t=e.$refs["synchronize-tip-bar"];if(t&&t.style){t.style.display="none";t.offsetHeight;t.style.display="block"}}),100)}))},buildingId:function(t){this.currentModuleCode&&n.default.isModuleNeedBuilding(this.currentModuleCode)&&t&&(console.log("楼栋重新加载，是否再次自动加载数据：",this.oneUpdateData),this.oneUpdateData&&this.automaticLogic(),this.checkSync())},show:function(t){t?this.$emit("show"):this.$emit("hide")}},activated:function(){this.init()},methods:{init:function(){this.getCurrentModuleCode(),this.enterDoCheck&&!l.a.isBack&&this.checkSync(),this.automaticLogic()},automaticLogic:function(){var t=this;this.$router.isBack||(this.oneUpdateData=!0,c.a.getAutomaticLoadData().then((function(e){$log.log("是否要自动加载 ===> ",e&&t.oneDataSync&&"function"==typeof t.automaticUpdateCallback),e&&t.oneDataSync&&"function"==typeof t.automaticUpdateCallback&&t.dataSync().then((function(e){console.log("是否需要初始化页面 ====> ",Boolean(e)),e&&t.automaticUpdateCallback()}))})))},getCurrentModuleCode:function(){var t=n.default.getCurrentModuleCode(),e=this.isTodo?"todo":"";this.currentModuleCode=t||e},checkSync:function(){var e=this,o="checkDataUpdate",a=this.currentModuleCode,r=this.buildingId,l=i.a.state.global.isLeader?this.projId:"";return!n.default.isModuleNeedBuilding(a)||r||this.isTodo?(this.isTodo&&(o+="_todo"),a&&(o+="_".concat(a)),r&&(o+="_".concat(r)),s.a.execAfterInterval(120,o).then((function(){return e.isTodo?"todo"===a?d.a.getModuleList().then((function(e){var o=t.map(e,"code");return n.default.hasTodoChangedData("",o)})):n.default.hasTodoChangedData("",[a]):n.default.hasBusinessChangedData(l,[a],r)})).then((function(t){if(e.isTodo){var o=p({},i.a.state.global.todoChangedStatus);o[a]=t,i.a.commit("global/SET_TODO_CHANGED_STATUS",o)}else{var n=p({},i.a.state.global.businessChangedStatus);if(r){var d=n[a]?n[a]:{};d[r]=t,n[a]=d}else n[a]=t;i.a.commit("global/SET_BUSINESS_CHANGED_STATUS",n)}})).catch((function(t){return t&&!0===t.timeNotTo?($log.debug(t.msg),!1):$q.reject(t)}))):Promise.resolve()},dataSync:function(){var t=this.currentModuleCode,e=this.buildingId,o=n.default.isModuleNeedBuilding(t),a=o&&!e;return $log.log(["模块名：",t," 楼栋id：",e," 当前模块是否需要楼栋id：",o," 判断是否终止自动更新：",a]),a?Promise.resolve():(this.oneUpdateData=!1,r.a.beginManualUpdate(),n.default.checkSync(e).then((function(t){return r.a.endManualUpdate(),t})).catch((function(t){$log.error("自动更新错误",t),r.a.endManualUpdate()})))}}}}).call(this,o("391c"))},"7eb2":function(t,e,o){(t.exports=o("690e")(!1)).push([t.i,".zjapp .synchronize-tip-bar[data-v-66826030]{height:30px;padding:5px 15px;line-height:20px;text-align:center;background-color:#ffe6e6;color:#ff6060;font-size:14px}.zjapp .synchronize-tip-bar .icon-caution[data-v-66826030]{line-height:20px;margin-right:5px}@media screen and (-webkit-min-device-pixel-ratio:1){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 100%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:1.5){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2.625){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 38.0952%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:3){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:4){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 25%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}",""])},"82c6":function(t,e,o){var a=o("5454");(t.exports=o("690e")(!1)).push([t.i,'.zjapp .drop-down-group[data-v-82946754]{display:flex;flex-direction:row}.zjapp .drop-down-group .select-con[data-v-82946754]{flex:1}.zjapp .list-room[data-v-82946754]{padding:15px 20px 0;background-color:#fff;overflow:hidden}.zjapp .item-list-room[data-v-82946754]{float:left;min-width:65px;min-height:30px;line-height:30px;margin:0 25px 15px 0;padding:0 15px;text-align:center;border:1px solid #dcdcdc;border-radius:3px}.zjapp .item-list-room.selected[data-v-82946754]{border-color:#4275e8;background-color:#4275e8;color:#fff}.zjapp .item-list-room.disabled[data-v-82946754]{background-color:#f2f2f2;color:#999}.zjapp .item-list-room.bg-green[data-v-82946754]{color:#fff;border-color:#0bc666}.zjapp .item-list-room.bg-blue[data-v-82946754]{color:#fff;border-color:#4174e9}.zjapp .item-list-room.bg-orange[data-v-82946754]{color:#fff;border-color:#ff8400}.zjapp .item-list-room.bg-red[data-v-82946754]{color:#fff;border-color:#ff3d3d}.zjapp .item-list-room.bg-brown[data-v-82946754]{color:#fff;border-color:#ff7439}.zjapp .item-list-room.bg-part[data-v-82946754]{border:1px solid #0bc666;position:relative;color:#0bc666}.zjapp .item-list-room.bg-part[data-v-82946754]:after{content:"";display:inline-block;width:27px;height:15px;background:url('+a(o("30e2"))+");background-repeat:no-repeat;background-size:100% 100%;position:absolute;right:-8px;top:-4px}.zjapp .list-pile[data-v-82946754]{display:flex;display:-webkit-flex;flex-flow:row wrap;align-content:center;padding:15px 10px 0;background-color:#fff;overflow:hidden;width:100%}.zjapp .item-list-pile[data-v-82946754]{flex:0 0 33.3%;padding:4px 8px;overflow:hidden;margin-bottom:15px;position:relative}.zjapp .item-list-pile-name[data-v-82946754]{text-align:center;border-radius:100px;padding:0 10px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:28px;line-height:28px}",""])},b4db:function(t,e,o){"use strict";(function(t){var a=o("e2a7"),i=o("07d2"),n=o("f7ab"),r=o("774b"),d=o("d623"),s=o("f546"),l=o("efa7"),c=o("bcd6");e.a={name:"PrcossAcceptV2",components:{item:i.default,SynchronizeTipBar:n.a,Scroller:r.default,DropDownSelect:d.a,StatusTotalBar:s.a,PlaceList:l.a},data:function(){return{model:c.a,classSet:{"不合格":"bg-red","施工已验":"bg-green","监理已验":"bg-orange","建设已验":"bg-blue"}}},computed:{sectionId:function(){return this.model.buildingCurrent&&this.model.buildingCurrent[0]&&this.model.buildingCurrent[0].id||""},buildingId:function(){return this.model.buildingCurrent&&this.model.buildingCurrent[1]&&this.model.buildingCurrent[1].id||""},roomId:function(){return this.model.buildingCurrent&&this.model.buildingCurrent[2]&&this.model.buildingCurrent[2].id||""},buildingCurrentEnd:function(){return t.isEmpty(this.model.buildingCurrent)?null:this.model.buildingCurrent[2]||this.model.buildingCurrent[1]},checkItemCurrentEnd:function(){return t.isEmpty(this.model.checkItemCurrent)?null:this.model.checkItemCurrent[2]||this.model.checkItemCurrent[1]},isListEmpty:function(){var t=(1===this.model.deliver_type||2===this.model.deliver_type||5===this.model.deliver_type)&&!this.model.listData.length,e=90===this.model.deliver_type&&!this.model.places.length;return t||e}},activated:function(){this.init()},methods:{init:function(){var t=this,e=this.$route.query.proj_id;c.a.init(e).then((function(){console.log(t.model,"====")})).catch((function(t){console.error(t)}))},onChangeBuilding:function(t){this.model.buildingCurrent=t,c.a.getCheckItemList().then((function(){c.a.getDefaultCheckItem(),c.a.getRoomList()})),c.a.setDefaultBuilding(this.model.buildingCurrent)},onChangeCheckItem:function(t){this.model.checkItemCurrent=t,c.a.setDefaultCheckItem(this.model.checkItemCurrent),c.a.getRoomList()},gotoDetail:function(e){console.log(e,this.model);var o=this.model.isCheckAccept,i=parseInt(this.model.deliver_type,10);e=e||{};var n=this.model,r=e.building_id,d=e.unit,s=i&&5===i?e.unit_name:"",l=e.floor,c=e.id;90===i&&(r=n.buildingCurrent[2]?n.buildingCurrent[2].id:n.buildingCurrent[1].id,d="",l="",c="");var u=t.isEmpty(n.checkItemCurrent)?null:n.checkItemCurrent[2]||n.checkItemCurrent[1];if(u)return o&&1!==n.userIdentity&&!e.status?a.a.alert("施工单位未报验，需报验后才可以验收"):void this.$router.push({path:"/process-accept-v2-detail",query:{item_id:u.id,building_id:r,unit:d||s,floor:l,room_id:c,deliver_type:i,id:e.id}})}}}}).call(this,o("391c"))},c59c:function(t,e,o){var a=o("82c6");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("85cb").default)("73862e82",a,!0,{sourceMap:!1,shadowMode:!1})},e2a8:function(t,e,o){(t.exports=o("690e")(!1)).push([t.i,'.zjapp .status-total-bar[data-v-be07cd9c]{display:flex;flex-direction:row;text-align:center}.zjapp .total-item[data-v-be07cd9c]{flex:1;line-height:20px;padding:10px 5px 0;color:#111;font-size:12px}.zjapp .total-status[data-v-be07cd9c]{white-space:nowrap}.zjapp .total-status[data-v-be07cd9c]:before{content:"";width:10px;height:10px;display:inline-block;vertical-align:top;margin:5px 5px 0 0;background-color:#ddd;border-radius:50%}.zjapp .total-status-orange[data-v-be07cd9c]:before{background-color:#fc8b01}.zjapp .total-status-orange2[data-v-be07cd9c]:before{background-color:#ff8e24}.zjapp .total-status-white2[data-v-be07cd9c]:before{background-color:#fff;border:1px solid #dcdcdc}.zjapp .total-status-red[data-v-be07cd9c]:before{background-color:#ff3d3d}.zjapp .total-status-green[data-v-be07cd9c]:before{background-color:#0bc666}.zjapp .total-status-white[data-v-be07cd9c]:before{background-color:#fff}.zjapp .total-status-white-border[data-v-be07cd9c]:before{background-color:#fff;border:1px solid #dcdcdc}.zjapp .total-status-blue[data-v-be07cd9c]:before{background-color:#4174e9}.zjapp .total-status-purple-border[data-v-be07cd9c]:before{background-color:#fff;border:1px solid #796bfb}.zjapp .total-status-green-border[data-v-be07cd9c]:before{background-color:#fff;border:1px solid #0bc666}.zjapp .status-total-bar.-abs-top-right[data-v-be07cd9c]{position:absolute;top:0;right:13px}.zjapp .status-total-bar.-abs-top-right .total-item[data-v-be07cd9c]{padding-left:3px;padding-right:3px}.zjapp .status-total-bar.-abs-top-right .total-status[data-v-be07cd9c]:before{margin-right:2px}',""])},e89f:function(t,e,o){"use strict";var a=o("04f3"),i=o("cf09"),n=o("4360"),r=0;e.a={name:"PopupMixin",data:function(){return{backButtonEvent:null}},watch:{show:function(t){var e=this;if(t){if(this.$nextTick((function(){e.$el&&e.$el.style&&(e.$el.style.zIndex=++i.a.zIndex,r++,n.a.commit("app/SET_HAS_POPUP",!!r))})),!this.backButtonEvent){var o=this.close||this.closePopup;this.backButtonEvent=Object(a.a)(o)}}else--r<0&&(r=0),n.a.commit("app/SET_HAS_POPUP",!!r),this.backButtonEvent&&(Object(a.c)(this.backButtonEvent),this.backButtonEvent=null)}},methods:{}}},efb7:function(t,e,o){"use strict";o("c59c")},f546:function(t,e,o){"use strict";var a={name:"StatusTotalBar",props:{data:{type:Array,default:function(){return[]}},status:{type:String,default:"default"}},data:function(){return{}}},i=(o("f6de"),o("17cc")),n=Object(i.a)(a,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"status-total-bar"},t._l(t.data,(function(e,a){return o("div",{key:a,staticClass:"total-item"},["default"===t.status?[o("p",[o("span",{staticClass:"total-status",class:"total-status-"+e.color},[t._v("\n          "+t._s(e.status)+"\n        ")])]),o("p",[t._v("\n        "+t._s(e.total)+"\n      ")])]:t._e(),"laser-scanning"===t.status?[o("p",[o("span",{staticClass:"total-status",class:"total-status-"+e.color},[t._v("\n          "+t._s(e.status)+"\n        ")]),t._v("\n        ("+t._s(e.total)+")\n      ")])]:t._e()],2)})))}),[],!1,null,"be07cd9c",null);e.a=n.exports},f6de:function(t,e,o){"use strict";o("5b85")},f7ab:function(t,e,o){"use strict";var a=o("65e9").a,i=(o("f7d4"),o("17cc")),n=Object(i.a)(a,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.show?o("div",{ref:"synchronize-tip-bar",staticClass:"synchronize-tip-bar"},[o("icon",{attrs:{name:"caution"}}),t.waitUploadNum?o("span",[t._v("您有"+t._s(t.waitUploadNum)+"条数据待上传")]):t._e(),!t.waitUploadNum&&t.hasChanged?o("span",[t._v("有新数据")]):t._e(),t._v("\n  ，下拉可"+t._s(t.waitUploadNum?"上传":"刷新")+"\n")],1):t._e()}),[],!1,null,"66826030",null);e.a=n.exports},f7d4:function(t,e,o){"use strict";o("2d6e")},fde2:function(t,e,o){"use strict";o.r(e);var a=o("b4db").a,i=(o("efb7"),o("17cc")),n=Object(i.a)(a,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("page-content",{attrs:{title:"工序验收"}},[o("synchronize-tip-bar",{attrs:{"automatic-update-callback":t.init}}),o("div",{staticClass:"drop-down-group bg-sub-theme border-bottom"},[o("drop-down-select",{attrs:{value:t.model.buildingCurrent,options:t.model.buildingList,stage:3,"min-select-stage":2,"show-text-level":2===t.model.deliver_type?2:3,"options-map":[{name:"标段"},{key:"buildings",name:"楼栋"},{key:"units",name:"单元"}]},on:{onSelect:t.onChangeBuilding}}),o("drop-down-select",{attrs:{value:t.model.checkItemCurrent,options:t.model.checkItemList,stage:3,"min-select-stage":2,"only-show-last-text":!0,"keep-stage":[!0,!0],"options-map":[{name:"一级检查项"},{key:"subitem",name:"二级检查项"},{key:"subitem",name:"三级检查项"}]},on:{onSelect:t.onChangeCheckItem}})],1),o("scroller",{attrs:{"is-empty":t.isListEmpty},on:{pullDown:t.init}},[o("status-total-bar",{attrs:{data:[{status:"不合格",color:"red"},{status:"施工已验",color:"green"},{status:"监理已验",color:"orange"},{status:"建设已验",color:"blue"}]}}),t.model.isFloorLoading||1!==t.model.deliver_type?t._e():o("place-list",{staticClass:"mt10",attrs:{"has-title":!0,data:t.model.listData,"item-name-key":"floorName","children-key":"rooms","status-class":{"不合格":"bg-red","施工已验":"bg-green","监理已验":"bg-orange","建设已验":"bg-blue"}},on:{click:t.gotoDetail}}),t.model.isFloorLoading||2!==t.model.deliver_type&&5!==t.model.deliver_type?t._e():o("div",[o("div",{staticClass:"list list-room border-tb mt10"},t._l(t.model.listData,(function(e,a){return o("div",{key:a,staticClass:"item-list-room",class:t.classSet[e.status],domProps:{textContent:t._s(e.floorName)},on:{click:function(o){t.gotoDetail(e,t.model.deliver_type)}}})})))]),t.model.isFloorLoading||3!==t.model.deliver_type?t._e():o("div",[o("div",{staticClass:"list list-room border-tb"},[o("div",{staticClass:"item-list-room",class:t.classSet[t.model.buildingData.status],domProps:{textContent:t._s(t.model.buildingData.name)},on:{click:function(e){t.gotoDetail(t.model.buildingData)}}})])]),!t.model.isFloorLoading&&90===t.model.deliver_type&&t.model.places.length?o("div",{staticClass:"mt10"},[o("div",{staticClass:"list list-pile"},t._l(t.model.places,(function(e,a){return o("div",{key:a,staticClass:"item-list-pile",staticStyle:{flex:"0 0 50%"},on:{click:function(o){t.gotoDetail(e,t.model.deliver_type)}}},[o("div",{staticClass:"item-list-pile-name item-list-room",class:t.classSet[e.status],style:{color:e.custom_location?"":"#999",width:"100%",margin:0},domProps:{textContent:t._s(e.custom_location||"部位未填")}})])})))]):t._e(),1===t.model.deliver_type||2===t.model.deliver_type||5===t.model.deliver_type?o("loading-status",{attrs:{"is-loading":t.model.isFloorLoading,"is-empty":!t.model.listData.length,"empty-text":"没有楼层"}}):t._e(),90===t.model.deliver_type?o("loading-status",{attrs:{"is-loading":t.model.isFloorLoading,"is-empty":!t.model.places.length,"empty-text":"没有数据"}}):t._e()],1),90!==t.model.deliver_type||t.model.isCheckAccept&&1!==t.model.userIdentity?t._e():o("app-button-group",{attrs:{"fixed-bottom":""}},[o("app-button",{on:{click:function(e){t.gotoDetail()}}},[t._v("\n      发起验收\n    ")])],1)],1)}),[],!1,null,"82946754",null);e.default=n.exports}}]);