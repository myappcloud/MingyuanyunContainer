(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-2d0d2f53"],{"5b5e":function(e,t,r){"use strict";(function(e){r("9e76"),r("163d"),r("e697");var i,n=r("fd50"),a=r("3bd5"),c=r("ed08"),o=r("4ad6"),u=r("3122"),d=r("3516"),s=r("37d5"),_=r("f2d3"),l=r("48f4"),f=r("6bf2"),m=r.n(f),h=r("4360"),b=r("4921"),g=r("334f"),y=r("b725"),k=r("6b81"),v=r("2f02"),P=r("7364"),j=r("59f8"),q=r("c745"),C=r("0136"),w=function(t,r){var i=a.a.getUser();return g.a.getProblemCCAllColumn(t).then((function(n){if(e.some(n,(function(e){return e.cc===i.user_id&&e.type===r})))return g.a.updateProblemReadingTime(t);var a={id:i.user_id,name:i.user_name,type:r,reading_time:c.a.getNowDate()};return g.a.appendCC(t,a).then((function(){return g.a.updateProblemReadingTime(t)}))}))},B=function(e){var t=e.status;return"已关闭"===e.status&&(t="非正常关闭"),n.a.resolve({status_text:t})};i={getCheckProblemDraftList:function(e){return b.a.getCheckProblemDraftList(e).catch((function(e){return $log.error(e),n.a.reject(e)}))},getCheckProblemList:function(t){var r=a.a.getUser().user_id;return b.a.getCheckProblemList(t,r).then((function(a){return e.map(a,(function(e){i.getProblemLocalStatus({status:e.status}).then((function(t){e.status_text=t.status_text}))})),b.a.getCheckProblemCount(t,r).then((function(e){return n.a.resolve({data:a,total:e.count})}))})).catch((function(e){return $log.error(e),n.a.reject(e)}))},getCheckProblemInfo:function(t){return t?n.a.all([b.a.getCheckProblem(t),y.a.getRepair(t),k.a.getMutliReinspect(t),g.a.getCC(t),g.a.getProblemCCAllColumn(t),k.a.getReinspectByList(t)]).then((function(t){var r=t[0],i=t[5],a=t[1];a&&(r.repair_set=a,r.has_read=a.has_read);var c=t[2];e.isEmpty(c)?r.reinspect_set=[]:r.reinspect_set=c;var o=t[3];o&&o.length>0&&(r.cc_set_id_array=e.map(o,(function(e){return{id:e.user_id}})),r.cc_set_name_array=e.map(o,(function(e){return{name:e.user_name}})),r.cc_set_array=e.map(o,(function(e){return{id:e.user_id,name:e.user_name,mobile:e.mobile,is_im_user:e.is_im_user}})));var u=t[4];return u&&u.length>0&&(r.cc_set_all_id_array=e.map(u,(function(e){return{id:e.cc}}))),r.regist_by||r.sent_back_by||r.repair_by||r.reinspect_by?s.default.getAllProjectUsers(r.proj_id).then((function(t){if(r.regist_by){var n=e.find(t,(function(e){return e.user_id===r.regist_by}));n&&(r.regist=n)}if(r.sent_back_by){var a=e.find(t,(function(e){return e.user_id===r.sent_back_by}));a&&(r.sent_back={id:a.user_id,name:a.user_name,mobile:a.mobile,is_im_user:a.is_im_user})}if(r.repair_by){var c=e.find(t,(function(e){return e.user_id===r.repair_by}));c&&(r.repair=c)}return e.isEmpty(i)||(r.reinspectBy=e.map(i,(function(r){var i=e.find(t,(function(e){return e.user_id===r.reinspect}));return i?{id:i.user_id,name:i.user_name,mobile:i.mobile,is_im_user:i.is_im_user,reinspect_date:r.reinspect_date,reinspect_remark:r.reinspect_remark,reinspect_image_file:JSON.parse(r.reinspect_image_file||"[]"),reinspectById:r.id}:{id:r.reinspect,name:"该用户已被删除",mobile:"",is_im_user:null,reinspect_date:r.reinspect_date,reinspect_remark:"",reinspect_image_file:[],reinspectById:r.id}})),r.reinspectBy=e.filter(r.reinspectBy,(function(e){return!!e})),r.reinspect=e.filter(r.reinspectBy,(function(e){return!!e.reinspect_date}))),r.regist=r.regist||{},r.sent_back=r.sent_back||{},r.repair=r.repair||{},r.reinspect=r.reinspect||[],r})):(r.regist={},r.sent_back={},r.repair={},r.reinspect=[],n.a.resolve(r))})).catch((function(e){$log.log(e)})):n.a.resolve({})},submit:function(t,r,i){if(!1===i)return function(e,t){var r=a.a.getUser();return e.repair_deadline="",e.regist_by=r.user_id,e.regist_date=c.a.getNowDate(),e.created_by=r.user_id,e.created_on=c.a.getNowDate(),e.image_file=JSON.stringify(e.image_file),e.drawing_file&&(e.drawing_file=JSON.stringify(e.drawing_file)),$log.log("专项巡检--\x3e不通知整改",e),b.a.submit(e).then((function(){return P.a.saveProblemStatusLog(e.proj_id,"",e.batch_id,e.id,"已提交","","",e.image_file)})).then((function(){return w(e.id,"登记人")})).then((function(t){return l.default.addSyncGroup([["checkquality_problem",e.id],["checkquality_cc",e.id]])})).then((function(){if("special-inspect-problem"!==t)return C.a.saveTodo({biz_id:e.id,proj_id:e.proj_id,module_code:t||"",type:2})})).catch((function(e){return $log.error(e),n.a.reject(e)}))}(t,r);if("待提交"!==t.status&&"草稿"!==t.status&&"合格草稿"!==t.status&&"不合格草稿"!==t.status)return n.a.reject("问题单状态异常");if(!t.checkItem.id)return n.a.reject("请先选择检查项");if(!t.repair_set||!t.repair_set.id)return n.a.reject("请选择问题的整改人");if(e.isEmpty(t.reinspect_set))return n.a.reject("请选择问题的复验人");var o=a.a.getUser();t.status="待整改";var u=new Date;return u.setDate(u.getDate()+Number(t.deadline)),t.repair_deadline=m()(u).format("YYYY-MM-DD"),"special-inspect-problem"===r&&t.regist_by&&t.regist_date&&t.created_by&&t.created_on||(t.regist_by=o.user_id,t.regist_date=c.a.getNowDate(),t.created_by=o.user_id,t.created_on=c.a.getNowDate()),t.image_file=JSON.stringify(t.image_file),t.drawing_file&&(t.drawing_file=JSON.stringify(t.drawing_file)),$log.log("现场检查--\x3e提交问题",t),b.a.submit(t).then((function(){return P.a.saveProblemStatusLog(t.proj_id,t.bidsection_id,t.batch_id,t.id,"已提交","","",t.image_file)})).then((function(){return w(t.id,"登记人")})).then((function(){if("special-inspect-problem"!==r){var e=t.created_by===t.repair_set.id?1:2;return C.a.insertTodoData(t.created_by,t.id,r,e,0)}})).then((function(){return k.a.getReinspectByList(t.id)})).then((function(r){return l.default.addSyncGroup([["checkquality_problem",t.id],["checkquality_repair",t.id],["checkquality_reinspect",t.id],["checkquality_reinspect_by",e.map(r,"id")],["checkquality_cc",t.id]])})).catch((function(e){return $log.error(e),n.a.reject(e)}))},save:function(e){if("待提交"!==e.status&&"草稿"!==e.status&&"合格草稿"!==e.status&&"不合格草稿"!==e.status)return n.a.reject("问题单状态异常。");if(!/^\+?[0-9]*$/.test(e.deadline))return n.a.reject("整改期限必须是正整数");var t={id:e.id,remark:e.remark,image_file:e.image_file,batch_id:e.batch_id,batch_type:e.batch_type,bidsection_id:e.bidsection_id||"",proj_id:e.proj_id,created_by:e.created_by,created_on:c.a.getNowDate(),status:e.status,room_id:e.room_id||"",building_id:e.building_id||"",unit:e.unit||"",floor:e.floor||"",biz_id:e.biz_id||"",biz_children_id:e.biz_children_id||"",deduction:void 0===e.deduction?"":e.deduction,redline_deduction:4===e.mode||8===e.mode?e.redline_deduction:0,contract_id:e.contract&&e.contract.id?e.contract.id:""};return e.repair_requirements&&(t.repair_requirements=e.repair_requirements||""),e.checkItem&&e.checkItem.id&&(t.item_id=e.checkItem.id),e.place&&e.place.full_name&&(t.place=e.place.full_name),e.contractor&&e.contractor.id&&(t.contractor_id=e.contractor.id),e.description&&e.description.id?t.desc_id=e.description.id:t.desc_id="",t.emergency_degree=e.level,e.deadline&&(t.deadline=e.deadline),e.place_point&&(t.problem_values=JSON.stringify(e.place_point)),t.image_file=JSON.stringify(e.image_file),e.drawing_file&&(t.drawing_file=JSON.stringify(e.drawing_file)),(e.process_mode||null===e.process_mode)&&(t.process_mode=e.process_mode),8===e.mode&&(t.deduction_level=e.deduction_level),e.id?b.a.update(t,e.cc_set,e.repair_set,e.reinspect_set).then((function(){return n.a.resolve(e.id)})).catch((function(e){return $log.error(e),n.a.reject(e)})):(t.id=c.a.uuid(),b.a.insert(t).then((function(){return b.a.update(t,e.cc_set,e.repair_set,e.reinspect_set)})).then((function(){return n.a.resolve(t.id)})).catch((function(e){return $log.error(e),n.a.reject(e)})))},delete:function(e){return b.a.getCheckProblem(e).then((function(t){return"待提交"===t.status||"草稿"===t.status||"合格草稿"===t.status||"不合格草稿"===t.status?b.a.delete(e).catch((function(e){return $log.error(e),n.a.reject(e)})):($log.log("问题单状态异常："+e),n.a.reject("问题单状态异常"))}))},repair:function(t,r){if("待整改"!==t.status)return n.a.reject("问题单状态异常");var i=a.a.getUser();t.status="待复验",t.repair_by=i.user_id,t.repair_date=c.a.getNowDate();var o=JSON.stringify(t.repair_image_file);return b.a.getCheckProblem(t.id).then((function(i){if(!i||"待整改"===i.status)return $log.log("现场检查--\x3e完成整改",t),b.a.repairProblem(t.id,t.status,t.repair_by,t.repair_remark,t.repair_date,o).then((function(){return P.a.saveProblemStatusLog(t.proj_id,t.bidsection_id,t.batch_id,t.id,"已整改","",t.repair_remark,o)})).then((function(){return w(t.id,"操作人")})).then((function(){if("special-inspect-problem"!==r){var i=2;e.filter(t.reinspect_set,{user_id:t.repair_by}).length&&(i=1);var n=C.a.getTodoSort(t.status,t.repair_deadline,t.close_date,t.repair_date,t.sent_back_times,t.emergency_degree,"check");return C.a.insertTodoData(t.repair_by,t.id,"check",i,n)}})).then((function(){return l.default.addSyncGroup([["checkquality_problem",t.id],["checkquality_cc",t.id]])}));$log.log("提交整改时数据已变为",i)})).catch((function(e){return $log.error(e),n.a.reject(e)}))},reinspectPass:function(t,r){if("待复验"!==t.status)return n.a.reject("问题单状态异常");t.currentReinspectBy=t.currentReinspectBy||{};var i=a.a.getUser(),o="",u=e.isEmpty(t.currentReinspectBy.reinspect_image_file)?"":JSON.stringify(t.currentReinspectBy.reinspect_image_file);return b.a.getCheckProblem(t.id).then((function(a){if(!a||"待复验"===a.status)return k.a.reinspectPass(t.id,i.user_id,c.a.now(),u,t.currentReinspectBy.reinspect_remark||"").then((function(){return k.a.getReinspectByList(t.id).then((function(r){var a=e.every(r,(function(e){return!!e.reinspect_date})),u=e.find(r,{reinspect:i.user_id});return u?(o=u.id,a?(t.status="已通过",t.respect_by=i.user_id,t.reinspect_completed_date=c.a.getNowDate(),b.a.reinspectProblemPass(t.id,t.status,t.reinspect_completed_date,t.respect_by).then((function(){return P.a.saveProblemStatusLog(t.proj_id,t.bidsection_id,t.batch_id,t.id,"已复验","","","")}))):void 0):n.a.reject("问题单复验人异常")}))})).then((function(){return w(t.id,"操作人")})).then((function(){if("special-inspect-problem"!==r){var e=C.a.getTodoSort(t.status,t.repair_deadline,t.close_date,t.repair_date,t.sent_back_times,t.emergency_degree,"check");return C.a.insertTodoData(i.user_id,t.id,r||"check",2,e)}})).then((function(){return l.default.addSyncGroup([["checkquality_problem",t.id],["checkquality_reinspect_by",o],["checkquality_cc",t.id]])}))})).catch((function(e){return $log.error(e),n.a.reject(e)}))},reinspectReject:function(t,r){var i=[["checkquality_problem",t.id],["checkquality_cc",t.id]];if("待复验"!==t.status)return n.a.reject("问题单状态异常");if(!t.sent_back_remark)return n.a.reject("请填写退回原因");var o=a.a.getUser();t.sent_back_times?t.sent_back_times++:t.sent_back_times=1,t.status="待整改",t.sent_back_date=c.a.getNowDate(),t.sent_back_by=o.user_id;var u=JSON.stringify(t.sent_back_image_file);return $log.log("现场检查--\x3e复验退回",t),b.a.reinspectProblemReject(t.id,t.status,t.sent_back_date,t.sent_back_remark,u,t.sent_back_by,t.sent_back_times).then((function(){return P.a.saveProblemStatusLog(t.proj_id,t.bidsection_id,t.batch_id,t.id,"已退回",t.sent_back_remark,"",u)})).then((function(){return k.a.clearReinspectByData(t.id)})).then((function(){return w(t.id,"操作人")})).then((function(){if("special-inspect-problem"!==r){var e=2;t.repair_set.id&&t.repair_set.id===o.user_id&&(e=1);var i=C.a.getTodoSort(t.status,t.repair_deadline,t.close_date,t.repair_date,t.sent_back_times,t.emergency_degree,"check");return C.a.insertTodoData(o.user_id,t.id,"check",e,i)}})).then((function(){return k.a.getReinspectByList(t.id).then((function(t){i.push(["checkquality_reinspect_by",e.map(t,"id")])}))})).then((function(){if(1===t.has_read)return y.a.update({has_read:0},{checkquality_problem_id:t.id}).then((function(){i.push(["checkquality_repair",t.id])}))})).then((function(){return l.default.addSyncGroup(i)})).catch((function(e){return $log.error(e),n.a.reject(e)}))},close:function(e,t){if("待整改"!==e.status)return n.a.reject("问题单状态异常");if(!e.close_reason)return n.a.reject("请填写关闭原因");var r=a.a.getUser();return e.close_date=c.a.getNowDate(),e.status="已关闭",$log.log("现场检查--\x3e非正常关闭",e),b.a.closeProblem(e.id,e.status,e.close_date,e.close_reason).then((function(){return P.a.saveProblemStatusLog(e.proj_id,e.bidsection_id,e.batch_id,e.id,"已关闭",e.close_reason,"","")})).then((function(){return w(e.id,"操作人")})).then((function(){if("special-inspect-problem"!==t){var i=C.a.getTodoSort(e.status,e.repair_deadline,e.close_date,e.repair_date,e.sent_back_times,e.emergency_degree,"check");return C.a.insertTodoData(r.user_id,e.id,"check",2,i)}})).then((function(){return l.default.addSyncGroup([["checkquality_problem",e.id],["checkquality_cc",e.id]])})).catch((function(e){return $log.error(e),n.a.reject(e)}))},changeRepair:function(e,t,r){if(!e.repair_set||!e.repair_set.id)return n.a.reject("请指定一个整改人");var i=a.a.getUser();return $log.log("现场检查--\x3e修改整改人",e),b.a.updateProblemModifiedBy(e.id).then((function(){if(t)return b.a.updateProblemContractor(e.id,e.contractor.id)})).then((function(){if(t){var r=e.contractor&&e.contractor.id||"";return b.a.updateProblemContractor(e.id,r)}})).then((function(){return y.a.changeProblemRepairer(e)})).then((function(){return v.a.saveProblemFpInfo(e.proj_id,e.bidsection_id,e.batch_id,e.id,e.repair_set.id,e.repair_set_old.id,"分配整改人")})).then((function(){return w(e.id,"操作人")})).then((function(){if("special-inspect-problem"!==r){var t=2;e.repair_set.id&&e.repair_set.id===i.user_id&&(t=1);var n=C.a.getTodoSort(e.status,e.repair_deadline,e.close_date,e.repair_date,e.sent_back_times,e.emergency_degree,"check");return C.a.insertTodoData(i.user_id,e.id,"check",t,n)}})).then((function(){return l.default.addSyncGroup([["checkquality_problem",e.id],["checkquality_repair",e.id],["checkquality_cc",e.id],["checkquality_problem_fpinfo",e.id]])})).catch((function(e){return $log.error(e),n.a.reject(e)}))},changeReinspect:function(t,r){if(e.isEmpty(t.reinspect_set))return n.a.reject("请指定一个复验人");var i=a.a.getUser();return $log.log("现场检查--\x3e修改复验人",t),b.a.updateProblemModifiedBy(t.id).then((function(){return k.a.changeProblemReinspect(t.id,t.reinspect_set,!0)})).then((function(){var r=e.map(t.reinspect_set,(function(e){return e.id})).join(","),i=e.map(t.reinspect_set_old,(function(e){return e.id})).join(",");return v.a.saveProblemFpInfo(t.proj_id,t.bidsection_id,t.batch_id,t.id,r,i,"分配复验人")})).then((function(){return w(t.id,"操作人")})).then((function(){if("special-inspect-problem"!==r){var n=2;e.filter(t.reinspect_set,{user_id:i.user_id}).length&&"待复验"===t.status&&(n=1);var a=C.a.getTodoSort(t.status,t.repair_deadline,t.close_date,t.repair_date,t.sent_back_times,t.emergency_degree,"check");return C.a.insertTodoData(i.user_id,t.id,"check",n,a)}})).then((function(){return k.a.getReinspectByList(t.id)})).then((function(r){return l.default.addSyncGroup([["checkquality_problem",t.id],["checkquality_reinspect",t.id],["checkquality_reinspect_by",e.map(r,"id")],["checkquality_cc",t.id],["checkquality_problem_fpinfo",t.id]])})).catch((function(e){return $log.error(e),n.a.reject(e)}))},changeCC:function(e){return $log.log("现场检查--\x3e修改抄送人",e),b.a.updateProblemModifiedBy(e.id).then((function(){return g.a.saveProblemCC(e.id,e.cc_set)})).then((function(){return l.default.addSyncGroup([["checkquality_problem",e.id],["checkquality_cc",e.id]])})).catch((function(e){return $log.error(e),n.a.reject(e)}))},changeContractor:function(e){return e.contractor&&e.contractor.id?($log.log("现场检查--\x3e修改责任单位",e),b.a.updateProblemContractor(e.id,e.contractor.id).then((function(){return l.default.addSyncGroup([["checkquality_problem",e.id]])})).catch((function(e){return $log.error(e),n.a.reject(e)}))):n.a.reject("请指定责任单位")},changeRepairDeadline:function(e){if(!/^(\d+)-(\d{1,2})-(\d{1,2})$/.test(e.repair_deadline))return n.a.reject("整改期限需要一个日期格式的值");var t=m()(e.repair_deadline).format("YYYY-MM-DD"),r=m()().format("YYYY-MM-DD");return e.is_timeout=t<r,$log.log("现场检查--\x3e修改整改期限",e),b.a.updateProblemRepairDeadline(e.id,e.repair_deadline).then((function(){return l.default.addSyncGroup([["checkquality_problem",e.id]])})).catch((function(e){return $log.error(e),n.a.reject(e)}))},getProblemLocalStatusById:function(e){return B({status:p.status})},getProblemLocalStatus:B,saveRepairInfo:function(e,t,r){return r=JSON.stringify(r),b.a.saveRepairInfo(e,t,r).then((function(){return b.a.getCheckProblemDraft(e).then((function(t){return _.a.backUpDraft(e,t.proj_id,"checkquality_problem",t)}))}))},problemRead:function(e){return y.a.update({has_read:1},{checkquality_problem_id:e}).then((function(){return l.default.addSyncGroup([["checkquality_problem",e],["checkquality_repair",e]])}))},takePictureAndSave:function(e){var t={shootVideo:!0};return u.a.takePicture(t).then((function(t){if(t)return d.a.getBatch(e).then((function(e){var r={proj_id:e.proj_id,bidsection_id:e.bidsection_id,batch_id:e.id,deadline:e.repair_deadline,batch_type:e.batch_type,created_by:a.a.getUser().user_id,created_on:c.a.now(),image_file:[t],status:"待提交"};return i.save(r)}))})).catch((function(e){return $log.error(e),n.a.reject(e)}))},saveByPicture:function(e,t){return e?d.a.getBatch(t).then((function(t){var r={proj_id:t.proj_id,bidsection_id:t.bidsection_id,batch_id:t.id,deadline:t.repair_deadline,batch_type:t.batch_type,created_by:a.a.getUser().user_id,created_on:c.a.now(),image_file:[{temp:e}],status:"待提交"};return i.save(r)})).catch((function(e){return $log.error(e),n.a.reject(e)})):n.a.when()},createProblem:function(e,t){return d.a.getBatch(t).then((function(t){var r={proj_id:t.proj_id,bidsection_id:t.bidsection_id,batch_id:t.id,deadline:t.repair_deadline,batch_type:t.batch_type,created_by:a.a.getUser().user_id,created_on:c.a.now(),image_file:[{temp:e}],status:"待提交"};return i.save(r)}))},takePicture:function(){return u.a.takePicture()},allowSelectPicture:function(){return j.a.getValue("upload_from_phone_albums").then((function(e){return"1"===e}))},reinspectByConflict:function(t){return e.isEmpty(t.reinspectBy)?n.a.when():k.a.removeProblemReinspectBy(t.reinspectBy[0].checkquality_problem_id).then((function(){return k.a.insertReinspectByList(t.reinspectBy)})).then((function(){return TodoRepository.removeProblemTodo(t.reinspectBy[0].checkquality_problem_id)})).then((function(){return TodoRepository.insertTodoList(t.todo)}))},copyProblem:function(t){return n.a.all([b.a.getProblemAllColumn(t),y.a.getRepairAllColumn(t),k.a.getReinspectAllColumn(t),k.a.getReinspectByList(t),g.a.getProblemCCAllColumn(t)]).then((function(t){var r=t[0],i=t[1],o=t[2],u=t[3],d=t[4];if(r.id=c.a.uuid(),r.status="待提交",r.regist_by="",r.repair_by="",r.repair_remark="",r.repair_date="",r.repair_image_file="",r.sent_back_by="",r.sent_back_date="",r.sent_back_times=0,r.sent_back_remark="",r.sent_back_image_file="",r.reinspect_by="",r.reinspect_completed_date="",r.close_date="",r.close_reason="",r.created_by=a.a.getUser().user_id,r.created_on=c.a.now(),r.modified_by=a.a.getUser().user_id,r.download_time="",r.update_timestamp="",r.repair_deadline&&!r.deadline&&r.regist_date){for(var s=r.repair_deadline.match(/\d+/g),_=0;_<s.length;_++)s[_]=parseInt(s[_]);for(var l=new Date(s[0],s[1]-1,s[2],s[3]||0,s[4]||0,s[5]||0),p=r.regist_date.match(/\d+/g),f=0;f<p.length;f++)p[f]=parseInt(p[f]);var m=new Date(p[0],p[1]-1,p[2],p[3]||0,p[4]||0,p[5]||0);r.deadline=Math.ceil((l.getTime()-m.getTime())/864e5)}r.regist_date="",r.repair_deadline="",e.each(i,(function(e){e.id=c.a.uuid(),e.checkquality_problem_id=r.id,e.download_time=""})),e.each(o,(function(e){e.id=c.a.uuid(),e.checkquality_problem_id=r.id,e.download_time=""})),e.each(u,(function(e){e.id=c.a.uuid(),e.checkquality_problem_id=r.id,e.reinspect_date="",i.reinspect_remark="",i.reinspect_image_file="",e.download_time=""}));var h=e.filter(d,(function(e){return"默认"===e.type}));return h=e.map(h,(function(e){return{id:e.cc}})),d=e.filter(d,(function(e){return"被抄送"===e.type})),d=e.map(d,(function(e){return{id:e.cc}})),n.a.all([b.a.insert(r),y.a.insert(i),k.a.insertReinspect(o),k.a.insertReinspectByList(u),g.a.saveProblemCC(r.id,d),g.a.saveDefaultCc(r.id,h)])}))},removeLocalInvalidProblem:function(t){var r=n.a.when();return t.problem_repair&&(r=r.then((function(){return y.a.removeInvalidData(t.problem.id,e.map(t.problem_repair,"id"))}))),t.problem_reinspect&&(r=r.then((function(){return k.a.removeInvalidData(t.problem.id,e.map(t.problem_reinspect,"id"))}))),t.problem_cc&&(r=r.then((function(){return g.a.removeInvalidData(t.problem.id,e.map(t.problem_cc,"id"))}))),t.children_Problem&&(r=r.then((function(){return b.a.removeInvalidChildProblem(t.problem.id,t.children_Problem)}))),r},removeLocalInvalidProblem1:function(t,r){var i=r.checkquality_problem;return n.a.when().then((function(){if(r.checkquality_problem)return b.a.deleteProblemById(i.id)})).then((function(){if(r.checkquality_repair)return y.a.removeInvalidData(i.id,e.map(r.checkquality_repair,"id"))})).then((function(){if(r.checkquality_cc)return g.a.removeInvalidData(i.id,e.map(r.checkquality_cc,"id"))}))},removeClosedBatchProblem:function(){return d.a.getClosedBatchIdList().then((function(e){return i.deleteBatchProblems(e)}))},deleteBatchProblems:function(t){return $log.log("删除已关闭批次的问题"),b.a.getProblemsByBatch(t).then((function(t){var r=n.a.when(),i=["image_file","repair_image_file","sent_back_image_file"],a=[];return e.each(t,(function(t){for(var r=0;r<i.length;++r){var n=t[i[r]]=JSON.parse(t[i[r]]||"[]");e.each(n,(function(e){e.local&&a.push(e.local),e.thumbnail&&a.push(e.thumbnail),e.temp&&a.push(e.temp)}))}})),e.each(a,(function(e){r=r.then((function(){return o.a.isFileExists(e)})).then((function(t){if(t)return o.a.deleteFile(e)}))})),r})).then((function(){return b.a.deleteProblemByBatch(t)}))},getLeaderComments:function(t){return b.a.getLeaderComments(t).then((function(t){return e.each(t,(function(e){e.user={id:e.user_id,name:e.user_name,mobile:e.mobile,is_im_user:e.is_im_user},e.image_file&&(e.image_file=JSON.parse(e.image_file))})),t}))},getPhotoRequired:function(e,t){var r=h.a.state.global.allGrayRelease.UsingProjectParameter;return q.a.getProjParameter(e,"is_photo_required",t).then((function(e){return r&&e&&e.length?Number(e[0].value):h.a.state.global.isPhotoRequired[t]})).catch((function(e){console.log("error",e)}))}},t.a=i}).call(this,r("391c"))}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fX21vZHVsZV9lbnRyeV96amFwcF9fLy4vc3JjL3NlcnZpY2UvY2hlY2svY2hlY2stcHJvYmxlbS1zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbIl9zZWxmIiwiX2FwcGVuZFRvQ0MiLCJpZCIsInR5cGUiLCJ1c2VyIiwiY29udGV4dCIsImdldFVzZXIiLCJDaGVja1F1YWxpdHlQcm9ibGVtQ0NSZXBvc2l0b3J5IiwiZ2V0UHJvYmxlbUNDQWxsQ29sdW1uIiwidGhlbiIsImNjTGlzdCIsIl8iLCJzb21lIiwiY2MiLCJ1c2VyX2lkIiwidXBkYXRlUHJvYmxlbVJlYWRpbmdUaW1lIiwibmFtZSIsInVzZXJfbmFtZSIsInJlYWRpbmdfdGltZSIsIlV0aWxzIiwiZ2V0Tm93RGF0ZSIsImFwcGVuZENDIiwiX2dldFByb2JsZW1Mb2NhbFN0YXR1cyIsInByb2JsZW0iLCJzdGF0dXNUZXh0Iiwic3RhdHVzIiwiJHEiLCJyZXNvbHZlIiwic3RhdHVzX3RleHQiLCJnZXRDaGVja1Byb2JsZW1EcmFmdExpc3QiLCJiYXRjaElkIiwiQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkiLCJjYXRjaCIsImVycm9yIiwiJGxvZyIsInJlamVjdCIsImdldENoZWNrUHJvYmxlbUxpc3QiLCJ1c2VySWQiLCJkYXRhUmVzdWx0IiwibWFwIiwibCIsImdldFByb2JsZW1Mb2NhbFN0YXR1cyIsInJlc3VsdCIsImdldENoZWNrUHJvYmxlbUNvdW50IiwiZGF0YUNvdW50IiwiZGF0YSIsInRvdGFsIiwiZ2V0Q2hlY2tQcm9ibGVtSW5mbyIsImFsbCIsImdldENoZWNrUHJvYmxlbSIsIkNoZWNrUXVhbGl0eVByb2JsZW1SZXBhaXJSZXBvc2l0b3J5IiwiZ2V0UmVwYWlyIiwiQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkiLCJnZXRNdXRsaVJlaW5zcGVjdCIsImdldENDIiwiZ2V0UmVpbnNwZWN0QnlMaXN0IiwicmVzdWx0cyIsInJlaW5zcGVjdEJ5TGlzdCIsInJlcGFpclNldCIsInJlcGFpcl9zZXQiLCJoYXNfcmVhZCIsInJlaW5zcGVjdFNldCIsImlzRW1wdHkiLCJyZWluc3BlY3Rfc2V0IiwiY2NTZXQiLCJsZW5ndGgiLCJjY19zZXRfaWRfYXJyYXkiLCJjY19zZXRfbmFtZV9hcnJheSIsImNjX3NldF9hcnJheSIsIm1vYmlsZSIsImlzX2ltX3VzZXIiLCJjY1NldEFsbCIsImNjX3NldF9hbGxfaWRfYXJyYXkiLCJyZWdpc3RfYnkiLCJzZW50X2JhY2tfYnkiLCJyZXBhaXJfYnkiLCJyZWluc3BlY3RfYnkiLCJQcm9qZWN0U2VydmljZSIsImdldEFsbFByb2plY3RVc2VycyIsInByb2pfaWQiLCJ1c2VycyIsInJlZ2lzdFVzZXIiLCJmaW5kIiwicmVnaXN0Iiwic2VudEJhY2tVc2VyIiwic2VudF9iYWNrIiwicmVwYWlyVXNlciIsInJlcGFpciIsInJlaW5zcGVjdEJ5IiwicmVpbnNwZWN0VXNlciIsInJlaW5zcGVjdCIsInJlaW5zcGVjdF9kYXRlIiwicmVpbnNwZWN0X3JlbWFyayIsInJlaW5zcGVjdF9pbWFnZV9maWxlIiwiSlNPTiIsInBhcnNlIiwicmVpbnNwZWN0QnlJZCIsImZpbHRlciIsImxvZyIsInN1Ym1pdCIsInByb2JsZW1EYXRhIiwidG9kb01vZHVsZUNvZGUiLCJuZWVkUmVwYWlyIiwicmVwYWlyX2RlYWRsaW5lIiwicmVnaXN0X2RhdGUiLCJjcmVhdGVkX2J5IiwiY3JlYXRlZF9vbiIsImltYWdlX2ZpbGUiLCJzdHJpbmdpZnkiLCJkcmF3aW5nX2ZpbGUiLCJDaGVja1F1YWxpdHlQcm9ibGVtTG9nUmVwb3NpdG9yeSIsInNhdmVQcm9ibGVtU3RhdHVzTG9nIiwiYmF0Y2hfaWQiLCJEYXRhU3luY2hyb25pemVyIiwiYWRkU3luY0dyb3VwIiwiVG9kb1NlcnZpY2UiLCJzYXZlVG9kbyIsImJpel9pZCIsIm1vZHVsZV9jb2RlIiwiX3N1Ym1pdFByb2JsZW1XaXRob3V0TmVlZFJlcGFpciIsImNoZWNrSXRlbSIsImRhdGUiLCJEYXRlIiwic2V0RGF0ZSIsImdldERhdGUiLCJOdW1iZXIiLCJkZWFkbGluZSIsIm1vbWVudCIsImZvcm1hdCIsImJpZHNlY3Rpb25faWQiLCJpbnNlcnRUb2RvRGF0YSIsInNhdmUiLCJ0ZXN0IiwicmVtYXJrIiwiYmF0Y2hfdHlwZSIsInJvb21faWQiLCJidWlsZGluZ19pZCIsInVuaXQiLCJmbG9vciIsImJpel9jaGlsZHJlbl9pZCIsImRlZHVjdGlvbiIsInJlZGxpbmVfZGVkdWN0aW9uIiwibW9kZSIsImNvbnRyYWN0X2lkIiwiY29udHJhY3QiLCJyZXBhaXJfcmVxdWlyZW1lbnRzIiwiaXRlbV9pZCIsInBsYWNlIiwiZnVsbF9uYW1lIiwiY29udHJhY3RvciIsImNvbnRyYWN0b3JfaWQiLCJkZXNjcmlwdGlvbiIsImRlc2NfaWQiLCJlbWVyZ2VuY3lfZGVncmVlIiwibGV2ZWwiLCJwbGFjZV9wb2ludCIsInByb2JsZW1fdmFsdWVzIiwicHJvY2Vzc19tb2RlIiwiZGVkdWN0aW9uX2xldmVsIiwidXBkYXRlIiwiY2Nfc2V0IiwidXVpZCIsImluc2VydCIsImRlbGV0ZSIsInEiLCJtb2R1bGVDb2RlIiwicmVwYWlyX2RhdGUiLCJyZXBhaXJJbWFnZUZpbGUiLCJyZXBhaXJfaW1hZ2VfZmlsZSIsImV4aXN0c1Byb2JsZW0iLCJyZXBhaXJQcm9ibGVtIiwicmVwYWlyX3JlbWFyayIsInNvcnQiLCJnZXRUb2RvU29ydCIsImNsb3NlX2RhdGUiLCJzZW50X2JhY2tfdGltZXMiLCJyZWluc3BlY3RQYXNzIiwiY3VycmVudFJlaW5zcGVjdEJ5IiwicmVpbnNwZWN0SWQiLCJyZWluc3BlY3RJbWFnZUZpbGUiLCJub3ciLCJsaXN0IiwiYWxsRG9uZSIsImV2ZXJ5IiwiaXRlbSIsInJlc3BlY3RfYnkiLCJyZWluc3BlY3RfY29tcGxldGVkX2RhdGUiLCJyZWluc3BlY3RQcm9ibGVtUGFzcyIsInJlaW5zcGVjdFJlamVjdCIsInN5bmNRdWV1ZSIsInNlbnRfYmFja19yZW1hcmsiLCJzZW50X2JhY2tfZGF0ZSIsInNlbnRCYWNrSW1hZ2VGaWxlIiwic2VudF9iYWNrX2ltYWdlX2ZpbGUiLCJyZWluc3BlY3RQcm9ibGVtUmVqZWN0IiwiY2xlYXJSZWluc3BlY3RCeURhdGEiLCJwdXNoIiwiY2hlY2txdWFsaXR5X3Byb2JsZW1faWQiLCJjbG9zZSIsImNsb3NlX3JlYXNvbiIsImNsb3NlUHJvYmxlbSIsImNoYW5nZVJlcGFpciIsImlzQ29udHJhY3RvckNoYW5nZSIsInVwZGF0ZVByb2JsZW1Nb2RpZmllZEJ5IiwidXBkYXRlUHJvYmxlbUNvbnRyYWN0b3IiLCJjb250cmFjdG9ySWQiLCJjaGFuZ2VQcm9ibGVtUmVwYWlyZXIiLCJDaGVja1F1YWxpdHlQcm9ibGVtRnBJbmZvUmVwb3NpdG9yeSIsInNhdmVQcm9ibGVtRnBJbmZvIiwicmVwYWlyX3NldF9vbGQiLCJjaGFuZ2VSZWluc3BlY3QiLCJjaGFuZ2VQcm9ibGVtUmVpbnNwZWN0IiwicmVpbnNwZWN0SWRzIiwiam9pbiIsInJlaW5zcGVjdElkc09sZCIsInJlaW5zcGVjdF9zZXRfb2xkIiwiY2hhbmdlQ0MiLCJzYXZlUHJvYmxlbUNDIiwiY2hhbmdlQ29udHJhY3RvciIsImNoYW5nZVJlcGFpckRlYWRsaW5lIiwicmVwYWlyRGVhZGxpbmUiLCJ0b2RheSIsImlzX3RpbWVvdXQiLCJ1cGRhdGVQcm9ibGVtUmVwYWlyRGVhZGxpbmUiLCJnZXRQcm9ibGVtTG9jYWxTdGF0dXNCeUlkIiwicCIsInNhdmVSZXBhaXJJbmZvIiwicHJvYmxlbUlkIiwicmVwYWlyUmVtYXJrIiwiZ2V0Q2hlY2tQcm9ibGVtRHJhZnQiLCJUb2RvTGlzdFNlcnZpY2UiLCJiYWNrVXBEcmFmdCIsInByb2JsZW1SZWFkIiwidGFrZVBpY3R1cmVBbmRTYXZlIiwib3B0aW9ucyIsIkltYWdlU2VydmljZSIsInRha2VQaWN0dXJlIiwiaW1hZ2UiLCJCYXRjaFNlcnZpY2UiLCJnZXRCYXRjaCIsImJhdGNoIiwic2F2ZUJ5UGljdHVyZSIsInBhdGgiLCJ0ZW1wIiwid2hlbiIsImNyZWF0ZVByb2JsZW0iLCJwaWN0dXJlUGF0aCIsImFsbG93U2VsZWN0UGljdHVyZSIsIkdsb2JhbFN0b3JhZ2VSZXBvc2l0b3J5IiwiZ2V0VmFsdWUiLCJ2YWwiLCJyZWluc3BlY3RCeUNvbmZsaWN0IiwidXBsb2FkUmVzdWx0IiwicmVtb3ZlUHJvYmxlbVJlaW5zcGVjdEJ5IiwiaW5zZXJ0UmVpbnNwZWN0QnlMaXN0IiwiVG9kb1JlcG9zaXRvcnkiLCJyZW1vdmVQcm9ibGVtVG9kbyIsImluc2VydFRvZG9MaXN0IiwidG9kbyIsImNvcHlQcm9ibGVtIiwiZ2V0UHJvYmxlbUFsbENvbHVtbiIsImdldFJlcGFpckFsbENvbHVtbiIsImdldFJlaW5zcGVjdEFsbENvbHVtbiIsInJlcGFpckxpc3QiLCJyZWluc3BlY3RMaXN0IiwibW9kaWZpZWRfYnkiLCJkb3dubG9hZF90aW1lIiwidXBkYXRlX3RpbWVzdGFtcCIsImFyciIsIm1hdGNoIiwiaSIsInBhcnNlSW50IiwiZGVhZGxpbmVEYXRlIiwiYXJyMiIsInJlZ2lzdERhdGUiLCJNYXRoIiwiY2VpbCIsImdldFRpbWUiLCJlYWNoIiwiZGVmYXVsdENjTGlzdCIsImluc2VydFJlaW5zcGVjdCIsInNhdmVEZWZhdWx0Q2MiLCJyZW1vdmVMb2NhbEludmFsaWRQcm9ibGVtIiwicHJvbWlzZSIsInByb2JsZW1fcmVwYWlyIiwicmVtb3ZlSW52YWxpZERhdGEiLCJwcm9ibGVtX3JlaW5zcGVjdCIsInByb2JsZW1fY2MiLCJjaGlsZHJlbl9Qcm9ibGVtIiwicmVtb3ZlSW52YWxpZENoaWxkUHJvYmxlbSIsInJlbW92ZUxvY2FsSW52YWxpZFByb2JsZW0xIiwicmVtb3RlRGF0YSIsImxvY2FsRGF0YSIsImNoZWNrcXVhbGl0eV9wcm9ibGVtIiwiZGVsZXRlUHJvYmxlbUJ5SWQiLCJjaGVja3F1YWxpdHlfcmVwYWlyIiwiY2hlY2txdWFsaXR5X2NjIiwicmVtb3ZlQ2xvc2VkQmF0Y2hQcm9ibGVtIiwiZ2V0Q2xvc2VkQmF0Y2hJZExpc3QiLCJiYXRjaElkcyIsImRlbGV0ZUJhdGNoUHJvYmxlbXMiLCJnZXRQcm9ibGVtc0J5QmF0Y2giLCJwcm9ibGVtcyIsImltYWdlQ29sdW1ucyIsImZpbGVzIiwiaW1hZ2VzIiwibG9jYWwiLCJ0aHVtYm5haWwiLCJmaWxlIiwicGx1Z2luQXBpIiwiaXNGaWxlRXhpc3RzIiwiZXhpc3RzIiwiZGVsZXRlRmlsZSIsImRlbGV0ZVByb2JsZW1CeUJhdGNoIiwiZ2V0TGVhZGVyQ29tbWVudHMiLCJnZXRQaG90b1JlcXVpcmVkIiwicHJvaklkIiwia2V5IiwicGhvdG9HcmF5Iiwic3RvcmUiLCJzdGF0ZSIsImdsb2JhbCIsImFsbEdyYXlSZWxlYXNlIiwiVXNpbmdQcm9qZWN0UGFyYW1ldGVyIiwiQ29tbW9uQmFzZWRhdGFTZXJ2aWNlIiwiZ2V0UHJvalBhcmFtZXRlciIsInZhbHVlIiwiaXNQaG90b1JlcXVpcmVkIiwiY29uc29sZSJdLCJtYXBwaW5ncyI6Im1NQW1DSUEsRSx5UEE2b0NBQyxFQUFjLFNBQVNDLEVBQUlDLEdBQzdCLElBQUlDLEVBQU9DLElBQVFDLFVBRW5CLE9BQU9DLElBQWdDQyxzQkFBc0JOLEdBQUlPLE1BQUssU0FBU0MsR0FHN0UsR0FDRUMsRUFBRUMsS0FBS0YsR0FBUSxTQUFTRyxHQUN0QixPQUFPQSxFQUFHQSxLQUFPVCxFQUFLVSxTQUFXRCxFQUFHVixPQUFTQSxLQUkvQyxPQUFPSSxJQUFnQ1EseUJBQXlCYixHQUVoRSxJQUFJVyxFQUFLLENBQ1BYLEdBQUlFLEVBQUtVLFFBQ1RFLEtBQU1aLEVBQUthLFVBQ1hkLEtBQU1BLEVBQ05lLGFBQWNDLElBQU1DLGNBRXRCLE9BQU9iLElBQWdDYyxTQUFTbkIsRUFBSVcsR0FBSUosTUFBSyxXQUMzRCxPQUFPRixJQUFnQ1EseUJBQXlCYixVQVdwRW9CLEVBQXlCLFNBQVNDLEdBQ3BDLElBQUlDLEVBQWFELEVBQVFFLE9BS3pCLE1BSnVCLFFBQW5CRixFQUFRRSxTQUNWRCxFQUFhLFNBR1JFLElBQUdDLFFBQVEsQ0FBRUMsWUFBYUosS0FtQ25DeEIsRUFBUSxDQUlONkIseUJBM3VC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QUFNcUUsT0FHZnJFLEVBQU1zRSxXQUNSSCxFQUFNNUcsS0FBS3lDLEVBQU1zRSxXQUdmdEUsRUFBTU0sTUFDUjZELEVBQU01RyxLQUFLeUMsRUFBTU0sYUFNekJ4TyxFQUFFMlEsS0FBSzBCLEdBQU8sU0FBU0ksR0FDckJ6QixFQUFVQSxFQUNQbFIsTUFBSyxXQUNKLE9BQU80UyxJQUFVQyxhQUFhRixNQUUvQjNTLE1BQUssU0FBUzhTLEdBQ2IsR0FBSUEsRUFDRixPQUFPRixJQUFVRyxXQUFXSixTQUs3QnpCLEtBRVJsUixNQUFLLFdBQ0osT0FBT3NCLElBQThCMFIscUJBQXFCZCxPQVFoRWUsa0JBQW1CLFNBQVN2RixHQUMxQixPQUFPcE0sSUFBOEIyUixrQkFBa0J2RixHQUFXMU4sTUFBSyxTQUFTNEssR0FjOUUsT0FiQTFLLEVBQUUyUSxLQUFLakcsR0FBTSxTQUFTRyxHQUNwQkEsRUFBS3BMLEtBQU8sQ0FDVkYsR0FBSXNMLEVBQUsxSyxRQUNURSxLQUFNd0ssRUFBS3ZLLFVBQ1hvRCxPQUFRbUgsRUFBS25ILE9BQ2JDLFdBQVlrSCxFQUFLbEgsWUFHZmtILEVBQUs3RSxhQUNQNkUsRUFBSzdFLFdBQWFiLEtBQUtDLE1BQU15RixFQUFLN0UsZ0JBSS9CMEUsTUFJWHNJLGlCQW5mTSxTQW1mV0MsRUFBUUMsR0FDdkIsSUFBTUMsRUFBWUMsSUFBTUMsTUFBTUMsT0FBT0MsZUFBZUMsc0JBQ3BELE9BQU9DLElBQXNCQyxpQkFBaUJULEVBQVEsb0JBQXFCQyxHQUN4RXBULE1BQUssU0FBQW9DLEdBQ0osT0FBSWlSLEdBQ0VqUixHQUFRQSxFQUFLb0IsT0FDUjRELE9BQU9oRixFQUFLLEdBQUd5UixPQUtqQlAsSUFBTUMsTUFBTUMsT0FBT00sZ0JBQWdCVixNQUc3QzdSLE9BQU0sU0FBQUMsR0FDTHVTLFFBQVF0TyxJQUFJLFFBQVNqRSxRQU1kakMsUSIsImZpbGUiOiJqcy9jaHVuay0yZDBkMmY1My5qcz92MTYwODcxNDQ1MTE5NSIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5a6J5YWo5paH5piO6Zeu6aKY5pyN5Yqh5a+56LGhXG4gKi9cblxuaW1wb3J0ICRxIGZyb20gJ0BzdGF0aWMvbGliL3Byb21pc2UnO1xuaW1wb3J0IGNvbnRleHQgZnJvbSAnQHNyYy9mcmFtZXdvcmsvY29udGV4dCc7XG5pbXBvcnQgVXRpbHMgZnJvbSAnQHNyYy91dGlscy9pbmRleCc7XG5pbXBvcnQgcGx1Z2luQXBpIGZyb20gJ0BzcmMvYXBpL3BsdWdpbkFwaSc7XG5pbXBvcnQgSW1hZ2VTZXJ2aWNlIGZyb20gJ0BzcmMvc2VydmljZS9jb21tb24vaW1hZ2Utc2VydmljZSc7XG5pbXBvcnQgQmF0Y2hTZXJ2aWNlIGZyb20gJ0BzcmMvc2VydmljZS9jb21tb24vYmF0Y2gtc2VydmljZSc7XG5pbXBvcnQgUHJvamVjdFNlcnZpY2UgZnJvbSAnQHNyYy9zZXJ2aWNlL2NvbW1vbi9wcm9qZWN0LXNlcnZpY2UnO1xuaW1wb3J0IFRvZG9MaXN0U2VydmljZSBmcm9tICdAc3JjL3NlcnZpY2UvdG9kby90b2RvLWxpc3Qtc2VydmljZSc7XG5pbXBvcnQgRGF0YVN5bmNocm9uaXplciBmcm9tICdAc3JjL3NlcnZpY2UvY29tbW9uL2RhdGEtc3luY2hyb25pemVyJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCBzdG9yZSBmcm9tICdAc3RvcmUnO1xuXG5pbXBvcnQgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkgZnJvbSAnQHNyYy9yZXBvc2l0b3JpZXMvY2hlY2stcXVhbGl0eS1wcm9ibGVtLXJlcG9zaXRvcnknO1xuaW1wb3J0IENoZWNrUXVhbGl0eVByb2JsZW1DQ1JlcG9zaXRvcnkgZnJvbSAnQHNyYy9yZXBvc2l0b3JpZXMvY2hlY2stcXVhbGl0eS1wcm9ibGVtLWNjLXJlcG9zaXRvcnknO1xuaW1wb3J0IENoZWNrUXVhbGl0eVByb2JsZW1SZXBhaXJSZXBvc2l0b3J5IGZyb20gJ0BzcmMvcmVwb3NpdG9yaWVzL2NoZWNrLXF1YWxpdHktcHJvYmxlbS1yZXBhaXItcmVwb3NpdG9yeSc7XG5pbXBvcnQgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkgZnJvbSAnQHNyYy9yZXBvc2l0b3JpZXMvY2hlY2stcXVhbGl0eS1wcm9ibGVtLXJlaW5zcGVjdC1yZXBvc2l0b3J5JztcbmltcG9ydCBDaGVja1F1YWxpdHlQcm9ibGVtRnBJbmZvUmVwb3NpdG9yeSBmcm9tICdAc3JjL3JlcG9zaXRvcmllcy9jaGVjay1xdWFsaXR5LXByb2JsZW0tZnBpbmZvLXJlcG9zaXRvcnknO1xuaW1wb3J0IENoZWNrUXVhbGl0eVByb2JsZW1Mb2dSZXBvc2l0b3J5IGZyb20gJ0BzcmMvcmVwb3NpdG9yaWVzL2NoZWNrLXF1YWxpdHktcHJvYmxlbS1sb2ctcmVwb3NpdG9yeSc7XG5pbXBvcnQgR2xvYmFsU3RvcmFnZVJlcG9zaXRvcnkgZnJvbSAnQHNyYy9yZXBvc2l0b3JpZXMvZ2xvYmFsLXN0b3JhZ2UtcmVwb3NpdG9yeSc7XG5pbXBvcnQgQ29tbW9uQmFzZWRhdGFTZXJ2aWNlIGZyb20gJ0BzcmMvc2VydmljZS9jb21tb24vY29tbW9uLWJhc2VkYXRhLXNlcnZpY2UnO1xuXG5pbXBvcnQgVG9kb1NlcnZpY2UgZnJvbSAnQHNyYy9zZXJ2aWNlL3RvZG8vdG9kby1zZXJ2aWNlJztcblxuLyogQ2hlY2tNb2QuZmFjdG9yeSgnQ2hlY2tRdWFsaXR5UHJvYmxlbVNlcnZpY2UnLCBbJyRxJywgJyRyb290U2NvcGUnLCAnJGZpbHRlcicsICckdGltZW91dCcsICckbG9nJywgJ25ldHdvcmsnLCAnUG9wdXAnLCAnY29udGV4dCcsICdVdGlscycsICdwbHVnaW5BcGknLCAnV2ViU2VydmljZScsICdJbWFnZVNlcnZpY2UnLCAnQmF0Y2hTZXJ2aWNlJywgJ1Byb2plY3RTZXJ2aWNlJywgJ1RvZG9MaXN0U2VydmljZScsXG4gICAgICAgICAgICAnbG9jYWxTdG9yYWdlJywgJ2xvY2FsU3RvcmFnZUtleXMnLCAnRGF0YVN5bmNocm9uaXplcicsICdDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeScsICdDaGVja1F1YWxpdHlQcm9ibGVtQ0NSZXBvc2l0b3J5JywgJ0NoZWNrUXVhbGl0eVByb2JsZW1SZXBhaXJSZXBvc2l0b3J5JywgJ0NoZWNrUXVhbGl0eVByb2JsZW1SZWluc3BlY3RSZXBvc2l0b3J5JywgJ0dsb2JhbFN0b3JhZ2VSZXBvc2l0b3J5JywgJ0NoZWNrUXVhbGl0eVByb2JsZW1GcEluZm9SZXBvc2l0b3J5JywgJ0NoZWNrUXVhbGl0eVByb2JsZW1Mb2dSZXBvc2l0b3J5JywgJ1RvZG9TZXJ2aWNlJywgJ1RvZG9SZXBvc2l0b3J5JyxcbiAgICBmdW5jdGlvbiAoJHEsICRyb290U2NvcGUsICRmaWx0ZXIsICR0aW1lb3V0LCAkbG9nLFxuICAgICAgICAgICAgbmV0d29yaywgUG9wdXAsIGNvbnRleHQsIFV0aWxzLCBwbHVnaW5BcGksIFdlYlNlcnZpY2UsIEltYWdlU2VydmljZSwgQmF0Y2hTZXJ2aWNlLCBQcm9qZWN0U2VydmljZSwgVG9kb0xpc3RTZXJ2aWNlLCBsb2NhbFN0b3JhZ2UsIGxvY2FsU3RvcmFnZUtleXMsIERhdGFTeW5jaHJvbml6ZXIsXG4gICAgICAgICAgICBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeSwgQ2hlY2tRdWFsaXR5UHJvYmxlbUNDUmVwb3NpdG9yeSwgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcGFpclJlcG9zaXRvcnksIENoZWNrUXVhbGl0eVByb2JsZW1SZWluc3BlY3RSZXBvc2l0b3J5LCBHbG9iYWxTdG9yYWdlUmVwb3NpdG9yeSxcbiAgICAgICAgICAgIENoZWNrUXVhbGl0eVByb2JsZW1GcEluZm9SZXBvc2l0b3J5LCBDaGVja1F1YWxpdHlQcm9ibGVtTG9nUmVwb3NpdG9yeSwgVG9kb1NlcnZpY2UsIFRvZG9SZXBvc2l0b3J5KVxueyAqL1xuXG52YXIgX3NlbGY7XG5cbi8qKlxuICog6I635Y+W6Zeu6aKY5a+56LGhXG4gKiBAcGFyYW0gaWQg6Zeu6aKYSWRcbiAqIEByZXR1cm5zIHsqfVxuICogQHByaXZhdGVcbiAqL1xudmFyIF9nZXRDaGVja1Byb2JsZW1JbmZvID0gZnVuY3Rpb24oaWQpIHtcbiAgaWYgKCFpZCkge1xuICAgIHJldHVybiAkcS5yZXNvbHZlKHt9KTtcbiAgfVxuICByZXR1cm4gJHFcbiAgICAuYWxsKFtcbiAgICAgIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LmdldENoZWNrUHJvYmxlbShpZCksXG4gICAgICBDaGVja1F1YWxpdHlQcm9ibGVtUmVwYWlyUmVwb3NpdG9yeS5nZXRSZXBhaXIoaWQpLFxuICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkuZ2V0TXV0bGlSZWluc3BlY3QoaWQpLFxuICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbUNDUmVwb3NpdG9yeS5nZXRDQyhpZCksXG4gICAgICBDaGVja1F1YWxpdHlQcm9ibGVtQ0NSZXBvc2l0b3J5LmdldFByb2JsZW1DQ0FsbENvbHVtbihpZCksXG4gICAgICBDaGVja1F1YWxpdHlQcm9ibGVtUmVpbnNwZWN0UmVwb3NpdG9yeS5nZXRSZWluc3BlY3RCeUxpc3QoaWQpLFxuICAgIF0pXG4gICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0cykge1xuICAgICAgdmFyIHByb2JsZW0gPSByZXN1bHRzWzBdO1xuICAgICAgdmFyIHJlaW5zcGVjdEJ5TGlzdCA9IHJlc3VsdHNbNV07XG5cbiAgICAgIHZhciByZXBhaXJTZXQgPSByZXN1bHRzWzFdO1xuICAgICAgaWYgKHJlcGFpclNldCkge1xuICAgICAgICBwcm9ibGVtLnJlcGFpcl9zZXQgPSByZXBhaXJTZXQ7XG4gICAgICAgIHByb2JsZW0uaGFzX3JlYWQgPSByZXBhaXJTZXQuaGFzX3JlYWQ7XG4gICAgICB9XG5cbiAgICAgIHZhciByZWluc3BlY3RTZXQgPSByZXN1bHRzWzJdO1xuICAgICAgaWYgKCFfLmlzRW1wdHkocmVpbnNwZWN0U2V0KSkge1xuICAgICAgICBwcm9ibGVtLnJlaW5zcGVjdF9zZXQgPSByZWluc3BlY3RTZXQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9ibGVtLnJlaW5zcGVjdF9zZXQgPSBbXTtcbiAgICAgIH1cblxuICAgICAgdmFyIGNjU2V0ID0gcmVzdWx0c1szXTtcbiAgICAgIGlmIChjY1NldCAmJiBjY1NldC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHByb2JsZW0uY2Nfc2V0X2lkX2FycmF5ID0gXy5tYXAoY2NTZXQsIGZ1bmN0aW9uKGNjKSB7XG4gICAgICAgICAgcmV0dXJuIHsgaWQ6IGNjLnVzZXJfaWQgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcHJvYmxlbS5jY19zZXRfbmFtZV9hcnJheSA9IF8ubWFwKGNjU2V0LCBmdW5jdGlvbihjYykge1xuICAgICAgICAgIHJldHVybiB7IG5hbWU6IGNjLnVzZXJfbmFtZSB9O1xuICAgICAgICB9KTtcblxuICAgICAgICBwcm9ibGVtLmNjX3NldF9hcnJheSA9IF8ubWFwKGNjU2V0LCBmdW5jdGlvbihjYykge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogY2MudXNlcl9pZCxcbiAgICAgICAgICAgIG5hbWU6IGNjLnVzZXJfbmFtZSxcbiAgICAgICAgICAgIG1vYmlsZTogY2MubW9iaWxlLFxuICAgICAgICAgICAgaXNfaW1fdXNlcjogY2MuaXNfaW1fdXNlcixcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdmFyIGNjU2V0QWxsID0gcmVzdWx0c1s0XTtcbiAgICAgIGlmIChjY1NldEFsbCAmJiBjY1NldEFsbC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHByb2JsZW0uY2Nfc2V0X2FsbF9pZF9hcnJheSA9IF8ubWFwKGNjU2V0QWxsLCBmdW5jdGlvbihjYykge1xuICAgICAgICAgIHJldHVybiB7IGlkOiBjYy5jYyB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHByb2JsZW0ucmVnaXN0X2J5IHx8IHByb2JsZW0uc2VudF9iYWNrX2J5IHx8IHByb2JsZW0ucmVwYWlyX2J5IHx8IHByb2JsZW0ucmVpbnNwZWN0X2J5KSB7XG4gICAgICAgIHJldHVybiBQcm9qZWN0U2VydmljZS5nZXRBbGxQcm9qZWN0VXNlcnMocHJvYmxlbS5wcm9qX2lkKS50aGVuKGZ1bmN0aW9uKHVzZXJzKSB7XG4gICAgICAgICAgaWYgKHByb2JsZW0ucmVnaXN0X2J5KSB7XG4gICAgICAgICAgICB2YXIgcmVnaXN0VXNlciA9IF8uZmluZCh1c2VycywgZnVuY3Rpb24odXNlcikge1xuICAgICAgICAgICAgICByZXR1cm4gdXNlci51c2VyX2lkID09PSBwcm9ibGVtLnJlZ2lzdF9ieTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAocmVnaXN0VXNlcikge1xuICAgICAgICAgICAgICBwcm9ibGVtLnJlZ2lzdCA9IHJlZ2lzdFVzZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHByb2JsZW0uc2VudF9iYWNrX2J5KSB7XG4gICAgICAgICAgICB2YXIgc2VudEJhY2tVc2VyID0gXy5maW5kKHVzZXJzLCBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgIHJldHVybiB1c2VyLnVzZXJfaWQgPT09IHByb2JsZW0uc2VudF9iYWNrX2J5O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoc2VudEJhY2tVc2VyKSB7XG4gICAgICAgICAgICAgIHByb2JsZW0uc2VudF9iYWNrID0ge1xuICAgICAgICAgICAgICAgIGlkOiBzZW50QmFja1VzZXIudXNlcl9pZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBzZW50QmFja1VzZXIudXNlcl9uYW1lLFxuICAgICAgICAgICAgICAgIG1vYmlsZTogc2VudEJhY2tVc2VyLm1vYmlsZSxcbiAgICAgICAgICAgICAgICBpc19pbV91c2VyOiBzZW50QmFja1VzZXIuaXNfaW1fdXNlcixcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAocHJvYmxlbS5yZXBhaXJfYnkpIHtcbiAgICAgICAgICAgIHZhciByZXBhaXJVc2VyID0gXy5maW5kKHVzZXJzLCBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgIHJldHVybiB1c2VyLnVzZXJfaWQgPT09IHByb2JsZW0ucmVwYWlyX2J5O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocmVwYWlyVXNlcikge1xuICAgICAgICAgICAgICBwcm9ibGVtLnJlcGFpciA9IHJlcGFpclVzZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFfLmlzRW1wdHkocmVpbnNwZWN0QnlMaXN0KSkge1xuICAgICAgICAgICAgcHJvYmxlbS5yZWluc3BlY3RCeSA9IF8ubWFwKHJlaW5zcGVjdEJ5TGlzdCwgZnVuY3Rpb24ocmVpbnNwZWN0QnkpIHtcbiAgICAgICAgICAgICAgdmFyIHJlaW5zcGVjdFVzZXIgPSBfLmZpbmQodXNlcnMsIGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlci51c2VyX2lkID09PSByZWluc3BlY3RCeS5yZWluc3BlY3Q7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBpZiAocmVpbnNwZWN0VXNlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBpZDogcmVpbnNwZWN0VXNlci51c2VyX2lkLFxuICAgICAgICAgICAgICAgICAgbmFtZTogcmVpbnNwZWN0VXNlci51c2VyX25hbWUsXG4gICAgICAgICAgICAgICAgICBtb2JpbGU6IHJlaW5zcGVjdFVzZXIubW9iaWxlLFxuICAgICAgICAgICAgICAgICAgaXNfaW1fdXNlcjogcmVpbnNwZWN0VXNlci5pc19pbV91c2VyLFxuICAgICAgICAgICAgICAgICAgcmVpbnNwZWN0X2RhdGU6IHJlaW5zcGVjdEJ5LnJlaW5zcGVjdF9kYXRlLFxuICAgICAgICAgICAgICAgICAgcmVpbnNwZWN0X3JlbWFyazogcmVpbnNwZWN0QnkucmVpbnNwZWN0X3JlbWFyayxcbiAgICAgICAgICAgICAgICAgIHJlaW5zcGVjdF9pbWFnZV9maWxlOiBKU09OLnBhcnNlKHJlaW5zcGVjdEJ5LnJlaW5zcGVjdF9pbWFnZV9maWxlIHx8ICdbXScpLFxuICAgICAgICAgICAgICAgICAgcmVpbnNwZWN0QnlJZDogcmVpbnNwZWN0QnkuaWQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgaWQ6IHJlaW5zcGVjdEJ5LnJlaW5zcGVjdCxcbiAgICAgICAgICAgICAgICAgIG5hbWU6ICfor6XnlKjmiLflt7LooqvliKDpmaQnLFxuICAgICAgICAgICAgICAgICAgbW9iaWxlOiAnJyxcbiAgICAgICAgICAgICAgICAgIGlzX2ltX3VzZXI6IG51bGwsXG4gICAgICAgICAgICAgICAgICByZWluc3BlY3RfZGF0ZTogcmVpbnNwZWN0QnkucmVpbnNwZWN0X2RhdGUsXG4gICAgICAgICAgICAgICAgICByZWluc3BlY3RfcmVtYXJrOiAnJyxcbiAgICAgICAgICAgICAgICAgIHJlaW5zcGVjdF9pbWFnZV9maWxlOiBbXSxcbiAgICAgICAgICAgICAgICAgIHJlaW5zcGVjdEJ5SWQ6IHJlaW5zcGVjdEJ5LmlkLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBwcm9ibGVtLnJlaW5zcGVjdEJ5ID0gXy5maWx0ZXIocHJvYmxlbS5yZWluc3BlY3RCeSwgZnVuY3Rpb24ocmVpbnNwZWN0KSB7XG4gICAgICAgICAgICAgIHJldHVybiAhIXJlaW5zcGVjdDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBwcm9ibGVtLnJlaW5zcGVjdCA9IF8uZmlsdGVyKHByb2JsZW0ucmVpbnNwZWN0QnksIGZ1bmN0aW9uKHJlaW5zcGVjdCkge1xuICAgICAgICAgICAgICByZXR1cm4gISFyZWluc3BlY3QucmVpbnNwZWN0X2RhdGU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyDlj6rmnInor6bmg4XpobXpnaLmiY3nlKjliLDkuIvpnaLov5nlh6DkuKrlsZ7mgKfvvIzogIzor6bmg4XpobXpnaLoh7PlsJHlrZjlnKhyZWdpc3RfYnlcbiAgICAgICAgICBwcm9ibGVtLnJlZ2lzdCA9IHByb2JsZW0ucmVnaXN0IHx8IHt9O1xuICAgICAgICAgIHByb2JsZW0uc2VudF9iYWNrID0gcHJvYmxlbS5zZW50X2JhY2sgfHwge307XG4gICAgICAgICAgcHJvYmxlbS5yZXBhaXIgPSBwcm9ibGVtLnJlcGFpciB8fCB7fTtcbiAgICAgICAgICBwcm9ibGVtLnJlaW5zcGVjdCA9IHByb2JsZW0ucmVpbnNwZWN0IHx8IFtdO1xuXG4gICAgICAgICAgcmV0dXJuIHByb2JsZW07XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJvYmxlbS5yZWdpc3QgPSB7fTtcbiAgICAgICAgcHJvYmxlbS5zZW50X2JhY2sgPSB7fTtcbiAgICAgICAgcHJvYmxlbS5yZXBhaXIgPSB7fTtcbiAgICAgICAgcHJvYmxlbS5yZWluc3BlY3QgPSBbXTtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocHJvYmxlbSk7XG4gICAgICB9XG4gICAgfSlcbiAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICRsb2cubG9nKGVycm9yKTtcbiAgICB9KTtcbn07XG5cbi8vIOS4k+mhueW3oeajgCAtIOS4jemAmuefpeaVtOaUueeahOa1geeoi1xudmFyIF9zdWJtaXRQcm9ibGVtV2l0aG91dE5lZWRSZXBhaXIgPSBmdW5jdGlvbihwcm9ibGVtRGF0YSwgdG9kb01vZHVsZUNvZGUpIHtcbiAgdmFyIHVzZXIgPSBjb250ZXh0LmdldFVzZXIoKTtcblxuICBwcm9ibGVtRGF0YS5yZXBhaXJfZGVhZGxpbmUgPSAnJztcbiAgcHJvYmxlbURhdGEucmVnaXN0X2J5ID0gdXNlci51c2VyX2lkO1xuICBwcm9ibGVtRGF0YS5yZWdpc3RfZGF0ZSA9IFV0aWxzLmdldE5vd0RhdGUoKTtcbiAgcHJvYmxlbURhdGEuY3JlYXRlZF9ieSA9IHVzZXIudXNlcl9pZDtcbiAgcHJvYmxlbURhdGEuY3JlYXRlZF9vbiA9IFV0aWxzLmdldE5vd0RhdGUoKTtcbiAgcHJvYmxlbURhdGEuaW1hZ2VfZmlsZSA9IEpTT04uc3RyaW5naWZ5KHByb2JsZW1EYXRhLmltYWdlX2ZpbGUpO1xuXG4gIGlmIChwcm9ibGVtRGF0YS5kcmF3aW5nX2ZpbGUpIHtcbiAgICBwcm9ibGVtRGF0YS5kcmF3aW5nX2ZpbGUgPSBKU09OLnN0cmluZ2lmeShwcm9ibGVtRGF0YS5kcmF3aW5nX2ZpbGUpO1xuICB9XG5cbiAgJGxvZy5sb2coJ+S4k+mhueW3oeajgC0tPuS4jemAmuefpeaVtOaUuScsIHByb2JsZW1EYXRhKTtcbiAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LnN1Ym1pdChwcm9ibGVtRGF0YSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIC8vIOS/neWtmOmXrumimOeKtuaAgeWPmOWMluaXpeW/l1xuICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1Mb2dSZXBvc2l0b3J5LnNhdmVQcm9ibGVtU3RhdHVzTG9nKFxuICAgICAgICBwcm9ibGVtRGF0YS5wcm9qX2lkLFxuICAgICAgICAnJyxcbiAgICAgICAgcHJvYmxlbURhdGEuYmF0Y2hfaWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmlkLFxuICAgICAgICAn5bey5o+Q5LqkJyxcbiAgICAgICAgJycsXG4gICAgICAgICcnLFxuICAgICAgICBwcm9ibGVtRGF0YS5pbWFnZV9maWxlXG4gICAgICApO1xuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gX2FwcGVuZFRvQ0MocHJvYmxlbURhdGEuaWQsICfnmbvorrDkuronKTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKHJlaW5zcGVjdEJ5TGlzdCkge1xuICAgICAgcmV0dXJuIERhdGFTeW5jaHJvbml6ZXIuYWRkU3luY0dyb3VwKFtcbiAgICAgICAgWydjaGVja3F1YWxpdHlfcHJvYmxlbScsIHByb2JsZW1EYXRhLmlkXSxcbiAgICAgICAgWydjaGVja3F1YWxpdHlfY2MnLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICBdKTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgLy8g5aaC5p6c5Li65LiT6aG55beh5qOA77yM5LiN5Yqg5YWl5b6F5Yqe6KGoXG4gICAgICBpZiAodG9kb01vZHVsZUNvZGUgIT09ICdzcGVjaWFsLWluc3BlY3QtcHJvYmxlbScpIHtcbiAgICAgICAgcmV0dXJuIFRvZG9TZXJ2aWNlLnNhdmVUb2RvKHtcbiAgICAgICAgICBiaXpfaWQ6IHByb2JsZW1EYXRhLmlkLFxuICAgICAgICAgIHByb2pfaWQ6IHByb2JsZW1EYXRhLnByb2pfaWQsXG4gICAgICAgICAgbW9kdWxlX2NvZGU6IHRvZG9Nb2R1bGVDb2RlIHx8ICcnLFxuICAgICAgICAgIHR5cGU6IDIsIC8vIOmXrumimOS4jemcgOaVtOaUuVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgJGxvZy5lcnJvcihlcnJvcik7XG4gICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICB9KTtcbn07XG4vKipcbiAqIOaPkOS6pOmXrumimOWNlVxuICogQHBhcmFtIHByb2JsZW1EYXRhIOmXrumimOWNleaVsOaNrlxuICogQHJldHVybnMgeyp9XG4gKiBAcHJpdmF0ZVxuICovXG52YXIgX3N1Ym1pdCA9IGZ1bmN0aW9uKHByb2JsZW1EYXRhLCB0b2RvTW9kdWxlQ29kZSwgbmVlZFJlcGFpcikge1xuICAvKipcbiAgICogMjAxOS0xMi0xOSBuZWVkUmVwYWly77yM5piv55So5LqO5LiT6aG55beh5qOA5LiN6YCa55+l5pW05pS555qE5Y+C5pWw77yMZmFsc2XkuLrkuI3pgJrnn6XmlbTmlLnvvIznm7TmjqXlj5jkuLrmo4Dmn6XlrozmiJDvvJtcbiAgICog546w5Zy65L+u5pS5IHRvZG9Nb2R1bGVDb2RlLCBuZWVkUmVwYWly5Y+C5pWw6aG65bqP77yM5Yig6Zmk5LmL5YmN55qE5aSE55CGXG4gICAqL1xuICBpZiAobmVlZFJlcGFpciA9PT0gZmFsc2UpIHtcbiAgICAvLyDkuJPpobnlt6Hmo4AgLSDkuI3pgJrnn6XmlbTmlLlcbiAgICByZXR1cm4gX3N1Ym1pdFByb2JsZW1XaXRob3V0TmVlZFJlcGFpcihwcm9ibGVtRGF0YSwgdG9kb01vZHVsZUNvZGUpO1xuICB9XG5cbiAgaWYgKFxuICAgIHByb2JsZW1EYXRhLnN0YXR1cyAhPT0gJ+W+heaPkOS6pCcgJiZcbiAgICBwcm9ibGVtRGF0YS5zdGF0dXMgIT09ICfojYnnqL8nICYmXG4gICAgcHJvYmxlbURhdGEuc3RhdHVzICE9PSAn5ZCI5qC86I2J56i/JyAmJlxuICAgIHByb2JsZW1EYXRhLnN0YXR1cyAhPT0gJ+S4jeWQiOagvOiNieeovydcbiAgKSB7XG4gICAgcmV0dXJuICRxLnJlamVjdCgn6Zeu6aKY5Y2V54q25oCB5byC5bi4Jyk7XG4gIH1cblxuICBpZiAoIXByb2JsZW1EYXRhLmNoZWNrSXRlbS5pZCkge1xuICAgIHJldHVybiAkcS5yZWplY3QoJ+ivt+WFiOmAieaLqeajgOafpemhuScpO1xuICB9XG5cbiAgaWYgKCFwcm9ibGVtRGF0YS5yZXBhaXJfc2V0IHx8ICFwcm9ibGVtRGF0YS5yZXBhaXJfc2V0LmlkKSB7XG4gICAgcmV0dXJuICRxLnJlamVjdCgn6K+36YCJ5oup6Zeu6aKY55qE5pW05pS55Lq6Jyk7XG4gIH1cblxuICBpZiAoXy5pc0VtcHR5KHByb2JsZW1EYXRhLnJlaW5zcGVjdF9zZXQpKSB7XG4gICAgcmV0dXJuICRxLnJlamVjdCgn6K+36YCJ5oup6Zeu6aKY55qE5aSN6aqM5Lq6Jyk7XG4gIH1cblxuICB2YXIgdXNlciA9IGNvbnRleHQuZ2V0VXNlcigpO1xuXG4gIHByb2JsZW1EYXRhLnN0YXR1cyA9ICflvoXmlbTmlLknO1xuXG4gIC8vIOiuoeeul+aVtOaUueWujOaIkOacn+mZkCDlvZPliY3ml7bpl7Qr5pW05pS55pyf6ZmQXG4gIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgTnVtYmVyKHByb2JsZW1EYXRhLmRlYWRsaW5lKSk7XG4gIHByb2JsZW1EYXRhLnJlcGFpcl9kZWFkbGluZSA9IG1vbWVudChkYXRlKS5mb3JtYXQoJ1lZWVktTU0tREQnKTtcbiAgLyoqXG4gICAyMDIwLTEwLTA5IOS4k+mhueW3oeajgOS4i++8jOS8muacieS7peS4i+aDheWGte+8mlxuICAgMeOAgeacqumAmuefpeaVtOaUue+8jOS4iuS8oOWbvueJh++8jOaPkOS6pOmXrumimO+8m1xuICAgMuOAgeWPpuS4gOS4quS6uumAmuefpeaVtOaUue+8jOS8muWwhiByZWdpc3RfYnnjgIFyZWdpc3RfZGF0ZeOAgWNyZWF0ZWRfYnnjgIFjcmVhdGVkX29u5pS55Li65b2T5YmN55So5oi377ybXG4gICAz44CB5Zu+54mH5LiK55qE55So5oi35ZKM6Zeu6aKY5o+Q5Lqk5Lq65LiN5LiA6Ie077ybXG4gICDmt7vliqDliKTmlq3vvJpcbiAgIDHjgIHkuJPpobnlt6Hmo4DmqKHlnZfvvJtcbiAgIDLjgIHlpoLmnpzlt7Lnu4/mnIlyZWdpc3RfYnnnrYnvvIzliJnkuI3kvb/nlKjlvZPliY3nlKjmiLfvvIznlKjmlbDmja7lupPmlbDmja7vvJtcbiAgIDPjgIHlpoLmnpzmsqHmnIlyZWdpc3RfYnnnrYnvvIzliJnkvb/nlKjlvZPliY3nlKjmiLfvvJtcbiAgKi9cbiAgY29uc3QgaXNSYXdEYXRlID1cbiAgICB0b2RvTW9kdWxlQ29kZSA9PT0gJ3NwZWNpYWwtaW5zcGVjdC1wcm9ibGVtJyAmJlxuICAgIHByb2JsZW1EYXRhLnJlZ2lzdF9ieSAmJlxuICAgIHByb2JsZW1EYXRhLnJlZ2lzdF9kYXRlICYmXG4gICAgcHJvYmxlbURhdGEuY3JlYXRlZF9ieSAmJlxuICAgIHByb2JsZW1EYXRhLmNyZWF0ZWRfb247XG5cbiAgaWYgKCFpc1Jhd0RhdGUpIHtcbiAgICBwcm9ibGVtRGF0YS5yZWdpc3RfYnkgPSB1c2VyLnVzZXJfaWQ7XG4gICAgcHJvYmxlbURhdGEucmVnaXN0X2RhdGUgPSBVdGlscy5nZXROb3dEYXRlKCk7XG4gICAgcHJvYmxlbURhdGEuY3JlYXRlZF9ieSA9IHVzZXIudXNlcl9pZDtcbiAgICBwcm9ibGVtRGF0YS5jcmVhdGVkX29uID0gVXRpbHMuZ2V0Tm93RGF0ZSgpO1xuICB9XG4gIHByb2JsZW1EYXRhLmltYWdlX2ZpbGUgPSBKU09OLnN0cmluZ2lmeShwcm9ibGVtRGF0YS5pbWFnZV9maWxlKTtcbiAgaWYgKHByb2JsZW1EYXRhLmRyYXdpbmdfZmlsZSkge1xuICAgIHByb2JsZW1EYXRhLmRyYXdpbmdfZmlsZSA9IEpTT04uc3RyaW5naWZ5KHByb2JsZW1EYXRhLmRyYXdpbmdfZmlsZSk7XG4gIH1cblxuICAkbG9nLmxvZygn546w5Zy65qOA5p+lLS0+5o+Q5Lqk6Zeu6aKYJywgcHJvYmxlbURhdGEpO1xuICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkuc3VibWl0KHByb2JsZW1EYXRhKVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgLy8g5L+d5a2Y6Zeu6aKY54q25oCB5Y+Y5YyW5pel5b+XXG4gICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbUxvZ1JlcG9zaXRvcnkuc2F2ZVByb2JsZW1TdGF0dXNMb2coXG4gICAgICAgIHByb2JsZW1EYXRhLnByb2pfaWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmJpZHNlY3Rpb25faWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmJhdGNoX2lkLFxuICAgICAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICAgICAgJ+W3suaPkOS6pCcsXG4gICAgICAgICcnLFxuICAgICAgICAnJyxcbiAgICAgICAgcHJvYmxlbURhdGEuaW1hZ2VfZmlsZVxuICAgICAgKTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgLy8g5bCG5b2T5YmN5Lq65Yqg5YWl5oqE6YCB5Lq66ZuG5ZCIXG4gICAgICByZXR1cm4gX2FwcGVuZFRvQ0MocHJvYmxlbURhdGEuaWQsICfnmbvorrDkuronKTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgLy8g5b6F5Yqe6KGo5o+S5YWl5Yib5bu65Lq677yM5LiT6aG55beh5qOA5LiN5Yqg5YWl5b6F5YqeXG4gICAgICBpZiAodG9kb01vZHVsZUNvZGUgIT09ICdzcGVjaWFsLWluc3BlY3QtcHJvYmxlbScpIHtcbiAgICAgICAgbGV0IHR5cGUgPSBwcm9ibGVtRGF0YS5jcmVhdGVkX2J5ID09PSBwcm9ibGVtRGF0YS5yZXBhaXJfc2V0LmlkID8gMSA6IDI7XG4gICAgICAgIHJldHVybiBUb2RvU2VydmljZS5pbnNlcnRUb2RvRGF0YShcbiAgICAgICAgICBwcm9ibGVtRGF0YS5jcmVhdGVkX2J5LFxuICAgICAgICAgIHByb2JsZW1EYXRhLmlkLFxuICAgICAgICAgIHRvZG9Nb2R1bGVDb2RlLFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgMFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkuZ2V0UmVpbnNwZWN0QnlMaXN0KHByb2JsZW1EYXRhLmlkKTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKHJlaW5zcGVjdEJ5TGlzdCkge1xuICAgICAgcmV0dXJuIERhdGFTeW5jaHJvbml6ZXIuYWRkU3luY0dyb3VwKFtcbiAgICAgICAgWydjaGVja3F1YWxpdHlfcHJvYmxlbScsIHByb2JsZW1EYXRhLmlkXSxcbiAgICAgICAgWydjaGVja3F1YWxpdHlfcmVwYWlyJywgcHJvYmxlbURhdGEuaWRdLFxuICAgICAgICBbJ2NoZWNrcXVhbGl0eV9yZWluc3BlY3QnLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICAgIFsnY2hlY2txdWFsaXR5X3JlaW5zcGVjdF9ieScsIF8ubWFwKHJlaW5zcGVjdEJ5TGlzdCwgJ2lkJyldLFxuICAgICAgICBbJ2NoZWNrcXVhbGl0eV9jYycsIHByb2JsZW1EYXRhLmlkXSxcbiAgICAgIF0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAkbG9nLmVycm9yKGVycm9yKTtcbiAgICAgIHJldHVybiAkcS5yZWplY3QoZXJyb3IpO1xuICAgIH0pO1xufTtcblxuLyoqXG4gKiDkv53lrZjojYnnqL9cbiAqIEBwYXJhbSBwcm9ibGVtRGF0YSDpl67popjljZXmlbDmja5cbiAqIEByZXR1cm5zIHsqfVxuICogQHByaXZhdGVcbiAqL1xudmFyIF9zYXZlID0gZnVuY3Rpb24ocHJvYmxlbURhdGEpIHtcbiAgaWYgKFxuICAgIHByb2JsZW1EYXRhLnN0YXR1cyAhPT0gJ+W+heaPkOS6pCcgJiZcbiAgICBwcm9ibGVtRGF0YS5zdGF0dXMgIT09ICfojYnnqL8nICYmXG4gICAgcHJvYmxlbURhdGEuc3RhdHVzICE9PSAn5ZCI5qC86I2J56i/JyAmJlxuICAgIHByb2JsZW1EYXRhLnN0YXR1cyAhPT0gJ+S4jeWQiOagvOiNieeovydcbiAgKSB7XG4gICAgcmV0dXJuICRxLnJlamVjdCgn6Zeu6aKY5Y2V54q25oCB5byC5bi444CCJyk7XG4gIH1cblxuICBpZiAoIS9eXFwrP1swLTldKiQvLnRlc3QocHJvYmxlbURhdGEuZGVhZGxpbmUpKSB7XG4gICAgcmV0dXJuICRxLnJlamVjdCgn5pW05pS55pyf6ZmQ5b+F6aG75piv5q2j5pW05pWwJyk7XG4gIH1cblxuICB2YXIgZGF0YSA9IHtcbiAgICBpZDogcHJvYmxlbURhdGEuaWQsXG4gICAgcmVtYXJrOiBwcm9ibGVtRGF0YS5yZW1hcmssXG4gICAgaW1hZ2VfZmlsZTogcHJvYmxlbURhdGEuaW1hZ2VfZmlsZSxcbiAgICBiYXRjaF9pZDogcHJvYmxlbURhdGEuYmF0Y2hfaWQsXG4gICAgYmF0Y2hfdHlwZTogcHJvYmxlbURhdGEuYmF0Y2hfdHlwZSxcbiAgICBiaWRzZWN0aW9uX2lkOiBwcm9ibGVtRGF0YS5iaWRzZWN0aW9uX2lkIHx8ICcnLFxuICAgIHByb2pfaWQ6IHByb2JsZW1EYXRhLnByb2pfaWQsXG4gICAgY3JlYXRlZF9ieTogcHJvYmxlbURhdGEuY3JlYXRlZF9ieSxcbiAgICBjcmVhdGVkX29uOiBVdGlscy5nZXROb3dEYXRlKCksXG4gICAgc3RhdHVzOiBwcm9ibGVtRGF0YS5zdGF0dXMsXG4gICAgcm9vbV9pZDogcHJvYmxlbURhdGEucm9vbV9pZCB8fCAnJyxcbiAgICBidWlsZGluZ19pZDogcHJvYmxlbURhdGEuYnVpbGRpbmdfaWQgfHwgJycsXG4gICAgdW5pdDogcHJvYmxlbURhdGEudW5pdCB8fCAnJyxcbiAgICBmbG9vcjogcHJvYmxlbURhdGEuZmxvb3IgfHwgJycsXG4gICAgYml6X2lkOiBwcm9ibGVtRGF0YS5iaXpfaWQgfHwgJycsXG4gICAgYml6X2NoaWxkcmVuX2lkOiBwcm9ibGVtRGF0YS5iaXpfY2hpbGRyZW5faWQgfHwgJycsXG4gICAgZGVkdWN0aW9uOiB0eXBlb2YgcHJvYmxlbURhdGEuZGVkdWN0aW9uID09PSAndW5kZWZpbmVkJyA/ICcnIDogcHJvYmxlbURhdGEuZGVkdWN0aW9uLFxuICAgIHJlZGxpbmVfZGVkdWN0aW9uOlxuICAgICAgcHJvYmxlbURhdGEubW9kZSA9PT0gNCB8fCBwcm9ibGVtRGF0YS5tb2RlID09PSA4ID8gcHJvYmxlbURhdGEucmVkbGluZV9kZWR1Y3Rpb24gOiAwLFxuICAgIGNvbnRyYWN0X2lkOiBwcm9ibGVtRGF0YS5jb250cmFjdCAmJiBwcm9ibGVtRGF0YS5jb250cmFjdC5pZCA/IHByb2JsZW1EYXRhLmNvbnRyYWN0LmlkIDogJycsXG4gIH07XG5cbiAgLy8g5pW05pS56KaB5rGCXG4gIGlmIChwcm9ibGVtRGF0YS5yZXBhaXJfcmVxdWlyZW1lbnRzKSB7XG4gICAgZGF0YS5yZXBhaXJfcmVxdWlyZW1lbnRzID0gcHJvYmxlbURhdGEucmVwYWlyX3JlcXVpcmVtZW50cyB8fCAnJzsgLy8g5pW05pS56KaB5rGCXG4gIH1cblxuICBpZiAocHJvYmxlbURhdGEuY2hlY2tJdGVtICYmIHByb2JsZW1EYXRhLmNoZWNrSXRlbS5pZCkge1xuICAgIGRhdGEuaXRlbV9pZCA9IHByb2JsZW1EYXRhLmNoZWNrSXRlbS5pZDtcbiAgfVxuICBpZiAocHJvYmxlbURhdGEucGxhY2UgJiYgcHJvYmxlbURhdGEucGxhY2UuZnVsbF9uYW1lKSB7XG4gICAgZGF0YS5wbGFjZSA9IHByb2JsZW1EYXRhLnBsYWNlLmZ1bGxfbmFtZTtcbiAgfVxuICBpZiAocHJvYmxlbURhdGEuY29udHJhY3RvciAmJiBwcm9ibGVtRGF0YS5jb250cmFjdG9yLmlkKSB7XG4gICAgZGF0YS5jb250cmFjdG9yX2lkID0gcHJvYmxlbURhdGEuY29udHJhY3Rvci5pZDtcbiAgfVxuICBpZiAocHJvYmxlbURhdGEuZGVzY3JpcHRpb24gJiYgcHJvYmxlbURhdGEuZGVzY3JpcHRpb24uaWQpIHtcbiAgICBkYXRhLmRlc2NfaWQgPSBwcm9ibGVtRGF0YS5kZXNjcmlwdGlvbi5pZDtcbiAgfSBlbHNlIHtcbiAgICBkYXRhLmRlc2NfaWQgPSAnJztcbiAgfVxuICAvKlxuICAyMDE5LTA1LTIzIOS/ruaUuWJ1Z1xuICDpl67popjvvJrpgInmi6nkuobmo4Dmn6XpobnmnInmj4/ov7DvvIzlho3pgInml6Dmj4/ov7Dmo4Dmn6XpobnvvIzkv53lrZjml7bov5jmmK/kvJrluKbkuIrkuYvliY3pgInmi6nnmoTmj4/ov7DvvJtcbiAg5Y6f5Zug77ya5peg5o+P6L+w5qOA5p+l5pe26L+b5YWl5LiN5LqGaWbvvIzliJnml6Dms5Xkv67mlLlkZXNjX2lk77yM5Lya5L+d55WZ5LmL5YmN55qE5o+P6L+wXG4gIOS/ruaUue+8muWIoOmZpGlm6YCJ5oup77yM5pS55Li65LiJ5YWD6L+Q566X56ym77ybXG4gICovXG4gIC8vIGRhdGEuZGVzY19pZCA9IHByb2JsZW1EYXRhLmRlc2NyaXB0aW9uXG4gIC8vICAgPyBwcm9ibGVtRGF0YS5kZXNjcmlwdGlvbi5pZCB8fCAnJ1xuICAvLyAgIDogJyc7XG5cbiAgZGF0YS5lbWVyZ2VuY3lfZGVncmVlID0gcHJvYmxlbURhdGEubGV2ZWw7XG5cbiAgaWYgKHByb2JsZW1EYXRhLmRlYWRsaW5lKSB7XG4gICAgZGF0YS5kZWFkbGluZSA9IHByb2JsZW1EYXRhLmRlYWRsaW5lO1xuICB9XG4gIGlmIChwcm9ibGVtRGF0YS5wbGFjZV9wb2ludCkge1xuICAgIGRhdGEucHJvYmxlbV92YWx1ZXMgPSBKU09OLnN0cmluZ2lmeShwcm9ibGVtRGF0YS5wbGFjZV9wb2ludCk7XG4gIH1cblxuICBkYXRhLmltYWdlX2ZpbGUgPSBKU09OLnN0cmluZ2lmeShwcm9ibGVtRGF0YS5pbWFnZV9maWxlKTtcblxuICBpZiAocHJvYmxlbURhdGEuZHJhd2luZ19maWxlKSB7XG4gICAgZGF0YS5kcmF3aW5nX2ZpbGUgPSBKU09OLnN0cmluZ2lmeShwcm9ibGVtRGF0YS5kcmF3aW5nX2ZpbGUpO1xuICB9XG5cbiAgLy8g6Ieq5a6a5LmJ6YOo5L2N77yMcHJvY2Vzc19tb2RlID09PSA5MOaXtu+8jOWwhnByb2Nlc3NfbW9kZeWKoOWFpeWFtuS4re+8jOWcqOeOsOWcuuOAgeWuieWFqOOAgei0qOmHj+WmguaenOmAieeahOaYr+mdnumDqOS9je+8jOWImeS4um51bGzvvIznlKjku6Xph43nva5cbiAgaWYgKHByb2JsZW1EYXRhLnByb2Nlc3NfbW9kZSB8fCBwcm9ibGVtRGF0YS5wcm9jZXNzX21vZGUgPT09IG51bGwpIHtcbiAgICBkYXRhLnByb2Nlc3NfbW9kZSA9IHByb2JsZW1EYXRhLnByb2Nlc3NfbW9kZTtcbiAgfVxuXG4gIC8vIOi0qOmHj+mjjumZqe+8jOWwhuetiee6p0EvQi9D5re75Yqg5Yiw5pqC5a2YXG4gIGlmIChwcm9ibGVtRGF0YS5tb2RlID09PSA4KSB7XG4gICAgZGF0YS5kZWR1Y3Rpb25fbGV2ZWwgPSBwcm9ibGVtRGF0YS5kZWR1Y3Rpb25fbGV2ZWw7XG4gIH1cblxuICBpZiAoIXByb2JsZW1EYXRhLmlkKSB7XG4gICAgZGF0YS5pZCA9IFV0aWxzLnV1aWQoKTtcblxuICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS5pbnNlcnQoZGF0YSlcbiAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkudXBkYXRlKFxuICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgcHJvYmxlbURhdGEuY2Nfc2V0LFxuICAgICAgICAgIHByb2JsZW1EYXRhLnJlcGFpcl9zZXQsXG4gICAgICAgICAgcHJvYmxlbURhdGEucmVpbnNwZWN0X3NldFxuICAgICAgICApO1xuICAgICAgfSlcbiAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShkYXRhLmlkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgJGxvZy5lcnJvcihlcnJvcik7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoZXJyb3IpO1xuICAgICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LnVwZGF0ZShcbiAgICAgIGRhdGEsXG4gICAgICBwcm9ibGVtRGF0YS5jY19zZXQsXG4gICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfc2V0LFxuICAgICAgcHJvYmxlbURhdGEucmVpbnNwZWN0X3NldFxuICAgIClcbiAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShwcm9ibGVtRGF0YS5pZCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICRsb2cuZXJyb3IoZXJyb3IpO1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuICB9XG59O1xuXG52YXIgX2RlbGV0ZSA9IGZ1bmN0aW9uKGlkKSB7XG4gIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS5nZXRDaGVja1Byb2JsZW0oaWQpLnRoZW4oZnVuY3Rpb24ocSkge1xuICAgIGlmIChcbiAgICAgIHEuc3RhdHVzID09PSAn5b6F5o+Q5LqkJyB8fFxuICAgICAgcS5zdGF0dXMgPT09ICfojYnnqL8nIHx8XG4gICAgICBxLnN0YXR1cyA9PT0gJ+WQiOagvOiNieeovycgfHxcbiAgICAgIHEuc3RhdHVzID09PSAn5LiN5ZCI5qC86I2J56i/J1xuICAgICkge1xuICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LmRlbGV0ZShpZCkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgJGxvZy5lcnJvcihlcnJvcik7XG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoZXJyb3IpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRsb2cubG9nKCfpl67popjljZXnirbmgIHlvILluLjvvJonICsgaWQpO1xuICAgICAgcmV0dXJuICRxLnJlamVjdCgn6Zeu6aKY5Y2V54q25oCB5byC5bi4Jyk7XG4gICAgfVxuICB9KTtcbn07XG5cbi8qKlxuICog6I635Y+W6I2J56i/5YiX6KGoXG4gKiBAcGFyYW0gYmF0Y2hJZFxuICogQHJldHVybnMgeyp8cHJvbWlzZX1cbiAqL1xudmFyIF9nZXRDaGVja1Byb2JsZW1EcmFmdExpc3QgPSBmdW5jdGlvbihiYXRjaElkKSB7XG4gIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS5nZXRDaGVja1Byb2JsZW1EcmFmdExpc3QoYmF0Y2hJZCkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAkbG9nLmVycm9yKGVycm9yKTtcbiAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgfSk7XG59O1xuXG4vKipcbiAqIOiOt+WPluW3suaPkOS6pOWIl+ihqFxuICogQHBhcmFtIGJhdGNoSWQg5om55qyhSWRcbiAqIEByZXR1cm5zIHsqfHByb21pc2V8e21ldGhvZCwgaXNBcnJheX19XG4gKi9cbnZhciBfZ2V0Q2hlY2tQcm9ibGVtTGlzdCA9IGZ1bmN0aW9uKGJhdGNoSWQpIHtcbiAgdmFyIHVzZXJJZCA9IGNvbnRleHQuZ2V0VXNlcigpLnVzZXJfaWQ7XG4gIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS5nZXRDaGVja1Byb2JsZW1MaXN0KGJhdGNoSWQsIHVzZXJJZClcbiAgICAudGhlbihmdW5jdGlvbihkYXRhUmVzdWx0KSB7XG4gICAgICBfLm1hcChkYXRhUmVzdWx0LCBmdW5jdGlvbihsKSB7XG4gICAgICAgIF9zZWxmLmdldFByb2JsZW1Mb2NhbFN0YXR1cyh7IHN0YXR1czogbC5zdGF0dXMgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICBsLnN0YXR1c190ZXh0ID0gcmVzdWx0LnN0YXR1c190ZXh0O1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkuZ2V0Q2hlY2tQcm9ibGVtQ291bnQoYmF0Y2hJZCwgdXNlcklkKS50aGVuKGZ1bmN0aW9uKFxuICAgICAgICBkYXRhQ291bnRcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSh7IGRhdGE6IGRhdGFSZXN1bHQsIHRvdGFsOiBkYXRhQ291bnRbJ2NvdW50J10gfSk7XG4gICAgICB9KTtcbiAgICB9KVxuICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgJGxvZy5lcnJvcihlcnJvcik7XG4gICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICB9KTtcbn07XG5cbi8qKlxuICog5a6M5oiQ5pW05pS5XG4gKiBAcGFyYW0gcHJvYmxlbURhdGEg6Zeu6aKY5Y2V5pWw5o2uXG4gKiBAcmV0dXJucyB7cHJvbWlzZX1cbiAqL1xudmFyIF9yZXBhaXIgPSBmdW5jdGlvbihwcm9ibGVtRGF0YSwgbW9kdWxlQ29kZSkge1xuICBpZiAocHJvYmxlbURhdGEuc3RhdHVzICE9PSAn5b6F5pW05pS5Jykge1xuICAgIHJldHVybiAkcS5yZWplY3QoJ+mXrumimOWNleeKtuaAgeW8guW4uCcpO1xuICB9XG5cbiAgLyogaWYoIXByb2JsZW1EYXRhLnJlcGFpcl9pbWFnZV9maWxlIHx8IHByb2JsZW1EYXRhLnJlcGFpcl9pbWFnZV9maWxlLmxlbmd0aCA9PT0gMCl7XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KCfor7fmi43mkYTmlbTmlLnnhafniYcnKTtcbiAgICAgICAgfSAqL1xuICB2YXIgdXNlciA9IGNvbnRleHQuZ2V0VXNlcigpO1xuXG4gIHByb2JsZW1EYXRhLnN0YXR1cyA9ICflvoXlpI3pqownO1xuICBwcm9ibGVtRGF0YS5yZXBhaXJfYnkgPSB1c2VyLnVzZXJfaWQ7XG4gIHByb2JsZW1EYXRhLnJlcGFpcl9kYXRlID0gVXRpbHMuZ2V0Tm93RGF0ZSgpO1xuXG4gIHZhciByZXBhaXJJbWFnZUZpbGUgPSBKU09OLnN0cmluZ2lmeShwcm9ibGVtRGF0YS5yZXBhaXJfaW1hZ2VfZmlsZSk7XG5cbiAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LmdldENoZWNrUHJvYmxlbShwcm9ibGVtRGF0YS5pZClcbiAgICAudGhlbihmdW5jdGlvbihleGlzdHNQcm9ibGVtKSB7XG4gICAgICBpZiAoZXhpc3RzUHJvYmxlbSAmJiBleGlzdHNQcm9ibGVtLnN0YXR1cyAhPT0gJ+W+heaVtOaUuScpIHtcbiAgICAgICAgJGxvZy5sb2coJ+aPkOS6pOaVtOaUueaXtuaVsOaNruW3suWPmOS4uicsIGV4aXN0c1Byb2JsZW0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgICRsb2cubG9nKCfnjrDlnLrmo4Dmn6UtLT7lrozmiJDmlbTmlLknLCBwcm9ibGVtRGF0YSk7XG4gICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkucmVwYWlyUHJvYmxlbShcbiAgICAgICAgcHJvYmxlbURhdGEuaWQsXG4gICAgICAgIHByb2JsZW1EYXRhLnN0YXR1cyxcbiAgICAgICAgcHJvYmxlbURhdGEucmVwYWlyX2J5LFxuICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfcmVtYXJrLFxuICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfZGF0ZSxcbiAgICAgICAgcmVwYWlySW1hZ2VGaWxlXG4gICAgICApXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIC8vIOS/neWtmOmXrumimOeKtuaAgeWPmOWMluaXpeW/l1xuICAgICAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtTG9nUmVwb3NpdG9yeS5zYXZlUHJvYmxlbVN0YXR1c0xvZyhcbiAgICAgICAgICAgIHByb2JsZW1EYXRhLnByb2pfaWQsXG4gICAgICAgICAgICBwcm9ibGVtRGF0YS5iaWRzZWN0aW9uX2lkLFxuICAgICAgICAgICAgcHJvYmxlbURhdGEuYmF0Y2hfaWQsXG4gICAgICAgICAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICAgICAgICAgICflt7LmlbTmlLknLFxuICAgICAgICAgICAgJycsXG4gICAgICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfcmVtYXJrLFxuICAgICAgICAgICAgcmVwYWlySW1hZ2VGaWxlXG4gICAgICAgICAgKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8g5bCG5b2T5YmN5Lq65Yqg5YWl5oqE6YCB5Lq66ZuG5ZCIXG4gICAgICAgICAgcmV0dXJuIF9hcHBlbmRUb0NDKHByb2JsZW1EYXRhLmlkLCAn5pON5L2c5Lq6Jyk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIC8vIOWmguaenOS4uuS4k+mhueW3oeajgO+8jOS4jeWKoOWFpeW+heWKnuihqFxuICAgICAgICAgIGlmIChtb2R1bGVDb2RlICE9PSAnc3BlY2lhbC1pbnNwZWN0LXByb2JsZW0nKSB7XG4gICAgICAgICAgICAvLyDmlbTmlLnkurrlvoXlip7lj5jlt7Llip4s5aaC5p6c5aSN6aqM5Lq65pyJ5pW05pS55Lq6LOS7jeeEtuS4uuW+heWKnlxuICAgICAgICAgICAgdmFyIHR5cGUgPSAyO1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICBfLmZpbHRlcihwcm9ibGVtRGF0YS5yZWluc3BlY3Rfc2V0LCB7XG4gICAgICAgICAgICAgICAgdXNlcl9pZDogcHJvYmxlbURhdGEucmVwYWlyX2J5LFxuICAgICAgICAgICAgICB9KS5sZW5ndGhcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICB0eXBlID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzb3J0ID0gVG9kb1NlcnZpY2UuZ2V0VG9kb1NvcnQoXG4gICAgICAgICAgICAgIHByb2JsZW1EYXRhLnN0YXR1cyxcbiAgICAgICAgICAgICAgcHJvYmxlbURhdGEucmVwYWlyX2RlYWRsaW5lLFxuICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5jbG9zZV9kYXRlLFxuICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfZGF0ZSxcbiAgICAgICAgICAgICAgcHJvYmxlbURhdGEuc2VudF9iYWNrX3RpbWVzLFxuICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5lbWVyZ2VuY3lfZGVncmVlLFxuICAgICAgICAgICAgICAnY2hlY2snXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIFRvZG9TZXJ2aWNlLmluc2VydFRvZG9EYXRhKFxuICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfYnksXG4gICAgICAgICAgICAgIHByb2JsZW1EYXRhLmlkLFxuICAgICAgICAgICAgICAnY2hlY2snLFxuICAgICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgICBzb3J0XG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIERhdGFTeW5jaHJvbml6ZXIuYWRkU3luY0dyb3VwKFtcbiAgICAgICAgICAgIFsnY2hlY2txdWFsaXR5X3Byb2JsZW0nLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICAgICAgICBbJ2NoZWNrcXVhbGl0eV9jYycsIHByb2JsZW1EYXRhLmlkXSxcbiAgICAgICAgICBdKTtcbiAgICAgICAgfSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICRsb2cuZXJyb3IoZXJyb3IpO1xuICAgICAgcmV0dXJuICRxLnJlamVjdChlcnJvcik7XG4gICAgfSk7XG59O1xuXG4vKipcbiAqIOWkjemqjOmAmui/h1xuICogQHBhcmFtIHByb2JsZW1EYXRhIOmXrumimOWNleaVsOaNrlxuICogQHJldHVybnMge3Byb21pc2V9XG4gKi9cbnZhciBfcmVpbnNwZWN0UGFzcyA9IGZ1bmN0aW9uKHByb2JsZW1EYXRhLCBtb2R1bGVDb2RlKSB7XG4gIGlmIChwcm9ibGVtRGF0YS5zdGF0dXMgIT09ICflvoXlpI3pqownKSB7XG4gICAgcmV0dXJuICRxLnJlamVjdCgn6Zeu6aKY5Y2V54q25oCB5byC5bi4Jyk7XG4gIH1cblxuICBwcm9ibGVtRGF0YS5jdXJyZW50UmVpbnNwZWN0QnkgPSBwcm9ibGVtRGF0YS5jdXJyZW50UmVpbnNwZWN0QnkgfHwge307XG5cbiAgdmFyIHVzZXIgPSBjb250ZXh0LmdldFVzZXIoKTtcblxuICB2YXIgcmVpbnNwZWN0SWQgPSAnJztcbiAgdmFyIHJlaW5zcGVjdEltYWdlRmlsZSA9IF8uaXNFbXB0eShwcm9ibGVtRGF0YS5jdXJyZW50UmVpbnNwZWN0QnkucmVpbnNwZWN0X2ltYWdlX2ZpbGUpXG4gICAgPyAnJ1xuICAgIDogSlNPTi5zdHJpbmdpZnkocHJvYmxlbURhdGEuY3VycmVudFJlaW5zcGVjdEJ5LnJlaW5zcGVjdF9pbWFnZV9maWxlKTtcbiAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LmdldENoZWNrUHJvYmxlbShwcm9ibGVtRGF0YS5pZClcbiAgICAudGhlbihmdW5jdGlvbihleGlzdHNQcm9ibGVtKSB7XG4gICAgICBpZiAoZXhpc3RzUHJvYmxlbSAmJiBleGlzdHNQcm9ibGVtLnN0YXR1cyAhPT0gJ+W+heWkjemqjCcpIHtcbiAgICAgICAgLy8gJGxvZy5sb2coJ+aPkOS6pOWkjemqjOaXtuaVsOaNruW3suWPmOS4uicsIGV4aXN0c1Byb2JsZW0pOyAvLyDmiZPljbDnmoTmlbDmja7lpKrlpKfvvIzlrrnmmJPljaHpob9cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyAkbG9nLmxvZygn546w5Zy65qOA5p+lLS0+5aSN6aqM6YCa6L+HJywgcHJvYmxlbURhdGEpOyAvLyDmiZPljbDnmoTmlbDmja7lpKrlpKfvvIzlrrnmmJPljaHpob9cbiAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVpbnNwZWN0UmVwb3NpdG9yeS5yZWluc3BlY3RQYXNzKFxuICAgICAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICAgICAgdXNlci51c2VyX2lkLFxuICAgICAgICBVdGlscy5ub3coKSxcbiAgICAgICAgcmVpbnNwZWN0SW1hZ2VGaWxlLFxuICAgICAgICBwcm9ibGVtRGF0YS5jdXJyZW50UmVpbnNwZWN0QnkucmVpbnNwZWN0X3JlbWFyayB8fCAnJ1xuICAgICAgKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkuZ2V0UmVpbnNwZWN0QnlMaXN0KHByb2JsZW1EYXRhLmlkKS50aGVuKFxuICAgICAgICAgICAgZnVuY3Rpb24obGlzdCkge1xuICAgICAgICAgICAgICB2YXIgYWxsRG9uZSA9IF8uZXZlcnkobGlzdCwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAhIWl0ZW0ucmVpbnNwZWN0X2RhdGU7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIHZhciByZWluc3BlY3QgPSBfLmZpbmQobGlzdCwgeyByZWluc3BlY3Q6IHVzZXIudXNlcl9pZCB9KTtcbiAgICAgICAgICAgICAgaWYgKCFyZWluc3BlY3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KCfpl67popjljZXlpI3pqozkurrlvILluLgnKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJlaW5zcGVjdElkID0gcmVpbnNwZWN0LmlkO1xuXG4gICAgICAgICAgICAgIGlmIChhbGxEb25lKSB7XG4gICAgICAgICAgICAgICAgLy8g5Y+q5pyJ5YWo6YOo5a6M5oiQ5omN5pS55aSn54q25oCBXG4gICAgICAgICAgICAgICAgcHJvYmxlbURhdGEuc3RhdHVzID0gJ+W3sumAmui/hyc7XG4gICAgICAgICAgICAgICAgcHJvYmxlbURhdGEucmVzcGVjdF9ieSA9IHVzZXIudXNlcl9pZDtcbiAgICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5yZWluc3BlY3RfY29tcGxldGVkX2RhdGUgPSBVdGlscy5nZXROb3dEYXRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LnJlaW5zcGVjdFByb2JsZW1QYXNzKFxuICAgICAgICAgICAgICAgICAgcHJvYmxlbURhdGEuaWQsXG4gICAgICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5yZWluc3BlY3RfY29tcGxldGVkX2RhdGUsXG4gICAgICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5yZXNwZWN0X2J5XG4gICAgICAgICAgICAgICAgKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgLy8g5L+d5a2Y6Zeu6aKY54q25oCB5Y+Y5YyW5pel5b+XXG4gICAgICAgICAgICAgICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbUxvZ1JlcG9zaXRvcnkuc2F2ZVByb2JsZW1TdGF0dXNMb2coXG4gICAgICAgICAgICAgICAgICAgIHByb2JsZW1EYXRhLnByb2pfaWQsXG4gICAgICAgICAgICAgICAgICAgIHByb2JsZW1EYXRhLmJpZHNlY3Rpb25faWQsXG4gICAgICAgICAgICAgICAgICAgIHByb2JsZW1EYXRhLmJhdGNoX2lkLFxuICAgICAgICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICAgICAgICAgICAgICAgICAgJ+W3suWkjemqjCcsXG4gICAgICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgICAgJydcbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAvLyDlsIblvZPliY3kurrliqDlhaXmioTpgIHkurrpm4blkIhcbiAgICAgICAgICByZXR1cm4gX2FwcGVuZFRvQ0MocHJvYmxlbURhdGEuaWQsICfmk43kvZzkuronKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8g5aaC5p6c5Li65LiT6aG55beh5qOA77yM5LiN5Yqg5YWl5b6F5Yqe6KGoXG4gICAgICAgICAgaWYgKG1vZHVsZUNvZGUgIT09ICdzcGVjaWFsLWluc3BlY3QtcHJvYmxlbScpIHtcbiAgICAgICAgICAgIC8vIOWkjemqjOmAmui/h+W+heWKni0tPuW3suWKnlxuICAgICAgICAgICAgdmFyIHNvcnQgPSBUb2RvU2VydmljZS5nZXRUb2RvU29ydChcbiAgICAgICAgICAgICAgcHJvYmxlbURhdGEuc3RhdHVzLFxuICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfZGVhZGxpbmUsXG4gICAgICAgICAgICAgIHByb2JsZW1EYXRhLmNsb3NlX2RhdGUsXG4gICAgICAgICAgICAgIHByb2JsZW1EYXRhLnJlcGFpcl9kYXRlLFxuICAgICAgICAgICAgICBwcm9ibGVtRGF0YS5zZW50X2JhY2tfdGltZXMsXG4gICAgICAgICAgICAgIHByb2JsZW1EYXRhLmVtZXJnZW5jeV9kZWdyZWUsXG4gICAgICAgICAgICAgICdjaGVjaydcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gVG9kb1NlcnZpY2UuaW5zZXJ0VG9kb0RhdGEoXG4gICAgICAgICAgICAgIHVzZXIudXNlcl9pZCxcbiAgICAgICAgICAgICAgcHJvYmxlbURhdGEuaWQsXG4gICAgICAgICAgICAgIG1vZHVsZUNvZGUgfHwgJ2NoZWNrJyxcbiAgICAgICAgICAgICAgMixcbiAgICAgICAgICAgICAgc29ydFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBEYXRhU3luY2hyb25pemVyLmFkZFN5bmNHcm91cChbXG4gICAgICAgICAgICBbJ2NoZWNrcXVhbGl0eV9wcm9ibGVtJywgcHJvYmxlbURhdGEuaWRdLFxuICAgICAgICAgICAgWydjaGVja3F1YWxpdHlfcmVpbnNwZWN0X2J5JywgcmVpbnNwZWN0SWRdLFxuICAgICAgICAgICAgWydjaGVja3F1YWxpdHlfY2MnLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICAgICAgXSk7XG4gICAgICAgIH0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAkbG9nLmVycm9yKGVycm9yKTtcbiAgICAgIHJldHVybiAkcS5yZWplY3QoZXJyb3IpO1xuICAgIH0pO1xufTtcblxuLyoqXG4gKiDlpI3pqozpgIDlm55cbiAqIEBwYXJhbSBwcm9ibGVtRGF0YSDpl67popjljZXmlbDmja5cbiAqIEByZXR1cm5zIHtwcm9taXNlfVxuICogQHByaXZhdGVcbiAqL1xudmFyIF9yZWluc3BlY3RSZWplY3QgPSBmdW5jdGlvbihwcm9ibGVtRGF0YSwgbW9kdWxlQ29kZSkge1xuICB2YXIgc3luY1F1ZXVlID0gW1xuICAgIFsnY2hlY2txdWFsaXR5X3Byb2JsZW0nLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgWydjaGVja3F1YWxpdHlfY2MnLCBwcm9ibGVtRGF0YS5pZF0sXG4gIF07XG5cbiAgaWYgKHByb2JsZW1EYXRhLnN0YXR1cyAhPT0gJ+W+heWkjemqjCcpIHtcbiAgICByZXR1cm4gJHEucmVqZWN0KCfpl67popjljZXnirbmgIHlvILluLgnKTtcbiAgfVxuXG4gIGlmICghcHJvYmxlbURhdGEuc2VudF9iYWNrX3JlbWFyaykge1xuICAgIHJldHVybiAkcS5yZWplY3QoJ+ivt+Whq+WGmemAgOWbnuWOn+WboCcpO1xuICB9XG4gIHZhciB1c2VyID0gY29udGV4dC5nZXRVc2VyKCk7XG5cbiAgaWYgKCFwcm9ibGVtRGF0YS5zZW50X2JhY2tfdGltZXMpIHtcbiAgICBwcm9ibGVtRGF0YS5zZW50X2JhY2tfdGltZXMgPSAxO1xuICB9IGVsc2Uge1xuICAgIHByb2JsZW1EYXRhLnNlbnRfYmFja190aW1lcysrO1xuICB9XG5cbiAgcHJvYmxlbURhdGEuc3RhdHVzID0gJ+W+heaVtOaUuSc7XG4gIHByb2JsZW1EYXRhLnNlbnRfYmFja19kYXRlID0gVXRpbHMuZ2V0Tm93RGF0ZSgpO1xuICBwcm9ibGVtRGF0YS5zZW50X2JhY2tfYnkgPSB1c2VyLnVzZXJfaWQ7XG4gIHZhciBzZW50QmFja0ltYWdlRmlsZSA9IEpTT04uc3RyaW5naWZ5KHByb2JsZW1EYXRhLnNlbnRfYmFja19pbWFnZV9maWxlKTtcbiAgJGxvZy5sb2coJ+eOsOWcuuajgOafpS0tPuWkjemqjOmAgOWbnicsIHByb2JsZW1EYXRhKTtcbiAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LnJlaW5zcGVjdFByb2JsZW1SZWplY3QoXG4gICAgcHJvYmxlbURhdGEuaWQsXG4gICAgcHJvYmxlbURhdGEuc3RhdHVzLFxuICAgIHByb2JsZW1EYXRhLnNlbnRfYmFja19kYXRlLFxuICAgIHByb2JsZW1EYXRhLnNlbnRfYmFja19yZW1hcmssXG4gICAgc2VudEJhY2tJbWFnZUZpbGUsXG4gICAgcHJvYmxlbURhdGEuc2VudF9iYWNrX2J5LFxuICAgIHByb2JsZW1EYXRhLnNlbnRfYmFja190aW1lc1xuICApXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAvLyDkv53lrZjpl67popjnirbmgIHlj5jljJbml6Xlv5dcbiAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtTG9nUmVwb3NpdG9yeS5zYXZlUHJvYmxlbVN0YXR1c0xvZyhcbiAgICAgICAgcHJvYmxlbURhdGEucHJval9pZCxcbiAgICAgICAgcHJvYmxlbURhdGEuYmlkc2VjdGlvbl9pZCxcbiAgICAgICAgcHJvYmxlbURhdGEuYmF0Y2hfaWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmlkLFxuICAgICAgICAn5bey6YCA5ZueJyxcbiAgICAgICAgcHJvYmxlbURhdGEuc2VudF9iYWNrX3JlbWFyayxcbiAgICAgICAgJycsXG4gICAgICAgIHNlbnRCYWNrSW1hZ2VGaWxlXG4gICAgICApO1xuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAvLyDmiormiYDmnInlpI3pqozkurrnmoTlpI3pqozmlbDmja7muIXnqbpcbiAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVpbnNwZWN0UmVwb3NpdG9yeS5jbGVhclJlaW5zcGVjdEJ5RGF0YShwcm9ibGVtRGF0YS5pZCk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIC8vIOWwhuW9k+WJjeS6uuWKoOWFpeaKhOmAgeS6uumbhuWQiFxuICAgICAgcmV0dXJuIF9hcHBlbmRUb0NDKHByb2JsZW1EYXRhLmlkLCAn5pON5L2c5Lq6Jyk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIC8vIOWmguaenOS4uuS4k+mhueW3oeajgO+8jOS4jeWKoOWFpeW+heWKnuihqFxuICAgICAgaWYgKG1vZHVsZUNvZGUgIT09ICdzcGVjaWFsLWluc3BlY3QtcHJvYmxlbScpIHtcbiAgICAgICAgLy8g5aSN6aqM6YCA5Zue5b6F5YqeLS0+5bey5YqeXG4gICAgICAgIHZhciB0eXBlID0gMjtcbiAgICAgICAgaWYgKHByb2JsZW1EYXRhLnJlcGFpcl9zZXQuaWQgJiYgcHJvYmxlbURhdGEucmVwYWlyX3NldC5pZCA9PT0gdXNlci51c2VyX2lkKSB7XG4gICAgICAgICAgdHlwZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNvcnQgPSBUb2RvU2VydmljZS5nZXRUb2RvU29ydChcbiAgICAgICAgICBwcm9ibGVtRGF0YS5zdGF0dXMsXG4gICAgICAgICAgcHJvYmxlbURhdGEucmVwYWlyX2RlYWRsaW5lLFxuICAgICAgICAgIHByb2JsZW1EYXRhLmNsb3NlX2RhdGUsXG4gICAgICAgICAgcHJvYmxlbURhdGEucmVwYWlyX2RhdGUsXG4gICAgICAgICAgcHJvYmxlbURhdGEuc2VudF9iYWNrX3RpbWVzLFxuICAgICAgICAgIHByb2JsZW1EYXRhLmVtZXJnZW5jeV9kZWdyZWUsXG4gICAgICAgICAgJ2NoZWNrJ1xuICAgICAgICApO1xuICAgICAgICByZXR1cm4gVG9kb1NlcnZpY2UuaW5zZXJ0VG9kb0RhdGEodXNlci51c2VyX2lkLCBwcm9ibGVtRGF0YS5pZCwgJ2NoZWNrJywgdHlwZSwgc29ydCk7XG4gICAgICB9XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVpbnNwZWN0UmVwb3NpdG9yeS5nZXRSZWluc3BlY3RCeUxpc3QocHJvYmxlbURhdGEuaWQpLnRoZW4oXG4gICAgICAgIGZ1bmN0aW9uKHJlaW5zcGVjdEJ5TGlzdCkge1xuICAgICAgICAgIHN5bmNRdWV1ZS5wdXNoKFsnY2hlY2txdWFsaXR5X3JlaW5zcGVjdF9ieScsIF8ubWFwKHJlaW5zcGVjdEJ5TGlzdCwgJ2lkJyldKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgLy8g6YeN572u5pW05pS55Lq65bey6K+75pyq6K+754q25oCBLOS7peWJjeeahOaXp+aVsOaNruS4jeWkhOeQhlxuICAgICAgaWYgKHByb2JsZW1EYXRhLmhhc19yZWFkID09PSAxKSB7XG4gICAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwYWlyUmVwb3NpdG9yeS51cGRhdGUoXG4gICAgICAgICAgeyBoYXNfcmVhZDogMCB9LFxuICAgICAgICAgIHsgY2hlY2txdWFsaXR5X3Byb2JsZW1faWQ6IHByb2JsZW1EYXRhLmlkIH1cbiAgICAgICAgKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHN5bmNRdWV1ZS5wdXNoKFsnY2hlY2txdWFsaXR5X3JlcGFpcicsIHByb2JsZW1EYXRhLmlkXSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gRGF0YVN5bmNocm9uaXplci5hZGRTeW5jR3JvdXAoc3luY1F1ZXVlKTtcbiAgICB9KVxuICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgJGxvZy5lcnJvcihlcnJvcik7XG4gICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICB9KTtcbn07XG5cbi8qKlxuICog6Z2e5q2j5bi45YWz6ZetXG4gKiBAcGFyYW0gcHJvYmxlbURhdGEg6Zeu6aKY5Y2V5pWw5o2uXG4gKiBAcmV0dXJucyB7cHJvbWlzZX1cbiAqIEBwcml2YXRlXG4gKi9cbnZhciBfY2xvc2UgPSBmdW5jdGlvbihwcm9ibGVtRGF0YSwgbW9kdWxlQ29kZSkge1xuICBpZiAocHJvYmxlbURhdGEuc3RhdHVzICE9PSAn5b6F5pW05pS5Jykge1xuICAgIHJldHVybiAkcS5yZWplY3QoJ+mXrumimOWNleeKtuaAgeW8guW4uCcpO1xuICB9XG5cbiAgaWYgKCFwcm9ibGVtRGF0YS5jbG9zZV9yZWFzb24pIHtcbiAgICByZXR1cm4gJHEucmVqZWN0KCfor7floavlhpnlhbPpl63ljp/lm6AnKTtcbiAgfVxuICB2YXIgdXNlciA9IGNvbnRleHQuZ2V0VXNlcigpO1xuICBwcm9ibGVtRGF0YS5jbG9zZV9kYXRlID0gVXRpbHMuZ2V0Tm93RGF0ZSgpO1xuICBwcm9ibGVtRGF0YS5zdGF0dXMgPSAn5bey5YWz6ZetJztcbiAgJGxvZy5sb2coJ+eOsOWcuuajgOafpS0tPumdnuato+W4uOWFs+mXrScsIHByb2JsZW1EYXRhKTtcbiAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LmNsb3NlUHJvYmxlbShcbiAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICBwcm9ibGVtRGF0YS5zdGF0dXMsXG4gICAgcHJvYmxlbURhdGEuY2xvc2VfZGF0ZSxcbiAgICBwcm9ibGVtRGF0YS5jbG9zZV9yZWFzb25cbiAgKVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgLy8g5L+d5a2Y6Zeu6aKY54q25oCB5Y+Y5YyW5pel5b+XXG4gICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbUxvZ1JlcG9zaXRvcnkuc2F2ZVByb2JsZW1TdGF0dXNMb2coXG4gICAgICAgIHByb2JsZW1EYXRhLnByb2pfaWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmJpZHNlY3Rpb25faWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmJhdGNoX2lkLFxuICAgICAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICAgICAgJ+W3suWFs+mXrScsXG4gICAgICAgIHByb2JsZW1EYXRhLmNsb3NlX3JlYXNvbixcbiAgICAgICAgJycsXG4gICAgICAgICcnXG4gICAgICApO1xuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAvLyDlsIblvZPliY3kurrliqDlhaXmioTpgIHkurrpm4blkIhcbiAgICAgIHJldHVybiBfYXBwZW5kVG9DQyhwcm9ibGVtRGF0YS5pZCwgJ+aTjeS9nOS6uicpO1xuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAvLyDlpoLmnpzkuLrkuJPpobnlt6Hmo4DvvIzkuI3liqDlhaXlvoXlip7ooahcbiAgICAgIGlmIChtb2R1bGVDb2RlICE9PSAnc3BlY2lhbC1pbnNwZWN0LXByb2JsZW0nKSB7XG4gICAgICAgIC8vIOmdnuato+W4uOWFs+mXreW+heWKni0tPuW3suWKnlxuICAgICAgICB2YXIgc29ydCA9IFRvZG9TZXJ2aWNlLmdldFRvZG9Tb3J0KFxuICAgICAgICAgIHByb2JsZW1EYXRhLnN0YXR1cyxcbiAgICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfZGVhZGxpbmUsXG4gICAgICAgICAgcHJvYmxlbURhdGEuY2xvc2VfZGF0ZSxcbiAgICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfZGF0ZSxcbiAgICAgICAgICBwcm9ibGVtRGF0YS5zZW50X2JhY2tfdGltZXMsXG4gICAgICAgICAgcHJvYmxlbURhdGEuZW1lcmdlbmN5X2RlZ3JlZSxcbiAgICAgICAgICAnY2hlY2snXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBUb2RvU2VydmljZS5pbnNlcnRUb2RvRGF0YSh1c2VyLnVzZXJfaWQsIHByb2JsZW1EYXRhLmlkLCAnY2hlY2snLCAyLCBzb3J0KTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERhdGFTeW5jaHJvbml6ZXIuYWRkU3luY0dyb3VwKFtcbiAgICAgICAgWydjaGVja3F1YWxpdHlfcHJvYmxlbScsIHByb2JsZW1EYXRhLmlkXSxcbiAgICAgICAgWydjaGVja3F1YWxpdHlfY2MnLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICBdKTtcbiAgICB9KVxuICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgJGxvZy5lcnJvcihlcnJvcik7XG4gICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICB9KTtcbn07XG5cbi8qKlxuICog5L+u5pS55pW05pS55Lq6XG4gKiBAcGFyYW0gcHJvYmxlbURhdGEg6Zeu6aKY5Y2V5pWw5o2uXG4gKiBAcmV0dXJucyB7cHJvbWlzZX1cbiAqIEBwcml2YXRlXG4gKi9cbnZhciBfY2hhbmdlUmVwYWlyID0gZnVuY3Rpb24ocHJvYmxlbURhdGEsIGlzQ29udHJhY3RvckNoYW5nZSwgbW9kdWxlQ29kZSkge1xuICBpZiAoIXByb2JsZW1EYXRhLnJlcGFpcl9zZXQgfHwgIXByb2JsZW1EYXRhLnJlcGFpcl9zZXQuaWQpIHtcbiAgICByZXR1cm4gJHEucmVqZWN0KCfor7fmjIflrprkuIDkuKrmlbTmlLnkuronKTtcbiAgfVxuICB2YXIgdXNlciA9IGNvbnRleHQuZ2V0VXNlcigpO1xuICAkbG9nLmxvZygn546w5Zy65qOA5p+lLS0+5L+u5pS55pW05pS55Lq6JywgcHJvYmxlbURhdGEpO1xuICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkudXBkYXRlUHJvYmxlbU1vZGlmaWVkQnkocHJvYmxlbURhdGEuaWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgLy8g5aaC5p6c5om/5bu65ZWG5Y+Y5LqG77yM5YiZ6KaB5L+d5a2Y5om/5bu65ZWGXG4gICAgICBpZiAoaXNDb250cmFjdG9yQ2hhbmdlKSB7XG4gICAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS51cGRhdGVQcm9ibGVtQ29udHJhY3RvcihcbiAgICAgICAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICAgICAgICBwcm9ibGVtRGF0YS5jb250cmFjdG9yLmlkXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIGlmIChpc0NvbnRyYWN0b3JDaGFuZ2UpIHtcbiAgICAgICAgdmFyIGNvbnRyYWN0b3JJZCA9IHByb2JsZW1EYXRhLmNvbnRyYWN0b3IgPyBwcm9ibGVtRGF0YS5jb250cmFjdG9yLmlkIHx8ICcnIDogJyc7XG4gICAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS51cGRhdGVQcm9ibGVtQ29udHJhY3Rvcihwcm9ibGVtRGF0YS5pZCwgY29udHJhY3RvcklkKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgLy8gcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBhaXJSZXBvc2l0b3J5LmNoYW5nZVByb2JsZW1SZXBhaXIocHJvYmxlbURhdGEuaWQsIHByb2JsZW1EYXRhLnJlcGFpcl9zZXQpO1xuICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBhaXJSZXBvc2l0b3J5LmNoYW5nZVByb2JsZW1SZXBhaXJlcihwcm9ibGVtRGF0YSk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtRnBJbmZvUmVwb3NpdG9yeS5zYXZlUHJvYmxlbUZwSW5mbyhcbiAgICAgICAgcHJvYmxlbURhdGEucHJval9pZCxcbiAgICAgICAgcHJvYmxlbURhdGEuYmlkc2VjdGlvbl9pZCxcbiAgICAgICAgcHJvYmxlbURhdGEuYmF0Y2hfaWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmlkLFxuICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfc2V0LmlkLFxuICAgICAgICBwcm9ibGVtRGF0YS5yZXBhaXJfc2V0X29sZC5pZCxcbiAgICAgICAgJ+WIhumFjeaVtOaUueS6uidcbiAgICAgICk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIC8vIOWwhuW9k+WJjeS6uuWKoOWFpeaKhOmAgeS6uumbhuWQiFxuICAgICAgcmV0dXJuIF9hcHBlbmRUb0NDKHByb2JsZW1EYXRhLmlkLCAn5pON5L2c5Lq6Jyk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIC8vIOWmguaenOS4uuS4k+mhueW3oeajgO+8jOS4jeWKoOWFpeW+heWKnuihqFxuICAgICAgaWYgKG1vZHVsZUNvZGUgIT09ICdzcGVjaWFsLWluc3BlY3QtcHJvYmxlbScpIHtcbiAgICAgICAgLy8g5L+u5pS55pW05pS55Lq65b6F5YqeLS0+5bey5YqeXG4gICAgICAgIHZhciB0eXBlID0gMjtcbiAgICAgICAgaWYgKHByb2JsZW1EYXRhLnJlcGFpcl9zZXQuaWQgJiYgcHJvYmxlbURhdGEucmVwYWlyX3NldC5pZCA9PT0gdXNlci51c2VyX2lkKSB7XG4gICAgICAgICAgdHlwZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNvcnQgPSBUb2RvU2VydmljZS5nZXRUb2RvU29ydChcbiAgICAgICAgICBwcm9ibGVtRGF0YS5zdGF0dXMsXG4gICAgICAgICAgcHJvYmxlbURhdGEucmVwYWlyX2RlYWRsaW5lLFxuICAgICAgICAgIHByb2JsZW1EYXRhLmNsb3NlX2RhdGUsXG4gICAgICAgICAgcHJvYmxlbURhdGEucmVwYWlyX2RhdGUsXG4gICAgICAgICAgcHJvYmxlbURhdGEuc2VudF9iYWNrX3RpbWVzLFxuICAgICAgICAgIHByb2JsZW1EYXRhLmVtZXJnZW5jeV9kZWdyZWUsXG4gICAgICAgICAgJ2NoZWNrJ1xuICAgICAgICApO1xuICAgICAgICByZXR1cm4gVG9kb1NlcnZpY2UuaW5zZXJ0VG9kb0RhdGEodXNlci51c2VyX2lkLCBwcm9ibGVtRGF0YS5pZCwgJ2NoZWNrJywgdHlwZSwgc29ydCk7XG4gICAgICB9XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBEYXRhU3luY2hyb25pemVyLmFkZFN5bmNHcm91cChbXG4gICAgICAgIFsnY2hlY2txdWFsaXR5X3Byb2JsZW0nLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICAgIFsnY2hlY2txdWFsaXR5X3JlcGFpcicsIHByb2JsZW1EYXRhLmlkXSxcbiAgICAgICAgWydjaGVja3F1YWxpdHlfY2MnLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICAgIFsnY2hlY2txdWFsaXR5X3Byb2JsZW1fZnBpbmZvJywgcHJvYmxlbURhdGEuaWRdLFxuICAgICAgXSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICRsb2cuZXJyb3IoZXJyb3IpO1xuICAgICAgcmV0dXJuICRxLnJlamVjdChlcnJvcik7XG4gICAgfSk7XG59O1xuXG4vKipcbiAqIOS/ruaUueWkjemqjOS6ulxuICogQHBhcmFtIHByb2JsZW1EYXRhIOmXrumimOWNleaVsOaNrlxuICogQHJldHVybnMge3Byb21pc2V9XG4gKiBAcHJpdmF0ZVxuICovXG52YXIgX2NoYW5nZVJlaW5zcGVjdCA9IGZ1bmN0aW9uKHByb2JsZW1EYXRhLCBtb2R1bGVDb2RlKSB7XG4gIGlmIChfLmlzRW1wdHkocHJvYmxlbURhdGEucmVpbnNwZWN0X3NldCkpIHtcbiAgICByZXR1cm4gJHEucmVqZWN0KCfor7fmjIflrprkuIDkuKrlpI3pqozkuronKTtcbiAgfVxuICB2YXIgdXNlciA9IGNvbnRleHQuZ2V0VXNlcigpO1xuICAkbG9nLmxvZygn546w5Zy65qOA5p+lLS0+5L+u5pS55aSN6aqM5Lq6JywgcHJvYmxlbURhdGEpO1xuICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkudXBkYXRlUHJvYmxlbU1vZGlmaWVkQnkocHJvYmxlbURhdGEuaWQpXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkuY2hhbmdlUHJvYmxlbVJlaW5zcGVjdChcbiAgICAgICAgcHJvYmxlbURhdGEuaWQsXG4gICAgICAgIHByb2JsZW1EYXRhLnJlaW5zcGVjdF9zZXQsXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgfSlcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHZhciByZWluc3BlY3RJZHMgPSBfLm1hcChwcm9ibGVtRGF0YS5yZWluc3BlY3Rfc2V0LCBmdW5jdGlvbihyZWluc3BlY3QpIHtcbiAgICAgICAgcmV0dXJuIHJlaW5zcGVjdC5pZDtcbiAgICAgIH0pLmpvaW4oJywnKTtcbiAgICAgIHZhciByZWluc3BlY3RJZHNPbGQgPSBfLm1hcChwcm9ibGVtRGF0YS5yZWluc3BlY3Rfc2V0X29sZCwgZnVuY3Rpb24ocmVpbnNwZWN0KSB7XG4gICAgICAgIHJldHVybiByZWluc3BlY3QuaWQ7XG4gICAgICB9KS5qb2luKCcsJyk7XG4gICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbUZwSW5mb1JlcG9zaXRvcnkuc2F2ZVByb2JsZW1GcEluZm8oXG4gICAgICAgIHByb2JsZW1EYXRhLnByb2pfaWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmJpZHNlY3Rpb25faWQsXG4gICAgICAgIHByb2JsZW1EYXRhLmJhdGNoX2lkLFxuICAgICAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICAgICAgcmVpbnNwZWN0SWRzLFxuICAgICAgICByZWluc3BlY3RJZHNPbGQsXG4gICAgICAgICfliIbphY3lpI3pqozkuronXG4gICAgICApO1xuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAvLyDlsIblvZPliY3kurrliqDlhaXmioTpgIHkurrpm4blkIhcbiAgICAgIHJldHVybiBfYXBwZW5kVG9DQyhwcm9ibGVtRGF0YS5pZCwgJ+aTjeS9nOS6uicpO1xuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAvLyDlpoLmnpzkuLrkuJPpobnlt6Hmo4DvvIzkuI3liqDlhaXlvoXlip7ooahcbiAgICAgIGlmIChtb2R1bGVDb2RlICE9PSAnc3BlY2lhbC1pbnNwZWN0LXByb2JsZW0nKSB7XG4gICAgICAgIC8vIOS/ruaUueWkjemqjOS6uuW+heWKni0tPuW3suWKnlxuICAgICAgICB2YXIgdHlwZSA9IDI7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBfLmZpbHRlcihwcm9ibGVtRGF0YS5yZWluc3BlY3Rfc2V0LCB7IHVzZXJfaWQ6IHVzZXIudXNlcl9pZCB9KS5sZW5ndGggJiZcbiAgICAgICAgICBwcm9ibGVtRGF0YS5zdGF0dXMgPT09ICflvoXlpI3pqownXG4gICAgICAgICkge1xuICAgICAgICAgIHR5cGUgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzb3J0ID0gVG9kb1NlcnZpY2UuZ2V0VG9kb1NvcnQoXG4gICAgICAgICAgcHJvYmxlbURhdGEuc3RhdHVzLFxuICAgICAgICAgIHByb2JsZW1EYXRhLnJlcGFpcl9kZWFkbGluZSxcbiAgICAgICAgICBwcm9ibGVtRGF0YS5jbG9zZV9kYXRlLFxuICAgICAgICAgIHByb2JsZW1EYXRhLnJlcGFpcl9kYXRlLFxuICAgICAgICAgIHByb2JsZW1EYXRhLnNlbnRfYmFja190aW1lcyxcbiAgICAgICAgICBwcm9ibGVtRGF0YS5lbWVyZ2VuY3lfZGVncmVlLFxuICAgICAgICAgICdjaGVjaydcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIFRvZG9TZXJ2aWNlLmluc2VydFRvZG9EYXRhKHVzZXIudXNlcl9pZCwgcHJvYmxlbURhdGEuaWQsICdjaGVjaycsIHR5cGUsIHNvcnQpO1xuICAgICAgfVxuICAgIH0pXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkuZ2V0UmVpbnNwZWN0QnlMaXN0KHByb2JsZW1EYXRhLmlkKTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKHJlaW5zcGVjdEJ5TGlzdCkge1xuICAgICAgcmV0dXJuIERhdGFTeW5jaHJvbml6ZXIuYWRkU3luY0dyb3VwKFtcbiAgICAgICAgWydjaGVja3F1YWxpdHlfcHJvYmxlbScsIHByb2JsZW1EYXRhLmlkXSxcbiAgICAgICAgWydjaGVja3F1YWxpdHlfcmVpbnNwZWN0JywgcHJvYmxlbURhdGEuaWRdLFxuICAgICAgICBbJ2NoZWNrcXVhbGl0eV9yZWluc3BlY3RfYnknLCBfLm1hcChyZWluc3BlY3RCeUxpc3QsICdpZCcpXSxcbiAgICAgICAgWydjaGVja3F1YWxpdHlfY2MnLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICAgIFsnY2hlY2txdWFsaXR5X3Byb2JsZW1fZnBpbmZvJywgcHJvYmxlbURhdGEuaWRdLFxuICAgICAgXSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICRsb2cuZXJyb3IoZXJyb3IpO1xuICAgICAgcmV0dXJuICRxLnJlamVjdChlcnJvcik7XG4gICAgfSk7XG59O1xuXG4vKipcbiAqIOS/ruaUueaKhOmAgeS6ulxuICogQHBhcmFtIHByb2JsZW1EYXRhIOmXrumimOWNleaVsOaNrlxuICogQHJldHVybnMge3Byb21pc2V9XG4gKiBAcHJpdmF0ZVxuICovXG52YXIgX2NoYW5nZUNDID0gZnVuY3Rpb24ocHJvYmxlbURhdGEpIHtcbiAgJGxvZy5sb2coJ+eOsOWcuuajgOafpS0tPuS/ruaUueaKhOmAgeS6uicsIHByb2JsZW1EYXRhKTtcbiAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LnVwZGF0ZVByb2JsZW1Nb2RpZmllZEJ5KHByb2JsZW1EYXRhLmlkKVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1DQ1JlcG9zaXRvcnkuc2F2ZVByb2JsZW1DQyhwcm9ibGVtRGF0YS5pZCwgcHJvYmxlbURhdGEuY2Nfc2V0KTtcbiAgICB9KVxuICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERhdGFTeW5jaHJvbml6ZXIuYWRkU3luY0dyb3VwKFtcbiAgICAgICAgWydjaGVja3F1YWxpdHlfcHJvYmxlbScsIHByb2JsZW1EYXRhLmlkXSxcbiAgICAgICAgWydjaGVja3F1YWxpdHlfY2MnLCBwcm9ibGVtRGF0YS5pZF0sXG4gICAgICBdKTtcbiAgICB9KVxuICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgJGxvZy5lcnJvcihlcnJvcik7XG4gICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICB9KTtcbn07XG5cbi8qKlxuICog5L+u5pS56LSj5Lu75Y2V5L2NXG4gKiBAcGFyYW0gcHJvYmxlbURhdGEg6Zeu6aKY5Y2V5pWw5o2uXG4gKiBAcmV0dXJucyB7cHJvbWlzZX1cbiAqIEBwcml2YXRlXG4gKi9cbnZhciBfY2hhbmdlQ29udHJhY3RvciA9IGZ1bmN0aW9uKHByb2JsZW1EYXRhKSB7XG4gIGlmICghcHJvYmxlbURhdGEuY29udHJhY3RvciB8fCAhcHJvYmxlbURhdGEuY29udHJhY3Rvci5pZCkge1xuICAgIHJldHVybiAkcS5yZWplY3QoJ+ivt+aMh+Wumui0o+S7u+WNleS9jScpO1xuICB9XG4gICRsb2cubG9nKCfnjrDlnLrmo4Dmn6UtLT7kv67mlLnotKPku7vljZXkvY0nLCBwcm9ibGVtRGF0YSk7XG4gIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS51cGRhdGVQcm9ibGVtQ29udHJhY3RvcihcbiAgICBwcm9ibGVtRGF0YS5pZCxcbiAgICBwcm9ibGVtRGF0YS5jb250cmFjdG9yLmlkXG4gIClcbiAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBEYXRhU3luY2hyb25pemVyLmFkZFN5bmNHcm91cChbWydjaGVja3F1YWxpdHlfcHJvYmxlbScsIHByb2JsZW1EYXRhLmlkXV0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAkbG9nLmVycm9yKGVycm9yKTtcbiAgICAgIHJldHVybiAkcS5yZWplY3QoZXJyb3IpO1xuICAgIH0pO1xufTtcblxuLyoqXG4gKiDkv67mlLnmlbTmlLnmnJ/pmZBcbiAqIEBwYXJhbSBwcm9ibGVtRGF0YSDpl67popjljZXmlbDmja5cbiAqIEByZXR1cm5zIHtwcm9taXNlfVxuICogQHByaXZhdGVcbiAqL1xudmFyIF9jaGFuZ2VSZXBhaXJEZWFkbGluZSA9IGZ1bmN0aW9uKHByb2JsZW1EYXRhKSB7XG4gIHZhciByID0gL14oXFxkKyktKFxcZHsxLDJ9KS0oXFxkezEsMn0pJC87IC8vIHl5eXktTU0tZGRcbiAgaWYgKCFyLnRlc3QocHJvYmxlbURhdGEucmVwYWlyX2RlYWRsaW5lKSkge1xuICAgIHJldHVybiAkcS5yZWplY3QoJ+aVtOaUueacn+mZkOmcgOimgeS4gOS4quaXpeacn+agvOW8j+eahOWAvCcpO1xuICB9XG5cbiAgdmFyIHJlcGFpckRlYWRsaW5lID0gbW9tZW50KHByb2JsZW1EYXRhLnJlcGFpcl9kZWFkbGluZSkuZm9ybWF0KCdZWVlZLU1NLUREJyk7XG4gIHZhciB0b2RheSA9IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCcpO1xuXG4gIHByb2JsZW1EYXRhLmlzX3RpbWVvdXQgPSByZXBhaXJEZWFkbGluZSA8IHRvZGF5O1xuICAkbG9nLmxvZygn546w5Zy65qOA5p+lLS0+5L+u5pS55pW05pS55pyf6ZmQJywgcHJvYmxlbURhdGEpO1xuICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkudXBkYXRlUHJvYmxlbVJlcGFpckRlYWRsaW5lKFxuICAgIHByb2JsZW1EYXRhLmlkLFxuICAgIHByb2JsZW1EYXRhLnJlcGFpcl9kZWFkbGluZVxuICApXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gRGF0YVN5bmNocm9uaXplci5hZGRTeW5jR3JvdXAoW1snY2hlY2txdWFsaXR5X3Byb2JsZW0nLCBwcm9ibGVtRGF0YS5pZF1dKTtcbiAgICB9KVxuICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgJGxvZy5lcnJvcihlcnJvcik7XG4gICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICB9KTtcbn07XG5cbi8qKlxuICog5bCG5b2T5YmN5Lq65re75Yqg6Iez5oqE6YCB5Lq66ZuG5ZCIXG4gKiBAcGFyYW0gaWQg6Zeu6aKYSWRcbiAqIEBwYXJhbSB0eXBlIOaKhOmAgeexu+Wei++8iOiiq+aKhOmAgXznmbvorrDkurp85pON5L2c5Lq677yJXG4gKiBAcHJpdmF0ZVxuICovXG52YXIgX2FwcGVuZFRvQ0MgPSBmdW5jdGlvbihpZCwgdHlwZSkge1xuICB2YXIgdXNlciA9IGNvbnRleHQuZ2V0VXNlcigpO1xuXG4gIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtQ0NSZXBvc2l0b3J5LmdldFByb2JsZW1DQ0FsbENvbHVtbihpZCkudGhlbihmdW5jdGlvbihjY0xpc3QpIHtcbiAgICAvLyDlsIblvZPliY3kurrliqDlhaXmioTpgIHkurrpm4blkIhcbiAgICAvLyDlpoLmnpzmioTpgIHkurrpm4blkIjlt7Lnu4/ljIXlkKvpl67popjnmoTnmbvorrDkurrvvIzliJnkuI3lho3ph43lpI3mt7vliqBcbiAgICBpZiAoXG4gICAgICBfLnNvbWUoY2NMaXN0LCBmdW5jdGlvbihjYykge1xuICAgICAgICByZXR1cm4gY2MuY2MgPT09IHVzZXIudXNlcl9pZCAmJiBjYy50eXBlID09PSB0eXBlO1xuICAgICAgfSlcbiAgICApIHtcbiAgICAgIC8vIOaKhOmAgeS6uuW3sue7j+WtmOWcqO+8jOS7heabtOaWsOmYheivu+aXtumXtFxuICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1DQ1JlcG9zaXRvcnkudXBkYXRlUHJvYmxlbVJlYWRpbmdUaW1lKGlkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGNjID0ge1xuICAgICAgICBpZDogdXNlci51c2VyX2lkLFxuICAgICAgICBuYW1lOiB1c2VyLnVzZXJfbmFtZSxcbiAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgcmVhZGluZ190aW1lOiBVdGlscy5nZXROb3dEYXRlKCksXG4gICAgICB9O1xuICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1DQ1JlcG9zaXRvcnkuYXBwZW5kQ0MoaWQsIGNjKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbUNDUmVwb3NpdG9yeS51cGRhdGVQcm9ibGVtUmVhZGluZ1RpbWUoaWQpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn07XG5cbi8qKlxuICog6I635Y+W6Zeu6aKY5Y2V5Zyo5pys5Zyw55qE54q25oCB77yI5Y+v6IO95Lya5a2Y5Zyo5pyq5LiK5Lyg55qE5oOF5Ya177yJXG4gKiBAcGFyYW0gcHJvYmxlbSDpl67popjljZXlr7nosaEge3N0YXR1cywgcmVpbnNwZWN0X2J5LCByZXBhaXJfc2V0X2lkLCByZWluc3BlY3Rfc2V0X2lkfVxuICogQHByaXZhdGVcbiAqL1xudmFyIF9nZXRQcm9ibGVtTG9jYWxTdGF0dXMgPSBmdW5jdGlvbihwcm9ibGVtKSB7XG4gIHZhciBzdGF0dXNUZXh0ID0gcHJvYmxlbS5zdGF0dXM7XG4gIGlmIChwcm9ibGVtLnN0YXR1cyA9PT0gJ+W3suWFs+mXrScpIHtcbiAgICBzdGF0dXNUZXh0ID0gJ+mdnuato+W4uOWFs+mXrSc7XG4gIH1cblxuICByZXR1cm4gJHEucmVzb2x2ZSh7IHN0YXR1c190ZXh0OiBzdGF0dXNUZXh0IH0pO1xufTtcblxuLyoqXG4gKiDojrflj5bpl67popjljZXlnKjmnKzlnLDnmoTnirbmgIHvvIjlj6/og73kvJrlrZjlnKjmnKrkuIrkvKDnmoTmg4XlhrXvvIlcbiAqIEBwYXJhbSBpZCDpl67popjljZVJZFxuICogQHByaXZhdGVcbiAqL1xudmFyIF9nZXRQcm9ibGVtTG9jYWxTdGF0dXNCeUlkID0gZnVuY3Rpb24oaWQpIHtcbiAgcmV0dXJuIF9nZXRQcm9ibGVtTG9jYWxTdGF0dXMoeyBzdGF0dXM6IHAuc3RhdHVzIH0pO1xufTtcblxuLyoqXG4gKiDnlKjkuo7mmoLlrZjmlbTmlLnkurrkuLTml7bnvJbovpHnmoTkv6Hmga9cbiAqIEBwYXJhbSBwcm9ibGVtSWQg6Zeu6aKYSWRcbiAqIEBwYXJhbSByZXBhaXJSZW1hcmsg5pW05pS56KGl5YWF6K+05piOXG4gKiBAcGFyYW0gcmVwYWlySW1hZ2VGaWxlIOaVtOaUueWbvueJh1xuICogQHByaXZhdGVcbiAqL1xudmFyIF9zYXZlUmVwYWlySW5mbyA9IGZ1bmN0aW9uKHByb2JsZW1JZCwgcmVwYWlyUmVtYXJrLCByZXBhaXJJbWFnZUZpbGUpIHtcbiAgcmVwYWlySW1hZ2VGaWxlID0gSlNPTi5zdHJpbmdpZnkocmVwYWlySW1hZ2VGaWxlKTtcbiAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LnNhdmVSZXBhaXJJbmZvKFxuICAgIHByb2JsZW1JZCxcbiAgICByZXBhaXJSZW1hcmssXG4gICAgcmVwYWlySW1hZ2VGaWxlXG4gICkudGhlbihmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkuZ2V0Q2hlY2tQcm9ibGVtRHJhZnQocHJvYmxlbUlkKS50aGVuKGZ1bmN0aW9uKHApIHtcbiAgICAgIHJldHVybiBUb2RvTGlzdFNlcnZpY2UuYmFja1VwRHJhZnQocHJvYmxlbUlkLCBwLnByb2pfaWQsICdjaGVja3F1YWxpdHlfcHJvYmxlbScsIHApO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbi8qKlxuICog5pyN5Yqh5YWs5byA55qE5a+56LGhXFzmlrnms5VcbiAqL1xuX3NlbGYgPSB7XG4gIC8qKlxuICAgKiDojrflj5bojYnnqL/liJfooahcbiAgICovXG4gIGdldENoZWNrUHJvYmxlbURyYWZ0TGlzdDogX2dldENoZWNrUHJvYmxlbURyYWZ0TGlzdCxcbiAgLyoqXG4gICAqIOiOt+WPluW3suaPkOS6pOWIl+ihqFxuICAgKi9cbiAgZ2V0Q2hlY2tQcm9ibGVtTGlzdDogX2dldENoZWNrUHJvYmxlbUxpc3QsXG4gIC8qKlxuICAgKiDmoLnmja5JZOi/lOWbnumXrumimOWvueixoVxuICAgKi9cbiAgZ2V0Q2hlY2tQcm9ibGVtSW5mbzogX2dldENoZWNrUHJvYmxlbUluZm8sXG4gIC8qKlxuICAgKiDmj5DkuqTpl67popjljZVcbiAgICovXG4gIHN1Ym1pdDogX3N1Ym1pdCxcbiAgLyoqXG4gICAqIOS/neWtmOiNieeov1xuICAgKi9cbiAgc2F2ZTogX3NhdmUsXG4gIC8qKlxuICAgKiDliKDpmaTojYnnqL9cbiAgICovXG4gIGRlbGV0ZTogX2RlbGV0ZSxcbiAgLyoqXG4gICAqIOWujOaIkOaVtOaUuVxuICAgKi9cbiAgcmVwYWlyOiBfcmVwYWlyLFxuICAvKipcbiAgICog5aSN6aqM6YCa6L+HXG4gICAqL1xuICByZWluc3BlY3RQYXNzOiBfcmVpbnNwZWN0UGFzcyxcbiAgLyoqXG4gICAqIOWkjemqjOmAgOWbnlxuICAgKi9cbiAgcmVpbnNwZWN0UmVqZWN0OiBfcmVpbnNwZWN0UmVqZWN0LFxuICAvKipcbiAgICog6Z2e5q2j5bi45YWz6ZetXG4gICAqL1xuICBjbG9zZTogX2Nsb3NlLFxuICAvKipcbiAgICog5L+u5pS55pW05pS55Lq6XG4gICAqL1xuICBjaGFuZ2VSZXBhaXI6IF9jaGFuZ2VSZXBhaXIsXG4gIC8qKlxuICAgKiDkv67mlLnlpI3pqozkurpcbiAgICovXG4gIGNoYW5nZVJlaW5zcGVjdDogX2NoYW5nZVJlaW5zcGVjdCxcbiAgLyoqXG4gICAqIOS/ruaUueaKhOmAgeS6ulxuICAgKi9cbiAgY2hhbmdlQ0M6IF9jaGFuZ2VDQyxcbiAgLyoqXG4gICAqIOS/ruaUueaJv+W7uuWVhlxuICAgKi9cbiAgY2hhbmdlQ29udHJhY3RvcjogX2NoYW5nZUNvbnRyYWN0b3IsXG4gIC8qKlxuICAgKiDkv67mlLnmlbTmlLnmnJ/pmZBcbiAgICovXG4gIGNoYW5nZVJlcGFpckRlYWRsaW5lOiBfY2hhbmdlUmVwYWlyRGVhZGxpbmUsXG4gIC8qKlxuICAgKiDojrflj5bpl67popjljZXlnKjmnKzlnLDnmoTnirbmgIHvvIjlj6/og73kvJrlrZjlnKjmnKrkuIrkvKDnmoTmg4XlhrXvvIlcbiAgICovXG4gIGdldFByb2JsZW1Mb2NhbFN0YXR1c0J5SWQ6IF9nZXRQcm9ibGVtTG9jYWxTdGF0dXNCeUlkLFxuICAvKipcbiAgICog6I635Y+W6Zeu6aKY5Y2V5Zyo5pys5Zyw55qE54q25oCB77yI5Y+v6IO95Lya5a2Y5Zyo5pyq5LiK5Lyg55qE5oOF5Ya177yJ77yM5Lyg6YCS6Zeu6aKY5Y2V5a+56LGh77yM5oCn6IO96L6D5b+rXG4gICAqL1xuICBnZXRQcm9ibGVtTG9jYWxTdGF0dXM6IF9nZXRQcm9ibGVtTG9jYWxTdGF0dXMsXG4gIC8qKlxuICAgKiDnlKjkuo7kv53lrZjmlbTmlLnkurrkuLTml7bnvJbovpHnmoTkv6Hmga9cbiAgICovXG4gIHNhdmVSZXBhaXJJbmZvOiBfc2F2ZVJlcGFpckluZm8sXG5cbiAgcHJvYmxlbVJlYWQ6IGZ1bmN0aW9uKHByb2JsZW1JZCkge1xuICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwYWlyUmVwb3NpdG9yeS51cGRhdGUoXG4gICAgICB7IGhhc19yZWFkOiAxIH0sXG4gICAgICB7IGNoZWNrcXVhbGl0eV9wcm9ibGVtX2lkOiBwcm9ibGVtSWQgfVxuICAgICkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBEYXRhU3luY2hyb25pemVyLmFkZFN5bmNHcm91cChbXG4gICAgICAgIFsnY2hlY2txdWFsaXR5X3Byb2JsZW0nLCBwcm9ibGVtSWRdLFxuICAgICAgICBbJ2NoZWNrcXVhbGl0eV9yZXBhaXInLCBwcm9ibGVtSWRdLFxuICAgICAgXSk7XG4gICAgfSk7XG4gIH0sXG4gIC8qKlxuICAgKiDmi43nhaflubbkv53lrZjojYnnqL9cbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICB0YWtlUGljdHVyZUFuZFNhdmU6IGZ1bmN0aW9uKGJhdGNoSWQpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHt9O1xuICAgIG9wdGlvbnMuc2hvb3RWaWRlbyA9IHRydWU7XG5cbiAgICByZXR1cm4gSW1hZ2VTZXJ2aWNlLnRha2VQaWN0dXJlKG9wdGlvbnMpXG4gICAgICAudGhlbihmdW5jdGlvbihpbWFnZSkge1xuICAgICAgICBpZiAoaW1hZ2UpIHtcbiAgICAgICAgICByZXR1cm4gQmF0Y2hTZXJ2aWNlLmdldEJhdGNoKGJhdGNoSWQpLnRoZW4oZnVuY3Rpb24oYmF0Y2gpIHtcbiAgICAgICAgICAgIHZhciBwcm9ibGVtID0ge1xuICAgICAgICAgICAgICBwcm9qX2lkOiBiYXRjaC5wcm9qX2lkLFxuICAgICAgICAgICAgICBiaWRzZWN0aW9uX2lkOiBiYXRjaC5iaWRzZWN0aW9uX2lkLFxuICAgICAgICAgICAgICBiYXRjaF9pZDogYmF0Y2guaWQsXG4gICAgICAgICAgICAgIGRlYWRsaW5lOiBiYXRjaC5yZXBhaXJfZGVhZGxpbmUsXG4gICAgICAgICAgICAgIGJhdGNoX3R5cGU6IGJhdGNoLmJhdGNoX3R5cGUsXG4gICAgICAgICAgICAgIGNyZWF0ZWRfYnk6IGNvbnRleHQuZ2V0VXNlcigpLnVzZXJfaWQsXG4gICAgICAgICAgICAgIGNyZWF0ZWRfb246IFV0aWxzLm5vdygpLFxuICAgICAgICAgICAgICBpbWFnZV9maWxlOiBbaW1hZ2VdLFxuICAgICAgICAgICAgICBzdGF0dXM6ICflvoXmj5DkuqQnLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBfc2VsZi5zYXZlKHByb2JsZW0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICRsb2cuZXJyb3IoZXJyb3IpO1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiDmoLnmja7nhafniYfkv53lrZjojYnnqL9cbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICBzYXZlQnlQaWN0dXJlOiBmdW5jdGlvbihwYXRoLCBiYXRjaElkKSB7XG4gICAgaWYgKCFwYXRoKSB7XG4gICAgICByZXR1cm4gJHEud2hlbigpO1xuICAgIH1cbiAgICByZXR1cm4gQmF0Y2hTZXJ2aWNlLmdldEJhdGNoKGJhdGNoSWQpXG4gICAgICAudGhlbihmdW5jdGlvbihiYXRjaCkge1xuICAgICAgICB2YXIgcHJvYmxlbSA9IHtcbiAgICAgICAgICBwcm9qX2lkOiBiYXRjaC5wcm9qX2lkLFxuICAgICAgICAgIGJpZHNlY3Rpb25faWQ6IGJhdGNoLmJpZHNlY3Rpb25faWQsXG4gICAgICAgICAgYmF0Y2hfaWQ6IGJhdGNoLmlkLFxuICAgICAgICAgIGRlYWRsaW5lOiBiYXRjaC5yZXBhaXJfZGVhZGxpbmUsXG4gICAgICAgICAgYmF0Y2hfdHlwZTogYmF0Y2guYmF0Y2hfdHlwZSxcbiAgICAgICAgICBjcmVhdGVkX2J5OiBjb250ZXh0LmdldFVzZXIoKS51c2VyX2lkLFxuICAgICAgICAgIGNyZWF0ZWRfb246IFV0aWxzLm5vdygpLFxuICAgICAgICAgIGltYWdlX2ZpbGU6IFt7IHRlbXA6IHBhdGggfV0sXG4gICAgICAgICAgc3RhdHVzOiAn5b6F5o+Q5LqkJyxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9zZWxmLnNhdmUocHJvYmxlbSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICRsb2cuZXJyb3IoZXJyb3IpO1xuICAgICAgICByZXR1cm4gJHEucmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuICB9LFxuXG4gIGNyZWF0ZVByb2JsZW06IGZ1bmN0aW9uKHBpY3R1cmVQYXRoLCBiYXRjaElkKSB7XG4gICAgcmV0dXJuIEJhdGNoU2VydmljZS5nZXRCYXRjaChiYXRjaElkKS50aGVuKGZ1bmN0aW9uKGJhdGNoKSB7XG4gICAgICB2YXIgcHJvYmxlbSA9IHtcbiAgICAgICAgcHJval9pZDogYmF0Y2gucHJval9pZCxcbiAgICAgICAgYmlkc2VjdGlvbl9pZDogYmF0Y2guYmlkc2VjdGlvbl9pZCxcbiAgICAgICAgYmF0Y2hfaWQ6IGJhdGNoLmlkLFxuICAgICAgICBkZWFkbGluZTogYmF0Y2gucmVwYWlyX2RlYWRsaW5lLFxuICAgICAgICBiYXRjaF90eXBlOiBiYXRjaC5iYXRjaF90eXBlLFxuICAgICAgICBjcmVhdGVkX2J5OiBjb250ZXh0LmdldFVzZXIoKS51c2VyX2lkLFxuICAgICAgICBjcmVhdGVkX29uOiBVdGlscy5ub3coKSxcbiAgICAgICAgaW1hZ2VfZmlsZTogW3sgdGVtcDogcGljdHVyZVBhdGggfV0sXG4gICAgICAgIHN0YXR1czogJ+W+heaPkOS6pCcsXG4gICAgICB9O1xuICAgICAgcmV0dXJuIF9zZWxmLnNhdmUocHJvYmxlbSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIOaLjeeFp1xuICAgKiBAcmV0dXJucyB7Knxwcm9taXNlfVxuICAgKi9cbiAgdGFrZVBpY3R1cmU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBJbWFnZVNlcnZpY2UudGFrZVBpY3R1cmUoKTtcbiAgfSxcblxuICAvKipcbiAgICog5piv5ZCm5YWB6K645LuO55u45YaM6YCJ54Wn54mHXG4gICAqIEByZXR1cm5zIHsqfFByb21pc2UuPFQ+fVxuICAgKi9cbiAgYWxsb3dTZWxlY3RQaWN0dXJlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gR2xvYmFsU3RvcmFnZVJlcG9zaXRvcnkuZ2V0VmFsdWUoJ3VwbG9hZF9mcm9tX3Bob25lX2FsYnVtcycpLnRoZW4oZnVuY3Rpb24odmFsKSB7XG4gICAgICByZXR1cm4gdmFsID09PSAnMSc7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIOWmguaenOacjeWKoeerr+W3suacieS6uuWkjemqjOmAmui/h++8jEFQUCDor5Xlm77mlLnlpI3pqozkurrvvIzlsLHkvJrkuqfnlJ/or6XlhrLnqoFcbiAgICog5aSE55CG5Yqe5rOV77yM55So5pyN5Yqh5Zmo5pyA5paw5pWw5o2u6KaG55uW5pys5ZywXG4gICAqIEBwYXJhbSB1cGxvYWRSZXN1bHRcbiAgICovXG4gIHJlaW5zcGVjdEJ5Q29uZmxpY3Q6IGZ1bmN0aW9uKHVwbG9hZFJlc3VsdCkge1xuICAgIGlmIChfLmlzRW1wdHkodXBsb2FkUmVzdWx0LnJlaW5zcGVjdEJ5KSkge1xuICAgICAgcmV0dXJuICRxLndoZW4oKTtcbiAgICB9XG5cbiAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkucmVtb3ZlUHJvYmxlbVJlaW5zcGVjdEJ5KFxuICAgICAgdXBsb2FkUmVzdWx0LnJlaW5zcGVjdEJ5WzBdLmNoZWNrcXVhbGl0eV9wcm9ibGVtX2lkXG4gICAgKVxuICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVpbnNwZWN0UmVwb3NpdG9yeS5pbnNlcnRSZWluc3BlY3RCeUxpc3QoXG4gICAgICAgICAgdXBsb2FkUmVzdWx0LnJlaW5zcGVjdEJ5XG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBUb2RvUmVwb3NpdG9yeS5yZW1vdmVQcm9ibGVtVG9kbyhcbiAgICAgICAgICB1cGxvYWRSZXN1bHQucmVpbnNwZWN0QnlbMF0uY2hlY2txdWFsaXR5X3Byb2JsZW1faWRcbiAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFRvZG9SZXBvc2l0b3J5Lmluc2VydFRvZG9MaXN0KHVwbG9hZFJlc3VsdC50b2RvKTtcbiAgICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiDlpI3liLbpl67popjvvIzmjpLpmaTvvJrnhafniYfjgIHooaXlhYXor7TmmI7jgIHmiLflnovlm77kuIrmoIforrDnmoTngrlcbiAgICogQHBhcmFtIGlkXG4gICAqL1xuICBjb3B5UHJvYmxlbTogZnVuY3Rpb24oaWQpIHtcbiAgICByZXR1cm4gJHFcbiAgICAgIC5hbGwoW1xuICAgICAgICBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS5nZXRQcm9ibGVtQWxsQ29sdW1uKGlkKSxcbiAgICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcGFpclJlcG9zaXRvcnkuZ2V0UmVwYWlyQWxsQ29sdW1uKGlkKSxcbiAgICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkuZ2V0UmVpbnNwZWN0QWxsQ29sdW1uKGlkKSxcbiAgICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkuZ2V0UmVpbnNwZWN0QnlMaXN0KGlkKSxcbiAgICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbUNDUmVwb3NpdG9yeS5nZXRQcm9ibGVtQ0NBbGxDb2x1bW4oaWQpLFxuICAgICAgXSlcbiAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICB2YXIgcHJvYmxlbSA9IHJlc3VsdFswXTtcbiAgICAgICAgdmFyIHJlcGFpckxpc3QgPSByZXN1bHRbMV07XG4gICAgICAgIHZhciByZWluc3BlY3RMaXN0ID0gcmVzdWx0WzJdO1xuICAgICAgICB2YXIgcmVpbnNwZWN0QnlMaXN0ID0gcmVzdWx0WzNdO1xuICAgICAgICB2YXIgY2NMaXN0ID0gcmVzdWx0WzRdO1xuXG4gICAgICAgIHByb2JsZW0uaWQgPSBVdGlscy51dWlkKCk7XG4gICAgICAgIC8vIOaWsOmcgOaxguimgeaxguWkjeWItui/meS4pOmhue+8mmh0dHA6Ly9qaXJhLm15c29mdC5jb20uY24vYnJvd3NlL1lEWkotMTE5NTNcbiAgICAgICAgLy8gcHJvYmxlbS5yZW1hcmsgPSAnJztcbiAgICAgICAgLy8gcHJvYmxlbS5pbWFnZV9maWxlID0gJyc7XG4gICAgICAgIHByb2JsZW0uc3RhdHVzID0gJ+W+heaPkOS6pCc7XG4gICAgICAgIHByb2JsZW0ucmVnaXN0X2J5ID0gJyc7XG4gICAgICAgIHByb2JsZW0ucmVwYWlyX2J5ID0gJyc7XG4gICAgICAgIHByb2JsZW0ucmVwYWlyX3JlbWFyayA9ICcnO1xuICAgICAgICBwcm9ibGVtLnJlcGFpcl9kYXRlID0gJyc7XG4gICAgICAgIHByb2JsZW0ucmVwYWlyX2ltYWdlX2ZpbGUgPSAnJztcbiAgICAgICAgcHJvYmxlbS5zZW50X2JhY2tfYnkgPSAnJztcbiAgICAgICAgcHJvYmxlbS5zZW50X2JhY2tfZGF0ZSA9ICcnO1xuICAgICAgICBwcm9ibGVtLnNlbnRfYmFja190aW1lcyA9IDA7XG4gICAgICAgIHByb2JsZW0uc2VudF9iYWNrX3JlbWFyayA9ICcnO1xuICAgICAgICBwcm9ibGVtLnNlbnRfYmFja19pbWFnZV9maWxlID0gJyc7XG4gICAgICAgIHByb2JsZW0ucmVpbnNwZWN0X2J5ID0gJyc7XG4gICAgICAgIHByb2JsZW0ucmVpbnNwZWN0X2NvbXBsZXRlZF9kYXRlID0gJyc7XG4gICAgICAgIHByb2JsZW0uY2xvc2VfZGF0ZSA9ICcnO1xuICAgICAgICBwcm9ibGVtLmNsb3NlX3JlYXNvbiA9ICcnO1xuICAgICAgICBwcm9ibGVtLmNyZWF0ZWRfYnkgPSBjb250ZXh0LmdldFVzZXIoKS51c2VyX2lkO1xuICAgICAgICBwcm9ibGVtLmNyZWF0ZWRfb24gPSBVdGlscy5ub3coKTtcbiAgICAgICAgcHJvYmxlbS5tb2RpZmllZF9ieSA9IGNvbnRleHQuZ2V0VXNlcigpLnVzZXJfaWQ7XG4gICAgICAgIHByb2JsZW0uZG93bmxvYWRfdGltZSA9ICcnO1xuICAgICAgICBwcm9ibGVtLnVwZGF0ZV90aW1lc3RhbXAgPSAnJztcbiAgICAgICAgLy8g6KaB5rGC5aSN5Yi254K55L2NIGh0dHA6Ly9qaXJhLm15c29mdC5jb20uY24vYnJvd3NlL1lEWkotMTIxNTJcbiAgICAgICAgLy8gcHJvYmxlbS5wcm9ibGVtX3ZhbHVlcyA9ICcnO1xuICAgICAgICAvLyBwcm9ibGVtLnByb2JsZW1fdmFsdWVzX3ppcCA9ICcnO1xuXG4gICAgICAgIGlmIChwcm9ibGVtLnJlcGFpcl9kZWFkbGluZSAmJiAhcHJvYmxlbS5kZWFkbGluZSAmJiBwcm9ibGVtLnJlZ2lzdF9kYXRlKSB7XG4gICAgICAgICAgdmFyIGFyciA9IHByb2JsZW0ucmVwYWlyX2RlYWRsaW5lLm1hdGNoKC9cXGQrL2cpO1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcnJbaV0gPSBwYXJzZUludChhcnJbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZGVhZGxpbmVEYXRlID0gbmV3IERhdGUoXG4gICAgICAgICAgICBhcnJbMF0sXG4gICAgICAgICAgICBhcnJbMV0gLSAxLFxuICAgICAgICAgICAgYXJyWzJdLFxuICAgICAgICAgICAgYXJyWzNdIHx8IDAsXG4gICAgICAgICAgICBhcnJbNF0gfHwgMCxcbiAgICAgICAgICAgIGFycls1XSB8fCAwXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHZhciBhcnIyID0gcHJvYmxlbS5yZWdpc3RfZGF0ZS5tYXRjaCgvXFxkKy9nKTtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycjIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFycjJbaV0gPSBwYXJzZUludChhcnIyW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJlZ2lzdERhdGUgPSBuZXcgRGF0ZShcbiAgICAgICAgICAgIGFycjJbMF0sXG4gICAgICAgICAgICBhcnIyWzFdIC0gMSxcbiAgICAgICAgICAgIGFycjJbMl0sXG4gICAgICAgICAgICBhcnIyWzNdIHx8IDAsXG4gICAgICAgICAgICBhcnIyWzRdIHx8IDAsXG4gICAgICAgICAgICBhcnIyWzVdIHx8IDBcbiAgICAgICAgICApO1xuICAgICAgICAgIHByb2JsZW0uZGVhZGxpbmUgPSBNYXRoLmNlaWwoXG4gICAgICAgICAgICAoZGVhZGxpbmVEYXRlLmdldFRpbWUoKSAtIHJlZ2lzdERhdGUuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcHJvYmxlbS5yZWdpc3RfZGF0ZSA9ICcnO1xuICAgICAgICBwcm9ibGVtLnJlcGFpcl9kZWFkbGluZSA9ICcnO1xuXG4gICAgICAgIF8uZWFjaChyZXBhaXJMaXN0LCBmdW5jdGlvbihyZXBhaXIpIHtcbiAgICAgICAgICByZXBhaXIuaWQgPSBVdGlscy51dWlkKCk7XG4gICAgICAgICAgcmVwYWlyLmNoZWNrcXVhbGl0eV9wcm9ibGVtX2lkID0gcHJvYmxlbS5pZDtcbiAgICAgICAgICByZXBhaXIuZG93bmxvYWRfdGltZSA9ICcnO1xuICAgICAgICB9KTtcblxuICAgICAgICBfLmVhY2gocmVpbnNwZWN0TGlzdCwgZnVuY3Rpb24ocmVpbnNwZWN0KSB7XG4gICAgICAgICAgcmVpbnNwZWN0LmlkID0gVXRpbHMudXVpZCgpO1xuICAgICAgICAgIHJlaW5zcGVjdC5jaGVja3F1YWxpdHlfcHJvYmxlbV9pZCA9IHByb2JsZW0uaWQ7XG4gICAgICAgICAgcmVpbnNwZWN0LmRvd25sb2FkX3RpbWUgPSAnJztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgXy5lYWNoKHJlaW5zcGVjdEJ5TGlzdCwgZnVuY3Rpb24ocmVpbnNwZWN0QnkpIHtcbiAgICAgICAgICByZWluc3BlY3RCeS5pZCA9IFV0aWxzLnV1aWQoKTtcbiAgICAgICAgICByZWluc3BlY3RCeS5jaGVja3F1YWxpdHlfcHJvYmxlbV9pZCA9IHByb2JsZW0uaWQ7XG4gICAgICAgICAgcmVpbnNwZWN0QnkucmVpbnNwZWN0X2RhdGUgPSAnJztcbiAgICAgICAgICByZXBhaXJMaXN0LnJlaW5zcGVjdF9yZW1hcmsgPSAnJztcbiAgICAgICAgICByZXBhaXJMaXN0LnJlaW5zcGVjdF9pbWFnZV9maWxlID0gJyc7XG4gICAgICAgICAgcmVpbnNwZWN0QnkuZG93bmxvYWRfdGltZSA9ICcnO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyDlpI3liLbpu5jorqTmioTpgIHkurpcbiAgICAgICAgdmFyIGRlZmF1bHRDY0xpc3QgPSBfLmZpbHRlcihjY0xpc3QsIGZ1bmN0aW9uKGNjKSB7XG4gICAgICAgICAgcmV0dXJuIGNjLnR5cGUgPT09ICfpu5jorqQnO1xuICAgICAgICB9KTtcbiAgICAgICAgZGVmYXVsdENjTGlzdCA9IF8ubWFwKGRlZmF1bHRDY0xpc3QsIGZ1bmN0aW9uKGNjKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBjYy5jYyxcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICBjY0xpc3QgPSBfLmZpbHRlcihjY0xpc3QsIGZ1bmN0aW9uKGNjKSB7XG4gICAgICAgICAgcmV0dXJuIGNjLnR5cGUgPT09ICfooqvmioTpgIEnO1xuICAgICAgICB9KTtcbiAgICAgICAgY2NMaXN0ID0gXy5tYXAoY2NMaXN0LCBmdW5jdGlvbihjYykge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogY2MuY2MsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuICRxLmFsbChbXG4gICAgICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkuaW5zZXJ0KHByb2JsZW0pLFxuICAgICAgICAgIENoZWNrUXVhbGl0eVByb2JsZW1SZXBhaXJSZXBvc2l0b3J5Lmluc2VydChyZXBhaXJMaXN0KSxcbiAgICAgICAgICBDaGVja1F1YWxpdHlQcm9ibGVtUmVpbnNwZWN0UmVwb3NpdG9yeS5pbnNlcnRSZWluc3BlY3QocmVpbnNwZWN0TGlzdCksXG4gICAgICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbVJlaW5zcGVjdFJlcG9zaXRvcnkuaW5zZXJ0UmVpbnNwZWN0QnlMaXN0KHJlaW5zcGVjdEJ5TGlzdCksXG4gICAgICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbUNDUmVwb3NpdG9yeS5zYXZlUHJvYmxlbUNDKHByb2JsZW0uaWQsIGNjTGlzdCksXG4gICAgICAgICAgQ2hlY2tRdWFsaXR5UHJvYmxlbUNDUmVwb3NpdG9yeS5zYXZlRGVmYXVsdENjKHByb2JsZW0uaWQsIGRlZmF1bHRDY0xpc3QpLFxuICAgICAgICBdKTtcbiAgICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiDku6XmnI3liqHlmajpl67popjmlbDmja7kuLrln7rlh4bvvIznp7vpmaTmnKzlnLDnmoTml6DmlYjmlbDmja5cbiAgICogQHBhcmFtIHByb2JsZW1EYXRhXG4gICAqL1xuICByZW1vdmVMb2NhbEludmFsaWRQcm9ibGVtOiBmdW5jdGlvbihwcm9ibGVtRGF0YSkge1xuICAgIHZhciBwcm9taXNlID0gJHEud2hlbigpO1xuXG4gICAgaWYgKHByb2JsZW1EYXRhLnByb2JsZW1fcmVwYWlyKSB7XG4gICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcGFpclJlcG9zaXRvcnkucmVtb3ZlSW52YWxpZERhdGEoXG4gICAgICAgICAgcHJvYmxlbURhdGEucHJvYmxlbS5pZCxcbiAgICAgICAgICBfLm1hcChwcm9ibGVtRGF0YS5wcm9ibGVtX3JlcGFpciwgJ2lkJylcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChwcm9ibGVtRGF0YS5wcm9ibGVtX3JlaW5zcGVjdCkge1xuICAgICAgcHJvbWlzZSA9IHByb21pc2UudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZWluc3BlY3RSZXBvc2l0b3J5LnJlbW92ZUludmFsaWREYXRhKFxuICAgICAgICAgIHByb2JsZW1EYXRhLnByb2JsZW0uaWQsXG4gICAgICAgICAgXy5tYXAocHJvYmxlbURhdGEucHJvYmxlbV9yZWluc3BlY3QsICdpZCcpXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAocHJvYmxlbURhdGEucHJvYmxlbV9jYykge1xuICAgICAgcHJvbWlzZSA9IHByb21pc2UudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1DQ1JlcG9zaXRvcnkucmVtb3ZlSW52YWxpZERhdGEoXG4gICAgICAgICAgcHJvYmxlbURhdGEucHJvYmxlbS5pZCxcbiAgICAgICAgICBfLm1hcChwcm9ibGVtRGF0YS5wcm9ibGVtX2NjLCAnaWQnKVxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHByb2JsZW1EYXRhLmNoaWxkcmVuX1Byb2JsZW0pIHtcbiAgICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS5yZW1vdmVJbnZhbGlkQ2hpbGRQcm9ibGVtKFxuICAgICAgICAgIHByb2JsZW1EYXRhLnByb2JsZW0uaWQsXG4gICAgICAgICAgcHJvYmxlbURhdGEuY2hpbGRyZW5fUHJvYmxlbVxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH0sXG5cbiAgcmVtb3ZlTG9jYWxJbnZhbGlkUHJvYmxlbTE6IGZ1bmN0aW9uKHJlbW90ZURhdGEsIGxvY2FsRGF0YSkge1xuICAgIHZhciBwcm9ibGVtID0gbG9jYWxEYXRhLmNoZWNrcXVhbGl0eV9wcm9ibGVtO1xuICAgIHJldHVybiAkcVxuICAgICAgLndoZW4oKVxuICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChsb2NhbERhdGEuY2hlY2txdWFsaXR5X3Byb2JsZW0pIHtcbiAgICAgICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbVJlcG9zaXRvcnkuZGVsZXRlUHJvYmxlbUJ5SWQocHJvYmxlbS5pZCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGxvY2FsRGF0YS5jaGVja3F1YWxpdHlfcmVwYWlyKSB7XG4gICAgICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBhaXJSZXBvc2l0b3J5LnJlbW92ZUludmFsaWREYXRhKFxuICAgICAgICAgICAgcHJvYmxlbS5pZCxcbiAgICAgICAgICAgIF8ubWFwKGxvY2FsRGF0YS5jaGVja3F1YWxpdHlfcmVwYWlyLCAnaWQnKVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGxvY2FsRGF0YS5jaGVja3F1YWxpdHlfY2MpIHtcbiAgICAgICAgICByZXR1cm4gQ2hlY2tRdWFsaXR5UHJvYmxlbUNDUmVwb3NpdG9yeS5yZW1vdmVJbnZhbGlkRGF0YShcbiAgICAgICAgICAgIHByb2JsZW0uaWQsXG4gICAgICAgICAgICBfLm1hcChsb2NhbERhdGEuY2hlY2txdWFsaXR5X2NjLCAnaWQnKVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiDmiorlt7LlhbPpl63mibnmrKHnmoTpl67popjnp7vpmaRcbiAgICogQHJldHVybnMgeyp8UHJvbWlzZS48VFJlc3VsdD59XG4gICAqL1xuICByZW1vdmVDbG9zZWRCYXRjaFByb2JsZW06IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBCYXRjaFNlcnZpY2UuZ2V0Q2xvc2VkQmF0Y2hJZExpc3QoKS50aGVuKGZ1bmN0aW9uKGJhdGNoSWRzKSB7XG4gICAgICAvLyDliKDpmaTlt7LlhbPpl63mibnmrKHnmoTpl67popjlj4rmnKzlnLDlm77niYdcbiAgICAgIHJldHVybiBfc2VsZi5kZWxldGVCYXRjaFByb2JsZW1zKGJhdGNoSWRzKTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICog5Yig6Zmk5om55qyh5LiL55qE6Zeu6aKY77yI5YWz6Zet5om55qyh77yJXG4gICAqIEBwYXJhbSBiYXRjaElkc1xuICAgKi9cbiAgZGVsZXRlQmF0Y2hQcm9ibGVtczogZnVuY3Rpb24oYmF0Y2hJZHMpIHtcbiAgICAkbG9nLmxvZygn5Yig6Zmk5bey5YWz6Zet5om55qyh55qE6Zeu6aKYJyk7XG4gICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LmdldFByb2JsZW1zQnlCYXRjaChiYXRjaElkcylcbiAgICAgIC50aGVuKGZ1bmN0aW9uKHByb2JsZW1zKSB7XG4gICAgICAgIC8vIOWIoOmZpOmXrumimOWbvueJh1xuICAgICAgICB2YXIgcHJvbWlzZSA9ICRxLndoZW4oKTtcbiAgICAgICAgdmFyIGltYWdlQ29sdW1ucyA9IFsnaW1hZ2VfZmlsZScsICdyZXBhaXJfaW1hZ2VfZmlsZScsICdzZW50X2JhY2tfaW1hZ2VfZmlsZSddO1xuICAgICAgICB2YXIgZmlsZXMgPSBbXTtcbiAgICAgICAgXy5lYWNoKHByb2JsZW1zLCBmdW5jdGlvbihwcm9ibGVtKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbWFnZUNvbHVtbnMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBpbWFnZXMgPSAocHJvYmxlbVtpbWFnZUNvbHVtbnNbaV1dID0gSlNPTi5wYXJzZShwcm9ibGVtW2ltYWdlQ29sdW1uc1tpXV0gfHwgJ1tdJykpO1xuICAgICAgICAgICAgXy5lYWNoKGltYWdlcywgZnVuY3Rpb24oaW1hZ2UpIHtcbiAgICAgICAgICAgICAgaWYgKGltYWdlLmxvY2FsKSB7XG4gICAgICAgICAgICAgICAgZmlsZXMucHVzaChpbWFnZS5sb2NhbCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoaW1hZ2UudGh1bWJuYWlsKSB7XG4gICAgICAgICAgICAgICAgZmlsZXMucHVzaChpbWFnZS50aHVtYm5haWwpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGltYWdlLnRlbXApIHtcbiAgICAgICAgICAgICAgICBmaWxlcy5wdXNoKGltYWdlLnRlbXApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIF8uZWFjaChmaWxlcywgZnVuY3Rpb24oZmlsZSkge1xuICAgICAgICAgIHByb21pc2UgPSBwcm9taXNlXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHBsdWdpbkFwaS5pc0ZpbGVFeGlzdHMoZmlsZSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZXhpc3RzKSB7XG4gICAgICAgICAgICAgIGlmIChleGlzdHMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGx1Z2luQXBpLmRlbGV0ZUZpbGUoZmlsZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIENoZWNrUXVhbGl0eVByb2JsZW1SZXBvc2l0b3J5LmRlbGV0ZVByb2JsZW1CeUJhdGNoKGJhdGNoSWRzKTtcbiAgICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiDojrflj5bpooblr7zmibnnpLpcbiAgICogQHBhcmFtIHByb2JsZW1JZFxuICAgKi9cbiAgZ2V0TGVhZGVyQ29tbWVudHM6IGZ1bmN0aW9uKHByb2JsZW1JZCkge1xuICAgIHJldHVybiBDaGVja1F1YWxpdHlQcm9ibGVtUmVwb3NpdG9yeS5nZXRMZWFkZXJDb21tZW50cyhwcm9ibGVtSWQpLnRoZW4oZnVuY3Rpb24obGlzdCkge1xuICAgICAgXy5lYWNoKGxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaXRlbS51c2VyID0ge1xuICAgICAgICAgIGlkOiBpdGVtLnVzZXJfaWQsXG4gICAgICAgICAgbmFtZTogaXRlbS51c2VyX25hbWUsXG4gICAgICAgICAgbW9iaWxlOiBpdGVtLm1vYmlsZSxcbiAgICAgICAgICBpc19pbV91c2VyOiBpdGVtLmlzX2ltX3VzZXIsXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGl0ZW0uaW1hZ2VfZmlsZSkge1xuICAgICAgICAgIGl0ZW0uaW1hZ2VfZmlsZSA9IEpTT04ucGFyc2UoaXRlbS5pbWFnZV9maWxlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBsaXN0O1xuICAgIH0pO1xuICB9LFxuXG4gIGdldFBob3RvUmVxdWlyZWQocHJvaklkLCBrZXkpIHtcbiAgICBjb25zdCBwaG90b0dyYXkgPSBzdG9yZS5zdGF0ZS5nbG9iYWwuYWxsR3JheVJlbGVhc2UuVXNpbmdQcm9qZWN0UGFyYW1ldGVyO1xuICAgIHJldHVybiBDb21tb25CYXNlZGF0YVNlcnZpY2UuZ2V0UHJvalBhcmFtZXRlcihwcm9qSWQsICdpc19waG90b19yZXF1aXJlZCcsIGtleSlcbiAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICBpZiAocGhvdG9HcmF5KSB7XG4gICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBOdW1iZXIoZGF0YVswXS52YWx1ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzdG9yZS5zdGF0ZS5nbG9iYWwuaXNQaG90b1JlcXVpcmVkW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBzdG9yZS5zdGF0ZS5nbG9iYWwuaXNQaG90b1JlcXVpcmVkW2tleV07XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InLCBlcnJvcik7XG4gICAgICB9KTtcbiAgfSxcbn07XG4vLyB9XSk7XG5cbmV4cG9ydCBkZWZhdWx0IF9zZWxmO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==