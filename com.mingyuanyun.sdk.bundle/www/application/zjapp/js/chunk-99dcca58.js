(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-99dcca58","chunk-3adbbd26"],{"0416":function(t,e,i){"use strict";i("068e")},"068e":function(t,e,i){var n=i("771c");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("1ce02ce6",n,!0,{sourceMap:!1,shadowMode:!1})},"0732":function(t,e,i){var n=i("81f2");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("1b5b07de",n,!0,{sourceMap:!1,shadowMode:!1})},3411:function(t,e,i){"use strict";i("ef1c")},"3ab5":function(t,e,i){"use strict";i("6d57");var n={props:{title:{type:String,default:"请选择"},items:{type:Array,default:function(){return[]}},selectedText:{type:String,default:""}},data:function(){return{visable:!1,itemOptions:[],callback:null}},methods:{open:function(t){var e=t.options,i=void 0===e?[]:e,n=t.selected,a=void 0===n?"":n,o=t.callback,c=void 0===o?null:o;console.log({params:t}),this._initItemOptions(i,a),this.callback=c,this.visable=!0},_initItemOptions:function(t,e){var i=this,n=0;this.itemOptions=t.map((function(t,i){var a=e===t;return a&&(n=i),{title:t,checked:a}})),setTimeout((function(){var t=50*n-125;i.$refs["popup-content"].scrollTop=t>0?t:0}),200)},onClickItem:function(t){this.itemOptions.forEach((function(t){t.checked=!1})),t.checked=!0,this.callback&&this.callback(t.title),this.visable=!1}}},a=(i("52bc"),i("17cc")),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("van-popup",{style:{height:"70%"},attrs:{position:"bottom",round:"",ellipsis:!1},model:{value:t.visable,callback:function(e){t.visable=e},expression:"visable"}},[i("div",{staticClass:"popup-title"},[i("div",{staticClass:"title-name"},[t._v(t._s(t.title))])]),i("div",{ref:"popup-content",staticClass:"popup-content"},t._l(t.itemOptions,(function(e,n){return i("div",{key:n,staticClass:"text-picker-options-wrapper",on:{click:function(i){t.onClickItem(e)}}},[t._v("\n        "+t._s(e.title)+"\n        "),e.checked?i("van-icon",{staticClass:"picker-icon",attrs:{name:"success"}}):t._e()],1)})))])}),[],!1,null,"4d7cbae5",null);e.a=o.exports},"3f2e":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .process-accept-detail-header{background-color:#fff;padding:10px 15px}.zjapp .process-accept-detail-header .process-accept-detail-title{font-size:18px;color:#111;margin-top:10px;margin-bottom:10px}.zjapp .process-accept-detail-header .process-accept-detail-content{height:auto;line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .process-accept-detail-list{position:relative;padding-top:1px;padding-bottom:1px;padding-left:0}.zjapp .process-accept-detail-list .process-accept-detail-item-header{position:relative;align-items:center}.zjapp .content-bottom-btn-con{text-align:center}.zjapp .delete-btn{display:inline-block!important;padding:3px 10px!important;width:80px!important;height:28px!important;border:1px solid #dcdcdc!important;background:transparent!important;line-height:20px!important;text-align:center!important;font-size:14px!important;color:#666!important;border-radius:14px!important}.zjapp .process-accept-point-content{font-size:14px;background-color:#f0f0f0;padding:10px;color:#666;border-radius:3px;word-break:break-all}.zjapp .process-accept-icon-sys{position:absolute;left:0;width:4px;height:16px;background-color:#4275e8}.zjapp .required-icon{color:#ff3d3d}.zjapp .process-accept-edit-content{display:flex;flex-direction:column}.zjapp .process-accept-detail-img-list{padding:15px}.zjapp .process-accept-detail-input-wrapper{margin-bottom:14px;padding:15px 0;border-bottom:1px solid #ececec}.zjapp .process-accept-detail-input-wrapper /deep/ .van-cell{padding:0 15px}.zjapp .process-accept-detail-input-wrapper /deep/ .van-cell.text-right .van-field__control{padding-top:2px;text-align:right}.zjapp .process-accept-detail-input-wrapper.no-padding-top{padding-top:0}.zjapp .process-accept-entrys-viewer{padding:15px;font-size:16px;color:#333}.zjapp .no-entry-text{color:#999}.zjapp .item-margin-bottom{margin-bottom:15px}.zjapp .bar-fixed-buttons{background-color:#fff;border:none;background-image:linear-gradient(180deg,#dcdcdc,#dcdcdc 100%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:top;display:flex;flex-direction:horizontal;justify-content:center}.zjapp .btn-text-blue{display:block;padding:10px;margin:0 auto;width:auto;height:40px;line-height:20px;font-size:14px;color:#7a95d1;border:none;background:transparent}",""])},"4e37":function(t,e,i){"use strict";i("7f3b")},"515e":function(t,e,i){"use strict";var n=i("329b"),a=i("f1e4").a,o=(i("0416"),i("17cc")),c=Object(o.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide-right"}},[t.show?i("page-content",{class:{"content-not-empty":t.content.length},attrs:{mode:"dialog",title:"检查指引","on-close":t.closePopup}},[!t.isLoading&&t.title?i("div",{staticClass:"check-guide-detail-hd border-bottom"},[i("h2",{staticClass:"check-guide-detail-title pb10"},[t._v(t._s(t.title))])]):t._e(),!t.isLoading&&t.content.length?i("div",{staticClass:"check-guide-detail-content"},t._l(t.content,(function(e,n){return i("p",{key:n},[e.isImg&&e.src?i("img",{class:{"img-not-ready":!e.ready,error:"rejected"===e.status},attrs:{src:t.getThumbnail(e)},on:{error:function(i){t.imgError(e,n)},click:function(i){t.imgClick(e)}}}):t._e(),e.isImg?t._e():i("span",[t._v("\n          "+t._s(e.val)+"\n        ")])])}))):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.content.length,"empty-text":"PC端未设置检查指引"}})],1):t._e()],1)}),[],!1,null,"691b2f0f",null).exports,s=!1;s||(s=new(n.default.extend(c))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},"52bc":function(t,e,i){"use strict";i("e79f")},"6c7c":function(t,e,i){"use strict";i("8df9")},"771c":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .content-not-empty[data-v-691b2f0f] .layout-content{display:auto;overflow:auto;padding-bottom:100px}.zjapp .check-guide-detail-hd[data-v-691b2f0f]{margin-left:30px;padding:25px 30px 5px 0}.zjapp .check-guide-detail-title[data-v-691b2f0f]{margin:0;line-height:20px;font-size:18px;color:#111;font-weight:700;word-break:break-all}.zjapp .check-guide-detail-info[data-v-691b2f0f]{line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .check-guide-detail-content[data-v-691b2f0f]{padding:30px;line-height:30px;color:#333;font-size:16px}.zjapp .check-guide-detail-content p[data-v-691b2f0f]{margin-bottom:30px;min-height:1em}.zjapp .check-guide-detail-content img[data-v-691b2f0f]{max-width:100%}.zjapp .check-guide-detail-content .img-not-ready[data-v-691b2f0f]{width:80px;height:auto}.zjapp .error[data-v-691b2f0f]{max-width:50%}",""])},"7f3b":function(t,e,i){var n=i("3f2e");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("2c4dd5f2",n,!0,{sourceMap:!1,shadowMode:!1})},8072:function(t,e,i){"use strict";i("ce26")},"81b5":function(t,e,i){"use strict";var n=i("c9b6").a,a=(i("6c7c"),i("17cc")),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("van-popup",{style:{height:"70%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("div",{staticClass:"popup-title van-hairline--bottom"},[i("div",{staticClass:"title-name"},[t._v("请选择桩基类型")])]),i("div",{staticClass:"popup-content"},[i("div",{staticClass:"list"},t._l(t.options,(function(e,n){return i("div",{key:n,staticClass:"list-item",class:{checked:e.checked},on:{click:function(i){t.openChild(e)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))),i("div",{staticClass:"list"},[t._l(t.children,(function(e,n){return i("div",{key:n,staticClass:"list-item",class:{checked:e.checked},on:{click:function(i){t.selectChildren(e)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])})),t.children.length?t._e():i("div",{staticClass:"list-item",staticStyle:{color:"#666666"}},[t._v("无二级检查项")])],2)])])],1)}),[],!1,null,"653ff8ec",null);e.a=o.exports},"81f2":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .main[data-v-2cac8864]{position:fixed;width:100%;bottom:0}.zjapp .arrow[data-v-2cac8864]{position:absolute;top:-7px;right:18px;width:0;height:0;border-bottom:7px solid #fff;border-right:7px solid transparent;border-left:7px solid transparent}.zjapp .content[data-v-2cac8864]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-2cac8864]{display:flex;flex-direction:column;background-color:#fff;overflow:auto}.zjapp .box-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1}.zjapp .detail-hd[data-v-2cac8864]{display:flex;padding:6px 15px}.zjapp .detail-arrow-right[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-right[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:12px;border:5px solid transparent;border-left:5px solid #c8c8c8}.zjapp .detail-arrow-down[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-down[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:15px;border:5px solid transparent;border-top:5px solid #c8c8c8}.zjapp .detail-title[data-v-2cac8864]{flex:1;line-height:34px;color:#111;font-size:16px}.zjapp .detail-bd[data-v-2cac8864]{padding:8px 15px 8px 35px;background-color:#fafafa}.zjapp .text-line[data-v-2cac8864]{font-size:14px;color:#666;line-height:30px;margin-bottom:30px}.zjapp .detail-hd-single[data-v-2cac8864]{padding:6px 0;margin:0 15px}.zjapp .detail-bd-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1;padding:8px 15px;background-color:#fff}',""])},"841f":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .popup-title[data-v-4d7cbae5]{display:flex;align-items:center;justify-content:center;height:46px;padding:0 15px;border-bottom:1px solid #ececec}.zjapp .popup-title .title-name[data-v-4d7cbae5]{font-size:16px;color:#333}.zjapp .popup-content[data-v-4d7cbae5]{height:calc(100% - 46px);overflow:hidden;overflow-y:scroll}.zjapp .popup-content .text-picker-options-wrapper[data-v-4d7cbae5]{position:relative;padding:13px 15px;padding-right:40px;box-sizing:border-box;border-bottom:1px solid #ececec;line-height:20px;font-size:14px;color:#333}.zjapp .popup-content .text-picker-options-wrapper .picker-icon[data-v-4d7cbae5]{position:absolute;right:15px;top:14px;width:18px;height:18px;font-size:18px;color:#4275e8}",""])},"8df9":function(t,e,i){var n=i("e6e2");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("50ab7b41",n,!0,{sourceMap:!1,shadowMode:!1})},"91c1":function(t,e,i){"use strict";(function(t){i("5ab2"),i("6d57"),i("e10e"),i("9a33");var n=i("28f8"),a=i("e68e"),o=i("6f9e"),c=i("bcc7"),s=i("e89f");function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"CheckGuideDetailDrop",components:{ItemImgList:a.a},mixins:[s.a],data:function(){return{show:!1,showList:!1,isLoading:!1,isOpening:!1,isClosing:!1,contentTop:64,listHeight:510,module:"",itemIds:[],data:[],target:""}},watch:{show:function(t){var e=this;t&&this.$nextTick((function(){e.showList=!0}))}},created:function(){o.a.$on("routerBeforeEach",this.closePopup),o.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){o.a.$off("routerBeforeEach",this.closePopup),o.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(e){this.show=!0,this.$emit("open"),this.module=e.module,this.itemIds=e.itemIds,this.options=e.options;var i=document.querySelector(".layout-main .layout-header");if(this.contentTop=i.offsetHeight,e.el){var n=e.el.getBoundingClientRect();this.contentTop=n.bottom}this.target=e.el,this.listHeight=t.minBy([window.innerHeight-this.contentTop-50,510]),this.getData()},closePopup:function(){var t=this;if(!this.isOpening)return this.showList=!1,this.$emit("close"),new Promise((function(e){t.$on("afterClosePopup",e)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(t){t&&t.target&&t.target!==this.target&&this.show&&this.closePopup()},getData:function(){var e=this;return this.options&&this.options.length?(this.data=t.map(this.options,(function(t){return l(l({},t),{},{isOpen:!1})})),Promise.resolve()):c.a.getMeasureCheckItem(this.itemIds).then((function(i){e.data=t.map(i,(function(e){var i=e.content?e.content.trim():"",n=i?i.split("\n"):[],a=e.content_image?JSON.parse(e.content_image):[],o=t.filter(n,(function(t){return!/<img([\s\S]*)>/gm.test(t)}));return t.each(a,(function(t){t.url=t.url.split("@")[0]})),{id:e.id,name:e.full_name,textArr:o,contentImage:a,isOpen:!1}}))})).catch((function(t){console.error(t)}))},toggleItem:function(t){this.data.length>1&&this.$set(t,"isOpen",!t.isOpen)}}}}).call(this,i("391c"))},"9b03":function(t,e,i){"use strict";(function(t){i("c904"),i("f548"),i("9dd9"),i("6a61");var n,a=i("2e91"),o=(i("e697"),i("6bf2")),c=i.n(o),s=i("fd50"),r=i("e2a7"),l=i("7cb8"),d=i("3bd5"),p=i("ed08"),u=i("774b"),h=i("07d2"),f=i("e68e"),m=i("cd05"),g=i("f369"),b=i("81b5"),v=i("3ab5"),_=i("14c3"),k=i("0136"),x=i("8cf5"),y=i("b9cd"),I=x.a.processDraft,w=null;e.a={components:{Scroller:u.default,Item:h.default,ItemImgList:f.a,UserSelect:m.a,CheckGuide:g.a,PilePicker:b.a,TextPicker:v.a},data:function(){return{CHECKPOINT_ENTER_TYPE:y.a,showSelectDatePopup:!1,selectDateValue:new Date,datetimeType:"date",currentSettingPoint:null,isLoading:!0,saving:!1,curUser:d.a.getUser(),project:{},primaryKeys:{},isAdd:!1,isView:!1,isHint:!1,hasDarft:!1,checkItemList:[],allCheckItemList:[],currentCheckItem:{},buildingInfo:{},model:{pile_address:"",partners:[],cc:[],accepts:[],status:"待移交",created_on:""},process_mode:1,pileAcceptId:"",emptyCheckPoints:[],checkPointDetail:[],userOptions:[],showSubmitMenu:!1,submitActions:[{name:"未完成验收，先提交",status:"待验收"},{name:"验收完成并提交（提交后不可修改）",status:"已验收"}]}},computed:{allProjects:function(){var e=t.clone(this.$store.state.global.allProjects);return e}},activated:function(){var e=this.$route.query,i=e.id,n=e.sectionId,a=e.sectionName,o=e.buildingId,c=e.buildingName,s=e.status,r=e.pointXY,l=e.fromReport,d=e.projectId,p=e.processMode,u=e.locationName;this.process_mode=p;var h=t.find(this.allProjects,{id:d})||{};this.project="1"===l?h:this.$store.state.global.currentProject,this.buildingInfo={sectionId:n,sectionName:a,buildingId:o,buildingName:c||u,pointXY:r},this.pileAcceptId=i,this.isAdd=!i,this.init(s)},methods:{init:(n=Object(a.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.defaultValue(e);case 2:return t.next=4,this.getCheckItemList();case 4:return t.next=6,this.getDefaultCheckItem();case 6:return t.next=8,this.getCheckPoints();case 8:return t.next=10,this.getUserOptions();case 10:return t.next=12,this.getPileData();case 12:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)}),showTextPicker:function(t){var e=this;this.currentSettingPoint=t;var i=[];try{i=JSON.parse(t.enter_type_option)}catch(t){}this.$refs["text-picker"].open({options:i,selected:t.enter_content,callback:function(i){t.enter_content=i,e.saveDraft()}})},datetimePickerFormatter:function(t,e){return"".concat(e).concat({year:"年",month:"月",day:"日",hour:"时",minute:"分"}[t]||"")},showDatetimePicker:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"date";this.currentSettingPoint=t,isNaN(t.enter_content)&&!isNaN(Date.parse(t.enter_content))?this.selectDateValue=new Date(t.enter_content):this.selectDateValue=new Date,this.datetimeType=e,this.showSelectDatePopup=!0},datePickerConfirmHandler:function(t){if(this.currentSettingPoint){var e={date:"YYYY-MM-DD",datetime:"YYYY-MM-DD HH:mm"},i=e[this.datetimeType]||e.date;this.currentSettingPoint.enter_content=c()(t).format(i)}this.showSelectDatePopup=!1,this.saveDraft()},datePickerCancelHandler:function(){this.showSelectDatePopup=!1},numberFormatter:function(t){for(var e=[["^0(\\d+)$","$1"],["[^\\d\\.]+$",""],["\\.(\\d?)\\.+",".$1"],["^(\\d+\\.\\d{2}).+","$1"]],i=0;i<e.length;i++){var n=new RegExp(e[i][0]);t=t.replace(n,e[i][1])}return t},defaultValue:function(t){this.isView="已验收"===t&&this.pileAcceptId,this.checkPointDetail=[],this.currentCheckItem={},this.isAdd?(this.isLoading=!1,this.model={pile_address:"",partners:[],cc:[],accepts:[],status:"待移交",created_on:c()().format("YYYY-MM-DD HH:mm:ss")}):this.isLoading=!0},getPileData:function(){var e=this;return this.pileAcceptId=this.pileAcceptId||p.a.uuid(),this.primaryKeys={processAcceptId:this.pileAcceptId},w=x.a.createPrimaryKeys(this.primaryKeys),this.isAdd?(this.setMMKVModel(this.checkPointDetail),Promise.resolve()):x.a.getDataRecover(this.pileAcceptId).then((function(t){return t?(e.setMMKVModel(t.details,t),I.save(w).then((function(){return _.a.clear()}))):Promise.resolve()})).then((function(){return x.a.getDataMMKVMergeDB(e.buildingInfo.buildingId,w,e.pileAcceptId,e.userOptions).then((function(i){e.model.pile_address=i.index.pile_address,e.model.status=i.index.status,e.model.created_on=i.index.created_on,e.currentCheckItem=t.find(e.allCheckItemList,(function(t){return t.id===i.index.item_id}))||{},e.checkPointDetail=i.detail.map((function(t){return t.enter_type||(t.enter_type="image",t.enter_content="",t.enter_type_option=""),void 0===t.is_fill&&(t.is_fill=1),t})),e.model.partners=i.users.partners,e.model.cc=i.users.cc,e.model.accepts=i.users.accepts,e.hasDarft=i.hasDarft,i.hasDarft||I.remove(w),e.setMMKVModel(e.checkPointDetail)})).finally((function(){e.isLoading=!1}))}))},getCheckItemList:function(){var e=this;return x.a.getItemList().then((function(i){console.log({res:i}),e.checkItemList=i;var n=[];t.each(i,(function(e){t.each(e.subitem,(function(t){n.push(t)}))})),e.allCheckItemList=n}))},getDefaultCheckItem:function(){var t=this;if(this.isAdd)return x.a.getDefaultCheckItem(this.checkItemList).then((function(e){console.log({res:e}),t.currentCheckItem=e}))},getCheckPoints:function(e){var i=this,n=this.currentCheckItem.id;return n?x.a.getCheckPoints(n).then((function(n){return console.log({res:n}),t.each(n,(function(t){t.is_open=!0,t.enter_content=""})),i.setMMKVModel(n),i.emptyCheckPoints=n,i.isAdd&&(i.checkPointDetail=n),e&&!i.isAdd&&(i.model={pile_address:"",partners:[],cc:[],accepts:[],status:"待移交",created_on:c()().format("YYYY-MM-DD HH:mm:ss")},i.checkPointDetail=n),n})):Promise.resolve()},getUserOptions:function(){var t=this;return x.a.getUserOptions(this.project.id).then((function(e){t.userOptions=e,console.log({user:e})}))},openCheckItem:function(){var e=this;this.checkItemList.length?(this.isHint=t.some(this.checkPointDetail,(function(t){return e.isPointHasContent(t)})),this.$refs["pile-picker"].open()):r.a.alert("桩基类型为空")},changeCheckItem:function(t,e){var i=this;if(console.log({value:t}),e)return this.currentCheckItem=t,x.a.setDefaultCheckItem(t).then((function(){return i.getCheckPoints(!0).then((function(){return I.remove(w).then((function(){i.hasDarft=!1}))}))}))},togglePoint:function(t){this.$set(t,"is_open",!t.is_open)},hasProcessAcceptData:function(){var e=t.some(this.checkPointDetail,(function(t){return!!t.id})),i=!t.isEmpty(this.model.partners),n=!t.isEmpty(this.model.cc);return e||i||n},checkPileAddressEffective:function(){if(!this.model.pile_address)return s.a.reject("请先填写桩号");if("待验收"===this.model.status)return s.a.resolve();var t=[this.buildingInfo.buildingId,this.currentCheckItem.id,this.pileAcceptId,this.model.pile_address],e=t[0],i=t[1],n=t[2],a=t[3];return x.a.isPileAddressExist(e,i,n,a).then((function(t){if(t)return s.a.reject("此桩号已存在，请重新输入")}))},doFuncWhenPileAddressCheckPass:function(t,e){this.checkPileAddressEffective().then((function(){e&&e()})).catch((function(t){r.a.alert(t)}))},saveCustomLocation:function(){var t=this;if(this.model.pile_address)return this.saving=!0,this.saveDraft().finally((function(){t.saving=!1}))},changeImage:function(t){console.log({point:t}),t.id=t.id||p.a.uuid(),t.pile_accept_id=this.pileAcceptId,this.saveDraft(),_.a.clear()},prepareTakePicture:function(e){this.$route.query.id=this.pileAcceptId,console.log(this.$route.query),_.a.save({module:"pile-accept",details:t.clone(this.checkPointDetail),point:e,pile_address:this.model.pile_address,checkItemId:this.currentCheckItem.id,partners:this.model.partners,cc:this.model.cc,created_on:this.model.created_on,pileAcceptId:this.pileAcceptId})},cancelTakePicture:function(){_.a.clear()},changePartners:function(){this.saveDraft()},changeCC:function(){this.saveDraft()},saveDraft:function(){var t=this;return s.a.when().then((function(){return t.checkPileAddressEffective()})).then((function(){return I.save(w)})).then((function(){t.isAdd=!1})).catch((function(t){return r.a.alert(t),s.a.reject(t)}))},saveLocal:function(){var e=this,i=t.cloneDeep(this.model);return console.log({modelCopy:i}),s.a.when().then((function(){return e.checkPileAddressEffective()})).then((function(){return e.saveProcessAccept()})).then((function(){var i=[];return t.each(e.checkPointDetail,(function(t){i.push(e.saveDetail(t))})),s.a.all(i)})).then((function(){return e.savePartners(i.partners)})).then((function(){return e.saveCC(i.cc)})).then((function(){return _.a.clear()})).then((function(){return I.remove(w)})).then((function(){return s.a.resolve()})).catch((function(t){return console.error(t),r.a.alert(t),s.a.reject(t)}))},save:function(){var t=this;if(!this.saving)return this.saveDraft().then((function(){return r.a.alert("保存成功").then((function(){t.$router.go(-1)}))}));$log.log("正在保存主表。。。")},isPointHasContent:function(t){return t.enter_type===y.a.IMAGE?t.image_file&&t.image_file.length:!!"".concat(t.enter_content).trim()},_isFillFilter:function(t){return t.filter((function(t){return!!t.is_fill}))},submit:function(){var e=this,i=t.cloneDeep(this.model);return console.log({modelCopy:i}),i.pile_address?this.checkPileAddressEffective().then((function(){var i=e._isFillFilter(e.checkPointDetail),n=t.every(i,(function(t){return e.isPointHasContent(t)}))?"已验收":"待验收";console.log("提交时状态：",n);if("已验收"!==n)return r.a.confirm("确认提交？",{okText:"提交",cancelText:"取消"}).then((function(t){t&&e.submitPileAccept(n)}));e.showSubmitMenu=!0})).catch((function(t){console.error(t),r.a.alert(t)})):r.a.alert("请先填写桩号")},submitPileAccept:function(t){var e=this;return this.saveLocal().then((function(){return x.a.submit(e.pileAcceptId,t).then((function(){return r.a.alert("提交成功").then((function(){return k.a.saveTodo({biz_id:e.pileAcceptId,type:2,module_code:"pile-accept",proj_id:e.project.id}).then((function(t){console.log("插入待办",t)}))})).then((function(){e.$router.go(-1)}))}))}))},submitProcess:function(t){var e=t.status;this.submitPileAccept(e),this.showSubmitMenu=!1},deleteMMKV:function(){var t=this;return r.a.confirm("确认删除？").then((function(e){if(e)return I.remove(w).then((function(){return r.a.alert("删除成功").then((function(){t.$router.go(-1)})).then((function(){k.a.removeTodo(t.pileAcceptId)}))}))}))},saveProcessAccept:function(){var t={id:this.pileAcceptId,proj_id:this.project.id,bidsection_id:this.buildingInfo.sectionId,item_id:this.currentCheckItem.id,building_id:this.buildingInfo.buildingId,status:this.model.status||"待移交",pile_data:this.buildingInfo.pointXY,accept_by:this.curUser.user_id,pile_address:this.model.pile_address,created_on:this.model.created_on,created_by:this.curUser.user_id,process_mode:this.process_mode};return s.a.when().then((function(){return x.a.updateAccept(t)}))},saveDetail:function(e){var i=this;if(t.isEmpty(e))return s.a.when();e.enter_type===y.a.IMAGE?e.enter_content="":e.image_file=[];var n={id:e.id,title:e.title,checkpoint_id:e.checkpoint_id,content:e.content,image_file:Object(l.o)(e.image_file||[]),sort:e.sort,is_open:e.is_open?1:0,pile_accept_id:e.pile_accept_id,enter_type:e.enter_type,enter_content:e.enter_content,enter_type_option:e.enter_type_option,is_fill:e.is_fill};return s.a.when().then((function(){return n.pile_accept_id=n.pile_accept_id||i.pileAcceptId,x.a.saveAcceptDetail(n)})).then((function(t){return e.id=t,t}))},savePartners:function(e){if(!e.length)return Promise.resolve();var i=t.map(e,(function(t){return{id:t.id,type:"同验人"}}));return x.a.saveAcceptUsers(this.pileAcceptId,i,"同验人",this.model.status)},saveCC:function(e){if(!e.length)return Promise.resolve();var i=t.map(e,(function(t){return{id:t.id,type:"抄送人"}}));return x.a.saveAcceptUsers(this.pileAcceptId,i,"抄送人",this.model.status)},setMMKVModel:function(e,i){var n=t.extend(this.model,{primaryKeys:this.primaryKeys,checkPointDetail:e,pile_data:this.buildingInfo.pointXY,buildingId:this.buildingInfo.buildingId,checkItemId:this.currentCheckItem.id});i&&(n.checkItemId=i.checkItemId,n.pile_address=i.pile_address,n.partners=i.partners,n.cc=i.cc,n.created_on=i.created_on,console.log({mmkvModel:n})),I.config({buildingId:this.buildingInfo.buildingId,model:n,modelKeys:["primaryKeys","checkPointDetail","partners","cc","pile_address","pile_data","buildingId","checkItemId","created_on"]})}}}}).call(this,i("391c"))},"9fea":function(t,e,i){"use strict";i.r(e);var n=i("9b03").a,a=(i("8072"),i("4e37"),i("17cc")),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{title:"桩基验收","show-go-root":!0}},[i("check-guide",{attrs:{slot:"header-bar-right","item-id":t.currentCheckItem.id},slot:"header-bar-right"}),t.isLoading?t._e():i("scroller",{staticClass:"footer-blank"},[i("div",{staticClass:"list process-accept-detail-header"},[i("h4",{staticClass:"process-accept-detail-title f18 color-black"},[t._v(t._s(t.buildingInfo.sectionName)+"("+t._s(t.project.name)+")")]),i("p",{staticClass:"process-accept-detail-content"},[t._v("楼栋："+t._s(t.buildingInfo.buildingName))]),"待移交"!==t.model.status?i("p",{staticClass:"process-accept-detail-content"},[t._v("类型："+t._s(t.currentCheckItem.name))]):t._e(),"待移交"!==t.model.status?i("p",{staticClass:"process-accept-detail-content"},[t._v("桩号："+t._s(t.model.pile_address))]):t._e()]),t.isView?[i("div",{staticClass:"list bg-white process-accept-detail-list"},t._l(t.checkPointDetail,(function(e,n){return i("div",{key:n},[i("div",{staticClass:"item-base border-none process-accept-detail-item-header"},[i("i",{staticClass:"process-accept-icon-sys"}),e.is_fill?i("i",{staticClass:"required-icon"},[t._v("*")]):t._e(),i("div",{staticClass:"item-text"},[t._v(t._s(e.title))])]),i("div",{staticClass:"process-accept-entrys-viewer"},[e.enter_type===t.CHECKPOINT_ENTER_TYPE.IMAGE?i("item-img-list",{attrs:{editabled:!1,group:"process-accept-view"},model:{value:e.image_file,callback:function(i){t.$set(e,"image_file",i)},expression:"point.image_file"}}):i("div",[t._v("\n              "+t._s(e.enter_content)+"\n            ")]),e.enter_type===t.CHECKPOINT_ENTER_TYPE.IMAGE&&(!e.image_file||0===e.image_file.length)||e.enter_type!==t.CHECKPOINT_ENTER_TYPE.IMAGE&&!e.enter_content?i("div",{staticClass:"no-entry-text"},[t._v("\n              未录入\n            ")]):t._e()],1),e.content?i("div",{staticClass:"pl15 pr15 pb10"},[i("div",{staticClass:"process-accept-point-content"},[t._v("\n              "+t._s(e.content)+"\n            ")])]):t._e()])})))]:["待移交"===t.model.status?i("item",{staticClass:"pile-type",attrs:{label:"桩基类型",mode:"view",border:"bottom","icon-right":"arrow-right",text:t.currentCheckItem.name},on:{click:t.openCheckItem}}):t._e(),t.isLoading?t._e():i("loading-status",{staticStyle:{height:"calc(100% - 100px)"},attrs:{"is-empty":!t.checkPointDetail.length,"empty-text":"PC端未设置验收点"}}),"待移交"===t.model.status?i("item",{directives:[{name:"show",rawName:"v-show",value:t.checkPointDetail.length,expression:"checkPointDetail.length"}],attrs:{label:"桩号",mode:"edit"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.model.pile_address,expression:"model.pile_address"}],staticClass:"input-align-r f16",attrs:{slot:"right",type:"text",maxlength:"50",placeholder:"请输入"},domProps:{value:t.model.pile_address},on:{blur:t.saveCustomLocation,input:function(e){e.target.composing||t.$set(t.model,"pile_address",e.target.value)}},slot:"right"})]):t._e(),t._l(t.checkPointDetail,(function(e,n){return i("div",{key:n,staticClass:"list bg-white process-accept-edit-content"},[i("div",{staticClass:"item-base",class:{"border-none":!e.is_open},on:{click:function(i){t.togglePoint(e)}}},[i("i",{staticClass:"process-accept-icon-sys"}),e.is_fill?i("i",{staticClass:"required-icon"},[t._v("*")]):t._e(),i("div",{staticClass:"item-text"},[t._v(t._s(e.title))]),i("van-icon",{attrs:{name:e.is_open?"arrow-up":"arrow-down"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.is_open,expression:"point.is_open"}]},[e.enter_type===t.CHECKPOINT_ENTER_TYPE.IMAGE?i("div",{staticClass:"process-accept-detail-img-list border-none"},[i("item-img-list",{attrs:{maxlength:15,"prepare-callback":function(){return t.prepareTakePicture(e)},"cancel-callback":function(){return t.cancelTakePicture(e)},editabled:!t.isView,"user-link":!0,"before-edit":t.checkPileAddressEffective,group:"process-accept-edit","track-text":"桩基验收"},on:{callback:function(i){t.changeImage(e)}},model:{value:e.image_file,callback:function(i){t.$set(e,"image_file",i)},expression:"point.image_file"}})],1):t._e(),e.enter_type===t.CHECKPOINT_ENTER_TYPE.NUMBER?i("div",{staticClass:"process-accept-detail-input-wrapper"},[i("van-field",{staticClass:"text-right",attrs:{clearable:"",type:"number",label:"输入数字",placeholder:"请输入"},on:{input:function(){return e.enter_content=t.numberFormatter(e.enter_content)},blur:function(i){t.doFuncWhenPileAddressCheckPass(e,t.saveDraft)}},model:{value:e.enter_content,callback:function(i){t.$set(e,"enter_content",i)},expression:"point.enter_content"}})],1):t._e(),e.enter_type===t.CHECKPOINT_ENTER_TYPE.TEXT?i("div",{staticClass:"process-accept-detail-input-wrapper"},[i("van-field",{attrs:{clearable:"","show-word-limit":"",maxlength:200,type:"textarea","label-width":0,placeholder:"请输入文本"},on:{blur:function(i){t.doFuncWhenPileAddressCheckPass(e,t.saveDraft)}},model:{value:e.enter_content,callback:function(i){t.$set(e,"enter_content",i)},expression:"point.enter_content"}})],1):t._e(),e.enter_type===t.CHECKPOINT_ENTER_TYPE.DATE?i("item",{staticClass:"item-margin-bottom",attrs:{mode:"edit",label:"选择日期",text:e.enter_content,editabled:!0},on:{click:function(i){t.doFuncWhenPileAddressCheckPass(e,(function(){return t.showDatetimePicker(e)}))}}}):t._e(),e.enter_type===t.CHECKPOINT_ENTER_TYPE.DATETIME?i("item",{staticClass:"item-margin-bottom",attrs:{mode:"edit",label:"选择时间",text:e.enter_content,editabled:!0},on:{click:function(i){t.doFuncWhenPileAddressCheckPass(e,(function(){return t.showDatetimePicker(e,"datetime")}))}}}):t._e(),e.enter_type===t.CHECKPOINT_ENTER_TYPE.RADIO?i("item",{staticClass:"item-margin-bottom",attrs:{mode:"edit",label:"选择选项",text:e.enter_content,editabled:!0},on:{click:function(i){t.doFuncWhenPileAddressCheckPass(e,(function(){return t.showTextPicker(e)}))}}}):t._e()],1),e.content&&e.is_open?i("div",{staticClass:"pl15 pr15 pb10"},[i("div",{staticClass:"process-accept-point-content"},[t._v("\n            "+t._s(e.content)+"\n          ")])]):t._e()])}))],"待移交"!==t.model.status?i("div",{staticClass:"list bg-white"},t._l(t.model.accepts,(function(e,n){return i("div",{key:n,staticClass:"process-accept-user-list"},[i("user-select",{attrs:{title:0===n?"验收人":"",date:t._f("formatDate")(e.created_on),mode:"view",editabled:!1},model:{value:t.model.accepts[n],callback:function(e){t.$set(t.model.accepts,n,e)},expression:"model.accepts[index]"}})],1)}))):t._e(),i("user-select",{directives:[{name:"show",rawName:"v-show",value:t.checkPointDetail.length,expression:"checkPointDetail.length"}],attrs:{options:t.userOptions,title:"共同验收人",multi:!0,mode:t.isView?"view":"edit",editabled:!t.isView,"before-select":t.checkPileAddressEffective,"before-open":t.checkPileAddressEffective,required:!1},on:{onSelect:t.changePartners},model:{value:t.model.partners,callback:function(e){t.$set(t.model,"partners",e)},expression:"model.partners"}}),i("user-select",{directives:[{name:"show",rawName:"v-show",value:t.checkPointDetail.length,expression:"checkPointDetail.length"}],attrs:{options:t.userOptions,title:"抄送人",multi:!0,mode:t.isView?"view":"edit",editabled:!t.isView,"before-select":t.checkPileAddressEffective,"before-open":t.checkPileAddressEffective,required:!1,memory:!0},on:{onSelect:t.changeCC},model:{value:t.model.cc,callback:function(e){t.$set(t.model,"cc",e)},expression:"model.cc"}}),!t.isView&&t.hasDarft?i("div",{staticClass:"content-bottom-btn-con mt20"},[i("button",{staticClass:"btn-text-blue",on:{click:t.deleteMMKV}},[t._v("删除此草稿")])]):t._e()],2),t.isView?t._e():i("app-button-group",{directives:[{name:"show",rawName:"v-show",value:t.checkPointDetail.length,expression:"checkPointDetail.length"}],attrs:{"fixed-bottom":"",seamless:""}},[i("app-button",{staticStyle:{width:"35%"},attrs:{plain:"","active-text":"暂存"},on:{click:function(e){t.save()}}},[t._v("暂存")]),i("app-button",{staticClass:"btn",attrs:{"active-text":"正在操作"},on:{click:t.submit}},[t._v("提交")])],1),"待移交"!==t.model.status?i("loading-status",{attrs:{"is-loading":t.isLoading}}):t._e(),i("pile-picker",{ref:"pile-picker",attrs:{current:t.currentCheckItem,"check-list":t.checkItemList,"is-hint":t.isHint},on:{selected:t.changeCheckItem}}),i("van-action-sheet",{attrs:{actions:t.submitActions,"cancel-text":"取消","get-container":"body",round:!0},on:{cancel:function(e){t.showSubmitMenu=!1},select:t.submitProcess},model:{value:t.showSubmitMenu,callback:function(e){t.showSubmitMenu=e},expression:"showSubmitMenu"}}),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showSelectDatePopup,callback:function(e){t.showSelectDatePopup=e},expression:"showSelectDatePopup"}},[i("van-datetime-picker",{attrs:{type:t.datetimeType,title:"date"===t.datetimeType?"日期":"",formatter:t.datetimePickerFormatter},on:{confirm:t.datePickerConfirmHandler,cancel:t.datePickerCancelHandler},model:{value:t.selectDateValue,callback:function(e){t.selectDateValue=e},expression:"selectDateValue"}})],1),i("text-picker",{ref:"text-picker"})],1)}),[],!1,null,"1cbc8ca0",null);e.default=o.exports},ad2c:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .list[data-v-1cbc8ca0]{margin-bottom:10px}.zjapp .item-base[data-v-1cbc8ca0]{align-items:center;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .item-base[data-v-1cbc8ca0] .van-icon{position:relative;display:block;padding-right:10px;margin-right:-10px;width:34px;height:34px;line-height:34px;text-align:right;font-size:20px;color:#c8c8c8}.zjapp .btn[data-v-1cbc8ca0]{border-radius:0}.zjapp .btn-link[data-v-1cbc8ca0]{background:#fff;color:#4275e8}.zjapp .item.pile-type[data-v-1cbc8ca0] .item-label-gray{color:#333}.zjapp .item.pile-type[data-v-1cbc8ca0] .item-text{text-align:right}",""])},b9cd:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a}));var n={IMAGE:"image",NUMBER:"number",TEXT:"text",DATE:"date",RADIO:"radio",DATETIME:"datetime"},a={CONSTRUCTION:31,SUPERVISING:32,DEVELOPMENT:33}},c9b6:function(t,e,i){"use strict";(function(t){i("e697");var n=i("e2a7");e.a={name:"PilePicker",props:{checkList:{type:Array,default:function(){return[]}},current:{type:Object,default:function(){}},isHint:{type:Boolean,default:!1}},data:function(){return{show:!1,options:[],children:[],value:{}}},methods:{open:function(){var e=this;this.show=!0;var i=t.clone(this.current),n=t.clone(this.checkList);if(console.log({current:i}),t.isEmpty(i))n[0].subitem&&n[0].subitem[0]?(i=n[0].subitem[0],this.children=n[0].subitem,this.value=n[0].subitem[0]):(i=n[0],this.value=n[0]);else{var a=t.find(n,(function(t){return t.id===i.parent_id}));this.children=a.subitem||[],this.value=i}t.each(n,(function(n){e.$set(n,"checked",i.parent_id===n.id),t.each(n.subitem,(function(t){e.$set(t,"checked",i.id===t.id)}))})),this.options=n},openChild:function(e){this.children=e.subitem;var i=this.options;t.each(i,(function(i){i.checked=e.id===i.id,t.each(i.subitem,(function(t){t.checked=!1}))}))},selectChildren:function(e){var i=this;this.value=e;var n=this.children;t.each(n,(function(t){i.$set(t,"checked",e.id===t.id)})),this.confirm()},confirm:function(){var e=this;return t.isEmpty(this.value)?n.a.alert("请选择桩基类型"):this.isHint&&this.current.id!==this.value.id?n.a.confirm("您已录入数据，切换桩基类型会清除掉这些数据，确认切换吗？",{okText:"确认",cancelText:"取消"}).then((function(t){t&&(e.show=!1,e.$emit("selected",e.value,!0))})):(this.show=!1,void this.$emit("selected",this.value,this.current.id!==this.value.id))}}}}).call(this,i("391c"))},ce26:function(t,e,i){var n=i("ad2c");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("09577964",n,!0,{sourceMap:!1,shadowMode:!1})},d1d1:function(t,e,i){"use strict";(function(t){var n=i("fd50"),a=i("bcc7"),o=i("515e"),c=i("07d2"),s=i("7bac"),r=i("a7c3"),l=i("4360");e.a={name:"CheckGuideList",components:{Item:c.default},store:l.a,data:function(){return{isLoading:!0,listData:[],module:"",itemId:"",batchId:"",sectionId:"",options:""}},computed:{moduleAttribute:function(){return this.$store.state.global.moduleAttribute}},methods:{init:function(e){var i,a=this;for(var o in this.module=e.module,this.itemId=e.itemId,this.batchId=e.batchId,this.sectionId=e.sectionId,this.options=e.options,e)this[o]=e[o];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module];var c=!1;t.isEmpty(this.itemId)?!t.isEmpty(this.checkType)&&t.isEmpty(this.sectionId)?i=this.initByType():t.isEmpty(this.batchId)?t.isEmpty(this.options)?t.isEmpty(this.sectionId)?i=n.a.when():(c=!0,i=this.initByBidsection()):i=this.initByOptions():i=this.initByBatch():i=this.initById(),this.isLoading=!0,i.then((function(e){var i=a.moduleAttribute[a.module]||{};!t.isEmpty(i)&&i.setUsualItems&&c?s.a.getUserKey(a.mmkvCode()).then((function(t){t=null===t?e:a.mergeArray(a.deepClone(e),t),a.listData=t||[],a.isLoading=!1})):(a.listData=e||[],a.isLoading=!1)}))},mmkvCode:function(){var t=this.moduleAttribute[this.module]||{};return r.a[t.mmkv_item]+"_"+this.sectionId},mergeArray:function(e,i){var n=this;return t.filter(e,(function(e){var a=i[e.id];return t.isEmpty(e.subitem)||(e.subitem=n.mergeArray(e.subitem,i)),!t.isEmpty(a)||"desc"===e.type}))},clickItem:function(t){t.subitem&&t.subitem.length?this.$set(t,"isOpen",!t.isOpen):"special-inspect"===this.module?o.a.openPopup({itemId:t.id,module:this.module}):o.a.openPopup({itemId:t.item_id,module:this.module})},initById:function(){var t=this;if("special-inspect"!==this.module)return a.a.getCheckItem(this.itemId,this.checkType).then((function(e){return e?t.sectionId?a.a.getBidSectionCheckItemListByCode(t.sectionId,e.code):a.a.getCheckItemTreeByCode(e.code):n.a.when()}))},initByType:function(){return a.a.getCheckItemGuidelineList(this.checkType)},initByBatch:function(){return n.a.when()},initByBidsection:function(){return a.a.getBidSectionCheckItemTreeByType(this.sectionId,this.checkType)},initByOptions:function(){return n.a.resolve(this.options)},deepClone:function(t){return JSON.parse(JSON.stringify(t))}}}}).call(this,i("391c"))},dc98:function(t,e,i){"use strict";i("0732")},e6e2:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,'.zjapp .popup-title[data-v-653ff8ec]{display:flex;align-items:center;justify-content:center;height:44px;padding:0 15px}.zjapp .popup-title .left-button[data-v-653ff8ec],.zjapp .popup-title .right-button[data-v-653ff8ec]{font-size:14px;color:#666}.zjapp .popup-title .right-button[data-v-653ff8ec]{color:#4981ff}.zjapp .popup-title .title-name[data-v-653ff8ec]{font-size:16px;color:#333}.zjapp .popup-content[data-v-653ff8ec]{display:flex;height:calc(100% - 44px)}.zjapp .popup-content .list[data-v-653ff8ec]{flex:1;background:#fff;overflow:auto}.zjapp .popup-content .list[data-v-653ff8ec]:last-child{background:#fafafa}.zjapp .popup-content .list .list-item[data-v-653ff8ec]{position:relative;font-size:14px;color:#333;border-color:#fff;padding:12px 10px}.zjapp .popup-content .list .list-item.checked[data-v-653ff8ec]{color:#4981ff;border-color:#4981ff}.zjapp .popup-content .list .list-item.checked[data-v-653ff8ec]:after{content:"";position:absolute;left:10px;right:10px;bottom:6px;width:calc(100% - 20px);height:1px;background:#4981ff}',""])},e79f:function(t,e,i){var n=i("841f");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("329f2521",n,!0,{sourceMap:!1,shadowMode:!1})},e9ea:function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".zjapp .guide-box[data-v-ff0679ce]{flex:1;display:flex}.zjapp .page-scroll[data-v-ff0679ce]{flex:1;overflow:auto;padding-bottom:100px;transform:translateZ(0)}.zjapp .sublist[data-v-ff0679ce]{padding-left:25px;padding-top:1px;background-color:#fff}.zjapp .sublist>.sublist[data-v-ff0679ce]{padding-left:10px;padding-top:0}",""])},ef1c:function(t,e,i){var n=i("e9ea");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,i("85cb").default)("2e832052",n,!0,{sourceMap:!1,shadowMode:!1})},f1e4:function(t,e,i){"use strict";(function(t){i("5ab2"),i("e10e");var n=i("28f8"),a=(i("9e76"),i("6d57"),i("9a33"),i("f548"),i("cc57"),i("4ad6")),o=i("e89f"),c=i("bcc7"),s=i("3122"),r=i("6e1b"),l=i("c130"),d=i("0636");function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.a={name:"CheckGuideDetail",components:{},mixins:[o.a],data:function(){return{show:!1,isLoading:!0,isImageDownloading:!1,title:"",content:[],module:"",itemId:""}},methods:{openPopup:function(e){var i=this;for(var n in this.value=!0,this.show=!0,this.module=e.module,this.itemId=e.itemId,this.$emit("open"),e)this[n]=e[n];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module],this.isLoading=!0,("special-inspect"===this.module?r.a.getSpecialInspectCheckItemDetail(this.itemId):"templet-plan"===this.module?l.a.getTempletDetail(this.itemId):"material"===this.module?d.a.getMaterialDetail(this.itemId):c.a.getCheckItem(this.itemId,this.checkType)).then((function(e){console.log("checkitemData",e),e=e||{},i.checkitemData=e,i.title=e.full_name||e.name,"special-inspect"!==i.module&&"inspect"!==i.module&&"fly-inspect"!==i.module&&"material"!==i.module||(e.content=e.guideline||e.content);var n=e.content?e.content.trim():"";if(n=(n=(n=(n=(n=n.replace(/<\/p><p>/gm,"\n")).replace(/<p>/gm,"")).replace(/<\/p>/gm,"")).replace(/<br>/gm,"")).replace(/<br \/>/gm,""),/(<img[^\>]*>)/gm.test(n)){var a=n.split(/(<img[^\>]*>)/gm);(a=a.filter((function(t){return!!t}))).forEach((function(t,e){t&&!/^\s*\n/.test(t)&&e&&!/\n\s*$/.test(a[e-1])&&(a[e]="\n"+t)})),n=a.join("")}var o=n?n.split("\n"):[];i.content=t.map(o,(function(t,e){var i;if(/<img([\s\S]*)>/gm.test(t)){var n=t.split(/\ssrc="([^"]*)"/gm)[1],a=n?n.match(/[\w|-]{36}/gm)[0]:(new Date).getTime()+"-"+e;i={isImg:!0,src:"",url:n,status:"pending",id:a,ready:!0}}else i={isImg:!1,val:t};return i})),i.downloadImage(),i.isLoading=!1})).catch((function(t){$log.log(t)}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},getThumbnail:function(t){return"pending"===t.status?s.a.IMAGE_LOADING:"rejected"===t.status?s.a.IMAGE_RELOAD:"dev"===APP_ENV?t.url:"fulfilled"===t.status?t.src:($log.log("检查指引-显示图片：",t),s.a.IMAGE_PLACEHOLD)},imgError:function(t,e){$log.error("检查指引-加载图片出现错误：",t);var i=u({},t);i.status="rejected",this.$set(this.content,e,i)},downloadImage:function(e){var i=this;e=e?[e]:this.imageList(),t.each(e,(function(e){var n=u({},e),a=t.map(i.content,(function(t){return t.id})).indexOf(e.id);s.a.isNeedDownload(e.url).then((function(t){t?s.a.download(e.url).then((function(t){n.status="fulfilled",n.src=s.a.fixUrl(t),i.$set(i.content,a,n)})).catch((function(t){$log.error("检查指引-下载图片：",t)})):(n.status="fulfilled",n.src=s.a.fixUrl(s.a.getPathFromUrl(e.url)),i.$set(i.content,a,n))}))}))},imageList:function(){return t.filter(this.content,(function(t){return t.isImg}))},imgClick:function(e){var i=this;if("pending"===e.status)return!1;if("rejected"===e.status)return this.downloadImage(e),$log.log("检查指引-点击重新加载-重新下载图片：",e),!1;var n=this.imageList(),o=t.map(n,(function(t){return t.id})).indexOf(e.id);n=t.map(n,(function(t){return i.getThumbnail(t)})),a.a.openImageBrowser(n,o)}}}}).call(this,i("391c"))},f369:function(t,e,i){"use strict";var n=i("fd50"),a=i("bcc7"),o=i("329b"),c=i("d1d1").a,s=(i("3411"),i("17cc")),r={name:"CheckGuideList",components:{GuideList:Object(s.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"guide-box"},[!t.isLoading&&t.listData.length?i("div",{staticClass:"page-scroll"},t._l(t.listData,(function(e,n){return i("div",{key:n},[i("item",{attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text fw-b color-blue one-line"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,n){return i("div",{key:n,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,n){return i("div",{key:n,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,n){return i("div",{key:n,staticClass:"sublist"},[i("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(i){t.clickItem(e)}}},[i("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])])],1)})):t._e()],2)})):t._e()],2)})):t._e()],2)}))):t._e(),i("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.listData.length,"empty-text":"没有检查项"}})],1)}),[],!1,null,"ff0679ce",null).exports},mixins:[i("e89f").a],data:function(){return{show:!1}},methods:{openPopup:function(t){var e=this;this.value=!0,this.show=!0,this.$nextTick((function(){e.$refs["guide-list"].init(t),e.$emit("open")}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")}}},l=Object(s.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"slide-right"}},[this.show?e("page-content",{attrs:{mode:"dialog",title:"检查指引","on-close":this.closePopup}},[e("guide-list",{ref:"guide-list"})],1):this._e()],1)}),[],!1,null,null,null).exports,d=!1;d||(d=new(o.default.extend(l))({el:document.createElement("div")}),document.body.appendChild(d.$el));var p=d,u=i("515e"),h=i("91c1").a,f=(i("dc98"),Object(s.a)(h,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"main",style:{top:t.contentTop+"px"}},[i("i",{staticClass:"arrow"}),i("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePopup(e)}}},[i("transition",{attrs:{name:"slide-down"},on:{enter:function(e){t.isOpening=!0},"after-enter":function(e){t.isOpening=!1},leave:function(e){t.isClosing=!0},"after-leave":t.afterClose}},[t.showList?i("div",{staticClass:"box",style:{height:t.listHeight+"px"}},t._l(t.data,(function(e,n){return i("div",{key:n,class:{"border-bottom":t.data.length>1,"box-single":1===t.data.length}},[i("div",{staticClass:"detail-hd",class:{"border-bottom":t.data.length<=1,"detail-hd-single":t.data.length<=1},on:{click:function(i){t.toggleItem(e)}}},[t.data.length>1?i("i",{class:{"detail-arrow-right":!e.isOpen,"detail-arrow-down":e.isOpen}}):t._e(),i("div",{staticClass:"detail-title"},[t._v(t._s(e.name))])]),t.data.length<=1||e.isOpen?i("div",{staticClass:"detail-bd",class:{"detail-bd-single":t.data.length<=1}},[t._l(e.textArr,(function(e,n){return i("p",{key:n,staticClass:"text-line"},[t._v("\n              "+t._s(e)+"\n            ")])})),i("item-img-list",{attrs:{editabled:!1},model:{value:e.contentImage,callback:function(i){t.$set(e,"contentImage",i)},expression:"item.contentImage"}}),i("loading-status",{attrs:{"is-empty":!e.textArr.length&&!e.contentImage.length,"empty-text":"PC端未设置检查指引"}})],2):t._e()])}))):t._e()])],1)]):t._e()}),[],!1,null,"2cac8864",null).exports),m=!1;m||(m=new(o.default.extend(f))({el:document.createElement("div")}),document.body.appendChild(m.$el));var g=m,b={name:"CheckGuide",components:{},props:{module:{type:String,default:""},mode:{type:String,default:"page"},itemId:{type:String,default:""},itemIds:{type:Array,default:function(){return[]}},batchId:{type:String,default:""},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}},optionsPromise:{type:Function,default:function(){}},beforeOpen:{type:Function,default:function(){}}},data:function(){return{isLoading:!1}},methods:{openCheckGuide:function(){var t=this,e=this.beforeOpen&&this.beforeOpen();e instanceof Promise||(e=Promise.resolve(e)),e.then((function(e){!1!==e&&("drop"===t.mode?g.openPopup({itemIds:t.itemIds,el:t.$refs["check-guide-btn"],options:t.options}):("templet-plan"===t.module?n.a.when(!1):t.itemId&&t.sectionId?a.a.hasChildSectionCheckItem(t.itemId,t.sectionId):t.itemId?a.a.hasChildCheckItem(t.itemId):n.a.when(!0)).then((function(e){e?p.openPopup({module:t.module,itemId:t.itemId,batchId:t.batchId,sectionId:t.sectionId,options:t.options}):u.a.openPopup({itemId:t.itemId,module:t.module})})))}))}}},v=Object(s.a)(b,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"check-guide-btn",staticClass:"header-btn",on:{click:function(e){t.openCheckGuide()}}},[i("icon",{attrs:{name:"nav-info"}})],1)}),[],!1,null,null,null);e.a=v.exports}}]);