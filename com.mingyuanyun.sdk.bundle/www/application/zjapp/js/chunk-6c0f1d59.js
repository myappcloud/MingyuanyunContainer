(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-6c0f1d59","chunk-0b5b35be","chunk-59fa3e5d","chunk-3adbbd26","chunk-2b8a39de","chunk-606c3122"],{"03dc":function(t,e,a){var i=a("924b");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("1b37f6c6",i,!0,{sourceMap:!1,shadowMode:!1})},"0416":function(t,e,a){"use strict";a("068e")},"04f2":function(t,e,a){var i=a("90a0");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("067c3858",i,!0,{sourceMap:!1,shadowMode:!1})},"068e":function(t,e,a){var i=a("771c");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("1ce02ce6",i,!0,{sourceMap:!1,shadowMode:!1})},"0732":function(t,e,a){var i=a("81f2");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("1b5b07de",i,!0,{sourceMap:!1,shadowMode:!1})},"0831":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-340d7e0d]{height:100%;overflow:auto}.zjapp .brand-info[data-v-340d7e0d]{background-color:#fff;padding:15px 15px 0 15px;font-size:16px}.zjapp .brand-name[data-v-340d7e0d]{color:#4275e8;padding-bottom:10px}.zjapp .brand-type[data-v-340d7e0d]{color:#333;padding:10px 0 10px 10px}.zjapp .brand-spec[data-v-340d7e0d],.zjapp .brand-type[data-v-340d7e0d]{display:flex;justify-content:space-between}.zjapp .brand-spec[data-v-340d7e0d]{padding:10px 0 10px 30px}.zjapp .van-popup--right[data-v-340d7e0d]{width:100%;height:100%}",""])},"0eb4":function(t,e,a){var i=a("9459");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("2cf709ed",i,!0,{sourceMap:!1,shadowMode:!1})},"10d4":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .multi-select-list-title[data-v-89cd976c]{position:relative;color:#888;font-size:14px;line-height:30px;min-height:40px;margin-bottom:0;margin-top:0;padding:8px 16px;background-color:#f2f2f2}.zjapp .item[data-v-89cd976c]{padding:16px}.zjapp .search-item>div[data-v-89cd976c]{padding-right:35px}.zjapp .search-item i[data-v-89cd976c]{position:absolute;color:#ccc;font-size:26px;right:0;top:50%;transform:translateY(-50%)}.zjapp .van-popup--right[data-v-89cd976c]{width:100%;height:100%}[data-v-89cd976c] .van-cell__title{color:#4174e9;font-weight:700}[data-v-89cd976c] .van-collapse-item__content{transform:translateZ(0);padding:0 0 0 25px}[data-v-89cd976c] .van-collapse-item__content .van-cell{padding-left:0}",""])},"11fa":function(t,e,a){"use strict";a("745e")},"170e":function(t,e,a){var i=a("f205");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("4eac5dbe",i,!0,{sourceMap:!1,shadowMode:!1})},1869:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .task-wrap[data-v-7b880d47]{padding-bottom:80px}",""])},"299f":function(t,e,a){var i=a("8b97");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("692b574b",i,!0,{sourceMap:!1,shadowMode:!1})},"29be":function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e");var i=a("28f8"),n=(a("cc57"),a("163d"),a("07d2")),o=a("a5c6"),r=a("6144");function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"SingleSelect",components:{Item:n.default},props:{title:{type:String,default:""},border:{type:String,default:""},pageTitle:{type:String,default:""},placeholder:{type:String,default:""},value:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},optionsDisabled:{type:Array,default:function(){return[]}},required:{type:Boolean,default:!0},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},beforeOpen:{type:Function,default:function(){}},searchBar:{type:Boolean,default:!0},grouping:{type:String,default:""},autoOpen:{type:Boolean,default:!1},rightBtn:{type:String,default:""},rightBtnEvent:{type:Function,default:function(){return 0}},ifToggle:{type:Boolean,default:!1},formCheck:{type:Boolean,default:!1},editorAddData:{type:Boolean,default:!1},lineLimit:{type:[Number,String],default:1}},data:function(){return{memoryKey:this.$route.name+encodeURI(this.title)}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var e=this;if(this.editabled){var a=this.beforeOpen();a&&a.then&&t.isFunction(a.then)?a.then((function(t){!1!==t&&e.openPopup()})):!1!==a&&this.openPopup()}},openPopup:function(){var e=this;if(this.optionsDisabled&&this.optionsDisabled.length){var a={};t.each(this.optionsDisabled,(function(t){t.id&&(a[t.id]=t)})),t.each(this.options,(function(t,i){a[t.id]?e.options[i].disabled=!0:e.options[i].disabled=!1}))}o.a.openPopup({title:this.pageTitle||"选择"+this.title,selected:this.value,options:this.options,required:this.required,searchBar:this.searchBar,grouping:this.grouping,autoOpen:this.autoOpen,rightBtn:this.rightBtn,ifToggle:this.ifToggle,lineLimit:this.lineLimit,editorAddData:this.editorAddData,onSelect:function(a){var i=t.cloneDeep(e.value);a=t.isArray(a)?t.map(a,(function(t){return c({},t)})):c({},a),e.$emit("input",a,i),e.$emit("onSelect",a,i)},rightBtnEvent:function(a){var i=t.cloneDeep(e.value);e.$emit("rightBtnEvent",a,i)}})},closePopup:function(){o.a.closePopup()},onSelect:function(t){r.a.saveObject(this.memoryKey,t,r.a.level.user),this.$emit("input",t[0]),this.$emit("onSelect",t[0])},setSelected:function(){var e=r.a.getObject(this.memoryKey,r.a.level.user);!1===this.editabled||t.isEmpty(this.options)||(t.isEmpty(this.value)?this.memory&&!t.isEmpty(e)&&t.some(this.options,{id:e.id})&&(this.$emit("input",e),this.autoSelect&&this.$emit("onSelect",e)):this.autoSelect&&this.$emit("onSelect",this.value))}}}}).call(this,a("391c"))},"2c76":function(t,e,a){"use strict";a("c070")},"2d6e":function(t,e,a){var i=a("7eb2");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("53a2fbaa",i,!0,{sourceMap:!1,shadowMode:!1})},"2dd6":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .single-item[data-v-6920dde7]{min-height:44px}.zjapp .single-item>div[data-v-6920dde7]{display:flex}.zjapp .single-item>div>span[data-v-6920dde7]{flex:1;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical}.zjapp .single-item>div>span[data-v-6920dde7] label{color:#4174e9}.zjapp .single-item i[data-v-6920dde7]{line-height:24px;font-size:24px;color:#4275e8}.zjapp .single-item .disabled-item[data-v-6920dde7]{color:#aaa}",""])},"2ddb":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .supplier-editor[data-v-e465319c]{margin-bottom:10px;padding:8px;display:flex;justify-content:space-between;align-items:center;height:52px;color:#4275e8;background-color:#fff}.zjapp .supplier-editor .icon[data-v-e465319c]{border-left:1px solid #c8c8c8;padding-left:12px}.zjapp .supplier-editor .icon-edit[data-v-e465319c]{color:#c8c8c8;font-size:18px}.zjapp .supplier-editor .icon-qualified[data-v-e465319c]{color:#4275e8}.zjapp .supplier-editor .margin-r[data-v-e465319c]{margin-right:10px}.zjapp .list-title[data-v-e465319c]{position:relative;top:0;color:#888;font-size:14px;line-height:30px;min-height:40px;margin-bottom:0;margin-top:0;padding:8px 16px 2px}.zjapp .search-item>div[data-v-e465319c]{padding-right:35px}.zjapp .search-item i[data-v-e465319c]{position:absolute;color:#ccc;font-size:26px;right:0;top:50%;transform:translateY(-50%)}.zjapp .van-popup--right[data-v-e465319c]{width:100%;height:100%}[data-v-e465319c] .van-cell__title{color:#4174e9;font-weight:700}[data-v-e465319c] .van-collapse-item__content{transform:translateZ(0);padding:0 0 0 25px}[data-v-e465319c] .van-collapse-item__content .van-cell{padding-left:0}",""])},"2dea":function(t,e,a){var i=a("10d4");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("d2d2cc46",i,!0,{sourceMap:!1,shadowMode:!1})},"2e2c":function(t,e,a){"use strict";a("0eb4")},"2e84":function(t,e,a){"use strict";a("cc57");var i=a("07d2"),n=a("cd05"),o=a("5a71"),r={name:"MaterialDetailTast",components:{Item:i.default,UserSelect:n.a,SingleSelect:o.a},props:{model:{type:Object,default:function(){return{}}},taskData:{type:Object,default:function(){return{}}},deleteTask:{type:Function},editTask:{type:Function}},data:function(){return{reason:""}},computed:{selectedMaterialType:function(){var t=[];return this.taskData.materialType&&this.taskData.materialType.map((function(e){t.push(e.name)})),t.join("、")},editAuthority:function(){return!!this.$store.state.user.isSuper||this.model.batchData&&this.model.batchData.task_base&&this.model.user.user_id===this.model.batchData.task_base.created_by},deleteAuthority:function(){return!!this.$store.state.user.isSuper||!(!this.editAuthority||"待申请进场"!==this.model.batchData.status)}},methods:{saveTask:function(){}}},s=(a("cb44"),a("17cc")),c=Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-wrap"},[t.taskData.shipping_no?a("item",{attrs:{label:"送货单",text:t.taskData.shipping_no}}):t._e(),a("item",{attrs:{label:"所属标段",text:t.taskData.section&&t.taskData.section.name}}),a("item",{attrs:{label:"材料名称",text:t.taskData.material&&t.taskData.material.name}}),t.selectedMaterialType?a("item",{attrs:{label:"材料类型",text:t.selectedMaterialType}}):t._e(),a("item",{attrs:{label:"使用部位",text:t.taskData.place||"无"}}),a("item",{attrs:{label:"材料供应商",text:t.taskData.supplier?t.taskData.supplier.name:"无"}}),t.taskData.contract&&t.taskData.contract.id&&t.taskData.contract.name?a("item",{attrs:{label:"所属合同",text:t.taskData.contract?t.taskData.contract.name:"无"}}):t._e(),t.taskData.remark?a("item",{attrs:{label:"补充说明",text:t.taskData.remark}}):t._e(),a("user-select",{attrs:{title:"接收人",mode:"view",editabled:!1},model:{value:t.taskData.receiver,callback:function(e){t.$set(t.taskData,"receiver",e)},expression:"taskData.receiver"}}),a("single-select",{attrs:{title:"接收单位",mode:"view",editabled:!1},model:{value:t.taskData.contractor,callback:function(e){t.$set(t.taskData,"contractor",e)},expression:"taskData.contractor"}}),a("user-select",{attrs:{title:"监理",mode:"view",editabled:!1},model:{value:t.taskData.checker,callback:function(e){t.$set(t.taskData,"checker",e)},expression:"taskData.checker"}}),t.taskData.needConstructer?a("user-select",{attrs:{title:"建设单位验收人",mode:"view",multi:!0,editabled:!1},model:{value:t.taskData.constructers,callback:function(e){t.$set(t.taskData,"constructers",e)},expression:"taskData.constructers"}}):t._e(),t.taskData.isAreaCheckOn?a("user-select",{attrs:{title:"区域验收人",mode:"view",multi:!0,editabled:!1},model:{value:t.taskData.areaCheckers,callback:function(e){t.$set(t.taskData,"areaCheckers",e)},expression:"taskData.areaCheckers"}}):t._e(),a("user-select",{attrs:{title:"抄送人",mode:"view",multi:!0,editabled:!1},model:{value:t.taskData.cc,callback:function(e){t.$set(t.taskData,"cc",e)},expression:"taskData.cc"}}),a("user-select",{attrs:{title:"创建人",date:t._f("formatDate")(t.taskData.created_on),mode:"view",editabled:!1},model:{value:t.taskData.creater,callback:function(e){t.$set(t.taskData,"creater",e)},expression:"taskData.creater"}}),t.taskData.sendback_reason?a("item",{attrs:{label:"退回原因",text:t.taskData.sendback_reason}}):t._e(),(t.editAuthority||t.deleteAuthority)&&"view"===t.model.taskMode?a("app-button-group",[t.deleteAuthority?a("app-button",{attrs:{type:"warning",plain:"",rimless:""},on:{click:t.deleteTask}},[t._v("\n      删除\n    ")]):t._e(),t.editAuthority?a("app-button",{on:{click:t.editTask}},[t._v(" 修改 ")]):t._e()],1):t._e()],1)}),[],!1,null,"7b880d47",null);e.a=c.exports},"2f9d":function(t,e,a){"use strict";(function(t){var i=a("fc9f");e.a={getTemplateDirs:function(t){return i.a.query("select * from template_manage_dirs where parent_id = ? order by pinyin, name",[t])},getDirsAndCount:function(t,e){return i.a.query('select tmd.* ,                 (select count(1) from template_manage tm                     join template_manage_projs tmp on tmp.template_manage_id = tm.id                     where tmp.proj_id = ? and tm.code like tmd.code || ".%"                 ) as file_count                 from template_manage_dirs tmd where tmd.parent_id = ? order by pinyin, name',[t,e])},getTemplateList:function(t,e){return i.a.query("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and tm.template_manage_dir_id = ? order by tm.pinyin, tm.name ",[t,e])},updateDownloadTime:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r="replace into template_manage_local (id, download_time, name, url, local_download_time) values (?, ?, ?, ?, ?)";return i.a.executeSql(r,[t,e,a,n,o])},getMaterialTemplate:function(t,e){return i.a.queryOne("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and material_id = ? ",[t,e])},getProcessTemplate:function(t,e){return i.a.queryOne("select tm.*, tml.download_time from template_manage tm                 join template_manage_projs tmp on tmp.template_manage_id = tm.id                 left join template_manage_local tml on tm.id = tml.id                 where tmp.proj_id = ? and tm.process_check_id = ? ",[t,e])},getRecord:function(t){return i.a.queryOne("select * from template_manage where id = ?",[t])},getLocal:function(t){return i.a.query("select * from template_manage_local")},delLocalByIds:function(e){t.isArray(e)||(e=[e]);var a="DELETE FROM template_manage_local WHERE id in ("+t.map(e,(function(t){return"'"+t+"'"})).join(", ")+")";return i.a.executeSql(a)}}}).call(this,a("391c"))},"308d":function(t,e,a){"use strict";a("04f2")},"30c7":function(t,e,a){"use strict";a("69c5")},"3103b":function(t,e,a){"use strict";a("768c")},"3156b":function(t,e,a){"use strict";a("163d");var i={name:"SingleSelectItem",props:{item:{type:Object,default:function(){return{id:"",name:""}}},checked:{type:Boolean,default:!1},renderField:{type:String,default:"name"},lineLimit:{type:[Number,String],default:1}},methods:{selectItem:function(t){t.disabled||this.$emit("click",t)}}},n=(a("9788"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-cell",{staticClass:"single-item",attrs:{clickable:!0},on:{click:function(e){t.selectItem(t.item)}}},[a("span",{class:{"disabled-item":t.item.disabled},style:{"-webkit-line-clamp":"unlimited"===t.lineLimit?"initial":t.lineLimit},domProps:{innerHTML:t._s(t.item[t.renderField])}}),t.checked?a("van-icon",{attrs:{name:"success"}}):t._e()],1)}),[],!1,null,"6920dde7",null);e.a=o.exports},3411:function(t,e,a){"use strict";a("ef1c")},3730:function(t,e,a){"use strict";var i=a("329b"),n=a("b65c").a,o=(a("50d5e"),a("17cc")),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{attrs:{title:t.title,mode:"dialog","on-close":t.closeEvent}},[t.rightBtn?a("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:function(e){t.checkBoxAliRight?t.submit():t.rightBtnEvent(t.category)}},slot:"header-bar-right"},[t._v(t._s(t.checkBoxAliRight?t.rightBtn+"("+t.realChecked.length+")":t.rightBtn))]):t._e(),a("scroller",{staticClass:"bg-white",attrs:{"has-next":!t.searchStatus&&!t.grouping&&t.optionsLimit<t.options.length,"end-text":"","is-empty":0===t.optionsShow.length},on:{loadNext:t.pageOptions}},[t.searchBar?a("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":t.storageKey},on:{changeSearchStatus:t.onSearchTypeChange,input:t.onInput},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):t._e(),t.showSelected&&(t.searchStatus&&t.isHasVal||!t.searchStatus)?a("div",[a("div",{staticClass:"multi-select-list-title"},[t._v("已选")]),a("div",{staticClass:"item"},[t._v(t._s(t.selectedNames||"请选择"))])]):t._e(),t.listTile&&(t.searchStatus&&t.isHasVal||!t.searchStatus)?a("div",{staticClass:"multi-select-list-title"},[t._v("全部")]):t._e(),t.searchStatus?[t.keyword?[t.grouping?a("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.searchData,(function(e,i){return a("van-collapse-item",{key:i,attrs:{title:e.name,name:i}},t._l(e.children,(function(e,i){return a("item",{key:i,attrs:{checked:!!t.checkedItem[e.id],item:e,"render-field":"rename"},on:{click:t.selectItem}})})))}))):t._l(t.searchData,(function(e,i){return a("item",{key:i,attrs:{checked:!!t.checkedItem[e.id],item:e,disabled:e.disabled,"render-field":"rename"},on:{click:t.selectItem}})}))]:t._e()]:[t.grouping?a("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.optionsShow,(function(e,i){return a("van-collapse-item",{key:i,attrs:{title:e.name,name:i}},[t._l(e.children,(function(e,i){return a("item",{key:i,attrs:{checked:!!t.checkedItem[e.id],item:e},on:{click:t.selectItem}})})),t._v("\n            "+t._s(e.id)+"\n          ")],2)}))):t._l(t.optionsShow,(function(e,i){return a("item",{key:i,attrs:{checked:!!t.checkedItem[e.id],item:e,"align-right":t.checkBoxAliRight,disabled:e.disabled},on:{click:t.selectItem}})})),t.optionsShow.length?t._e():a("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容",type:"search"}})]],2),t.checkBoxAliRight?t._e():a("app-button-group",{staticClass:"ctrl",attrs:{"fixed-bottom":""}},[a("app-button",{on:{click:t.submit}},[t._v("提交")])],1)],1):t._e()],1)}),[],!1,null,"89cd976c",null).exports,s=!1;s||(s=new(i.default.extend(r))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},"3c64":function(t,e,a){"use strict";a("163d");var i={name:"ItemTextarea",components:{},props:{value:{type:String,default:""},placeholder:{type:String,default:""},maxlength:{type:Number,default:200},borderBottom:{type:Boolean,default:!0}},data:function(){return{textareaHeight:40,isLock:!1,blurTime:null}},computed:{lastLength:function(){var t=this.value&&this.value.length||0,e=this.maxlength-t;return e>0?e:0}},mounted:function(){var t=this;this.$nextTick((function(){t.textareaHeight=t.$refs.rule&&t.$refs.rule.offsetHeight||40}))},methods:{onfocus:function(){var t=(new Date).getTime();this.blurTime&&t-this.blurTime<300&&window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(this.$refs.input.blur(),window.cordova.plugins.Keyboard.close()),this.blurTime=null,this.$emit("focus")},onblur:function(){this.blurTime=(new Date).getTime(),this.$emit("blur")},setStatus:function(t){console.log(t),this.isLock=t},oninput:function(t){var e=this;setTimeout((function(){if(!e.isLock){var a=t.target.value;a.length>e.maxlength&&(a=a.substring(0,e.maxlength),e.$refs.input.value=a),e.$refs.rule.innerText=a,e.textareaHeight=e.$refs.rule&&e.$refs.rule.offsetHeight+20,e.$emit("input",a),e.$emit("change",a)}}),0)}}},n=(a("2c76"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item-textarea",class:{"border-bottom":t.borderBottom}},[a("div",{staticClass:"item-textarea-content"},[a("textarea",{ref:"input",style:{height:t.textareaHeight+"px"},attrs:{placeholder:t.placeholder},domProps:{value:t.value},on:{focus:t.onfocus,blur:t.onblur,compositionstart:function(e){t.setStatus(!0)},compositionend:function(e){t.setStatus(!1)},input:t.oninput}}),a("div",{ref:"rule",staticClass:"rule"},[t._v("\n      "+t._s(t.value)+"\n    ")]),t.maxlength!==1/0?a("p",{staticClass:"counter"},[t._v("\n      "+t._s(t.lastLength)+"\n    ")]):t._e()])])}),[],!1,null,null,null);e.a=o.exports},"3ccf":function(t,e,a){"use strict";(function(t){a("e697");var i=a("b23b"),n=(a("cc57"),a("fd50")),o=a("6bf2"),r=a.n(o),s=a("e2a7"),c=a("5e1b"),l=a("aab3"),d=a("0636"),p=a("59f8"),u=a("07d2"),h=a("3c64"),m=a("e68e"),f=a("88c7"),g=a("6948"),b=a("cd66"),v=a("774b"),k=a("cd05");e.a={name:"MaterialDetailApproach",components:{Item:u.default,ItemImgList:m.a,ItemTextarea:h.a,MultiSelect:f.a,NumberInput:g.a,MaterialInfoSelect:b.a,UserSelect:k.a,Scroller:v.default},props:{isSupervision:{type:Boolean},isIeceiverPhotoType:{type:Boolean,default:!1},model:{type:Object,default:function(){return{}}},approachData:{type:Object,default:function(){return{}}},batchData:{type:Object,default:function(){return{}}},ccList:{type:Array},revoke:{type:Function,default:function(){return 0}},pushInSaveStack:{type:Function},prepareTakePicture:{type:Function},approachSaveDetail:{type:Function}},data:function(){return{show:!0,hadBrand:!0,selectType:{},allowCustomBrand:!1,allowCustomType:!1,allowCustomSpec:!1,isSubmitData:!1}},computed:{constructers:function(){var t=[];return this.approachData.constructers.map((function(e){t.push(e.name)})),t.join("、")},areaChecker:function(){var t=[];return this.batchData.task_base&&this.batchData.task_base.areaCheckers&&this.batchData.task_base.areaCheckers.map((function(e){t.push(e.name)})),t.join("、")},brandList:function(){return this.approachData.brands}},created:function(){var e=this;console.log("打开了页面。。。。。。。。。。。"),t.map(this.approachData.brands,(function(t){t.standard;var e=Object(i.a)(t,["standard"]);t.selectedBrand=e})),p.a.getValue("allow_add_material_via_app").then((function(t){e.allowCustomBrand="1"===t||"0"===t?"1"===t:"1"===JSON.parse(t).MATERIAL_BRAND})),p.a.getValue("allow_add_material_via_app").then((function(t){e.allowCustomType="1"===t||"0"===t?"1"===t:"1"===JSON.parse(t).MATERIAL_TYPE})),p.a.getValue("allow_add_material_via_app").then((function(t){e.allowCustomSpec="1"===t||"0"===t?"1"===t:"1"===JSON.parse(t).MATERIAL_FORMAT}))},methods:{onSelectBrands:function(t,e){this.hadBrand=!1,t.id=e.id,t.name=e.name,this.hadBrand=!0,this.pushInSaveStack("approachSaveDetail")},onMaterialTypeSelect:function(){this.pushInSaveStack("approachSaveDetail")},onSelectSpecification:function(e,a){e.specification=t.map(a,(function(a){var i=t.find(e.specification,{id:a.id});return{id:a.id,name:a.name,num:(i?i.num:"")||""}})),this.pushInSaveStack("approachSaveDetail")},selectApproachDate:function(){var t=this;c.a.openPopup({inputDate:r()(this.approachData.date).toDate(),callback:function(e){t.approachData.date=r()(e).format("YYYY-MM-DD"),t.pushInSaveStack("approachSaveLog")}})},addStandard:function(t){console.log("新增类型"),t.standard||this.$set(t,"standard",[]),t.standard.push({data:{},num:""}),this.pushInSaveStack("approachSaveDetail")},removeType:function(t,e){console.log(this.approachData),t.standard.splice(e,1),$log.log("删除类型"),this.pushInSaveStack("approachSaveDetail")},removeSpec:function(t,e,a,i){t.splice(e,1),a.specification=t,this.pushInSaveStack("approachSaveDetail")},addBrands:function(){this.approachData.brands||this.$set(this.approachData,"brands",[]),this.approachData.brands.push({standard:[]}),this.pushInSaveStack("approachSaveDetail")},removeBrand:function(t){console.log(this.approachData),this.approachData.brands.splice(t,1),this.pushInSaveStack("approachSaveDetail")},approachSubmit:function(){var e=this;return this.revoke().then((function(){e.isSubmitData=!0;var a=JSON.parse(JSON.stringify(e.approachData));if(t.some(a.brands,(function(t){return!t.id})))return n.a.reject("请选择品牌");if(t.some(a.brands,(function(e){return t.some(e.standard,(function(t){return!t.id}))})))return n.a.reject("请选择类型");var i=[];if(t.each(a.brands,(function(e){i=i.concat(t.map(e.standard,"id"))})),t.some(a.brands,(function(e){return t.some(e.standard,(function(t){return t.specificationList&&t.specificationList.length&&(!t.specification||!t.specification.length)}))})))return n.a.reject("请选择规格");if(t.some(a.brands,(function(e){return t.some(e.standard,(function(e){return e.specification&&e.specification.length?t.some(e.specification,(function(t){return void 0===t.num||null===t.num||""===t.num})):void 0===e.num||null===e.num||""===e.num}))})))return n.a.reject("请添加所有的数量");t.each(a.brands,(function(e){/^custom\-[\d]+$/.test(e.id)&&(e.id=""),t.each(e.standard,(function(e){/^custom\-[\d]+$/.test(e.id)&&(e.id=""),t.each(e.specification||[],(function(t){/^custom\-[\d]+$/.test(t.id)&&(t.id="")}))}))}));var o=e.model.supplyData.shipping_image;return e.model.supplyData.id&&0===o.length?n.a.reject("请添加供货单照片"):(console.log("数据 ---------\x3e ",t.cloneDeep(a)),l.a.getAreaCheckerSetting(e.batchData.task_base.bidsection_id,i).then((function(e){a.area_acceptor=t.map(e.checkers,"id").join(",")})).then((function(){return d.a.updateApproach(t.clone(e.batchData),a,e.isIeceiverPhotoType,e.model.supplyData)})))})).then((function(){return window.setTimeout((function(){e.isSubmitData=!1,e.$emit("onSubmitSuccess")}),100)})).catch((function(t){return console.log(t),t&&s.a.alert(t)}))}}}}).call(this,a("391c"))},"3e47":function(t,e,a){"use strict";(function(t){a("e697"),a("9e76"),a("cc57"),a("6d57"),a("ed63"),a("8cf2");var i=a("fd50"),n=a("e2a7"),o=a("ed08"),r=a("4ad6"),s=a("3122"),c=a("162a"),l=a("a078"),d=a("2f9d"),p=a("4360"),u=a("a18c"),h=a("6bf2"),m=a.n(h),f=a("4daa"),g={},b=[],v={},k=[],y={_downloadTemplate:function(t,e,a){if(t in g)return y._checkQueue();var s=a,u=o.a.formatFiletypes(s),h=r.a.appDataPath()+"template",f=h+"/"+t+"."+u,b=i.a.defer(),k=g[t]=v[t]=v[t]||{progress:0},_=p.a.state.templateManage.support_bimface.includes(u);return _&&(f+=".zip"),k.promise=b.promise,$log.log("download url",s),$log.log("download localPath",f),c.a.startBackgroundTask(),c.a.canUpdate(!1).then((function(){return r.a.isFileExists(h)})).then((function(t){return t?r.a.isFileExists(f).then((function(t){if(t)return r.a.deleteFile(f)})):r.a.mkdir(h)})).then((function(){return k.progress=0,r.a.downloadFile(s,f).then((function(e){if($log.log("service ext",u),_){var a=h+"/"+t;return $log.log("localUnzipPath",a),r.a.isFileExists(a).then((function(t){if(t)return r.a.deleteFile(a)})).then((function(){return r.a.unzipFile(f,a).catch((function(){return i.a.reject("使用此功能请升级到最新版本")}))})).then((function(){return r.a.deleteFile(f)})).then((function(){return a}))}return e})).then((function(i){return b.resolve(i),k.download_time=k.upload_time,k.progress=-1,d.a.updateDownloadTime(t,k.upload_time,e,a,m()().format("YYYY-MM-DD HH:mm")).then((function(){return delete g[t],y._checkQueue()}))}),null,(function(t){k.progress=t,b.notify(t)}))})).catch((function(e){return k.progress=-1,e&&r.a.getAppFullVersion().then((function(t){t.fullVersion=t.fullVersion.slice(0,5),1===o.a.versionCompare("3.0.5",t.fullVersion)?n.a.popBoxExt({content:"使用此模块需更新APP到最新版",buttons:["取消","去更新"],cssClass:"popup-app-update",callback:function(t,e){switch(t){case 0:_btnSelected="cancel",$ionicBackdrop.release();break;case 1:$ionicBackdrop.release(),r.a.getDeviceInfo().then((function(t){var e="Android"===t.platform?l.a.appUpdate.Android:l.a.appUpdate.IOS;r.a.openUrlInBrowser(e)})),e.preventDefault(),_btnSelected="update"}}}):($log.error("下载错误: ",e),n.a.alert(e))})),delete g[t],b.reject(e),y._checkQueue()})).finally((function(){c.a.finishBackgroundTask()})),b.promise},downloadSingleTemplate:function(t,e,a){var s,l=a;if(t in g)return s=n.a.topProcess({title:$rootScope.isIPhoneFullScreen?"下载中":"正在下载文件...",successTitle:"下载完成"}),g[t].promise.then(null,null,(function(t){s.loading(t)})).finally((function(){s.close()}));var u=o.a.formatFiletypes(l),h=r.a.appDataPath()+"template",f=h+"/"+t+"."+u,b=g[t]=v[t]=v[t]||{},k=p.a.state.templateManage.support_bimface.includes(u);return k&&(f+=".zip"),b.progress=0,s=n.a.topProcess({title:$rootScope.isIPhoneFullScreen?"下载中":"正在下载文件...",successTitle:"下载完成"}),c.a.beginManualUpdate(),c.a.startBackgroundTask(),b.promise=c.a.canUpdate(!1).then((function(){return r.a.isFileExists(h)})).then((function(t){return t?r.a.isFileExists(f).then((function(t){if(t)return r.a.deleteFile(f)})):r.a.mkdir(h)})).then((function(){return r.a.downloadFile(l,f).then((function(e){if(k){var a=h+"/"+t;return r.a.isFileExists(a).then((function(t){if(t)return r.a.deleteFile(a)})).then((function(){return r.a.unzipFile(f,a)})).then((function(){return r.a.deleteFile(f)})).then((function(){return a}))}return e})).then((function(i){return b.download_time=b.upload_time,b.progress=-1,d.a.updateDownloadTime(t,b.upload_time,e,a,m()().format("YYYY-MM-DD HH:mm")).then((function(){delete g[t]}))}),null,(function(t){b.progress=t,s.loading(t)}))})).catch((function(e){return s.close(),b.progress=-1,delete g[t],e?($log.error("下载错误: ",e),i.a.reject(e)):i.a.reject("下载样板发生错误")})).finally((function(){s.close(),c.a.finishBackgroundTask(),c.a.endManualUpdate()}))},fetchBimfaceSupported:function(){var t="bimface_mime_type";return c.a.post("/setting/get-setting-value",null,{code:[t]}).then((function(e){try{return JSON.parse(e[t])}catch(t){return[]}}))},addDownloadQueue:function(t,e,a){if(!g[t]){b.push({id:t,name:e,url:a}),v[t]=v[t]||{progress:0},v[t].progress=0;var n=i.a.defer();return y._checkQueue().then(null,null,(function(t){return n.notify(t)})),n.promise}},_checkQueue:function(){if(!b.length)return c.a.endManualUpdate(),i.a.when();var e=t.keys(g).length;if(e>=3)return i.a.when();0===e&&c.a.beginManualUpdate();var a=i.a.defer(),n=b.shift(),o=n.id,r=n.name,s=n.url;return y._downloadTemplate(o,r,s).then((function(t){return a.resolve(t)}),null,(function(t){return a.notify(t)})),a.promise},getTemplateListCount:function(t,e){return i.a.all([d.a.getTemplateDirs(e),d.a.getTemplateList(t,e)]).then((function(t){return t[0].concat(t[1]).length}))},getTemplateList:function(e,a){return $log.log(e,"projId"),i.a.all([d.a.getDirsAndCount(e,a),d.a.getTemplateList(e,a)]).then((function(e){var a=e[0],i=e[1];return t.each(a,(function(t){t.file_type="folder",t.child_num=t.file_count})),t.each(i,(function(t){v[t.id]=v[t.id]||{progress:-1},v[t.id].download_time=t.download_time,v[t.id].upload_time=t.upload_time,t.downloadInfo=v[t.id],t.file_size=o.a.formatFilesize(t.file_size),t.file_type=t.url&&t.url.match(/[^\.]+$/)?t.url.match(/[^\.]+$/)[0]:"",t.child_num=1})),a.concat(i)}))},openTemplate:function(t,e,a){return new Promise((function(i,n){var c=o.a.formatFiletypes(a),l=p.a.state.templateManage.support_bimface.includes(c),d=r.a.appDataPath()+"template/"+t+"."+c;"pdf"===c||"docx"===c||"doc"===c||"xls"===c||"xlsx"===c||"ppt"===c||"pptx"===c?r.a.openPDF(d,e).then((function(t){i(t)})).catch((function(t){n(t)})):"jpg"===c||"jpeg"===c||"png"===c?r.a.openImageBrowser([s.a.fixUrl(d)],0).then((function(t){i(t)})).catch((function(t){n(t)})):l?(d=r.a.appDataPath()+"template/"+t,$log.log("localPath",d),$log.log("name",e),u.a.push({path:"/bimface",query:{mode:"view",layout:"fullScreen",url:d,name:e,ext:c}}),i()):n("未知的文件类型")}))},getMaterialTemplate:function(t,e){var a={projId:t,materialId:e};return Object(f.a)(a).then((function(t){var e=t&&t.length?t[0]:null;return e&&(v[e.id]=v[e.id]||{progress:-1},v[e.id].download_time=e.download_time,v[e.id].upload_time=e.upload_time,e.downloadInfo=v[e.id],e.file_size=o.a.formatFilesize(e.file_size)),e}))},getProcessTemplate:function(t,e){var a={projId:t,processId:e};return Object(f.b)(a).then((function(t){var e=t&&t.length?t[0]:null;return e&&(v[e.id]=v[e.id]||{progress:-1},v[e.id].download_time=e.download_time,v[e.id].upload_time=e.upload_time,e.downloadInfo=v[e.id],e.file_size=o.a.formatFilesize(e.file_size)),e}))},openDirs:function(t,e){return y.getTemplateList(t,e.id).then((function(a){var o=$rootScope.$new();o.listConllection=a||[],k.push(o),o.title=e.name,o.close=function(t){if(t)for(;k.length;)k.pop().modal.remove();else k.pop().modal.remove()},$ionicModal.fromTemplateUrl("templates/template-manage/template-list.html?v=20190415",{scope:o,animation:"slide-in-right"}).then((function(t){o.modal=t,o.modal.show()})),o.openDOC=function(){var e=this.item;if("folder"===e.file_type)return y.openDirs(t,e);e.downloadInfo.progress<0&&e.downloadInfo.download_time===e.downloadInfo.upload_time&&y.openTemplate(e.id).catch((function(t){n.a.alert(t)}))},o.uploadCallback=function(){y.getTemplateList(t,e.id).then((function(t){o.listConllection=t||[]}))},o.downloadTemplate=function(t,e,a){a&&a.stopPropagation();var n=this;i.a.when().then((function(){a.target.style.display="none"})).then((function(){n.item.downloadInfo.progress=0})).then((function(){setTimeout((function(){y.addDownloadQueue(t,e)}),10)}))}}))},_getTemplateList:function(e){var a=e.projId,n=e.parent_id,r=e.keywords,s=e.mtime_sort,l=e.name_sort;return i.a.all([c.a.post("/template-manage/list",{proj_id:a,parent_id:n,keywords:r,mtime_sort:s,name_sort:l}),y._getLocalTemplateList()]).then((function(e){var a=e[0].list.filter((function(t){return t.is_dir})),i=e[0].list.filter((function(t){return!t.is_dir})),n=e[1];return t.each(a,(function(t){t.file_type="folder",t.child_num=t.docs_num})),t.each(i,(function(t){v[t.id]=v[t.id]||{progress:-1};var e=n.find((function(e){return e.id===t.id}));v[t.id].download_time=e?e.download_time:"",v[t.id].upload_time=t.upload_time,t.downloadInfo=v[t.id],t.file_size=o.a.formatFilesize(t.file_size),t.file_type=o.a.formatFiletypes(t.url||t.name),t.child_num=1})),a.concat(i)}))},_getLocalTemplateList:function(){return d.a.getLocal().then((function(t){return t.filter((function(t){return t.name&&t.url}))}))},removeTemplate:function(t){return d.a.delLocalByIds(t)},getViewToken:function(t){return c.a.post("/template-manage/get-view-token",null,{id:t})},coverterBimface:function(t){return new Promise((function(e,a){var i=20;!function n(){if(i<=0)return void a("timeout");var o=function(){setTimeout((function(){i--,n()}),2e3)};c.a.request("/template-manage/offline-data-uri",{id:t}).then((function(t){t?e(t):o()})).catch((function(){o()}))}()}))}};e.a=y}).call(this,a("391c"))},"3f00":function(t,e,a){var i=a("a14f");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("eb0bf718",i,!0,{sourceMap:!1,shadowMode:!1})},"41b9":function(t,e,a){var i=a("0831");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("65c37dc0",i,!0,{sourceMap:!1,shadowMode:!1})},"45dc":function(t,e,a){var i=a("624c");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("9f5f8384",i,!0,{sourceMap:!1,shadowMode:!1})},"45f4":function(t,e,a){var i=a("46a3");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("08fd193d",i,!0,{sourceMap:!1,shadowMode:!1})},"46a3":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-34524e4e]{display:flex;flex-direction:column;flex:1;padding-bottom:100px;height:100%;overflow:auto}.zjapp .content .picture[data-v-34524e4e]{padding-left:15px;padding-bottom:15px;background-color:#fff}.zjapp .content .title-name[data-v-34524e4e]{font-size:16px;padding:10px 0 10px 0}",""])},"46ae":function(t,e,a){"use strict";var i=a("e1e7").a,n=a("17cc"),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("item",{attrs:{label:t.title,text:t.text,mode:t.mode,editabled:t.editabled,placeholder:t.placeholder},on:{click:t.openSelect}},[t.$slots.right?t._t("right",null,{slot:"right"}):t._e()],2)}),[],!1,null,null,null);e.a=o.exports},"4bef":function(t,e,a){"use strict";a.r(e);var i=a("8fcf").a,n=(a("8827"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-content",{attrs:{"show-go-root":!0,title:t.model.batchData.task_name}},[a("template-guide",{attrs:{slot:"header-bar-right",module:"material","proj-id":t.taskInfo.proj_id,"connect-id":t.taskInfo.material_id},on:{queryHasTemplate:t.getTemplateStatus},slot:"header-bar-right"}),t.isShowTamplate?t._e():a("check-guide",{attrs:{slot:"header-bar-right",module:"material","item-id":t.taskInfo.material_id},slot:"header-bar-right"}),t.isLoading?t._e():a("div",{staticClass:"wrap detail-wrap",style:{height:t.viewSize.contentHeight+"px"}},[a("div",{staticClass:"tabs"},t._l(t.model.tabs,(function(e,i){return a("span",{key:i,class:{active:i===t.model.partIndex},on:{click:function(e){t.changeTabName(i)}}},[t._v(t._s(e)+"\n      ")])}))),-1!==t.initTabContent?a("van-swipe",{ref:"materialTabContent",staticClass:"swipe-content",attrs:{"show-indicators":!1,loop:!1,"initial-swipe":t.initTabContent},on:{change:t.changeTabContent}},[a("van-swipe-item",["edit"===t.model.taskMode?a("span",{staticClass:"edit-task"},[a("material-task-form",{attrs:{model:t.model,status:"edit","save-task":t.saveTask}})],1):a("material-detail-task",{attrs:{model:t.model,"task-data":t.model.taskData,"delete-task":t.deleteTask,"edit-task":t.editTask}})],1),a("van-swipe-item",[t.model.approachLoading||t.model.approachEmpty?t._e():["edit"===t.model.approachMode?a("material-detail-approach",{attrs:{model:t.model,"is-ieceiver-photo-type":t.isIeceiverPhotoType,"approach-data":t.model.approachData,"batch-data":t.model.batchData,"cc-list":t.model.ccList,"is-supervision":t.model.isSupervision,revoke:t.revoke,"prepare-take-picture":t.prepareTakePicture,"push-in-save-stack":t.pushInSaveStack,"approach-save-detail":t.approachSaveDetail},on:{onSubmitSuccess:t.approachSubmitSuccess}}):t._e(),"view"===t.model.approachMode?a("material-detail-approach-view",{attrs:{model:t.model,"cur-user-id":t.curUserId,"is-checker-photo-type":t.isCheckerPhotoType,"prepare-take-picture":t.prepareTakePicture,"push-in-save-stack":t.pushInSaveStack,"early-pass":t.earlyPass,"early-un-pass":t.earlyUnPass,"before-change-checker":t.beforeChangeChecker,"before-construter":t.beforeChangeConstruter},on:{changeChecker:t.changeEarlyChecker}}):t._e()],t.model.approachLoading||t.model.approachEmpty?a("loading-status",{attrs:{"is-loading":t.model.approachLoading,"is-empty":t.model.approachEmpty,"empty-text":"暂无进场记录"}}):t._e()],2),t.model.batchData.needCheck&&(!1!==t.model.earlyPass||t.model.batchData.hasCheckRecord)&&t.model.statusMap[t.model.batchData.status]>1?a("van-swipe-item",[t.model.checkLoading||t.model.checkEmpty?t._e():["edit"===t.model.checkMode?a("material-detail-check",{attrs:{model:t.model,"push-in-save-stack":t.pushInSaveStack,"prepare-take-picture":t.prepareTakePicture,"change-check-checker":t.changeCheckChecker,"check-submit":t.checkSubmit,"checker-list":t.model.checkerList}}):t._e(),"view"===t.model.checkMode?a("material-detail-check-view",{attrs:{model:t.model}}):t._e()],t.model.checkLoading||t.model.checkEmpty?a("loading-status",{attrs:{"is-loading":t.model.checkLoading,"is-empty":t.model.checkEmpty,"empty-text":t.model.batchData.needCheck?"暂无送检记录":"本批材料不需要送检"}}):t._e()],2):t._e(),t.model.batchData.needCheck&&(!1!==t.model.earlyPass||t.model.batchData.hasCheckRecord)&&t.model.statusMap[t.model.batchData.status]>1?a("van-swipe-item",["edit"!==t.model.reportMode||t.model.reportLoading||t.model.reportEmpty?t._e():a("material-detail-report",{attrs:{model:t.model,"push-in-save-stack":t.pushInSaveStack,"prepare-take-picture":t.prepareTakePicture,"change-report-checker":t.changeReportChecker,"report-submit":t.reportSubmit,"report-back":t.reportBack,"retest-submit":t.retestSubmit,"retest-back":t.retestBack}}),"view"!==t.model.reportMode||t.model.reportLoading||t.model.reportEmpty?t._e():a("material-detail-report-view",{attrs:{model:t.model}}),!t.model.reportLoading&&"待上传报告"===t.model.batchData.status&&t.model.reportEmpty&&t.model.reportData.checker?[a("user-select",{attrs:{title:"报告上传人",editabled:!1},model:{value:t.model.reportData.checker,callback:function(e){t.$set(t.model.reportData,"checker",e)},expression:"model.reportData.checker"}})]:t._e(),t.model.reportLoading||t.model.reportEmpty?a("loading-status",{attrs:{"is-loading":t.model.reportLoading,"is-empty":t.model.reportEmpty,"empty-text":t.model.batchData.needCheck?"暂无报告记录":"本批材料不需要送检"}}):t._e()],2):t._e(),!1===t.model.earlyPass?a("van-swipe-item",["edit"!==t.model.backMode||t.model.backLoading||t.model.backEmpty?t._e():a("material-detail-back",{attrs:{model:t.model,"push-in-save-stack":t.pushInSaveStack,"prepare-take-picture":t.prepareTakePicture,"change-back-checker":t.changeBackChecker,"back-submit":t.backSubmit}}),"view"!==t.model.backMode||t.model.backLoading||t.model.backEmpty?t._e():a("material-detail-back-view",{attrs:{model:t.model}}),t.model.backLoading||t.model.backEmpty?a("loading-status",{attrs:{"is-loading":t.model.backLoading,"is-empty":t.model.backEmpty,"empty-text":"暂无退场记录"}}):t._e()],1):t._e()],1):t._e()],1),a("loading-status",{attrs:{"is-loading":t.isLoading}}),a("material-task-void-dialog",{ref:"materialTaskVoidDialog",on:{submit:t.supplyOrderTaskVoid}})],1)}),[],!1,null,"73693d74",null);e.default=o.exports},"4daa":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return s}));var i=a("5e8d"),n=a("162a"),o=a("da71");function r(t){return Object(i.a)().then((function(){var e=o.a.processTemplate.url;return n.a.request(e,t)}))}function s(t){return Object(i.a)().then((function(){var e=o.a.materialTemplate.url;return n.a.request(e,t)}))}},"4e8c":function(t,e,a){"use strict";var i=a("329b"),n=a("b056").a,o=(a("30c7"),a("17cc")),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePopup(e)}}},[a("transition",{attrs:{name:"slide-up"},on:{enter:function(e){t.isOpening=!0},"after-enter":function(e){t.isOpening=!1},leave:function(e){t.isClosing=!0},"after-leave":t.afterClose}},[t.showList?a("div",{staticClass:"box",style:{height:t.listHeight+"px"}},[t.allowSearching?t._e():a("div",{staticClass:"hd border-bottom"},[t._v("\n        "+t._s(t.title)+"\n        "),a("icon",{attrs:{name:"unqualified"},on:{click:t.closePopup}})],1),t.allowSearch?a("app-search-bar",{ref:"app-search-bar-checkitem-select",staticClass:"bg-white",attrs:{"history-key":t.historyKey},on:{changeSearchStatus:t.setSearchMode},model:{value:t.searchKeyword,callback:function(e){t.searchKeyword=e},expression:"searchKeyword"}}):t._e(),t.renderData&&t.renderData.length?a("scroller",{ref:"scroller",attrs:{"has-next":t.hasNextPage},on:{loadNext:t.loadNext}},[a("div",{attrs:{id:"slideUpSelectDialog"}},t._l(t.renderData,(function(e){return a("item",{key:e.id,attrs:{"icon-right":e.id===t.selected.id?"qualified":"",border:"bottom"},on:{click:function(a){t.select(e)}}},[t.showNote?[a("div",{staticClass:"item-con"},[a("p",{staticClass:"text"},[t._v(t._s(e.name))]),a("p",{staticClass:"note"},[t._v(t._s(e[t.showNote]))])])]:a("div",{staticClass:"item-text",domProps:{innerHTML:t._s(t.keywordFilter(e.name))}})],2)})))]):t._e(),a("loading-status",{attrs:{"is-empty":!t.options||!t.options.length,type:"search","empty-text":t.emptyText}},[t.allowSearching&&t.allowSearch?a("template",{slot:"empty-text"},[t._v("\n          未搜索到包含"),a("span",{staticClass:"color-blue"},[t._v(t._s(t.searchKeyword))]),t._v("的结果\n        ")]):t._e()],2)],1):t._e()])],1):t._e()}),[],!1,null,"c4404120",null).exports,s=!1;s||(s=new(i.default.extend(r))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},"50d5e":function(t,e,a){"use strict";a("2dea")},"515e":function(t,e,a){"use strict";var i=a("329b"),n=a("f1e4").a,o=(a("0416"),a("17cc")),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{class:{"content-not-empty":t.content.length},attrs:{mode:"dialog",title:"检查指引","on-close":t.closePopup}},[!t.isLoading&&t.title?a("div",{staticClass:"check-guide-detail-hd border-bottom"},[a("h2",{staticClass:"check-guide-detail-title pb10"},[t._v(t._s(t.title))])]):t._e(),!t.isLoading&&t.content.length?a("div",{staticClass:"check-guide-detail-content"},t._l(t.content,(function(e,i){return a("p",{key:i},[e.isImg&&e.src?a("img",{class:{"img-not-ready":!e.ready,error:"rejected"===e.status},attrs:{src:t.getThumbnail(e)},on:{error:function(a){t.imgError(e,i)},click:function(a){t.imgClick(e)}}}):t._e(),e.isImg?t._e():a("span",[t._v("\n          "+t._s(e.val)+"\n        ")])])}))):t._e(),a("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.content.length,"empty-text":"PC端未设置检查指引"}})],1):t._e()],1)}),[],!1,null,"691b2f0f",null).exports,s=!1;s||(s=new(i.default.extend(r))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},"53bf":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .single-item[data-v-b3cb8602]{min-height:44px}.zjapp .single-item .checkbox[data-v-b3cb8602]{font-size:14px;color:transparent;text-align:center;line-height:inherit;width:20px;height:20px;box-sizing:border-box;border:1px solid #dcdcdc;transition:.2s;border-radius:100%;display:inline-block;vertical-align:middle}.zjapp .single-item .checkbox i[data-v-b3cb8602]{display:none}.zjapp .single-item .checkbox.checked[data-v-b3cb8602]{color:#fff;border-color:#1989fa;background-color:#1989fa}.zjapp .single-item .checkbox.checked i[data-v-b3cb8602]{display:inline-block}.zjapp .single-item .checkbox.disabled[data-v-b3cb8602]{border-color:#b2b2b2}.zjapp .single-item .checkboxtxt[data-v-b3cb8602]{flex:1;margin-left:8px}.zjapp .single-item .disabled-text[data-v-b3cb8602]{color:#b2b2b2}.zjapp .wrapper[data-v-b3cb8602]{display:flex;align-items:center}",""])},"574c":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .item-textarea{background-color:#fff;padding:5px 15px}.zjapp .item-textarea-content{position:relative}.zjapp .item-textarea .rule,.zjapp .item-textarea textarea{width:100%;min-height:40px;line-height:20px;font-size:16px;padding:0;border:none}.zjapp .item-textarea .rule{position:absolute;top:0;left:0;visibility:hidden;word-break:break-all}.zjapp .item-textarea .counter{text-align:right;margin:0 0 -5px 0;height:15px;line-height:15px;color:#b2b2b2;font-size:12px}",""])},"5a71":function(t,e,a){"use strict";var i=a("29be").a,n=a("17cc"),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("item",{class:t.required,attrs:{label:t.title,text:t.value&&t.value.id?t.value.name:"view"===t.mode?"无":"",mode:t.mode,editabled:t.editabled,placeholder:t.required?t.placeholder||"请选择":"选填","form-check":t.formCheck,border:t.border},on:{click:t.openSelect}})}),[],!1,null,null,null);e.a=o.exports},"5db1":function(t,e,a){"use strict";a("fb25")},"5e1b":function(t,e,a){"use strict";var i=a("329b"),n=(a("6d57"),a("e10e"),a("6bf2")),o=a.n(n);var r={name:"DatepickerDialog",components:{},mixins:[a("e89f").a],props:{},data:function(){return{show:!1,isLoading:!0,today:"",currentYear:"",currentMonth:"",currentDate:"",yearsList:[],monthsList:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],weeksList:["日","一","二","三","四","五","六"],showYearSelect:!1,showMonthSelect:!1,dayList:[]}},methods:{openPopup:function(t){this.value=!0,this.show=!0,this.from=t.from,this.to=t.to,this.inputDate=o()(t.inputDate).isValid()?o()(o()(t.inputDate).format("YYYY-MM-DD")):o()(o()().format("YYYY-MM-DD")),this.callback=t.callback,this.today=o()(o()().format("YYYY-MM-DD")).valueOf(),this.from?this.fromDate=o()(o()(this.from).format("YYYY-MM-DD")).valueOf():this.fromDate=0,this.to?this.toDate=o()(o()(this.to).format("YYYY-MM-DD")).valueOf():this.toDate=1/0,this.selctedDateEpoch=o()(o()(this.inputDate).format("YYYY-MM-DD")).valueOf(),this.refreshDateList(this.inputDate),this.$emit("open")},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeSelectList:function(){this.showYearSelect=!1,this.showMonthSelect=!1},prevMonth:function(){this.currentDate=o()(this.currentDate).subtract(1,"month"),this.currentMonth=this.monthsList[this.currentDate.month()],this.currentYear=this.currentDate.year(),this.refreshDateList(this.currentDate)},nextMonth:function(){this.currentDate=o()(this.currentDate).add(1,"month"),this.currentMonth=this.monthsList[this.currentDate.month()],this.currentYear=this.currentDate.year(),this.refreshDateList(this.currentDate)},selectYear:function(){this.showYearSelect=!this.showYearSelect,this.showMonthSelect=!1},setYear:function(t){this.currentYear=t,this.yearChanged(t),this.showYearSelect=!1},selectMonth:function(){this.showYearSelect=!1,this.showMonthSelect=!this.showMonthSelect},setMonth:function(t){this.currentMonth=t,this.monthChanged(t),this.showMonthSelect=!1},dateSelected:function(t){t&&0!==Object.keys(t).length&&(this.selctedDateEpoch=t.epoch,this.callback(this.selctedDateEpoch),this.closePopup())},monthChanged:function(t){var e=this.monthsList.indexOf(t);this.currentDate.month(e),this.refreshDateList(this.currentDate)},yearChanged:function(t){this.currentDate.year(t),this.refreshDateList(this.currentDate)},refreshDateList:function(t){var e=[];this.isLoading=!0,t=o()(o()(t).format("YYYY-MM-DD")),this.currentDate=t,this.currentYear="",this.currentMonth="";var a,i,n=this.currentDate.daysInMonth();this.yearsList=function(t,e){var a=[],i=2015,n=2100;i=t?o()(t).year():i,n=e?o()(e).year():n;for(var r=i;r<=n;r++)a.push(r);return a}(),this.dayList=[];var r=o()(this.currentDate).startOf("month").day();this.firstDayEpoch=o()(this.currentDate).startOf("month").valueOf(),this.lastDayEpoch=o()(this.currentDate).endOf("month").startOf("day").valueOf();for(var s=1;s<=n;s++)i=(a=o()(this.currentDate).date(s)).valueOf()<this.fromDate||a.valueOf()>this.toDate,e.push({date:a.date(),month:a.month(),year:a.year(),day:a.day(),epoch:a.valueOf(),disabled:i}),this.dayList=e;for(var c=0;c<r;c++)this.dayList.unshift({});this.rows=[0,7,14,21,28,35],this.cols=[0,1,2,3,4,5,6],this.currentMonth=this.monthsList[t.month()],this.currentYear=this.currentDate.year(),this.numColumns=7,this.isLoading=!1}}},s=(a("80d8"),a("17cc")),c=Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{attrs:{mode:"dialog",title:"选择日期","on-close":t.closePopup},on:{click:function(e){t.closeSelectList()}}},[t.isLoading?t._e():a("div",{staticClass:"datepicker-hd"},[a("div",{class:{"datepicker-prev":!0,disabled:t.firstDayEpoch-864e5<t.fromDate},on:{click:t.prevMonth}},[a("icon",{attrs:{name:"arrow-left"}})],1),a("div",{staticClass:"datepicker-hd-center"},[a("div",{staticClass:"datepicker-year",on:{click:function(e){return e.stopPropagation(),t.selectYear(e)}}},[t._v("\n          "+t._s(t.currentYear)+"\n\n          "),a("transition",{attrs:{name:"spread"}},[t.showYearSelect?a("div",{staticClass:"select-list",on:{click:function(t){t.stopPropagation()}}},t._l(t.yearsList,(function(e,i){return a("div",{key:i,class:{"select-item":!0,"item-selected":t.currentYear===e},on:{click:function(a){t.setYear(e)}}},[t._v("\n                "+t._s(e)+"\n              ")])}))):t._e()])],1),a("div",{staticClass:"datepicker-month",on:{click:function(e){e.stopPropagation(),t.selectMonth()}}},[t._v("\n          "+t._s(t.currentMonth)+"\n          "),a("transition",{attrs:{name:"spread"}},[t.showMonthSelect?a("div",{staticClass:"select-list",on:{click:function(t){t.stopPropagation()}}},t._l(t.monthsList,(function(e,i){return a("div",{key:i,class:{"select-item":!0,"item-selected":t.currentMonth===e},on:{click:function(a){t.setMonth(e)}}},[t._v("\n                "+t._s(e)+"\n              ")])}))):t._e()])],1)]),a("div",{class:{"datepicker-next":!0,disabled:t.lastDayEpoch+864e5>t.toDate},on:{click:t.nextMonth}},[a("icon",{attrs:{name:"arrow-right"}})],1)]),t.isLoading?t._e():a("div",{staticClass:"calendar"},[a("div",{staticClass:"weeks-row"},t._l(t.weeksList,(function(e,i){return a("div",{key:i,staticClass:"weeks-cell"},[t._v("\n          "+t._s(e)+"\n        ")])}))),t._l(t.rows,(function(e,i){return a("div",{key:i,staticClass:"date-row"},t._l(t.cols,(function(i,n){return a("div",{key:n,staticClass:"date-cell",class:{"date-cell-selected":t.dayList[e+i]&&t.dayList[e+i].epoch===t.selctedDateEpoch,today:t.dayList[e+i]&&t.dayList[e+i].epoch===t.today,disabled:t.dayList[e+i]&&t.dayList[e+i].disabled},on:{click:function(a){t.dateSelected(t.dayList[e+i])}}},[t._v("\n          "+t._s(t.dayList[e+i]&&t.dayList[e+i].date)+"\n        ")])})))}))],2)]):t._e()],1)}),[],!1,null,"0a266c44",null).exports,l=!1;l||(l=new(i.default.extend(c))({el:document.createElement("div")}),document.body.appendChild(l.$el));e.a=l},"605d":function(t,e,a){"use strict";a("cc57");var i=a("e2a7"),n=a("6bf2"),o=a.n(n),r=a("5e1b"),s=a("e68e"),c=a("07d2"),l=a("3c64"),d=a("cd05"),p=a("774b"),u={name:"MaterialDetailBack",components:{Item:c.default,ItemImgList:s.a,ItemTextarea:l.a,UserSelect:d.a,Scroller:p.default},props:{model:{type:Object,default:function(){return{}}},pushInSaveStack:{type:Function},prepareTakePicture:{type:Function},changeBackChecker:{type:Function},backSubmit:{type:Function}},methods:{selectBackDate:function(){var t=this;r.a.openPopup({inputDate:o()(this.model.backData.date).toDate(),callback:function(e){t.model.backData.date=o()(e).format("YYYY-MM-DD"),t.pushInSaveStack("backSaveLog")}})},beforeSelect:function(t){return i.a.confirm("确定将监理修改为【"+t.name+"】吗？").then((function(t){return t}))},onSelectPic:function(t){this.$set(this.model.backData,"img",t),this.pushInSaveStack("backSaveLog")}}},h=(a("bdae"),a("17cc")),m=Object(h.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("scroller",{ref:"scroller"},[a("item",{attrs:{mode:"edit",label:"退场时间",editabled:!0,text:t.model.backData.date},on:{click:t.selectBackDate}}),a("div",{staticClass:"picture"},[a("p",{staticClass:"title-name"},[t._v("相关照片")]),a("item-img-list",{attrs:{maxlength:50,"allow-multi-select":!0,"prepare-callback":function(){return t.prepareTakePicture(t.model.backData,"back","","")}},on:{callback:t.onSelectPic},model:{value:t.model.backData.img,callback:function(e){t.$set(t.model.backData,"img",e)},expression:"model.backData.img"}})],1),a("item-textarea",{staticClass:"border-tb",attrs:{placeholder:"补充说明"},on:{blur:function(e){t.pushInSaveStack("backSaveLog")}},model:{value:t.model.backData.remark,callback:function(e){t.$set(t.model.backData,"remark",e)},expression:"model.backData.remark"}}),a("user-select",{attrs:{options:t.model.backData.checkerList,title:"监理","before-select":t.beforeSelect},on:{onSelect:t.changeBackChecker},model:{value:t.model.backData.checker,callback:function(e){t.$set(t.model.backData,"checker",e)},expression:"model.backData.checker"}}),a("user-select",{attrs:{title:"抄送人",options:t.model.ccList,multi:!0,required:!1},on:{onSelect:function(){return t.pushInSaveStack("backSaveLog")}},model:{value:t.model.backData.cc,callback:function(e){t.$set(t.model.backData,"cc",e)},expression:"model.backData.cc"}})],1),a("app-button-group",[a("app-button",{on:{click:t.backSubmit}},[t._v("\n      提交退场\n    ")])],1)],1)}),[],!1,null,"34524e4e",null);e.a=m.exports},"624c":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .task-void-dialog[data-v-918e1df2] .van-dialog__content{height:140px;padding:32px 20px}.zjapp .task-void-dialog .text-area-border[data-v-918e1df2]{border:1px solid #eee;border-bottom:null}",""])},6272:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .number-input[data-v-74068386]{position:relative;display:inline-block;vertical-align:top;width:61px;height:30px;border:1px solid #e5e5e5;border-radius:3px;text-align:center;font-size:14px;color:#333}@media screen and (min-width:320px){.zjapp .number-input[data-v-74068386]{width:50px}}@media screen and (min-width:360px){.zjapp .number-input[data-v-74068386]{width:58px}}@media screen and (min-width:375px){.zjapp .number-input[data-v-74068386]{width:61px}}.zjapp .text[data-v-74068386]{position:relative;display:inline-block;vertical-align:top;width:100%;height:100%;line-height:28px;overflow:hidden}.zjapp .text.disabled[data-v-74068386]{background:#f5f5f5;color:#666}.zjapp .value[data-v-74068386]{position:absolute;top:50%;right:0;margin-top:-14px;min-width:100%;height:28px;color:inherit}.zjapp .placeholder[data-v-74068386],.zjapp .value[data-v-74068386]{line-height:28px;pointer-events:none}.zjapp .placeholder[data-v-74068386]{display:inline-block;vertical-align:top;width:100%;height:100%;color:#b2b2b2}.zjapp .icon-minus[data-v-74068386]{position:absolute;top:-9px;right:-9px;width:18px;height:18px;border-radius:9px;background-color:#ff4546}.zjapp .icon-minus[data-v-74068386]:before{content:"";position:absolute;left:4px;top:8px;width:10px;height:2px;background-color:#fff}.zjapp .icon-minus[data-v-74068386]:after{content:"";position:absolute;left:-5px;top:-5px;width:28px;height:28px;border-radius:9px}.zjapp .number-input-select-all .value-handle[data-v-74068386]{background-color:#cbdaf9}.zjapp .number-input.unqualified[data-v-74068386]{border:1px solid #ffe8e8;background-color:#fff3f3;color:#ff5050}.zjapp .number-input.qualified .text[data-v-74068386]{color:#333}.zjapp .number-input.number-input-focus[data-v-74068386]{border-color:#4275e8;box-shadow:0 0 8px 0 rgba(66,117,232,.37)}.zjapp .number-input.number-input-empty[data-v-74068386]{border-color:#ff3d3d;box-shadow:0 0 8px 0 rgba(255,59,48,.37)}',""])},6314:function(t,e,a){"use strict";var i=a("329b"),n=a("07d2"),o=a("e68e"),r=a("cd05"),s=a("e89f"),c={name:"MaterialReportFirst",components:{Item:n.default,ItemImgList:o.a,UserSelect:r.a},mixins:[s.a],data:function(){return{show:!1,reportData:{}}},methods:{open:function(t){this.show=!0,this.reportData=t},close:function(){this.show=!1}}},l=(a("3103b"),a("17cc")),d=Object(l.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{attrs:{title:"首次送检报告",mode:"dialog","on-close":t.close}},[a("item",{attrs:{label:"送检报告"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.reportData.id,"model-field":"image_file","model-table":"material_task_log","edited-by":t.reportData.created_by,editabled:!1},model:{value:t.reportData.img,callback:function(e){t.$set(t.reportData,"img",e)},expression:"reportData.img"}})],1)]),a("item",{attrs:{label:"报告结果",text:t.reportData.result}}),a("user-select",{attrs:{title:"送检人",mode:"view",editabled:!1,date:t._f("formatDate")(t.reportData.checker_date)},model:{value:t.reportData.checker,callback:function(e){t.$set(t.reportData,"checker",e)},expression:"reportData.checker"}})],1):t._e()],1)}),[],!1,null,"186d9147",null).exports,p=!1;p||(p=new(i.default.extend(d))({el:document.createElement("div")}),document.body.appendChild(p.$el));e.a=p},"65e9":function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e");var i=a("28f8"),n=a("4360"),o=a("48f4"),r=a("162a"),s=a("f2d3"),c=a("6906"),l=a("a18c"),d=a("c745");function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"SynchronizeTipBar",props:{isTodo:{type:Boolean},useDownload:{type:Boolean,default:!0},enterDoCheck:{type:Boolean,default:!0},buildingId:{type:String,default:""},automaticUpdateCallback:{type:Function,default:null}},data:function(){return{currentModuleCode:"",oneUpdateData:!0}},computed:{projId:function(){return n.a.state.global.currentProject.id},waitUploadNum:function(){return n.a.state.global.waitUploadNum},hasTopProgress:function(){return n.a.state.global.hasTopProgress},hasChanged:function(){if(!this.useDownload)return!1;if(this.currentModuleCode){var t,e=o.default.isModuleNeedBuilding(this.currentModuleCode)&&!this.isTodo;return!(e&&!this.buildingId)&&(t=this.isTodo?n.a.state.global.todoChangedStatus||{}:n.a.state.global.businessChangedStatus||{},e?!!t[this.currentModuleCode]&&t[this.currentModuleCode][this.buildingId]:t[this.currentModuleCode])}return!1},show:function(){return(this.hasChanged||this.waitUploadNum)&&!this.hasTopProgress},oneDataSync:function(){return this.$store.state.app.oneDataSync}},watch:{hasChanged:function(t){var e=this;t&&this.$nextTick((function(){setTimeout((function(){var t=e.$refs["synchronize-tip-bar"];if(t&&t.style){t.style.display="none";t.offsetHeight;t.style.display="block"}}),100)}))},buildingId:function(t){this.currentModuleCode&&o.default.isModuleNeedBuilding(this.currentModuleCode)&&t&&(console.log("楼栋重新加载，是否再次自动加载数据：",this.oneUpdateData),this.oneUpdateData&&this.automaticLogic(),this.checkSync())},show:function(t){t?this.$emit("show"):this.$emit("hide")}},activated:function(){this.init()},methods:{init:function(){this.getCurrentModuleCode(),this.enterDoCheck&&!l.a.isBack&&this.checkSync(),this.automaticLogic()},automaticLogic:function(){var t=this;this.$router.isBack||(this.oneUpdateData=!0,d.a.getAutomaticLoadData().then((function(e){$log.log("是否要自动加载 ===> ",e&&t.oneDataSync&&"function"==typeof t.automaticUpdateCallback),e&&t.oneDataSync&&"function"==typeof t.automaticUpdateCallback&&t.dataSync().then((function(e){console.log("是否需要初始化页面 ====> ",Boolean(e)),e&&t.automaticUpdateCallback()}))})))},getCurrentModuleCode:function(){var t=o.default.getCurrentModuleCode(),e=this.isTodo?"todo":"";this.currentModuleCode=t||e},checkSync:function(){var e=this,a="checkDataUpdate",i=this.currentModuleCode,r=this.buildingId,l=n.a.state.global.isLeader?this.projId:"";return!o.default.isModuleNeedBuilding(i)||r||this.isTodo?(this.isTodo&&(a+="_todo"),i&&(a+="_".concat(i)),r&&(a+="_".concat(r)),c.a.execAfterInterval(120,a).then((function(){return e.isTodo?"todo"===i?s.a.getModuleList().then((function(e){var a=t.map(e,"code");return o.default.hasTodoChangedData("",a)})):o.default.hasTodoChangedData("",[i]):o.default.hasBusinessChangedData(l,[i],r)})).then((function(t){if(e.isTodo){var a=u({},n.a.state.global.todoChangedStatus);a[i]=t,n.a.commit("global/SET_TODO_CHANGED_STATUS",a)}else{var o=u({},n.a.state.global.businessChangedStatus);if(r){var s=o[i]?o[i]:{};s[r]=t,o[i]=s}else o[i]=t;n.a.commit("global/SET_BUSINESS_CHANGED_STATUS",o)}})).catch((function(t){return t&&!0===t.timeNotTo?($log.debug(t.msg),!1):$q.reject(t)}))):Promise.resolve()},dataSync:function(){var t=this.currentModuleCode,e=this.buildingId,a=o.default.isModuleNeedBuilding(t),i=a&&!e;return $log.log(["模块名：",t," 楼栋id：",e," 当前模块是否需要楼栋id：",a," 判断是否终止自动更新：",i]),i?Promise.resolve():(this.oneUpdateData=!1,r.a.beginManualUpdate(),o.default.checkSync(e).then((function(t){return r.a.endManualUpdate(),t})).catch((function(t){$log.error("自动更新错误",t),r.a.endManualUpdate()})))}}}}).call(this,a("391c"))},6632:function(t,e,a){"use strict";(function(t){a("f548"),a("c904"),a("e697"),a("9a33"),a("cc57");var i,n=a("fd50"),o=a("a18c"),r=a("6bf2"),s=a.n(r),c=a("e2a7"),l=a("0636"),d=a("3bd5"),p=a("37d5"),u=a("5ff0"),h=a("3516"),m=a("7b81"),f=a("c745"),g=a("f479"),b={"待申请进场":1,"待验收":1,"待区域验收":1,"已验收":1,"待送检":2,"待上传报告":3,"送检合格":3,"待复验":2,"复验合格":3,"待退场":4,"已退场":4};e.a=i={statusMap:b,isLoading:!0,proj_id:"",user:{},task_id:"",partIndex:0,partNum:0,checkerList:[],ccList:[],isSupervision:!1,partGo:function(t,e){var a;switch(t){case"进场":case"待申请进场":case"待验收":case"待区域验收":case"已验收":case g.a[1]:a=i.loadApproach(e);break;case"送检":case"待送检":case"待复验":a=i.loadCheck(e);break;case"报告":case"待上传报告":case"送检合格":case"复验合格":a=i.loadReport(e);break;case"待退场":case"退场":case"已退场":a=i.loadBack(e);break;default:a=i.loadTask(e)}return a.then((function(){i.checkEarlyResult()}))},checkEarlyResult:function(){switch(i.batchData.status){case"待申请进场":case"待验收":case"待建设单位验收":case"待区域验收":i.early_result="";break;case"待退场":case"已退场":i.early_result="不合格";break;default:i.early_result="合格"}},loadContractor:function(e){return f.a.allowGroupUserByConstructor().then((function(a){if(a){var n=e||i.batchData.task_base.recipient;return f.a.getOwnedContractorList(n).then((function(e){if(!t.isEmpty(e))return i.contractorOptions=e,!0}))}})).then((function(t){if(!t&&i.taskData.section&&i.taskData.section.id)return u.a.getContractorList(i.taskData.section.id).then((function(t){i.contractorOptions=t}))})).then((function(){t.isEmpty(i.contractorOptions)||i.batchData.task_base.recipient_unit||(i.taskData.contractor=t.clone(i.contractorOptions[0]),i.batchData.task_base.recipient_unit=i.taskData.contractor.id,i.batchData.task_base.recipient_unit_name=i.taskData.contractor.name)}))},changeReceiver:function(t){return i.loadContractor(t.id)},partGoByIndex:function(t,e){var a;switch(t){case 1:a=i.loadApproach(e);break;case 2:a=i.loadCheck(e);break;case 3:a=i.loadReport(e);break;case 4:a=i.loadBack(e);break;default:a=i.loadTask(e)}return a.then((function(){i.checkEarlyResult()}))},batchData:{},conCheckList:[],taskData:{},taskMode:"view",taskLoading:!0,supplyData:{},loadTask:function(e){i.taskMode="view",!1!==e&&(i.taskLoading=!0);var a=i.batchData,o=i.supplyData,r=a.task_base;return i.taskData={material:{id:r.material_id,name:r.material_name,quantity_unit:r.quantity_unit},defaultMaterialId:r.material_id,place:r.used_part,supplier:r.supplier,contractor:{id:r.recipient_unit,name:r.recipient_unit_name},creater:{id:r.created_by,name:r.created_by_name},receiver:{id:r.recipient,name:r.recipient_name,is_im_user:r.recipient_im,mobile:r.recipient_mobile},checker:{id:r.supervisor,name:r.supervisor_name,is_im_user:r.supervisor_im,mobile:r.supervisor_mobile},constructers:[],cc:a.cc,repair:{},section:{id:r.section_id,name:r.section_name},needConstructer:!!r.constructer,created_on:r.created_on,remark:r.remark,sync:r.allow_task_accept_together,isAreaCheckOn:r.isAreaCheckOn,areaCheckers:r.areaCheckers,shipping_no:o.shipping_no,sendback_reason:o.sendback_reason,contract:{id:r.contract_id,name:r.contract_name}},r.constructer&&m.a.getUsersByIds(r.constructer.split(",")).then((function(t){i.taskData.constructers=t})),"0"===r.need_check?i.taskData.needCheck=!1:"1"===r.need_check&&(i.taskData.needCheck=!0),r.material_type_list?i.taskData.materialType=JSON.parse(r.material_type_list):i.taskData.materialType=[],i.user.user_id===i.batchData.task_base.created_by?(i.taskData.materialList=[],i.taskData.checkerList=i.checkerList,p.default.getProjectUsers(i.proj_id,[33]).then((function(t){i.taskData.constructerList=t})),l.a.getMaterialList(i.proj_id).then((function(e){t.each(e,(function(t){i.taskData.materialList.push({id:t.id,name:t.name,quantity_unit:t.quantity_unit})}))})).then((function(){return i.loadContractor()})).finally((function(){i.taskLoading=!1}))):n.a.when().finally((function(){i.taskLoading=!1}))},loadAreaCheckData:function(e){return l.a.getTaskAreaCheckData(e).then((function(e){return t.each(e,(function(t){try{t.img=JSON.parse(t.image_file||"[]")}catch(e){t.img=[]}t.defaultChecker={id:t.user_id,name:t.user_name,is_im_user:t.is_im_user,mobile:t.mobile},t.checker={id:t.user_id,name:t.user_name,is_im_user:t.is_im_user,mobile:t.mobile},t.early_result="待退场"===t.status?"不合格":t.status?"合格":"尚未验收"})),e}))},approachData:{},approachMode:"view",approachLoading:!0,approachEmpty:!1,earlyMode:"view",earlyData:{},earlyDone:!1,earlyPass:"",activeLog:{},approachTemporaryStorage:!1,loadApproach:function(e){return!1!==e&&(i.approachLoading=!0),i.approachEmpty=!1,i.earlyDone=!1,i.earlyMode="view",i.approachMode="view",i.activeLog={},b[i.batchData.status]<b["待申请进场"]?(i.checkLoading=!1,i.approachEmpty=!0,!1):l.a.getTask(i.task_id).then((function(e){function a(e){var a=[],i=t.groupBy(e,"photo_requirement_id");return t.each(i,(function(e){if(e&&e.length)if(1===e.length)a.push(e[0]);else{var i=t.find(e,(function(e){return!t.isEmpty(e.image_file)}));a.push(i||e[0])}})),a}if(i.batchData.status=e.status,i.batchData.task_base=e,e.hasReceiverImgRecord){var n=a(e.receiverImg),o=t.difference(t.map(e.receiverImg,"id"),t.map(n,"id"));e.receiverImg=t.map(n,(function(t){return t.created_by_id=e.recipient,t})),o&&o.length&&t.each(o,(function(t){l.a.deleteMaterialPhotoType(t)}));var r=a(e.checkerImg),c=t.difference(t.map(e.checkerImg,"id"),t.map(r,"id"));e.checkerImg=t.map(r,(function(t){return t.created_by_id=e.supervisor,t})),c&&c.length&&t.each(c,(function(t){l.a.deleteMaterialPhotoType(t)}))}return i.approachData={material:{id:e.material_id,name:e.material_name},place:e.used_part,standard_unit:e.quantity_unit,contractor:{id:e.recipient_unit,name:e.recipient_unit_name},brands:[],receiver:{id:e.recipient,name:e.recipient_name,is_im_user:e.recipient_im,mobile:e.recipient_mobile},checker:{id:e.supervisor,name:e.supervisor_name,is_im_user:e.supervisor_im,mobile:e.supervisor_mobile},constructers:e.constructers,needConstructer:!!e.constructer,areaCheckers:e.areaCheckers,date:s()().format("YYYY-MM-DD"),img:[],receiverImg:e.receiverImg,checkerImg:e.checkerImg,hasReceiverImgRecord:e.hasReceiverImgRecord,hasCheckImgRecord:e.hasCheckImgRecord,isAreaCheckOn:!!e.area_acceptor},"0"===e.need_check?i.approachData.needCheck=!1:"1"===e.need_check&&(i.approachData.needCheck=!0),i.user.user_id===i.batchData.task_base.recipient&&"待申请进场"===i.batchData.status?i.approachMode="edit":i.approachEmpty=!(b[i.batchData.status]>b["待申请进场"]),i.approachTemporaryStorage=e.brands.length,i.approachData.brands=l.a.formatbrands(e.brands,"quantity"),e})).then((function(t){return l.a.getTaskLogByStatus(i.batchData.id,"待申请进场","").then((function(t){t&&(i.batchData.approachLogId=t.id,i.approachData.id=t.id,i.approachData.checker={id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},i.approachData.date=t.occurrence_date?s()(t.occurrence_date).format("YYYY-MM-DD"):s()().format("YYYY-MM-DD"),i.approachData.img=t.image_file?JSON.parse(t.image_file):[],i.approachData.remark=t.remark,i.approachData.receive_date=s()(t.created_on).format("YYYY-MM-DD HH:mm"),i.approachData.created_by=t.created_by)}))})).then((function(){if(i.approachData.brandsList=[],i.approachData.standardList=[],"edit"===i.approachMode)return l.a.getBrandList(i.batchData.task_base.material_id).then((function(e){t.each(e,(function(t){i.approachData.brandsList.push({id:t.id,name:t.name})})),t.each(i.approachData.brands,(function(e){if(/^custom\-[\d]+$/.test(e.id)){if(t.some(i.approachData.brandsList,{id:e.id}))return;i.approachData.brandsList.push({id:e.id,name:e.name})}}))})).then((function(){var e=i.supplyData.id?l.a.getMaterialTypeList(i.batchData.task_base.material_id):l.a.getSectionTypeList(i.batchData.task_base.section_id,i.batchData.task_base.material_id);return n.a.all([e,l.a.getSpecificationList(i.batchData.task_base.material_id)]).then((function(e){var a=e[0],n=e[1],o=t.groupBy(n,"material_type_id");t.each(a,(function(e){var a=e;t.has(o,e.id)&&(a.specificationList=o[e.id]),i.approachData.standardList.push(a)})),t.each(i.batchData.task_base.brands,(function(e){t.each(e.material_types,(function(e){var a;if(/^custom\-[\d]+$/.test(e.material_type_id)){if(t.some(i.approachData.standardList,{id:e.material_type_id}))return;a={id:e.material_type_id,name:e.material_type_name,quantity_unit:e.quantity_unit},i.approachData.standardList.push(a)}}))}))}))}))})).then((function(){"edit"===i.approachMode&&t.each(i.approachData.brands,(function(e){t.each(e.standard,(function(e){var a=t.find(i.approachData.standardList,{id:e.id});a&&(e.quantity_unit=a.quantity_unit)}))}))})).then((function(){if(i.checkLogList=[],"待申请进场"!==i.batchData.status)return i.approachEmpty=!1,l.a.getTaskCheckLogs(i.batchData.id).then((function(e){var a;return i.checkLogList=e,t.each(e,(function(t){"待验收"!==i.batchData.status||t.supervisor!==i.user.user_id||t.status||(i.activeLog={id:t.id,img:t.image_file?JSON.parse(t.image_file):[],remark:t.remark,status:t.status,type:t.supervisor===i.batchData.task_base.supervisor?"监理":"建设单位",defaultChecker:{id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},checker:{id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile}}),t.supervisor===i.batchData.task_base.supervisor&&(a=t)})),a})).then((function(t){t&&(i.batchData.earlyLogId=t.id,i.earlyData.defaultChecker={id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},i.earlyData.checker={id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},i.earlyData.id=t.id,i.earlyData.status=t.status,i.earlyData.early_result="待退场"===t.status?"不合格":t.status?"合格":"尚未验收",i.earlyData.check_date=s()(t.occurrence_date||t.created_on).format("YYYY-MM-DD HH:mm"),i.earlyData.img=t.image_file?JSON.parse(t.image_file):[],i.earlyData.remark=t.remark,i.earlyData.created_by=t.created_by,t.status&&(i.earlyDone=!0),i.batchData.task_base.checker?m.a.getUser(i.batchData.task_base.checker).then((function(t){i.batchData.checker=t})):i.batchData.checker=i.earlyData.checker,"待验收"!==i.batchData.status||t.supervisor!==i.user.user_id||t.status||(i.earlyMode="edit")),p.default.getProjectUsers(i.proj_id,[31,32,33]).then((function(t){i.earlyData.checkerList=t}))}))})).then((function(){if(i.conAllHasChecked=!1,i.conCheckList=[],i.approachData.needConstructer){var e=t.filter(i.checkLogList,(function(t){return t.supervisor!==i.batchData.task_base.supervisor}));e.length&&(i.conAllHasChecked=!0,e=e.sort((function(t,e){var a=parseInt((t.occurrence_date||"0").replace(/\D+/g,"")),i=parseInt((e.occurrence_date||"0").replace(/\D+/g,""));return 0===a&&0!==i?1:0!==a&&0===i?-1:0!==a&&0!==i?a-i:0})),t.each(e,(function(t){i.conCheckList.push({id:t.id,defaultChecker:{id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},checker:{id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},early_result:"待退场"===t.status?"不合格":"合格",status:t.status,remark:t.remark,created_by:t.created_by,check_date:s()(t.occurrence_date||t.created_on).format("YYYY-MM-DD HH:mm"),img:t.image_file?JSON.parse(t.image_file):[]}),"待退场"===i.batchData.status||t.status||(i.conAllHasChecked=!1)})),i.batchData.task_base.checker?m.a.getUser(i.batchData.task_base.checker).then((function(t){i.batchData.checker=t})):i.batchData.checker=i.earlyData.checker)}})).then((function(){return i.loadAreaCheckData(i.batchData.id).then((function(e){"待区域验收"===i.batchData.status&&t.find(e,(function(t){if(t.checker.id===i.user.user_id&&!t.status)return i.activeLog=t,!0})),i.approachData.areaCheckData=e}))})).then((function(){var e=JSON.parse(i.batchData.task_base.material_type_list||"[]");i.approachData.brands.length||(i.approachData.brands=[{standard:[]}],e.length?t.each(e,(function(e){var a=t.find(i.approachData.standardList,(function(t){return t.id===e.id}));a&&(a=t.clone(a),i.approachData.brands[0].standard.push(a))})):i.approachData.brands[0].standard.push({num:""}))})).then((function(){t.each(i.approachData.brands,(function(e){t.each(e.standard,(function(e){if(e){var a=t.find(i.approachData.standardList,{id:e.id});a=t.clone(a),e.specificationList=a?a.specificationList:[]}}))}))})).then((function(){var e=i.supplyData.materialType;if(i.supplyData.materialType&&!i.approachTemporaryStorage){var a=t.cloneDeep(i.approachData.brands),n=t.map(a,(function(a){return a.standard=t.map(a.standard,(function(a){var i=e.filter((function(t){return t.material_type_id===a.id}));if(i&&0!==i.length){var n=a.specificationList;if(n&&n.length){var o=[];t.each(i,(function(e){var a=t.find(n,{id:e.material_spec_id});a&&o.push({name:a.name,id:a.id,num:e.quantity})})),a.specification=o}else a.quantity=i[0].quantity}return a})),a}));i.approachData.brands=n}})).catch((function(t){console.error(t)})).finally((function(){var e=i.user.user_id;t.isEmpty(i.activeLog)||"待区域验收"!==i.batchData.status&&"待验收"!==i.batchData.status||e!==i.activeLog.checker.id||i.activeLog.status?i.actionPermit=!1:i.actionPermit=!0,i.approachLoading=!1}))},recoverApproachData:function(e,a){var o=e.data[0],r=e.data[1],s=e.data[2];(i.approachData=o,i.activeLog=r,"待验收"===i.batchData.status&&"edit"===i.earlyMode&&(i.batchData.needCheck=s.needCheck),a)&&("receiverImg"===e.imageField&&e.photoRequirementId?t.find(i.approachData.receiverImg,t.matches({photo_requirement_id:e.photoRequirementId})).image_file.push(a):"checkerImg"===e.imageField&&e.photoRequirementId?t.find(i.approachData.checkerImg,t.matches({photo_requirement_id:e.photoRequirementId})).image_file.push(a):"activeLog"===e.imageField?i.activeLog.img.push(a):i.approachData.img.push(a));return n.a.when()},checkData:{},checkDataFirst:{},checkMode:"view",checkLoading:!0,checkEmpty:!1,isFirstCheck:!0,onlyCheckFirst:!1,loadCheck:function(e){return!1!==e&&(i.checkLoading=!0),i.isFirstCheck=!0,i.checkEmpty=!1,i.checkMode="view",i.onlyCheckFirst=!1,i.checkData={},i.checkDataFirst={},b[i.batchData.status]<b["待送检"]?(i.checkLoading=!1,i.checkEmpty=!0,!1):l.a.isFirstCheck(i.task_id).then((function(t){i.isFirstCheck=t})).then((function(){return l.a.getTask(i.task_id).then((function(t){return i.batchData.status=t.status,i.batchData.task_base=t,t})).then((function(t){return i.isFirstCheck?l.a.getTaskLogByStatus(i.batchData.id,"待送检","").then((function(e){return e&&(i.checkData={id:e.id,brands:i.isFirstCheck?l.a.formatbrands(t.brands,"inspection_num"):l.a.formatbrands(t.brands,"retest_num"),standard_unit:t.brands[0].quantity_unit,date:e.occurrence_date?s()(e.occurrence_date).format("YYYY-MM-DD"):s()().format("YYYY-MM-DD"),defaultChecker:{id:e.supervisor,name:e.supervisor_name,mobile:e.supervisor_mobile,is_im_user:e.supervisor_im},checker:{id:e.supervisor,name:e.supervisor_name,mobile:e.supervisor_mobile,is_im_user:e.supervisor_im},checker_date:s()(e.created_on).format("YYYY-MM-DD HH:mm"),img:e.image_file?JSON.parse(e.image_file):[],created_by:e.created_by},i.batchData.checkLogId=e.id),t})):l.a.getTaskLogByStatus(i.batchData.id,"待复验","").then((function(e){return e&&(i.batchData.checkLogId=e.id,i.checkData={id:e.id,brands:(i.isFirstCheck,l.a.formatbrands(t.brands,"retest_num")),standard_unit:t.brands[0].quantity_unit,date:e.occurrence_date?s()(e.occurrence_date).format("YYYY-MM-DD"):s()().format("YYYY-MM-DD"),defaultChecker:{id:e.supervisor,name:e.supervisor_name,mobile:e.supervisor_mobile,is_im_user:e.supervisor_im},checker:{id:e.supervisor,name:e.supervisor_name,mobile:e.supervisor_mobile,is_im_user:e.supervisor_im},checker_date:s()(e.created_on).format("YYYY-MM-DD HH:mm"),img:e.image_file?JSON.parse(e.image_file):[],created_by:e.created_by}),t}))}))})).then((function(t){return i.checkData.checker&&i.user.user_id===i.checkData.checker.id&&["待送检","待复验"].indexOf(i.batchData.status)>-1?(i.checkMode="edit",p.default.getProjectUsers(i.proj_id,[31,32,33]).then((function(t){i.checkData.checkerList=t}))):i.isFirstCheck&&"待送检"===i.batchData.status?i.checkEmpty=!0:i.checkEmpty=!(b[i.batchData.status]>=b["待送检"]),t})).then((function(e){if(!i.isFirstCheck)return l.a.getTaskLogByStatus(i.batchData.id,"待送检","待上传报告").then((function(t){i.checkDataFirst.id=t.id,i.checkDataFirst.brands=l.a.formatbrands(e.brands,"inspection_num"),i.checkDataFirst.standard_unit=e.brands[0].quantity_unit,i.checkDataFirst.date=t.occurrence_date?s()(t.occurrence_date).format("YYYY-MM-DD"):"",i.checkDataFirst.checker={id:t.supervisor,name:t.supervisor_name,mobile:t.supervisor_mobile,is_im_user:t.supervisor_im},i.checkDataFirst.checker_date=s()(t.created_on).format("YYYY-MM-DD HH:mm"),i.checkDataFirst.img=t.image_file?JSON.parse(t.image_file):[],i.checkDataFirst.created_by=t.created_by,"待复验"===i.batchData.status&&"view"===i.checkMode&&(i.checkEmpty=!1,i.checkData=i.checkDataFirst,i.onlyCheckFirst=!0)}));t.isEmpty(i.checkData)&&(i.checkEmpty=!0)})).finally((function(){i.checkLoading=!1}))},recoverCheckData:function(t,e){return i.checkData=t.data,e&&i.checkData.img.push(e),n.a.when()},reportData:{},reportMode:"view",reportLoading:!0,reportEmpty:!1,isFirstReport:!1,onlyReportFirst:!1,loadReport:function(e){return i.reportMode="view",!1!==e&&(i.reportLoading=!0),i.reportEmpty=!1,i.isFirstReport=!1,i.onlyReportFirst=!1,i.reportData={},i.reportDataFirst={},l.a.isFirstReport(i.batchData.id).then((function(t){if(i.isFirstReport=t,i.isFirstReport&&b[i.batchData.status]<b["待上传报告"])return i.reportLoading=!1,i.reportEmpty=!0,!1})).then((function(){return l.a.getTask(i.task_id).then((function(t){return i.batchData.status=t.status,i.batchData.task_base=t,t}))})).then((function(){return l.a.getTaskLogByStatus(i.batchData.id,"待上传报告","").then((function(t){t&&(i.reportData={id:t.id||"",reportLogId:t.id||"",img:JSON.parse(t.image_file||"[]"),checker:{id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},checkerList:[],defaultChecker:{id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},checker_date:s()(t.created_on).format("YYYY-MM-DD HH:mm"),result:t.remark||"",created_by:t.created_by},t.status&&(i.reportDataView=i.reportData))}))})).then((function(){i.reportData.checker&&i.user.user_id===i.reportData.checker.id&&"待上传报告"===i.batchData.status?(i.reportMode="edit",p.default.getProjectUsers(i.proj_id,[31,32,33]).then((function(t){i.reportData.checkerList=t}))):i.isFirstReport&&"待上传报告"===i.batchData.status?i.reportEmpty=!0:i.reportEmpty=!(b[i.batchData.status]>=b["待上传报告"])})).then((function(){if(!i.isFirstReport)return l.a.getTaskLogByStatus(i.batchData.id,"待上传报告","待复验").then((function(t){t&&(i.reportDataFirst={id:t.id||"",img:JSON.parse(t.image_file||"[]"),checker:{id:t.supervisor,name:t.supervisor_name,is_im_user:t.supervisor_im,mobile:t.supervisor_mobile},checker_date:s()(t.created_on).format("YYYY-MM-DD HH:mm"),result:t.remark||"不合格，需要复检",created_by:t.created_by},(i.reportEmpty||"待上传报告"===i.batchData.status&&"view"===i.reportMode)&&(i.reportEmpty=!1,i.onlyReportFirst=!0),i.reportDataView||(i.reportDataView=i.reportDataFirst))}));t.isEmpty(i.reportData)&&(i.reportEmpty=!0)})).finally((function(){i.reportLoading=!1}))},recoverReportData:function(t,e){return i.reportData=t.data,e&&i.reportData.img.push(e),n.a.when()},backData:{},backMode:"view",backLoading:!0,backEmpty:!1,loadBack:function(e){return!1!==e&&(i.backLoading=!0),i.backMode="view",i.backEmpty=!1,b[i.batchData.status]<b["待退场"]?(i.backLoading=!1,i.backEmpty=!0,n.a.when()):l.a.getTask(i.task_id).then((function(t){return i.batchData.status=t.status,i.batchData.task_base=t,t})).then((function(t){return n.a.all([l.a.getTaskLogByStatus(i.batchData.id,"待退场",""),l.a.getTaskLogByStatus(i.batchData.id,"待退场","已退场")]).then((function(e){var a;e[0]?a=e[0]:(i.backMode="view",i.backEmpty=!1,a=e[1]),i.backData={taskId:i.task_id,id:a.id,backLogId:a.id,status:t.status,date:a.occurrence_date?s()(a.occurrence_date).format("YYYY-MM-DD"):s()().format("YYYY-MM-DD"),img:a.image_file?JSON.parse(a.image_file):[],remark:a.remark,checker:{id:a.supervisor,name:a.supervisor_name,mobile:a.supervisor_mobile,is_im_user:a.supervisor_im},checker_date:s()(a.created_on).format("YYYY-MM-DD HH:mm"),cc:JSON.parse(a.cc||"[]"),created_by:a.created_by}}))})).then((function(){i.user.user_id===i.backData.checker.id&&"待退场"===i.batchData.status?(i.backMode="edit",i.backData.checkerList=i.checkerList):"待退场"===i.batchData.status&&(i.backEmpty=!0)})).then((function(){return l.a.getTaskCcList(i.task_id,"被抄送").then((function(e){i.backData.cc=t.map(e,(function(t){return{id:t.cc,name:t.cc_name,mobile:t.cc_mobile,is_im_user:t.is_im_user,disabled:!0}}))}))})).finally((function(){i.backLoading=!1}))},recoverBackData:function(t,e){return i.backData=t.data,e&&i.backData.img.push(e),n.a.when()},init:function(e,a){return i.isLoading=!0,i.user=d.a.getUser(),i.taskData={},i.checkData={},i.batchData={},i.earlyData={},i.actionPermit=!1,i.reportData={},i.checkDataFirst={},i.reportDataFirst={},i.isSupervision=!1,i.tabs=[],i.supplyData={},l.a.getTaskBaseInfo(e).then((function(e){console.log("任务的基本数据 ----------------\x3e ",t.cloneDeep(e)),e||(c.a.alert("记录不存在"),o.a.back());var n=i.batchData={id:e.id,status:e.status,task_base:e,task_name:e.name,hasCheckRecord:!!e.log_id,needConstructer:!!e.constructer,constructer:e.constructer,sync:e.allow_task_accept_together};"0"===e.need_check?i.batchData.needCheck=!1:"1"===e.need_check&&(i.batchData.needCheck=!0),i.supplyData={materialId:e.id,id:e.supply_id},i.proj_id=e.proj_id,i.task_id=e.id;var r=-1;switch(n.status){case"待申请进场":case"待验收":case"待区域验收":case"已验收":r=1;break;case"待送检":case"待复验":r=2;break;case"待上传报告":case"送检合格":case"复验合格":r=3;break;case"待退场":case"已退场":r=i.batchData.hasCheckRecord?4:2;break;default:r=0}i.partIndex=void 0===a?r:a,i.loadTabs(),i.isLoading=!1})).then((function(){l.a.getTaskCcList(e,"被抄送").then((function(e){i.batchData.cc=t.map(e,(function(t){return{id:t.cc,name:t.cc_name,mobile:t.cc_mobile,is_im_user:t.is_im_user}}))}))})).then((function(){p.default.getProjectUsers(i.proj_id,[31,32,33]).then((function(t){i.checkerList=t}))})).then((function(){p.default.getProjectUsers(i.proj_id,[31,32,33]).then((function(t){i.ccList=t}))})).then((function(){p.default.getProjectUsers(i.proj_id,[33]).then((function(t){i.constructerList=t}))})).then((function(){return h.a.getSectionList(i.proj_id).then((function(t){i.sectionOptions=t}))})).then((function(){p.default.getCurrentUserProjectRoles().then((function(e){i.isSupervision=!!t.some(e,t.matches({role_type:32}))}))})).then((function(){return i.getSupplyDetail()})).then((function(){return void 0!==a?i.partGoByIndex(a):i.supplyData.allowSupplyOrderReturn?(i.partIndex=1,i.partGo(i.supplyData.supplyStatus)):i.partGo(i.batchData.status)})).then((function(){return i.loadContractor()}))},getSupplyDetail:function(){if(i.supplyData.id)return l.a.getSupplyDetail(i.supplyData.id).then((function(t){t.allowSupplyOrderReturn=t.supplyStatus===g.a[1]&&i.batchData.constructer===i.user.user_id,i.supplyData=Object.assign({},i.supplyData,t)}))},loadTabs:function(){var t=i.batchData;"待退场"===t.status||"已退场"===t.status?(i.earlyPass=!1,t.hasCheckRecord?(i.partNum=5,i.tabs=["任务","进场","送检","报告","退场"],i.partIndex=4):(i.partNum=3,i.tabs=["任务","进场","退场"])):(i.earlyPass="",t.needCheck&&i.statusMap[t.status]>1?(i.partNum=4,i.tabs=["任务","进场","送检","报告"]):(i.partNum=2,i.tabs=["任务","进场"]))}}}).call(this,a("391c"))},"68a0":function(t,e,a){"use strict";a("cc57");var i=a("6bf2"),n=a.n(i),o=a("e2a7"),r=a("5e1b"),s=a("774b"),c=a("07d2"),l=a("6948"),d=a("cd05"),p=a("e68e"),u=a("f5d4"),h={name:"MaterialDetailCheck",components:{Item:c.default,NumberInput:l.a,ItemImgList:p.a,UserSelect:d.a,Scroller:s.default},props:{model:{type:Object,default:function(){return{}}},pushInSaveStack:{type:Function},prepareTakePicture:{type:Function},changeCheckChecker:{type:Function},checkSubmit:{type:Function},checkerList:{type:Array}},data:function(){return{checkData:{}}},created:function(){console.log(this.model.checkData),console.log(this.model)},methods:{selectCheckDate:function(){var t=this;r.a.openPopup({inputDate:n()(this.model.checkData.date).toDate(),callback:function(e){t.$set(t.model.checkData,"date",n()(e).format("YYYY-MM-DD")),t.pushInSaveStack("saveCheckLog")}})},beforeSelect:function(t){return o.a.confirm("确定将送检人修改为【"+t.name+"】吗？").then((function(t){return t}))},onSelectPic:function(t){this.model.checkData.img=t,console.log(t),this.pushInSaveStack("saveCheckLog")},firstCheckDetail:function(){u.a.open(this.model.checkDataFirst)}}},m=(a("11fa"),a("17cc")),f=Object(m.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("scroller",{ref:"scroller"},[t.model.isFirstCheck?t._e():a("item",{staticClass:"bg-sub-theme mb10",attrs:{border:"bottom"},on:{click:t.firstCheckDetail}},[a("div",{staticClass:"item-text"},[t._v("首次送检记录")]),a("div",{staticClass:"item-font color-light"},[t._v("查看")]),a("icon",{attrs:{name:"arrow-right"}})],1),t._l(t.model.checkData.brands,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"brand-title"},[t._v("品牌："+t._s(e.name))]),t._l(e.standard,(function(e,i){return a("div",{key:i,staticClass:"brand-type"},[a("p",[t._v("类型："+t._s(e.name))]),e.specification&&e.specification.length?t._e():a("div",{staticClass:"spec-item"},[a("span"),a("span",[a("number-input",{staticClass:"color-theme",attrs:{type:"int, positive",range:[0,99],"overflow-auto-recover":!1},on:{blur:function(){return t.pushInSaveStack("saveCheckBrand")}},model:{value:e.num,callback:function(a){t.$set(e,"num",a)},expression:"item.num"}}),a("span",{staticClass:"text"},[t._v("组")])],1)]),e.specification&&e.specification.length?t._l(e.specification,(function(e,i){return a("div",{key:i,staticClass:"spec-item"},[a("span",{staticClass:"spec-name"},[t._v(t._s(e.name))]),a("span",[a("number-input",{staticClass:"color-theme",attrs:{range:[0,99],"overflow-auto-recover":!1,type:"int, positive"},on:{blur:function(){return t.pushInSaveStack("saveCheckBrand")}},model:{value:e.num,callback:function(a){t.$set(e,"num",a)},expression:"spec.num"}}),a("span",{staticClass:"text"},[t._v("组")])],1)])})):t._e()],2)}))],2)})),a("div",{staticClass:"picture"},[a("p",[t._v("送检照片")]),a("item-img-list",{attrs:{maxlength:50,"allow-multi-select":!0,"prepare-callback":function(){return t.prepareTakePicture(t.model.checkData,"check","","")}},on:{callback:t.onSelectPic},model:{value:t.model.checkData.img,callback:function(e){t.$set(t.model.checkData,"img",e)},expression:"model.checkData.img"}})],1),a("item",{attrs:{mode:"edit",label:"送检时间",editabled:!0,text:t.model.checkData.date},on:{click:t.selectCheckDate}}),a("user-select",{attrs:{options:t.checkerList,title:"送检人",editabled:!0,"before-select":t.beforeSelect},on:{onSelect:t.changeCheckChecker},model:{value:t.model.checkData.checker,callback:function(e){t.$set(t.model.checkData,"checker",e)},expression:"model.checkData.checker"}})],2),a("app-button-group",{attrs:{"fixed-bottom":""}},[a("app-button",{on:{click:t.checkSubmit}},[t._v("\n      提交送检记录\n    ")])],1)],1)}),[],!1,null,"b65069ea",null);e.a=f.exports},6948:function(t,e,a){"use strict";a("2b45"),a("163d");var i=a("329b"),n=a("8c3d").a,o=(a("b55a"),a("17cc")),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-up"},on:{leave:t.startClose,afterLeave:t.onClose}},[t.show?a("div",{staticClass:"number-keyboard-con",class:{"ios-bezel-less":t.isIOSBezelLess},style:{"z-index":t.zIndex},on:{touchstart:t.keyTouchstart,touchend:t.keyTouchend}},["true-or-false"===t.type?[a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"row-span-3 keys-row"},[a("div",{staticClass:"keys col color-green",attrs:{direct:"setTure"}},[a("icon",{attrs:{name:"qualified"}}),t._v("\n            合格\n          ")],1),a("div",{staticClass:"keys col color-red",attrs:{direct:"setFalse"}},[a("icon",{attrs:{name:"unqualified"}}),t._v("\n            不合格\n          ")],1)]),a("div",{staticClass:"row-span-1"},[a("div",{staticClass:"keys-row"},[a("div",{staticClass:"keys keys-ok",attrs:{direct:"closeKeyboard"}},[a("icon",{attrs:{name:"keyboard-close"}})],1)]),a("div",{staticClass:"keys-row"},[a("div",{staticClass:"keys keys-delete",attrs:{direct:"delete"}},[a("icon",{attrs:{name:"keyboard-delete"}})],1)])])]),a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys keys-prev",class:{disabled:!t.hasPrev},attrs:{direct:"prev"}},[t._v("\n          上一项\n        ")]),a("div",{staticClass:"keys keys-next",class:{disabled:!t.hasNext},attrs:{direct:"next"}},[t._v("\n          下一项\n        ")])])]:[a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys",attrs:{direct:"1"}},[t._v("1")]),a("div",{staticClass:"keys",attrs:{direct:"2"}},[t._v("2")]),a("div",{staticClass:"keys",attrs:{direct:"3"}},[t._v("3")]),a("div",{staticClass:"keys keys-ok",attrs:{direct:"closeKeyboard"}},[a("icon",{attrs:{name:"keyboard-close"}})],1)]),a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys",attrs:{direct:"4"}},[t._v("4")]),a("div",{staticClass:"keys",attrs:{direct:"5"}},[t._v("5")]),a("div",{staticClass:"keys",attrs:{direct:"6"}},[t._v("6")]),a("div",{staticClass:"keys keys-delete",attrs:{direct:"delete"}},[a("icon",{attrs:{name:"keyboard-delete"}})],1)]),a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys",attrs:{direct:"7"}},[t._v("7")]),a("div",{staticClass:"keys",attrs:{direct:"8"}},[t._v("8")]),a("div",{staticClass:"keys",attrs:{direct:"9"}},[t._v("9")]),a("div",{staticClass:"keys keys-prev",class:{disabled:!t.hasPrev},attrs:{direct:"prev"}},[t._v("\n          上一项\n        ")])]),a("div",{staticClass:"keyboard-row"},[a("div",{staticClass:"keys",class:{disabled:t.isDisabledMinus},attrs:{direct:"-"}},[t._v("-")]),a("div",{staticClass:"keys",attrs:{direct:"0"}},[t._v("0")]),a("div",{staticClass:"keys",class:{disabled:t.isDisabledPoint},attrs:{direct:"."}},[t._v(".")]),a("div",{staticClass:"keys keys-next",class:{disabled:!t.hasNext},attrs:{direct:"next"}},[t._v("\n          下一项\n        ")])])]],2):t._e()])}),[],!1,null,"6337f428",null).exports,s=!1;s||(s=new(i.default.extend(r))({el:document.createElement("div")}),document.body.appendChild(s.$el));var c=s,l=a("6f9e"),d=a("4360"),p={name:"NumberInput",props:{value:{type:[String,Number]},type:{type:String,default:"all"},decimal:{type:Number,default:2},placeholder:{type:String,default:""},nextEvent:{type:Function},range:{type:Array,default:function(){return[]}},overflowAutoRecover:{type:Boolean,default:!1},required:{type:Boolean},emptyAutoRecover:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},isSetEmptyTip:{type:Boolean,default:!1}},data:function(){return{rawValue:"",isFocusing:!1,isSelectAll:!1,keyboardHeight:d.a.state.app.isIOSBezelLess?266:"true-or-false"===this.type?176:232}},computed:{min:function(){return isNaN(this.range[0])?-1/0:parseFloat(this.range[0])},max:function(){return isNaN(this.range[1])?1/0:parseFloat(this.range[1])}},created:function(){l.a.$on("numberInputBlur",this.setBlur),l.a.$on("numberKeyboardClose",this.setBlur)},beforeDestroy:function(){this.isFocusing&&c.closeKeyboard()},destroyed:function(){l.a.$off("numberInputBlur",this.setBlur),l.a.$off("numberKeyboardClose",this.setBlur)},methods:{hasVal:function(t){return null!=t&&""!==t},openKeyboard:function(){this.disabled||(this.isFocusing?this.isSelectAll=!1:(l.a.$emit("numberInputBlur"),this.setFocus(),c.openKeyboard({inputComponent:this})))},setFocus:function(){this.isFocusing=!0,"true-or-false"!==this.type&&(this.isSelectAll=!0),this.rawValue=this.value,c.$on("keyboardInput",this.input),c.$on("keyboardAssign",this.assign),c.$on("keyboardDelete",this.deleteValue),c.$on("keyboardClear",this.clear),this.$emit("focus")},setBlur:function(){if(this.isFocusing){var t=this.checkValue();this.isFocusing=!1,this.isSelectAll=!1,c.$off("keyboardInput",this.input),c.$off("keyboardAssign",this.assign),c.$off("keyboardDelete",this.deleteValue),c.$off("keyboardClear",this.clear),this.$emit("input",t),this.$emit("blur",t),this.$nextTick((function(){c.calcTab()}))}},input:function(t){var e=this.hasVal(this.value)?this.value.toString():"",a="";this.isSelectAll?(a=t,this.isSelectAll=!1):a=e+t,console.log("newValue =====",a),this.$emit("input",a),c.setKeysStatus(a,this.type)},assign:function(t){this.isSelectAll=!1,this.$emit("input",t),c.setKeysStatus(t,this.type)},deleteValue:function(){var t=this.hasVal(this.value)?this.value.toString():"",e="";this.hasVal(t)&&(e=this.isSelectAll?"":t.substr(0,t.length-1)),this.$emit("input",e),c.setKeysStatus(e,this.type)},clear:function(){this.$emit("input",""),c.setKeysStatus("",this.type)},checkValue:function(){var t=this.hasVal(this.value)?this.value.toString():"";"-"===t&&(t=""),"."===t.substr(-1)&&(t=t.substr(0,t.length-1));var e=t.indexOf(".");return e>0&&(t=parseFloat(t.substring(0,e+this.decimal+1))),t=parseFloat(t),isNaN(t)?this.required&&this.emptyAutoRecover?(t=this.rawValue,this.$emit("onEmpty")):t="":(t<this.min&&(t=this.overflowAutoRecover?this.rawValue:this.min,this.$emit("overflowRange")),t>this.max&&(t=this.overflowAutoRecover?this.rawValue:this.max,this.$emit("overflowRange"))),t}}},u=(a("6abe"),Object(o.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"number-input component-number-input",class:{"number-input-focus":t.isFocusing,"number-input-empty":t.isSetEmptyTip&&!t.value&&!t.isFocusing,"number-input-select-all":t.isSelectAll,qualified:"true-or-false"===t.type&&1===t.value,unqualified:"true-or-false"===t.type&&0===t.value}},[a("div",{staticClass:"text",class:{disabled:t.disabled},on:{click:function(e){return e.stopPropagation(),t.openKeyboard(e)}}},[t.hasVal(t.value)?a("span",{staticClass:"value"},[a("span",{staticClass:"value-handle"},[t._v(t._s("true-or-false"===t.type?1===t.value?"合格":"不合格":t.value))])]):a("span",{staticClass:"placeholder"},[t._v("\n      "+t._s(t.placeholder)+"\n    ")])]),t._t("extend")],2)}),[],!1,null,"74068386",null));e.a=u.exports},"69c5":function(t,e,a){var i=a("7d2b");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("172b2e44",i,!0,{sourceMap:!1,shadowMode:!1})},"6abe":function(t,e,a){"use strict";a("bebe")},"6b81a":function(t,e,a){var i=a("a779");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("cd18d2ce",i,!0,{sourceMap:!1,shadowMode:!1})},"6c75":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,"[data-v-cbca839c] .layout-content{overflow:auto}.zjapp .brand-info[data-v-cbca839c]{background-color:#fff;padding:15px 15px 0 15px;font-size:16px}.zjapp .brand-name[data-v-cbca839c]{color:#4275e8;padding-bottom:10px}.zjapp .brand-type[data-v-cbca839c]{color:#333;padding:10px 0 10px 10px}.zjapp .brand-spec[data-v-cbca839c],.zjapp .brand-type[data-v-cbca839c]{display:flex;justify-content:space-between}.zjapp .brand-spec[data-v-cbca839c]{padding:10px 0 10px 30px}",""])},7274:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .custom-material-dialog[data-v-6fc312fe] .van-dialog__content{padding:20px}.zjapp .custom-material-dialog[data-v-6fc312fe] .van-dialog__content span{display:inline-block;color:#333;height:30px;line-height:30px;padding:0 13px;text-align:center;font-size:15px;border:1px solid #dcdcdc;border-radius:4px}.zjapp .custom-material-dialog[data-v-6fc312fe] .van-dialog__content span.checked{position:relative;border-color:#4275e8;color:#4275e8!important}.zjapp .custom-material-dialog[data-v-6fc312fe] .van-dialog__content span.checked:before{position:absolute;content:" ";display:block;border:1px solid #4275e8;border-top:none;border-right:none;width:8px;height:4px;transform:rotate(-45deg);right:3px;bottom:5px}.zjapp .custom-material-dialog[data-v-6fc312fe] .van-dialog__content .untis{margin:0 -3px}.zjapp .custom-material-dialog[data-v-6fc312fe] .van-dialog__content .untis span{padding:0;width:50px;margin:0 3px 5px 3px;font-size:14px;color:#666}.zjapp .custom-material-dialog[data-v-6fc312fe] .van-dialog__content p{padding:14px 0 10px 0;line-height:20px;color:#999;font-size:12px}.zjapp .custom-material-dialog[data-v-6fc312fe] .van-dialog__content p.error{color:#ff3d3d}.zjapp .custom-material-dialog .new-name[data-v-6fc312fe]{margin-top:10px}.zjapp .custom-material-dialog .new-name input[data-v-6fc312fe]{width:100%;height:40px;padding:10px;border-radius:0;font-size:14px;border:none;background-image:linear-gradient(180deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0),linear-gradient(270deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0),linear-gradient(0deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0),linear-gradient(90deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0);background-size:100% 1px,1px 100%,100% 1px,1px 100%;background-repeat:no-repeat;background-position:top,100% 0,bottom,0 0}.zjapp .custom-material-dialog .new-name.error input[data-v-6fc312fe]::-webkit-input-placeholder{color:#ff3d3d}',""])},"745e":function(t,e,a){var i=a("776e");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("17165077",i,!0,{sourceMap:!1,shadowMode:!1})},7460:function(t,e,a){"use strict";a("cc57");var i=a("e2a7"),n=a("ed08"),o=a("3e47"),r={name:"TemplateGuide",components:{Converting:a("e8e4").a},props:{projId:{type:String,default:""},module:{type:String,default:""},connectId:{type:String,default:""}},data:function(){return{templateData:null,inConverting:!1}},watch:{connectId:function(t){this.init()}},activated:function(){this.init()},methods:{init:function(){var t=this,e=this.connectId;return e?Promise.resolve().then((function(){return"process"===t.module?o.a.getProcessTemplate(t.projId,e):"material"===t.module?o.a.getMaterialTemplate(t.projId,e):void 0})).then((function(a){e===t.connectId&&(t.templateData=a,t.$emit("queryHasTemplate",!!a))})).catch((function(e){t.templateData=null,t.$emit("queryHasTemplate",!1),console.error(e)})):Promise.resolve()},downloadTemplate:function(){var t=this.templateData.url,e=n.a.formatFiletypes(t);"dwg"!==e&&"rvt"!==e?this.openTemplateGuide():this.handleCovertingAndDownload()},handleCovertingAndDownload:function(){var t=this,e=this.templateData.id;this.inConverting=!0,o.a.coverterBimface(e).then((function(e){t.templateData.url=e,$log.log("converting url",e),t.inConverting=!1,t.openTemplateGuide()})).catch((function(){t.inConverting=!1,$log.log("转换失败")}))},openTemplateGuide:function(){var t=this;return Promise.resolve().then((function(){var e=t.templateData.downloadInfo;if(!e.download_time||e.upload_time>e.download_time)return o.a.downloadSingleTemplate(t.templateData.id,t.templateData.name,t.templateData.url)})).then((function(){return o.a.openTemplate(t.templateData.id,t.templateData.name,t.templateData.url).catch((function(t){i.a.alert(t)}))})).catch((function(t){i.a.alert(t)}))}}},s=(a("d81a"),a("17cc")),c=Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.templateData?a("div",{staticClass:"header-btn",on:{click:function(e){t.downloadTemplate()}}},[t.inConverting?a("converting",{staticClass:"cover"}):t._e(),t.inConverting?t._e():a("span",[t._v("样板")])],1):t._e()}),[],!1,null,"02a5f460",null);e.a=c.exports},7644:function(t,e,a){"use strict";a("03dc")},"768c":function(t,e,a){var i=a("8d95a");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("53f9b32b",i,!0,{sourceMap:!1,shadowMode:!1})},"771c":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content-not-empty[data-v-691b2f0f] .layout-content{display:auto;overflow:auto;padding-bottom:100px}.zjapp .check-guide-detail-hd[data-v-691b2f0f]{margin-left:30px;padding:25px 30px 5px 0}.zjapp .check-guide-detail-title[data-v-691b2f0f]{margin:0;line-height:20px;font-size:18px;color:#111;font-weight:700;word-break:break-all}.zjapp .check-guide-detail-info[data-v-691b2f0f]{line-height:20px;font-size:14px;color:#8c8c8c}.zjapp .check-guide-detail-content[data-v-691b2f0f]{padding:30px;line-height:30px;color:#333;font-size:16px}.zjapp .check-guide-detail-content p[data-v-691b2f0f]{margin-bottom:30px;min-height:1em}.zjapp .check-guide-detail-content img[data-v-691b2f0f]{max-width:100%}.zjapp .check-guide-detail-content .img-not-ready[data-v-691b2f0f]{width:80px;height:auto}.zjapp .error[data-v-691b2f0f]{max-width:50%}",""])},"776e":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-b65069ea],.zjapp .content .wrap-scroll[data-v-b65069ea]{display:flex;flex-direction:column;flex:1;height:100%}.zjapp .content .wrap-scroll[data-v-b65069ea]{padding-bottom:100px;overflow:auto}.zjapp .content .item[data-v-b65069ea]{min-height:44px}.zjapp .content .brand-title[data-v-b65069ea]{font-size:16px;color:#333;position:relative;line-height:30px;min-height:40px;padding:8px 16px 2px}.zjapp .content .brand-type[data-v-b65069ea]{background-color:#fff;padding:15px 0 15px 17px;font-size:16px;color:#999;border:none;background-image:linear-gradient(180deg,#eee,#eee 33.3333%,transparent 0),linear-gradient(0deg,#eee,#eee 33.3333%,transparent 0);background-size:100% 1px,100% 1px;background-repeat:no-repeat;background-position:top,bottom}.zjapp .content .spec-item[data-v-b65069ea]{display:flex;justify-content:space-between;padding:15px 15px 0 14px}.zjapp .content .spec-item span[data-v-b65069ea]{position:relative;display:block}.zjapp .content .spec-item[data-v-b65069ea] .number-input{width:160px;padding-right:27px}.zjapp .content .spec-item[data-v-b65069ea] .number-input input{text-align:right}.zjapp .content .spec-item .text[data-v-b65069ea]{position:absolute;color:#666;right:7px;top:7px}.zjapp .content .spec-item .spec-name[data-v-b65069ea]{padding-top:8px}.zjapp .content .picture[data-v-b65069ea]{background-color:#fff;margin-top:10px;padding:15px;border:none;background-image:linear-gradient(180deg,#ddd,#ddd 33.3333%,transparent 0),linear-gradient(0deg,#ddd,#ddd 33.3333%,transparent 0);background-size:100% 1px,100% 1px;background-repeat:no-repeat;background-position:top,bottom}.zjapp .content .picture p[data-v-b65069ea]{font-size:16px;margin-bottom:10px}",""])},"7d2b":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-c4404120]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-c4404120]{position:absolute;left:0;bottom:0;width:100%;flex-direction:column}.zjapp .box[data-v-c4404120],.zjapp .list-wrap[data-v-c4404120]{display:flex;background-color:#fff}.zjapp .list-wrap[data-v-c4404120]{flex-direction:row;align-items:flex-start;flex:1;height:465px}.zjapp #slideUpSelectDialog[data-v-c4404120]{padding:0 15px 0}.zjapp .hd[data-v-c4404120]{position:relative;padding:10px 45px;height:44px;line-height:22px;font-size:16px;color:#666;text-align:center;background-color:#fff}.zjapp .hd .icon-unqualified[data-v-c4404120]{position:absolute;width:44px;height:44px;top:0;right:0;line-height:44px;font-size:14px;text-align:center;color:#999}.zjapp .item[data-v-c4404120]{padding-left:0;padding-right:0}.zjapp .text[data-v-c4404120]{font-size:14px;line-height:20px;color:#333}.zjapp .note[data-v-c4404120]{font-size:12px;line-height:18px;color:#999}[data-v-c4404120] .icon-qualified{width:34px;height:34px;line-height:34px;text-align:center;color:#4275e8}",""])},"7eb2":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .synchronize-tip-bar[data-v-66826030]{height:30px;padding:5px 15px;line-height:20px;text-align:center;background-color:#ffe6e6;color:#ff6060;font-size:14px}.zjapp .synchronize-tip-bar .icon-caution[data-v-66826030]{line-height:20px;margin-right:5px}@media screen and (-webkit-min-device-pixel-ratio:1){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 100%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:1.5){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2.625){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 38.0952%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:3){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:4){.zjapp .synchronize-tip-bar[data-v-66826030]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 25%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}",""])},"80d8":function(t,e,a){"use strict";a("e60b")},"81f2":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .main[data-v-2cac8864]{position:fixed;width:100%;bottom:0}.zjapp .arrow[data-v-2cac8864]{position:absolute;top:-7px;right:18px;width:0;height:0;border-bottom:7px solid #fff;border-right:7px solid transparent;border-left:7px solid transparent}.zjapp .content[data-v-2cac8864]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);overflow:hidden}.zjapp .box[data-v-2cac8864]{display:flex;flex-direction:column;background-color:#fff;overflow:auto}.zjapp .box-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1}.zjapp .detail-hd[data-v-2cac8864]{display:flex;padding:6px 15px}.zjapp .detail-arrow-right[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-right[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:12px;border:5px solid transparent;border-left:5px solid #c8c8c8}.zjapp .detail-arrow-down[data-v-2cac8864]{width:13px;height:34px;overflow:hidden}.zjapp .detail-arrow-down[data-v-2cac8864]:before{display:block;content:"";width:0;height:0;margin-top:15px;border:5px solid transparent;border-top:5px solid #c8c8c8}.zjapp .detail-title[data-v-2cac8864]{flex:1;line-height:34px;color:#111;font-size:16px}.zjapp .detail-bd[data-v-2cac8864]{padding:8px 15px 8px 35px;background-color:#fafafa}.zjapp .text-line[data-v-2cac8864]{font-size:14px;color:#666;line-height:30px;margin-bottom:30px}.zjapp .detail-hd-single[data-v-2cac8864]{padding:6px 0;margin:0 15px}.zjapp .detail-bd-single[data-v-2cac8864]{display:flex;flex-direction:column;flex:1;padding:8px 15px;background-color:#fff}',""])},"86ac":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .text-area-border{border:1px solid #eee;border-bottom:null}",""])},"873c":function(t,e,a){"use strict";(function(t){a("5ab2"),a("e10e"),a("f548");var i=a("28f8"),n=(a("cc57"),a("6d57"),a("e697"),a("c0c3"),a("6a61"),a("2e91")),o=(a("fd50"),a("3bd5")),r=a("e2a7"),s=a("aab3"),c=a("5ff0"),l=a("0636"),d=a("c745"),p=a("3516"),u=a("6144"),h=a("bc69"),m=a("37d5"),f=a("59f8"),g=a("24de"),b=a("0136"),v=a("7bac"),k=a("a7c3"),y=a("07d2"),_=a("3c64"),D=a("5a71"),x=a("88c7"),w=a("cd05"),C=a("cd66"),S=a("f711"),j=a("f5bd");function O(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function I(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?O(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var L,T,z,$,M,P,E,B,A,R={add:{allowSection:!0,allowMaterial:!0,allowPeople:!0,allowIsConstructerBtn:!0,allowIsNews:!0,allowSupplyOrderTaskVoide:!1},edit:{allowSection:!0,allowMaterial:!1,allowPeople:!0,allowIsConstructerBtn:!0,allowIsNews:!1,allowSupplyOrderTaskVoide:!1},preCreated:{allowSection:!0,allowMaterial:!1,allowPeople:!0,allowIsConstructerBtn:!1,allowIsNews:!0,allowSupplyOrderTaskVoide:!0}};e.a={name:"MaterialTaskForm",components:{Item:y.default,ItemTextarea:_.a,SingleSelect:D.a,UserSelect:w.a,MultiSelect:x.a,MaterialInfoSelect:C.a,MaterialTaskVoidDialog:S.a,MaterialTaskContract:j.a},props:{status:{type:String,default:"add"},model:{type:Object,default:function(){return{}}},saveTask:{type:Function,default:function(){}}},data:function(){return{allowSection:!0,allowMaterial:!0,allowPeople:!0,allowIsConstructerBtn:!0,allowIsNews:!0,allowSupplyOrderTaskVoide:!1,isAreaCheckOn:!1,allowCustomMaterialName:!1,allowCustomMaterialType:!1,UsingMaterialContract:!1,sectionOptions:[],ccList:[],supplierOptions:[],supplierData:{id:"-1",name:""},taskData:{checker:{},constructers:[]},typeList:[],showSupplier:!1}},computed:{statusComputed:function(){var t=this.$route.query.status;return t||(t=this.status),t},statusData:function(){return R[this.statusComputed]||{}},userData:function(){var t=o.a.getUser();return{id:t.user_id,name:t.user_name}},placeRequired:function(){return this.$store.state.global.isPlaceRequired.material},proj_id:function(){return this.$route.query.projId},supply_id:function(){var t=this.$route.query.supply_id;return t},allowSupplyOrder:function(){return Boolean(this.supply_id)||this.model.supplyData&&this.model.supplyData.id}},mounted:function(){this.$refs.materialTaskForm.scrollTop=0,this.initEdit()},activated:function(){this.initAdd(),this.initPreCreated()},methods:{init:(A=Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.result(),t.next=3,this.search();case 3:case"end":return t.stop()}}),t,this)}))),function(){return A.apply(this,arguments)}),setting:function(){var t=this.statusData,e=t.allowSection,a=t.allowMaterial,i=t.allowPeople,n=t.allowIsConstructerBtn,o=t.allowIsNews,r=t.allowSupplyOrderTaskVoide;console.log("status -----\x3e ",this.statusData),this.allowSection=e,this.allowMaterial=a,this.allowPeople=i,this.allowIsConstructerBtn=n,this.allowIsNews=o,this.allowSupplyOrderTaskVoide=r},result:function(){this.isAreaCheckOn=!1,this.taskData={id:"",material:{},materialType:[],place:"",supplier:{},contractor:{},receiver:{},needCheck:!1,areaCheckers:[],materialList:[],checkerList:[],needConstructer:!1}},search:(B=Object(n.a)(regeneratorRuntime.mark((function t(){var e,a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.getUserKey(k.a.MATERIAL_NEED_CONSTRUCTER);case 2:return e=t.sent,this.taskData.needConstructer=Boolean(e),t.next=6,f.a.getValue("allow_add_material_via_app");case 6:return a=t.sent,this.allowCustomMaterialName="1"===a||"0"===a?"1"===a:"1"===JSON.parse(a).MATERIAL_NAME,t.next=10,f.a.getValue("allow_add_material_via_app");case 10:i=t.sent,this.allowCustomMaterialType="1"===i||"0"===i?"1"===i:"1"===JSON.parse(i).MATERIAL_TYPE,this.UsingMaterialContract=this.$store.state.global.allGrayRelease.UsingMaterialContract;case 13:case"end":return t.stop()}}),t,this)}))),function(){return B.apply(this,arguments)}),peopleList:(E=Object(n.a)(regeneratorRuntime.mark((function e(){var a,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.default.getCurrentUserProjectRoles();case 3:return a=e.sent,t.find(a,(function(t){if(32===t.role_type)return!0}))&&this.$set(this.taskData,"checker",this.userData),e.next=8,m.default.getProjectUsers(this.proj_id,[31,32,33]).then((function(t){i.taskData.checkerList=t}));case 8:return e.next=10,m.default.getProjectUsers(this.proj_id,[33]).then((function(t){i.taskData.constructerList=t}));case 10:return e.next=12,m.default.getProjectUsers(this.proj_id,[31,32,33]).then((function(t){i.ccList=t}));case 12:return e.next=14,f.a.getValue("allow_task_accept_together").then((function(t){i.taskData.sync=+t}));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),$log.error("材料验收-新建任务时-获取初始数据-error ",e.t0);case 19:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(){return E.apply(this,arguments)}),supplierList:function(){var t=this,e=this.taskData.section&&this.taskData.section.id;if(e)return c.a.getContractorList(e).then((function(e){t.supplierOptions=e})).then((function(){var e=t.taskData.supplier;-1===e.id&&t.supplierOptions.unshift(e)})).then((function(){var e=t.taskData.contractor_id;e&&t.allowSupplyOrder&&(t.supplierOptions||[]).forEach((function(a){a.id===e&&t.$set(t.taskData,"supplier",{id:a.id,name:a.name})}))}))},loadContractorList:(P=Object(n.a)(regeneratorRuntime.mark((function e(a){var i,n,o,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null,e.next=3,d.a.allowGroupUserByConstructor();case 3:if(!e.sent){e.next=9;break}return n=a||this.taskData.receiver.id||this.userData.id,e.next=8,d.a.getOwnedContractorList(n);case 8:i=e.sent;case 9:if(i&&0!==i.length||!this.taskData.section||!this.taskData.section.id){e.next=13;break}return e.next=12,c.a.getContractorList(this.taskData.section.id);case 12:i=e.sent;case 13:this.$set(this.taskData,"contractorOptions",i||[]),o=t.find(i||[],(function(t){if(t.id===r.taskData.contractor.id)return!0})),i&&!o&&(this.taskData.contractor=t.clone(i[0]));case 16:case"end":return e.stop()}}),e,this)}))),function(t){return P.apply(this,arguments)}),showSupplierDialog:function(t){var e=this;t.stopPropagation?(t.stopPropagation(),this.supplierData=I({},this.taskData.supplier)):this.resetSupplierData(),this.showSupplier=!0,setTimeout((function(){e.$refs["textarea-supplier"].$refs.input.focus()}),50)},supplierSubmit:function(t,e){var a=this;if("confirm"===t){var i=this.supplierData.name=this.supplierData.name.trim();if(i.length<1)return e(!1);this.supplierOptions.some((function(t){if(t.name===i)return a.supplierData.id=t.id,!0})),this.taskData.supplier=I({},this.supplierData),this.$refs.singleSelectDialog.closePopup(),e()}else this.resetSupplierData(),e()},resetSupplierData:function(){this.supplierData={id:"-1",name:""}},onChangeMaterialType:function(e){this.loadAreaCheckers(this.taskData.section.id,t.map(e,"id"))},selectSection:(M=Object(n.a)(regeneratorRuntime.mark((function t(){var e,a,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.taskData.receiver=this.userData,t.next=3,p.a.getSectionList(this.proj_id);case 3:e=t.sent,this.sectionOptions=e,(a=(a=u.a.getObject(h.a.MATERIAL_DEFAULT_SECTION,u.a.level.user)||{})[this.proj_id])&&this.sectionOptions.forEach((function(t){a.id===t.id&&i.$set(i.taskData,"section",a)}));case 8:case"end":return t.stop()}}),t,this)}))),function(){return M.apply(this,arguments)}),materialTaskContractSelect:function(t){this.$set(this.taskData,"contract",t)},initAdd:($=Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setting(),"add"===this.statusComputed){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.init();case 5:return t.next=7,this.selectSection();case 7:this.taskData&&this.taskData.section&&this.taskData.section.id?this.changeSection():this.loadContractorList(),this.peopleList();case 9:case"end":return t.stop()}}),t,this)}))),function(){return $.apply(this,arguments)}),changeSection:function(){return this.allowIsNews&&(this.allowSupplyOrder||(this.$set(this.taskData,"material",{}),this.materialNameSelect()),this.$set(this.taskData,"supplier",{})),this.supplierList(),this.loadContractorList()},materialNameSelect:function(){var t=this;l.a.getSectionMaterial(this.taskData.section.id).then((function(e){t.taskData.materialList=e}))},materialTypeSelect:function(){var t=this;l.a.getSectionTypeList(this.taskData.section.id,this.taskData.material.id).then((function(e){t.typeList=e,t.taskData.materialType=null}))},loadAreaCheckers:function(t,e){var a=this;return e.length<1?(this.isAreaCheckOn=!1,void(this.taskData.areaCheckers=[])):s.a.getAreaCheckerSetting(t,e).then((function(t){a.isAreaCheckOn=t.isAreaCheckOn,t.isAreaCheckOn?a.taskData.areaCheckers=t.checkers:a.taskData.areaCheckers=[]}))},checkMaterialType:function(){var e=this.taskData.section,a=this.taskData.material;return t.isEmpty(e)?(r.a.alert("请先选择标段"),!1):t.isEmpty(a)?(r.a.alert("请先选择材料名称"),!1):void 0},checkSectionIsAvailable:function(){if(!this.taskData.section||!this.taskData.section.id||t.isEmpty(this.taskData.contractorOptions))return r.a.alert("请先选择标段"),!1},initEdit:(z=Object(n.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setting(),"edit"===this.statusComputed){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.init();case 5:this.taskData=this.model.taskData,this.sectionOptions=this.model.sectionOptions,this.ccList=this.model.ccList,this.taskData.needConstructer=!!this.allowSupplyOrder||this.taskData.needConstructer,e="待申请进场"===this.model.batchData.status,this.allowSection=e,this.allowPeople=e,this.allowIsConstructerBtn=!this.allowSupplyOrder&&e,this.taskData.section&&this.taskData.section.id&&this.supplierList(),this.loadContractorList();case 15:case"end":return t.stop()}}),t,this)}))),function(){return z.apply(this,arguments)}),initPreCreated:(T=Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.setting(),"preCreated"===this.statusComputed){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,this.init();case 6:return this.taskData.needConstructer=!0,t.next=9,this.selectSection();case 9:return t.next=11,this.getSupplyAddTaskDetail();case 11:this.supplierList(),this.loadContractorList(),this.peopleList(),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),$log.error("材料验收-新建任务-初始化-甲供材：",t.t0);case 19:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(){return T.apply(this,arguments)}),getSupplyAddTaskDetail:(L=Object(n.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.getSupplyAddTaskDetail(this.supply_id);case 2:e=t.sent,this.$set(this.taskData,"material",e.material),this.$set(this.taskData,"materialType",e.materialType),this.$set(this.taskData,"constructers",e.constructers),this.$set(this.taskData,"shipping_no",e.shipping_no),this.$set(this.taskData,"contractor_id",e.contractor_id),this.taskData.shipping_id=e.shipping_id,console.log("detail",this.taskData,e);case 10:case"end":return t.stop()}}),t,this)}))),function(){return L.apply(this,arguments)}),taskVoid:function(){this.$refs.materialTaskVoidDialog.show=!0},supplyOrderTaskVoid:function(t,e){var a=this;l.a.submitSupplyOrderTaskVoid({cancel_reason:t,id:this.supply_id}).then((function(){e(),a.$router.back()})).catch((function(){e(!1)}))},submit:function(){var e=this,a=t.cloneDeep(this.taskData);if(t.isEmpty(a.section)||!a.section.id)return r.a.alert("请选择所属标段"),!1;if(t.isEmpty(a.material)||!a.material.id)return r.a.alert("请选择材料"),!1;if(!a.supplier||!a.supplier.id)return r.a.alert("请选择材料供应商"),!1;if(this.placeRequired&&!a.place)return r.a.alert("请填写使用部位"),!1;if(t.isEmpty(a.contractor)||!a.contractor.id)return r.a.alert("请选择接收单位"),!1;if(t.isEmpty(a.checker)||!a.checker.id)return r.a.alert("请选择监理"),!1;if(t.isEmpty(a.constructers)&&a.needConstructer)return r.a.alert("请选择建设单位负责人"),!1;/^custom\-[\d]+$/.test(a.material.id)&&(a.material.id=""),a.materialType&&a.materialType.length&&t.each(a.materialType,(function(t){/^custom\-[\d]+$/.test(t.id)&&(t.id="")}));var i=u.a.getUserObject(h.a.MATERIAL_DEFAULT_SECTION)||{};i[this.proj_id]=this.taskData.section,u.a.saveUserObject(h.a.MATERIAL_DEFAULT_SECTION,i);var n=this.allowSupplyOrder?{shipping_id:this.taskData.shipping_id}:{};return g.a.checkHasNetwork(!0).then((function(){return l.a.addTask(e.proj_id,a,n).then((function(t){"preCreated"!==e.statusComputed&&v.a.setUserKey(k.a.MATERIAL_NEED_CONSTRUCTER,a.needConstructer),e.taskData.id=t})).then((function(){if(e.allowSupplyOrder){var t={id:e.supply_id,status:"待申请进场",task_id:e.taskData.id};return l.a.saveSupplyOrderData(t)}})).then((function(){return e.$router.replace("/material-index")})).then((function(){var t=e.taskData;return b.a.saveTodo({biz_id:t.id,module_code:"material",proj_id:t.section.proj_id,type:t.receiver.id===e.userData.id?1:2})})).catch((function(t){r.a.alert(t),$log.log("添加任务失败")}))})).catch((function(e){$log.error(e),t.isObject(e)&&!0===e.noNetwork&&r.a.alert("请在有网络的环境下新建任务")}))}}}}).call(this,a("391c"))},8827:function(t,e,a){"use strict";a("90c5")},"88c7":function(t,e,a){"use strict";var i=a("c7df").a,n=a("17cc"),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{on:{click:t.openSelect}},[t.$slots.default?t._t("default"):a("item",{class:t.required,attrs:{label:t.title,text:t.selectVal,mode:t.mode,editabled:t.editabled,placeholder:t.required?"请选择":"选填"}},[t.$slots.right?t._t("right",null,{slot:"right"}):t._e()],2)],2)}),[],!1,null,null,null);e.a=o.exports},"8b97":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .cover[data-v-02a5f460] path{fill:#fff!important}",""])},"8bf4":function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e"),a("cc57");var i=a("28f8"),n=a("4c09"),o=a("07d2"),r=a("e68e"),s=a("cd05"),c=a("3c64"),l=a("6948"),d=a("e2a7"),p=a("0636"),u=(a("f479"),a("24de"),a("ed08"),a("3bd5"));function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}e.a={name:"MaterialDetailApproachView",components:{Item:o.default,ItemImgList:r.a,UserSelect:s.a,ItemTextarea:c.a,NumberInput:l.a},props:{model:{type:Object,default:function(){return{}}},isCheckerPhotoType:{type:Boolean},curUserId:{type:String,default:""},pushInSaveStack:{type:Function},prepareTakePicture:{type:Function},beforeChangeChecker:{type:Function,default:function(){}},beforeConstruter:{type:Function,default:function(){}},earlyPass:{type:Function},earlyUnPass:{type:Function}},data:function(){return{selectedCC:[],selectedChecker:{},needCheck:!1}},computed:{checkerEditabled:function(){return!!(this.model.earlyData&&this.model.earlyData.checker&&this.model.earlyData.checker.id)&&(this.curUserId===this.model.earlyData.checker.id&&"待验收"===this.model.batchData.status&&!this.model.earlyData.status)},checkerNote:function(){return this.model.earlyData&&this.model.earlyData.checker&&this.model.earlyData.checker.id&&(this.curUserId!==this.model.earlyData.checker.id||this.model.earlyData.status||"待验收"!==this.model.batchData.status)?this.model.earlyData.early_result:""},allowSupplyOrderEdit:function(){return this.model.supplyData.allowSupplyOrderReturn}},mounted:function(){console.log("approachView mounted",this.model),this.selectedCC=Object(n.a)(this.model.batchData.cc),this.selectedChecker=function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},this.model.batchData.checker)},methods:{beforeChange:function(t){return this.beforeChangeChecker(t)},changeEarlyChecker:function(t){this.$emit("changeChecker",t)},changeNeedCheck:function(t){this.$set(this.model.batchData,"needCheck",t)},beforeChangeConstruter:function(t){return this.beforeConstruter(t)},changeInspection:function(t){this.$set(this.model.batchData,"checker",t)},changeCcer:function(t){this.$set(this.model.batchData,"cc",t),this.pushInSaveStack("saveEarlyLog")},submitAgain:function(){var e=this,a=this.model.approachData.brands;if(t.some(a,(function(e){return t.some(e.standard,(function(e){return e.specification&&e.specification.length?t.some(e.specification,(function(t){return void 0===t.num||null===t.num||""===t.num})):void 0===e.num||null===e.num||""===e.num}))})))d.a.alert("请添加所有的数量");else{var i=[],n=!0,o="",r=this.model.batchData,s=this.model.approachData;u.a.getUser();if(t.each(a,(function(e){t.each(e.standard,(function(t){if(t.specification&&t.specification.length)for(var a=0;a<t.specification.length;a++){var c=t.specification[a];/^\d+(?=\.{0,1}\d+$|$)/.test(c.num)?c.name?i.push({task_id:r.id,material_id:s.material.id,material:s.material.name,brand_id:e.id,brand:e.name,material_type_id:t.id,material_type:t.name,specification_id:c.id,specification:c.name,quantity_unit:t.quantity_unit||s.standard_unit,quantity:c.num,id:c.detailId}):(n=!1,o="请输入规格名称"):(n=!1,o="请输入正确的规格数量")}else{if(!/^\d+(?=\.{0,1}\d+$|$)/.test(t.num)||t.num<0)return n=!1,o="请填写正确的数量",!1;i.push({task_id:r.id,material_id:s.material.id,material:s.material.name,brand_id:e.id,brand:e.name,material_type_id:t.id,material_type:t.name,quantity_unit:t.quantity_unit||s.standard_unit,quantity:t.num,id:t.detailId})}}))})),n){var c=this.model.supplyData.shipping_image;if(0!==c.length){var l=this.model.batchData.status,h={id:this.model.supplyData.id,shipping_image:JSON.stringify(c),status:l},m={brandList:i,id:this.model.batchData.id,status:l};return console.log(m,t.cloneDeep(this.model.approachData.brands)),p.a.saveSupplyOrderSubmitAgain(m,h,!0).then((function(){e.model.loadApproach(),e.model.getSupplyDetail()}))}d.a.alert("请添加供货单照片")}else d.a.alert(o)}}}}}).call(this,a("391c"))},"8c3d":function(t,e,a){"use strict";(function(t){a("ed63"),a("163d"),a("2b45"),a("e204"),a("cc57");var i,n,o=a("07d2"),r=a("cf09"),s=a("6f9e"),c=a("4360"),l=[],d=[0,1,2,3,4,5,6,7,8,9,".","-"];function p(t){return null!=t&&""!==t}e.a={name:"NumberKeyboard",components:{Item:o.default},data:function(){return{show:!1,isClosing:!1,zIndex:0,willOpenParams:null,inputComponent:"",type:"",hasPrev:!1,hasNext:!1,isDisabledMinus:!1,isDisabledPoint:!1}},computed:{isIOSBezelLess:function(){return c.a.state.app.isIOSBezelLess}},watch:{isClosing:function(t){var e=this;this.$nextTick((function(){!t&&e.willOpenParams&&e.openKeyboard(e.willOpenParams)}))}},created:function(){s.a.$on("routerBeforeEach",this.closeKeyboard),s.a.$on("pageContentClick",this.closeKeyboard)},destroyed:function(){s.a.$off("routerBeforeEach",this.closeKeyboard),s.a.$off("pageContentClick",this.closeKeyboard)},methods:{openKeyboard:function(t){this.isClosing?this.willOpenParams=t:(this.willOpenParams=null,this.show=!0,this.inputComponent=t.inputComponent,this.zIndex=r.a?++r.a.zIndex:1,c.a.commit("global/SET_IS_NUMBER_INPUT_OPEN",!0),c.a.commit("global/SET_NUMBER_KEYBOARD_HEIGHT",c.a.state.app.isIOSBezelLess?266:"true-or-false"===this.inputComponent.type?176:232),this.calcTab(),this.type=this.inputComponent.type,this.setKeysStatus(this.inputComponent.value,this.inputComponent.type),s.a.$emit("numberKeyboardOpen",this.inputComponent))},closeKeyboard:function(){this.show=!1,s.a.$emit("numberKeyboardClose")},startClose:function(){this.isClosing=!0},onClose:function(){this.isClosing=!1,c.a.commit("global/SET_IS_NUMBER_INPUT_OPEN",!1),s.a.$emit("afterNumberKeyboardClose")},input:function(t){"-"===t&&this.isDisabledMinus||"."===t&&this.isDisabledPoint||this.$emit("keyboardInput",t)},delete:function(t){var e=this;this.$emit("keyboardDelete"),i=setTimeout((function(){e.$emit("keyboardClear")}),500)},calcTab:function(){var e=function t(e){return e&&e.$parent?"Scroller"===e.$parent.$options.name?e.$parent:t(e.$parent):null}(this.inputComponent),a=e&&e.$el.querySelectorAll(".component-number-input");if(l=[],a&&t.each(a,(function(t){l.push(t.__vue__)})),t.isEmpty(l))this.hasPrev=!1,this.hasNext=!1;else{var i=t.findIndex(l,this.inputComponent);this.hasPrev=i>0,this.hasNext=i<l.length-1}this.inputComponent&&this.inputComponent.nextEvent&&(this.hasNext=!0)},prev:function(){var e=t.findIndex(l,this.inputComponent),a=l[e-1];a&&(s.a.$emit("numberInputBlur"),a.setFocus(),this.openKeyboard({inputComponent:a}))},next:function(){var e=t.findIndex(l,this.inputComponent),a=l[e+1];a?(s.a.$emit("numberInputBlur"),a.setFocus(),this.openKeyboard({inputComponent:a})):this.inputComponent&&this.inputComponent.nextEvent&&this.inputComponent.nextEvent()},setTure:function(){this.$emit("keyboardAssign",1)},setFalse:function(){this.$emit("keyboardAssign",0)},setKeysStatus:function(t,e){t=p(t)?t.toString():"",p(t)||e.indexOf("positive")>=0?this.isDisabledMinus=!0:this.isDisabledMinus=!1,!/\d/.test(t)||t.indexOf(".")>=0||e.indexOf("int")>=0?this.isDisabledPoint=!0:this.isDisabledPoint=!1},setKeyActiving:function(t,e){t&&t.classList.contains("keys")&&!t.classList.contains("disabled")&&(e?t.classList.add("activing"):t.classList.remove("activing"))},keyTouchstart:function(t){var e=t&&t.target;if(e){+new Date,n=e,this.setKeyActiving(e,!0);var a=e.getAttribute("direct");"closeKeyboard"!==a&&this.clickHandler(a)}},keyTouchend:function(t){var e=t&&t.target;if(e){this.setKeyActiving(e,!1),this.setKeyActiving(n,!1);var a=e.getAttribute("direct");"delete"===a?clearTimeout(i):"closeKeyboard"===a&&this.clickHandler(a)}},clickHandler:function(t){t&&(isNaN(t)||(t=Number(t)),"function"==typeof this[t]?this[t]():d.includes(t)&&this.input(t))}}}}).call(this,a("391c"))},"8c64":function(t,e,a){"use strict";(function(t){var i=a("4c09"),n=(a("e697"),a("cc57"),a("5a71")),o=a("88c7"),r=a("6f9e"),s=a("e2a7"),c=a("a500");e.a={name:"MaterialInfoSelect",components:{SingleSelect:n.a,MultiSelect:o.a},props:{title:{type:String,default:""},value:{type:[Object,Array]},multi:{type:Boolean,default:!1},options:{type:Array,default:function(){return[]}},optionsDisabled:{type:Array,default:function(){return[]}},rightBtn:{type:String,default:""},customType:{type:String,default:"1"},grouping:{type:String,default:""},beforeOpen:{type:Function},standardUnit:{type:String,default:""},editabled:{type:Boolean,default:!0},formCheck:{type:Boolean,default:!1}},data:function(){return{selected:this.multi?[]:{},showCustom:!1,customMaterialCategory:"",customName:"",customMaterialUnit:"",customFormError:!1,materialCategory:[],units:[{id:"包",name:"包"},{id:"卷",name:"卷"},{id:"匹",name:"匹"},{id:"套",name:"套"},{id:"桶",name:"桶"},{id:"支",name:"支"},{id:"只",name:"只"},{id:"组",name:"组"},{id:"根",name:"根"},{id:"箱",name:"箱"},{id:"米",name:"米"},{id:"台",name:"台"},{id:"盏",name:"盏"},{id:"个",name:"个"},{id:"片",name:"片"},{id:"块",name:"块"},{id:"吨",name:"吨"},{id:"樘",name:"樘"},{id:"棵",name:"棵"},{id:"株",name:"株"},{id:"公斤",name:"公斤"},{id:"平方米",name:"平方米"},{id:"立方米",name:"立方米"},{id:"其它",name:"其它"}]}},watch:{value:function(t){this.selected=t},showCustom:function(t){var e=this;t&&this.$nextTick((function(){e.$refs["custom-input"].focus()}))}},mounted:function(){this.value&&(this.selected=this.value)},methods:{onHandleSelect:function(e){t.has(e,"num")&&(e.num=""),this.selected=e,this.$emit("input",e),this.$emit("onSelect",e),r.a.$emit("closeDialog")},showCustomDialog:function(t){this.customMaterialUnit=this.standardUnit,this.materialCategory=t,this.customMaterialCategory=t[0],this.showCustom=!0,c.a.addTrack("材料验收-手工添加材料".concat(this.title),"","")},selectMaterialCategory:function(t){this.customMaterialCategory=t},selectCustomMaterialUnit:function(t){this.customMaterialUnit=t.name},customSubmit:function(e,a){var n,o,r=this;if("confirm"===e){if(!this.customName)return this.customFormError=!0,a(!1);switch(this.customType){case"1":(o=t.find(this.options,(function(t){return t.name===r.customName})))?n=o:(n={id:"custom-"+(new Date).getTime(),name:this.customName,checked:!0},this.options.push(n));break;case"2":if(!this.customMaterialUnit)return this.customFormError=!0,a(!1);(o=t.find(this.options,(function(t){return t.name===r.customName})))?n=o:(n={id:"custom-"+(new Date).getTime(),name:this.customName,checked:!0,quantity_unit:this.customMaterialUnit},this.options.push(n));break;case"3":if(!this.customMaterialUnit)return this.customFormError=!0,a(!1);(o=t.find(this.options,(function(t){return t.name===r.customName&&t.category_name===r.customMaterialCategory})))?n=o:(n={id:"custom-"+(new Date).getTime(),name:this.customName,checked:!0,quantity_unit:this.customMaterialUnit,category_name:this.customMaterialCategory},this.options.push(n))}n.disabled?s.a.alert("“"+this.customName+"”已存在，且不可选"):this.multi?(this.selected=this.$refs.multiSelectDialog.getDialogValue(),this.$refs.multiSelectDialog.setDialogValue([].concat(Object(i.a)(this.selected),[n]))):this.onHandleSelect(n),this.resetData(),a()}else this.resetData(),a()},resetData:function(){this.showCustom=!1,this.customMaterialCategory="",this.customName="",this.customMaterialUnit="",this.customFormError=!1}}}}).call(this,a("391c"))},"8d95a":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,"[data-v-186d9147] .layout-content{overflow:auto}",""])},"8fcf":function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e"),a("e697"),a("c04d");var i=a("f585"),n=(a("cc57"),a("28f8")),o=a("fd50"),r=a("1b7e"),s=a("6632"),c=a("0636"),l=a("14c3"),d=a("3bd5"),p=a("e2a7"),u=a("0136"),h=a("48f4"),m=a("4ad6"),f=a("9bcb"),g=a("f711"),b=a("7460"),v=a("f369"),k=a("cd05"),y=a("b6c2"),_=a("2e84"),D=a("f2a6"),x=a("cd5a"),w=a("68a0"),C=a("bb6b"),S=a("b50d"),j=a("e6d8"),O=a("605d"),I=a("e5c6"),L=a("6f9e");function T(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}e.a={name:"MaterialDetail",components:{TemplateGuide:b.a,CheckGuide:v.a,UserSelect:k.a,MaterialTaskForm:y.a,MaterialDetailTask:_.a,MaterialDetailApproach:D.a,MaterialDetailApproachView:x.a,MaterialDetailCheck:w.a,MaterialDetailCheckView:C.a,MaterialDetailReport:S.a,MaterialDetailReportView:j.a,MaterialDetailBack:O.a,MaterialDetailBackView:I.a,MaterialTaskVoidDialog:g.a},data:function(){return{taskMode:"view",taskInfo:{},initTabContent:-1,task_id:"",isLoading:!1,isIeceiverPhotoType:!1,isCheckerPhotoType:!1,isShowTamplate:!1,curUserId:"",saveStack:[],locked:!1,revoking:!1,checkSubmitting:!1,model:{reportData:{},conCheckList:[],approachData:{},approachLoading:!0,taskData:{},batchData:{task_name:""},earlyData:{checker:{id:""}}},viewSize:$rootScope.viewSize}},computed:{allowIsSupply:function(){return this.model.supplyData.id}},created:function(){var t=this;console.log("created ---------------------------\x3e "),Object(L.d)((function(e){console.log("材料验收-进场-冲突数据：",e,t.model.batchData&&e.id===t.model.batchData.id),t.model.batchData&&e.id===t.model.batchData.id&&(t.model.loadApproach(),t.model.getSupplyDetail())}))},activated:function(){var t=this;this.curUserId=d.a.getUser().user_id,o.a.all([c.a.getMaterialIsPhotoList(1),c.a.getMaterialIsPhotoList(2)]).then((function(e){t.isIeceiverPhotoType=e[0].length>0,t.isCheckerPhotoType=e[1].length>0})),this.init(),document.addEventListener("pause",this.onPause,!1)},deactivated:function(){this.revoke(),this.$set(this.model,"taskMode","view"),document.removeEventListener("pause",this.onPause,!1)},methods:{getTemplateStatus:function(t){console.log(t),this.isShowTamplate=t},onPause:function(){m.a.isRunningBack||this.revoke()},init:function(){var t=this,e=this.$route.params.id;this.task_id=e,this.isLoading=!0,f.a.getOneTask(e).then((function(e){t.taskInfo=e})),s.a.init(e).then((function(a){return t.isLoading=!1,t.initTabContent=s.a.partIndex,t.model=s.a,t.$set(t.model,"checkData",function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?T(Object(a),!0).forEach((function(e){Object(n.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},s.a.checkData)),l.a.getRecoverData().then((function(a){var i=a&&a.data&&a.data[2]&&a.data[2].id;if(a&&"material"===a.module&&i===e)return l.a.getRecoverMedia().then((function(e){return $log.log("恢复材料验收数据"),"approach"===a.step?t.model.recoverApproachData(a,e).then((function(){"edit"!==t.model.approachMode||t.model.approachEmpty?"view"!==t.model.approachMode||t.model.approachEmpty||(t.pushInSaveStack("saveEarlyLog"),t.pushInSaveStack("photoTypeSaveLog","checkerImg"),t.pushInSaveStack("saveEarlyLog")):(t.pushInSaveStack("approachSaveLog"),t.pushInSaveStack("photoTypeSaveLog","receiverImg"),t.pushInSaveStack("approachSaveDetail"))})):"check"===a.step?t.model.recoverCheckData(a,e).then((function(){t.pushInSaveStack("saveCheckBrand"),t.pushInSaveStack("saveCheckLog")})):"report"===a.step?t.model.recoverReportData(a,e).then((function(){t.pushInSaveStack("saveReportLog")})):"back"===a.step?t.model.recoverBackData(a,e).then((function(){t.pushInSaveStack("backSaveLog")})):void 0})).then((function(){l.a.clear()}))}))}))},changeTabName:function(t){this.$refs.materialTabContent.swipeTo(t)},changeTabContent:function(t){this.revoke(),this.model.partIndex=t,this.model.partGo(this.model.tabs[t]),t&&(this.model.taskMode="view")},pushInSaveStack:function(){if(!this.locked){for(var t=[].slice.call(arguments,0),e=t[0],a=!1,i=0;i<this.saveStack.length;i++)if(this.saveStack[i].fun===e&&this.saveStack[i].args.length===t.length-1&&JSON.stringify(this.saveStack[i].args)===JSON.stringify(t.slice(1))){a=!0;break}!1===a&&this.saveStack.push({fun:e,args:t.slice(1)})}},revoke:function(){var t=this;if(this.revoking)return o.a.resolve();console.time("材料验收暂存");var e=o.a.resolve();this.locked=!0,this.revoking=!0;for(var a=0;a<this.saveStack.length;a++)e=e.then(function(e){return function(){return t.wrapPromise(e)}}(this.saveStack[a]));return e.finally((function(){console.timeEnd("材料验收暂存"),t.locked=!1,t.revoking=!1,t.saveStack.length&&l.a.clear(),t.saveStack.length=0}))},wrapPromise:function(t){var e=o.a.defer(),a=e.promise,i=t.fun,n=t.args;return this[i]?(o.a.when(this[i].apply(this,n)).finally((function(){e.resolve()})),a):(console.error("$scope没有方法："+i),o.a.resolve())},changeSection:function(e){this.model.loadContractor().finally((function(){loadAreaCheckers(e.id,t.map(taskData.materialType,"id"))}))},loadAreaCheckers:function(e,a){var i=this.model.taskData||{};if(!t.isEmpty(i.materialType))return BuildingService.getAreaCheckerSetting(e,a).then((function(t){i.isAreaCheckOn=t.isAreaCheckOn,t.isAreaCheckOn&&(i.areaCheckers=t.checkers)}))},editTask:function(){this.model.taskMode="edit"},saveTask:function(){var e=this;return r.a.getHasNetwork().then((function(a){if(a){var n=t.clone(e.model.taskData);return/^custom\-[\d]+$/.test(n.material.id)&&(n.material.id=""),c.a.saveTask(t.clone(e.model.batchData),n,!0).then((function(){return e.model.batchData.cc=e.model.taskData.cc,u.a.saveTodo({biz_id:e.model.batchData.id,module_code:"material",type:n.receiver.id===e.curUserId?1:2}).then((function(){return c.a.getTask(e.model.batchData.id)})).then((function(t){return e.model.batchData.task_base=t,e.model.loadTask().then((function(){e.model.taskMode="view";var t=e.$route.params.id;c.a.getTaskBaseInfo(t).then((function(t){e.model.batchData.task_name=t.name,Object(i.a)("保存成功")}))}))}))})).catch((function(t){console.log("修改任务内容失败：",t)}))}p.a.alert("离线状态下不能修改！")}))},deleteTask:function(){var t=this;if(!this.allowIsSupply){var e={title:"确定删除任务？",cancelText:"取消",okText:"删除",callback:function(e){e&&c.a.deleteTask(t.model.batchData.id).then((function(){h.default.setLocalChanged(),t.$router.back()})).then((function(){return u.a.removeTodo(t.model.batchData.id)})).catch((function(t){p.a.alert(t)}))}};return p.a.popBox(e)}this.$refs.materialTaskVoidDialog.show=!0},supplyOrderTaskVoid:function(t,e){var a=this;c.a.submitSupplyOrderTaskVoid({cancel_reason:t,id:this.model.supplyData.id,task_id:this.model.batchData.id}).then((function(){e(),a.$router.back()})).catch((function(){e(!1)}))},approachSubmitSuccess:function(){console.log("申请进场验收，提交成功！"),this.model.batchData.status="待验收",this.model.approachMode="view",this.model.loadApproach()},approachSaveDetail:function(){return c.a.saveApproachDetail(t.clone(this.model.batchData),t.clone(this.model.approachData)).then((function(t){return c.a.saveDetailDraft(t)}))},approachSaveLog:function(){var e=this;return c.a.saveApproachLog(t.clone(this.model.batchData),t.clone(this.model.approachData)).then((function(t){return e.model.batchData.approachLogId=t,t})).then((function(t){return c.a.saveLogDraft(t)}))},photoTypeSaveLog:function(e){var a=this;return c.a.saveApproachPhoto(t.clone(this.model.batchData),t.clone(this.model.approachData),e).then((function(i){return t.each(i,(function(t,i){a.model.approachData[e][i].id=t})),i})).then((function(t){return c.a.savePhotoTypeDraft(t)}))},saveEarlyLog:function(e){var a=this,i=t.clone(this.model.activeLog);return c.a.saveEarlyLog(t.clone(this.model.batchData),i).then((function(t){return a.model.batchData.earlyLogId=t,t})).then((function(t){return c.a.saveLogDraft(t)}))},earlyPass:function(){var e=this,a=this.model.activeLog;if("监理"===a.type){if(!0!==this.model.batchData.needCheck&&!1!==this.model.batchData.needCheck)return void p.a.alert("请选择是否送检");if(!0===this.model.batchData.needCheck&&(t.isEmpty(this.model.batchData.checker)||!this.model.batchData.checker.id))return void p.a.alert("请选择送检人");if(this.isCheckerPhotoType){var i=!0;if(t.each(this.model.approachData.checkerImg,(function(e){t.isEmpty(e.image_file)&&(i=!1)})),!i)return void p.a.alert("请按要求拍照")}else if(t.isEmpty(this.model.activeLog.img))return void p.a.alert("请添加验收照片")}return p.a.confirm("确认进场验收合格？",{okText:"合格"}).then((function(i){if(i)return e.revoke().then((function(){return"监理"===a.type?c.a.earlyPass(t.clone(e.model.batchData),t.clone(e.model.approachData),t.clone(e.model.activeLog)):"建设单位"===a.type?c.a.constructerPass(t.clone(e.model.batchData),t.clone(e.model.approachData),t.clone(e.model.activeLog),e.model.conCheckList):c.a.areaCheckerPass(t.clone(e.model.batchData),t.clone(e.model.approachData),t.clone(e.model.activeLog))})).then((function(t){e.model.batchData.status=t||e.model.batchData.status,e.model.init(e.model.task_id).then((function(){e.changeTabName(e.model.partIndex)}))})).catch((function(t){console.error("初验合格，报错",t)}))}))},earlyUnPass:function(){var e=this,a=this.model.activeLog;if("监理"===a.type)if(this.isCheckerPhotoType){var i=!0;if(t.each(this.model.approachData.checkerImg,(function(e){t.isEmpty(e.image_file)&&(i=!1)})),!i)return void p.a.alert("请按要求拍照")}else if(t.isEmpty(a.img))return void p.a.alert("请添加验收照片");return p.a.confirm("确认进场验收不合格？",{okText:"不合格"}).then((function(a){if(a)return e.revoke().then((function(){return c.a.earlyUnPass(t.clone(e.model.batchData),t.clone(e.model.approachData),t.clone(e.model.activeLog))})).then((function(){e.model.loadApproach(),$log.log("材料任务状态：",e.model.batchData.status),e.model.batchData.status="待退场",$log.log("材料任务状态：",e.model.batchData.status),e.model.tabs=["任务","进场","退场"],e.model.earlyPass=!1,e.model.partNum=e.model.tabs.length,e.model.partIndex=e.model.tabs.length-1,e.$refs.materialTabContent.swipeTo(e.model.partIndex)})).catch((function(t){console.error("初验不合格，报错",t)}))}))},beforeChangeChecker:function(t){var e=!1;return console.log("this.model.batchData.task_base.constructers",this.model.batchData.task_base.constructers),"建设单位"===this.model.activeLog.type?this.model.batchData.task_base.supervisor===t.id&&(e=!0):this.model.batchData.task_base.constructers.find((function(e){return e.id===t.id}))&&(e=!0),e?(p.a.alert("同一个人不能是监理和建设单位验收人"),Promise.resolve(!1)):Promise.resolve(this.model.activeLog.checker.id!==t.id)},changeEarlyChecker:function(e){var a=this;return this.model.activeLog.checker=e,c.a.changeEarlyChecker(t.clone(this.model.batchData),t.clone(this.model.approachData),t.clone(this.model.activeLog),"建设单位"===this.model.activeLog.type&&this.model.conCheckList).catch((function(t){p.a.alert(t)})).finally((function(){a.model.loadApproach()}))},saveCheckBrand:function(){return c.a.saveCheckBrands(t.clone(this.model.checkData.brands),this.model.isFirstCheck).then((function(t){return c.a.saveDetailDraft(t)}))},saveCheckLog:function(){var e=this;return console.log("checkData",this.model.checkData),c.a.saveCheckLog(this.model.batchData.checkLogId,t.clone(this.model.checkData)).then((function(){return c.a.saveLogDraft(e.model.batchData.checkLogId)}))},checkSubmit:function(){var e=this,a=!1;return this.checkSubmitting&&(p.a.loading("当前数据已提交，请稍等"),a=!0),this.checkSubmitting=!0,this.revoke().then((function(){return c.a.checkSubmit(t.clone(e.model.batchData),t.clone(e.model.checkData),e.model.isFirstCheck)})).then((function(){return e.model.loadCheck()})).then((function(){e.changeTabName(++e.model.partIndex)})).finally((function(){e.checkSubmitting=!1,a&&p.a.hideLoading()}))},backSubmit:function(){var e=this;if(!t.isEmpty(this.model.backData.img))return p.a.confirm("确定提交退场吗？").then((function(a){if(a)return e.revoke().then((function(){return c.a.submitBack(t.clone(e.model.backData))})).then((function(){e.model.loadBack()}))}));p.a.alert("请添加退场照片")},backSaveLog:function(){var e=this;c.a.saveBackLog(t.clone(this.model.backData)).then((function(){return c.a.saveLogDraft(e.model.backData.backLogId)}))},changeBackChecker:function(){var e=this;return c.a.changeBackChecker(t.clone(this.model.backData)).then((function(){e.model.loadBack()}))},changeCheckChecker:function(){var e=this;return c.a.changeCheckChecker(t.clone(this.model.batchData),t.clone(this.model.checkData)).then((function(){e.model.loadCheck()})).catch((function(t){p.a.alert(t),e.model.loadCheck()}))},reportSubmit:function(){var e=this;return this.revoke().then((function(){return c.a.reportSubmit(t.clone(e.model.batchData),t.clone(e.model.reportData))})).then((function(){e.model.loadReport()}))},reportBack:function(){var e=this;return this.revoke().then((function(){return c.a.reportBack(t.clone(e.model.batchData),t.clone(e.model.reportData))})).then((function(){e.model.loadReport().then((function(){e.model.partIndex--,e.changeTabName(e.model.partIndex)}))}))},changeReportChecker:function(){var e=this;return c.a.changeReportChecker(t.clone(this.model.batchData),t.clone(this.model.reportData)).then((function(){e.model.loadReport()})).catch((function(t){p.a.alert(t),e.model.loadReport()}))},saveReportLog:function(){var e=this;return c.a.saveReportLog(t.clone(this.model.reportData)).then((function(){return c.a.saveLogDraft(t.clone(e.model.reportData).reportLogId)}))},retestSubmit:function(){var e=this;return this.revoke().then((function(){return c.a.retestSubmit(t.clone(e.model.batchData),t.clone(e.model.reportData))})).then((function(){e.model.loadReport()}))},retestBack:function(){var e=this;return this.revoke().then((function(){return c.a.retestBack(t.clone(e.model.batchData),t.clone(e.model.reportData))})).then((function(){e.model.loadReport(),$log.log("材料任务状态：",e.model.batchData.status),e.model.batchData.status="待退场",$log.log("材料任务状态：",e.model.batchData.status),e.model.partNum=5,e.model.tabs=["任务","进场","送检","报告","退场"],e.model.batchData.hasCheckRecord=!0,e.model.earlyPass=!1,e.model.partIndex=4,e.changeTabName(e.model.partIndex)}))},beforeChangeConstruter:function(e){var a=this;return this.beforeChangeChecker(e).then((function(i){if(i){if(e.id===a.model.activeLog.checker.id)return!1;if(t.find(a.model.conCheckList,(function(t){if(e.id===t.checker.id)return!0})))return p.a.alert("【"+e.name+"】已经存在当前验收任务中").then((function(){return!1}))}return i}))},prepareTakePicture:function(e,a,i,n){l.a.save({module:"material",data:t.clone(e),step:a,imageField:i,photoRequirementId:n})}}}}).call(this,a("391c"))},9020:function(t,e,a){"use strict";a("41b9")},9094:function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return s})),a.d(e,"a",(function(){return c}));var i=a("5e8d"),n=a("da71"),o=a("162a");function r(){return Object(i.a)().then((function(){var t=n.a.materialList.url;return o.a.request(t)}))}function s(t){return Object(i.a)().then((function(){var e=n.a.contractorListByProject.url;return o.a.request(e,t)}))}function c(t){return Object(i.a)().then((function(){var e=n.a.getContractList.url;return o.a.request(e,t)}))}},"90a0":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .delivery-note_item[data-v-f9d9b95a]{margin:10px 0}.zjapp .wrap[data-v-f9d9b95a]{height:100%;padding-bottom:60px;overflow:auto}.zjapp .wrap[data-v-f9d9b95a] .item-label{width:40%}.zjapp .ctrl[data-v-f9d9b95a]{margin-top:15px}.zjapp .custom-material-dialog[data-v-f9d9b95a] .van-dialog__content{padding:20px}.zjapp .custom-material-dialog[data-v-f9d9b95a] .van-dialog__content span{display:inline-block;color:#333;height:30px;line-height:30px;padding:0 13px;text-align:center;font-size:15px;border:1px solid #dcdcdc;border-radius:4px}.zjapp .custom-material-dialog[data-v-f9d9b95a] .van-dialog__content span.checked{position:relative;border-color:#4275e8;color:#4275e8!important}.zjapp .custom-material-dialog[data-v-f9d9b95a] .van-dialog__content span.checked:before{position:absolute;content:" ";display:block;border:1px solid #4275e8;border-top:none;border-right:none;width:8px;height:4px;transform:rotate(-45deg);right:3px;bottom:5px}.zjapp .custom-material-dialog[data-v-f9d9b95a] .van-dialog__content>span{margin:0 5px 5px 0}',""])},"90c5":function(t,e,a){var i=a("ab032");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("a58d503c",i,!0,{sourceMap:!1,shadowMode:!1})},9120:function(t,e,a){var i=a("2ddb");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("cb55f532",i,!0,{sourceMap:!1,shadowMode:!1})},"91c1":function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e"),a("9a33");var i=a("28f8"),n=a("e68e"),o=a("6f9e"),r=a("bcc7"),s=a("e89f");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"CheckGuideDetailDrop",components:{ItemImgList:n.a},mixins:[s.a],data:function(){return{show:!1,showList:!1,isLoading:!1,isOpening:!1,isClosing:!1,contentTop:64,listHeight:510,module:"",itemIds:[],data:[],target:""}},watch:{show:function(t){var e=this;t&&this.$nextTick((function(){e.showList=!0}))}},created:function(){o.a.$on("routerBeforeEach",this.closePopup),o.a.$on("pageContentClick",this.onClickOther)},destroyed:function(){o.a.$off("routerBeforeEach",this.closePopup),o.a.$off("pageContentClick",this.onClickOther)},methods:{openPopup:function(e){this.show=!0,this.$emit("open"),this.module=e.module,this.itemIds=e.itemIds,this.options=e.options;var a=document.querySelector(".layout-main .layout-header");if(this.contentTop=a.offsetHeight,e.el){var i=e.el.getBoundingClientRect();this.contentTop=i.bottom}this.target=e.el,this.listHeight=t.minBy([window.innerHeight-this.contentTop-50,510]),this.getData()},closePopup:function(){var t=this;if(!this.isOpening)return this.showList=!1,this.$emit("close"),new Promise((function(e){t.$on("afterClosePopup",e)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},onClickOther:function(t){t&&t.target&&t.target!==this.target&&this.show&&this.closePopup()},getData:function(){var e=this;return this.options&&this.options.length?(this.data=t.map(this.options,(function(t){return l(l({},t),{},{isOpen:!1})})),Promise.resolve()):r.a.getMeasureCheckItem(this.itemIds).then((function(a){e.data=t.map(a,(function(e){var a=e.content?e.content.trim():"",i=a?a.split("\n"):[],n=e.content_image?JSON.parse(e.content_image):[],o=t.filter(i,(function(t){return!/<img([\s\S]*)>/gm.test(t)}));return t.each(n,(function(t){t.url=t.url.split("@")[0]})),{id:e.id,name:e.full_name,textArr:o,contentImage:n,isOpen:!1}}))})).catch((function(t){console.error(t)}))},toggleItem:function(t){this.data.length>1&&this.$set(t,"isOpen",!t.isOpen)}}}}).call(this,a("391c"))},"924b":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-13a9cf84]{height:100%;overflow:auto}.zjapp .van-popup--right[data-v-13a9cf84]{width:100%;height:100%}",""])},9446:function(t,e,a){var i=a("2dd6");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("2192cd00",i,!0,{sourceMap:!1,shadowMode:!1})},9459:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-6e76799c]{height:100%;overflow:auto}",""])},"95c9":function(t,e,a){"use strict";a("d258")},9788:function(t,e,a){"use strict";a("9446")},"9bc0":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .content[data-v-7898d325]{display:flex;flex-direction:column;flex:1;height:100%}.zjapp .content[data-v-7898d325] .item-img-list,.zjapp .content[data-v-7898d325] .item-img-list li,.zjapp .content[data-v-7898d325] .photo-list{transform:translateZ(0)}.zjapp .content .material-name[data-v-7898d325]{min-height:44px}.zjapp .content .wrap-scroll[data-v-7898d325]{padding-top:10px;padding-bottom:80px;display:flex;flex:1;flex-direction:column;height:100%;overflow:auto}.zjapp .content .txt[data-v-7898d325]{text-align:right}.zjapp .content .item-text[data-v-7898d325]{color:#666}.zjapp .content .brand-item[data-v-7898d325]{position:relative;margin-top:10px}.zjapp .content .brand-item>.item-icon-remove[data-v-7898d325]{left:14px}.zjapp .content .brand-item+.brand-item>span[data-v-7898d325] .item{padding-left:44px!important}.zjapp .content .add-btn[data-v-7898d325]{height:44px;line-height:44px;text-align:center;font-size:16px;background-color:#fff;color:#4275e8;border:none;background-image:linear-gradient(180deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0),linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px,100% 1px;background-repeat:no-repeat;background-position:top,bottom}.zjapp .content .mt10[data-v-7898d325]{margin-top:10px}.zjapp .content .alignL[data-v-7898d325]{text-align:left}.zjapp .content .photo-type[data-v-7898d325]{margin-top:7px;margin-bottom:15px;font-size:16px}.zjapp .content .photo-list[data-v-7898d325]{flex-direction:column;padding-bottom:15px;background-color:#fff}.zjapp .content .pic-list[data-v-7898d325]{padding:10px 0 10px 15px;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .content .brand-info-item[data-v-7898d325]{background:#fff;padding-left:45px;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .content .brand-info-item[data-v-7898d325] .item{padding-left:0}.zjapp .content .brand-info-item .brand-type[data-v-7898d325]{position:relative}.zjapp .content .item-icon-remove[data-v-7898d325]{position:absolute;display:inline-block;height:20px;width:20px;border-radius:30px;background-color:#ff3d3d;left:-30px;top:12px;z-index:1}.zjapp .content .item-icon-remove[data-v-7898d325]:before{content:" ";position:absolute;display:inline-block;width:13px;height:2px;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff}.zjapp .content .spec-item[data-v-7898d325]{position:relative;display:flex;min-height:44px;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .content .spec-item .item-text[data-v-7898d325]{line-height:36px}.zjapp .content .spec-item .align-r[data-v-7898d325]{position:relative;width:160px;padding-top:7px;padding-right:18px}.zjapp .content .spec-item .align-r[data-v-7898d325] .number-input{width:100%;padding-right:16px}.zjapp .content .spec-item .align-r[data-v-7898d325] .number-input input{text-align:right}.zjapp .content .spec-item .align-r .text[data-v-7898d325]{position:absolute;right:26px;top:14px}.zjapp .content .spec-item .align-r.unit_2[data-v-7898d325] .number-input{padding-right:30px}.zjapp .content .spec-item .align-r.unit_3[data-v-7898d325] .number-input{padding-right:42px}.zjapp .content .color-b2b2b2[data-v-7898d325]{color:#b2b2b2}',""])},"9e8c":function(t,e,a){"use strict";a("3f00")},a093:function(t,e,a){"use strict";(function(t){a("5ab2"),a("6d57"),a("e10e"),a("f548");var i=a("28f8"),n=(a("9dd9"),a("cc57"),a("e204"),a("9eea")),o=a("3156b"),r=a("774b"),s=a("e89f"),c=a("6f9e");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"AppSingleSelect",components:{appSearchBar:n.default,item:o.a,Scroller:r.default},mixins:[s.a],props:{},data:function(){return{activeTab:[],storageKey:encodeURI(this.title||"singleSelectMark"),storageVal:[],keyword:"",searchStatus:!1,checkedItem:{},show:!1,searchData:[],options:[],optionsLimit:20,pagingOptions:!1,searchBar:!0,category:[],ifToggle:!1,editorAddData:!1,lineLimit:1}},computed:{optionsShow:function(){return this.options&&this.options.length?this.grouping?this.getGroupData():this.options.slice(0,this.optionsLimit):[]}},watch:{keyword:function(t){var e=this;this.$nextTick((function(){e.filterList(t)}))}},methods:{openPopup:function(e){if(console.log(e),this.value=!0,this.show=!0,this.category=[],c.a.$on("closeDialog",this.closePopup),this.title=e.title,this.selected=e.selected,this.checkedItem=e.selected,this.options=e.options,this.onSelect=e.onSelect,this.searchBar=e.searchBar,this.grouping=e.grouping,this.rightBtn=e.rightBtn,this.rightBtnEvent=e.rightBtnEvent,this.ifToggle=e.ifToggle,this.lineLimit=e.lineLimit,this.editorAddData=e.editorAddData,e.grouping&&e.autoOpen){var a=t.uniqBy(t.map(this.options,e.grouping));this.activeTab=t.map(a,(function(t,e){return e}))}this.storageKey=encodeURI(this.title||"singleSelectMark"),this.$emit("open")},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeEvent:function(){c.a.$off("closeDialog",this.closePopup),this.value=!1,this.show=!1,this.keyword="",this.searchStatus=!1,this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch()},customAddSupplier:function(t){return this.options.findIndex((function(e){return e.name===t}))},selectItem:function(t){var e=this;this.ifToggle&&this.checkedItem.id===t.id?this.checkedItem={}:this.checkedItem=t,this.onSelect(this.checkedItem),this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].saveHistory(),window.setTimeout((function(){e.closeEvent()}),300)},onSearchTypeChange:function(t){this.searchStatus=t},filterList:function(t){var e,a,i=this,n=new RegExp("("+t+")","gmi");if(this.category=[],this.keyword=t,this.searchData=[],!t)return!1;this.options.map((function(t){return n.test(t.name)&&(a=d(d({},t),{},{rename:t.name.replace(n,"<label>$1</label>")}),i.grouping?-1===(e=i.category.indexOf(a[i.grouping]))?(i.category.push(a[i.grouping]),i.searchData.push({name:a[i.grouping],children:[a]})):i.searchData[e].children.push(a):i.searchData.push(a)),t}))},pageOptions:function(){this.optionsLimit=this.optionsLimit+20,this.pagingOptions=!1},getGroupData:function(){var t,e=this,a=[];return this.category=[],this.options.map((function(i){return-1===(t=e.category.indexOf(i[e.grouping]))?(e.category.push(i[e.grouping]),a.push({name:i[e.grouping],children:[i]})):a[t].children.push(i),i})),a}}}}).call(this,a("391c"))},a14f:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .convert[data-v-13aac6b6]{-webkit-animation:rotate-data-v-13aac6b6 2s linear infinite;animation:rotate-data-v-13aac6b6 2s linear infinite}.zjapp .icon[data-v-13aac6b6]{fill:#4275e8}@-webkit-keyframes rotate-data-v-13aac6b6{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes rotate-data-v-13aac6b6{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}",""])},a5c6:function(t,e,a){"use strict";var i=a("329b"),n=a("a093").a,o=(a("f3d7"),a("17cc")),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{attrs:{title:t.title,mode:"dialog","on-close":t.closeEvent}},[t.rightBtn&&!t.editorAddData||t.rightBtn&&t.editorAddData&&(!t.selected.name||t.customAddSupplier(t.selected.name)>-1)?a("div",{staticClass:"header-btn",attrs:{slot:"header-bar-right"},on:{click:function(e){t.rightBtnEvent(t.category)}},slot:"header-bar-right"},[t._v("\n      "+t._s(t.rightBtn)+"\n    ")]):t._e(),a("scroller",{attrs:{"has-next":!t.searchStatus&&!t.grouping&&t.optionsLimit<t.options.length,"end-text":"","is-empty":0===t.optionsShow.length},on:{loadNext:t.pageOptions}},[t.searchBar?a("app-search-bar",{ref:"app-search-bar",attrs:{placeholder:"搜索","history-key":t.storageKey},on:{changeSearchStatus:t.onSearchTypeChange},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):t._e(),t.searchStatus?[t.keyword?[t.grouping?a("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.searchData,(function(e,i){return a("van-collapse-item",{key:i,attrs:{title:e.name,name:i}},t._l(e.children,(function(e,i){return a("item",{key:i,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit,"render-field":"rename"},on:{click:t.selectItem}})})))}))):t._e(),t.grouping&&!t.searchData.length?a("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容","show-style":"search"}}):t._e(),t.grouping?t._e():[t._l(t.searchData,(function(e,i){return a("item",{key:i,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit,"render-field":"rename"},on:{click:t.selectItem}})})),t.searchData.length?t._e():a("loading-status",{attrs:{"is-empty":!0,"empty-text":"没有内容","show-style":"search"}})]]:t._e()]:["-1"===t.selected.id&&t.customAddSupplier(t.selected.name)<0&&t.editorAddData?a("div",{staticClass:"supplier-editor",on:{click:t.closePopup}},[a("span",{staticClass:"title"},[t._v(t._s(t.selected.name))]),a("span",{staticClass:"icon"},[a("i",{staticClass:"iconfont icon-edit margin-r",on:{click:t.rightBtnEvent}}),a("i",{staticClass:"iconfont icon-qualified"})])]):t._e(),t.grouping?a("van-collapse",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.optionsShow,(function(e,i){return a("van-collapse-item",{key:i,attrs:{title:e.name,name:i}},t._l(e.children,(function(e,i){return a("item",{key:i,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit},on:{click:t.selectItem}})})))}))):t._l(t.optionsShow,(function(e,i){return a("item",{key:i,attrs:{checked:t.checkedItem.id===e.id,item:e,"line-limit":t.lineLimit},on:{click:t.selectItem}})})),t.optionsShow.length?t._e():a("loading-status",{attrs:{"is-empty":!0,"empty-text":"暂无数据","show-style":"search"}})]],2)],1):t._e()],1)}),[],!1,null,"e465319c",null).exports,s=!1;s||(s=new(i.default.extend(r))({el:document.createElement("div")}),document.body.appendChild(s.$el));e.a=s},a63e:function(t,e,a){"use strict";a("45dc")},a779:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .report-wrap[data-v-6b2a34ff]{height:100%;padding-bottom:100px;overflow:auto}",""])},aa1f:function(t,e,a){var i=a("7274");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("5f53ac0f",i,!0,{sourceMap:!1,shadowMode:!1})},ab032:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .wrap[data-v-73693d74]{display:flex;flex-direction:column;transform:translateZ(0)}.zjapp .wrap.detail-wrap[data-v-73693d74]{padding-top:40px;max-height:100%}.zjapp .wrap .tabs[data-v-73693d74]{position:relative;height:40px;margin-top:-40px;line-height:40px;background-color:#fff;text-align:center;font-size:14px;z-index:1;border:none;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .wrap .tabs span[data-v-73693d74]{display:inline-block;padding:0 18px;position:relative}.zjapp .wrap .tabs .active[data-v-73693d74]{color:#4275e8}.zjapp .wrap .tabs .active[data-v-73693d74]:after{position:absolute;content:" ";display:block;width:6px;height:6px;border-radius:6px;background:#4275e8;bottom:-3px;left:50%;transform:translateX(-50%);transition:transform}.zjapp .wrap .swipe-content[data-v-73693d74]{height:100%}.zjapp .wrap .swipe-content .van-swipe-item[data-v-73693d74]{overflow:auto}.zjapp .wrap .edit-task[data-v-73693d74]{display:block;margin-top:10px}',""])},b056:function(t,e,a){"use strict";(function(t){a("f548"),a("cc57"),a("9dd9");var i,n=a("07d2"),o=a("6f9e"),r=a("e89f"),s=a("9eea"),c=a("774b");e.a={name:"SlideUpSelectDialog",components:{Item:n.default,appSearchBar:s.default,Scroller:c.default},mixins:[r.a],data:function(){return{show:!1,showList:!1,isOpening:!1,isClosing:!1,title:"",selected:{},options:[],showNote:"",emptyText:"",initHeight:null,listHeight:null,componentUid:"",searchKeyword:"",allowSearch:!1,allowSearching:!1,timer:null,historyKey:null,searchOptions:[],listLimit:100,listLimitSize:100}},computed:{renderData:function(){var t=this.options;return t&&t.length>this.listLimit?t.slice(0,this.listLimit):t||[]},hasNextPage:function(){return this.options&&this.options.length>this.listLimit}},watch:{searchKeyword:function(e){var a=this;this.$nextTick((function(){a.options=e?a.fitlerByKeyword(t.cloneDeep(a.searchOptions),e):t.cloneDeep(a.searchOptions)}))},show:function(t){var e=this;t&&this.$nextTick((function(){e.showList=!0}))},showList:function(t){t&&this.scrollToSelect()}},created:function(){o.a.$on("routerBeforeEach",this.closePopup),o.a.$on("pageContentClick",this.closePopup),window.addEventListener("native.keyboardshow",this.onResize,!1),window.addEventListener("native.keyboardhide",this.onResize,!1)},destroyed:function(){o.a.$off("routerBeforeEach",this.closePopup),o.a.$off("pageContentClick",this.closePopup)},methods:{openPopup:function(e){this.componentUid=e.componentUid||"",this.title="选择"+e.title,this.options=e.options,this.searchOptions=t.cloneDeep(e.options),this.selected=t.clone(e.selected),this.showNote=e.showNote,this.emptyText=e.emptyText,this.allowSearch=e.allowSearch,this.initHeight=e.initHeight,this.historyKey=e.historyKey,i=e.callback,this.show=!0,this.onResize(),this.clearScrollToTimeout()},closePopup:function(){var t=this;if(!this.isOpening)return this.showList=!1,this.clearScrollToTimeout(),this.cloneSearch(),new Promise((function(e){t.$on("afterClosePopup",e)}))},afterClose:function(){this.show=!1,this.isClosing=!1,this.$emit("afterClosePopup")},select:function(t){i(t),this.saveHistory(),this.closePopup()},scrollToSelect:function(){var t=this;this.$nextTick((function(){t.timer=window.setTimeout((function(){var e=document.querySelector("#slideUpSelectDialog .item .item-icon-right");e&&e.scrollIntoViewIfNeeded({block:"start",behavior:"smooth"}),t.clearScrollToTimeout()}),400)}))},clearScrollToTimeout:function(){clearTimeout(this.timer),this.timer=null},cloneSearch:function(){this.options=t.cloneDeep(this.searchOptions),this.searchKeyword="",this.$refs["app-search-bar-checkitem-select"]&&this.$refs["app-search-bar-checkitem-select"].cancelSearch()},saveHistory:function(){this.$refs["app-search-bar-checkitem-select"]&&this.$refs["app-search-bar-checkitem-select"].saveHistory()},setSearchMode:function(t){this.allowSearching=t,this.onResize()},onResize:function(e){var a=null,i=window.innerHeight;i-=$rootScope.viewSize.headerHeight-44,a=this.allowSearch&&this.allowSearching?i:t.minBy([.8*i,this.initHeight]),this.listHeight=a},fitlerByKeyword:function(e,a){var i=this,n=[];return t.each(e,(function(e){if(new RegExp(a,"gm").test(e.name))e.isOpen=!0,n.push(e);else if(!t.isEmpty(e.children)){var o=i.fitlerByKeyword(e.children,a);t.isEmpty(o)||(e.isOpen=!0,e.children=o,n.push(e))}})),n},keywordFilter:function(t){return this.searchKeyword?t.replace(new RegExp(this.searchKeyword,"gm"),'<span class="color-blue">'+this.searchKeyword+"</span>"):t},loadNext:function(){this.listLimit+=this.listLimitSize,this.listLimit>this.options.length&&(this.listLimit=this.options.length)},resultListLimit:function(){this.listLimit=this.listLimitSize}}}}).call(this,a("391c"))},b229:function(t,e,a){var i=a("1869");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("1ce3a096",i,!0,{sourceMap:!1,shadowMode:!1})},b23b:function(t,e,a){"use strict";function i(t,e){if(null==t)return{};var a,i,n=function(t,e){if(null==t)return{};var a,i,n={},o=Object.keys(t);for(i=0;i<o.length;i++)a=o[i],e.indexOf(a)>=0||(n[a]=t[a]);return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)a=o[i],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}a.d(e,"a",(function(){return i}))},b50d:function(t,e,a){"use strict";a("cc57");var i=a("e2a7"),n=a("07d2"),o=a("cd05"),r=a("e68e"),s=a("6314"),c={name:"MaterialDetailReport",components:{Item:n.default,ItemImgList:r.a,UserSelect:o.a},props:{model:{type:Object,default:function(){return{}}},pushInSaveStack:{type:Function},prepareTakePicture:{type:Function},changeReportChecker:{type:Function},reportSubmit:{type:Function},reportBack:{type:Function},retestSubmit:{type:Function},retestBack:{type:Function}},methods:{beforeSelect:function(t){return i.a.confirm("确定将送检人修改为【"+t.name+"】吗？").then((function(t){return t}))},firstReportDetail:function(){s.a.open(this.model.reportDataFirst)}}},l=(a("d6ae"),a("17cc")),d=Object(l.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"report-wrap"},[t.model.isFirstReport?t._e():a("item",{staticClass:"mb10 bg-sub-theme",attrs:{border:"bottom"},on:{click:t.firstReportDetail}},[a("div",{staticClass:"item-text"},[t._v("首次送检报告")]),a("div",{staticClass:"item-font color-light"},[t._v("查看")]),a("icon",{attrs:{name:"arrow-right"}})],1),a("item",{attrs:{border:"top-bottom"}},[a("div",{staticClass:"item-con pb10"},[a("div",{staticClass:"item-text"},[t._v("送检报告")]),a("item-img-list",{attrs:{maxlength:50,"allow-multi-select":!0,"prepare-callback":function(){return t.prepareTakePicture(t.model.reportData,"report","","")}},on:{callback:function(e){t.pushInSaveStack("saveReportLog")}},model:{value:t.model.reportData.img,callback:function(e){t.$set(t.model.reportData,"img",e)},expression:"model.reportData.img"}})],1)]),a("user-select",{attrs:{options:t.model.reportData.checkerList,title:"送检人",editabled:!0,"before-select":t.beforeSelect},on:{onSelect:t.changeReportChecker},model:{value:t.model.reportData.checker,callback:function(e){t.$set(t.model.reportData,"checker",e)},expression:"model.reportData.checker"}}),a("app-button-group",{attrs:{direction:"column"}},[t.model.isFirstReport?a("app-button",{on:{click:t.reportSubmit}},[t._v("\n      送检合格\n    ")]):t._e(),t.model.isFirstReport?a("app-button",{attrs:{type:"warning",plain:"",rimless:""},on:{click:t.reportBack}},[t._v("\n      需要复验\n    ")]):t._e(),t.model.isFirstReport?t._e():a("app-button",{on:{click:t.retestSubmit}},[t._v("\n      复验合格\n    ")]),t.model.isFirstReport?t._e():a("app-button",{attrs:{type:"warning",plain:"",rimless:""},on:{click:t.retestBack}},[t._v("\n      复验不合格\n    ")])],1)],1)}),[],!1,null,"6b2a34ff",null);e.a=d.exports},b55a:function(t,e,a){"use strict";a("c001")},b65c:function(t,e,a){"use strict";(function(t){a("5ab2"),a("e10e"),a("f548"),a("9dd9"),a("cc57");var i=a("28f8"),n=(a("6d57"),a("de78"),a("9eea")),o=a("b850"),r=a("774b"),s=a("e89f");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"AppMultiSelect",components:{appSearchBar:n.default,item:o.a,Scroller:r.default},mixins:[s.a],props:{},data:function(){return{activeTab:[],storageKey:encodeURI(this.title||"multiSelectMark"),storageVal:[],keyword:"",searchStatus:!1,isHasVal:!1,checkedItem:{},show:!1,searchData:[],showSelected:!1,listTile:"",selectedNames:"",options:[],optionsLimit:20,pagingOptions:!1,searchBar:!0,category:[]}},computed:{optionsShow:function(){return this.options&&this.options.length?this.grouping?this.getGroupData():this.options.slice(0,this.optionsLimit):[]},realChecked:function(){return Object.values(this.checkedItem).filter((function(t){return!!t}))}},watch:{keyword:function(t){var e=this;this.$nextTick((function(){e.filterList(t)}))}},methods:{openPopup:function(e){this.value=!0,this.show=!0,this.title=e.title,this.selected=e.selected,this.options=e.options,this.onSelect=e.onSelect,this.searchBar=e.searchBar,this.grouping=e.grouping,this.rightBtn=e.rightBtn,this.rightBtnEvent=e.rightBtnEvent,this.checkBoxAliRight=e.checkBoxAliRight,this.showSelected=e.showSelected,this.listTile=e.listTile,this.beforeCheck=e.beforeCheck,t.isEmpty(this.selected)&&(this.selectedNames=""),this.setValue(e.selected),this.$emit("open")},setValue:function(t){var e={};t&&t.length?(t.forEach((function(t){t&&(e[t.id]=t)})),this.checkedItem=e):this.checkedItem={}},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},closeEvent:function(){this.value=!1,this.show=!1,this.keyword="",this.searchStatus=!1,this.$refs["app-search-bar"]&&this.$refs["app-search-bar"].cancelSearch()},selectItem:function(e){var a=this;if(!e.disabled){var i=this.beforeCheck&&this.beforeCheck(e);i instanceof Promise||(i=Promise.resolve(i)),i.then((function(i){if(!1!==i){var n=l({},a.checkedItem);if(a.$refs["app-search-bar"]&&a.$refs["app-search-bar"].saveHistory(),a.checkedItem[e.id]?delete n[e.id]:n[e.id]=e,a.checkedItem=n,a.showSelected){var o=[];t.each(a.checkedItem,(function(t){o.push(t.name)})),a.selectedNames=o.join("、")}}}))}},onSearchTypeChange:function(t){this.searchStatus=t},onInput:function(t){this.isHasVal=!!t},filterList:function(t){var e,a,i=this,n=new RegExp("("+t+")","gmi");if(this.category=[],this.keyword=t,this.searchData=[],!t)return!1;this.options.map((function(t){return n.test(t.name)&&(a=l(l({},t),{},{rename:t.name.replace(n,"<label>$1</label>")}),i.grouping?-1===(e=i.category.indexOf(a[i.grouping]))?(i.category.push(a[i.grouping]),i.searchData.push({name:a[i.grouping],children:[a]})):i.searchData[e].children.push(a):i.searchData.push(a)),t}))},pageOptions:function(){this.optionsLimit=this.optionsLimit+20,this.pagingOptions=!1},getGroupData:function(){var t,e=this,a=[];return this.category=[],this.options.map((function(i){return-1===(t=e.category.indexOf(i[e.grouping]))?(e.category.push(i[e.grouping]),a.push({name:i[e.grouping],children:[i]})):a[t].children.push(i),i})),a},submit:function(){var t=Object.values(this.checkedItem);this.onSelect(t),this.closeEvent()},getHadSelectValue:function(){return Object.values(this.checkedItem)}}}}).call(this,a("391c"))},b6c2:function(t,e,a){"use strict";var i=a("873c").a,n=(a("308d"),a("5db1"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"materialTaskForm",staticClass:"wrap"},[t.taskData.shipping_no&&t.allowSupplyOrder?a("item",{staticClass:"delivery-note_item",attrs:{"text-style":{"text-align":"right"},text:t.taskData.shipping_no}},[a("div",{staticClass:"item-label",attrs:{slot:"left"},slot:"left"},[t._v("送货单")])]):t._e(),a("single-select",{attrs:{options:t.sectionOptions,editabled:t.allowSection,title:"所属标段"},on:{onSelect:t.changeSection},model:{value:t.taskData.section,callback:function(e){t.$set(t.taskData,"section",e)},expression:"taskData.section"}}),a("material-info-select",{attrs:{options:t.taskData.materialList,"before-open":t.checkSectionIsAvailable,editabled:t.allowMaterial,title:"材料名称",grouping:"category_name","right-btn":t.allowCustomMaterialName?"手工添加":"","custom-type":"3"},on:{onSelect:t.materialTypeSelect},model:{value:t.taskData.material,callback:function(e){t.$set(t.taskData,"material",e)},expression:"taskData.material"}}),t.taskData.material&&t.taskData.material.name?a("material-info-select",{ref:"selectMaterialType",attrs:{options:t.typeList,"before-open":t.checkMaterialType,multi:!0,"standard-unit":t.taskData.material.quantity_unit,editabled:t.allowMaterial,"custom-type":"2",title:"材料类型","right-btn":t.allowCustomMaterialType?"手工添加":"",required:!1},on:{onSelect:t.onChangeMaterialType},model:{value:t.taskData.materialType,callback:function(e){t.$set(t.taskData,"materialType",e)},expression:"taskData.materialType"}}):t._e(),a("single-select",{ref:"singleSelectDialog",attrs:{options:t.supplierOptions,"before-open":t.checkSectionIsAvailable,"right-btn":"手工添加","editor-add-data":!0,title:"材料供应商"},on:{rightBtnEvent:t.showSupplierDialog},model:{value:t.taskData.supplier,callback:function(e){t.$set(t.taskData,"supplier",e)},expression:"taskData.supplier"}}),a("item",{attrs:{label:"使用部位",border:"bottom",mode:"edit"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.taskData.place,expression:"taskData.place"}],staticClass:"input-align-r f16",attrs:{slot:"right",type:"text",placeholder:t.placeRequired?"必填":"选填"},domProps:{value:t.taskData.place},on:{input:function(e){e.target.composing||t.$set(t.taskData,"place",e.target.value)}},slot:"right"})]),t.UsingMaterialContract||t.taskData.contract&&t.taskData.contract.id?a("material-task-contract",{ref:"MaterialTaskContractRef",on:{onSelect:t.materialTaskContractSelect},model:{value:t.taskData.contract,callback:function(e){t.$set(t.taskData,"contract",e)},expression:"taskData.contract"}}):t._e(),a("item-textarea",{attrs:{"default-height":400,placeholder:"补充说明（选填）"},model:{value:t.taskData.remark,callback:function(e){t.$set(t.taskData,"remark",e)},expression:"taskData.remark"}}),a("div",{staticClass:"mt10"},[a("user-select",{attrs:{title:"接收人",options:t.ccList,editabled:t.allowPeople},model:{value:t.taskData.receiver,callback:function(e){t.$set(t.taskData,"receiver",e)},expression:"taskData.receiver"}}),a("single-select",{attrs:{options:t.taskData.contractorOptions,"before-open":t.checkSectionIsAvailable,title:"接收单位"},model:{value:t.taskData.contractor,callback:function(e){t.$set(t.taskData,"contractor",e)},expression:"taskData.contractor"}}),a("user-select",{attrs:{title:"监理",options:t.taskData.checkerList,editabled:t.allowPeople},model:{value:t.taskData.checker,callback:function(e){t.$set(t.taskData,"checker",e)},expression:"taskData.checker"}})],1),a("div",{staticClass:"mt10"},[t.allowIsConstructerBtn?a("item",{attrs:{label:"需建设单位验收",border:"bottom",mode:"edit"}},[a("div",{staticClass:"item-text align-r",attrs:{slot:"right"},slot:"right"},[a("van-switch",{model:{value:t.taskData.needConstructer,callback:function(e){t.$set(t.taskData,"needConstructer",e)},expression:"taskData.needConstructer"}})],1)]):t._e(),t.taskData.needConstructer?a("user-select",{attrs:{title:"建设单位验收人",options:t.taskData.constructerList,multi:!0,memory:!0,max:4,editabled:t.allowPeople},model:{value:t.taskData.constructers,callback:function(e){t.$set(t.taskData,"constructers",e)},expression:"taskData.constructers"}}):t._e(),t.isAreaCheckOn?a("user-select",{attrs:{title:"区域验收人",multi:!0,editabled:!1},model:{value:t.taskData.areaCheckers,callback:function(e){t.$set(t.taskData,"areaCheckers",e)},expression:"taskData.areaCheckers"}}):t._e(),a("user-select",{attrs:{title:"抄送人",options:t.ccList,multi:!0,required:!1,editabled:t.allowPeople},model:{value:t.taskData.cc,callback:function(e){t.$set(t.taskData,"cc",e)},expression:"taskData.cc"}}),t.allowIsNews?t._e():a("user-select",{attrs:{title:"创建人",editabled:!1},model:{value:t.taskData.creater,callback:function(e){t.$set(t.taskData,"creater",e)},expression:"taskData.creater"}})],1),t.taskData.sendback_reason&&t.allowSupplyOrder?a("item",{attrs:{"text-style":{"text-align":"right"},text:t.taskData.sendback_reason}},[a("div",{staticClass:"item-label",attrs:{slot:"left"},slot:"left"},[t._v("退回原因")])]):t._e(),a("app-button-group",{staticClass:"ctrl",attrs:{direction:"column"}},[t.allowIsNews?a("app-button",{on:{click:t.submit}},[t._v("提交")]):a("app-button",{on:{click:t.saveTask}},[t._v("保存")]),t.allowSupplyOrder&&t.allowSupplyOrderTaskVoide?a("app-button",{attrs:{type:"warning",plain:"",rimless:""},on:{click:t.taskVoid}},[t._v("任务作废")]):t._e()],1),a("van-dialog",{attrs:{"show-cancel-button":"","get-container":"body","cancel-button-color":"#666","class-name":"custom-material-dialog","before-close":t.supplierSubmit},model:{value:t.showSupplier,callback:function(e){t.showSupplier=e},expression:"showSupplier"}},[a("div",[a("item-textarea",{ref:"textarea-supplier",staticClass:"text-area-border",attrs:{placeholder:"请输入材料供应商名称",maxlength:20},model:{value:t.supplierData.name,callback:function(e){t.$set(t.supplierData,"name",e)},expression:"supplierData.name"}})],1)]),a("material-task-void-dialog",{ref:"materialTaskVoidDialog",on:{submit:t.supplyOrderTaskVoid}})],1)}),[],!1,null,"f9d9b95a",null);e.a=o.exports},b850:function(t,e,a){"use strict";var i={name:"MultiSelectItem",props:{item:{type:Object,default:function(){return{id:"",name:""}}},checked:{type:Boolean,default:!1},alignRight:{type:Boolean,default:!1},renderField:{type:String,default:"name"},disabled:{type:Boolean,default:!1}},methods:{selectItem:function(t){this.disabled||this.$emit("click",t)}}},n=(a("c85b"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-cell",{staticClass:"single-item",attrs:{clickable:!0},on:{click:function(e){t.selectItem(t.item)}}},[a("div",{staticClass:"wrapper"},[a("span",{class:{checkbox:!0,checked:t.checked,disabled:t.disabled},style:{order:t.alignRight?10:0}},[a("i",{staticClass:"van-icon van-icon-success"})]),a("div",{staticClass:"checkboxtxt",class:{"disabled-text":t.disabled}},[a("span",{domProps:{innerHTML:t._s(t.item[t.renderField])}}),t.alignRight?a("p",{staticClass:"f12 color-gray"},[t._v(t._s(t.item.code))]):t._e()])])])}),[],!1,null,"b3cb8602",null);e.a=o.exports},bb6b:function(t,e,a){"use strict";var i=a("07d2"),n=a("cd05"),o=a("e68e"),r=a("f5d4"),s={name:"MaterialDetailCheckView",components:{Item:i.default,ItemImgList:o.a,UserSelect:n.a},props:{model:{type:Object,default:function(){return{}}}},data:function(){return{show:!1}},methods:{firstCheckDetail:function(){r.a.open(this.model.checkDataFirst)}}},c=(a("9020"),a("17cc")),l=Object(c.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t.model.isFirstCheck||t.model.onlyCheckFirst?t._e():a("item",{staticClass:"bg-sub-theme mb10",attrs:{border:"bottom"},on:{click:t.firstCheckDetail}},[a("div",{staticClass:"item-text"},[t._v("首次送检记录")]),a("div",{staticClass:"item-font color-light"},[t._v("查看")]),a("icon",{attrs:{name:"arrow-right"}})],1),a("div",{staticClass:"brand-info border-bottom"},t._l(t.model.checkData.brands,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"brand-name border-bottom"},[t._v(t._s(e.name))]),t._l(e.standard,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"brand-type"},[a("div",{staticClass:"flex one-line"},[t._v(t._s(e.name))]),e.specification&&e.specification.length?t._e():a("div",[t._v("\n            "+t._s(e.num||0)+"组\n          ")])]),e.specification&&e.specification.length?t._l(e.specification,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"brand-spec"},[a("div",[t._v(t._s(e.name))]),a("div",[t._v(t._s(e.num||0)+"组")])])])})):t._e()],2)}))],2)}))),a("div",{staticClass:"mt10"},[a("item",{attrs:{label:"送检照片"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.model.checkData.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":t.model.checkData.created_by},model:{value:t.model.checkData.img,callback:function(e){t.$set(t.model.checkData,"img",e)},expression:"model.checkData.img"}})],1)]),a("item",{attrs:{mode:"view",label:"送检时间",editabled:!1,text:t.model.checkData.date}}),a("user-select",{attrs:{title:"送检人",mode:"view",editabled:!1,date:t._f("formatDate")(t.model.checkData.check_date)},model:{value:t.model.checkData.checker,callback:function(e){t.$set(t.model.checkData,"checker",e)},expression:"model.checkData.checker"}})],1)],1)}),[],!1,null,"340d7e0d",null);e.a=l.exports},bdae:function(t,e,a){"use strict";a("45f4")},bebe:function(t,e,a){var i=a("6272");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("53478790",i,!0,{sourceMap:!1,shadowMode:!1})},c001:function(t,e,a){var i=a("f53a");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("bd5eb062",i,!0,{sourceMap:!1,shadowMode:!1})},c070:function(t,e,a){var i=a("574c");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("35590dcb",i,!0,{sourceMap:!1,shadowMode:!1})},c523:function(t,e,a){"use strict";a("d959")},c7df:function(t,e,a){"use strict";(function(t){a("cc57");var i=a("07d2"),n=a("3730"),o=a("6144");e.a={name:"MultiSelect",components:{Item:i.default},props:{title:{type:String,default:""},value:{type:Array,default:function(){return[]}},options:{type:Array,default:function(){return[]}},selectedText:{type:String,default:""},required:{type:Boolean,default:!0},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},memory:{type:Boolean,default:!1},autoSelect:{type:Boolean,default:!1},beforeOpen:{type:Function,default:function(){}},beforeCheck:{type:Function,default:function(){}},searchBar:{type:Boolean,default:!0},checkBoxAliRight:{type:Boolean,default:!1},grouping:{type:String,default:""},rightBtn:{type:String,default:""},rightBtnEvent:{type:Function,default:function(){return 0}}},data:function(){return{memoryKey:this.$route.name+encodeURI(this.title)}},computed:{selectVal:function(){return""!==this.selectedText?this.selectedText:this.value&&this.value.length?this.value.map((function(t){return t.name})).join("、"):"view"===this.mode?"无":""}},watch:{options:function(){this.setSelected()}},mounted:function(){this.setSelected()},methods:{openSelect:function(){var e=this;if(this.editabled){var a=this.beforeOpen();a&&a.then&&t.isFunction(a.then)?a.then((function(t){!1!==t&&e.openPopup()})):!1!==a&&this.openPopup()}},renderSelected:function(t){n.a.selectItem(t)},openPopup:function(){var t=this;n.a.openPopup({title:"选择"+this.title,selected:this.value,options:this.options,required:this.required,searchBar:this.searchBar,grouping:this.grouping,rightBtn:this.rightBtn,checkBoxAliRight:this.checkBoxAliRight,beforeCheck:this.beforeCheck,onSelect:function(e){t.$emit("input",e),t.$emit("onSelect",e)},rightBtnEvent:function(e){t.$emit("rightBtnEvent",e)}})},setDialogValue:function(t){n.a.setValue(t)},getDialogValue:function(){return n.a.getHadSelectValue()},closePopup:function(){n.a.closePopup()},onSelect:function(t){this.$emit("input",t),this.$emit("onSelect",t)},setSelected:function(){var e=o.a.getObject(this.memoryKey,o.a.level.user);!1===this.editabled||t.isEmpty(this.options)||(t.isEmpty(this.value)?this.memory&&!t.isEmpty(e)&&t.some(this.options,{id:e.id})&&(this.$emit("input",e),this.autoSelect&&this.$emit("onSelect",e)):this.autoSelect&&this.$emit("onSelect",this.value))}}}}).call(this,a("391c"))},c85b:function(t,e,a){"use strict";a("f6e3")},cb44:function(t,e,a){"use strict";a("b229")},cd5a:function(t,e,a){"use strict";var i=a("8bf4").a,n=(a("deec"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("div",{staticClass:"brand-info"},t._l(t.model.approachData.brands,(function(e,i){return a("div",{key:"brand"+i},[a("div",{staticClass:"brand-name"},[t._v(t._s(e.name))]),t._l(e.standard,(function(e,i){return a("div",{key:"standard"+i},[a("div",{staticClass:"brand-type",class:{"brand-supply":t.allowSupplyOrderEdit}},[a("div",{staticClass:"flex one-line label"},[t._v(t._s(e.name))]),e.specification&&e.specification.length?t._e():[t.allowSupplyOrderEdit?a("div",{staticClass:"item-ele align-r",class:e.quantity_unit?"unit_"+e.quantity_unit.length:"unit_"+t.model.approachData.standard_unit.length},[a("number-input",{staticClass:"color-theme",attrs:{type:"positive",decimal:3,"overflow-auto-recover":!1,range:[0,999999.999]},model:{value:e.num,callback:function(a){t.$set(e,"num",a)},expression:"item.num"}}),a("span",{staticClass:"text"},[t._v(t._s(e.quantity_unit||t.model.approachData.standard_unit))])],1):a("div",{staticClass:"quantity"},[t._v("\n              "+t._s(e.num+(e.quantity_unit||t.model.approachData.standard_unit))+"\n            ")])]],2),e.specification&&e.specification.length?t._l(e.specification,(function(i,n){return a("div",{key:"specification"+n},[a("div",{staticClass:"brand-spec",class:{"brand-supply":t.allowSupplyOrderEdit}},[a("div",{staticClass:"label"},[t._v(t._s(i.name))]),t.allowSupplyOrderEdit?a("div",{staticClass:"item-ele align-r",class:e.quantity_unit?"unit_"+e.quantity_unit.length:"unit_"+t.model.approachData.standard_unit.length},[a("number-input",{staticClass:"color-theme",attrs:{type:"positive",decimal:3,"overflow-auto-recover":!1,range:[0,999999.999]},model:{value:i.num,callback:function(e){t.$set(i,"num",e)},expression:"spec.num"}}),a("span",{staticClass:"text"},[t._v(t._s(e.quantity_unit||t.model.approachData.standard_unit))])],1):a("div",{staticClass:"quantity"},[t._v("\n                "+t._s(i.num+(e.quantity_unit||t.model.approachData.standard_unit))+"\n              ")])])])})):t._e()],2)}))],2)}))),a("div",{staticClass:"approach-info mt10"},[a("item",{attrs:{label:"进场时间",text:t.model.approachData.date}}),t.allowSupplyOrderEdit?a("item",{staticClass:"photo-list pic-list"},[a("p",{staticClass:"photo-type"},[t._v("供货单")]),a("item-img-list",{attrs:{"model-id":t.model.supplyData.id,maxlength:50},model:{value:t.model.supplyData.shipping_image,callback:function(e){t.$set(t.model.supplyData,"shipping_image",e)},expression:"model.supplyData.shipping_image"}})],1):t.model.supplyData.id?a("item",{attrs:{label:"供货单"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.model.supplyData.id,maxlength:50,editabled:!1},model:{value:t.model.supplyData.shipping_image,callback:function(e){t.$set(t.model.supplyData,"shipping_image",e)},expression:"model.supplyData.shipping_image"}})],1)]):t._e(),t.model.approachData.hasReceiverImgRecord?t._e():a("item",{attrs:{label:"进场照片"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.model.approachData.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":t.model.approachData.created_by},model:{value:t.model.approachData.img,callback:function(e){t.$set(t.model.approachData,"img",e)},expression:"model.approachData.img"}})],1)]),t.model.approachData.hasReceiverImgRecord?t._l(t.model.approachData.receiverImg,(function(e,i){return a("item",{key:"receiverImg"+i,attrs:{label:e.title}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":e.id,"model-field":"image_file","model-table":"material_task_photo_requirement",editabled:!1,"edited-by":e.created_by_id},model:{value:e.image_file,callback:function(a){t.$set(e,"image_file",a)},expression:"item.image_file"}})],1)])})):t._e(),t.model.approachData.remark?a("item",{attrs:{label:"补充说明",text:t.model.approachData.remark}}):t._e(),a("item",{attrs:{label:"接收单位",text:t.model.approachData.contractor&&t.model.approachData.contractor.name}}),a("user-select",{attrs:{title:"接收人",mode:"view",date:t._f("formatDate")(t.model.approachData.receive_date),editabled:!1},model:{value:t.model.approachData.receiver,callback:function(e){t.$set(t.model.approachData,"receiver",e)},expression:"model.approachData.receiver"}})],2),a("div",{staticClass:"approach-info"},[t.model.early_result?a("item",{attrs:{label:"初验结果",text:t.model.early_result}}):t._e(),a("user-select",{attrs:{options:t.model.checkerList,title:"监理",mode:"view","before-select":t.beforeChange,editabled:t.checkerEditabled,date:t._f("formatDate")(t.model.earlyData.status&&t.model.earlyData.check_date),note:t.checkerNote},on:{onSelect:t.changeEarlyChecker},model:{value:t.model.earlyData.checker,callback:function(e){t.$set(t.model.earlyData,"checker",e)},expression:"model.earlyData.checker"}}),t.model.earlyData.status?[t.model.approachData.hasCheckImgRecord?t._e():a("item",{attrs:{label:"验收照片"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[t.model.earlyData.remark?a("p",{staticClass:"pic-title"},[t._v("\n            "+t._s(t.model.earlyData.remark)+"\n          ")]):t._e(),a("item-img-list",{attrs:{"model-id":t.model.earlyData.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":t.model.earlyData.created_by},model:{value:t.model.earlyData.img,callback:function(e){t.$set(t.model.earlyData,"img",e)},expression:"model.earlyData.img"}})],1)]),t.model.approachData.hasCheckImgRecord?t._l(t.model.approachData.checkerImg,(function(e,i){return a("item",{key:"checkerImg"+i,attrs:{label:e.title}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":e.id,"model-field":"image_file","model-table":"material_task_photo_requirement",editabled:!1,"edited-by":e.created_by_id},model:{value:e.image_file,callback:function(a){t.$set(e,"image_file",a)},expression:"item.image_file"}})],1)])})):t._e()]:t._e(),t.model.earlyData.remark&&t.model.approachData.hasCheckImgRecord?a("item",{attrs:{label:"补充说明",text:t.model.earlyData.remark}}):t._e(),"待验收"===t.model.batchData.status&&"edit"===t.model.earlyMode?a("item",{attrs:{label:"是否送检"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("span",{staticClass:"item-select-box",class:{selected:t.model.batchData.needCheck},on:{click:function(e){t.changeNeedCheck(!0)}}},[t._v("\n          是\n        ")]),a("span",{staticClass:"item-select-box",class:{selected:!1===t.model.batchData.needCheck},on:{click:function(e){t.changeNeedCheck(!1)}}},[t._v("\n          否\n        ")])])]):t._e(),"edit"!==t.model.earlyMode&&"boolean"==typeof t.model.batchData.needCheck?a("item",{attrs:{label:"是否送检",text:t.model.batchData.needCheck?"是":"否"}}):t._e(),!0===t.model.batchData.needCheck?a("user-select",{attrs:{options:t.model.earlyData.checkerList,title:"送检人",mode:"view",editabled:"待验收"==t.model.batchData.status&&"edit"===t.model.earlyMode},on:{onSelect:t.changeInspection},model:{value:t.selectedChecker,callback:function(e){t.selectedChecker=e},expression:"selectedChecker"}}):t._e(),t.model.conCheckList&&t.model.conCheckList.length?t._e():t._l(t.model.approachData.constructers,(function(e,i){return a("user-select",{key:"constructers"+i,attrs:{options:t.model.earlyData.checkerList,title:"建设单位验收人",mode:"view",multi:!0,editabled:!1,note:"尚未验收"},model:{value:t.model.approachData.constructers[i],callback:function(e){t.$set(t.model.approachData.constructers,i,e)},expression:"model.approachData.constructers[key]"}})})),t._l(t.model.conCheckList,(function(e,i){return a("div",{key:"conCheckList"+i},[a("user-select",{attrs:{options:t.model.constructerList,title:"建设单位验收人",mode:"view","before-select":t.beforeChangeConstruter,note:e.status?e.early_result:t.curUserId!==e.checker.id||e.status||t.model.conAllHasChecked?"尚未验收":"",date:t._f("formatDate")(e.status&&e.check_date),editabled:t.curUserId===e.checker.id&&!e.status&&"待验收"==t.model.batchData.status},on:{onSelect:t.changeEarlyChecker},model:{value:e.checker,callback:function(a){t.$set(e,"checker",a)},expression:"checkRecord.checker"}}),e.img.length?[e.status?a("item",{attrs:{label:"验收照片"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[e.remark?a("p",{staticClass:"pic-title"},[t._v(t._s(e.remark))]):t._e(),a("item-img-list",{attrs:{"model-id":e.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":e.checker.id},model:{value:e.img,callback:function(a){t.$set(e,"img",a)},expression:"checkRecord.img"}})],1)]):t._e()]:t._e()],2)})),t._l(t.model.approachData.areaCheckData,(function(e,i){return a("div",{key:"checkRecord-"+i},[a("user-select",{attrs:{title:"区域验收人",mode:"view",multi:!0,note:e.status?e.early_result:t.curUserId===e.checker.id&&"待区域验收"==t.model.batchData.status?"":"尚未验收",date:t._f("formatDate")(e.status&&e.occurrence_date),editabled:!1},model:{value:e.checker,callback:function(a){t.$set(e,"checker",a)},expression:"checkRecord.checker"}}),e.img.length?[e.status?a("item",{attrs:{label:"验收照片"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[e.remark?a("p",[t._v(t._s(e.remark))]):t._e(),a("item-img-list",{attrs:{"model-id":e.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":e.checker.id},model:{value:e.img,callback:function(a){t.$set(e,"img",a)},expression:"checkRecord.img"}})],1)]):t._e()]:t._e()],2)})),a("user-select",{attrs:{options:t.model.ccList,title:"抄送人",multi:!0,mode:"view",editabled:!!t.model.actionPermit},on:{onSelect:t.changeCcer},model:{value:t.selectedCC,callback:function(e){t.selectedCC=e},expression:"selectedCC"}}),t.model.actionPermit?[t.isCheckerPhotoType&&"监理"===t.model.activeLog.type&&t.isCheckerPhotoType?a("div",t._l(t.model.approachData.checkerImg,(function(e,i){return a("div",{key:"checkerImg"+i,staticClass:"photo-list"},[a("p",[t._v(t._s(e.title))]),a("item-img-list",{attrs:{maxlength:50,"allow-multi-select":!0,"prepare-callback":function(){return t.prepareTakePicture([t.model.approachData,t.model.activeLog,t.model.batchData],"approach","checkerImg",e.photo_requirement_id)}},on:{callback:function(e){t.pushInSaveStack("photoTypeSaveLog","checkerImg")}},model:{value:e.image_file,callback:function(a){t.$set(e,"image_file",a)},expression:"item.image_file"}})],1)}))):t._e(),t.isCheckerPhotoType&&"监理"===t.model.activeLog.type?t._e():[a("p",{staticClass:"title-name"},[t._v("验收照片")]),a("item",[a("item-img-list",{attrs:{maxlength:50,"allow-multi-select":!0,"prepare-callback":function(){return t.prepareTakePicture([t.model.approachData,t.model.activeLog,t.model.batchData],"approach","activeLog","")}},on:{callback:function(e){t.pushInSaveStack("saveEarlyLog")}},model:{value:t.model.activeLog.img,callback:function(e){t.$set(t.model.activeLog,"img",e)},expression:"model.activeLog.img"}})],1)],a("item-textarea",{staticClass:"border-tb",attrs:{placeholder:"补充说明"},on:{blur:function(e){t.pushInSaveStack("saveEarlyLog")}},model:{value:t.model.activeLog.remark,callback:function(e){t.$set(t.model.activeLog,"remark",e)},expression:"model.activeLog.remark"}})]:t._e()],2),t.allowSupplyOrderEdit?a("app-button-group",{attrs:{direction:"column"}},[a("app-button",{on:{click:t.submitAgain}},[t._v(" 再次提交 ")])],1):t._e(),t.model.actionPermit?a("app-button-group",{attrs:{direction:"column"}},[a("app-button",{on:{click:t.earlyPass}},[t._v(" 进场验收合格 ")]),a("app-button",{attrs:{type:"warning",plain:"",rimless:""},on:{click:t.earlyUnPass}},[t._v(" 进场验收不合格 ")])],1):t._e()],1)}),[],!1,null,"19f3674d",null);e.a=o.exports},cd66:function(t,e,a){"use strict";var i=a("8c64").a,n=(a("e9d7"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t.multi?a("multi-select",{ref:"multiSelectDialog",attrs:{options:t.options,title:t.title,"right-btn":t.rightBtn,editabled:t.editabled},on:{onSelect:t.onHandleSelect,rightBtnEvent:t.showCustomDialog},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[t._t("default")],2):a("single-select",{ref:"singleSelectDialog",attrs:{options:t.options,"options-disabled":t.optionsDisabled,title:t.title,"right-btn":t.rightBtn,grouping:t.grouping,"auto-open":!0,"before-open":t.beforeOpen,"standard-unit":t.standardUnit,editabled:t.editabled,"form-check":t.formCheck},on:{onSelect:t.onHandleSelect,rightBtnEvent:t.showCustomDialog},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),a("van-dialog",{attrs:{"show-cancel-button":"","get-container":"body","class-name":"custom-material-dialog","cancel-button-color":"#666","before-close":t.customSubmit},model:{value:t.showCustom,callback:function(e){t.showCustom=e},expression:"showCustom"}},[a("div",{on:{click:function(){t.$refs["custom-input"].blur()}}},["3"===t.customType?t._l(t.materialCategory,(function(e,i){return a("span",{key:"cate-"+i,staticClass:"mr5 mb5",class:t.customMaterialCategory===e?"checked":"",on:{click:function(a){t.selectMaterialCategory(e)}}},[t._v(t._s(e))])})):t._e(),a("div",{class:{"new-name":!0,error:t.customFormError&&!t.customName}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.customName,expression:"customName"}],ref:"custom-input",attrs:{placeholder:"请输入"+t.title,maxlength:"20"},domProps:{value:t.customName},on:{click:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.customName=e.target.value)}}})]),"2"===t.customType||"3"===t.customType?[a("p",{class:{error:t.customFormError&&!t.customMaterialUnit}},[t._v("请选择数量单位")]),a("div",{staticClass:"untis"},t._l(t.units,(function(e,i){return a("span",{key:"unit-"+i,class:t.customMaterialUnit===e.name?"checked":"",on:{click:function(a){t.selectCustomMaterialUnit(e)}}},[t._v(t._s(e.name))])})))]:t._e()],2)])],1)}),[],!1,null,"6fc312fe",null);e.a=o.exports},cf0d:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,'.zjapp .layout-main[data-v-0a266c44] .layout-content{overflow:auto}.zjapp .datepicker-hd[data-v-0a266c44]{display:flex;text-align:center;padding:5px 5px 15px 5px}.zjapp .datepicker-hd-center[data-v-0a266c44]{flex:1;display:flex;padding:10px 5px}.zjapp .datepicker-month[data-v-0a266c44],.zjapp .datepicker-year[data-v-0a266c44]{position:relative;flex:1;border:none;border-bottom:1px solid #4374ea;padding:0;line-height:26px;font-size:14px;text-align:center}.zjapp .datepicker-month[data-v-0a266c44]{margin-left:10px}.zjapp .datepicker-month[data-v-0a266c44]:after,.zjapp .datepicker-year[data-v-0a266c44]:after{position:absolute;top:50%;right:5px;margin-top:-3px;width:0;height:0;border-top:5px solid;border-right:5px solid transparent;border-left:5px solid transparent;content:"";pointer-events:none;color:#4374ea}.zjapp .datepicker-next[data-v-0a266c44],.zjapp .datepicker-prev[data-v-0a266c44]{width:10%;padding:10px 5px;font-size:24px;color:#4374ea}.zjapp .select-list[data-v-0a266c44]{position:absolute;top:27px;left:0;width:100%;max-height:380px;overflow:auto;background-color:#fff;box-shadow:0 0 5px #333}.zjapp .select-item[data-v-0a266c44]{padding:5px;height:38px;line-height:28px}.zjapp .item-selected[data-v-0a266c44]{background-color:#4374ea;color:#fff}.zjapp .weeks-row[data-v-0a266c44]{padding:5px;display:flex}.zjapp .weeks-cell[data-v-0a266c44]{flex:1;line-height:20px;text-align:center;font-size:14px;font-weight:700}.zjapp .date-row[data-v-0a266c44]{padding:0 5px;display:flex}.zjapp .date-cell[data-v-0a266c44]{flex:1;height:50px;line-height:50px;text-align:center;font-size:14px}.zjapp .date-cell-selected[data-v-0a266c44]{background-color:#4374ea;color:#fff;font-weight:700}.zjapp .date-cell.today[data-v-0a266c44]{border:1px solid #4374ea}.zjapp .disabled[data-v-0a266c44]{pointer-events:none;color:#aaa}',""])},d1d1:function(t,e,a){"use strict";(function(t){var i=a("fd50"),n=a("bcc7"),o=a("515e"),r=a("07d2"),s=a("7bac"),c=a("a7c3"),l=a("4360");e.a={name:"CheckGuideList",components:{Item:r.default},store:l.a,data:function(){return{isLoading:!0,listData:[],module:"",itemId:"",batchId:"",sectionId:"",options:""}},computed:{moduleAttribute:function(){return this.$store.state.global.moduleAttribute}},methods:{init:function(e){var a,n=this;for(var o in this.module=e.module,this.itemId=e.itemId,this.batchId=e.batchId,this.sectionId=e.sectionId,this.options=e.options,e)this[o]=e[o];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module];var r=!1;t.isEmpty(this.itemId)?!t.isEmpty(this.checkType)&&t.isEmpty(this.sectionId)?a=this.initByType():t.isEmpty(this.batchId)?t.isEmpty(this.options)?t.isEmpty(this.sectionId)?a=i.a.when():(r=!0,a=this.initByBidsection()):a=this.initByOptions():a=this.initByBatch():a=this.initById(),this.isLoading=!0,a.then((function(e){var a=n.moduleAttribute[n.module]||{};!t.isEmpty(a)&&a.setUsualItems&&r?s.a.getUserKey(n.mmkvCode()).then((function(t){t=null===t?e:n.mergeArray(n.deepClone(e),t),n.listData=t||[],n.isLoading=!1})):(n.listData=e||[],n.isLoading=!1)}))},mmkvCode:function(){var t=this.moduleAttribute[this.module]||{};return c.a[t.mmkv_item]+"_"+this.sectionId},mergeArray:function(e,a){var i=this;return t.filter(e,(function(e){var n=a[e.id];return t.isEmpty(e.subitem)||(e.subitem=i.mergeArray(e.subitem,a)),!t.isEmpty(n)||"desc"===e.type}))},clickItem:function(t){t.subitem&&t.subitem.length?this.$set(t,"isOpen",!t.isOpen):"special-inspect"===this.module?o.a.openPopup({itemId:t.id,module:this.module}):o.a.openPopup({itemId:t.item_id,module:this.module})},initById:function(){var t=this;if("special-inspect"!==this.module)return n.a.getCheckItem(this.itemId,this.checkType).then((function(e){return e?t.sectionId?n.a.getBidSectionCheckItemListByCode(t.sectionId,e.code):n.a.getCheckItemTreeByCode(e.code):i.a.when()}))},initByType:function(){return n.a.getCheckItemGuidelineList(this.checkType)},initByBatch:function(){return i.a.when()},initByBidsection:function(){return n.a.getBidSectionCheckItemTreeByType(this.sectionId,this.checkType)},initByOptions:function(){return i.a.resolve(this.options)},deepClone:function(t){return JSON.parse(JSON.stringify(t))}}}}).call(this,a("391c"))},d258:function(t,e,a){var i=a("6c75");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("a90b1c6a",i,!0,{sourceMap:!1,shadowMode:!1})},d6ae:function(t,e,a){"use strict";a("6b81a")},d81a:function(t,e,a){"use strict";a("299f")},d959:function(t,e,a){var i=a("9bc0");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("72c78e6b",i,!0,{sourceMap:!1,shadowMode:!1})},dc98:function(t,e,a){"use strict";a("0732")},deec:function(t,e,a){"use strict";a("170e")},e1e7:function(t,e,a){"use strict";(function(t){a("cc57"),a("163d");var i=a("07d2"),n=a("4e8c");e.a={name:"SlideUpSelect",components:{Item:i.default},props:{title:{type:String,default:""},value:{type:Object,default:function(){return{}}},options:{type:Array,default:function(){return[]}},placeholder:{type:String,default:"请选择"},emptyText:{type:String,default:"暂无数据"},mode:{type:String,default:"edit"},editabled:{type:Boolean,default:!0},showNote:{type:String},allowSearch:{type:Boolean,defalut:!1},initHeight:{type:Number,default:400},historyKey:{type:String,default:"historyHey"}},data:function(){return{isOpen:!1}},computed:{text:function(){return t.isEmpty(this.value)?this.editabled?"":"无":this.value.name}},created:function(){var t=this;n.a.$on("afterClosePopup",(function(){t.isOpen=!1}))},activated:function(){n.a.resultListLimit()},methods:{openSelect:function(){var t=this;n.a.openPopup({title:this.title,options:this.options,selected:this.value,showNote:this.showNote,emptyText:this.emptyText,allowSearch:this.allowSearch,initHeight:this.initHeight,historyKey:this.historyKey,componentUid:this._uid,callback:function(e){t.$emit("input",e),t.$emit("onSelect",e)}}),this.isOpen=!0}}}}).call(this,a("391c"))},e5c6:function(t,e,a){"use strict";var i=a("e68e"),n=a("cd05"),o={name:"MaterialDetailBackView",components:{Item:a("07d2").default,ItemImgList:i.a,UserSelect:n.a},props:{model:{type:Object,default:function(){return{}}}}},r=(a("2e2c"),a("17cc")),s=Object(r.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("item",{attrs:{label:"退场时间",text:t.model.backData.date}}),a("item",{attrs:{label:"相关照片"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.model.backData.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":t.model.backData.created_by},model:{value:t.model.backData.img,callback:function(e){t.$set(t.model.backData,"img",e)},expression:"model.backData.img"}})],1)]),a("item",{attrs:{label:"补充说明",text:t.model.backData.remark}}),a("user-select",{attrs:{title:"监理",mode:"view",date:t._f("formatDate")(t.model.backData.check_date),editabled:!1},model:{value:t.model.backData.checker,callback:function(e){t.$set(t.model.backData,"checker",e)},expression:"model.backData.checker"}}),a("user-select",{attrs:{title:"抄送人",mode:"view",multi:!0,editabled:!1},model:{value:t.model.backData.cc,callback:function(e){t.$set(t.model.backData,"cc",e)},expression:"model.backData.cc"}})],1)}),[],!1,null,"6e76799c",null);e.a=s.exports},e60b:function(t,e,a){var i=a("cf0d");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("1be2b028",i,!0,{sourceMap:!1,shadowMode:!1})},e6d8:function(t,e,a){"use strict";var i=a("07d2"),n=a("e68e"),o=a("cd05"),r=a("f7ab"),s=a("774b"),c=a("6314"),l={name:"MaterialDetailReportView",components:{Item:i.default,ItemImgList:n.a,UserSelect:o.a,Scroller:s.default,SynchronizeTipBar:r.a},props:{model:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{onRefresh:function(){},firstReportDetail:function(){c.a.open(this.model.reportDataFirst)}}},d=(a("7644"),a("17cc")),p=Object(d.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("synchronize-tip-bar"),a("scroller",{on:{pullDown:t.onRefresh}},[t.model.isFirstReport?[a("item",{attrs:{label:"送检报告"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.model.reportData.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":t.model.reportData.created_by},model:{value:t.model.reportData.img,callback:function(e){t.$set(t.model.reportData,"img",e)},expression:"model.reportData.img"}})],1)]),a("item",{attrs:{label:"报告结果",text:t.model.reportData.result}}),a("user-select",{attrs:{title:"送检人",mode:"view",editabled:!1,date:t._f("formatDate")(t.model.reportData.checker_date)},model:{value:t.model.reportData.checker,callback:function(e){t.$set(t.model.reportData,"checker",e)},expression:"model.reportData.checker"}})]:[t.model.onlyReportFirst?t._e():a("item",{staticClass:"mb10 bg-sub-theme",attrs:{border:"bottom"},on:{click:t.firstReportDetail}},[a("div",{staticClass:"item-text"},[t._v("首次送检报告")]),a("div",{staticClass:"item-font color-light"},[t._v("查看")]),a("icon",{attrs:{name:"arrow-right"}})],1),a("item",{attrs:{label:"送检报告",border:"top"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.model.reportDataView.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":t.model.reportDataView.created_by},model:{value:t.model.reportDataView.img,callback:function(e){t.$set(t.model.reportDataView,"img",e)},expression:"model.reportDataView.img"}})],1)]),a("item",{attrs:{label:"报告结果",text:t.model.reportDataView.result}}),a("user-select",{attrs:{title:"送检人",mode:"view",editabled:!1,date:t._f("formatDate")(t.model.reportDataView.checker_date)},model:{value:t.model.reportDataView.checker,callback:function(e){t.$set(t.model.reportDataView,"checker",e)},expression:"model.reportDataView.checker"}})],t.model.reportData.checker&&"待上传报告"===t.model.batchData.status?a("div",{staticClass:"mt10"},[a("user-select",{attrs:{title:"报告上传人",mode:"view",editabled:!1},model:{value:t.model.reportData.checker,callback:function(e){t.$set(t.model.reportData,"checker",e)},expression:"model.reportData.checker"}})],1):t._e()],2)],1)}),[],!1,null,"13a9cf84",null);e.a=p.exports},e8e4:function(t,e,a){"use strict";a("163d");var i={name:"ProgressRound",props:{size:{type:[String,Number],default:24}},data:function(){return{girth:22*Math.PI}},computed:{barWidth:function(){return this.girth*(Number(this.progress)||0)/100},isWaiting:function(){return 0===(Number(this.progress)||0)}}},n=(a("9e8c"),a("17cc")),o=Object(n.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticClass:"convert",style:{width:this.size+"px",height:this.size+"px"},attrs:{t:"1597203904175",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{staticClass:"icon",attrs:{d:"M194.047757 125.823843l2.133331 0.170666a42.922613 42.922613 0 0 1 33.023959 21.119974l85.333226 147.797148a42.666613 42.666613 0 1 1-73.898574 42.666614L183.893103 239.231701A424.959469 424.959469 0 0 0 85.333227 511.99936c0 235.647705 191.018428 426.666133 426.666133 426.666133a426.3248 426.3248 0 0 0 165.589126-33.279958 42.666613 42.666613 0 0 1 33.151959 78.591902A508.586031 508.586031 0 0 1 511.99936 1023.99872C229.247713 1023.99872 0 794.751007 0 511.99936c0-143.786487 59.605259-278.058319 162.559797-374.271532 2.474664-2.346664 5.247993-4.437328 8.362656-6.229326l0.426666-0.255999a42.32528 42.32528 0 0 1 1.663998-0.853333l-2.090664 1.109332c1.706665-0.981332 3.413329-1.834664 5.16266-2.559997l1.194665-0.426666a36.394621 36.394621 0 0 1 3.498663-1.151998l1.365331-0.341333a32.981292 32.981292 0 0 1 3.839996-0.767999l0.511999-0.042667a38.655952 38.655952 0 0 1 7.55199-0.426666zM511.99936 0c282.751647 0 511.99936 229.247713 511.99936 511.99936a510.250029 510.250029 0 0 1-152.917142 364.97021 42.666613 42.666613 0 0 1-49.493272 7.509324 42.83728 42.83728 0 0 1-18.51731-17.194645l-85.333227-147.797148a42.666613 42.666613 0 0 1 73.898575-42.666614l56.575929 97.919878A424.703469 424.703469 0 0 0 938.665493 511.99936c0-235.647705-191.018428-426.666133-426.666133-426.666133-44.842611 0-88.746556 6.911991-130.474504 20.309308A42.666613 42.666613 0 0 1 355.412889 24.405303 511.700694 511.700694 0 0 1 511.99936 0z","p-id":"13796"}})])}),[],!1,null,"13aac6b6",null);e.a=o.exports},e9d7:function(t,e,a){"use strict";a("aa1f")},e9ea:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .guide-box[data-v-ff0679ce]{flex:1;display:flex}.zjapp .page-scroll[data-v-ff0679ce]{flex:1;overflow:auto;padding-bottom:100px;transform:translateZ(0)}.zjapp .sublist[data-v-ff0679ce]{padding-left:25px;padding-top:1px;background-color:#fff}.zjapp .sublist>.sublist[data-v-ff0679ce]{padding-left:10px;padding-top:0}",""])},ef1c:function(t,e,a){var i=a("e9ea");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("2e832052",i,!0,{sourceMap:!1,shadowMode:!1})},f1e4:function(t,e,a){"use strict";(function(t){a("5ab2"),a("e10e");var i=a("28f8"),n=(a("9e76"),a("6d57"),a("9a33"),a("f548"),a("cc57"),a("4ad6")),o=a("e89f"),r=a("bcc7"),s=a("3122"),c=a("6e1b"),l=a("c130"),d=a("0636");function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){Object(i.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}e.a={name:"CheckGuideDetail",components:{},mixins:[o.a],data:function(){return{show:!1,isLoading:!0,isImageDownloading:!1,title:"",content:[],module:"",itemId:""}},methods:{openPopup:function(e){var a=this;for(var i in this.value=!0,this.show=!0,this.module=e.module,this.itemId=e.itemId,this.$emit("open"),e)this[i]=e[i];this.checkType={check:31,"check-safety":36,"check-quality":37,"measure-v3":41,process:32,"fly-inspect":101}[this.module],this.isLoading=!0,("special-inspect"===this.module?c.a.getSpecialInspectCheckItemDetail(this.itemId):"templet-plan"===this.module?l.a.getTempletDetail(this.itemId):"material"===this.module?d.a.getMaterialDetail(this.itemId):r.a.getCheckItem(this.itemId,this.checkType)).then((function(e){console.log("checkitemData",e),e=e||{},a.checkitemData=e,a.title=e.full_name||e.name,"special-inspect"!==a.module&&"inspect"!==a.module&&"fly-inspect"!==a.module&&"material"!==a.module||(e.content=e.guideline||e.content);var i=e.content?e.content.trim():"";if(i=(i=(i=(i=(i=i.replace(/<\/p><p>/gm,"\n")).replace(/<p>/gm,"")).replace(/<\/p>/gm,"")).replace(/<br>/gm,"")).replace(/<br \/>/gm,""),/(<img[^\>]*>)/gm.test(i)){var n=i.split(/(<img[^\>]*>)/gm);(n=n.filter((function(t){return!!t}))).forEach((function(t,e){t&&!/^\s*\n/.test(t)&&e&&!/\n\s*$/.test(n[e-1])&&(n[e]="\n"+t)})),i=n.join("")}var o=i?i.split("\n"):[];a.content=t.map(o,(function(t,e){var a;if(/<img([\s\S]*)>/gm.test(t)){var i=t.split(/\ssrc="([^"]*)"/gm)[1],n=i?i.match(/[\w|-]{36}/gm)[0]:(new Date).getTime()+"-"+e;a={isImg:!0,src:"",url:i,status:"pending",id:n,ready:!0}}else a={isImg:!1,val:t};return a})),a.downloadImage(),a.isLoading=!1})).catch((function(t){$log.log(t)}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")},getThumbnail:function(t){return"pending"===t.status?s.a.IMAGE_LOADING:"rejected"===t.status?s.a.IMAGE_RELOAD:"dev"===APP_ENV?t.url:"fulfilled"===t.status?t.src:($log.log("检查指引-显示图片：",t),s.a.IMAGE_PLACEHOLD)},imgError:function(t,e){$log.error("检查指引-加载图片出现错误：",t);var a=u({},t);a.status="rejected",this.$set(this.content,e,a)},downloadImage:function(e){var a=this;e=e?[e]:this.imageList(),t.each(e,(function(e){var i=u({},e),n=t.map(a.content,(function(t){return t.id})).indexOf(e.id);s.a.isNeedDownload(e.url).then((function(t){t?s.a.download(e.url).then((function(t){i.status="fulfilled",i.src=s.a.fixUrl(t),a.$set(a.content,n,i)})).catch((function(t){$log.error("检查指引-下载图片：",t)})):(i.status="fulfilled",i.src=s.a.fixUrl(s.a.getPathFromUrl(e.url)),a.$set(a.content,n,i))}))}))},imageList:function(){return t.filter(this.content,(function(t){return t.isImg}))},imgClick:function(e){var a=this;if("pending"===e.status)return!1;if("rejected"===e.status)return this.downloadImage(e),$log.log("检查指引-点击重新加载-重新下载图片：",e),!1;var i=this.imageList(),o=t.map(i,(function(t){return t.id})).indexOf(e.id);i=t.map(i,(function(t){return a.getThumbnail(t)})),n.a.openImageBrowser(i,o)}}}}).call(this,a("391c"))},f205:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .content[data-v-19f3674d]{height:100%;padding-bottom:100px;overflow:auto}.zjapp .content .brand-info[data-v-19f3674d]{background-color:#fff;padding:15px 15px 0 15px;font-size:16px;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0)}.zjapp .content .brand-info[data-v-19f3674d],.zjapp .content .brand-name[data-v-19f3674d]{border:none;background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .content .brand-name[data-v-19f3674d]{color:#4275e8;padding-bottom:10px;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 50%,transparent 0)}.zjapp .content .brand-type[data-v-19f3674d]{display:flex;justify-content:space-between;color:#333;padding:10px 0 10px 10px}.zjapp .content .brand-spec[data-v-19f3674d]{display:flex;justify-content:space-between;padding:10px 0 10px 30px}.zjapp .content .brand-spec .quantity[data-v-19f3674d],.zjapp .content .brand-type .quantity[data-v-19f3674d]{white-space:nowrap;margin-left:10px}.zjapp .content .brand-supply .label[data-v-19f3674d]{padding-top:6px;max-width:calc(100% - 142px)}.zjapp .content .brand-supply .item-text[data-v-19f3674d]{line-height:36px}.zjapp .content .brand-supply .align-r[data-v-19f3674d]{position:relative;width:142px}.zjapp .content .brand-supply .align-r[data-v-19f3674d] .number-input{width:100%;padding-right:25px}.zjapp .content .brand-supply .align-r[data-v-19f3674d] .number-input input{text-align:right}.zjapp .content .brand-supply .align-r .text[data-v-19f3674d]{position:absolute;right:11px;top:8px}.zjapp .content .brand-supply .align-r.unit_2[data-v-19f3674d] .number-input{padding-right:40px}.zjapp .content .brand-supply .align-r.unit_3[data-v-19f3674d] .number-input{padding-right:55px}.zjapp .content .photo-list[data-v-19f3674d]{flex-direction:column;padding-bottom:15px;background-color:#fff}.zjapp .content .pic-list[data-v-19f3674d]{padding:10px 0 10px 15px;background-image:linear-gradient(0deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-position:bottom}.zjapp .content .approach-info[data-v-19f3674d],.zjapp .content .pic-list[data-v-19f3674d]{border:none;background-size:100% 1px;background-repeat:no-repeat}.zjapp .content .approach-info[data-v-19f3674d]{background-color:#fff;padding-top:1px;background-image:linear-gradient(180deg,#dcdcdc,#dcdcdc 33.3333%,transparent 0);background-position:top}.zjapp .content .item-select-box[data-v-19f3674d]{display:inline-block;height:34px;line-height:32px;min-width:60px;padding:0 5px;border:1px solid #d9d9d9;background:#fff;color:#666;vertical-align:top;font-size:14px;text-align:center;border-radius:3px}.zjapp .content .item-select-box+.item-select-box[data-v-19f3674d]{margin-left:15px}.zjapp .content .item-select-box.selected[data-v-19f3674d]{border-color:#4275e8;color:#4275e8}.zjapp .content .title-name[data-v-19f3674d]{font-size:16px;padding:15px 0 10px 15px;color:#8c8c8c}.zjapp .content .pic-title[data-v-19f3674d]{padding:5px 0 10px 0}.zjapp .content .photo-list[data-v-19f3674d]{padding:10px 0 10px 15px}.zjapp .content .photo-list p[data-v-19f3674d]{font-size:16px;color:#8c8c8c;padding-bottom:10px}",""])},f2a6:function(t,e,a){"use strict";var i=a("3ccf").a,n=(a("c523"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("scroller",{ref:"scroller"},[a("item",{staticClass:"material-name",attrs:{label:"材料名称",mode:"edit"}},[a("div",{staticClass:"item-text txt",attrs:{slot:"right"},slot:"right"},[t._v(t._s(t.approachData.material.name))])]),t._l(t.approachData.brands,(function(e,i){return a("div",{key:e.id,staticClass:"brand-item"},[i?a("i",{staticClass:"item-icon-remove",on:{click:function(e){e.stopPropagation(),t.removeBrand(i)}}}):t._e(),a("material-info-select",{attrs:{options:t.approachData.brandsList,"options-disabled":t.approachData.brands,title:"品牌","right-btn":t.allowCustomBrand?"手工添加":""},on:{onSelect:function(a){return t.onSelectBrands(e,a)}},model:{value:e.selectedBrand,callback:function(a){t.$set(e,"selectedBrand",a)},expression:"brand['selectedBrand']"}}),t._l(e.standard,(function(n,o){return a("div",{key:""+o+n.id,staticClass:"brand-info-item"},[a("div",{staticClass:"brand-type"},[a("i",{staticClass:"item-icon-remove",on:{click:function(a){a.stopPropagation(),t.removeType(e,o)}}}),a("material-info-select",{attrs:{options:t.approachData.standardList,"options-disabled":e.standard,"standard-unit":t.approachData.standard_unit,"custom-type":"2","place-holder":"请输入材料类型",title:"类型","right-btn":t.allowCustomType?"手工添加":""},on:{onSelect:t.onMaterialTypeSelect},model:{value:e.standard[o],callback:function(a){t.$set(e.standard,o,a)},expression:"brand.standard[key]"}})],1),n.specificationList&&n.specificationList.length&&n.specification&&n.specification.length?[t._l(n.specification,(function(i,o){return a("div",{key:o+i.name,staticClass:"spec-item"},[a("i",{staticClass:"item-icon-remove",on:{click:function(a){a.stopPropagation(),t.removeSpec(n.specification,o,n,e)}}}),a("div",{staticClass:"item-text"},[t._v(t._s(i.name))]),a("div",{staticClass:"item-ele align-r",class:n.quantity_unit?"unit_"+n.quantity_unit.length:"unit_"+t.approachData.standard_unit.length},[a("number-input",{staticClass:"color-theme",attrs:{type:"positive",decimal:3,"overflow-auto-recover":!1,range:[0,999999.999],"is-set-empty-tip":t.isSubmitData},on:{blur:function(e){t.pushInSaveStack("approachSaveDetail")}},model:{value:i.num,callback:function(e){t.$set(i,"num",e)},expression:"specification.num"}}),a("span",{staticClass:"text"},[t._v(t._s(n.quantity_unit||t.approachData.standard_unit))])],1)])})),a("material-info-select",{attrs:{options:n.specificationList,multi:!0,title:"规格","right-btn":t.allowCustomSpec?"手工添加":"","place-holder":"请输入材料规格"},on:{onSelect:function(e){return t.onSelectSpecification(n,e)}},model:{value:n.specification,callback:function(e){t.$set(n,"specification",e)},expression:"type.specification"}},[a("div",{staticClass:"add-btn alignL"},[t._v("+ 新增规格")])])]:t._e(),!n.specificationList||!n.specificationList.length||n.specification&&n.specification.length?t._e():[a("material-info-select",{attrs:{options:n.specificationList,multi:!0,title:"规格","right-btn":t.allowCustomSpec?"手工添加":"","place-holder":"请输入材料规格"},on:{onSelect:function(e){return t.onSelectSpecification(n,e)}},model:{value:n.specification,callback:function(e){t.$set(n,"specification",e)},expression:"type.specification"}})],!n||!n.id||n.specificationList&&n.specificationList.length?t._e():[a("div",{staticClass:"spec-item"},[a("div",{staticClass:"item-text"},[t._v("数量")]),a("div",{staticClass:"item-ele align-r",class:n.quantity_unit?"unit_"+n.quantity_unit.length:"unit_"+t.approachData.standard_unit.length},[a("number-input",{key:"num_"+i,staticClass:"color-theme",attrs:{type:"positive",decimal:3,"overflow-auto-recover":!1,range:[0,999999.999],"is-set-empty-tip":t.isSubmitData},on:{blur:function(e){t.pushInSaveStack("approachSaveDetail")}},model:{value:n.num,callback:function(e){t.$set(n,"num",e)},expression:"type.num"}}),a("span",{staticClass:"text"},[t._v(t._s(n.quantity_unit||t.approachData.standard_unit))])],1)])]],2)})),t.hadBrand&&t.approachData.brands[i].id?a("div",{staticClass:"add-btn",on:{click:function(a){t.addStandard(e)}}},[t._v("\n        + 新增类型\n      ")]):t._e()],2)})),a("div",{staticClass:"add-btn mt10",on:{click:t.addBrands}},[t._v("+ 新增品牌")]),a("div",{staticClass:"mt10"},[a("item",{attrs:{mode:"edit",label:"进场时间",editabled:!0,text:t.approachData.date},on:{click:t.selectApproachDate}}),t.model.supplyData.id?a("item",{staticClass:"photo-list pic-list"},[a("p",{staticClass:"photo-type"},[t._v("供货单")]),a("item-img-list",{attrs:{"model-id":t.model.supplyData.id,maxlength:50},model:{value:t.model.supplyData.shipping_image,callback:function(e){t.$set(t.model.supplyData,"shipping_image",e)},expression:"model.supplyData.shipping_image"}})],1):t._e(),t.isIeceiverPhotoType?t._e():a("item",{staticClass:"photo-list"},[a("p",{staticClass:"photo-type"},[t._v("进场照片")]),a("item-img-list",{attrs:{"allow-multi-select":!0,maxlength:50,"prepare-callback":function(){return t.prepareTakePicture([t.model.approachData,t.model.activeLog,t.model.batchData],"approach","","")}},on:{callback:function(e){t.pushInSaveStack("approachSaveLog")}},model:{value:t.approachData.img,callback:function(e){t.$set(t.approachData,"img",e)},expression:"approachData.img"}})],1),t.isIeceiverPhotoType?t._l(t.approachData.receiverImg,(function(e,i){return a("div",{key:""+i+e.id,staticClass:"photo-list pic-list"},[a("p",{staticClass:"mb15 photo-type"},[t._v(t._s(e.title))]),a("item-img-list",{attrs:{maxlength:50,"allow-multi-select":!0,"prepare-callback":function(){return t.prepareTakePicture([t.model.approachData,t.model.activeLog,t.model.batchData],"approach","receiverImg",e.photo_requirement_id)}},on:{callback:function(e){t.pushInSaveStack("photoTypeSaveLog","receiverImg")}},model:{value:e.image_file,callback:function(a){t.$set(e,"image_file",a)},expression:"item.image_file"}})],1)})):t._e()],2),a("div",{staticClass:"mt10"},[a("item-textarea",{staticClass:"border-tb",attrs:{placeholder:"补充说明"},on:{blur:function(e){t.pushInSaveStack("approachSaveLog")}},model:{value:t.approachData.remark,callback:function(e){t.$set(t.approachData,"remark",e)},expression:"approachData.remark"}}),a("item",{attrs:{label:"接收单位",mode:"edit"}},[a("div",{staticClass:"item-text txt",attrs:{slot:"right"},slot:"right"},[t._v("\n          "+t._s(t.approachData.contractor&&t.approachData.contractor.name)+"\n        ")])]),a("item",{attrs:{label:"接收人",mode:"edit"}},[a("div",{staticClass:"item-text txt",attrs:{slot:"right"},slot:"right"},[t._v("\n          "+t._s(t.approachData.receiver&&t.approachData.receiver.name)+"\n        ")])]),a("item",{attrs:{label:"监理",mode:"edit"}},[a("div",{staticClass:"item-text txt",attrs:{slot:"right"},slot:"right"},[t._v("\n          "+t._s(t.approachData.checker&&t.approachData.checker.name)+"\n        ")])]),a("item",{attrs:{label:"建设单位验收人",mode:"edit"}},[a("div",{staticClass:"item-text txt",class:{"color-b2b2b2":!t.constructers},attrs:{slot:"right"},slot:"right"},[t._v("\n          "+t._s(t.constructers||"无")+"\n        ")])]),t.areaChecker.length?a("item",{attrs:{label:"区域验收人",mode:"edit"}},[a("div",{staticClass:"item-text txt",attrs:{slot:"right"},slot:"right"},[t._v(t._s(t.areaChecker))])]):t._e(),a("user-select",{attrs:{options:t.ccList,title:"抄送人",multi:!0,editabled:t.isSupervision,required:!1},on:{onSelect:function(){return t.pushInSaveStack("approachSaveDetail")}},model:{value:t.batchData.cc,callback:function(e){t.$set(t.batchData,"cc",e)},expression:"batchData.cc"}})],1)],2),a("app-button-group",{attrs:{"fixed-bottom":""}},[a("app-button",{on:{click:t.approachSubmit}},[t._v("申请进场验收")])],1)],1)}),[],!1,null,"7898d325",null);e.a=o.exports},f369:function(t,e,a){"use strict";var i=a("fd50"),n=a("bcc7"),o=a("329b"),r=a("d1d1").a,s=(a("3411"),a("17cc")),c={name:"CheckGuideList",components:{GuideList:Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"guide-box"},[!t.isLoading&&t.listData.length?a("div",{staticClass:"page-scroll"},t._l(t.listData,(function(e,i){return a("div",{key:i},[a("item",{attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){t.clickItem(e)}}},[a("div",{staticClass:"item-text fw-b color-blue one-line"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,i){return a("div",{key:i,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){t.clickItem(e)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,i){return a("div",{key:i,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){t.clickItem(e)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])]),e.isOpen?t._l(e.subitem,(function(e,i){return a("div",{key:i,staticClass:"sublist"},[a("item",{staticClass:"pl0",attrs:{border:"bottom","icon-right":e.subitem&&e.subitem.length?e.isOpen?"arrow-up":"arrow-down":"arrow-right"},on:{click:function(a){t.clickItem(e)}}},[a("div",{staticClass:"item-text checkitem-list-name"},[t._v(t._s(e.item_name))])])],1)})):t._e()],2)})):t._e()],2)})):t._e()],2)}))):t._e(),a("loading-status",{attrs:{"is-loading":t.isLoading,"is-empty":!t.listData.length,"empty-text":"没有检查项"}})],1)}),[],!1,null,"ff0679ce",null).exports},mixins:[a("e89f").a],data:function(){return{show:!1}},methods:{openPopup:function(t){var e=this;this.value=!0,this.show=!0,this.$nextTick((function(){e.$refs["guide-list"].init(t),e.$emit("open")}))},closePopup:function(){this.value=!1,this.show=!1,this.$emit("close")}}},l=Object(s.a)(c,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"slide-right"}},[this.show?e("page-content",{attrs:{mode:"dialog",title:"检查指引","on-close":this.closePopup}},[e("guide-list",{ref:"guide-list"})],1):this._e()],1)}),[],!1,null,null,null).exports,d=!1;d||(d=new(o.default.extend(l))({el:document.createElement("div")}),document.body.appendChild(d.$el));var p=d,u=a("515e"),h=a("91c1").a,m=(a("dc98"),Object(s.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{staticClass:"main",style:{top:t.contentTop+"px"}},[a("i",{staticClass:"arrow"}),a("div",{staticClass:"content",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePopup(e)}}},[a("transition",{attrs:{name:"slide-down"},on:{enter:function(e){t.isOpening=!0},"after-enter":function(e){t.isOpening=!1},leave:function(e){t.isClosing=!0},"after-leave":t.afterClose}},[t.showList?a("div",{staticClass:"box",style:{height:t.listHeight+"px"}},t._l(t.data,(function(e,i){return a("div",{key:i,class:{"border-bottom":t.data.length>1,"box-single":1===t.data.length}},[a("div",{staticClass:"detail-hd",class:{"border-bottom":t.data.length<=1,"detail-hd-single":t.data.length<=1},on:{click:function(a){t.toggleItem(e)}}},[t.data.length>1?a("i",{class:{"detail-arrow-right":!e.isOpen,"detail-arrow-down":e.isOpen}}):t._e(),a("div",{staticClass:"detail-title"},[t._v(t._s(e.name))])]),t.data.length<=1||e.isOpen?a("div",{staticClass:"detail-bd",class:{"detail-bd-single":t.data.length<=1}},[t._l(e.textArr,(function(e,i){return a("p",{key:i,staticClass:"text-line"},[t._v("\n              "+t._s(e)+"\n            ")])})),a("item-img-list",{attrs:{editabled:!1},model:{value:e.contentImage,callback:function(a){t.$set(e,"contentImage",a)},expression:"item.contentImage"}}),a("loading-status",{attrs:{"is-empty":!e.textArr.length&&!e.contentImage.length,"empty-text":"PC端未设置检查指引"}})],2):t._e()])}))):t._e()])],1)]):t._e()}),[],!1,null,"2cac8864",null).exports),f=!1;f||(f=new(o.default.extend(m))({el:document.createElement("div")}),document.body.appendChild(f.$el));var g=f,b={name:"CheckGuide",components:{},props:{module:{type:String,default:""},mode:{type:String,default:"page"},itemId:{type:String,default:""},itemIds:{type:Array,default:function(){return[]}},batchId:{type:String,default:""},sectionId:{type:String,default:""},options:{type:Array,default:function(){return[]}},optionsPromise:{type:Function,default:function(){}},beforeOpen:{type:Function,default:function(){}}},data:function(){return{isLoading:!1}},methods:{openCheckGuide:function(){var t=this,e=this.beforeOpen&&this.beforeOpen();e instanceof Promise||(e=Promise.resolve(e)),e.then((function(e){!1!==e&&("drop"===t.mode?g.openPopup({itemIds:t.itemIds,el:t.$refs["check-guide-btn"],options:t.options}):("templet-plan"===t.module?i.a.when(!1):t.itemId&&t.sectionId?n.a.hasChildSectionCheckItem(t.itemId,t.sectionId):t.itemId?n.a.hasChildCheckItem(t.itemId):i.a.when(!0)).then((function(e){e?p.openPopup({module:t.module,itemId:t.itemId,batchId:t.batchId,sectionId:t.sectionId,options:t.options}):u.a.openPopup({itemId:t.itemId,module:t.module})})))}))}}},v=Object(s.a)(b,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"check-guide-btn",staticClass:"header-btn",on:{click:function(e){t.openCheckGuide()}}},[a("icon",{attrs:{name:"nav-info"}})],1)}),[],!1,null,null,null);e.a=v.exports},f3d7:function(t,e,a){"use strict";a("9120")},f53a:function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".zjapp .number-keyboard-con[data-v-6337f428]{position:absolute;left:0;bottom:0;width:100%;padding:4px 0;background-color:#fafafa;box-shadow:0 -4px 8px 0 rgba(0,0,0,.08);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.zjapp .ios-bezel-less[data-v-6337f428]{padding-bottom:34px}.zjapp .keyboard-row[data-v-6337f428],.zjapp .keys-row[data-v-6337f428]{display:flex}.zjapp .row-span-1[data-v-6337f428]{flex:1}.zjapp .row-span-2[data-v-6337f428]{flex:2}.zjapp .row-span-3[data-v-6337f428]{flex:3}.zjapp .keys[data-v-6337f428]{flex:1;height:48px;line-height:48px;text-align:center;font-size:18px;margin:4px;border:1px solid rgba(5,5,5,.07);border-radius:8px;background-color:#fff;padding:0}.zjapp .keys-next[data-v-6337f428],.zjapp .keys-prev[data-v-6337f428]{font-size:14px;color:#4275e8}.zjapp .keys-ok[data-v-6337f428]{font-size:14px;color:#999}.zjapp .keys-delete[data-v-6337f428]{color:#999}.zjapp .icon[data-v-6337f428]{pointer-events:none}.zjapp .icon-keyboard-close[data-v-6337f428]{font-size:20px;color:#999}.zjapp .icon-keyboard-delete[data-v-6337f428]{vertical-align:top;margin-top:13px;font-size:14px;color:#333}.zjapp .activing[data-v-6337f428]{background-color:#ececec}.zjapp .disabled[data-v-6337f428]{color:#999}.zjapp .col[data-v-6337f428]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:104px;line-height:36px}",""])},f5bd:function(t,e,a){"use strict";a("6a61");var i,n=a("2e91"),o=a("46ae"),r=(a("e2a7"),a("9094")),s=a("e89f"),c=a("24de"),l="没有相关合同",d="当前无网络",p={name:"MaterialTaskContract",components:{SlideUpSelect:o.a},mixins:[s.a],props:{value:{type:Object,default:function(){return{}}}},data:function(){return{emptyText:l,list:[]}},computed:{proj_id:function(){return this.$store.state.global.currentProject.id}},created:function(){this.init()},activated:function(){this.init()},methods:{init:function(){this.contractList(),this.emptyText=l},contractList:(i=Object(n.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.checkHasNetwork(!0);case 3:return t.next=5,Object(r.a)({proj_id:this.proj_id});case 5:e=(e=t.sent).map((function(t){return{id:t.contract_id,name:t.contract_name}})),this.list=e,$log.log("材料验收-查询合同列表"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),t.t0&&t.t0.noNetwork&&(this.emptyText=d),$log.error("材料验收-获取合同列表-error->",t.t0);case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return i.apply(this,arguments)}),onSelect:function(t){this.$emit("onSelect",t)}}},u=a("17cc"),h=Object(u.a)(p,(function(){var t=this.$createElement;return(this._self._c||t)("slide-up-select",{attrs:{value:this.value,title:"所属合同",options:this.list,"empty-text":this.emptyText,"allow-search":!0,"init-height":500,"history-key":"material-task-contract"},on:{onSelect:this.onSelect}})}),[],!1,null,null,null);e.a=h.exports},f5d4:function(t,e,a){"use strict";var i=a("329b"),n=a("07d2"),o=a("e68e"),r=a("cd05"),s=a("e89f"),c={name:"MaterialCheckPopup",components:{Item:n.default,ItemImgList:o.a,UserSelect:r.a},mixins:[s.a],data:function(){return{show:!1,reportData:{}}},methods:{open:function(t){this.show=!0,this.checkData=t},close:function(){this.show=!1}}},l=(a("95c9"),a("17cc")),d=Object(l.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-right"}},[t.show?a("page-content",{attrs:{title:"首次送检记录",mode:"dialog","on-close":t.close}},[a("div",{staticClass:"brand-info border-bottom"},t._l(t.checkData.brands,(function(e){return a("div",{key:e.id},[a("div",{staticClass:"brand-name border-bottom"},[t._v(t._s(e.name))]),t._l(e.standard,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"brand-type"},[a("div",{staticClass:"flex one-line"},[t._v(t._s(e.name))]),e.specification&&e.specification.length?t._e():a("div",[t._v("\n              "+t._s(e.num||0)+"组\n            ")])]),e.specification&&e.specification.length?t._l(e.specification,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"brand-spec"},[a("div",[t._v(t._s(e.name))]),a("div",[t._v(t._s(e.num||0)+"组")])])])})):t._e()],2)}))],2)}))),a("div",{staticClass:"mt10"},[a("item",{attrs:{label:"送检照片"}},[a("div",{staticClass:"item-con",attrs:{slot:"right"},slot:"right"},[a("item-img-list",{attrs:{"model-id":t.checkData.id,"model-field":"image_file","model-table":"material_task_log",editabled:!1,"edited-by":t.checkData.created_by},model:{value:t.checkData.img,callback:function(e){t.$set(t.checkData,"img",e)},expression:"checkData.img"}})],1)]),a("item",{attrs:{mode:"view",label:"送检时间",editabled:!1,text:t.checkData.date}}),a("user-select",{attrs:{title:"送检人",mode:"view",editabled:!1,date:t._f("formatDate")(t.checkData.check_date)},model:{value:t.checkData.checker,callback:function(e){t.$set(t.checkData,"checker",e)},expression:"checkData.checker"}})],1)]):t._e()],1)}),[],!1,null,"cbca839c",null).exports,p=!1;p||(p=new(i.default.extend(d))({el:document.createElement("div")}),document.body.appendChild(p.$el));e.a=p},f6e3:function(t,e,a){var i=a("53bf");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("d3b0c900",i,!0,{sourceMap:!1,shadowMode:!1})},f711:function(t,e,a){"use strict";var i=a("3c64"),n=a("e2a7"),o=a("04f3"),r={name:"MaterialTaskVoidDialog",components:{ItemTextarea:i.a},data:function(){return{show:!1,reason:"",backButtonEvent:null}},activated:function(){this.show=!1},methods:{open:function(){this.reason="",this.backButtonEvent||(this.backButtonEvent=Object(o.a)(this.close))},close:function(t){this.show=!1,this.backButtonEvent&&(Object(o.c)(this.backButtonEvent),this.backButtonEvent=null)},beforeClose:function(t,e){if("cancel"!==t){var a=this.reason.trim();if(!a||a.length<=0)return n.a.alert("请输入作废原因"),void e(!1);this.$emit("submit",a,e)}else e()}}},s=(a("a63e"),a("17cc")),c=Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-dialog",{attrs:{"show-cancel-button":"","get-container":"body","class-name":"dialog-customize task-void-dialog","before-close":t.beforeClose},on:{open:t.open,close:t.close},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",[a("item-textarea",{ref:"textarea-supplier",staticClass:"text-area-border",attrs:{placeholder:"请输入作废原因",maxlength:50},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}})],1)])],1)}),[],!1,null,"918e1df2",null);e.a=c.exports},f7ab:function(t,e,a){"use strict";var i=a("65e9").a,n=(a("f7d4"),a("17cc")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{ref:"synchronize-tip-bar",staticClass:"synchronize-tip-bar"},[a("icon",{attrs:{name:"caution"}}),t.waitUploadNum?a("span",[t._v("您有"+t._s(t.waitUploadNum)+"条数据待上传")]):t._e(),!t.waitUploadNum&&t.hasChanged?a("span",[t._v("有新数据")]):t._e(),t._v("\n  ，下拉可"+t._s(t.waitUploadNum?"上传":"刷新")+"\n")],1):t._e()}),[],!1,null,"66826030",null);e.a=o.exports},f7d4:function(t,e,a){"use strict";a("2d6e")},fb25:function(t,e,a){var i=a("86ac");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("85cb").default)("23902f6f",i,!0,{sourceMap:!1,shadowMode:!1})}}]);