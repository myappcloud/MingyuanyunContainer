(window.webpackJsonp_module_entry_zjapp_=window.webpackJsonp_module_entry_zjapp_||[]).push([["chunk-33d0ad87"],{"2a0b":function(e,t,a){var o=a("5454");(e.exports=a("690e")(!1)).push([e.i,".zjapp .project-select[data-v-4dc585c0]{text-align:center;padding:0 10px;line-height:44px}.zjapp .project-select .text[data-v-4dc585c0]{pointer-events:none}.zjapp .project-select-con[data-v-4dc585c0]{display:inline-block;position:relative;padding-right:23px;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;pointer-events:none;vertical-align:top}.zjapp .project-select-con .arrow[data-v-4dc585c0]{position:absolute;top:13px;right:0;width:18px;height:18px;background:url("+o(a("7fb27"))+') no-repeat;background-size:100% 100%;transition:transform .2s}.zjapp .project-select-con .arrow.active[data-v-4dc585c0]{transform:rotate(180deg)}.zjapp .notice-detail-wrip[data-v-4dc585c0]{width:100%;height:100%}.zjapp .notice-detail-wrip .layout-main[data-v-4dc585c0]{height:100%}.zjapp .notice-detail-wrip .layout-main .layout-content[data-v-4dc585c0]{background-color:#fff}.zjapp .home-page-bg[data-v-4dc585c0]{position:relative;padding:10px 0 20px 0;background:#fff}.zjapp .home-page-bg>div[data-v-4dc585c0]{position:relative;z-index:2}.zjapp .home-page-bg[data-v-4dc585c0]:after,.zjapp .home-page-bg[data-v-4dc585c0]:before{position:absolute;top:0;left:0;content:" ";display:block;width:100%;height:200px;background:linear-gradient(90deg,#2c5cf7 0,rgba(44,92,247,.8));z-index:0}.zjapp .home-page-bg[data-v-4dc585c0]:after{z-index:1;background:linear-gradient(1turn,#fff,hsla(0,0%,100%,0))}.zjapp .home-page-module[data-v-4dc585c0]{position:relative;padding:25px 0;margin:0 10px;min-height:190px;background-color:#fff;margin-bottom:10px;overflow:hidden;box-shadow:0 0 20px rgba(66,117,232,.2);border-radius:10px}.zjapp .home-page-module .module-item[data-v-4dc585c0]{text-align:center;padding:8px 0 10px}.zjapp .home-page-module .module-item-grid[data-v-4dc585c0]{float:left;width:33.3333%;text-align:center;padding:8px 0 10px}.zjapp .home-page-module .item-icon[data-v-4dc585c0]{height:27px;text-align:center}.zjapp .home-page-module .item-icon img[data-v-4dc585c0]{width:27px;height:27px}.zjapp .home-page-module .item-icon .active-icon[data-v-4dc585c0]{width:31px;height:44px;position:relative;bottom:16px}.zjapp .home-page-module .item-name[data-v-4dc585c0]{line-height:22px;margin-top:8px;color:#666;font-size:14px}.zjapp .home-page-module .module-empty[data-v-4dc585c0]{text-align:center;color:#b2b2b2}.zjapp .home-page-module .synchronize-tip-bar[data-v-4dc585c0]{position:absolute;top:0;left:0;width:100%;border-top-left-radius:10px;border-top-right-radius:10px}.zjapp .home-page-news[data-v-4dc585c0]{margin-top:10px}.zjapp .home-page-news .news-title[data-v-4dc585c0]{height:40px;line-height:14px;font-size:14px;padding:21px 15px 5px;color:#666}.zjapp .home-page-news .news-title .icon[data-v-4dc585c0]{display:inline-block;vertical-align:top;width:4px;height:14px;margin-right:6px;background:#f7c141;border-radius:2px}.zjapp .home-page-news .news-list[data-v-4dc585c0]{padding-left:20px}.zjapp .home-page-news .news-item[data-v-4dc585c0]{position:relative;padding:8px 75px 8px 0;border:none;background-image:linear-gradient(0deg,#e6e6e6,#e6e6e6 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}.zjapp .home-page-news .news-item[data-v-4dc585c0]:last-child{background:none!important}.zjapp .home-page-news .title[data-v-4dc585c0]{line-height:26px;font-size:15px;color:#111}.zjapp .home-page-news .detail[data-v-4dc585c0]{line-height:18px;font-size:12px;color:#b2b2b2}.zjapp .home-page-news .news-item-date[data-v-4dc585c0]{position:absolute;top:50%;right:15px;margin-top:-13px;line-height:26px;font-size:12px;color:#b2b2b2}.zjapp .home-page-news .news-item-empty[data-v-4dc585c0]{padding:26px 15px 26px 0;line-height:22px;text-align:center;color:#b2b2b2}.zjapp .home-page-news .news-item-empty .icon[data-v-4dc585c0]{display:inline-block;vertical-align:top;width:22px;height:22px;margin-right:10px}.zjapp .home-page-news .news-item-empty .icon img[data-v-4dc585c0]{width:22px}',""])},"394b":function(e,t,a){var o=a("8d4c");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,a("85cb").default)("a723c790",o,!0,{sourceMap:!1,shadowMode:!1})},"65e9":function(e,t,a){"use strict";(function(e){a("5ab2"),a("6d57"),a("e10e");var o=a("28f8"),i=a("4360"),n=a("48f4"),r=a("162a"),s=a("f2d3"),l=a("6906"),c=a("a18c"),d=a("c745");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){Object(o.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}t.a={name:"SynchronizeTipBar",props:{isTodo:{type:Boolean},useDownload:{type:Boolean,default:!0},enterDoCheck:{type:Boolean,default:!0},buildingId:{type:String,default:""},automaticUpdateCallback:{type:Function,default:null}},data:function(){return{currentModuleCode:"",oneUpdateData:!0}},computed:{projId:function(){return i.a.state.global.currentProject.id},waitUploadNum:function(){return i.a.state.global.waitUploadNum},hasTopProgress:function(){return i.a.state.global.hasTopProgress},hasChanged:function(){if(!this.useDownload)return!1;if(this.currentModuleCode){var e,t=n.default.isModuleNeedBuilding(this.currentModuleCode)&&!this.isTodo;return!(t&&!this.buildingId)&&(e=this.isTodo?i.a.state.global.todoChangedStatus||{}:i.a.state.global.businessChangedStatus||{},t?!!e[this.currentModuleCode]&&e[this.currentModuleCode][this.buildingId]:e[this.currentModuleCode])}return!1},show:function(){return(this.hasChanged||this.waitUploadNum)&&!this.hasTopProgress},oneDataSync:function(){return this.$store.state.app.oneDataSync}},watch:{hasChanged:function(e){var t=this;e&&this.$nextTick((function(){setTimeout((function(){var e=t.$refs["synchronize-tip-bar"];if(e&&e.style){e.style.display="none";var a=e.offsetHeight;e.style.display="block",$log.log(a)}}),100)}))},buildingId:function(e){this.currentModuleCode&&n.default.isModuleNeedBuilding(this.currentModuleCode)&&e&&(console.log("楼栋重新加载，是否再次自动加载数据：",this.oneUpdateData),this.oneUpdateData&&this.automaticLogic(),this.checkSync())},show:function(e){e?this.$emit("show"):this.$emit("hide")}},activated:function(){this.init()},methods:{init:function(){this.getCurrentModuleCode(),this.enterDoCheck&&!c.a.isBack&&this.checkSync(),this.automaticLogic()},automaticLogic:function(){var e=this;this.$router.isBack||(this.oneUpdateData=!0,d.a.getAutomaticLoadData().then((function(t){$log.log("是否要自动加载 ===> ",t&&e.oneDataSync&&"function"==typeof e.automaticUpdateCallback),t&&e.oneDataSync&&"function"==typeof e.automaticUpdateCallback&&e.dataSync().then((function(t){console.log("是否需要初始化页面 ====> ",Boolean(t)),t&&e.automaticUpdateCallback()}))})))},getCurrentModuleCode:function(){var e=n.default.getCurrentModuleCode(),t=this.isTodo?"todo":"";this.currentModuleCode=e||t},checkSync:function(){var t=this,a="checkDataUpdate",o=this.currentModuleCode,r=this.buildingId,c=i.a.state.global.isLeader?this.projId:"";return!n.default.isModuleNeedBuilding(o)||r||this.isTodo?(this.isTodo&&(a+="_todo"),o&&(a+="_".concat(o)),r&&(a+="_".concat(r)),l.a.execAfterInterval(120,a).then((function(){return t.isTodo?"todo"===o?s.a.getModuleList().then((function(t){var a=e.map(t,"code");return n.default.hasTodoChangedData("",a)})):n.default.hasTodoChangedData("",[o]):n.default.hasBusinessChangedData(c,[o],r)})).then((function(e){if(t.isTodo){var a=u({},i.a.state.global.todoChangedStatus);a[o]=e,i.a.commit("global/SET_TODO_CHANGED_STATUS",a)}else{var n=u({},i.a.state.global.businessChangedStatus);if(r){var s=n[o]?n[o]:{};s[r]=e,n[o]=s}else n[o]=e;i.a.commit("global/SET_BUSINESS_CHANGED_STATUS",n)}})).catch((function(e){return e&&!0===e.timeNotTo?($log.debug(e.msg),!1):$q.reject(e)}))):Promise.resolve()},dataSync:function(){var e=this.currentModuleCode,t=this.buildingId,a=n.default.isModuleNeedBuilding(e),o=a&&!t;return $log.log("模块名：",e," 楼栋id：",t," 当前模块是否需要楼栋id：",a," 判断是否终止自动更新：",o),o?Promise.resolve():(this.oneUpdateData=!1,r.a.beginManualUpdate(),n.default.checkSync(t).then((function(e){return r.a.endManualUpdate(),e})).catch((function(e){$log.error("自动更新错误",e),r.a.endManualUpdate()})))}}}}).call(this,a("391c"))},"66f8":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAMAAAAPdrEwAAAAXVBMVEUAAADJycni4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLIyMjIyMji4uLIyMjIyMjJycnPz8/IyMjIyMjIyMji4uLi4uLIyMjLy8vJycnIyMjZ2dnJycnIyMji4uLa2tqOIKRyAAAAHHRSTlMAMwHxuR7zvWllS+Yh871H/eeEgGQgGNjDs5Q0bEl4+QAAAURJREFUWMPt2GkOwiAQhmGKOxWwLnVjvP8xbY11UvlBzQxxm+8Ab56ka1DDZ5y1zqgMW4fb1vxlE+5jd+t9l95r3vJkHB4bTzjJixFgGkYLzUcGgFVXXgEAwsnkZpcufQEAhBPJ7abz7uabTwEQTibDbIePzG4GCKeTexWNcDJ5qZ6GcEZyDKeT03A6OYazkXFLhNPJaTidHMMJZDpcbyMyAZ4k0+ExmQAnk2M4gZyCb2OWPwSmHXy/vAmM20Q/GXwzCud4007hbPulPp0L8s6n9stvFS408wXLfNt6ShdMk7SkJf2facW030z7Mgxc6V9MYzndzpeuXkybajDafM5llLSkJU1585WeL30vYztfuuJLm6qPNl9xGSUtaUm/MV3zlOtHGg8tjjVL+dikbMajlowHRHmPtXDeWZ6udV7JZLLP2hV1pKxnDHsrZAAAAABJRU5ErkJggg=="},"757f":function(e,t,a){"use strict";a.r(t);var o=a("adb8").a,i=(a("d945"),a("17cc")),n=Object(i.a)(o,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("page-content",{attrs:{"is-special-header":!0}},[e.model.isLoading?[o("span",{staticClass:"text",attrs:{slot:"header-bar"},slot:"header-bar"},[e._v("...")])]:e.projectList&&e.projectList.length?o("drop-down-select-single",{ref:"home-index-company-select",attrs:{slot:"header-bar",options:e.projectList,type:"home",selected:e.selectProject},on:{select:e.onSelectProject},slot:"header-bar"}):[o("span",{staticClass:"text",attrs:{slot:"header-bar"},slot:"header-bar"},[e._v("无项目权限或未建标段")])],o("scroller",{attrs:{"is-empty":e.loading},on:{pullDown:e.onRefresh}},[e.loading?e._e():o("div",{staticClass:"home-page-bg"},[o("div",{staticClass:"home-page-module"},[o("synchronize-tip-bar",{attrs:{"use-download":!1}}),o("div",[!e.model.isLoading&&e.model.moduleList.length<=2?e._l(e.model.moduleList,(function(t,a){return o("div",{key:a,staticClass:"module-item",on:{click:function(a){e.enterModule(t)}}},["project-highlight"===t.code?o("div",{staticClass:"item-icon"},[t.isHasNewData?o("img",{staticClass:"active-icon",attrs:{src:t.activeIcon,alt:t.name}}):e._e(),t.isHasNewData?e._e():o("img",{attrs:{src:t.icon,alt:t.name}})]):e._e(),"project-highlight"!==t.code?o("div",{staticClass:"item-icon"},[o("img",{attrs:{src:t.icon,alt:t.name}})]):e._e(),o("div",{staticClass:"item-name",domProps:{textContent:e._s(t.name)}})])})):e._e(),!e.model.isLoading&&e.model.moduleList.length>2?o("div",{staticClass:"clearfix"},e._l(e.model.moduleList,(function(t,a){return o("div",{key:a,staticClass:"module-item-grid",on:{click:function(a){e.enterModule(t)}}},["project-highlight"===t.code?o("div",{staticClass:"item-icon"},[t.isHasNewData?o("img",{staticClass:"active-icon",attrs:{src:t.activeIcon,alt:t.name}}):e._e(),t.isHasNewData?e._e():o("img",{attrs:{src:t.icon,alt:t.name}})]):e._e(),"project-highlight"!==t.code?o("div",{staticClass:"item-icon"},[o("img",{attrs:{src:t.icon,alt:t.name}})]):e._e(),o("div",{staticClass:"item-name",domProps:{textContent:e._s(t.name)}})])}))):e._e(),e.model.isLoading||e.model.moduleList.length?e._e():o("div",{staticClass:"module-empty"},[e._v("功能模块马上登场，请稍候...")]),e.model.isLoading?o("div",{staticClass:"module-item"},[e._v("...")]):e._e()],2)],1),o("div",{staticClass:"list home-page-news"},[o("div",{staticClass:"news-title"},[o("span",{staticClass:"icon"}),e._v("公告\n        ")]),o("div",{staticClass:"news-list"},[e.model.isNoticeLoading?e._e():e._l(e.model.noticeList,(function(t,a){return o("div",{key:a,staticClass:"news-item",on:{click:function(a){e.newsDetail(t)}}},[o("div",{staticClass:"news-item-con"},[o("p",{staticClass:"title one-line"},[e._v(e._s(t.title||""))]),o("p",{staticClass:"detail one-line"},[e._v(e._s(t.detail||""))])]),o("div",{staticClass:"news-item-date"},[e._v(e._s(e._f("formatDate")(t.publish_time,"MM-DD")))])])})),e.model.isNoticeLoading?o("div",{staticClass:"news-item-empty"},[e._v("加载中...")]):e._e(),e.model.isNoticeLoading||e.model.noticeList.length?e._e():o("div",{staticClass:"news-item-empty"},[o("span",{staticClass:"icon"},[o("img",{attrs:{src:a("66f8"),alt:""}})]),o("span",{domProps:{textContent:e._s(e.projectSelected.id?"暂无公告":"请先选择一个项目")}})])],2)])]),o("loading-status",{attrs:{"is-loading":e.loading}})],1)],2)}),[],!1,null,"4dc585c0",null);t.default=n.exports},"774b":function(e,t,a){"use strict";var o=a("d18d").a,i=(a("b225"),a("17cc")),n=Object(i.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"scroll-warp",staticClass:"scroll-warp",class:{"scroll-warp-pulling":e.pulling,"scroll-warp-complete":!e.hasNext&&!e.isEmpty,"scroll-warp-empty":e.isEmpty},style:{"padding-bottom":e.numberKeyboardCoverHeight+"px"},on:{scroll:e.onScroll,touchstart:e.onTouchstart,touchmove:e.onTouchmove,touchend:e.onTouchend}},[e.allowPullDown?a("div",{staticClass:"pull-refresh-warp",style:{height:e.pullDist+"px"}},[a("div",{staticClass:"pull-refresh"},[a("div",{staticClass:"animation-refresher",class:{refreshing:e.refreshing}}),e.updateTime?a("p",{staticClass:"pull-refresh-date"},[e._v("最后成功同步："+e._s(e.updateTime))]):e._e()])]):e._e(),e._t("default"),e.loading?a("div",{staticClass:"page-loading"},[a("svg",{staticClass:"svg-loading",attrs:{viewBox:"0 0 80 80"}},[a("circle",{attrs:{cx:"40",cy:"40",r:"36"}})])]):e._e(),e.hasNext||e.isEmpty?e._e():[e.$slots.end?e._t("end"):e._e(),!e.$slots.end&&e.endText?a("div",{staticClass:"end-text"},[e._v("\n      "+e._s(e.endText)+"\n    ")]):e._e()]],2)}),[],!1,null,"2b1a346c",null);t.a=n.exports},"8d4c":function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,".zjapp .synchronize-tip-bar[data-v-aaf184a8]{height:30px;padding:5px 15px;line-height:20px;text-align:center;background-color:#ffe6e6;color:#ff6060;font-size:14px}.zjapp .synchronize-tip-bar .icon-caution[data-v-aaf184a8]{line-height:20px;margin-right:5px}@media screen and (-webkit-min-device-pixel-ratio:1){.zjapp .synchronize-tip-bar[data-v-aaf184a8]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 100%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:1.5){.zjapp .synchronize-tip-bar[data-v-aaf184a8]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 66.6667%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2){.zjapp .synchronize-tip-bar[data-v-aaf184a8]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 50%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:2.625){.zjapp .synchronize-tip-bar[data-v-aaf184a8]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 38.0952%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:3){.zjapp .synchronize-tip-bar[data-v-aaf184a8]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 33.3333%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}@media screen and (-webkit-min-device-pixel-ratio:4){.zjapp .synchronize-tip-bar[data-v-aaf184a8]{border:none;background-image:linear-gradient(0deg,#ffd3d3,#ffd3d3 25%,transparent 0);background-size:100% 1px;background-repeat:no-repeat;background-position:bottom}}",""])},"9d55":function(e,t,a){(e.exports=a("690e")(!1)).push([e.i,'.zjapp .scroll-warp[data-v-2b1a346c]{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}.zjapp .scroll-warp-pulling[data-v-2b1a346c]{overflow:hidden}.zjapp .scroll-warp-complete[data-v-2b1a346c]:after{content:"";display:block;height:100px}.zjapp .scroll-warp-empty[data-v-2b1a346c]{display:flex;flex-direction:column}.zjapp .pull-refresh-warp[data-v-2b1a346c]{position:relative;height:0;overflow:hidden}.zjapp .pull-refresh[data-v-2b1a346c]{position:absolute;left:0;bottom:0;height:70px;width:100%;padding:6px;text-align:center}.zjapp .pull-refresh-date[data-v-2b1a346c]{margin-top:4px;height:16px;line-height:16px;font-size:12px;color:#bcbcbc}.zjapp .page-loading[data-v-2b1a346c]{padding:10px;text-align:center}.zjapp .end-text[data-v-2b1a346c]{color:#c8c8c8;background:#f4f4f4;position:relative;line-height:76px;height:76px;text-align:center}.zjapp .end-text[data-v-2b1a346c]:after,.zjapp .end-text[data-v-2b1a346c]:before{content:"";position:absolute;width:48px;height:1px;background:#e4e4e4;top:50%;margin-top:-1px}.zjapp .end-text[data-v-2b1a346c]:after{left:50%;transform:translateX(-92px)}.zjapp .end-text[data-v-2b1a346c]:before{right:50%;transform:translateX(90px)}.zjapp .end-slot[data-v-2b1a346c]{padding:30px;line-height:18px;text-align:center;color:#c8c8c8}',""])},a7b6:function(e,t,a){"use strict";a("394b")},adb8:function(e,t,a){"use strict";(function(e){a("e697"),a("cc57"),a("6a61");var o,i=a("2e91"),n=a("774b"),r=a("f7ab"),s=a("e2a7"),l=a("ed08"),c=a("f97c"),d=a("48f4"),p=a("c656"),u=a("6144"),h=a("6f9e"),g=(a("162a"),a("2137"));a("1b7e"),a("7bac");t.a={name:"WorkBench",components:{Scroller:n.a,SynchronizeTipBar:r.a,DropDownSelectSingle:g.a},data:function(){return{loading:!1,showPopup:!1,selectProject:{},model:{isLoading:!0,moduleList:[],noticeList:[],defaultProject:{}}}},computed:{projectList:function(){return this.$store.state.global.allProjectsTreeData},allProjects:function(){return this.$store.state.global.allProjects},projectSelected:function(){return this.$store.state.global.currentProject}},created:function(){var e=this;this.loading=!0,Object(h.e)(this.init),h.a.$on("guangmingWakeUp",(function(){e.init()}))},activated:function(){this.init()},methods:{init:function(){var e=this;c.a.init().then((function(){e.loading=!1,e.model=c.a,e.getProjects()}))},getProjects:(o=Object(i.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("global/setAllProjects");case 2:this.selectProject=this.projectSelected,this.selectProject&&!e.isEmpty(this.selectProject)&&this.onSelectProject(this.selectProject,{name:this.selectProject.parent_name});case 4:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),onSelectProject:function(e,t){var a=this;this.selectProject=e,e.parent_name=t&&t.name,e.parent_name&&this.$store.commit("global/SET_CURRENT_PROJECT",e),this.model.saveAsDefaultProject(e),p.a.getProjNotice(this.projectSelected.id).then((function(e){a.model.noticeList=e})),d.default.setLocalChanged(),d.default.showTopProgress(),d.default.executeSync()},enterModule:function(t){if("photos"===t.code)return this.$router.push({name:t.routerName});if(t&&t.code)if(e.isEmpty(this.projectSelected))s.a.alert("请先选择一个项目");else{var a=e.find(this.model.moduleList.concat(this.model.headList),(function(e){return e.code===t.code}));this.projectSelected.expire_time&&this.projectSelected.expire_time<=l.a.now()&&"报表"!==a.name?s.a.alert("该项目租期已过"):this.$router.push({name:t.routerName})}else s.a.alert("无效的模块编码")},newsDetail:function(e){u.a.saveObject("workBrenchCacheNotice",e),this.$router.push({path:"/notice",param:{id:e.id}})},onRefresh:function(){this.init()}}}}).call(this,a("391c"))},b225:function(e,t,a){"use strict";a("ef48")},b97a:function(e,t,a){var o=a("2a0b");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,a("85cb").default)("d49138b2",o,!0,{sourceMap:!1,shadowMode:!1})},d18d:function(e,t,a){"use strict";(function(e){a("2b45");var o,i=a("4360"),n=a("48f4"),r=a("162a"),s=a("e2a7"),l=a("a500"),c=a("6f9e"),d={};t.a={name:"Scroller",props:{buildingId:{type:String,default:""},hasNext:{type:Boolean,default:!1},isEmpty:{type:Boolean,default:!1},isSync:{type:Boolean,default:!0},endText:{type:String,default:""},memoryScrollTop:{type:Boolean,default:!0},keepScrollTop:{type:Boolean},hasPullDown:{type:Boolean,default:!0},onPullDown:{type:Function}},data:function(){return{pullDist:0,refreshing:!1,pulling:!1,loading:!1,scrollTop:0,isCurrKeyboard:!1,gapBottom:0}},computed:{allowPullDown:function(){return this.hasPullDown&&(!!this.$listeners.pullDown||!!this.onPullDown)},updateTime:function(){return i.a.state.global.businessDownloadTime},numberKeyboardCoverHeight:function(){return i.a.state.global.isNumberInputOpen?i.a.state.global.numberKeyboardHeight-this.gapBottom:0}},mounted:function(){var e=this;c.a.$on("numberKeyboardOpen",this.onNumberKeyboardOpen),this.$nextTick((function(){var t=e.$refs["scroll-warp"]&&e.$refs["scroll-warp"].getBoundingClientRect&&e.$refs["scroll-warp"].getBoundingClientRect();t&&(e.gapBottom=document.documentElement.clientHeight-t.bottom),e.$el&&e.$el.addEventListener("focus",(function(t){var a=t&&t.target,o=a&&a.tagName&&a.tagName.toLowerCase();if("input"===o||"textarea"===o){window.addEventListener("resize",(function t(){var o=a.getBoundingClientRect(),i=e.$el.getBoundingClientRect(),n=o.bottom-i.bottom;n>0&&e.scrollBy(n),window.removeEventListener("resize",t,!1)}),!1)}}),!0)}))},destroyed:function(){c.a.$off("numberKeyboardOpen",this.onNumberKeyboardOpen)},activated:function(){var e=this.keepScrollTop||this.$router.isBack&&this.memoryScrollTop;this.scrollTop&&e&&(this.$refs["scroll-warp"].scrollTop=this.scrollTop)},deactivated:function(){this.memoryScrollTop&&(this.scrollTop=this.$refs["scroll-warp"].scrollTop)},methods:{onScroll:function(e){var t=this,a=this.$refs["scroll-warp"].scrollTop,o=this.$refs["scroll-warp"].scrollHeight;if(a+this.$refs["scroll-warp"].clientHeight>=o-5&&!this.loading&&this.hasNext){this.loading=!0;var i=this.$listeners.loadNext();i&&i.then&&"function"==typeof i.then?i.then((function(){t.loading=!1})):this.loading=!1}this.$emit("scroll",e)},getTouchDiretion:function(e){if(!(d&&e&&e.touches&&e.touches[0]))return"";var t=e.touches[0].clientX,a=e.touches[0].clientY;return Math.abs(a-d.y)>Math.abs(t-d.x)&&Math.abs(a-d.y)>=3?a>d.y?"down":"up":""},onTouchstart:function(e){this.allowPullDown&&e.touches&&1===e.touches.length&&(d={x:e.touches[0].clientX,y:e.touches[0].clientY,scrollTop:this.$refs["scroll-warp"].scrollTop,pullDist:this.pullDist})},onTouchmove:function(e){if(this.allowPullDown&&e.touches&&1===e.touches.length){var t=this.$refs["scroll-warp"].scrollTop,a=e.touches[0].clientY,o=a-d.y,i=this.getTouchDiretion(e);"down"===i?!this.refreshing&&t<=0?(this.pulling=!0,this.pullDist=(o-d.scrollTop)/2,e.preventDefault()):this.pulling=!1:"up"===i?this.pullDist>0&&(this.pullDist=d.pullDist-(d.y-a),e.preventDefault()):this.pullDist=d.pullDist}},onTouchend:function(){var e=this;this.allowPullDown&&(d={},this.pulling=!1,this.pullDist>=70&&this.isSync?this.refreshing?this.makePullTo(70):this.makePullTo(70).then((function(){if(e.refreshing=!0,e.onPullDown){var t=e.onPullDown();t&&t.then&&"function"==typeof t?t.finally((function(){e.refreshing=!1,e.makePullTo(0)})):(e.refreshing=!1,e.makePullTo(0))}else e.dataSync().then((function(){e.refreshing=!1,e.makePullTo(0),e.$emit("pullDown")})).catch((function(){e.refreshing=!1,e.makePullTo(0),e.$emit("pullDown")}))})):(this.refreshing=!1,this.makePullTo(0)))},makePullTo:function(e){var t=this,a=this.pullDist,o=e,i=o-a,n=a;return a===o?Promise.resolve():new Promise((function(e){!function r(){window.requestAnimationFrame((function(){n+=i/6,t.pullDist=n,a<o&&n<o||a>o&&n>o?r():(t.pullDist=o,t.refreshing=!1,e())}))}()}))},dataSync:function(){var e,t=n.default.getCurrentModuleCode(),a=n.default.getCurrentRoute(),o=a.meta&&a.meta.isTodo;if(n.default.isModuleNeedBuilding(t)&&!o){if(!this.buildingId)return new Promise((function(e){setTimeout((function(){e()}),500)}));e=this.buildingId}return l.a.addTrack("公共-手动下拉刷新","",""),r.a.beginManualUpdate(),n.default.checkSync(e).then((function(e){return r.a.endManualUpdate(),e})).catch((function(e){$log.error("下拉刷新错误",e),e&&"Error: Network Error"===e.toString()?s.a.alert("当前网络无法同步数据"):s.a.alert(e),r.a.endManualUpdate()}))},getScrollHeight:function(){return this.$refs["scroll-warp"].offsetHeight},getScrollTop:function(){return this.$refs["scroll-warp"].scrollTop},setScrollTop:function(e){this.$refs["scroll-warp"].scrollTop=e},scrollBy:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=this.getScrollTop(),n=i+e,r=Math.round(a/16.7),s=e/r,l=i,c=o=+new Date;return i===n?Promise.resolve():new Promise((function(e){!function a(){window.requestAnimationFrame((function(){c===o&&(l+=s,t.$refs["scroll-warp"].scrollTop=l,i<n&&l<n||i>n&&l>n?a():(t.$refs["scroll-warp"].scrollTop=n,e()))}))}()}))},scrollTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,a=this.getScrollTop(),o=e-a;return this.scrollBy(o,t)},scrollToEle:function(e){var t=e.keyboardHeight||232,a=(e=e.$el?e.$el:e).getBoundingClientRect(),o=this.$refs["scroll-warp"].getBoundingClientRect();if(a&&o){var n=document.documentElement.clientHeight-(i.a.state.global.isNumberInputOpen?t:0),r=o.bottom<n?o.bottom:n,s=o.top-a.top,l=a.bottom-r;s>0?this.scrollBy(-s-10):l>0&&this.scrollBy(l+10)}},isCurrent:function(t,a){var o=this;t.length&&e.each(t,(function(e){e._uid===a?o.isCurrKeyboard=!0:o.isCurrent(e.$children,a)}))},onNumberKeyboardOpen:function(e){this.isCurrKeyboard=!1,this.isCurrent(this.$children,e._uid),this.isCurrKeyboard&&this.scrollToEle(e)}}}}).call(this,a("391c"))},d945:function(e,t,a){"use strict";a("b97a")},ef48:function(e,t,a){var o=a("9d55");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,a("85cb").default)("a1a65c0c",o,!0,{sourceMap:!1,shadowMode:!1})},f7ab:function(e,t,a){"use strict";var o=a("65e9").a,i=(a("a7b6"),a("17cc")),n=Object(i.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.show?a("div",{ref:"synchronize-tip-bar",staticClass:"synchronize-tip-bar"},[a("icon",{attrs:{name:"caution"}}),e.waitUploadNum?a("span",[e._v("您有"+e._s(e.waitUploadNum)+"条数据待上传")]):e._e(),!e.waitUploadNum&&e.hasChanged?a("span",[e._v("有新数据")]):e._e(),e._v("\n  ，下拉可"+e._s(e.waitUploadNum?"上传":"刷新")+"\n")],1):e._e()}),[],!1,null,"aaf184a8",null);t.a=n.exports}}]);